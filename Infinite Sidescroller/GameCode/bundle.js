(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\B2d.js":[function(require,module,exports){
// This file contains shortcuts for the methods of the Box2D library that are used
// too often to type their long names

var B2d = function(){

};

B2d.prototype.init = function(){
	include();

	this.b2Vec2 = Box2D.Common.Math.b2Vec2;
	this.b2BodyDef = Box2D.Dynamics.b2BodyDef;
	this.b2Body = Box2D.Dynamics.b2Body;
	this.b2FixtureDef = Box2D.Dynamics.b2FixtureDef;
	this.b2Fixture = Box2D.Dynamics.b2Fixture;
	this.b2World = Box2D.Dynamics.b2World;
	this.b2MassData = Box2D.Collision.Shapes.b2MassData;
	this.b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape;
	this.b2CircleShape = Box2D.Collision.Shapes.b2CircleShape;
	this.b2DebugDraw = Box2D.Dynamics.b2DebugDraw; 
	this.b2ContactListener = Box2D.Dynamics.b2ContactListener;

};

module.exports = new B2d;

var Includes = require("./Includes.js"); var include_data = Includes.get_include_data({
	current_module: "B2d", 
	include_options: Includes.choices.OTHER_STUFF
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"./Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Config.js":[function(require,module,exports){
var Config = function(){
	this.SCREEN_W = 0; // set up when the page is loaded (to 95% of width of containing element) 
	this.SCREEN_H = 600;

	this.MAIN_CANVAS_NAME = "display_canvas";
	this.DEBUG_CANVAS_NAME = "debug_canvas";

	// Frames Per Second. Essentially, frequency of createjs.Ticker 
	// Warning! Frequency of the Box2D physics updates may be different
	// (Currently not implemented)
	this.FPS = 30; 

	// Box2D stuff >>>
	this.B2D = {
		SCALE: 30,
		SPS: 60, 			// Steps Per Second
		VELOCITY_ITR: 8,	// velocity iterations
		POSITION_ITR: 3,	// position iterations
		debug_draw: false
	};

	this.TerrainSlice = {
		grid_rows: 20,
		grid_columns: 20,
		cell_w: 1, // in meters

		// is automatically incremented each time new TerrainSliceModel is instantiated:
		next_slice_id: 0 
	};
	
	// <<<
};

module.exports = new Config;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\AssetController.js":[function(require,module,exports){

var AssetController = (function(){
	/*
	   AssetController is in charge of setting up all bitmaps/animations/other resources
	   for everyone else.
   */

	// use AssetModel.loader.getResult("id_of_the_asset");

	var init = function(asset_path){
		include();	

		/* TODO make model with the easily managed tables of resources which will be
		   added to the loader automatically
		*/

		//loader = new createjs.LoadQueue(false); // loading resourses using preload.js
		//loader.addEventListener("complete", handleComplete);
		var manifest = AssetModel.manifest;	
		AssetModel.loader.loadManifest(manifest, true, asset_path);
		
	};

	var post_init = function(){
		/* this function will be done differently at some point
		 * it'll have something to do with refactoring InitController
		 */

		//AssetModel.animations["ant"] = new createjs.SpriteSheet({
			//"framerate": 0.2,
			//"images": [get_asset("Ant1"), get_asset("Ant2"), get_asset("Ant3")],
			//"frames": { "regX": 3, "regY": 6, "height": 25, "width": 50, "count": 6},
			//"animations": {
				//"walk": [0, 1, "walk"],
				//"upside_down": [2, 3, "upside_down"],
				//"death": [4, 5, "death"]
			//}
		//})

	};
	

	var get_asset = function(id){

		var result = AssetModel.loader.getResult(id);

		if(!result){
			throw "Error: asset with id " + id + " could not be loaded." +
				" Check that id is valid and that assets were properly loaded";
		}
		
		return result;
	};
		


	
	return {
		init: init,
		get_asset: get_asset,
	};

})();

module.exports = AssetController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "AssetController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\EnemyController.js":[function(require,module,exports){

var EnemyController = (function(){
	/* Description
	*/

	var type_logic_table;
	
	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

		type_logic_table = {
			"ant": AntLogic,
			"hero": HeroLogic,
		};

		var imports = {RegisterAsController: RegisterAsController,
			PhysicsController: PhysicsController,
			IdentificationController: IdentificationController,
			KeyboardController: KeyboardController,
			B2d: B2d
		};

		for(type in type_logic_table){
			var logic = type_logic_table[type];
			logic.init(imports);

			if(logic.begin_contact){
				PhysicsController.listen_for_contact_with(type, "BeginContact", logic.begin_contact);
				console.log(logic);
			}

			if(logic.end_contact){
				PhysicsController.listen_for_contact_with(type, "EndContact", logic.end_contact);
			}

			if(logic.pre_solve){
				PhysicsController.listen_for_contact_with(type, "PreSolve", logic.pre_solve);
			}

			if(logic.post_solve){
				PhysicsController.listen_for_contact_with(type, "PostSolve", logic.post_solve);
			}

		}

		spawn(10, 10, "hero");
	};

	var spawn = function(x, y, type){
		/**
		* spawn entity of the given type at the given coordinates
		* also registeres thing as awaiting graphics initialization
		*/
		var logic = type_logic_table[type];

		if(logic){
			var new_entity = logic.spawn(x, y);
			RegisterAsController.register_as("awaiting_graphics_initialization", new_entity)
			var logic_upd_list = EnemyModel.for_logic_update[type];
			if(logic_upd_list){
				logic_upd_list.push(new_entity);
			}else{
				EnemyModel.for_logic_update[type] = [new_entity]
			}
		}else{
			throw "Logic for the type " + type + " is not defined";
		}
		

	};
	

	var update = function(delta){
		/* is ran each tick from the GameController.update_all */
		var debug_commands = KeyboardController.debug_commands();

		// demonstration purposes
		if(debug_commands("spawn_ant")){
			var new_ant = spawn(Math.random()*50 + 10, 10, "ant");
		}

		for(var type in EnemyModel.for_logic_update){
			var list = EnemyModel.for_logic_update[type];

			var logic = type_logic_table[type];
			for(var i = 0; i < list.length; i++){
				logic.tick_AI(list[i]);
			}
		} // end for in 

	};

	return {
		// declare public
		init: init, 
		update: update,

	};
})();

module.exports = EnemyController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "EnemyController", 
	include_options: Includes.choices.DEFAULT | Includes.choices.LOGIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\GameController.js":[function(require,module,exports){


var GameController = (function(){

	var init = function(){
		include();
	};
		

	var update_all = function(event){
		/*
		 * main function pretty much
		 * everyghing else is called from here every tick
		 */
		
		if (!createjs.Ticker.paused){
			var delta = event.delta;

			// !!!! world simulation step goes somewhere right here
			// as per current design, will take delta as an argument
		
			//TerrainController.generate_terrain(); 
			//PlayerController.update();
		
			WorldController.update(delta);

			TerrainController.update();
			EnemyController.update();

			// Should be called after all movement of objects is done:
			GraphicsController.update();
		}
	};


	return {
		init: init,
		update_all: update_all,
	};

})();

module.exports = GameController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "GameController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\GraphicsController.js":[function(require,module,exports){

var GraphicsController = (function(){
	/* all the graphics stuff. and what did you expect?
	*/

	var get_asset; 
	var hero, ant; // for quicker access
	var type_renerer_table;
	var Graphics;

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

		// this will be passed to rendereres
		Graphics = {request_animated: request_animated, reg_for_render: reg_for_render, 
			set_reg_position: set_reg_position, request_bitmap: request_bitmap};

		type_renderer_table = {
		// type:	renderer:
			"ant": AntRenderer,
			"hero": HeroRenderer,
		};

		get_asset = AssetController.get_asset; // for quicker access

		init_animations();


		GraphicsModel.stage = new createjs.Stage(Config.MAIN_CANVAS_NAME);
		GraphicsModel.stage.canvas.width = Config.SCREEN_W;
		GraphicsModel.stage.canvas.height = Config.SCREEN_H;

		
		
		//GraphicsModel.camera.following = hero;
        //PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
		GraphicsModel.score = new createjs.Text();
		reg_for_render(GraphicsModel.score);
		GraphicsModel.health = new createjs.Text();
		reg_for_render(GraphicsModel.health);
		hud_temp();

		// TODO: init all renderers; change Includes to package renderers
		AntRenderer.init({get_asset: AssetController.get_asset, });
	};
    
	var update = function(delta){
		/* is ran each tick from the GameController.update_all */

	    update_camera(); // needs to be updated first

		register_new_stuff();

		check_for_new_terrain();

		render_things();
		synchronize_to_physical_bodies();

	    //PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
		hud_temp_update();

		// <<<<
		
		GraphicsModel.stage.update();
	};

	var register_new_stuff = function(){
		/**
		* description
		*/

		// retrieve instances of physical things that do not have graphics yet
		var new_stuff = RegisterAsController.retrieve_registered_as("awaiting_graphics_initialization");

		var length = new_stuff.length
		for(var i = 0; i < length; i++){
			var new_obj = new_stuff.pop();
			if(type_renderer_table[new_obj.type]){
				// if renderer exists for this type, register through it
				type_renderer_table[new_obj.type].register(new_obj, Graphics);	

				if(GraphicsModel.special_render[new_obj.type]){
					GraphicsModel.special_render[new_obj.type].push(new_obj);
				}else{
					GraphicsModel.special_render[new_obj.type] = [new_obj];
				}
			}else{
				console.log(new_obj);
				
				throw "No renderer found for the type " + String(new_obj.type) +
					" confirm that renderer exists and is added to the GraphicsController.type_renderer_table"
			}
		}

	};
	
	var render_things = function(){
		/**
		* call renderers for everything
		*/
		
		var to_render = GraphicsModel.special_render;

		for(var type in to_render){

			var list = to_render[type];
			var renderer = type_renderer_table[type];

			for(var i = 0; i < list.length; i++){
				renderer.render(list[i], Graphics);
			}

		}
		
	};
	

    //DELETE ME PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	var hud_temp = function () {
	    GraphicsModel.health.text = "100";
	    GraphicsModel.health.x = 10;
	    GraphicsModel.health.y = 30;
	    GraphicsModel.health.font = "20px Arial";
	    GraphicsModel.health.color = "#ff0000";
	    GraphicsModel.score.text = "10";
	    GraphicsModel.score.x = 10;
	    GraphicsModel.score.y = 10;
	    GraphicsModel.score.font = "20px Arial";
	}

    //DELETE ME PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	var hud_temp_update = function () {
	    temp_score = parseInt(GraphicsModel.score.text);
	    temp_score += 1;
	    GraphicsModel.score.text = temp_score.toString();
	}
	
	var update_health = function(passed) {
	
	GraphicsModel.health.text = passed;
	//console.log("I've been called");
	}

	var update_camera = function(){
		var camera = GraphicsModel.camera;
		var center = camera.center;

		center.x = Config.SCREEN_W/2 - camera.offset_from_followed.x;
		center.y = Config.SCREEN_H/2 - camera.offset_from_followed.y;

		if(camera.following != null){
			camera.offset.x = center.x - camera.following.physical_instance.body.GetWorldCenter().x * Config.B2D.SCALE;
			camera.offset.y =  center.y - camera.following.physical_instance.body.GetWorldCenter().y * Config.B2D.SCALE;
		}

		adjust_debug_draw(); // goes last
	};

	


	//*************************************
	var adjust_debug_draw = function(){
		var camera = GraphicsModel.camera;
		TestController.set_debug_offset(camera.offset.x, camera.offset.y);
	};

	var init_animations = function(){
		
		
	};
	
	var request_bitmap = function(id){
		// if id is invalid, throw meaningful exception?
		var bitmap = new createjs.Bitmap(get_asset(id));
		// more complicated setting for registration position may be needed, depending on the body attached
		if (!(bitmap.image)){
			throw "Error: image wasn't correctly loaded for this bitmap";
		}
		
		bitmap.regX = bitmap.image.width/2;
		bitmap.regY = bitmap.image.height/2;

		return bitmap;
		// TODO research DisplayObject's caching. and maybe incorporate
	};

	var request_animated = function(id, start_frame){
		// this implementation is temporary
		// until I setup efficient facility for defining spritesheets
		// within GraphicsController

		if(!id || !start_frame){
			if(!id){
				throw "wrong id";
			}else{
				throw "wrong start_frame";
			}
		};

		var sprite = new createjs.Sprite(id, start_frame);

		return sprite;
	};

	
	
	var synchronize_to_physical_bodies = function(){

		var tiles = GraphicsModel.all_physical;

		for(var i = 0; i < tiles.length; i++){
			var tile = tiles[i];
			var body = tile.physical_instance.body;

			var tile_pos = trans_xy(body.GetWorldCenter());

			tile.x = tile_pos.x;
			tile.y = tile_pos.y;
		}

	};
	

	var check_for_new_terrain = function(){
		/* If new terrain has been generated, render it
		 */

		var new_slices = TerrainController.GetNewTerrainSlices();
		while(new_slices.length > 0){

			var slice = new_slices.pop();

			for(var i = 0; i < slice.grid_rows; i++){
				/* graphics pass. should be probably moved to the graphics controller
				 * didn't decide on it yet
				 */


				var lvl = slice.grid_rows - i; // level from the bottom

				for(var j = 0; j < slice.grid_columns; j++){
					var id = slice.grid[i][j].id;
					if(id != 0){
						// TODO: should make proper terrain collection thing to pull from 
						var tile_texture = ["grass", "middle_terrain", "bottom_terrain"][id-1];
						var tile = request_bitmap(tile_texture);
						var physical_instance = slice.grid[i][j];
						var body_position = physical_instance.body.GetWorldCenter();
						var trans_pos = trans_xy(body_position);
						tile.x = trans_pos.x;
						tile.y = trans_pos.y;
						reg_for_render(tile, physical_instance);
					} // fi


				} // end for

			}//end for

		} // end while

	}; // end check_for_new_terrain

	var trans_xy = function(position_vector_unscaled){
		// takes position vector with values in meters, translates
		// it to pixel position taking the camera position into account
		var camera = GraphicsModel.camera;

		var x = (position_vector_unscaled.x * Config.B2D.SCALE) + camera.offset.x;
		var y = (position_vector_unscaled.y * Config.B2D.SCALE) + camera.offset.y;

		return {x: x, y: y};	
	};

	var set_reg_position = function(easeljs_obj, offset_x, offset_y){
		// sets registration position of the easeljs object
		// regisration position is the relative point of the object
		// that you move when you set object's x and y coordinats
		// i.e. if reg. position of the player is head, and you set their
		// position to (0, 0), their head will be at (0, 0)
		// currently the registration position is set to the middle of the body
		// to match what box2d does
		// last two arguments are optional and set PIXEL offset from the normal registration
		// position
		
		// this if statement should be temporary
		if(easeljs_obj.image){
			var w = easeljs_obj.image.width;	
			var h = easeljs_obj.image.height;	
		}else{
			var w = easeljs_obj.spriteSheet._frameWidth;
			var h = easeljs_obj.spriteSheet._frameHeight;
		};

		var offset_x = offset_x || 0;
		var offset_y = offset_y || 0;

		easeljs_obj.regX = w/2 + offset_x;
		easeljs_obj.regY = h/2 + offset_y;

	};

	var reg_for_render = function(easeljs_obj, physical_instance){
		// registeres object for rendering within graphics controller
		// if (OPTIONAL!) physical_instance is given, graphics controller will automatically
		// set the easeljs_obj's position to position of that body, each tick.
		// if the type of the physical instance is associated with some renderer
			
		if(physical_instance){

			easeljs_obj.physical_instance = physical_instance;
			GraphicsModel.all_physical.push(easeljs_obj);
		}


		AddToStage(easeljs_obj);
	};

	var AddToStage = function(element){
		// can be updated later to manage z-index or whatever
		GraphicsModel.stage.addChild(element);
	};

	var get_stage = function(){
		return GraphicsModel.stage;
	};
	

	return {
		// declare public
		init: init, 
		update: update,
		get_stage: get_stage,
		update_health: update_health,
	};
})();

module.exports = GraphicsController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "GraphicsController", 
	include_options: Includes.choices.DEFAULT | Includes.choices.RENDERERS
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\IdentificationController.js":[function(require,module,exports){

var IdentificationController = (function(){
	/* Is in charge of giving unique ID's to everything
	 * that wants them
	*/

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

		// create 100 id's
		for(var i = 0; i < 100; i++){
			var id = IdentificationModel.next_id ++;
			IdentificationModel.free_ids.push(id);
			IdentificationModel.id_matching[id] = null;
		}

	};

	var update = function(delta){
		/* is ran each tick from the GameController.update_all */
		// cleanup ids, if too many free ids (like if non-free id's < free id's/10
		
		//TODO: make function to actually be called from the GameController.update_all
		// TODO: loop through all non-free id's, and if any of them reference null,
		// remove (unregister) them;

	};

	var assign_id = function(obj, set_id){
		/**
		* assigns id to the object
		* sets property id on the object given. you can give OPTIONAL parameter
		* set_id which should be a function that takes object and id and assigns
		* id to the object. this can be useful if you want to store id in some unusual
		* place, or perform some extra operations before id is assigned
		*
		* return id assigned
		* IdentificationController will remember that this id has been assigned
		* this object
		*/
		var free = IdentificationModel.free_ids;
		var id;

		// get free id
		if(free.length > 0){
			id = free.pop();
		}else{
			id = IdentificationModel.next_id++;
		}

		// set id on the object. through function if provided
		if(set_id){
			set_id(obj, id);
		}else{
			obj.id = id;
		}

		// associate id with the object obj
		IdentificationModel.id_matching[id] = obj;

		return id
	};

	var get_by_id = function(id){
		/**
		* get object associated with the given id
		*/
		return IdentificationModel.id_matching[id];
	};

	var remove_id = function(id){
		/**
		* mark id as free and no longer assiciate it with any object
		* notice that you yourself is responsible for making sure
		* that object that was associated with this id doesn't think
		* that he is still assigned this is
		*/

		// TODO: make sure that all known places that use ids (PhysicsControllers'
		// contact listener for example) are notified that id had been unregistered
		IdentificationModel.id_matching[id] = null;
		IdentificationModel.free_ids.push(id);
	};
	
	var assign_type = function(obj, type){
		/**
		* assigns wanted type (string) to the given
		* model definition
		* if you try to assign same type twice, throws exception;
		* Id...Controller allows you to retrieve model
		*/

		var types = IdentificationModel.types;
		if(types[type]){
			throw "Error: type " + type + " is already registered. " +
				"You can't register the same type twice";
		}else{
			types[type] = obj;
			obj.prototype.type = type;
		}
		
	};

	var get_by_type = function(type){
		/**
		* gets object by it's type
		*/
		var types = IdentificationModel.types;
		if(types[type]){
			return types[type];
		}else{
			throw "Error: type " + type + " wasn't defined yet";
		}
	};
	
	
	
	
	return {
		// declare public
		init: init, 
		update: update,
		assign_id: assign_id,
		get_by_id: get_by_id,
		remove_id: remove_id,
		assign_type: assign_type,
		get_by_type: get_by_type,
	};
})();

module.exports = IdentificationController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "IdentificationController", 
	include_options: Includes.choices.OWN_MODEL
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\InitController.js":[function(require,module,exports){
var InitController = (function(){
	// why do you want to put initialization of everything into the InitController?
	// Because if initialization of smth depends on initialization of smth else,
	// it's easier to control here
	//
	// e.g. if you try to do var foo = $('#foo'); somewhere in other module,
	// you can get foo = null; as code of that module can execute before the html document
	// was fully loaded, but >InitController.init< is called after document was loaded, so
	// -1 potential problem. Btw, at this moment in time the the stuff is set to work that way
	// using html (<body onload=...); maybe using JS would be better? Idk;
		

	var init = function(mode){
		include();

		enable_arrowkey_scroll(false);
		setup_screen();
		setup_events();

		init_all_modules(mode); // call .init function of everyone. e.g. PlayerController.init(); etc.

		
		// Notice that asset dependent stuff doesn't (and mustn't) start until
		// all assets are completely loaded. That includes ticker, i.e. no ticks are processed
		// until everything is loaded. If you want something different, e.g. display some sort of loading
		// animation - let me know.
		// Look into the setup_asset_dependent function
			AssetModel.loader = new createjs.LoadQueue(false); // loading resourses using preload.js
			AssetModel.loader.addEventListener("complete", setup_asset_dependant);

		// if more stuff needs to be done for the test mode, 
		// or more types of it needs to be added
		// you can safely make the following a separate function
			var asset_path = (mode == "test") ? "./assets/art/" : "../GameCode/assets/art/";

		AssetController.init(asset_path);

	};

	var init_all_modules = function(mode){
		// TODO: better way to do stuff like that (call certain function
		// of every module in the order. 
		// Also, init and update functions of each module should probably
		// accept some argument. I think to make this argument an object,
		// this way we can add more things to be passed w/o any problem and
		// we won't need to change anything
		
		B2d.init(); // goes first
		IdentificationController.init();
		RegisterAsController.init();

		//AssetController.init(); // called from the InitController.init// stuff has to change
		GameController.init();
		KeyboardController.init();
		PhysicsController.init();

		TestController.init(mode);

		//PlayerController.init();
		TerrainController.init();
		TerrainSliceController.init();
		WorldController.init();

		// WARNING!!! GraphicsController.init is called from the
		// setup_asset_dependent function as it, well, depends on assets being loaded

	};


	var enable_arrowkey_scroll = function(enable_scroll){
		if(enable_scroll == false){                                                          
			document.addEventListener('keydown', function(e){ // .getElementById("display_canvas")
				arrows = [37, 38, 39, 40];                                          
				if(arrows.indexOf(e.keyCode) > -1){                                 
					e.preventDefault();                                             
					return false;                                                   
				}else{                                                              
					return true                                                     
				}                                                                   
			})                                                                      
		}		
	};
	
	var setup_screen = function(){

		// Setting up other stuff:
		// e.g setup canvas size
		
		// TODO: allow resizes?

		Config.SCREEN_W = $('#canvas_container').width(); // is dynamically set to pixel width of the containing element

		// possible resizing technique: 
		// http://www.fabiobiondi.com/blog/2012/08/createjs-and-html5-canvas-resize-fullscreen-and-liquid-layouts/

		
		//$('#debug_canvas').width(String(SCREEN_W) + "px");
		//$('#display_canvas').width(String(SCREEN_W) + "px");

		//$('#debug_canvas').height(String(SCREEN_H) + "px");
		//$('#display_canvas').height(String(SCREEN_H) + "px");
		
	};

	var setup_ticker = function(){

		createjs.Ticker.setFPS(Config.FPS);

		// ticker: on each tick call GameController.update_all();
		createjs.Ticker.addEventListener("tick", GameController.update_all);

	
	};

	var setup_events = function(){


		// keyboard input event: on each keyboard event call appropriate KeyboardController function
		document.onkeydown = KeyboardController.keydown;
		document.onkeyup = KeyboardController.keyup;

			// on interrupt event: stop/pause ticker ?

	};

	var setup_asset_dependant = function(){
		// this may need to move to either load_game or some sort of resizing function
		
		EnemyController.init();
		GraphicsController.init();


		setup_ticker();

		//TerrainController.generate_terrain(); // Initial terrain generation // deprecated, generation will be called from update each tick
	};


	return {
		init: init,
	};
})();

module.exports = InitController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "InitController", 
	include_options: Includes.choices.ALL
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\KeyboardController.js":[function(require,module,exports){
var KeyboardController = (function()
{

	var init = function(){
		
		include();
	};
	
	var get_active_commands_function = function(table){
		// get all commands associated with keys that are defined in the >table<,
		// and are currently pressed
		//
		// returns: array of commands
		//
		// TODO: REFACTOR this function to work better and so people do not
		// need to call it each tick. instead they should get reference to function one time
		// and stay updated on the active commands
		
		var commands = [];
		
		$.each(KeyboardModel.translation_tables.code_to_name, function(key, cmd){
			if(KeyboardModel.keys[key] && table[cmd]){
				commands.push(table[cmd]);
			}
		});

		var get_key = function(key){
			if(commands.indexOf(key) > -1){
				return true;
			}else{
				return false
			};
		};

		return get_key;
	};

	// public:
	
	var keydown = function(event){
		KeyboardModel.keys[event.keyCode] = true;
	};

	var keyup = function(event){
		delete KeyboardModel.keys[event.keyCode];
	};


	var movement_commands = function(){
		return get_active_commands_function(KeyboardModel.translation_tables.movement);
	};

	var debug_commands = function(){
		/**
		* commands active in debug mode
		*/
		return get_active_commands_function(KeyboardModel.translation_tables.debug);
	};
	

	return {
		keydown: keydown,
		keyup: keyup,

		movement_commands: movement_commands,
		debug_commands: debug_commands,
		init: init,
	};

})();

module.exports = KeyboardController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "KeyboardController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\PhysicsController.js":[function(require,module,exports){
// Notes:
// notice that you can reuse body definitions multiple times, it makes sense to have
// collection of body definitions that are commonly use and maybe allow some sort of 
// inheritance (i.e. you can make some definition on top of the another definition)
// // bodies are allowed to have userData on them that is just reference to some object.
// may be useful in some situations
//
// Question:
// does it make sense to allow users to pass any properties as part of object definition
// and just apply those properties automatically to the userData property of body?

var B2dConfig;

var PhysicsController = (function(){

	var init = function(){
		include();

		B2dConfig = Config.B2D;

		PhysicsModel.scale = B2dConfig.SCALE;
		PhysicsModel.step_amount = 1/(B2dConfig.SPS);

		PhysicsModel.gravity = new B2d.b2Vec2(0,20); // earth gravity
		PhysicsModel.world = new B2d.b2World(PhysicsModel.gravity, true);

		init_collision_listener();

	};
	
	var step = function (delta_ms) {
		// !? should I set upper limit on delta to prevent world from
		// fast forwarding if the ticker was paused? or that is not a problem in our case?
		// investigation is needed

		var delta = delta_ms/1000;

		PhysicsModel.timeToCover += delta;

		while (PhysicsModel.timeToCover > PhysicsModel.step_amount) {
			PhysicsModel.timeToCover -= PhysicsModel.step_amount;
			PhysicsModel.world.Step(
				PhysicsModel.step_amount,
				B2dConfig.POSITION_ITR, // velocity iterations
				B2dConfig.VELOCITY_ITR // position iterations
			);
		}
	};  // end step 

	var draw_debug = function(){
		if (B2dConfig.debug_draw) {
			PhysicsModel.world.DrawDebugData();
		}
	};

	var get_parent_chain = function(template, default_def){
		var next = template;
		var ancestors = [];

		while(next != null){
			ancestors.push(next);
			next = next["parent"];
		}

		if(default_def){
			ancestors.push(default_def);
		}

		return ancestors;
		
	};

	var apply_parents = function(template_name, template_collection){
		// TODO: refactor the code so this thing is done only once
		// at the load tim
		// that could probably be done even for other things.
		// idea: store compiled body/fixture etc. together with the
		// template. this way you'll have easy access to the all defined
		// options for debugging;
		
		var default_tmplate = template_collection["default"];

		var chain = get_parent_chain(template_collection[template_name], default_tmplate);

		var final_definition = {};

		for(var i = chain.length - 1; i >= 0 ; i--){
			// may be needed to be made more efficient by moving the other way
			// and not considering options that were already encountered in children
			var current = chain[i];


			for(var prop in current){
				final_definition[prop] = current[prop];
			}
		}

		return final_definition;
	}; // end apply_parents
		
	var target_props = {
		body_def: [
			"active",
			"allowSleep",
			"angle",
			"angularDamping",
			"angularVelocity",
			"awake",
			"bullet",
			"fixedRotation",
			"inertiaScale",
			"linearDamping",
			"linearVelocity",
			"position",
			"type",
			//"userData" // doesn't seem to properly work, doing it differently
		],
		fixture_def: [
			"density",
			//"filter", implement later if needed
			"friction",
			"isSensor",
			"restitution",
			"shape",
			"userData"
		]
	};

	var apply_property_list = function(source, destination, list){
		/**
		 * takes two objects and the list of strings
		 * copies all properties with names found in the list
		 * from source to destination
		 * scips properties which are null/undefined
		 */

		for(var i = 0; i < list.length; i++){
			var prop = list[i];
			if(source[prop] != null){
				destination[prop] = source[prop];
			}
		}

		return destination;
	};

	var PropertyUndefined = function PropertyUndefined(property_name){
		this.name = "PropertyUndefined";
		this.message = "Error: " + property_name + " is not defined";
	};
	PropertyUndefined.prototype = Object.create(Error.prototype);
	PropertyUndefined.prototype.constructor = PropertyUndefined;

	var get_formal_body_def = function(non_formal_def){
		/**
		 * turn non formal definition into the formal one
		 * non-formal definition is an object that contains
		 * properties SOME of which are box2d properties or are 
		 * intended to be transformed into such. E.g. the non-formal
		 * definition may contain properties vx and vy which will be transformed
		 * into the linearVelocity vector in the formal definition
		 */

		var nfdef = non_formal_def;

		var definition = new B2d.b2BodyDef();

		if(nfdef.vx != null && nfdef.vy != null){
			// check for informal parameter specification first
			nfdef.linearVelocity = new B2d.b2Vec2(nfdef.vx, nfdef.vy);
		}else{
			// maybe the linearVelocity was specified directly as vector,
			// and not through informal parameters; checking that, and if not,
			// exception
			if(!(nfdef.linearVelocity)){
				throw new PropertyUndefined("linearVelocity");
			}
		}

		if(nfdef.x != null && nfdef.y != null){
			// same procedure as for the linear velocity
			// checking for informal specification here
			// and if present, turning into the formal
			nfdef.position = new B2d.b2Vec2(nfdef.x, nfdef.y);
		}else{
			// checking if formal was specified directly
			if(!(nfdef.position)){
				// if not, throw custom exception
				throw new PropertyUndefined("position");
			}
		}

		if(nfdef.type){
			nfdef.type = {
				"static": B2d.b2Body.b2_staticBody, 
				"dynamic": B2d.b2Body.b2_dynamicBody,
				"kinematic": B2d.b2Body.b2_kinematicBody
			}[nfdef.type]; // turn string-type into b2d type
		}else{
			throw new PropertyUndefined("type");
		}

		apply_property_list(nfdef, definition, target_props.body_def);

		return definition;

	};

	var get_formal_fixture_def = function(non_formal_def){
		/**
		 * turns non-formal definition into the formal one
		 * see get_fromal_body_def for explanation
		 */

		var nfdef = non_formal_def;
		var shape = nfdef.shape;
		var fixture_def = new B2d.b2FixtureDef();

		apply_property_list(non_formal_def, fixture_def, target_props.fixture_def);

		switch (shape) {
			case "rectangle":

				if(nfdef.width != null && nfdef.height != null){
					fixture_def.shape = new B2d.b2PolygonShape();
					if (nfdef.offset != null){
						var offset = new B2d.b2Vec2(nfdef.offset.x ,nfdef.offset.y);
						fixture_def.shape.SetAsOrientedBox(nfdef.width/2, nfdef.height/2, offset, 0);
					}else{
						fixture_def.shape.SetAsBox(nfdef.width/2, nfdef.height/2);
					}
				}else{
					throw new PropertyUndefined("width or height");
				}
				break;
			case "polygon":

				if(nfdef.points != null){
					fixture_def.shape = new B2d.b2PolygonShape();
					fixture_def.shape.SetAsArray(nfdef.points, nfdef.points.length);
				}else{
					throw new PropertyUndefined("points");
				}
				break;
			case "circle":

				if(nfdef.radius != null){
					fixture_def.shape = new B2d.b2CircleShape(nfdef.radius);
				}else{
					throw new PropertyUndefined("radius");
				}
				break;
			default:
				throw "Error: shape must be one of the following: " + 
					'"polygon", "rectangle", "circle". You specified: ' +
					String(shape);
		}

		return fixture_def;

	};
	

	var get_body = function(non_formal_def, entity_instance){
		/**
		 * takes non-formal definition
		 * returns body based on this definition
		 *
		 */
		if (entity_instance == null){
		throw new PropertyUndefined("entity_instance");
		}
		var definition = get_formal_body_def(non_formal_def);

		var body = PhysicsModel.world.CreateBody(definition);

		//if(body.userData == null){
			//body.userData = {};
		//}

		// append passed definition to the user data of the body
		// for debugging purposes, and also to allow easy specification of 
		// custom parameters during definition. If this will cause confusion,
		// I'll remove that
		//body.userData.def = non_formal_def;
		body.SetUserData({def: non_formal_def, entity_instance: entity_instance});
		
		return body;
	
	};

	var attach_fixture = function(body, non_formal_def, fixture_name){
		/**
		 * given b2d body, (non-formal) fixture definition and (OPTIONAL) fixture_name
		 * this function attaches fixture to the body
		 */

		var fixture_def = get_formal_fixture_def(non_formal_def);

		if(fixture_def.userData == null){
			fixture_def.userData = {};
		}

		fixture_def.userData.def = non_formal_def;
		fixture_def.userData.name = fixture_name;
		
		body.CreateFixture(fixture_def);
		
	};

	var attach_sensors = function(body){
		var SENSOR_THICKNESS = 0.1;
		
		// get the width and height of the body's main fixture
		// and create 4 sensor fixtures based on those parameters
		// calculate offset of sensors so that they match the main fixture
		var x = body.GetPosition().x;
		var y = body.GetPosition().y;

		// TODO: change to getting dimentions of main fixture
		var h = body.GetFixtureList().GetAABB().GetExtents().y;
		var w = body.GetFixtureList().GetAABB().GetExtents().x;
		
		//attach top fixture
		var top_sensor = {};
		top_sensor.shape = "rectangle";
		top_sensor.density = 0;
		top_sensor.isSensor = true;
		top_sensor.height = SENSOR_THICKNESS;
		top_sensor.width = w*2 - SENSOR_THICKNESS*2;
		top_sensor.offset = {x:0, y: (-1*h) + SENSOR_THICKNESS/2};
		attach_fixture(body,top_sensor,"top");
		
		//attach bottom fixture
		var bottom_sensor = top_sensor;
		bottom_sensor.offset = {x:0, y: h - SENSOR_THICKNESS/2};
		attach_fixture(body,bottom_sensor,"bottom");
		
		//attach left fixture
		var left_sensor = top_sensor;
		left_sensor.height = h*2 - SENSOR_THICKNESS*2;
		left_sensor.width = SENSOR_THICKNESS;
		left_sensor.offset = {x:(-1*w) + SENSOR_THICKNESS/2,y:0};
		attach_fixture(body,left_sensor,"left");
		
		//attach right fixture
		var right_sensor = left_sensor;
		right_sensor.offset = {x:w - SENSOR_THICKNESS/2, y:0};
		attach_fixture(body,right_sensor,"right");
	};
	
	
	

	var get_rectangular = function(def, entity_instance){
		// get appropriate template collection to draw from
		var template_name = entity_instance.type;
		var template_collection = PhysicsModel.r_templates;
		var compiled_template = apply_parents(template_name, template_collection);

		// apply custom override
		var final_def = compiled_template;
		for(var prop in def){
			final_def[prop] = def[prop];
		}

		final_def.shape = "rectangle";

		// final_def contains all final data, about body we are about to create
		// it takes into account template given and all it's parents
		// and also manually specified parameters. However, this definition is raw,
		// i.e. some data in it may not be in its final form, e.g. linear velocity is specified
		// as two parameters, vx and vy, while it whould be converted into the vector
		// for box2d. so final_def is a final description, but not in final form


		var body = get_body(final_def, entity_instance);
		 
		attach_fixture(body, final_def, "main");
		
		//If the object has directional sensors, attach sensors here
		if(final_def.border_sensors){
			attach_sensors(body);
		}

		return body;
	};

	var get_circular = function(def, template){
		var type = "circular";
		// dont' forget about refactoring some stuff into the
		// set_common function
		
		var definition = new B2d.b2BodyDef();
		
	};
		
	var get_polygonal = function(def, template){
		var type = "polygonal";
		
		var definition = new B2d.b2BodyDef();
		
	};

	var set_debug_draw = function(debug_draw){
		PhysicsModel.world.SetDebugDraw(debug_draw);
	};


	
	var listen_for_contact_with = function(what, collision_event_name, custom_function){
		/**
		 * setups custom_function to be called each time the collision event 
		 * occurs and involves >what<
		 * TAKES:
		 * 	>what<
		 * 		string 
		 * 		id of an object ("383") or it's type ("player")
		 * 	>collision_event_name<
		 * 		string. one of:
		 * 		BeginContact, EndContact, PreSolve, PostSolve
		 * 	>custom_function< 
		 * 		function
		 * 		function to be called on one of those events
		 * 		notice that function will be wrapped, so it should
		 * 		accept extra parameter >info< that will contain
		 * 		unpacked information about the collision
		 */


		if(what == null){
			throw new PropertyUndefined("what");
		}

		if(
			collision_event_name != "BeginContact" && collision_event_name != "EndContact" &&
			collision_event_name != "PreSolve" && collision_event_name != "PostSolve" 
		){
			throw "collision_event_name should be one of: PreSolve, PostSolve, EndContact, BeginContact";
		}

		if(custom_function == null || typeof(custom_function) != "function"){
			throw "Property custom_function is not defined or isn't a function"
		}

		var target_function_table = PhysicsModel.awaiting_contact[collision_event_name]; 

		if(target_function_table[what] == null){
			target_function_table[what] = [custom_function];
		}else{
			target_function_table[what].push(custom_function);
		}
		
		
	};
	
	
		
	var init_collision_listener = function(){
		
		/**
		 */
		
		var call_all = function(list, args, info){
			/**
			 * call all functions in list providing arguments
			 * from the array args
			 * if list give is null/undefined, do nothing
			 */

			if(list != null){
				args.push(info);
				for(var i = 0; i < list.length; i++){
					list[i].apply(this, args);
				}
			}
		};

		var get_id = function(obj){
			userData = obj.GetUserData();
			if(userData != null && userData.id != null){
				return userData.id;
			}else{
				return "[NO_ID]"
			}
			
		};

		var get_type = function(obj){
			var userData = obj.GetUserData();
			if(userData != null && userData.entity_instance.type != null){
				return userData.entity_instance.type;
			}else{
				return null;
			}
			
		};

		var unpack_contact_info = function(contact, my_type){
			/**
			 * unpacks info about the collision and 
			 * returns it
			 * >my_type< is an type of an object that will
			 * go under the >Me< parameeter inside of info
			 * (As opposed to Them, which is the other object)
			 */
			if(my_type == null){
				// >my_type< isn't supposed to be null/undefined
				throw new PropertyUndefined("my_type");
			}

			var A = {};
			var B = {};

			A.fixture = contact.m_fixtureA;
			B.fixture = contact.m_fixtureB;
			A.body = A.fixture.GetBody();
			B.body = B.fixture.GetBody();

			A.id = get_id(A.body);
			B.id = get_id(B.body);

			//A.entity = IdentificationController.get_by_id(A.id);
			//B.entity = IdentificationController.get_by_id(B.id);
			A.entity = A.body.GetUserData().entity_instance;
			B.entity = B.body.GetUserData().entity_instance;

			A.type = get_type(A.body);
			B.type = get_type(B.body);

			A.fixture_name = get_custom_property(A.fixture, "name");
			B.fixture_name = get_custom_property(B.fixture, "name");

			// TODO: unpack more info if necessary

			var info = {};

			if(A.type == my_type){
				info.Me = A;
				info.Them = B;
			}else{
				info.Me = B;
				info.Them = A;
			}

			return info;
			
		};
		
		var common_contact = function(contact, args, lists){
			// create info, call respective functions for each id. use provided arguments >args<
			// lookup ids in the provided table of lists >lists<
			
			var type1 = get_type(contact.m_fixtureA.GetBody());
			var type2 = get_type(contact.m_fixtureB.GetBody());


			if(type1 != null){
				var info = unpack_contact_info(args[0], type1);
				call_all(lists[type1], args, info);
			}

			if(type2 != null){
				var info = unpack_contact_info(args[0], type2);
				call_all(lists[type2], args, info);
			}

		};
		
		var PreSolve = function(contact, impulse){
			
			var lists = PhysicsModel.awaiting_contact.PreSolve;

			var args = [contact, impulse];

			common_contact(contact, args, lists);
	
		};
		
		var PostSolve = function(contact, oldManifold){
			var lists = PhysicsModel.awaiting_contact.PostSolve;

			var args = [contact, oldManifold];

			common_contact(contact, args, lists);
		};

		var BeginContact = function(contact){
			var lists = PhysicsModel.awaiting_contact.BeginContact;

			var args = [contact];

			common_contact(contact, args, lists);
		};

		var EndContact = function(contact){
			var lists = PhysicsModel.awaiting_contact.EndContact;

			var args = [contact];

			common_contact(contact, args, lists);
		};
		
		
		
		var listener = new B2d.b2ContactListener;
		listener.PreSolve = PreSolve;
		listener.PostSolve = PostSolve;
		listener.BeginContact = BeginContact;
		listener.EndContact = EndContact;
		
		PhysicsModel.world.SetContactListener(listener);
	
	};

	var get_custom_property = function(b2d_obj, property_name){
		
		/**
		 * given any box2d object that has GetUserData method
		 * this function will return custom property with given
		 * property_name if this property is set on userData of the object
		 * if not, the function returns null
		 */
		var user_data = b2d_obj.GetUserData();
		if(user_data && user_data[property_name]){
			return user_data[property_name];
		}else{
			return null;
		}
	};
	
	
	
	
	return {
		get_body: get_body,
		get_rectangular: get_rectangular,
		step: step,
		init: init,
		set_debug_draw: set_debug_draw,
		draw_debug: draw_debug,
		listen_for_contact_with: listen_for_contact_with,
	};
})();


module.exports = PhysicsController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "PhysicsController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\RegisterAsController.js":[function(require,module,exports){

var RegisterAsController = (function(){
	/* Allows you to register object as something,
	 * for other modules to access
	 * One use could be registering newly generated terrain slice from the slice controller,
	 * for the GraphicsController to notice and generate graphics for it
	*/

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

	};

	var update = function(delta){
		/* is ran each tick from the GameController.update_all */

		// TODO: automatically delete stuff depending on timeout stuff
		// calculate timeout of 
	};

	var register_as = function(what, obj){
		/**
		* simple one time lookup registering of object
		* >what< - string. e.g. "new_terrain_slice"
		* >obj< - object to register
		*/
		
		var table = RegisterAsModel.simple_one_time_lookup;

		if(table[what]){
			table[what].push(obj);
		}else{
			table[what] = [obj];
		}
	};

	var retrieve_registered_as = function(what){
		/**
		* returns reference to the object contatining
		* things currently registered as >what<
		* you are responsible for popping (or not popping) them
		* from the array to no longer consieder (or continue to consider)
		* them as registered as >what<
		*/
		var list = RegisterAsModel.simple_one_time_lookup[what];
		if(list){
			return list;
		}else{
			return [];
		}
		
	};
	
	
	return {
		// declare public
		init: init, 
		update: update,
		register_as: register_as,
		retrieve_registered_as: retrieve_registered_as
	};
})();

module.exports = RegisterAsController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "RegisterAsController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\TerrainController.js":[function(require,module,exports){

var TerrainController = (function(){
	/* this will be the physical representation of the terrain
	 * currently it contains graphical bits, but that will change
	 */

	var init = function(){
		include();
	};
	

	var update = function(){
		// check for any chunks to be unloaded/deleted will go here, for now
		// maybe it'll check for all players to be sufficiently far to the right
		// of it, maybe one chunk in advance, or smth like that
		while(TerrainModel.terrain_slices_queue.length < 4){
			var slice = NewTerrainSlice();
			TerrainModel.terrain_slices_queue.push(slice);
		};
	};


	var NewTerrainSlice = function(){
		/* this takes care of appending new terrain slice to the generated terrain
		 * it calculates it's origin x and y positions and whatever other stuff,
		 * generates slice; sets up everything
		 */

		var slice = TerrainSliceController.generate();
		MarkAsNewTerrainSlice(slice); // so that graphics and other stuff will notice

		return slice;

	};

	var retrieve_world_parameters = function(){};
	
	var for_each_tile = function(f){
		// takes function >f< that takes three parameters: tile (eseljs object),
		// terrain_lvl (int), and tile_index (int)
		// calls this function for every tile of the terrain
		
		var queues = TerrainModel.terrain_queues;

		$.each(queues, function(terrain_lvl){
			$.each(queues[terrain_lvl], function(tile_index){
				f(queues[terrain_lvl][tile_index], terrain_lvl, tile_index);
			});
		});

	};

	var move_left = function(pixels){
		// Should I scrap this function and just use >move<, or is this a helpful shortcut?
		
		move((-1)*pixels, 0);

	}; // end move_left
	
	var move = function(offset_x, offset_y){
		if(offset_x != 0){
			for_each_tile(function(tile, terrain_lvl, tile_index){
				tile.x += offset_x;
			});

		}// fi

		if(offset_y != 0){
			for_each_tile(function(tile, terrain_lvl, tile_index){
				tile.y += offset_y;
			});

		}

	};

	var MarkAsNewTerrainSlice = function(slice){
		TerrainModel.new_slices.push(slice);
	};

	var NewSlicesAvailable = function(){
		return (TerrainModel.new_slices.length > 0);
	};

	var GetNewTerrainSlices = function(){
		return TerrainModel.new_slices;
	};

	return {
		move_left: move_left,
		move: move,
		update: update,
		init: init,
		NewTerrainSlice: NewTerrainSlice,
		MarkAsNewTerrainSlice: MarkAsNewTerrainSlice,
		NewSlicesAvailable: NewSlicesAvailable,
		GetNewTerrainSlices: GetNewTerrainSlices,
	}
})();

module.exports = TerrainController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TerrainController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\TerrainSliceController.js":[function(require,module,exports){

var TerrainSliceController = (function () {

	var init = function(){
		/* is ran from the InitController once when the game is loaded */
		include(); // satisfy requirements
		IdentificationController.assign_type(TerrainSliceModel.Cell, "terrain_cell");

	};

	var update = function(slice){
		

	};

	var get_next_origin = function(){
	};

	var generate = function(){

		var slice = new TerrainSliceModel.Slice();

		slice.origin.x = slice.id * slice.grid_columns * slice.cell_w;
		slice.origin.y = 0;

		// TODO: id's in this function should be actually called types and registered accordingly

		for(var i = 0; i < slice.grid_rows; i++){
			/* 	assigning id's
				that is the first pass. later it may be used to layout general form of the terrain
			   	assigning each cell in the grid some role, marked by its id.
			 	that role may include for it to be a piece of the bigger object >>>
			*/

			slice.grid[i] = [];
			var lvl = slice.grid_rows - i; // level from the bottom
			var prob = TerrainSliceModel.lvl_prob[lvl];

			for(var j = 0; j < slice.grid_columns; j++){
				if(prob){
					var random_id = GameUtility.random_choice(prob, [1, 2, 3]); // chose random terrain tile id
					// the tile in the grid might be made to be separate object later
					// the tile_id will determine the type of object in that tile,
					// such as type of terrain etc. the tiles with different id's do not
					// necessarily differ in physics representation, they might just have
					// different appearance
					slice.grid[i][j] = new TerrainSliceModel.Cell(random_id);
				}else{
					// 0 will be the id for the "air" i.e. nothing
					slice.grid[i][j] = new TerrainSliceModel.Cell(0);
				}
			} // for end
			// <<< assigning ids
			
		} // for end


		for(var i = 0; i < slice.grid_rows; i++){
			/*	creating physics representations
			 *	2nd pass; this will be used to create all the objects and such
			 *	physics-wise. It may examine id's of the adjacent tiles to find
			 *	larger pieces of terrain to unite under the common bounding box
			 *	if they have similar enough properties or belong together for some reason
			 */

			var lvl = slice.grid_rows - i; // level from the bottom

			for(var j = 0; j < slice.grid_columns; j++){
				var id = slice.grid[i][j].id;
				if(id != 0){ // if not air
					var x = slice.origin.x + j * slice.cell_w + slice.cell_w/2;
					var y = slice.origin.y + i * slice.cell_w + slice.cell_w/2;
					var body = PhysicsController.get_rectangular({x: x, y: y}, slice.grid[i][j]);
					slice.grid[i][j].body = body;
				}

			} // end for

		}//end for
		
		return slice;
	};

	return {
		// declare public
		init: init, 
		update: update,
		generate: generate,
	};
})();

module.exports = TerrainSliceController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TerrainSliceController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\TestController.js":[function(require,module,exports){
var TestController = (function(){
	// placeholder for implementing testing
	// may be changed/removed/upgraded depending on how we will handle our tests
	
	
	var preinit_tests = function(){
	//For tests requiring run before init is called
	
	
	};
	
	
	var test = function(){
		// if you need some sort of tests launched, this is one of the places to do it
		QUnit.test( "hello test", function( assert ) {
			assert.ok( 1 == "1", "Passed!" );
		});
		Includes.automated_tests();
	};

	var post_loading_tests = function(){
		// TODO: call when loading assets is completed if there are some tests that need
		// to be done at that moment. (Refer to InitController.init and 
		// InitController.setup_asset_dependent methods
	};

	var init = function(mode){
		include();
		// Sets up the debug canvas during testing
		TestModel.d_canvas = document.getElementById(Config.DEBUG_CANVAS_NAME);

		if(mode == "test"){
			TestModel.context = TestModel.d_canvas.getContext("2d");
			
			TestModel.debugDraw = new B2d.b2DebugDraw();
			TestModel.debugDraw.SetSprite(TestModel.context);
			TestModel.debugDraw.SetDrawScale(Config.B2D.SCALE);
			TestModel.debugDraw.SetFillAlpha(0.3);
			TestModel.debugDraw.SetLineThickness(1.0);
			TestModel.debugDraw.SetFlags(B2d.b2DebugDraw.e_shapeBit | B2d.b2DebugDraw.e_jointBit);

			PhysicsController.set_debug_draw(TestModel.debugDraw);

			Config.B2D.debug_draw = true;
			// Screen_W was setup only after this was called

			TestModel.d_canvas.width = Config.SCREEN_W;
			TestModel.d_canvas.height = Config.SCREEN_H;

			//$('#'+Config.DEBUG_CANVAS_NAME).show();

		}else{
			//d_canvas.hide();
		}
	};
	
	//this function sets the x and y offsets of the debug canvas
	var set_debug_offset = function(x_offset, y_offset){
		context = TestModel.context;
		context.save();
		context.clearRect(0, 0, Config.SCREEN_W, Config.SCREEN_H);
		context.translate(x_offset, y_offset);
		PhysicsController.draw_debug();
		context.restore();
	};

	return {
		init: init, 
		test: test,
		post_loading_tests: post_loading_tests,
		preinit_tests: preinit_tests,
		set_debug_offset: set_debug_offset
	}
})();

module.exports = TestController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TestController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\WorldController.js":[function(require,module,exports){
	
var WorldController = (function(){
	/* all the physics control of the whole world
	*/

    var body_test;
    var body_test2;
	//var temp = 0;

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

		body_test = PhysicsController.get_rectangular({}, "test");
		body_test2 = PhysicsController.get_rectangular({}, "platform");
	};

	var update = function(delta){
		/* is ran each tick from the GameController.update_all */
		PhysicsController.step(delta);

		//if(temp++ == 0){
			//TerrainController.NewTerrainSlice();
		//}

	};

	var MarkAsNewTerrainSlice = function(slice){
		
	};

	return {
		// declare public
		init: init, 
		update: update,
	};
})();

module.exports = WorldController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "WorldController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\GameUtility.js":[function(require,module,exports){
var GameUtility = (function()
{
  function arrow_key_scrolling(flag) {
    // Configures arrow key scrolling for canvas
    if (flag == false) {
      document.addEventListener('keydown', function (e) { // .getElementById("display_canvas")
        arrows = [37, 38, 39, 40];
        if (arrows.indexOf(e.keyCode) > -1) {
          e.preventDefault();
          return false;
        } else {
          return true
        }
      })
    }
  }

	var lg = function()
	{
		/*
		 * shortcut to console.log()
		 * prints all arguments to console
		 * first argument is used as a label for the rest
		 *
		 * each labeled group is enclosed into the colored delimiters
		 * >>> and <<< so it's easily distinguished. I found it helpful,
		 * if you don't let me know, or use something else
		 */
		console.log("%s %c %s", arguments[0], "background: #DAF2B1", ">>>");
		
		for(var i = 1; i < arguments.length; i++)
		{
			console.log("\t", arguments[i]);
		}
		console.log("%c<<<", "background: #DAF2B1");

	};

	var random_choice = function(probabilities, choices){
		/*
		   takes 2 arrays with elements at corresponding indexes
		   being choice and it's probability. picks random one.
		   choices are anything, probability is integer a, such that
		   probability of a choice is a/10. with a < 10, of course
		   and probabilities adding up to 10. 
		   Yes, it's not very good implementation (read: terrible), 
		   and since you noticed, now it's your job to improve it.

		*/

		// array with choices duplicated a proper amount of times based on
		// their probability
		var blah = []; 

		for(var i = 0; i < choices.length; i++){
			for(var j = 0; j < probabilities[i]; j++){
				blah.push(choices[i]);
			}
		}

		var rand_index = Math.floor(Math.random() * blah.length);

		return blah[rand_index];
	};

	

	return {
		lg: lg,
		random_choice: random_choice
	};

})();

module.exports = GameUtility;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js":[function(require,module,exports){
var Include = function(){

	var modules;

	// simple enumerator // option codes MUST be power of 2 or sum of other options (with 0 being the only exception), and unique
	var choices = (function(){
		// simple options: numberic value must be 0 or some power of 2, name should be all caps and unique
		var result = {NONE: 0, ALL_CONTROLLERS: 1, ALL_MODELS: 2, OWN_MODEL: 4, OTHER_STUFF: 8, RENDERERS: 16, LOGIC: 32};

		// complex options: should consist of simple options, bitwise(!) OR'ed or AND'ed together in any fashion
		result.DEFAULT = (result.ALL_CONTROLLERS | result.OWN_MODEL | result.OTHER_STUFF);
		result.ALL =  (result.ALL_CONTROLLERS | result.ALL_MODELS | result.OTHER_STUFF); 

		// object is immutable
		return Object.freeze(result);
	})();

	var module_names = {
		Controllers: [
			"AssetController",
			"EnemyController",
			"GameController",
			"GraphicsController",
			"InitController",
			"KeyboardController",
			"PhysicsController",
			//"PlayerController",
			"TerrainController",
			"TerrainSliceController",
			"TestController",
			"WorldController",
			//"AntController",
			"IdentificationController",
			"RegisterAsController",
		],

		Models: [
		
			"AssetModel",
			"GameModel",
			"GraphicsModel",
			"KeyboardModel",
			"PhysicsModel",
			//"PlayerModel",
			"TerrainModel",
			"TerrainSliceModel",
			"TestModel",
			"WorldModel",
			//"AntModel",
			"EnemyModel",
			"RegisterAsModel",
		],

		Other: [
		
			"B2d",
			"Box2D",
			"Config",
			"GameUtility",
		],

		Renderers: [
			"AntRenderer",
			"HeroRenderer",
		],

		Logic: [
			"AntLogic",
			"HeroLogic",
		],

	};//end module_names


	var init = function(){

		modules = {
			AssetController: require("./Controllers/AssetController.js"),
			GraphicsController: require("./Controllers/GraphicsController.js"),
			KeyboardController: require("./Controllers/KeyboardController.js"),
			PhysicsController: require("./Controllers/PhysicsController.js"),
			//PlayerController: require("./Controllers/PlayerController.js"),
			TerrainController: require("./Controllers/TerrainController.js"),
			TerrainSliceController: require("./Controllers/TerrainSliceController.js"),
			WorldController: require("./Controllers/WorldController.js"),
			InitController: require("./Controllers/InitController.js"),
			TestController: require("./Controllers/TestController.js"),
			GameController: require("./Controllers/GameController.js"),
			EnemyController: require("./Controllers/EnemyController.js"),
			//AntController: require("./Controllers/AntController.js"),
			IdentificationController: require("./Controllers/IdentificationController.js"),
			RegisterAsController: require("./Controllers/RegisterAsController.js"),
			
			
			
			// Models

			GameModel: require("./Models/GameModel.js"),
			TerrainSliceModel: require("./Models/TerrainSliceModel.js"),
			AssetModel: require("./Models/AssetModel.js"),
			PhysicsModel: require("./Models/PhysicsModel.js"),
			GraphicsModel: require("./Models/GraphicsModel.js"),
			TerrainModel: require("./Models/TerrainModel.js"),
			WorldModel: require("./Models/WorldModel.js"),
			KeyboardModel: require("./Models/KeyboardModel.js"),
			//PlayerModel: require("./Models/PlayerModel.js"),
			TestModel: require("./Models/TestModel.js"),
			//AntModel: require("./Models/AntModel.js"),
			IdentificationModel: require("./Models/IdentificationModel.js"),
			EnemyModel: require("./Models/EnemyModel.js"),
			RegisterAsModel: require("./Models/RegisterAsModel.js"),
			
			
			
				
			// Other stuff
			
			Config: require("./Config.js"),
			GameUtility: require("./GameUtility.js"),
			B2d: require("./B2d.js"),
			Box2D: require("box2dweb"),
			
			// Renderers
			
			AntRenderer: require("./Renderers/AntRenderer.js"),
			HeroRenderer: require("./Renderers/HeroRenderer.js"),
			

			// Logic
			AntLogic: require("./Logic/AntLogic.js"),
			HeroLogic: require("./Logic/HeroLogic.js"),
			
			

		};

	}; // end init

	var option_is_set = function(what_mods_selected, options){
		if(what_mods_selected == 0 && options == 0){
			return true;
		}
		// be mindful of bitwise operator ahead
		return (what_mods_selected & options);
	};//end option_is_set

	var get_module = function(name){
		// can be modified to throw object error instead of simple one
		// in that case it may contain list of difined modules
		// may also be modified to check whether module is missing from 
		// module_names, modules, or both, and give more accurate description
		var message = "Module " + name + 
			" is undefined. Note that you must hardcode all new modules" + 
			" into the Includes.module_names AND Includes.modules."
		
		if(modules){
			if(modules[name]){
				return modules[name];
			}else if(console.warn){ // check if console.warn is available
				console.warn(message);
			}else{
				throw message;
			}
		}else{
			throw "Error: You must run the Includes.init() before you can use any modules";
		}
	};//end get_module
	

	var get_names = function(current_module_name, options_code){
		var result = {Models: [], Controllers: [], Other: [], Renderers: [], Logic: [],};

		if(option_is_set(choices.NONE, options_code)){
			return result;
		}

		if (option_is_set(choices.ALL_CONTROLLERS, options_code)){

			var controller_names = module_names.Controllers;

			for(var i = 0; i < controller_names.length; i++){

				var ctl_name = controller_names[i];

				if(ctl_name != current_module_name){
					result.Controllers.push(ctl_name);
				}
			}
			
		}

		if (option_is_set(choices.ALL_MODELS, options_code)){
			result.Models = module_names.Models;
		}else if(option_is_set(choices.OWN_MODEL, options_code)){
			var own_model = current_module_name.replace("Controller", "Model");
			result.Models.push(own_model);
		}

		if(option_is_set(choices.OTHER_STUFF, options_code)){
			result.Other = module_names.Other;
		}

		if(option_is_set(choices.RENDERERS, options_code)){
			result.Renderers = module_names.Renderers;
		}

		if(option_is_set(choices.LOGIC, options_code)){
			result.Logic = module_names.Logic;
		}

		return result;
	};//end get_names

	var sections = ["Models", "Controllers", "Other", "Renderers", "Logic"];
	var get_name_statements = function(names){
		var result = "";
		for(var section_index = 0; section_index < sections.length; section_index++){
			var section = sections[section_index];
			for(var i = 0; i < names[section].length; i++){
				result += ("var " + names[section][i] + "; ");
			}
		}

		return result;
		
	};//end get_name_statements

	var get_module_statements = function(names){
		var result = "";
		for(var section_index = 0; section_index < sections.length; section_index++){
			var section = sections[section_index];
			for(var i = 0; i < names[section].length; i++){
				result += (names[section][i] + " = Includes.get_module(\"" + names[section][i] + "\"); ");
			}
		}

		return result;
	};//end get_module_statements

	var get_include_data = function(params){
		var current_module = params.current_module;
		var include_options = params.include_options;
		var names = get_names(current_module, include_options);

		var name_statements = get_name_statements(names);
		var module_statements = get_module_statements(names);

		return {
			imported_modules: names,
			name_statements: name_statements,
			module_statements: module_statements,
		};

	};//end get_include_data

	var automated_tests = function(){
		
		QUnit.test("option matching function", function( assert) {

			//If both are none
			assert.equal(option_is_set(choices.NONE, choices.NONE), true);

			assert.throws(option_is_set(choices.NONE, -1));

			//If both match, it returns the value of choices
			//If they don't match, it returns 0
			
			//MATCH
			assert.equal(option_is_set(choices.ALL_CONTROLLERS, choices.ALL_CONTROLLERS), 1);
			assert.equal(option_is_set(choices.ALL_MODELS, choices.ALL_MODELS), 2);
			assert.equal(option_is_set(choices.OTHER_STUFF, choices.OTHER_STUFF), 8);

			//Mismatch
			assert.equal(option_is_set(choices.NONE, choices.ALL_CONTROLLERS), 0);
			assert.equal(option_is_set(choices.OTHER_STUFF, choices.NONE), 0);
			assert.equal(option_is_set(choices.ALL_MODELS, choices.ALL_CONTROLLERS), 0);
			assert.equal(option_is_set(choices.OWN_MODEL, choices.ALL_MODELS), 0);
		});//end option matching test
		
	};//end automated_tests


	return {
		init: init,
		module_names: module_names,
		get_module: get_module,
		get_include_data: get_include_data,
		choices: choices,
		automated_tests: automated_tests
	};

};

module.exports = new Include;


},{"./B2d.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\B2d.js","./Config.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Config.js","./Controllers/AssetController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\AssetController.js","./Controllers/EnemyController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\EnemyController.js","./Controllers/GameController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\GameController.js","./Controllers/GraphicsController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\GraphicsController.js","./Controllers/IdentificationController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\IdentificationController.js","./Controllers/InitController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\InitController.js","./Controllers/KeyboardController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\KeyboardController.js","./Controllers/PhysicsController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\PhysicsController.js","./Controllers/RegisterAsController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\RegisterAsController.js","./Controllers/TerrainController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\TerrainController.js","./Controllers/TerrainSliceController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\TerrainSliceController.js","./Controllers/TestController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\TestController.js","./Controllers/WorldController.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Controllers\\WorldController.js","./GameUtility.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\GameUtility.js","./Logic/AntLogic.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Logic\\AntLogic.js","./Logic/HeroLogic.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Logic\\HeroLogic.js","./Models/AssetModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\AssetModel.js","./Models/EnemyModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\EnemyModel.js","./Models/GameModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\GameModel.js","./Models/GraphicsModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\GraphicsModel.js","./Models/IdentificationModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\IdentificationModel.js","./Models/KeyboardModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\KeyboardModel.js","./Models/PhysicsModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\PhysicsModel.js","./Models/RegisterAsModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\RegisterAsModel.js","./Models/TerrainModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\TerrainModel.js","./Models/TerrainSliceModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\TerrainSliceModel.js","./Models/TestModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\TestModel.js","./Models/WorldModel.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\WorldModel.js","./Renderers/AntRenderer.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Renderers\\AntRenderer.js","./Renderers/HeroRenderer.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Renderers\\HeroRenderer.js","box2dweb":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\node_modules\\box2dweb\\box2d.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Logic\\AntLogic.js":[function(require,module,exports){
var AntAI = (function(){

	var Ant = function(){
		//define your constants here
		this.H = 31;//height
		this.W = 50;
		this.sprite_array = [];  //single source for sprites
		
		this.hero_hurt_me = false;
		this.me_hurt_hero = false;
		this.death_tick = 0;

		//set your game logic parameters here
		//this.object_id = 1; //hardcode a unique identifier for each new enemy class
		this.hp = 2;
		this.speed = 4;
		this.damage = 1;
		//this.attack_cooldown = 4; //use this for enemies who need
		this.can_attack = true;//use this for enemies who alternate between 
		//this.cooldown_timer=-1;
		this.AI_state = "walk";//use this to keep track of the enemy's AI state
	};

	var IdentificationController, PhysicsController, RegisterAsController;

	var init = function(imports){
		/**
		* initialize and register stuff
		*/

		IdentificationController = imports.IdentificationController;
		PhysicsController = imports.PhysicsController;
		RegisterAsController = imports.RegisterAsController;

		IdentificationController.assign_type(Ant, "ant");	
	};
	

	var spawn = function(x, y){
		/**
		* spawn ant
		*/

		var new_ant = new Ant();
		var id = IdentificationController.assign_id(new_ant);

		new_ant.body = PhysicsController.get_rectangular({x: x, y: y, border_sensors: true}, new_ant);	

		// listen for type, put shit into the EnemyController
		PhysicsController.listen_for_contact_with(id, "BeginContact", begin_contact);
		
		return new_ant;

	};
	
	var wound_ant = function(ant, wound){

		ant.hp -= wound;
	}

	var tick_AI = function(ant, Stuff){
		/**
		* tick the AI for the given ant
		* gets instance of the ant and
		* >Stuff< which is object containing functions you need
		* and other stuff
		*/

		//if enemy is dead, die
		if (ant.hp == 1) {
			
			if (ant.hero_hurt_me)
			{
				wound_ant(ant, 1);
				ant.hero_hurt_me = false;
			}
		} 
		else if (ant.hp <= 0 && ant.death_tick == 30) {
			//ant.ant.DestroyFixture();
			ant.death_tick++;
		}
		else if (ant.hp <= 0 && ant.death_tick > 30){}
		else if (ant.hp <= 0) {
			
			change_state(ant, "death");
			ant.death_tick++;
		}
		//else move & attack
	
		else {

			if (ant.AI_state == "walk") {
				var Antbody = ant.body;
				var velocity = Antbody.GetLinearVelocity();
				velocity.x = -ant.speed;
				Antbody.SetLinearVelocity(velocity); // body.SetLinearVelocity(new b2Vec2(5, 0)); would work too
				Antbody.SetAwake(true);
			}
			if (ant.can_attack && ant.me_hurt_hero && model.AI_state == "walk") 
			{

				
			}
			if (ant.hero_hurt_me)
			{
				wound_ant(ant, 1);
				ant.hero_hurt_me = false;
				change_state(ant, "upside_down");
			}
		}
	
	};
	
	var change_state = function(ant, progress_state) {
		ant.AI_state = progress_state;

	}

	// // //Set up Collision handler
	
	
	var begin_contact = function(contact, info){
		//handle collisions here
		
		//console.log(info.Me.id, ":", "My fixture", "'" + info.Me.fixture_name + "'", "came into contact with fixture", 
			//"'" + info.Them.fixture_name + "'", "of", info.Them.id);

		
		//var mean_hero;
		//if(info.A.body_id == "hero")
		//{
			//mean_hero = info.A;
			//if(mean_hero.fixture != "bottom sensor" && AntModel.can_attack)
			//{
				//ant.me_hurt_hero = true;
			//}	
			//else
			//{

				//AntModel.hero_hurt_me = true;
			//}
		//}
		//else if(info.B.body_id == "hero")
		//{
			//mean_hero = info.B;
			//if(mean_hero.fixture != "bottom sensor" && AntModel.can_attack)
			//{
				//ant.me_hurt_hero = true;
			//}	
			//else
			//{

				//AntModel.hero_hurt_me = true;
			//}
		//}
	};

	var end_contact = function(contact, oldManifold, info) {

			AntModel.ants[info.Me.id].me_hurt_hero = false;

	};

	return {
		tick_AI: tick_AI,
		spawn: spawn,
		init: init,
		end_contact: end_contact,
		begin_contact: begin_contact
	};
})();

module.exports = AntAI;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Logic\\HeroLogic.js":[function(require,module,exports){
var AntAI = (function(){

	this.Player = function(){
		this.hp = 100;
		this.wound = false;
		this.jumps = 0;
	}

	var IdentificationController, PhysicsController, RegisterAsController, KeyboardController, B2d;
	var hero;

	var init = function(imports){
		/**
		* initialize and register stuff
		*/
		IdentificationController = imports.IdentificationController;
		PhysicsController = imports.PhysicsController;
		RegisterAsController = imports.RegisterAsController;
		KeyboardController = imports.KeyboardController;
		B2d = imports.B2d;


		IdentificationController.assign_type(Player, "hero");	

	};
	

	var spawn = function(x, y){
		var hero = new Player();

		hero.body = PhysicsController.get_rectangular({x: x, y: y, border_sensors: true}, hero);

		hero.hp = 100;
		hero.wound = false;
		hero.jumps = 0;


		return hero;
	};
	
	var tick_AI = function(entity){

		hero = entity;
		
		var cmds = KeyboardController.movement_commands();

		var MOVEMENT_EDGE = 500; // where terrain start scrolling


		if(cmds("right")){
		    // temporary

		    move_right(hero);
		}
		if(cmds("left")){
			// temporary
		    
		    move_left(hero);
		}

		if(cmds("up")){
			jump(hero);
		}
		if(hero.wound)
		{
			hero.hp--;
			console.log("Taking damage");
			GraphicsController.update_health(hero.hp);
		}
		
		if(hero.hp <= 0)
		{
			createjs.Ticker.paused = true;
			console.log("Player Is Dead");
		}
	
	};

	var begin_contact = function(contact, info){
		//console.log(info.Me.id, ":", "My fixture", "'" + info.Me.fixture_name + "'", "came into contact with fixture", 
			//"'" + info.Them.fixture_name + "'", "of", info.Them.id);
		console.log("here");
		
		if (info.Me.fixture_name == "bottom"){
			info.Me.entity.jumps = 0;
		}
		if (info.Me.fixture_name == "top"){
			take_hit(info.Me.entity, 1);
		}
				
	};

	var take_hit = function(hero, amount){
		hero.hp -= amount;
		GraphicsController.update_health(hero.hp);
	}

	var end_contact = function(contact, info){
			
		info.Me.entity.wound = false;
	};

	var move_right = function(hero){
		var body = hero.body;
		var velocity = body.GetLinearVelocity();
		velocity.x = 5;
		body.SetLinearVelocity(velocity); // body.SetLinearVelocity(new b2Vec2(5, 0)); would work too
		body.SetAwake(true);
		//hero.x += 10; // old
		//hero.x = (body.GetPosition().x + 1.5/2) * 30 ; 
	};

	var jump = function(hero){
	    var body = hero.body;
		if (hero.jumps == 0){
		    body.ApplyImpulse(new B2d.b2Vec2(0, -100), body.GetWorldCenter());
		    hero.jumps += 1;
		}
		else if (hero.jumps == 1 && body.GetLinearVelocity().y > -1) {
		    body.ApplyImpulse(new B2d.b2Vec2(0, -100), body.GetWorldCenter());
		    hero.jumps += 1;
		}

		//hero.y = body.GetPosition().y * 30;
	
	};

	var set_coordinates = function(position_vector){
		// TODO: remove;
		// temporary/testing
		hero.x = (position_vector.x - 1.5/2) * 30 ;
		hero.y = (position_vector.y + 2.5/2) * 30 ;

	};

	var b2b_get_coordinates = function(){
		return hero.body.GetWorldCenter();
	};

	var move_left = function(){
		var velocity = hero.body.GetLinearVelocity();
		velocity.x = -5;
		hero.body.SetLinearVelocity(velocity); // hero.SetLinearVelocity(new b2Vec2(5, 0)); would work too
		hero.body.SetAwake(true);
	};

	var move_right = function(){
		var velocity = hero.body.GetLinearVelocity();
		velocity.x = +5;
		hero.body.SetLinearVelocity(velocity); // hero.SetLinearVelocity(new b2Vec2(5, 0)); would work too
		hero.body.SetAwake(true);
	};

	var move = function(offset_x, offset_y){
		// unimplemented
		// should it hard-set position (not safe!)
		// or just allow to set any velocity/impulse vector?
	};



	return {
		tick_AI: tick_AI,
		spawn: spawn,
		init: init,
		begin_contact: begin_contact,
		end_contact: end_contact,
	};
})();

module.exports = AntAI;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\AssetModel.js":[function(require,module,exports){
var AssetModel = new function(){
	// As always, almost anything is initialized in the InitController
	
	this.loader;

	this.manifest = [ // defining resources to be loaded in bulk with preload.js
			{src: "greek_warrior.png", id: "greek_warrior"},
			//{src:, id:},
			{src: "middle_terrain.png", id:"middle_terrain"},
			{src: "bottom_terrain.png", id: "bottom_terrain"},
			{src: "grass.png", id: "grass"},
			{src: "AntChompers.png", id: "Ant1"},
			{src: "AntChompers2.png", id: "Ant2"},
			{src: "AntChompersDeath.png", id: "Ant3"}
		]; 
		// TODO make adding resources easier? Automatic loading 
		// of everything from assets, automatic names etc.?

	this.shapes = {}; // maybe this aren't needed

	this.bitmaps = {};

	this.animations = {};

};

module.exports = AssetModel;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\EnemyModel.js":[function(require,module,exports){
var EnemyModel = function(){	
	// associates type with the AI
	this.type_to_AI = {};

	// DEPRECATED
	this.ants = {};

	this.for_logic_update = {}; // key: type, value: array of objects

};

module.exports = new EnemyModel;


},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\GameModel.js":[function(require,module,exports){
var GameModel = new function(){ // main model

};

module.exports = GameModel;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\GraphicsModel.js":[function(require,module,exports){
var GraphicsModel = function(){
	this.stage; // main stage to where everything will be drawn
	// note that every graphics object must be augmented with
	// the reference to the corresponding physics object, if any
	this.hero;
	this.other_players = []; // array of players other then hero for multiplayer
	this.ant;
    //PIZZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	this.health;
	this.score;
	// all object registered for continious update to match their physical body
	// position 
	this.all_physical = []; 
	this.special_render = {}; // matches type with array of all objects of that type to be rendered

	// all spritesheet definitions (added at the initialization stage
	// because they need assets to be loaded)
	this.spritesheets = {}; 

	this.camera = {
		// should be easeljs object or null
		following: null,

		// internal camera implementation thing to know how far to offset from the
		// initial position
		offset: {x: 0, y: 0},

		// the offset of the camera from the followed object
		// e.g. offset of {x: 100, y: 100} will center camera
		// 100 pixels to the right and 100 pixels below the followed object
		offset_from_followed: {x: 400, y: -100},
		//offset_from_followed: {x: 330, y: -205}, //FOR GAME PAGE
		// this is center of the screen in pixels. gets dynamically recalculated 
		// during the camera update so if it's ever changed, camera still works as expected
		center: {x: 0, y: 0}

	};

};

module.exports = new GraphicsModel;


},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\IdentificationModel.js":[function(require,module,exports){

var IdentificationModel = function(){
	
	// next unique id to be given if not free id's remain
	this.next_id = 0;

	// array of free id's. push when freed, pop when free id is needed
	// if array is empty, get next id using >next_id<
	this.free_ids = [];

	// array matches ids to their corresponding objects
	this.id_matching = [];

	// registry of types to make sure that no type is registerd twice
	// and enable people to get the model by type name
	this.types = {}
};

module.exports = new IdentificationModel;



},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\KeyboardModel.js":[function(require,module,exports){
var KeyboardModel = function(){
	this.keys = {};

	this.translation_tables = {
		code_to_name: {
			8:   "backspace", //  backspace
			9:   "tab", //  tab
			13:  "enter", //  enter
			16:  "shift", //  shift
			17:  "ctrl", //  ctrl
			18:  "alt", //  alt
			19:  "pause/break", //  pause/break
			20:  "caps lock", //  caps lock
			27:  "escape", //  escape
			33:  "page up", // page up, to avoid displaying alternate character and confusing people
			34:  "page down", // page down
			35:  "end", // end
			36:  "home", // home
			37:  "left arrow", // left arrow
			38:  "up arrow", // up arrow
			39:  "right arrow", // right arrow
			40:  "down arrow", // down arrow
			45:  "insert", // insert
			46:  "delete", // delete
			48:  "0",
			49:  "1",
			50:  "2",
			51:  "3",
			52:  "4",
			53:  "5",
			54:  "6",
			55:  "7",
			56:  "8",
			57:  "9",
			65:  "a",
			66:  "b",
			67:  "c",
			68:  "d",
			69:  "e",
			70:  "f",
			71:  "g",
			72:  "h",
			73:  "i",
			74:  "j",
			75:  "k",
			76:  "l",
			77:  "m",
			78:  "n",
			79:  "o",
			80:  "p",
			81:  "q",
			82:  "r",
			83:  "s",
			84:  "t",
			85:  "u",
			86:  "v",
			87:  "w",
			88:  "x",
			89:  "y",
			90:  "z",
			91:  "left window", // left window
			92:  "right window", // right window
			93:  "select key", // select key
			96:  "numpad 0", // numpad 0
			97:  "numpad 1", // numpad 1
			98:  "numpad 2", // numpad 2
			99:  "numpad 3", // numpad 3
			100: "numpad 4", // numpad 4
			101: "numpad 5", // numpad 5
			102: "numpad 6", // numpad 6
			103: "numpad 7", // numpad 7
			104: "numpad 8", // numpad 8
			105: "numpad 9", // numpad 9
			106: "multiply", // multiply
			107: "add", // add
			109: "subtract", // subtract
			110: "decimal point", // decimal point
			111: "divide", // divide
			112: "F1", // F1
			113: "F2", // F2
			114: "F3", // F3
			115: "F4", // F4
			116: "F5", // F5
			117: "F6", // F6
			118: "F7", // F7
			119: "F8", // F8
			120: "F9", // F9
			121: "F10", // F10
			122: "F11", // F11
			123: "F12", // F12
			144: "num lock", // num lock
			145: "scroll lock", // scroll lock
			186: ";", // semi-colon
			187: "=", // equal-sign
			188: ",", // comma
			189: "-", // dash
			190: ".", // period
			191: "/", // forward slash
			192: "`", // grave accent
			219: "[", // open bracket
			220: "\\", // back slash
			221: "]", // close bracket
			222: "'", // single quote
		},

		movement: {
			"left arrow": "left",
			"up arrow": "up",
			"down arrow": "down",
			"right arrow": "right",
		},
		
		debug: {
			"a": "spawn_ant",
		},

	}


};

module.exports = new KeyboardModel;


},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\PhysicsModel.js":[function(require,module,exports){

var PhysicsModel = function() {
	
	this.gravity;
	this.world;
 
	// getting context of the debug canvas, for box2d to draw debuggin boxes

	// timeToCover is the time that simulation must cover to catch up to the real world time;
	// since createjs ticker is what we use for timing, and box2d ticks
	// must be of constant length and independent from the graphics framerate,
	// we keep track of time that passed since last box2d step by adding time deltas
	// to the timeToCover. Then, when timeToCover exceeds desired box2d step length,
	// we perform the step and subtract the corresponding time from the timeToCover;
	// If anything is still unclear, ask me (AK);
		this.timeToCover = 0; 

	this.step_amount;

	this.awaiting_contact = {
		PreSolve: {},
		PostSolve: {},
		BeginContact: {},
		EndContact: {},
	};

}; 

/*
 * Parameters for b2d body definition
	active: true
	allowSleep: true
	angle: 0
	angularDamping: 0
	angularVelocity: 0
	awake: true
	bullet: false
	fixedRotation: false
	inertiaScale: 1
	linearDamping: 0
	linearVelocity: b2Vec2
	position: b2Vec2
	type: 0
	userData: null
*/

/*
 * Fixture definition parameters:
	density: 0
	filter: b2FilterData
	friction: 0.2
	isSensor: false
	restitution: 0
	shape: null
	userData: null
 */

// rectangular
PhysicsModel.prototype.r_templates = r_templates = {};
// circular
PhysicsModel.prototype.c_templates = c_templates = {};
// polygonal
PhysicsModel.prototype.p_templates = p_templates = {};



r_templates["default"] = {

	//shape: "rectangle", // implied from the template type
	x: 3,
	y: 3,
	vx: 0,
	vy: 0,

	width: 5,
	height: 5,
	density: 2,
	friction: 1,
	restitution: 0.2,
	isSensor: false,


	active: true,
	allowSleep: true,
	angle: 0,
	angularVelocity: 0,
	awake: true,
	bullet: false,
	fixedRotation: false,
	type: "dynamic",

};

r_templates.living = {
	fixedRotation: true,
	awake: true,
	isSensor: false,
	//mobexp++
};

r_templates.terrain_cell = {
	type: "static",
	width: 1,
	height: 1,
	//mobexp++
};

r_templates.hero = {
	parent: r_templates.living,
	width: 1.5,
	height: 2.5,
	type: "dynamic",
	//mobexp++
};

r_templates.ant = {
	parent: r_templates.living,
	width: 1,
	height: 0.5,
	type: "dynamic",
	x: 40,
	y: 10,
	//mobexp++
};

r_templates.test = {
	width: 1,
	height: 2,
	fixedRotation: false,
	//mobexp++
}

r_templates.platform = {
    x: 10,
    y: 11,
    width: 10,
    height: .5,
    type: "static",
}

module.exports = new PhysicsModel;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\RegisterAsModel.js":[function(require,module,exports){
var RegisterAsModel = function(){
	
	// register stuff for one time lookup
	// the one requesting stuff is supposed to pop the each examined element
	// there is no timeouts or automatic cleanup
	this.simple_one_time_lookup = {};
};

module.exports = new RegisterAsModel;


},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\TerrainModel.js":[function(require,module,exports){
var TerrainModel = function(){
	//This is physics, for graphics look into the GraphicsController/Model
	this.terrain_slices_queue = [];
	this.new_slices = [];

};

module.exports = new TerrainModel;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\TerrainSliceModel.js":[function(require,module,exports){
TerrainSliceConfig = require ("../Config.js").TerrainSlice;

var TerrainSliceModel = function(){

	this.Slice = function(){
		/**
		* slice "model" to be instantiated
		*/
		
		
		this.id = TerrainSliceConfig.next_slice_id++; // automaticall assign id and increment 

		this.grid_columns = TerrainSliceConfig.grid_columns;
		this.grid_rows = TerrainSliceConfig.grid_rows;
		this.cell_w = TerrainSliceConfig.cell_w;
		
		// grid[i][j] is the element in the i's column and j's row
		// the grid is maid to match the screen coordinates and the current box2d coordinates
		// i.e. grid[0][0] is the one in the top left corner of the terrain slice
		// do we want to change it? would it be easier to generate terrain if we start at the bottom?
		// if yes, then what makes more sense, changing coordinate systems or just switching generation
		// loops around? discuss
		//
		// notice that the grid is a terrain generation device only. once terrain slice is loaded,
		// box2d physics simulation may (and will) go nuts on it, changing whatever it wants,
		// and changes won't anyhow be reflected in the grid. to keep track of all the bodies
		// in the terrain slice, if that will be needed, other mechanisms should be used.
		// idea: have a collections of bodies by type, and setup sensor collision beams
		// at the terrain slices' boundaries to keep track of bodies flying over from one
		// terrain slice to another. Btw, Ali, I hate you for making me to type "terrain slice"
		// instead of the "chunk" 
		this.grid = [];
		
		this.origin = {x: null, y: null};

	};

	this.Cell = function(id){
		this.id = id;
		this.body;
	}
	

	
	
};

TerrainSliceModel.prototype.lvl_prob = [
	[7, 2, 1],
	[0, 7, 3],
	[0, 1, 9]
]

module.exports = new TerrainSliceModel;

},{"../Config.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Config.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\TestModel.js":[function(require,module,exports){
var TestModel = function(){

};

module.exports = new TestModel;


},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Models\\WorldModel.js":[function(require,module,exports){
var WorldModel = function(){
	
};

module.exports = new WorldModel;


},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Renderers\\AntRenderer.js":[function(require,module,exports){
var AntRenderer = (function(){
	// TODO: mechanism for easy finding of new ants to render

	var spritesheets = {};

	var init = function(InitGraphics){
		/**
		* will be called once when game is loaded from the GraphicsController.init
		* initialize you animation definitions and other stuff here
		* >InitGraphics< contains graphics functions needed (and available) during initialization
		*/
		var get_asset = InitGraphics.get_asset;

		spritesheets["ant"] = new createjs.SpriteSheet({
			"framerate": 1,
			"images": [get_asset("Ant1"), get_asset("Ant2"), get_asset("Ant3")],
			"frames": { "regX": 3, "regY": 6, "height": 25, "width": 50, "count": 6},
			"animations": {
				"walk": [0, 1, "walk"],
				"upside_down": [2, 3, "upside_down"],
				"death": [4, 5, "death"]
			}
		})

	};
	
	var register = function(physical_instance, Graphics){
		/**
		* this is called when new ant is first registered in graphics controller
		* you are responsible for registering it for rendering etc.
		* >Graphics< object gives you access to various functions and modules you are
		* allowed to use
		*/
		var ant_animation = Graphics.request_animated(spritesheets["ant"], "walk");
		Graphics.set_reg_position(ant_animation, 0, 0); // change that to adjust sprite position relative to the body
		Graphics.reg_for_render(ant_animation, physical_instance); // sets ant_animation's position to track the ant's position (updates each tick)

	};
	

	var render = function(ant, Graphics){
		/**
		* takes >ant< (the ant object) and 
		* >Graphics< which is an object containing various functions/objects
		* passed from the GraphicsController to allow you to properly render the ant
		* will be called each tick
		*/

		// TEMPORARY needs to change to some sort of 
		// spawning notification system which is general 
		// idea: check for type and call function withing individual RENDERER
		// to create needed animation
		
		ant_special_render_temp(ant); 
		

	};
	
	var ant_special_render_temp = function(ant){
		/* how to handle special render? TEMPORARY */


		if(ant.AI_state == "death"){
			ant.gotoAndStop("death");
		}

		if(ant.AI_state == "upside_down")
		{
			ant.gotoAndPlay("upside_down");
		}

		

	};

	return {
		init: init, 
		render: render,
		register: register
	};
})();

module.exports = AntRenderer;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Renderers\\HeroRenderer.js":[function(require,module,exports){
var HeroRenderer = (function(){
	// TODO: mechanism for easy finding of new ants to render

	var spritesheets = {};

	var init = function(InitGraphics){
		/**
		* will be called once when game is loaded from the GraphicsController.init
		* initialize you animation definitions and other stuff here
		* >InitGraphics< contains graphics functions needed (and available) during initialization
		*/
		var get_asset = InitGraphics.get_asset;

	};
	
	var register = function(physical_instance, Graphics){
		/**
		* description
		*/

		var hero = Graphics.request_bitmap("greek_warrior");

		Graphics.set_reg_position(hero, -20, +10);
		Graphics.reg_for_render(hero, physical_instance);

	};
	

	var render = function(hero, Graphics){
		
	};
	

	return {
		init: init, 
		render: render,
		register: register
	};
})();

module.exports = HeroRenderer;

},{}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\main.js":[function(require,module,exports){

/*
 * Rules for working on the (client-side) game code:
 *
 * 1. If you think that one of these rules is stupid or useless, tell me, along with some better suggestions.
 *
 * 2. Model [name]Model can only be accessed through [name]Controller. If you need to do something to 
 * 		change [name]Model from [other_name]Controller, write function in the [name]Controller that does
 * 		what you need, and call it from the [other_name]Controller
 *
 * 3. Controllers are allowed to have private methods/fields. Models aren't. 
 *
 * 4. Controllers aren't allowed to have public data fields. 
 * 		Those data fields that are present must not reflect state of the game, they must be related to
 * 		some internal functionality of the controller
 *
 * 5. If you write some function that doesn't logically belong to one of the controllers,
 * 		put it in the Utility
 *
 * 6. Variables are named like that: variable_name
 * 		Except (singleton)class names, that are written like that: ClassName
 *
 * 7. And all the obvious stuff that everyone knows:
 * 		function must do one thing; don't make function public unless it needs to be that; 
 * 		comment ambigious code, for larger functions indicate their purpose (through commenting);
 */


// main namespace that is exposed to global scope (window object)
window.sidescroller_game = (function namespace(){

		var Includes = require("./Includes.js"); var include_data = Includes.get_include_data({
		current_module: "None", 
		include_options: Includes.choices.ALL_CONTROLLERS
	}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

	// Game initiation section: >>>
		
	var load_game = function(mode)
	{

		Includes.init(); // first
		include(); // second

		InitController.init(mode); // init all the stuff

		if(mode == "test"){
			TestController.test();
		}
	};


	var run = function(mode)
	{
		// done this way to ensure that load_game's internals aren't accessible to the world:
		load_game(mode);
	}; 
	
	return {
		run: run
	}; // expose function run to the world

})(); 


},{"./Includes.js":"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\Includes.js"}],"C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\node_modules\\box2dweb\\box2d.js":[function(require,module,exports){
/*
* Copyright (c) 2006-2007 Erin Catto http://www.gphysics.com
*
* This software is provided 'as-is', without any express or implied
* warranty.  In no event will the authors be held liable for any damages
* arising from the use of this software.
* Permission is granted to anyone to use this software for any purpose,
* including commercial applications, and to alter it and redistribute it
* freely, subject to the following restrictions:
* 1. The origin of this software must not be misrepresented; you must not
* claim that you wrote the original software. If you use this software
* in a product, an acknowledgment in the product documentation would be
* appreciated but is not required.
* 2. Altered source versions must be plainly marked as such, and must not be
* misrepresented as being the original software.
* 3. This notice may not be removed or altered from any source distribution.
*/
"use strict"

var Box2D = {};

(function (a2j, undefined) {
   
   function emptyFn() {};
   a2j.inherit = function(cls, base) {
      var tmpCtr = cls;
      emptyFn.prototype = base.prototype;
      cls.prototype = new emptyFn;
      cls.prototype.constructor = tmpCtr;
   };
   
   a2j.generateCallback = function generateCallback(context, cb) {
      return function () {
         cb.apply(context, arguments);
      };
   };
   
   a2j.NVector = function NVector(length) {
      if (length === undefined) length = 0;
      var tmp = new Array(length || 0);
      for (var i = 0; i < length; ++i)
      tmp[i] = 0;
      return tmp;
   };
   
   a2j.is = function is(o1, o2) {
      if (o1 === null) return false;
      if ((o2 instanceof Function) && (o1 instanceof o2)) return true;
      if ((o1.constructor.__implements != undefined) && (o1.constructor.__implements[o2])) return true;
      return false;
   };
   
   a2j.parseUInt = function(v) {
      return Math.abs(parseInt(v));
   }
   
})(Box2D);

//#TODO remove assignments from global namespace
var Vector = Array;
var Vector_a2j_Number = Box2D.NVector;
//package structure
if (typeof(Box2D) === "undefined") Box2D = {};
if (typeof(Box2D.Collision) === "undefined") Box2D.Collision = {};
if (typeof(Box2D.Collision.Shapes) === "undefined") Box2D.Collision.Shapes = {};
if (typeof(Box2D.Common) === "undefined") Box2D.Common = {};
if (typeof(Box2D.Common.Math) === "undefined") Box2D.Common.Math = {};
if (typeof(Box2D.Dynamics) === "undefined") Box2D.Dynamics = {};
if (typeof(Box2D.Dynamics.Contacts) === "undefined") Box2D.Dynamics.Contacts = {};
if (typeof(Box2D.Dynamics.Controllers) === "undefined") Box2D.Dynamics.Controllers = {};
if (typeof(Box2D.Dynamics.Joints) === "undefined") Box2D.Dynamics.Joints = {};
//pre-definitions
(function () {
   Box2D.Collision.IBroadPhase = 'Box2D.Collision.IBroadPhase';

   function b2AABB() {
      b2AABB.b2AABB.apply(this, arguments);
   };
   Box2D.Collision.b2AABB = b2AABB;

   function b2Bound() {
      b2Bound.b2Bound.apply(this, arguments);
   };
   Box2D.Collision.b2Bound = b2Bound;

   function b2BoundValues() {
      b2BoundValues.b2BoundValues.apply(this, arguments);
      if (this.constructor === b2BoundValues) this.b2BoundValues.apply(this, arguments);
   };
   Box2D.Collision.b2BoundValues = b2BoundValues;

   function b2Collision() {
      b2Collision.b2Collision.apply(this, arguments);
   };
   Box2D.Collision.b2Collision = b2Collision;

   function b2ContactID() {
      b2ContactID.b2ContactID.apply(this, arguments);
      if (this.constructor === b2ContactID) this.b2ContactID.apply(this, arguments);
   };
   Box2D.Collision.b2ContactID = b2ContactID;

   function b2ContactPoint() {
      b2ContactPoint.b2ContactPoint.apply(this, arguments);
   };
   Box2D.Collision.b2ContactPoint = b2ContactPoint;

   function b2Distance() {
      b2Distance.b2Distance.apply(this, arguments);
   };
   Box2D.Collision.b2Distance = b2Distance;

   function b2DistanceInput() {
      b2DistanceInput.b2DistanceInput.apply(this, arguments);
   };
   Box2D.Collision.b2DistanceInput = b2DistanceInput;

   function b2DistanceOutput() {
      b2DistanceOutput.b2DistanceOutput.apply(this, arguments);
   };
   Box2D.Collision.b2DistanceOutput = b2DistanceOutput;

   function b2DistanceProxy() {
      b2DistanceProxy.b2DistanceProxy.apply(this, arguments);
   };
   Box2D.Collision.b2DistanceProxy = b2DistanceProxy;

   function b2DynamicTree() {
      b2DynamicTree.b2DynamicTree.apply(this, arguments);
      if (this.constructor === b2DynamicTree) this.b2DynamicTree.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTree = b2DynamicTree;

   function b2DynamicTreeBroadPhase() {
      b2DynamicTreeBroadPhase.b2DynamicTreeBroadPhase.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTreeBroadPhase = b2DynamicTreeBroadPhase;

   function b2DynamicTreeNode() {
      b2DynamicTreeNode.b2DynamicTreeNode.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTreeNode = b2DynamicTreeNode;

   function b2DynamicTreePair() {
      b2DynamicTreePair.b2DynamicTreePair.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTreePair = b2DynamicTreePair;

   function b2Manifold() {
      b2Manifold.b2Manifold.apply(this, arguments);
      if (this.constructor === b2Manifold) this.b2Manifold.apply(this, arguments);
   };
   Box2D.Collision.b2Manifold = b2Manifold;

   function b2ManifoldPoint() {
      b2ManifoldPoint.b2ManifoldPoint.apply(this, arguments);
      if (this.constructor === b2ManifoldPoint) this.b2ManifoldPoint.apply(this, arguments);
   };
   Box2D.Collision.b2ManifoldPoint = b2ManifoldPoint;

   function b2Point() {
      b2Point.b2Point.apply(this, arguments);
   };
   Box2D.Collision.b2Point = b2Point;

   function b2RayCastInput() {
      b2RayCastInput.b2RayCastInput.apply(this, arguments);
      if (this.constructor === b2RayCastInput) this.b2RayCastInput.apply(this, arguments);
   };
   Box2D.Collision.b2RayCastInput = b2RayCastInput;

   function b2RayCastOutput() {
      b2RayCastOutput.b2RayCastOutput.apply(this, arguments);
   };
   Box2D.Collision.b2RayCastOutput = b2RayCastOutput;

   function b2Segment() {
      b2Segment.b2Segment.apply(this, arguments);
   };
   Box2D.Collision.b2Segment = b2Segment;

   function b2SeparationFunction() {
      b2SeparationFunction.b2SeparationFunction.apply(this, arguments);
   };
   Box2D.Collision.b2SeparationFunction = b2SeparationFunction;

   function b2Simplex() {
      b2Simplex.b2Simplex.apply(this, arguments);
      if (this.constructor === b2Simplex) this.b2Simplex.apply(this, arguments);
   };
   Box2D.Collision.b2Simplex = b2Simplex;

   function b2SimplexCache() {
      b2SimplexCache.b2SimplexCache.apply(this, arguments);
   };
   Box2D.Collision.b2SimplexCache = b2SimplexCache;

   function b2SimplexVertex() {
      b2SimplexVertex.b2SimplexVertex.apply(this, arguments);
   };
   Box2D.Collision.b2SimplexVertex = b2SimplexVertex;

   function b2TimeOfImpact() {
      b2TimeOfImpact.b2TimeOfImpact.apply(this, arguments);
   };
   Box2D.Collision.b2TimeOfImpact = b2TimeOfImpact;

   function b2TOIInput() {
      b2TOIInput.b2TOIInput.apply(this, arguments);
   };
   Box2D.Collision.b2TOIInput = b2TOIInput;

   function b2WorldManifold() {
      b2WorldManifold.b2WorldManifold.apply(this, arguments);
      if (this.constructor === b2WorldManifold) this.b2WorldManifold.apply(this, arguments);
   };
   Box2D.Collision.b2WorldManifold = b2WorldManifold;

   function ClipVertex() {
      ClipVertex.ClipVertex.apply(this, arguments);
   };
   Box2D.Collision.ClipVertex = ClipVertex;

   function Features() {
      Features.Features.apply(this, arguments);
   };
   Box2D.Collision.Features = Features;

   function b2CircleShape() {
      b2CircleShape.b2CircleShape.apply(this, arguments);
      if (this.constructor === b2CircleShape) this.b2CircleShape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2CircleShape = b2CircleShape;

   function b2EdgeChainDef() {
      b2EdgeChainDef.b2EdgeChainDef.apply(this, arguments);
      if (this.constructor === b2EdgeChainDef) this.b2EdgeChainDef.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2EdgeChainDef = b2EdgeChainDef;

   function b2EdgeShape() {
      b2EdgeShape.b2EdgeShape.apply(this, arguments);
      if (this.constructor === b2EdgeShape) this.b2EdgeShape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2EdgeShape = b2EdgeShape;

   function b2MassData() {
      b2MassData.b2MassData.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2MassData = b2MassData;

   function b2PolygonShape() {
      b2PolygonShape.b2PolygonShape.apply(this, arguments);
      if (this.constructor === b2PolygonShape) this.b2PolygonShape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2PolygonShape = b2PolygonShape;

   function b2Shape() {
      b2Shape.b2Shape.apply(this, arguments);
      if (this.constructor === b2Shape) this.b2Shape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2Shape = b2Shape;
   Box2D.Common.b2internal = 'Box2D.Common.b2internal';

   function b2Color() {
      b2Color.b2Color.apply(this, arguments);
      if (this.constructor === b2Color) this.b2Color.apply(this, arguments);
   };
   Box2D.Common.b2Color = b2Color;

   function b2Settings() {
      b2Settings.b2Settings.apply(this, arguments);
   };
   Box2D.Common.b2Settings = b2Settings;

   function b2Mat22() {
      b2Mat22.b2Mat22.apply(this, arguments);
      if (this.constructor === b2Mat22) this.b2Mat22.apply(this, arguments);
   };
   Box2D.Common.Math.b2Mat22 = b2Mat22;

   function b2Mat33() {
      b2Mat33.b2Mat33.apply(this, arguments);
      if (this.constructor === b2Mat33) this.b2Mat33.apply(this, arguments);
   };
   Box2D.Common.Math.b2Mat33 = b2Mat33;

   function b2Math() {
      b2Math.b2Math.apply(this, arguments);
   };
   Box2D.Common.Math.b2Math = b2Math;

   function b2Sweep() {
      b2Sweep.b2Sweep.apply(this, arguments);
   };
   Box2D.Common.Math.b2Sweep = b2Sweep;

   function b2Transform() {
      b2Transform.b2Transform.apply(this, arguments);
      if (this.constructor === b2Transform) this.b2Transform.apply(this, arguments);
   };
   Box2D.Common.Math.b2Transform = b2Transform;

   function b2Vec2() {
      b2Vec2.b2Vec2.apply(this, arguments);
      if (this.constructor === b2Vec2) this.b2Vec2.apply(this, arguments);
   };
   Box2D.Common.Math.b2Vec2 = b2Vec2;

   function b2Vec3() {
      b2Vec3.b2Vec3.apply(this, arguments);
      if (this.constructor === b2Vec3) this.b2Vec3.apply(this, arguments);
   };
   Box2D.Common.Math.b2Vec3 = b2Vec3;

   function b2Body() {
      b2Body.b2Body.apply(this, arguments);
      if (this.constructor === b2Body) this.b2Body.apply(this, arguments);
   };
   Box2D.Dynamics.b2Body = b2Body;

   function b2BodyDef() {
      b2BodyDef.b2BodyDef.apply(this, arguments);
      if (this.constructor === b2BodyDef) this.b2BodyDef.apply(this, arguments);
   };
   Box2D.Dynamics.b2BodyDef = b2BodyDef;

   function b2ContactFilter() {
      b2ContactFilter.b2ContactFilter.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactFilter = b2ContactFilter;

   function b2ContactImpulse() {
      b2ContactImpulse.b2ContactImpulse.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactImpulse = b2ContactImpulse;

   function b2ContactListener() {
      b2ContactListener.b2ContactListener.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactListener = b2ContactListener;

   function b2ContactManager() {
      b2ContactManager.b2ContactManager.apply(this, arguments);
      if (this.constructor === b2ContactManager) this.b2ContactManager.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactManager = b2ContactManager;

   function b2DebugDraw() {
      b2DebugDraw.b2DebugDraw.apply(this, arguments);
      if (this.constructor === b2DebugDraw) this.b2DebugDraw.apply(this, arguments);
   };
   Box2D.Dynamics.b2DebugDraw = b2DebugDraw;

   function b2DestructionListener() {
      b2DestructionListener.b2DestructionListener.apply(this, arguments);
   };
   Box2D.Dynamics.b2DestructionListener = b2DestructionListener;

   function b2FilterData() {
      b2FilterData.b2FilterData.apply(this, arguments);
   };
   Box2D.Dynamics.b2FilterData = b2FilterData;

   function b2Fixture() {
      b2Fixture.b2Fixture.apply(this, arguments);
      if (this.constructor === b2Fixture) this.b2Fixture.apply(this, arguments);
   };
   Box2D.Dynamics.b2Fixture = b2Fixture;

   function b2FixtureDef() {
      b2FixtureDef.b2FixtureDef.apply(this, arguments);
      if (this.constructor === b2FixtureDef) this.b2FixtureDef.apply(this, arguments);
   };
   Box2D.Dynamics.b2FixtureDef = b2FixtureDef;

   function b2Island() {
      b2Island.b2Island.apply(this, arguments);
      if (this.constructor === b2Island) this.b2Island.apply(this, arguments);
   };
   Box2D.Dynamics.b2Island = b2Island;

   function b2TimeStep() {
      b2TimeStep.b2TimeStep.apply(this, arguments);
   };
   Box2D.Dynamics.b2TimeStep = b2TimeStep;

   function b2World() {
      b2World.b2World.apply(this, arguments);
      if (this.constructor === b2World) this.b2World.apply(this, arguments);
   };
   Box2D.Dynamics.b2World = b2World;

   function b2CircleContact() {
      b2CircleContact.b2CircleContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2CircleContact = b2CircleContact;

   function b2Contact() {
      b2Contact.b2Contact.apply(this, arguments);
      if (this.constructor === b2Contact) this.b2Contact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2Contact = b2Contact;

   function b2ContactConstraint() {
      b2ContactConstraint.b2ContactConstraint.apply(this, arguments);
      if (this.constructor === b2ContactConstraint) this.b2ContactConstraint.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactConstraint = b2ContactConstraint;

   function b2ContactConstraintPoint() {
      b2ContactConstraintPoint.b2ContactConstraintPoint.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactConstraintPoint = b2ContactConstraintPoint;

   function b2ContactEdge() {
      b2ContactEdge.b2ContactEdge.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactEdge = b2ContactEdge;

   function b2ContactFactory() {
      b2ContactFactory.b2ContactFactory.apply(this, arguments);
      if (this.constructor === b2ContactFactory) this.b2ContactFactory.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactFactory = b2ContactFactory;

   function b2ContactRegister() {
      b2ContactRegister.b2ContactRegister.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactRegister = b2ContactRegister;

   function b2ContactResult() {
      b2ContactResult.b2ContactResult.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactResult = b2ContactResult;

   function b2ContactSolver() {
      b2ContactSolver.b2ContactSolver.apply(this, arguments);
      if (this.constructor === b2ContactSolver) this.b2ContactSolver.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactSolver = b2ContactSolver;

   function b2EdgeAndCircleContact() {
      b2EdgeAndCircleContact.b2EdgeAndCircleContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2EdgeAndCircleContact = b2EdgeAndCircleContact;

   function b2NullContact() {
      b2NullContact.b2NullContact.apply(this, arguments);
      if (this.constructor === b2NullContact) this.b2NullContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2NullContact = b2NullContact;

   function b2PolyAndCircleContact() {
      b2PolyAndCircleContact.b2PolyAndCircleContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PolyAndCircleContact = b2PolyAndCircleContact;

   function b2PolyAndEdgeContact() {
      b2PolyAndEdgeContact.b2PolyAndEdgeContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PolyAndEdgeContact = b2PolyAndEdgeContact;

   function b2PolygonContact() {
      b2PolygonContact.b2PolygonContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PolygonContact = b2PolygonContact;

   function b2PositionSolverManifold() {
      b2PositionSolverManifold.b2PositionSolverManifold.apply(this, arguments);
      if (this.constructor === b2PositionSolverManifold) this.b2PositionSolverManifold.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PositionSolverManifold = b2PositionSolverManifold;

   function b2BuoyancyController() {
      b2BuoyancyController.b2BuoyancyController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2BuoyancyController = b2BuoyancyController;

   function b2ConstantAccelController() {
      b2ConstantAccelController.b2ConstantAccelController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2ConstantAccelController = b2ConstantAccelController;

   function b2ConstantForceController() {
      b2ConstantForceController.b2ConstantForceController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2ConstantForceController = b2ConstantForceController;

   function b2Controller() {
      b2Controller.b2Controller.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2Controller = b2Controller;

   function b2ControllerEdge() {
      b2ControllerEdge.b2ControllerEdge.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2ControllerEdge = b2ControllerEdge;

   function b2GravityController() {
      b2GravityController.b2GravityController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2GravityController = b2GravityController;

   function b2TensorDampingController() {
      b2TensorDampingController.b2TensorDampingController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2TensorDampingController = b2TensorDampingController;

   function b2DistanceJoint() {
      b2DistanceJoint.b2DistanceJoint.apply(this, arguments);
      if (this.constructor === b2DistanceJoint) this.b2DistanceJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2DistanceJoint = b2DistanceJoint;

   function b2DistanceJointDef() {
      b2DistanceJointDef.b2DistanceJointDef.apply(this, arguments);
      if (this.constructor === b2DistanceJointDef) this.b2DistanceJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2DistanceJointDef = b2DistanceJointDef;

   function b2FrictionJoint() {
      b2FrictionJoint.b2FrictionJoint.apply(this, arguments);
      if (this.constructor === b2FrictionJoint) this.b2FrictionJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2FrictionJoint = b2FrictionJoint;

   function b2FrictionJointDef() {
      b2FrictionJointDef.b2FrictionJointDef.apply(this, arguments);
      if (this.constructor === b2FrictionJointDef) this.b2FrictionJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2FrictionJointDef = b2FrictionJointDef;

   function b2GearJoint() {
      b2GearJoint.b2GearJoint.apply(this, arguments);
      if (this.constructor === b2GearJoint) this.b2GearJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2GearJoint = b2GearJoint;

   function b2GearJointDef() {
      b2GearJointDef.b2GearJointDef.apply(this, arguments);
      if (this.constructor === b2GearJointDef) this.b2GearJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2GearJointDef = b2GearJointDef;

   function b2Jacobian() {
      b2Jacobian.b2Jacobian.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2Jacobian = b2Jacobian;

   function b2Joint() {
      b2Joint.b2Joint.apply(this, arguments);
      if (this.constructor === b2Joint) this.b2Joint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2Joint = b2Joint;

   function b2JointDef() {
      b2JointDef.b2JointDef.apply(this, arguments);
      if (this.constructor === b2JointDef) this.b2JointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2JointDef = b2JointDef;

   function b2JointEdge() {
      b2JointEdge.b2JointEdge.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2JointEdge = b2JointEdge;

   function b2LineJoint() {
      b2LineJoint.b2LineJoint.apply(this, arguments);
      if (this.constructor === b2LineJoint) this.b2LineJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2LineJoint = b2LineJoint;

   function b2LineJointDef() {
      b2LineJointDef.b2LineJointDef.apply(this, arguments);
      if (this.constructor === b2LineJointDef) this.b2LineJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2LineJointDef = b2LineJointDef;

   function b2MouseJoint() {
      b2MouseJoint.b2MouseJoint.apply(this, arguments);
      if (this.constructor === b2MouseJoint) this.b2MouseJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2MouseJoint = b2MouseJoint;

   function b2MouseJointDef() {
      b2MouseJointDef.b2MouseJointDef.apply(this, arguments);
      if (this.constructor === b2MouseJointDef) this.b2MouseJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2MouseJointDef = b2MouseJointDef;

   function b2PrismaticJoint() {
      b2PrismaticJoint.b2PrismaticJoint.apply(this, arguments);
      if (this.constructor === b2PrismaticJoint) this.b2PrismaticJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PrismaticJoint = b2PrismaticJoint;

   function b2PrismaticJointDef() {
      b2PrismaticJointDef.b2PrismaticJointDef.apply(this, arguments);
      if (this.constructor === b2PrismaticJointDef) this.b2PrismaticJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PrismaticJointDef = b2PrismaticJointDef;

   function b2PulleyJoint() {
      b2PulleyJoint.b2PulleyJoint.apply(this, arguments);
      if (this.constructor === b2PulleyJoint) this.b2PulleyJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PulleyJoint = b2PulleyJoint;

   function b2PulleyJointDef() {
      b2PulleyJointDef.b2PulleyJointDef.apply(this, arguments);
      if (this.constructor === b2PulleyJointDef) this.b2PulleyJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PulleyJointDef = b2PulleyJointDef;

   function b2RevoluteJoint() {
      b2RevoluteJoint.b2RevoluteJoint.apply(this, arguments);
      if (this.constructor === b2RevoluteJoint) this.b2RevoluteJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2RevoluteJoint = b2RevoluteJoint;

   function b2RevoluteJointDef() {
      b2RevoluteJointDef.b2RevoluteJointDef.apply(this, arguments);
      if (this.constructor === b2RevoluteJointDef) this.b2RevoluteJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2RevoluteJointDef = b2RevoluteJointDef;

   function b2WeldJoint() {
      b2WeldJoint.b2WeldJoint.apply(this, arguments);
      if (this.constructor === b2WeldJoint) this.b2WeldJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2WeldJoint = b2WeldJoint;

   function b2WeldJointDef() {
      b2WeldJointDef.b2WeldJointDef.apply(this, arguments);
      if (this.constructor === b2WeldJointDef) this.b2WeldJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2WeldJointDef = b2WeldJointDef;
})(); //definitions
Box2D.postDefs = [];
(function () {
   var b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase;

   b2AABB.b2AABB = function () {
      this.lowerBound = new b2Vec2();
      this.upperBound = new b2Vec2();
   };
   b2AABB.prototype.IsValid = function () {
      var dX = this.upperBound.x - this.lowerBound.x;
      var dY = this.upperBound.y - this.lowerBound.y;
      var valid = dX >= 0.0 && dY >= 0.0;
      valid = valid && this.lowerBound.IsValid() && this.upperBound.IsValid();
      return valid;
   }
   b2AABB.prototype.GetCenter = function () {
      return new b2Vec2((this.lowerBound.x + this.upperBound.x) / 2, (this.lowerBound.y + this.upperBound.y) / 2);
   }
   b2AABB.prototype.GetExtents = function () {
      return new b2Vec2((this.upperBound.x - this.lowerBound.x) / 2, (this.upperBound.y - this.lowerBound.y) / 2);
   }
   b2AABB.prototype.Contains = function (aabb) {
      var result = true;
      result = result && this.lowerBound.x <= aabb.lowerBound.x;
      result = result && this.lowerBound.y <= aabb.lowerBound.y;
      result = result && aabb.upperBound.x <= this.upperBound.x;
      result = result && aabb.upperBound.y <= this.upperBound.y;
      return result;
   }
   b2AABB.prototype.RayCast = function (output, input) {
      var tmin = (-Number.MAX_VALUE);
      var tmax = Number.MAX_VALUE;
      var pX = input.p1.x;
      var pY = input.p1.y;
      var dX = input.p2.x - input.p1.x;
      var dY = input.p2.y - input.p1.y;
      var absDX = Math.abs(dX);
      var absDY = Math.abs(dY);
      var normal = output.normal;
      var inv_d = 0;
      var t1 = 0;
      var t2 = 0;
      var t3 = 0;
      var s = 0; {
         if (absDX < Number.MIN_VALUE) {
            if (pX < this.lowerBound.x || this.upperBound.x < pX) return false;
         }
         else {
            inv_d = 1.0 / dX;
            t1 = (this.lowerBound.x - pX) * inv_d;
            t2 = (this.upperBound.x - pX) * inv_d;
            s = (-1.0);
            if (t1 > t2) {
               t3 = t1;
               t1 = t2;
               t2 = t3;
               s = 1.0;
            }
            if (t1 > tmin) {
               normal.x = s;
               normal.y = 0;
               tmin = t1;
            }
            tmax = Math.min(tmax, t2);
            if (tmin > tmax) return false;
         }
      } {
         if (absDY < Number.MIN_VALUE) {
            if (pY < this.lowerBound.y || this.upperBound.y < pY) return false;
         }
         else {
            inv_d = 1.0 / dY;
            t1 = (this.lowerBound.y - pY) * inv_d;
            t2 = (this.upperBound.y - pY) * inv_d;
            s = (-1.0);
            if (t1 > t2) {
               t3 = t1;
               t1 = t2;
               t2 = t3;
               s = 1.0;
            }
            if (t1 > tmin) {
               normal.y = s;
               normal.x = 0;
               tmin = t1;
            }
            tmax = Math.min(tmax, t2);
            if (tmin > tmax) return false;
         }
      }
      output.fraction = tmin;
      return true;
   }
   b2AABB.prototype.TestOverlap = function (other) {
      var d1X = other.lowerBound.x - this.upperBound.x;
      var d1Y = other.lowerBound.y - this.upperBound.y;
      var d2X = this.lowerBound.x - other.upperBound.x;
      var d2Y = this.lowerBound.y - other.upperBound.y;
      if (d1X > 0.0 || d1Y > 0.0) return false;
      if (d2X > 0.0 || d2Y > 0.0) return false;
      return true;
   }
   b2AABB.Combine = function (aabb1, aabb2) {
      var aabb = new b2AABB();
      aabb.Combine(aabb1, aabb2);
      return aabb;
   }
   b2AABB.prototype.Combine = function (aabb1, aabb2) {
      this.lowerBound.x = Math.min(aabb1.lowerBound.x, aabb2.lowerBound.x);
      this.lowerBound.y = Math.min(aabb1.lowerBound.y, aabb2.lowerBound.y);
      this.upperBound.x = Math.max(aabb1.upperBound.x, aabb2.upperBound.x);
      this.upperBound.y = Math.max(aabb1.upperBound.y, aabb2.upperBound.y);
   }
   b2Bound.b2Bound = function () {};
   b2Bound.prototype.IsLower = function () {
      return (this.value & 1) == 0;
   }
   b2Bound.prototype.IsUpper = function () {
      return (this.value & 1) == 1;
   }
   b2Bound.prototype.Swap = function (b) {
      var tempValue = this.value;
      var tempProxy = this.proxy;
      var tempStabbingCount = this.stabbingCount;
      this.value = b.value;
      this.proxy = b.proxy;
      this.stabbingCount = b.stabbingCount;
      b.value = tempValue;
      b.proxy = tempProxy;
      b.stabbingCount = tempStabbingCount;
   }
   b2BoundValues.b2BoundValues = function () {};
   b2BoundValues.prototype.b2BoundValues = function () {
      this.lowerValues = new Vector_a2j_Number();
      this.lowerValues[0] = 0.0;
      this.lowerValues[1] = 0.0;
      this.upperValues = new Vector_a2j_Number();
      this.upperValues[0] = 0.0;
      this.upperValues[1] = 0.0;
   }
   b2Collision.b2Collision = function () {};
   b2Collision.ClipSegmentToLine = function (vOut, vIn, normal, offset) {
      if (offset === undefined) offset = 0;
      var cv;
      var numOut = 0;
      cv = vIn[0];
      var vIn0 = cv.v;
      cv = vIn[1];
      var vIn1 = cv.v;
      var distance0 = normal.x * vIn0.x + normal.y * vIn0.y - offset;
      var distance1 = normal.x * vIn1.x + normal.y * vIn1.y - offset;
      if (distance0 <= 0.0) vOut[numOut++].Set(vIn[0]);
      if (distance1 <= 0.0) vOut[numOut++].Set(vIn[1]);
      if (distance0 * distance1 < 0.0) {
         var interp = distance0 / (distance0 - distance1);
         cv = vOut[numOut];
         var tVec = cv.v;
         tVec.x = vIn0.x + interp * (vIn1.x - vIn0.x);
         tVec.y = vIn0.y + interp * (vIn1.y - vIn0.y);
         cv = vOut[numOut];
         var cv2;
         if (distance0 > 0.0) {
            cv2 = vIn[0];
            cv.id = cv2.id;
         }
         else {
            cv2 = vIn[1];
            cv.id = cv2.id;
         }++numOut;
      }
      return numOut;
   }
   b2Collision.EdgeSeparation = function (poly1, xf1, edge1, poly2, xf2) {
      if (edge1 === undefined) edge1 = 0;
      var count1 = parseInt(poly1.m_vertexCount);
      var vertices1 = poly1.m_vertices;
      var normals1 = poly1.m_normals;
      var count2 = parseInt(poly2.m_vertexCount);
      var vertices2 = poly2.m_vertices;
      var tMat;
      var tVec;
      tMat = xf1.R;
      tVec = normals1[edge1];
      var normal1WorldX = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var normal1WorldY = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf2.R;
      var normal1X = (tMat.col1.x * normal1WorldX + tMat.col1.y * normal1WorldY);
      var normal1Y = (tMat.col2.x * normal1WorldX + tMat.col2.y * normal1WorldY);
      var index = 0;
      var minDot = Number.MAX_VALUE;
      for (var i = 0; i < count2; ++i) {
         tVec = vertices2[i];
         var dot = tVec.x * normal1X + tVec.y * normal1Y;
         if (dot < minDot) {
            minDot = dot;
            index = i;
         }
      }
      tVec = vertices1[edge1];
      tMat = xf1.R;
      var v1X = xf1.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var v1Y = xf1.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tVec = vertices2[index];
      tMat = xf2.R;
      var v2X = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var v2Y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      v2X -= v1X;
      v2Y -= v1Y;
      var separation = v2X * normal1WorldX + v2Y * normal1WorldY;
      return separation;
   }
   b2Collision.FindMaxSeparation = function (edgeIndex, poly1, xf1, poly2, xf2) {
      var count1 = parseInt(poly1.m_vertexCount);
      var normals1 = poly1.m_normals;
      var tVec;
      var tMat;
      tMat = xf2.R;
      tVec = poly2.m_centroid;
      var dX = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var dY = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf1.R;
      tVec = poly1.m_centroid;
      dX -= xf1.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      dY -= xf1.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var dLocal1X = (dX * xf1.R.col1.x + dY * xf1.R.col1.y);
      var dLocal1Y = (dX * xf1.R.col2.x + dY * xf1.R.col2.y);
      var edge = 0;
      var maxDot = (-Number.MAX_VALUE);
      for (var i = 0; i < count1; ++i) {
         tVec = normals1[i];
         var dot = (tVec.x * dLocal1X + tVec.y * dLocal1Y);
         if (dot > maxDot) {
            maxDot = dot;
            edge = i;
         }
      }
      var s = b2Collision.EdgeSeparation(poly1, xf1, edge, poly2, xf2);
      var prevEdge = parseInt(edge - 1 >= 0 ? edge - 1 : count1 - 1);
      var sPrev = b2Collision.EdgeSeparation(poly1, xf1, prevEdge, poly2, xf2);
      var nextEdge = parseInt(edge + 1 < count1 ? edge + 1 : 0);
      var sNext = b2Collision.EdgeSeparation(poly1, xf1, nextEdge, poly2, xf2);
      var bestEdge = 0;
      var bestSeparation = 0;
      var increment = 0;
      if (sPrev > s && sPrev > sNext) {
         increment = (-1);
         bestEdge = prevEdge;
         bestSeparation = sPrev;
      }
      else if (sNext > s) {
         increment = 1;
         bestEdge = nextEdge;
         bestSeparation = sNext;
      }
      else {
         edgeIndex[0] = edge;
         return s;
      }
      while (true) {
         if (increment == (-1)) edge = bestEdge - 1 >= 0 ? bestEdge - 1 : count1 - 1;
         else edge = bestEdge + 1 < count1 ? bestEdge + 1 : 0;s = b2Collision.EdgeSeparation(poly1, xf1, edge, poly2, xf2);
         if (s > bestSeparation) {
            bestEdge = edge;
            bestSeparation = s;
         }
         else {
            break;
         }
      }
      edgeIndex[0] = bestEdge;
      return bestSeparation;
   }
   b2Collision.FindIncidentEdge = function (c, poly1, xf1, edge1, poly2, xf2) {
      if (edge1 === undefined) edge1 = 0;
      var count1 = parseInt(poly1.m_vertexCount);
      var normals1 = poly1.m_normals;
      var count2 = parseInt(poly2.m_vertexCount);
      var vertices2 = poly2.m_vertices;
      var normals2 = poly2.m_normals;
      var tMat;
      var tVec;
      tMat = xf1.R;
      tVec = normals1[edge1];
      var normal1X = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var normal1Y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf2.R;
      var tX = (tMat.col1.x * normal1X + tMat.col1.y * normal1Y);
      normal1Y = (tMat.col2.x * normal1X + tMat.col2.y * normal1Y);
      normal1X = tX;
      var index = 0;
      var minDot = Number.MAX_VALUE;
      for (var i = 0; i < count2; ++i) {
         tVec = normals2[i];
         var dot = (normal1X * tVec.x + normal1Y * tVec.y);
         if (dot < minDot) {
            minDot = dot;
            index = i;
         }
      }
      var tClip;
      var i1 = parseInt(index);
      var i2 = parseInt(i1 + 1 < count2 ? i1 + 1 : 0);
      tClip = c[0];
      tVec = vertices2[i1];
      tMat = xf2.R;
      tClip.v.x = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      tClip.v.y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tClip.id.features.referenceEdge = edge1;
      tClip.id.features.incidentEdge = i1;
      tClip.id.features.incidentVertex = 0;
      tClip = c[1];
      tVec = vertices2[i2];
      tMat = xf2.R;
      tClip.v.x = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      tClip.v.y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tClip.id.features.referenceEdge = edge1;
      tClip.id.features.incidentEdge = i2;
      tClip.id.features.incidentVertex = 1;
   }
   b2Collision.MakeClipPointVector = function () {
      var r = new Vector(2);
      r[0] = new ClipVertex();
      r[1] = new ClipVertex();
      return r;
   }
   b2Collision.CollidePolygons = function (manifold, polyA, xfA, polyB, xfB) {
      var cv;
      manifold.m_pointCount = 0;
      var totalRadius = polyA.m_radius + polyB.m_radius;
      var edgeA = 0;
      b2Collision.s_edgeAO[0] = edgeA;
      var separationA = b2Collision.FindMaxSeparation(b2Collision.s_edgeAO, polyA, xfA, polyB, xfB);
      edgeA = b2Collision.s_edgeAO[0];
      if (separationA > totalRadius) return;
      var edgeB = 0;
      b2Collision.s_edgeBO[0] = edgeB;
      var separationB = b2Collision.FindMaxSeparation(b2Collision.s_edgeBO, polyB, xfB, polyA, xfA);
      edgeB = b2Collision.s_edgeBO[0];
      if (separationB > totalRadius) return;
      var poly1;
      var poly2;
      var xf1;
      var xf2;
      var edge1 = 0;
      var flip = 0;
      var k_relativeTol = 0.98;
      var k_absoluteTol = 0.001;
      var tMat;
      if (separationB > k_relativeTol * separationA + k_absoluteTol) {
         poly1 = polyB;
         poly2 = polyA;
         xf1 = xfB;
         xf2 = xfA;
         edge1 = edgeB;
         manifold.m_type = b2Manifold.e_faceB;
         flip = 1;
      }
      else {
         poly1 = polyA;
         poly2 = polyB;
         xf1 = xfA;
         xf2 = xfB;
         edge1 = edgeA;
         manifold.m_type = b2Manifold.e_faceA;
         flip = 0;
      }
      var incidentEdge = b2Collision.s_incidentEdge;
      b2Collision.FindIncidentEdge(incidentEdge, poly1, xf1, edge1, poly2, xf2);
      var count1 = parseInt(poly1.m_vertexCount);
      var vertices1 = poly1.m_vertices;
      var local_v11 = vertices1[edge1];
      var local_v12;
      if (edge1 + 1 < count1) {
         local_v12 = vertices1[parseInt(edge1 + 1)];
      }
      else {
         local_v12 = vertices1[0];
      }
      var localTangent = b2Collision.s_localTangent;
      localTangent.Set(local_v12.x - local_v11.x, local_v12.y - local_v11.y);
      localTangent.Normalize();
      var localNormal = b2Collision.s_localNormal;
      localNormal.x = localTangent.y;
      localNormal.y = (-localTangent.x);
      var planePoint = b2Collision.s_planePoint;
      planePoint.Set(0.5 * (local_v11.x + local_v12.x), 0.5 * (local_v11.y + local_v12.y));
      var tangent = b2Collision.s_tangent;
      tMat = xf1.R;
      tangent.x = (tMat.col1.x * localTangent.x + tMat.col2.x * localTangent.y);
      tangent.y = (tMat.col1.y * localTangent.x + tMat.col2.y * localTangent.y);
      var tangent2 = b2Collision.s_tangent2;
      tangent2.x = (-tangent.x);
      tangent2.y = (-tangent.y);
      var normal = b2Collision.s_normal;
      normal.x = tangent.y;
      normal.y = (-tangent.x);
      var v11 = b2Collision.s_v11;
      var v12 = b2Collision.s_v12;
      v11.x = xf1.position.x + (tMat.col1.x * local_v11.x + tMat.col2.x * local_v11.y);
      v11.y = xf1.position.y + (tMat.col1.y * local_v11.x + tMat.col2.y * local_v11.y);
      v12.x = xf1.position.x + (tMat.col1.x * local_v12.x + tMat.col2.x * local_v12.y);
      v12.y = xf1.position.y + (tMat.col1.y * local_v12.x + tMat.col2.y * local_v12.y);
      var frontOffset = normal.x * v11.x + normal.y * v11.y;
      var sideOffset1 = (-tangent.x * v11.x) - tangent.y * v11.y + totalRadius;
      var sideOffset2 = tangent.x * v12.x + tangent.y * v12.y + totalRadius;
      var clipPoints1 = b2Collision.s_clipPoints1;
      var clipPoints2 = b2Collision.s_clipPoints2;
      var np = 0;
      np = b2Collision.ClipSegmentToLine(clipPoints1, incidentEdge, tangent2, sideOffset1);
      if (np < 2) return;
      np = b2Collision.ClipSegmentToLine(clipPoints2, clipPoints1, tangent, sideOffset2);
      if (np < 2) return;
      manifold.m_localPlaneNormal.SetV(localNormal);
      manifold.m_localPoint.SetV(planePoint);
      var pointCount = 0;
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; ++i) {
         cv = clipPoints2[i];
         var separation = normal.x * cv.v.x + normal.y * cv.v.y - frontOffset;
         if (separation <= totalRadius) {
            var cp = manifold.m_points[pointCount];
            tMat = xf2.R;
            var tX = cv.v.x - xf2.position.x;
            var tY = cv.v.y - xf2.position.y;
            cp.m_localPoint.x = (tX * tMat.col1.x + tY * tMat.col1.y);
            cp.m_localPoint.y = (tX * tMat.col2.x + tY * tMat.col2.y);
            cp.m_id.Set(cv.id);
            cp.m_id.features.flip = flip;
            ++pointCount;
         }
      }
      manifold.m_pointCount = pointCount;
   }
   b2Collision.CollideCircles = function (manifold, circle1, xf1, circle2, xf2) {
      manifold.m_pointCount = 0;
      var tMat;
      var tVec;
      tMat = xf1.R;
      tVec = circle1.m_p;
      var p1X = xf1.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var p1Y = xf1.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf2.R;
      tVec = circle2.m_p;
      var p2X = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var p2Y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var distSqr = dX * dX + dY * dY;
      var radius = circle1.m_radius + circle2.m_radius;
      if (distSqr > radius * radius) {
         return;
      }
      manifold.m_type = b2Manifold.e_circles;
      manifold.m_localPoint.SetV(circle1.m_p);
      manifold.m_localPlaneNormal.SetZero();
      manifold.m_pointCount = 1;
      manifold.m_points[0].m_localPoint.SetV(circle2.m_p);
      manifold.m_points[0].m_id.key = 0;
   }
   b2Collision.CollidePolygonAndCircle = function (manifold, polygon, xf1, circle, xf2) {
      manifold.m_pointCount = 0;
      var tPoint;
      var dX = 0;
      var dY = 0;
      var positionX = 0;
      var positionY = 0;
      var tVec;
      var tMat;
      tMat = xf2.R;
      tVec = circle.m_p;
      var cX = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var cY = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      dX = cX - xf1.position.x;
      dY = cY - xf1.position.y;
      tMat = xf1.R;
      var cLocalX = (dX * tMat.col1.x + dY * tMat.col1.y);
      var cLocalY = (dX * tMat.col2.x + dY * tMat.col2.y);
      var dist = 0;
      var normalIndex = 0;
      var separation = (-Number.MAX_VALUE);
      var radius = polygon.m_radius + circle.m_radius;
      var vertexCount = parseInt(polygon.m_vertexCount);
      var vertices = polygon.m_vertices;
      var normals = polygon.m_normals;
      for (var i = 0; i < vertexCount; ++i) {
         tVec = vertices[i];
         dX = cLocalX - tVec.x;
         dY = cLocalY - tVec.y;
         tVec = normals[i];
         var s = tVec.x * dX + tVec.y * dY;
         if (s > radius) {
            return;
         }
         if (s > separation) {
            separation = s;
            normalIndex = i;
         }
      }
      var vertIndex1 = parseInt(normalIndex);
      var vertIndex2 = parseInt(vertIndex1 + 1 < vertexCount ? vertIndex1 + 1 : 0);
      var v1 = vertices[vertIndex1];
      var v2 = vertices[vertIndex2];
      if (separation < Number.MIN_VALUE) {
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.SetV(normals[normalIndex]);
         manifold.m_localPoint.x = 0.5 * (v1.x + v2.x);
         manifold.m_localPoint.y = 0.5 * (v1.y + v2.y);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
         return;
      }
      var u1 = (cLocalX - v1.x) * (v2.x - v1.x) + (cLocalY - v1.y) * (v2.y - v1.y);
      var u2 = (cLocalX - v2.x) * (v1.x - v2.x) + (cLocalY - v2.y) * (v1.y - v2.y);
      if (u1 <= 0.0) {
         if ((cLocalX - v1.x) * (cLocalX - v1.x) + (cLocalY - v1.y) * (cLocalY - v1.y) > radius * radius) return;
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.x = cLocalX - v1.x;
         manifold.m_localPlaneNormal.y = cLocalY - v1.y;
         manifold.m_localPlaneNormal.Normalize();
         manifold.m_localPoint.SetV(v1);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
      }
      else if (u2 <= 0) {
         if ((cLocalX - v2.x) * (cLocalX - v2.x) + (cLocalY - v2.y) * (cLocalY - v2.y) > radius * radius) return;
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.x = cLocalX - v2.x;
         manifold.m_localPlaneNormal.y = cLocalY - v2.y;
         manifold.m_localPlaneNormal.Normalize();
         manifold.m_localPoint.SetV(v2);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
      }
      else {
         var faceCenterX = 0.5 * (v1.x + v2.x);
         var faceCenterY = 0.5 * (v1.y + v2.y);
         separation = (cLocalX - faceCenterX) * normals[vertIndex1].x + (cLocalY - faceCenterY) * normals[vertIndex1].y;
         if (separation > radius) return;
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.x = normals[vertIndex1].x;
         manifold.m_localPlaneNormal.y = normals[vertIndex1].y;
         manifold.m_localPlaneNormal.Normalize();
         manifold.m_localPoint.Set(faceCenterX, faceCenterY);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
      }
   }
   b2Collision.TestOverlap = function (a, b) {
      var t1 = b.lowerBound;
      var t2 = a.upperBound;
      var d1X = t1.x - t2.x;
      var d1Y = t1.y - t2.y;
      t1 = a.lowerBound;
      t2 = b.upperBound;
      var d2X = t1.x - t2.x;
      var d2Y = t1.y - t2.y;
      if (d1X > 0.0 || d1Y > 0.0) return false;
      if (d2X > 0.0 || d2Y > 0.0) return false;
      return true;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2Collision.s_incidentEdge = b2Collision.MakeClipPointVector();
      Box2D.Collision.b2Collision.s_clipPoints1 = b2Collision.MakeClipPointVector();
      Box2D.Collision.b2Collision.s_clipPoints2 = b2Collision.MakeClipPointVector();
      Box2D.Collision.b2Collision.s_edgeAO = new Vector_a2j_Number(1);
      Box2D.Collision.b2Collision.s_edgeBO = new Vector_a2j_Number(1);
      Box2D.Collision.b2Collision.s_localTangent = new b2Vec2();
      Box2D.Collision.b2Collision.s_localNormal = new b2Vec2();
      Box2D.Collision.b2Collision.s_planePoint = new b2Vec2();
      Box2D.Collision.b2Collision.s_normal = new b2Vec2();
      Box2D.Collision.b2Collision.s_tangent = new b2Vec2();
      Box2D.Collision.b2Collision.s_tangent2 = new b2Vec2();
      Box2D.Collision.b2Collision.s_v11 = new b2Vec2();
      Box2D.Collision.b2Collision.s_v12 = new b2Vec2();
      Box2D.Collision.b2Collision.b2CollidePolyTempVec = new b2Vec2();
      Box2D.Collision.b2Collision.b2_nullFeature = 0x000000ff;
   });
   b2ContactID.b2ContactID = function () {
      this.features = new Features();
   };
   b2ContactID.prototype.b2ContactID = function () {
      this.features._m_id = this;
   }
   b2ContactID.prototype.Set = function (id) {
      this.key = id._key;
   }
   b2ContactID.prototype.Copy = function () {
      var id = new b2ContactID();
      id.key = this.key;
      return id;
   }
   Object.defineProperty(b2ContactID.prototype, 'key', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._key;
      }
   });
   Object.defineProperty(b2ContactID.prototype, 'key', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._key = value;
         this.features._referenceEdge = this._key & 0x000000ff;
         this.features._incidentEdge = ((this._key & 0x0000ff00) >> 8) & 0x000000ff;
         this.features._incidentVertex = ((this._key & 0x00ff0000) >> 16) & 0x000000ff;
         this.features._flip = ((this._key & 0xff000000) >> 24) & 0x000000ff;
      }
   });
   b2ContactPoint.b2ContactPoint = function () {
      this.position = new b2Vec2();
      this.velocity = new b2Vec2();
      this.normal = new b2Vec2();
      this.id = new b2ContactID();
   };
   b2Distance.b2Distance = function () {};
   b2Distance.Distance = function (output, cache, input) {
      ++b2Distance.b2_gjkCalls;
      var proxyA = input.proxyA;
      var proxyB = input.proxyB;
      var transformA = input.transformA;
      var transformB = input.transformB;
      var simplex = b2Distance.s_simplex;
      simplex.ReadCache(cache, proxyA, transformA, proxyB, transformB);
      var vertices = simplex.m_vertices;
      var k_maxIters = 20;
      var saveA = b2Distance.s_saveA;
      var saveB = b2Distance.s_saveB;
      var saveCount = 0;
      var closestPoint = simplex.GetClosestPoint();
      var distanceSqr1 = closestPoint.LengthSquared();
      var distanceSqr2 = distanceSqr1;
      var i = 0;
      var p;
      var iter = 0;
      while (iter < k_maxIters) {
         saveCount = simplex.m_count;
         for (i = 0;
         i < saveCount; i++) {
            saveA[i] = vertices[i].indexA;
            saveB[i] = vertices[i].indexB;
         }
         switch (simplex.m_count) {
         case 1:
            break;
         case 2:
            simplex.Solve2();
            break;
         case 3:
            simplex.Solve3();
            break;
         default:
            b2Settings.b2Assert(false);
         }
         if (simplex.m_count == 3) {
            break;
         }
         p = simplex.GetClosestPoint();
         distanceSqr2 = p.LengthSquared();
         if (distanceSqr2 > distanceSqr1) {}
         distanceSqr1 = distanceSqr2;
         var d = simplex.GetSearchDirection();
         if (d.LengthSquared() < Number.MIN_VALUE * Number.MIN_VALUE) {
            break;
         }
         var vertex = vertices[simplex.m_count];
         vertex.indexA = proxyA.GetSupport(b2Math.MulTMV(transformA.R, d.GetNegative()));
         vertex.wA = b2Math.MulX(transformA, proxyA.GetVertex(vertex.indexA));
         vertex.indexB = proxyB.GetSupport(b2Math.MulTMV(transformB.R, d));
         vertex.wB = b2Math.MulX(transformB, proxyB.GetVertex(vertex.indexB));
         vertex.w = b2Math.SubtractVV(vertex.wB, vertex.wA);
         ++iter;
         ++b2Distance.b2_gjkIters;
         var duplicate = false;
         for (i = 0;
         i < saveCount; i++) {
            if (vertex.indexA == saveA[i] && vertex.indexB == saveB[i]) {
               duplicate = true;
               break;
            }
         }
         if (duplicate) {
            break;
         }++simplex.m_count;
      }
      b2Distance.b2_gjkMaxIters = b2Math.Max(b2Distance.b2_gjkMaxIters, iter);
      simplex.GetWitnessPoints(output.pointA, output.pointB);
      output.distance = b2Math.SubtractVV(output.pointA, output.pointB).Length();
      output.iterations = iter;
      simplex.WriteCache(cache);
      if (input.useRadii) {
         var rA = proxyA.m_radius;
         var rB = proxyB.m_radius;
         if (output.distance > rA + rB && output.distance > Number.MIN_VALUE) {
            output.distance -= rA + rB;
            var normal = b2Math.SubtractVV(output.pointB, output.pointA);
            normal.Normalize();
            output.pointA.x += rA * normal.x;
            output.pointA.y += rA * normal.y;
            output.pointB.x -= rB * normal.x;
            output.pointB.y -= rB * normal.y;
         }
         else {
            p = new b2Vec2();
            p.x = .5 * (output.pointA.x + output.pointB.x);
            p.y = .5 * (output.pointA.y + output.pointB.y);
            output.pointA.x = output.pointB.x = p.x;
            output.pointA.y = output.pointB.y = p.y;
            output.distance = 0.0;
         }
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2Distance.s_simplex = new b2Simplex();
      Box2D.Collision.b2Distance.s_saveA = new Vector_a2j_Number(3);
      Box2D.Collision.b2Distance.s_saveB = new Vector_a2j_Number(3);
   });
   b2DistanceInput.b2DistanceInput = function () {};
   b2DistanceOutput.b2DistanceOutput = function () {
      this.pointA = new b2Vec2();
      this.pointB = new b2Vec2();
   };
   b2DistanceProxy.b2DistanceProxy = function () {};
   b2DistanceProxy.prototype.Set = function (shape) {
      switch (shape.GetType()) {
      case b2Shape.e_circleShape:
         {
            var circle = (shape instanceof b2CircleShape ? shape : null);
            this.m_vertices = new Vector(1, true);
            this.m_vertices[0] = circle.m_p;
            this.m_count = 1;
            this.m_radius = circle.m_radius;
         }
         break;
      case b2Shape.e_polygonShape:
         {
            var polygon = (shape instanceof b2PolygonShape ? shape : null);
            this.m_vertices = polygon.m_vertices;
            this.m_count = polygon.m_vertexCount;
            this.m_radius = polygon.m_radius;
         }
         break;
      default:
         b2Settings.b2Assert(false);
      }
   }
   b2DistanceProxy.prototype.GetSupport = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_count; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return bestIndex;
   }
   b2DistanceProxy.prototype.GetSupportVertex = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_count; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return this.m_vertices[bestIndex];
   }
   b2DistanceProxy.prototype.GetVertexCount = function () {
      return this.m_count;
   }
   b2DistanceProxy.prototype.GetVertex = function (index) {
      if (index === undefined) index = 0;
      b2Settings.b2Assert(0 <= index && index < this.m_count);
      return this.m_vertices[index];
   }
   b2DynamicTree.b2DynamicTree = function () {};
   b2DynamicTree.prototype.b2DynamicTree = function () {
      this.m_root = null;
      this.m_freeList = null;
      this.m_path = 0;
      this.m_insertionCount = 0;
   }
   b2DynamicTree.prototype.CreateProxy = function (aabb, userData) {
      var node = this.AllocateNode();
      var extendX = b2Settings.b2_aabbExtension;
      var extendY = b2Settings.b2_aabbExtension;
      node.aabb.lowerBound.x = aabb.lowerBound.x - extendX;
      node.aabb.lowerBound.y = aabb.lowerBound.y - extendY;
      node.aabb.upperBound.x = aabb.upperBound.x + extendX;
      node.aabb.upperBound.y = aabb.upperBound.y + extendY;
      node.userData = userData;
      this.InsertLeaf(node);
      return node;
   }
   b2DynamicTree.prototype.DestroyProxy = function (proxy) {
      this.RemoveLeaf(proxy);
      this.FreeNode(proxy);
   }
   b2DynamicTree.prototype.MoveProxy = function (proxy, aabb, displacement) {
      b2Settings.b2Assert(proxy.IsLeaf());
      if (proxy.aabb.Contains(aabb)) {
         return false;
      }
      this.RemoveLeaf(proxy);
      var extendX = b2Settings.b2_aabbExtension + b2Settings.b2_aabbMultiplier * (displacement.x > 0 ? displacement.x : (-displacement.x));
      var extendY = b2Settings.b2_aabbExtension + b2Settings.b2_aabbMultiplier * (displacement.y > 0 ? displacement.y : (-displacement.y));
      proxy.aabb.lowerBound.x = aabb.lowerBound.x - extendX;
      proxy.aabb.lowerBound.y = aabb.lowerBound.y - extendY;
      proxy.aabb.upperBound.x = aabb.upperBound.x + extendX;
      proxy.aabb.upperBound.y = aabb.upperBound.y + extendY;
      this.InsertLeaf(proxy);
      return true;
   }
   b2DynamicTree.prototype.Rebalance = function (iterations) {
      if (iterations === undefined) iterations = 0;
      if (this.m_root == null) return;
      for (var i = 0; i < iterations; i++) {
         var node = this.m_root;
         var bit = 0;
         while (node.IsLeaf() == false) {
            node = (this.m_path >> bit) & 1 ? node.child2 : node.child1;
            bit = (bit + 1) & 31;
         }++this.m_path;
         this.RemoveLeaf(node);
         this.InsertLeaf(node);
      }
   }
   b2DynamicTree.prototype.GetFatAABB = function (proxy) {
      return proxy.aabb;
   }
   b2DynamicTree.prototype.GetUserData = function (proxy) {
      return proxy.userData;
   }
   b2DynamicTree.prototype.Query = function (callback, aabb) {
      if (this.m_root == null) return;
      var stack = new Vector();
      var count = 0;
      stack[count++] = this.m_root;
      while (count > 0) {
         var node = stack[--count];
         if (node.aabb.TestOverlap(aabb)) {
            if (node.IsLeaf()) {
               var proceed = callback(node);
               if (!proceed) return;
            }
            else {
               stack[count++] = node.child1;
               stack[count++] = node.child2;
            }
         }
      }
   }
   b2DynamicTree.prototype.RayCast = function (callback, input) {
      if (this.m_root == null) return;
      var p1 = input.p1;
      var p2 = input.p2;
      var r = b2Math.SubtractVV(p1, p2);
      r.Normalize();
      var v = b2Math.CrossFV(1.0, r);
      var abs_v = b2Math.AbsV(v);
      var maxFraction = input.maxFraction;
      var segmentAABB = new b2AABB();
      var tX = 0;
      var tY = 0; {
         tX = p1.x + maxFraction * (p2.x - p1.x);
         tY = p1.y + maxFraction * (p2.y - p1.y);
         segmentAABB.lowerBound.x = Math.min(p1.x, tX);
         segmentAABB.lowerBound.y = Math.min(p1.y, tY);
         segmentAABB.upperBound.x = Math.max(p1.x, tX);
         segmentAABB.upperBound.y = Math.max(p1.y, tY);
      }
      var stack = new Vector();
      var count = 0;
      stack[count++] = this.m_root;
      while (count > 0) {
         var node = stack[--count];
         if (node.aabb.TestOverlap(segmentAABB) == false) {
            continue;
         }
         var c = node.aabb.GetCenter();
         var h = node.aabb.GetExtents();
         var separation = Math.abs(v.x * (p1.x - c.x) + v.y * (p1.y - c.y)) - abs_v.x * h.x - abs_v.y * h.y;
         if (separation > 0.0) continue;
         if (node.IsLeaf()) {
            var subInput = new b2RayCastInput();
            subInput.p1 = input.p1;
            subInput.p2 = input.p2;
            subInput.maxFraction = input.maxFraction;
            maxFraction = callback(subInput, node);
            if (maxFraction == 0.0) return;
            if (maxFraction > 0.0) {
               tX = p1.x + maxFraction * (p2.x - p1.x);
               tY = p1.y + maxFraction * (p2.y - p1.y);
               segmentAABB.lowerBound.x = Math.min(p1.x, tX);
               segmentAABB.lowerBound.y = Math.min(p1.y, tY);
               segmentAABB.upperBound.x = Math.max(p1.x, tX);
               segmentAABB.upperBound.y = Math.max(p1.y, tY);
            }
         }
         else {
            stack[count++] = node.child1;
            stack[count++] = node.child2;
         }
      }
   }
   b2DynamicTree.prototype.AllocateNode = function () {
      if (this.m_freeList) {
         var node = this.m_freeList;
         this.m_freeList = node.parent;
         node.parent = null;
         node.child1 = null;
         node.child2 = null;
         return node;
      }
      return new b2DynamicTreeNode();
   }
   b2DynamicTree.prototype.FreeNode = function (node) {
      node.parent = this.m_freeList;
      this.m_freeList = node;
   }
   b2DynamicTree.prototype.InsertLeaf = function (leaf) {
      ++this.m_insertionCount;
      if (this.m_root == null) {
         this.m_root = leaf;
         this.m_root.parent = null;
         return;
      }
      var center = leaf.aabb.GetCenter();
      var sibling = this.m_root;
      if (sibling.IsLeaf() == false) {
         do {
            var child1 = sibling.child1;
            var child2 = sibling.child2;
            var norm1 = Math.abs((child1.aabb.lowerBound.x + child1.aabb.upperBound.x) / 2 - center.x) + Math.abs((child1.aabb.lowerBound.y + child1.aabb.upperBound.y) / 2 - center.y);
            var norm2 = Math.abs((child2.aabb.lowerBound.x + child2.aabb.upperBound.x) / 2 - center.x) + Math.abs((child2.aabb.lowerBound.y + child2.aabb.upperBound.y) / 2 - center.y);
            if (norm1 < norm2) {
               sibling = child1;
            }
            else {
               sibling = child2;
            }
         }
         while (sibling.IsLeaf() == false)
      }
      var node1 = sibling.parent;
      var node2 = this.AllocateNode();
      node2.parent = node1;
      node2.userData = null;
      node2.aabb.Combine(leaf.aabb, sibling.aabb);
      if (node1) {
         if (sibling.parent.child1 == sibling) {
            node1.child1 = node2;
         }
         else {
            node1.child2 = node2;
         }
         node2.child1 = sibling;
         node2.child2 = leaf;
         sibling.parent = node2;
         leaf.parent = node2;
         do {
            if (node1.aabb.Contains(node2.aabb)) break;
            node1.aabb.Combine(node1.child1.aabb, node1.child2.aabb);
            node2 = node1;
            node1 = node1.parent;
         }
         while (node1)
      }
      else {
         node2.child1 = sibling;
         node2.child2 = leaf;
         sibling.parent = node2;
         leaf.parent = node2;
         this.m_root = node2;
      }
   }
   b2DynamicTree.prototype.RemoveLeaf = function (leaf) {
      if (leaf == this.m_root) {
         this.m_root = null;
         return;
      }
      var node2 = leaf.parent;
      var node1 = node2.parent;
      var sibling;
      if (node2.child1 == leaf) {
         sibling = node2.child2;
      }
      else {
         sibling = node2.child1;
      }
      if (node1) {
         if (node1.child1 == node2) {
            node1.child1 = sibling;
         }
         else {
            node1.child2 = sibling;
         }
         sibling.parent = node1;
         this.FreeNode(node2);
         while (node1) {
            var oldAABB = node1.aabb;
            node1.aabb = b2AABB.Combine(node1.child1.aabb, node1.child2.aabb);
            if (oldAABB.Contains(node1.aabb)) break;
            node1 = node1.parent;
         }
      }
      else {
         this.m_root = sibling;
         sibling.parent = null;
         this.FreeNode(node2);
      }
   }
   b2DynamicTreeBroadPhase.b2DynamicTreeBroadPhase = function () {
      this.m_tree = new b2DynamicTree();
      this.m_moveBuffer = new Vector();
      this.m_pairBuffer = new Vector();
      this.m_pairCount = 0;
   };
   b2DynamicTreeBroadPhase.prototype.CreateProxy = function (aabb, userData) {
      var proxy = this.m_tree.CreateProxy(aabb, userData);
      ++this.m_proxyCount;
      this.BufferMove(proxy);
      return proxy;
   }
   b2DynamicTreeBroadPhase.prototype.DestroyProxy = function (proxy) {
      this.UnBufferMove(proxy);
      --this.m_proxyCount;
      this.m_tree.DestroyProxy(proxy);
   }
   b2DynamicTreeBroadPhase.prototype.MoveProxy = function (proxy, aabb, displacement) {
      var buffer = this.m_tree.MoveProxy(proxy, aabb, displacement);
      if (buffer) {
         this.BufferMove(proxy);
      }
   }
   b2DynamicTreeBroadPhase.prototype.TestOverlap = function (proxyA, proxyB) {
      var aabbA = this.m_tree.GetFatAABB(proxyA);
      var aabbB = this.m_tree.GetFatAABB(proxyB);
      return aabbA.TestOverlap(aabbB);
   }
   b2DynamicTreeBroadPhase.prototype.GetUserData = function (proxy) {
      return this.m_tree.GetUserData(proxy);
   }
   b2DynamicTreeBroadPhase.prototype.GetFatAABB = function (proxy) {
      return this.m_tree.GetFatAABB(proxy);
   }
   b2DynamicTreeBroadPhase.prototype.GetProxyCount = function () {
      return this.m_proxyCount;
   }
   b2DynamicTreeBroadPhase.prototype.UpdatePairs = function (callback) {
      var __this = this;
      __this.m_pairCount = 0;
      var i = 0,
         queryProxy;
       function QueryCallback(proxy) {
          if (proxy == queryProxy) return true;
          if (__this.m_pairCount == __this.m_pairBuffer.length) {
             __this.m_pairBuffer[__this.m_pairCount] = new b2DynamicTreePair();
          }
          var pair = __this.m_pairBuffer[__this.m_pairCount];
          pair.proxyA = proxy < queryProxy ? proxy : queryProxy;
          pair.proxyB = proxy >= queryProxy ? proxy : queryProxy;++__this.m_pairCount;
          return true;
       };
      for (i = 0;
      i < __this.m_moveBuffer.length; ++i) {
         queryProxy = __this.m_moveBuffer[i];
         var fatAABB = __this.m_tree.GetFatAABB(queryProxy);
         __this.m_tree.Query(QueryCallback, fatAABB);
      }
      __this.m_moveBuffer.length = 0;
      for (var i = 0; i < __this.m_pairCount;) {
         var primaryPair = __this.m_pairBuffer[i];
         var userDataA = __this.m_tree.GetUserData(primaryPair.proxyA);
         var userDataB = __this.m_tree.GetUserData(primaryPair.proxyB);
         callback(userDataA, userDataB);
         ++i;
         while (i < __this.m_pairCount) {
            var pair = __this.m_pairBuffer[i];
            if (pair.proxyA != primaryPair.proxyA || pair.proxyB != primaryPair.proxyB) {
               break;
            }++i;
         }
      }
   }
   b2DynamicTreeBroadPhase.prototype.Query = function (callback, aabb) {
      this.m_tree.Query(callback, aabb);
   }
   b2DynamicTreeBroadPhase.prototype.RayCast = function (callback, input) {
      this.m_tree.RayCast(callback, input);
   }
   b2DynamicTreeBroadPhase.prototype.Validate = function () {}
   b2DynamicTreeBroadPhase.prototype.Rebalance = function (iterations) {
      if (iterations === undefined) iterations = 0;
      this.m_tree.Rebalance(iterations);
   }
   b2DynamicTreeBroadPhase.prototype.BufferMove = function (proxy) {
      this.m_moveBuffer[this.m_moveBuffer.length] = proxy;
   }
   b2DynamicTreeBroadPhase.prototype.UnBufferMove = function (proxy) {
      var i = parseInt(this.m_moveBuffer.indexOf(proxy));
      this.m_moveBuffer.splice(i, 1);
   }
   b2DynamicTreeBroadPhase.prototype.ComparePairs = function (pair1, pair2) {
      return 0;
   }
   b2DynamicTreeBroadPhase.__implements = {};
   b2DynamicTreeBroadPhase.__implements[IBroadPhase] = true;
   b2DynamicTreeNode.b2DynamicTreeNode = function () {
      this.aabb = new b2AABB();
   };
   b2DynamicTreeNode.prototype.IsLeaf = function () {
      return this.child1 == null;
   }
   b2DynamicTreePair.b2DynamicTreePair = function () {};
   b2Manifold.b2Manifold = function () {
      this.m_pointCount = 0;
   };
   b2Manifold.prototype.b2Manifold = function () {
      this.m_points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.m_points[i] = new b2ManifoldPoint();
      }
      this.m_localPlaneNormal = new b2Vec2();
      this.m_localPoint = new b2Vec2();
   }
   b2Manifold.prototype.Reset = function () {
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         ((this.m_points[i] instanceof b2ManifoldPoint ? this.m_points[i] : null)).Reset();
      }
      this.m_localPlaneNormal.SetZero();
      this.m_localPoint.SetZero();
      this.m_type = 0;
      this.m_pointCount = 0;
   }
   b2Manifold.prototype.Set = function (m) {
      this.m_pointCount = m.m_pointCount;
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         ((this.m_points[i] instanceof b2ManifoldPoint ? this.m_points[i] : null)).Set(m.m_points[i]);
      }
      this.m_localPlaneNormal.SetV(m.m_localPlaneNormal);
      this.m_localPoint.SetV(m.m_localPoint);
      this.m_type = m.m_type;
   }
   b2Manifold.prototype.Copy = function () {
      var copy = new b2Manifold();
      copy.Set(this);
      return copy;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2Manifold.e_circles = 0x0001;
      Box2D.Collision.b2Manifold.e_faceA = 0x0002;
      Box2D.Collision.b2Manifold.e_faceB = 0x0004;
   });
   b2ManifoldPoint.b2ManifoldPoint = function () {
      this.m_localPoint = new b2Vec2();
      this.m_id = new b2ContactID();
   };
   b2ManifoldPoint.prototype.b2ManifoldPoint = function () {
      this.Reset();
   }
   b2ManifoldPoint.prototype.Reset = function () {
      this.m_localPoint.SetZero();
      this.m_normalImpulse = 0.0;
      this.m_tangentImpulse = 0.0;
      this.m_id.key = 0;
   }
   b2ManifoldPoint.prototype.Set = function (m) {
      this.m_localPoint.SetV(m.m_localPoint);
      this.m_normalImpulse = m.m_normalImpulse;
      this.m_tangentImpulse = m.m_tangentImpulse;
      this.m_id.Set(m.m_id);
   }
   b2Point.b2Point = function () {
      this.p = new b2Vec2();
   };
   b2Point.prototype.Support = function (xf, vX, vY) {
      if (vX === undefined) vX = 0;
      if (vY === undefined) vY = 0;
      return this.p;
   }
   b2Point.prototype.GetFirstVertex = function (xf) {
      return this.p;
   }
   b2RayCastInput.b2RayCastInput = function () {
      this.p1 = new b2Vec2();
      this.p2 = new b2Vec2();
   };
   b2RayCastInput.prototype.b2RayCastInput = function (p1, p2, maxFraction) {
      if (p1 === undefined) p1 = null;
      if (p2 === undefined) p2 = null;
      if (maxFraction === undefined) maxFraction = 1;
      if (p1) this.p1.SetV(p1);
      if (p2) this.p2.SetV(p2);
      this.maxFraction = maxFraction;
   }
   b2RayCastOutput.b2RayCastOutput = function () {
      this.normal = new b2Vec2();
   };
   b2Segment.b2Segment = function () {
      this.p1 = new b2Vec2();
      this.p2 = new b2Vec2();
   };
   b2Segment.prototype.TestSegment = function (lambda, normal, segment, maxLambda) {
      if (maxLambda === undefined) maxLambda = 0;
      var s = segment.p1;
      var rX = segment.p2.x - s.x;
      var rY = segment.p2.y - s.y;
      var dX = this.p2.x - this.p1.x;
      var dY = this.p2.y - this.p1.y;
      var nX = dY;
      var nY = (-dX);
      var k_slop = 100.0 * Number.MIN_VALUE;
      var denom = (-(rX * nX + rY * nY));
      if (denom > k_slop) {
         var bX = s.x - this.p1.x;
         var bY = s.y - this.p1.y;
         var a = (bX * nX + bY * nY);
         if (0.0 <= a && a <= maxLambda * denom) {
            var mu2 = (-rX * bY) + rY * bX;
            if ((-k_slop * denom) <= mu2 && mu2 <= denom * (1.0 + k_slop)) {
               a /= denom;
               var nLen = Math.sqrt(nX * nX + nY * nY);
               nX /= nLen;
               nY /= nLen;
               lambda[0] = a;
               normal.Set(nX, nY);
               return true;
            }
         }
      }
      return false;
   }
   b2Segment.prototype.Extend = function (aabb) {
      this.ExtendForward(aabb);
      this.ExtendBackward(aabb);
   }
   b2Segment.prototype.ExtendForward = function (aabb) {
      var dX = this.p2.x - this.p1.x;
      var dY = this.p2.y - this.p1.y;
      var lambda = Math.min(dX > 0 ? (aabb.upperBound.x - this.p1.x) / dX : dX < 0 ? (aabb.lowerBound.x - this.p1.x) / dX : Number.POSITIVE_INFINITY,
      dY > 0 ? (aabb.upperBound.y - this.p1.y) / dY : dY < 0 ? (aabb.lowerBound.y - this.p1.y) / dY : Number.POSITIVE_INFINITY);
      this.p2.x = this.p1.x + dX * lambda;
      this.p2.y = this.p1.y + dY * lambda;
   }
   b2Segment.prototype.ExtendBackward = function (aabb) {
      var dX = (-this.p2.x) + this.p1.x;
      var dY = (-this.p2.y) + this.p1.y;
      var lambda = Math.min(dX > 0 ? (aabb.upperBound.x - this.p2.x) / dX : dX < 0 ? (aabb.lowerBound.x - this.p2.x) / dX : Number.POSITIVE_INFINITY,
      dY > 0 ? (aabb.upperBound.y - this.p2.y) / dY : dY < 0 ? (aabb.lowerBound.y - this.p2.y) / dY : Number.POSITIVE_INFINITY);
      this.p1.x = this.p2.x + dX * lambda;
      this.p1.y = this.p2.y + dY * lambda;
   }
   b2SeparationFunction.b2SeparationFunction = function () {
      this.m_localPoint = new b2Vec2();
      this.m_axis = new b2Vec2();
   };
   b2SeparationFunction.prototype.Initialize = function (cache, proxyA, transformA, proxyB, transformB) {
      this.m_proxyA = proxyA;
      this.m_proxyB = proxyB;
      var count = parseInt(cache.count);
      b2Settings.b2Assert(0 < count && count < 3);
      var localPointA;
      var localPointA1;
      var localPointA2;
      var localPointB;
      var localPointB1;
      var localPointB2;
      var pointAX = 0;
      var pointAY = 0;
      var pointBX = 0;
      var pointBY = 0;
      var normalX = 0;
      var normalY = 0;
      var tMat;
      var tVec;
      var s = 0;
      var sgn = 0;
      if (count == 1) {
         this.m_type = b2SeparationFunction.e_points;
         localPointA = this.m_proxyA.GetVertex(cache.indexA[0]);
         localPointB = this.m_proxyB.GetVertex(cache.indexB[0]);
         tVec = localPointA;
         tMat = transformA.R;
         pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         tVec = localPointB;
         tMat = transformB.R;
         pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         this.m_axis.x = pointBX - pointAX;
         this.m_axis.y = pointBY - pointAY;
         this.m_axis.Normalize();
      }
      else if (cache.indexB[0] == cache.indexB[1]) {
         this.m_type = b2SeparationFunction.e_faceA;
         localPointA1 = this.m_proxyA.GetVertex(cache.indexA[0]);
         localPointA2 = this.m_proxyA.GetVertex(cache.indexA[1]);
         localPointB = this.m_proxyB.GetVertex(cache.indexB[0]);
         this.m_localPoint.x = 0.5 * (localPointA1.x + localPointA2.x);
         this.m_localPoint.y = 0.5 * (localPointA1.y + localPointA2.y);
         this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointA2, localPointA1), 1.0);
         this.m_axis.Normalize();
         tVec = this.m_axis;
         tMat = transformA.R;
         normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tVec = this.m_localPoint;
         tMat = transformA.R;
         pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         tVec = localPointB;
         tMat = transformB.R;
         pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         s = (pointBX - pointAX) * normalX + (pointBY - pointAY) * normalY;
         if (s < 0.0) {
            this.m_axis.NegativeSelf();
         }
      }
      else if (cache.indexA[0] == cache.indexA[0]) {
         this.m_type = b2SeparationFunction.e_faceB;
         localPointB1 = this.m_proxyB.GetVertex(cache.indexB[0]);
         localPointB2 = this.m_proxyB.GetVertex(cache.indexB[1]);
         localPointA = this.m_proxyA.GetVertex(cache.indexA[0]);
         this.m_localPoint.x = 0.5 * (localPointB1.x + localPointB2.x);
         this.m_localPoint.y = 0.5 * (localPointB1.y + localPointB2.y);
         this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointB2, localPointB1), 1.0);
         this.m_axis.Normalize();
         tVec = this.m_axis;
         tMat = transformB.R;
         normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tVec = this.m_localPoint;
         tMat = transformB.R;
         pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         tVec = localPointA;
         tMat = transformA.R;
         pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         s = (pointAX - pointBX) * normalX + (pointAY - pointBY) * normalY;
         if (s < 0.0) {
            this.m_axis.NegativeSelf();
         }
      }
      else {
         localPointA1 = this.m_proxyA.GetVertex(cache.indexA[0]);
         localPointA2 = this.m_proxyA.GetVertex(cache.indexA[1]);
         localPointB1 = this.m_proxyB.GetVertex(cache.indexB[0]);
         localPointB2 = this.m_proxyB.GetVertex(cache.indexB[1]);
         var pA = b2Math.MulX(transformA, localPointA);
         var dA = b2Math.MulMV(transformA.R, b2Math.SubtractVV(localPointA2, localPointA1));
         var pB = b2Math.MulX(transformB, localPointB);
         var dB = b2Math.MulMV(transformB.R, b2Math.SubtractVV(localPointB2, localPointB1));
         var a = dA.x * dA.x + dA.y * dA.y;
         var e = dB.x * dB.x + dB.y * dB.y;
         var r = b2Math.SubtractVV(dB, dA);
         var c = dA.x * r.x + dA.y * r.y;
         var f = dB.x * r.x + dB.y * r.y;
         var b = dA.x * dB.x + dA.y * dB.y;
         var denom = a * e - b * b;
         s = 0.0;
         if (denom != 0.0) {
            s = b2Math.Clamp((b * f - c * e) / denom, 0.0, 1.0);
         }
         var t = (b * s + f) / e;
         if (t < 0.0) {
            t = 0.0;
            s = b2Math.Clamp((b - c) / a, 0.0, 1.0);
         }
         localPointA = new b2Vec2();
         localPointA.x = localPointA1.x + s * (localPointA2.x - localPointA1.x);
         localPointA.y = localPointA1.y + s * (localPointA2.y - localPointA1.y);
         localPointB = new b2Vec2();
         localPointB.x = localPointB1.x + s * (localPointB2.x - localPointB1.x);
         localPointB.y = localPointB1.y + s * (localPointB2.y - localPointB1.y);
         if (s == 0.0 || s == 1.0) {
            this.m_type = b2SeparationFunction.e_faceB;
            this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointB2, localPointB1), 1.0);
            this.m_axis.Normalize();
            this.m_localPoint = localPointB;
            tVec = this.m_axis;
            tMat = transformB.R;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tVec = this.m_localPoint;
            tMat = transformB.R;
            pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tVec = localPointA;
            tMat = transformA.R;
            pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            sgn = (pointAX - pointBX) * normalX + (pointAY - pointBY) * normalY;
            if (s < 0.0) {
               this.m_axis.NegativeSelf();
            }
         }
         else {
            this.m_type = b2SeparationFunction.e_faceA;
            this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointA2, localPointA1), 1.0);
            this.m_localPoint = localPointA;
            tVec = this.m_axis;
            tMat = transformA.R;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tVec = this.m_localPoint;
            tMat = transformA.R;
            pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tVec = localPointB;
            tMat = transformB.R;
            pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            sgn = (pointBX - pointAX) * normalX + (pointBY - pointAY) * normalY;
            if (s < 0.0) {
               this.m_axis.NegativeSelf();
            }
         }
      }
   }
   b2SeparationFunction.prototype.Evaluate = function (transformA, transformB) {
      var axisA;
      var axisB;
      var localPointA;
      var localPointB;
      var pointA;
      var pointB;
      var seperation = 0;
      var normal;
      switch (this.m_type) {
      case b2SeparationFunction.e_points:
         {
            axisA = b2Math.MulTMV(transformA.R, this.m_axis);
            axisB = b2Math.MulTMV(transformB.R, this.m_axis.GetNegative());
            localPointA = this.m_proxyA.GetSupportVertex(axisA);
            localPointB = this.m_proxyB.GetSupportVertex(axisB);
            pointA = b2Math.MulX(transformA, localPointA);
            pointB = b2Math.MulX(transformB, localPointB);
            seperation = (pointB.x - pointA.x) * this.m_axis.x + (pointB.y - pointA.y) * this.m_axis.y;
            return seperation;
         }
      case b2SeparationFunction.e_faceA:
         {
            normal = b2Math.MulMV(transformA.R, this.m_axis);
            pointA = b2Math.MulX(transformA, this.m_localPoint);
            axisB = b2Math.MulTMV(transformB.R, normal.GetNegative());
            localPointB = this.m_proxyB.GetSupportVertex(axisB);
            pointB = b2Math.MulX(transformB, localPointB);
            seperation = (pointB.x - pointA.x) * normal.x + (pointB.y - pointA.y) * normal.y;
            return seperation;
         }
      case b2SeparationFunction.e_faceB:
         {
            normal = b2Math.MulMV(transformB.R, this.m_axis);
            pointB = b2Math.MulX(transformB, this.m_localPoint);
            axisA = b2Math.MulTMV(transformA.R, normal.GetNegative());
            localPointA = this.m_proxyA.GetSupportVertex(axisA);
            pointA = b2Math.MulX(transformA, localPointA);
            seperation = (pointA.x - pointB.x) * normal.x + (pointA.y - pointB.y) * normal.y;
            return seperation;
         }
      default:
         b2Settings.b2Assert(false);
         return 0.0;
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2SeparationFunction.e_points = 0x01;
      Box2D.Collision.b2SeparationFunction.e_faceA = 0x02;
      Box2D.Collision.b2SeparationFunction.e_faceB = 0x04;
   });
   b2Simplex.b2Simplex = function () {
      this.m_v1 = new b2SimplexVertex();
      this.m_v2 = new b2SimplexVertex();
      this.m_v3 = new b2SimplexVertex();
      this.m_vertices = new Vector(3);
   };
   b2Simplex.prototype.b2Simplex = function () {
      this.m_vertices[0] = this.m_v1;
      this.m_vertices[1] = this.m_v2;
      this.m_vertices[2] = this.m_v3;
   }
   b2Simplex.prototype.ReadCache = function (cache, proxyA, transformA, proxyB, transformB) {
      b2Settings.b2Assert(0 <= cache.count && cache.count <= 3);
      var wALocal;
      var wBLocal;
      this.m_count = cache.count;
      var vertices = this.m_vertices;
      for (var i = 0; i < this.m_count; i++) {
         var v = vertices[i];
         v.indexA = cache.indexA[i];
         v.indexB = cache.indexB[i];
         wALocal = proxyA.GetVertex(v.indexA);
         wBLocal = proxyB.GetVertex(v.indexB);
         v.wA = b2Math.MulX(transformA, wALocal);
         v.wB = b2Math.MulX(transformB, wBLocal);
         v.w = b2Math.SubtractVV(v.wB, v.wA);
         v.a = 0;
      }
      if (this.m_count > 1) {
         var metric1 = cache.metric;
         var metric2 = this.GetMetric();
         if (metric2 < .5 * metric1 || 2.0 * metric1 < metric2 || metric2 < Number.MIN_VALUE) {
            this.m_count = 0;
         }
      }
      if (this.m_count == 0) {
         v = vertices[0];
         v.indexA = 0;
         v.indexB = 0;
         wALocal = proxyA.GetVertex(0);
         wBLocal = proxyB.GetVertex(0);
         v.wA = b2Math.MulX(transformA, wALocal);
         v.wB = b2Math.MulX(transformB, wBLocal);
         v.w = b2Math.SubtractVV(v.wB, v.wA);
         this.m_count = 1;
      }
   }
   b2Simplex.prototype.WriteCache = function (cache) {
      cache.metric = this.GetMetric();
      cache.count = Box2D.parseUInt(this.m_count);
      var vertices = this.m_vertices;
      for (var i = 0; i < this.m_count; i++) {
         cache.indexA[i] = Box2D.parseUInt(vertices[i].indexA);
         cache.indexB[i] = Box2D.parseUInt(vertices[i].indexB);
      }
   }
   b2Simplex.prototype.GetSearchDirection = function () {
      switch (this.m_count) {
      case 1:
         return this.m_v1.w.GetNegative();
      case 2:
         {
            var e12 = b2Math.SubtractVV(this.m_v2.w, this.m_v1.w);
            var sgn = b2Math.CrossVV(e12, this.m_v1.w.GetNegative());
            if (sgn > 0.0) {
               return b2Math.CrossFV(1.0, e12);
            }
            else {
               return b2Math.CrossVF(e12, 1.0);
            }
         }
      default:
         b2Settings.b2Assert(false);
         return new b2Vec2();
      }
   }
   b2Simplex.prototype.GetClosestPoint = function () {
      switch (this.m_count) {
      case 0:
         b2Settings.b2Assert(false);
         return new b2Vec2();
      case 1:
         return this.m_v1.w;
      case 2:
         return new b2Vec2(this.m_v1.a * this.m_v1.w.x + this.m_v2.a * this.m_v2.w.x, this.m_v1.a * this.m_v1.w.y + this.m_v2.a * this.m_v2.w.y);
      default:
         b2Settings.b2Assert(false);
         return new b2Vec2();
      }
   }
   b2Simplex.prototype.GetWitnessPoints = function (pA, pB) {
      switch (this.m_count) {
      case 0:
         b2Settings.b2Assert(false);
         break;
      case 1:
         pA.SetV(this.m_v1.wA);
         pB.SetV(this.m_v1.wB);
         break;
      case 2:
         pA.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x;
         pA.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y;
         pB.x = this.m_v1.a * this.m_v1.wB.x + this.m_v2.a * this.m_v2.wB.x;
         pB.y = this.m_v1.a * this.m_v1.wB.y + this.m_v2.a * this.m_v2.wB.y;
         break;
      case 3:
         pB.x = pA.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x + this.m_v3.a * this.m_v3.wA.x;
         pB.y = pA.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y + this.m_v3.a * this.m_v3.wA.y;
         break;
      default:
         b2Settings.b2Assert(false);
         break;
      }
   }
   b2Simplex.prototype.GetMetric = function () {
      switch (this.m_count) {
      case 0:
         b2Settings.b2Assert(false);
         return 0.0;
      case 1:
         return 0.0;
      case 2:
         return b2Math.SubtractVV(this.m_v1.w, this.m_v2.w).Length();
      case 3:
         return b2Math.CrossVV(b2Math.SubtractVV(this.m_v2.w, this.m_v1.w), b2Math.SubtractVV(this.m_v3.w, this.m_v1.w));
      default:
         b2Settings.b2Assert(false);
         return 0.0;
      }
   }
   b2Simplex.prototype.Solve2 = function () {
      var w1 = this.m_v1.w;
      var w2 = this.m_v2.w;
      var e12 = b2Math.SubtractVV(w2, w1);
      var d12_2 = (-(w1.x * e12.x + w1.y * e12.y));
      if (d12_2 <= 0.0) {
         this.m_v1.a = 1.0;
         this.m_count = 1;
         return;
      }
      var d12_1 = (w2.x * e12.x + w2.y * e12.y);
      if (d12_1 <= 0.0) {
         this.m_v2.a = 1.0;
         this.m_count = 1;
         this.m_v1.Set(this.m_v2);
         return;
      }
      var inv_d12 = 1.0 / (d12_1 + d12_2);
      this.m_v1.a = d12_1 * inv_d12;
      this.m_v2.a = d12_2 * inv_d12;
      this.m_count = 2;
   }
   b2Simplex.prototype.Solve3 = function () {
      var w1 = this.m_v1.w;
      var w2 = this.m_v2.w;
      var w3 = this.m_v3.w;
      var e12 = b2Math.SubtractVV(w2, w1);
      var w1e12 = b2Math.Dot(w1, e12);
      var w2e12 = b2Math.Dot(w2, e12);
      var d12_1 = w2e12;
      var d12_2 = (-w1e12);
      var e13 = b2Math.SubtractVV(w3, w1);
      var w1e13 = b2Math.Dot(w1, e13);
      var w3e13 = b2Math.Dot(w3, e13);
      var d13_1 = w3e13;
      var d13_2 = (-w1e13);
      var e23 = b2Math.SubtractVV(w3, w2);
      var w2e23 = b2Math.Dot(w2, e23);
      var w3e23 = b2Math.Dot(w3, e23);
      var d23_1 = w3e23;
      var d23_2 = (-w2e23);
      var n123 = b2Math.CrossVV(e12, e13);
      var d123_1 = n123 * b2Math.CrossVV(w2, w3);
      var d123_2 = n123 * b2Math.CrossVV(w3, w1);
      var d123_3 = n123 * b2Math.CrossVV(w1, w2);
      if (d12_2 <= 0.0 && d13_2 <= 0.0) {
         this.m_v1.a = 1.0;
         this.m_count = 1;
         return;
      }
      if (d12_1 > 0.0 && d12_2 > 0.0 && d123_3 <= 0.0) {
         var inv_d12 = 1.0 / (d12_1 + d12_2);
         this.m_v1.a = d12_1 * inv_d12;
         this.m_v2.a = d12_2 * inv_d12;
         this.m_count = 2;
         return;
      }
      if (d13_1 > 0.0 && d13_2 > 0.0 && d123_2 <= 0.0) {
         var inv_d13 = 1.0 / (d13_1 + d13_2);
         this.m_v1.a = d13_1 * inv_d13;
         this.m_v3.a = d13_2 * inv_d13;
         this.m_count = 2;
         this.m_v2.Set(this.m_v3);
         return;
      }
      if (d12_1 <= 0.0 && d23_2 <= 0.0) {
         this.m_v2.a = 1.0;
         this.m_count = 1;
         this.m_v1.Set(this.m_v2);
         return;
      }
      if (d13_1 <= 0.0 && d23_1 <= 0.0) {
         this.m_v3.a = 1.0;
         this.m_count = 1;
         this.m_v1.Set(this.m_v3);
         return;
      }
      if (d23_1 > 0.0 && d23_2 > 0.0 && d123_1 <= 0.0) {
         var inv_d23 = 1.0 / (d23_1 + d23_2);
         this.m_v2.a = d23_1 * inv_d23;
         this.m_v3.a = d23_2 * inv_d23;
         this.m_count = 2;
         this.m_v1.Set(this.m_v3);
         return;
      }
      var inv_d123 = 1.0 / (d123_1 + d123_2 + d123_3);
      this.m_v1.a = d123_1 * inv_d123;
      this.m_v2.a = d123_2 * inv_d123;
      this.m_v3.a = d123_3 * inv_d123;
      this.m_count = 3;
   }
   b2SimplexCache.b2SimplexCache = function () {
      this.indexA = new Vector_a2j_Number(3);
      this.indexB = new Vector_a2j_Number(3);
   };
   b2SimplexVertex.b2SimplexVertex = function () {};
   b2SimplexVertex.prototype.Set = function (other) {
      this.wA.SetV(other.wA);
      this.wB.SetV(other.wB);
      this.w.SetV(other.w);
      this.a = other.a;
      this.indexA = other.indexA;
      this.indexB = other.indexB;
   }
   b2TimeOfImpact.b2TimeOfImpact = function () {};
   b2TimeOfImpact.TimeOfImpact = function (input) {
      ++b2TimeOfImpact.b2_toiCalls;
      var proxyA = input.proxyA;
      var proxyB = input.proxyB;
      var sweepA = input.sweepA;
      var sweepB = input.sweepB;
      b2Settings.b2Assert(sweepA.t0 == sweepB.t0);
      b2Settings.b2Assert(1.0 - sweepA.t0 > Number.MIN_VALUE);
      var radius = proxyA.m_radius + proxyB.m_radius;
      var tolerance = input.tolerance;
      var alpha = 0.0;
      var k_maxIterations = 1000;
      var iter = 0;
      var target = 0.0;
      b2TimeOfImpact.s_cache.count = 0;
      b2TimeOfImpact.s_distanceInput.useRadii = false;
      for (;;) {
         sweepA.GetTransform(b2TimeOfImpact.s_xfA, alpha);
         sweepB.GetTransform(b2TimeOfImpact.s_xfB, alpha);
         b2TimeOfImpact.s_distanceInput.proxyA = proxyA;
         b2TimeOfImpact.s_distanceInput.proxyB = proxyB;
         b2TimeOfImpact.s_distanceInput.transformA = b2TimeOfImpact.s_xfA;
         b2TimeOfImpact.s_distanceInput.transformB = b2TimeOfImpact.s_xfB;
         b2Distance.Distance(b2TimeOfImpact.s_distanceOutput, b2TimeOfImpact.s_cache, b2TimeOfImpact.s_distanceInput);
         if (b2TimeOfImpact.s_distanceOutput.distance <= 0.0) {
            alpha = 1.0;
            break;
         }
         b2TimeOfImpact.s_fcn.Initialize(b2TimeOfImpact.s_cache, proxyA, b2TimeOfImpact.s_xfA, proxyB, b2TimeOfImpact.s_xfB);
         var separation = b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA, b2TimeOfImpact.s_xfB);
         if (separation <= 0.0) {
            alpha = 1.0;
            break;
         }
         if (iter == 0) {
            if (separation > radius) {
               target = b2Math.Max(radius - tolerance, 0.75 * radius);
            }
            else {
               target = b2Math.Max(separation - tolerance, 0.02 * radius);
            }
         }
         if (separation - target < 0.5 * tolerance) {
            if (iter == 0) {
               alpha = 1.0;
               break;
            }
            break;
         }
         var newAlpha = alpha; {
            var x1 = alpha;
            var x2 = 1.0;
            var f1 = separation;
            sweepA.GetTransform(b2TimeOfImpact.s_xfA, x2);
            sweepB.GetTransform(b2TimeOfImpact.s_xfB, x2);
            var f2 = b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA, b2TimeOfImpact.s_xfB);
            if (f2 >= target) {
               alpha = 1.0;
               break;
            }
            var rootIterCount = 0;
            for (;;) {
               var x = 0;
               if (rootIterCount & 1) {
                  x = x1 + (target - f1) * (x2 - x1) / (f2 - f1);
               }
               else {
                  x = 0.5 * (x1 + x2);
               }
               sweepA.GetTransform(b2TimeOfImpact.s_xfA, x);
               sweepB.GetTransform(b2TimeOfImpact.s_xfB, x);
               var f = b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA, b2TimeOfImpact.s_xfB);
               if (b2Math.Abs(f - target) < 0.025 * tolerance) {
                  newAlpha = x;
                  break;
               }
               if (f > target) {
                  x1 = x;
                  f1 = f;
               }
               else {
                  x2 = x;
                  f2 = f;
               }++rootIterCount;
               ++b2TimeOfImpact.b2_toiRootIters;
               if (rootIterCount == 50) {
                  break;
               }
            }
            b2TimeOfImpact.b2_toiMaxRootIters = b2Math.Max(b2TimeOfImpact.b2_toiMaxRootIters, rootIterCount);
         }
         if (newAlpha < (1.0 + 100.0 * Number.MIN_VALUE) * alpha) {
            break;
         }
         alpha = newAlpha;
         iter++;
         ++b2TimeOfImpact.b2_toiIters;
         if (iter == k_maxIterations) {
            break;
         }
      }
      b2TimeOfImpact.b2_toiMaxIters = b2Math.Max(b2TimeOfImpact.b2_toiMaxIters, iter);
      return alpha;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2TimeOfImpact.b2_toiCalls = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiIters = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiRootIters = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters = 0;
      Box2D.Collision.b2TimeOfImpact.s_cache = new b2SimplexCache();
      Box2D.Collision.b2TimeOfImpact.s_distanceInput = new b2DistanceInput();
      Box2D.Collision.b2TimeOfImpact.s_xfA = new b2Transform();
      Box2D.Collision.b2TimeOfImpact.s_xfB = new b2Transform();
      Box2D.Collision.b2TimeOfImpact.s_fcn = new b2SeparationFunction();
      Box2D.Collision.b2TimeOfImpact.s_distanceOutput = new b2DistanceOutput();
   });
   b2TOIInput.b2TOIInput = function () {
      this.proxyA = new b2DistanceProxy();
      this.proxyB = new b2DistanceProxy();
      this.sweepA = new b2Sweep();
      this.sweepB = new b2Sweep();
   };
   b2WorldManifold.b2WorldManifold = function () {
      this.m_normal = new b2Vec2();
   };
   b2WorldManifold.prototype.b2WorldManifold = function () {
      this.m_points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.m_points[i] = new b2Vec2();
      }
   }
   b2WorldManifold.prototype.Initialize = function (manifold, xfA, radiusA, xfB, radiusB) {
      if (radiusA === undefined) radiusA = 0;
      if (radiusB === undefined) radiusB = 0;
      if (manifold.m_pointCount == 0) {
         return;
      }
      var i = 0;
      var tVec;
      var tMat;
      var normalX = 0;
      var normalY = 0;
      var planePointX = 0;
      var planePointY = 0;
      var clipPointX = 0;
      var clipPointY = 0;
      switch (manifold.m_type) {
      case b2Manifold.e_circles:
         {
            tMat = xfA.R;
            tVec = manifold.m_localPoint;
            var pointAX = xfA.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            var pointAY = xfA.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = xfB.R;
            tVec = manifold.m_points[0].m_localPoint;
            var pointBX = xfB.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            var pointBY = xfB.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            var dX = pointBX - pointAX;
            var dY = pointBY - pointAY;
            var d2 = dX * dX + dY * dY;
            if (d2 > Number.MIN_VALUE * Number.MIN_VALUE) {
               var d = Math.sqrt(d2);
               this.m_normal.x = dX / d;
               this.m_normal.y = dY / d;
            }
            else {
               this.m_normal.x = 1;
               this.m_normal.y = 0;
            }
            var cAX = pointAX + radiusA * this.m_normal.x;
            var cAY = pointAY + radiusA * this.m_normal.y;
            var cBX = pointBX - radiusB * this.m_normal.x;
            var cBY = pointBY - radiusB * this.m_normal.y;
            this.m_points[0].x = 0.5 * (cAX + cBX);
            this.m_points[0].y = 0.5 * (cAY + cBY);
         }
         break;
      case b2Manifold.e_faceA:
         {
            tMat = xfA.R;
            tVec = manifold.m_localPlaneNormal;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = xfA.R;
            tVec = manifold.m_localPoint;
            planePointX = xfA.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            planePointY = xfA.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            this.m_normal.x = normalX;
            this.m_normal.y = normalY;
            for (i = 0;
            i < manifold.m_pointCount; i++) {
               tMat = xfB.R;
               tVec = manifold.m_points[i].m_localPoint;
               clipPointX = xfB.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
               clipPointY = xfB.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
               this.m_points[i].x = clipPointX + 0.5 * (radiusA - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusB) * normalX;
               this.m_points[i].y = clipPointY + 0.5 * (radiusA - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusB) * normalY;
            }
         }
         break;
      case b2Manifold.e_faceB:
         {
            tMat = xfB.R;
            tVec = manifold.m_localPlaneNormal;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = xfB.R;
            tVec = manifold.m_localPoint;
            planePointX = xfB.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            planePointY = xfB.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            this.m_normal.x = (-normalX);
            this.m_normal.y = (-normalY);
            for (i = 0;
            i < manifold.m_pointCount; i++) {
               tMat = xfA.R;
               tVec = manifold.m_points[i].m_localPoint;
               clipPointX = xfA.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
               clipPointY = xfA.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
               this.m_points[i].x = clipPointX + 0.5 * (radiusB - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusA) * normalX;
               this.m_points[i].y = clipPointY + 0.5 * (radiusB - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusA) * normalY;
            }
         }
         break;
      }
   }
   ClipVertex.ClipVertex = function () {
      this.v = new b2Vec2();
      this.id = new b2ContactID();
   };
   ClipVertex.prototype.Set = function (other) {
      this.v.SetV(other.v);
      this.id.Set(other.id);
   }
   Features.Features = function () {};
   Object.defineProperty(Features.prototype, 'referenceEdge', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._referenceEdge;
      }
   });
   Object.defineProperty(Features.prototype, 'referenceEdge', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._referenceEdge = value;
         this._m_id._key = (this._m_id._key & 0xffffff00) | (this._referenceEdge & 0x000000ff);
      }
   });
   Object.defineProperty(Features.prototype, 'incidentEdge', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._incidentEdge;
      }
   });
   Object.defineProperty(Features.prototype, 'incidentEdge', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._incidentEdge = value;
         this._m_id._key = (this._m_id._key & 0xffff00ff) | ((this._incidentEdge << 8) & 0x0000ff00);
      }
   });
   Object.defineProperty(Features.prototype, 'incidentVertex', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._incidentVertex;
      }
   });
   Object.defineProperty(Features.prototype, 'incidentVertex', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._incidentVertex = value;
         this._m_id._key = (this._m_id._key & 0xff00ffff) | ((this._incidentVertex << 16) & 0x00ff0000);
      }
   });
   Object.defineProperty(Features.prototype, 'flip', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._flip;
      }
   });
   Object.defineProperty(Features.prototype, 'flip', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._flip = value;
         this._m_id._key = (this._m_id._key & 0x00ffffff) | ((this._flip << 24) & 0xff000000);
      }
   });
})();
(function () {
   var b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase;

   Box2D.inherit(b2CircleShape, Box2D.Collision.Shapes.b2Shape);
   b2CircleShape.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype;
   b2CircleShape.b2CircleShape = function () {
      Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments);
      this.m_p = new b2Vec2();
   };
   b2CircleShape.prototype.Copy = function () {
      var s = new b2CircleShape();
      s.Set(this);
      return s;
   }
   b2CircleShape.prototype.Set = function (other) {
      this.__super.Set.call(this, other);
      if (Box2D.is(other, b2CircleShape)) {
         var other2 = (other instanceof b2CircleShape ? other : null);
         this.m_p.SetV(other2.m_p);
      }
   }
   b2CircleShape.prototype.TestPoint = function (transform, p) {
      var tMat = transform.R;
      var dX = transform.position.x + (tMat.col1.x * this.m_p.x + tMat.col2.x * this.m_p.y);
      var dY = transform.position.y + (tMat.col1.y * this.m_p.x + tMat.col2.y * this.m_p.y);
      dX = p.x - dX;
      dY = p.y - dY;
      return (dX * dX + dY * dY) <= this.m_radius * this.m_radius;
   }
   b2CircleShape.prototype.RayCast = function (output, input, transform) {
      var tMat = transform.R;
      var positionX = transform.position.x + (tMat.col1.x * this.m_p.x + tMat.col2.x * this.m_p.y);
      var positionY = transform.position.y + (tMat.col1.y * this.m_p.x + tMat.col2.y * this.m_p.y);
      var sX = input.p1.x - positionX;
      var sY = input.p1.y - positionY;
      var b = (sX * sX + sY * sY) - this.m_radius * this.m_radius;
      var rX = input.p2.x - input.p1.x;
      var rY = input.p2.y - input.p1.y;
      var c = (sX * rX + sY * rY);
      var rr = (rX * rX + rY * rY);
      var sigma = c * c - rr * b;
      if (sigma < 0.0 || rr < Number.MIN_VALUE) {
         return false;
      }
      var a = (-(c + Math.sqrt(sigma)));
      if (0.0 <= a && a <= input.maxFraction * rr) {
         a /= rr;
         output.fraction = a;
         output.normal.x = sX + a * rX;
         output.normal.y = sY + a * rY;
         output.normal.Normalize();
         return true;
      }
      return false;
   }
   b2CircleShape.prototype.ComputeAABB = function (aabb, transform) {
      var tMat = transform.R;
      var pX = transform.position.x + (tMat.col1.x * this.m_p.x + tMat.col2.x * this.m_p.y);
      var pY = transform.position.y + (tMat.col1.y * this.m_p.x + tMat.col2.y * this.m_p.y);
      aabb.lowerBound.Set(pX - this.m_radius, pY - this.m_radius);
      aabb.upperBound.Set(pX + this.m_radius, pY + this.m_radius);
   }
   b2CircleShape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
      massData.mass = density * b2Settings.b2_pi * this.m_radius * this.m_radius;
      massData.center.SetV(this.m_p);
      massData.I = massData.mass * (0.5 * this.m_radius * this.m_radius + (this.m_p.x * this.m_p.x + this.m_p.y * this.m_p.y));
   }
   b2CircleShape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      var p = b2Math.MulX(xf, this.m_p);
      var l = (-(b2Math.Dot(normal, p) - offset));
      if (l < (-this.m_radius) + Number.MIN_VALUE) {
         return 0;
      }
      if (l > this.m_radius) {
         c.SetV(p);
         return Math.PI * this.m_radius * this.m_radius;
      }
      var r2 = this.m_radius * this.m_radius;
      var l2 = l * l;
      var area = r2 * (Math.asin(l / this.m_radius) + Math.PI / 2) + l * Math.sqrt(r2 - l2);
      var com = (-2 / 3 * Math.pow(r2 - l2, 1.5) / area);
      c.x = p.x + normal.x * com;
      c.y = p.y + normal.y * com;
      return area;
   }
   b2CircleShape.prototype.GetLocalPosition = function () {
      return this.m_p;
   }
   b2CircleShape.prototype.SetLocalPosition = function (position) {
      this.m_p.SetV(position);
   }
   b2CircleShape.prototype.GetRadius = function () {
      return this.m_radius;
   }
   b2CircleShape.prototype.SetRadius = function (radius) {
      if (radius === undefined) radius = 0;
      this.m_radius = radius;
   }
   b2CircleShape.prototype.b2CircleShape = function (radius) {
      if (radius === undefined) radius = 0;
      this.__super.b2Shape.call(this);
      this.m_type = b2Shape.e_circleShape;
      this.m_radius = radius;
   }
   b2EdgeChainDef.b2EdgeChainDef = function () {};
   b2EdgeChainDef.prototype.b2EdgeChainDef = function () {
      this.vertexCount = 0;
      this.isALoop = true;
      this.vertices = [];
   }
   Box2D.inherit(b2EdgeShape, Box2D.Collision.Shapes.b2Shape);
   b2EdgeShape.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype;
   b2EdgeShape.b2EdgeShape = function () {
      Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments);
      this.s_supportVec = new b2Vec2();
      this.m_v1 = new b2Vec2();
      this.m_v2 = new b2Vec2();
      this.m_coreV1 = new b2Vec2();
      this.m_coreV2 = new b2Vec2();
      this.m_normal = new b2Vec2();
      this.m_direction = new b2Vec2();
      this.m_cornerDir1 = new b2Vec2();
      this.m_cornerDir2 = new b2Vec2();
   };
   b2EdgeShape.prototype.TestPoint = function (transform, p) {
      return false;
   }
   b2EdgeShape.prototype.RayCast = function (output, input, transform) {
      var tMat;
      var rX = input.p2.x - input.p1.x;
      var rY = input.p2.y - input.p1.y;
      tMat = transform.R;
      var v1X = transform.position.x + (tMat.col1.x * this.m_v1.x + tMat.col2.x * this.m_v1.y);
      var v1Y = transform.position.y + (tMat.col1.y * this.m_v1.x + tMat.col2.y * this.m_v1.y);
      var nX = transform.position.y + (tMat.col1.y * this.m_v2.x + tMat.col2.y * this.m_v2.y) - v1Y;
      var nY = (-(transform.position.x + (tMat.col1.x * this.m_v2.x + tMat.col2.x * this.m_v2.y) - v1X));
      var k_slop = 100.0 * Number.MIN_VALUE;
      var denom = (-(rX * nX + rY * nY));
      if (denom > k_slop) {
         var bX = input.p1.x - v1X;
         var bY = input.p1.y - v1Y;
         var a = (bX * nX + bY * nY);
         if (0.0 <= a && a <= input.maxFraction * denom) {
            var mu2 = (-rX * bY) + rY * bX;
            if ((-k_slop * denom) <= mu2 && mu2 <= denom * (1.0 + k_slop)) {
               a /= denom;
               output.fraction = a;
               var nLen = Math.sqrt(nX * nX + nY * nY);
               output.normal.x = nX / nLen;
               output.normal.y = nY / nLen;
               return true;
            }
         }
      }
      return false;
   }
   b2EdgeShape.prototype.ComputeAABB = function (aabb, transform) {
      var tMat = transform.R;
      var v1X = transform.position.x + (tMat.col1.x * this.m_v1.x + tMat.col2.x * this.m_v1.y);
      var v1Y = transform.position.y + (tMat.col1.y * this.m_v1.x + tMat.col2.y * this.m_v1.y);
      var v2X = transform.position.x + (tMat.col1.x * this.m_v2.x + tMat.col2.x * this.m_v2.y);
      var v2Y = transform.position.y + (tMat.col1.y * this.m_v2.x + tMat.col2.y * this.m_v2.y);
      if (v1X < v2X) {
         aabb.lowerBound.x = v1X;
         aabb.upperBound.x = v2X;
      }
      else {
         aabb.lowerBound.x = v2X;
         aabb.upperBound.x = v1X;
      }
      if (v1Y < v2Y) {
         aabb.lowerBound.y = v1Y;
         aabb.upperBound.y = v2Y;
      }
      else {
         aabb.lowerBound.y = v2Y;
         aabb.upperBound.y = v1Y;
      }
   }
   b2EdgeShape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
      massData.mass = 0;
      massData.center.SetV(this.m_v1);
      massData.I = 0;
   }
   b2EdgeShape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      var v0 = new b2Vec2(normal.x * offset, normal.y * offset);
      var v1 = b2Math.MulX(xf, this.m_v1);
      var v2 = b2Math.MulX(xf, this.m_v2);
      var d1 = b2Math.Dot(normal, v1) - offset;
      var d2 = b2Math.Dot(normal, v2) - offset;
      if (d1 > 0) {
         if (d2 > 0) {
            return 0;
         }
         else {
            v1.x = (-d2 / (d1 - d2) * v1.x) + d1 / (d1 - d2) * v2.x;
            v1.y = (-d2 / (d1 - d2) * v1.y) + d1 / (d1 - d2) * v2.y;
         }
      }
      else {
         if (d2 > 0) {
            v2.x = (-d2 / (d1 - d2) * v1.x) + d1 / (d1 - d2) * v2.x;
            v2.y = (-d2 / (d1 - d2) * v1.y) + d1 / (d1 - d2) * v2.y;
         }
         else {}
      }
      c.x = (v0.x + v1.x + v2.x) / 3;
      c.y = (v0.y + v1.y + v2.y) / 3;
      return 0.5 * ((v1.x - v0.x) * (v2.y - v0.y) - (v1.y - v0.y) * (v2.x - v0.x));
   }
   b2EdgeShape.prototype.GetLength = function () {
      return this.m_length;
   }
   b2EdgeShape.prototype.GetVertex1 = function () {
      return this.m_v1;
   }
   b2EdgeShape.prototype.GetVertex2 = function () {
      return this.m_v2;
   }
   b2EdgeShape.prototype.GetCoreVertex1 = function () {
      return this.m_coreV1;
   }
   b2EdgeShape.prototype.GetCoreVertex2 = function () {
      return this.m_coreV2;
   }
   b2EdgeShape.prototype.GetNormalVector = function () {
      return this.m_normal;
   }
   b2EdgeShape.prototype.GetDirectionVector = function () {
      return this.m_direction;
   }
   b2EdgeShape.prototype.GetCorner1Vector = function () {
      return this.m_cornerDir1;
   }
   b2EdgeShape.prototype.GetCorner2Vector = function () {
      return this.m_cornerDir2;
   }
   b2EdgeShape.prototype.Corner1IsConvex = function () {
      return this.m_cornerConvex1;
   }
   b2EdgeShape.prototype.Corner2IsConvex = function () {
      return this.m_cornerConvex2;
   }
   b2EdgeShape.prototype.GetFirstVertex = function (xf) {
      var tMat = xf.R;
      return new b2Vec2(xf.position.x + (tMat.col1.x * this.m_coreV1.x + tMat.col2.x * this.m_coreV1.y), xf.position.y + (tMat.col1.y * this.m_coreV1.x + tMat.col2.y * this.m_coreV1.y));
   }
   b2EdgeShape.prototype.GetNextEdge = function () {
      return this.m_nextEdge;
   }
   b2EdgeShape.prototype.GetPrevEdge = function () {
      return this.m_prevEdge;
   }
   b2EdgeShape.prototype.Support = function (xf, dX, dY) {
      if (dX === undefined) dX = 0;
      if (dY === undefined) dY = 0;
      var tMat = xf.R;
      var v1X = xf.position.x + (tMat.col1.x * this.m_coreV1.x + tMat.col2.x * this.m_coreV1.y);
      var v1Y = xf.position.y + (tMat.col1.y * this.m_coreV1.x + tMat.col2.y * this.m_coreV1.y);
      var v2X = xf.position.x + (tMat.col1.x * this.m_coreV2.x + tMat.col2.x * this.m_coreV2.y);
      var v2Y = xf.position.y + (tMat.col1.y * this.m_coreV2.x + tMat.col2.y * this.m_coreV2.y);
      if ((v1X * dX + v1Y * dY) > (v2X * dX + v2Y * dY)) {
         this.s_supportVec.x = v1X;
         this.s_supportVec.y = v1Y;
      }
      else {
         this.s_supportVec.x = v2X;
         this.s_supportVec.y = v2Y;
      }
      return this.s_supportVec;
   }
   b2EdgeShape.prototype.b2EdgeShape = function (v1, v2) {
      this.__super.b2Shape.call(this);
      this.m_type = b2Shape.e_edgeShape;
      this.m_prevEdge = null;
      this.m_nextEdge = null;
      this.m_v1 = v1;
      this.m_v2 = v2;
      this.m_direction.Set(this.m_v2.x - this.m_v1.x, this.m_v2.y - this.m_v1.y);
      this.m_length = this.m_direction.Normalize();
      this.m_normal.Set(this.m_direction.y, (-this.m_direction.x));
      this.m_coreV1.Set((-b2Settings.b2_toiSlop * (this.m_normal.x - this.m_direction.x)) + this.m_v1.x, (-b2Settings.b2_toiSlop * (this.m_normal.y - this.m_direction.y)) + this.m_v1.y);
      this.m_coreV2.Set((-b2Settings.b2_toiSlop * (this.m_normal.x + this.m_direction.x)) + this.m_v2.x, (-b2Settings.b2_toiSlop * (this.m_normal.y + this.m_direction.y)) + this.m_v2.y);
      this.m_cornerDir1 = this.m_normal;
      this.m_cornerDir2.Set((-this.m_normal.x), (-this.m_normal.y));
   }
   b2EdgeShape.prototype.SetPrevEdge = function (edge, core, cornerDir, convex) {
      this.m_prevEdge = edge;
      this.m_coreV1 = core;
      this.m_cornerDir1 = cornerDir;
      this.m_cornerConvex1 = convex;
   }
   b2EdgeShape.prototype.SetNextEdge = function (edge, core, cornerDir, convex) {
      this.m_nextEdge = edge;
      this.m_coreV2 = core;
      this.m_cornerDir2 = cornerDir;
      this.m_cornerConvex2 = convex;
   }
   b2MassData.b2MassData = function () {
      this.mass = 0.0;
      this.center = new b2Vec2(0, 0);
      this.I = 0.0;
   };
   Box2D.inherit(b2PolygonShape, Box2D.Collision.Shapes.b2Shape);
   b2PolygonShape.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype;
   b2PolygonShape.b2PolygonShape = function () {
      Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments);
   };
   b2PolygonShape.prototype.Copy = function () {
      var s = new b2PolygonShape();
      s.Set(this);
      return s;
   }
   b2PolygonShape.prototype.Set = function (other) {
      this.__super.Set.call(this, other);
      if (Box2D.is(other, b2PolygonShape)) {
         var other2 = (other instanceof b2PolygonShape ? other : null);
         this.m_centroid.SetV(other2.m_centroid);
         this.m_vertexCount = other2.m_vertexCount;
         this.Reserve(this.m_vertexCount);
         for (var i = 0; i < this.m_vertexCount; i++) {
            this.m_vertices[i].SetV(other2.m_vertices[i]);
            this.m_normals[i].SetV(other2.m_normals[i]);
         }
      }
   }
   b2PolygonShape.prototype.SetAsArray = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      var v = new Vector();
      var i = 0,
         tVec;
      for (i = 0;
      i < vertices.length; ++i) {
         tVec = vertices[i];
         v.push(tVec);
      }
      this.SetAsVector(v, vertexCount);
   }
   b2PolygonShape.AsArray = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsArray(vertices, vertexCount);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsVector = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      if (vertexCount == 0) vertexCount = vertices.length;
      b2Settings.b2Assert(2 <= vertexCount);
      this.m_vertexCount = vertexCount;
      this.Reserve(vertexCount);
      var i = 0;
      for (i = 0;
      i < this.m_vertexCount; i++) {
         this.m_vertices[i].SetV(vertices[i]);
      }
      for (i = 0;
      i < this.m_vertexCount; ++i) {
         var i1 = parseInt(i);
         var i2 = parseInt(i + 1 < this.m_vertexCount ? i + 1 : 0);
         var edge = b2Math.SubtractVV(this.m_vertices[i2], this.m_vertices[i1]);
         b2Settings.b2Assert(edge.LengthSquared() > Number.MIN_VALUE);
         this.m_normals[i].SetV(b2Math.CrossVF(edge, 1.0));
         this.m_normals[i].Normalize();
      }
      this.m_centroid = b2PolygonShape.ComputeCentroid(this.m_vertices, this.m_vertexCount);
   }
   b2PolygonShape.AsVector = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsVector(vertices, vertexCount);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsBox = function (hx, hy) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      this.m_vertexCount = 4;
      this.Reserve(4);
      this.m_vertices[0].Set((-hx), (-hy));
      this.m_vertices[1].Set(hx, (-hy));
      this.m_vertices[2].Set(hx, hy);
      this.m_vertices[3].Set((-hx), hy);
      this.m_normals[0].Set(0.0, (-1.0));
      this.m_normals[1].Set(1.0, 0.0);
      this.m_normals[2].Set(0.0, 1.0);
      this.m_normals[3].Set((-1.0), 0.0);
      this.m_centroid.SetZero();
   }
   b2PolygonShape.AsBox = function (hx, hy) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsBox(hx, hy);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsOrientedBox = function (hx, hy, center, angle) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      if (center === undefined) center = null;
      if (angle === undefined) angle = 0.0;
      this.m_vertexCount = 4;
      this.Reserve(4);
      this.m_vertices[0].Set((-hx), (-hy));
      this.m_vertices[1].Set(hx, (-hy));
      this.m_vertices[2].Set(hx, hy);
      this.m_vertices[3].Set((-hx), hy);
      this.m_normals[0].Set(0.0, (-1.0));
      this.m_normals[1].Set(1.0, 0.0);
      this.m_normals[2].Set(0.0, 1.0);
      this.m_normals[3].Set((-1.0), 0.0);
      this.m_centroid = center;
      var xf = new b2Transform();
      xf.position = center;
      xf.R.Set(angle);
      for (var i = 0; i < this.m_vertexCount; ++i) {
         this.m_vertices[i] = b2Math.MulX(xf, this.m_vertices[i]);
         this.m_normals[i] = b2Math.MulMV(xf.R, this.m_normals[i]);
      }
   }
   b2PolygonShape.AsOrientedBox = function (hx, hy, center, angle) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      if (center === undefined) center = null;
      if (angle === undefined) angle = 0.0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsOrientedBox(hx, hy, center, angle);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsEdge = function (v1, v2) {
      this.m_vertexCount = 2;
      this.Reserve(2);
      this.m_vertices[0].SetV(v1);
      this.m_vertices[1].SetV(v2);
      this.m_centroid.x = 0.5 * (v1.x + v2.x);
      this.m_centroid.y = 0.5 * (v1.y + v2.y);
      this.m_normals[0] = b2Math.CrossVF(b2Math.SubtractVV(v2, v1), 1.0);
      this.m_normals[0].Normalize();
      this.m_normals[1].x = (-this.m_normals[0].x);
      this.m_normals[1].y = (-this.m_normals[0].y);
   }
   b2PolygonShape.AsEdge = function (v1, v2) {
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsEdge(v1, v2);
      return polygonShape;
   }
   b2PolygonShape.prototype.TestPoint = function (xf, p) {
      var tVec;
      var tMat = xf.R;
      var tX = p.x - xf.position.x;
      var tY = p.y - xf.position.y;
      var pLocalX = (tX * tMat.col1.x + tY * tMat.col1.y);
      var pLocalY = (tX * tMat.col2.x + tY * tMat.col2.y);
      for (var i = 0; i < this.m_vertexCount; ++i) {
         tVec = this.m_vertices[i];
         tX = pLocalX - tVec.x;
         tY = pLocalY - tVec.y;
         tVec = this.m_normals[i];
         var dot = (tVec.x * tX + tVec.y * tY);
         if (dot > 0.0) {
            return false;
         }
      }
      return true;
   }
   b2PolygonShape.prototype.RayCast = function (output, input, transform) {
      var lower = 0.0;
      var upper = input.maxFraction;
      var tX = 0;
      var tY = 0;
      var tMat;
      var tVec;
      tX = input.p1.x - transform.position.x;
      tY = input.p1.y - transform.position.y;
      tMat = transform.R;
      var p1X = (tX * tMat.col1.x + tY * tMat.col1.y);
      var p1Y = (tX * tMat.col2.x + tY * tMat.col2.y);
      tX = input.p2.x - transform.position.x;
      tY = input.p2.y - transform.position.y;
      tMat = transform.R;
      var p2X = (tX * tMat.col1.x + tY * tMat.col1.y);
      var p2Y = (tX * tMat.col2.x + tY * tMat.col2.y);
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var index = parseInt((-1));
      for (var i = 0; i < this.m_vertexCount; ++i) {
         tVec = this.m_vertices[i];
         tX = tVec.x - p1X;
         tY = tVec.y - p1Y;
         tVec = this.m_normals[i];
         var numerator = (tVec.x * tX + tVec.y * tY);
         var denominator = (tVec.x * dX + tVec.y * dY);
         if (denominator == 0.0) {
            if (numerator < 0.0) {
               return false;
            }
         }
         else {
            if (denominator < 0.0 && numerator < lower * denominator) {
               lower = numerator / denominator;
               index = i;
            }
            else if (denominator > 0.0 && numerator < upper * denominator) {
               upper = numerator / denominator;
            }
         }
         if (upper < lower - Number.MIN_VALUE) {
            return false;
         }
      }
      if (index >= 0) {
         output.fraction = lower;
         tMat = transform.R;
         tVec = this.m_normals[index];
         output.normal.x = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         output.normal.y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         return true;
      }
      return false;
   }
   b2PolygonShape.prototype.ComputeAABB = function (aabb, xf) {
      var tMat = xf.R;
      var tVec = this.m_vertices[0];
      var lowerX = xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var lowerY = xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var upperX = lowerX;
      var upperY = lowerY;
      for (var i = 1; i < this.m_vertexCount; ++i) {
         tVec = this.m_vertices[i];
         var vX = xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         var vY = xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         lowerX = lowerX < vX ? lowerX : vX;
         lowerY = lowerY < vY ? lowerY : vY;
         upperX = upperX > vX ? upperX : vX;
         upperY = upperY > vY ? upperY : vY;
      }
      aabb.lowerBound.x = lowerX - this.m_radius;
      aabb.lowerBound.y = lowerY - this.m_radius;
      aabb.upperBound.x = upperX + this.m_radius;
      aabb.upperBound.y = upperY + this.m_radius;
   }
   b2PolygonShape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
      if (this.m_vertexCount == 2) {
         massData.center.x = 0.5 * (this.m_vertices[0].x + this.m_vertices[1].x);
         massData.center.y = 0.5 * (this.m_vertices[0].y + this.m_vertices[1].y);
         massData.mass = 0.0;
         massData.I = 0.0;
         return;
      }
      var centerX = 0.0;
      var centerY = 0.0;
      var area = 0.0;
      var I = 0.0;
      var p1X = 0.0;
      var p1Y = 0.0;
      var k_inv3 = 1.0 / 3.0;
      for (var i = 0; i < this.m_vertexCount; ++i) {
         var p2 = this.m_vertices[i];
         var p3 = i + 1 < this.m_vertexCount ? this.m_vertices[parseInt(i + 1)] : this.m_vertices[0];
         var e1X = p2.x - p1X;
         var e1Y = p2.y - p1Y;
         var e2X = p3.x - p1X;
         var e2Y = p3.y - p1Y;
         var D = e1X * e2Y - e1Y * e2X;
         var triangleArea = 0.5 * D;area += triangleArea;
         centerX += triangleArea * k_inv3 * (p1X + p2.x + p3.x);
         centerY += triangleArea * k_inv3 * (p1Y + p2.y + p3.y);
         var px = p1X;
         var py = p1Y;
         var ex1 = e1X;
         var ey1 = e1Y;
         var ex2 = e2X;
         var ey2 = e2Y;
         var intx2 = k_inv3 * (0.25 * (ex1 * ex1 + ex2 * ex1 + ex2 * ex2) + (px * ex1 + px * ex2)) + 0.5 * px * px;
         var inty2 = k_inv3 * (0.25 * (ey1 * ey1 + ey2 * ey1 + ey2 * ey2) + (py * ey1 + py * ey2)) + 0.5 * py * py;I += D * (intx2 + inty2);
      }
      massData.mass = density * area;
      centerX *= 1.0 / area;
      centerY *= 1.0 / area;
      massData.center.Set(centerX, centerY);
      massData.I = density * I;
   }
   b2PolygonShape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      var normalL = b2Math.MulTMV(xf.R, normal);
      var offsetL = offset - b2Math.Dot(normal, xf.position);
      var depths = new Vector_a2j_Number();
      var diveCount = 0;
      var intoIndex = parseInt((-1));
      var outoIndex = parseInt((-1));
      var lastSubmerged = false;
      var i = 0;
      for (i = 0;
      i < this.m_vertexCount; ++i) {
         depths[i] = b2Math.Dot(normalL, this.m_vertices[i]) - offsetL;
         var isSubmerged = depths[i] < (-Number.MIN_VALUE);
         if (i > 0) {
            if (isSubmerged) {
               if (!lastSubmerged) {
                  intoIndex = i - 1;
                  diveCount++;
               }
            }
            else {
               if (lastSubmerged) {
                  outoIndex = i - 1;
                  diveCount++;
               }
            }
         }
         lastSubmerged = isSubmerged;
      }
      switch (diveCount) {
      case 0:
         if (lastSubmerged) {
            var md = new b2MassData();
            this.ComputeMass(md, 1);
            c.SetV(b2Math.MulX(xf, md.center));
            return md.mass;
         }
         else {
            return 0;
         }
         break;
      case 1:
         if (intoIndex == (-1)) {
            intoIndex = this.m_vertexCount - 1;
         }
         else {
            outoIndex = this.m_vertexCount - 1;
         }
         break;
      }
      var intoIndex2 = parseInt((intoIndex + 1) % this.m_vertexCount);
      var outoIndex2 = parseInt((outoIndex + 1) % this.m_vertexCount);
      var intoLamdda = (0 - depths[intoIndex]) / (depths[intoIndex2] - depths[intoIndex]);
      var outoLamdda = (0 - depths[outoIndex]) / (depths[outoIndex2] - depths[outoIndex]);
      var intoVec = new b2Vec2(this.m_vertices[intoIndex].x * (1 - intoLamdda) + this.m_vertices[intoIndex2].x * intoLamdda, this.m_vertices[intoIndex].y * (1 - intoLamdda) + this.m_vertices[intoIndex2].y * intoLamdda);
      var outoVec = new b2Vec2(this.m_vertices[outoIndex].x * (1 - outoLamdda) + this.m_vertices[outoIndex2].x * outoLamdda, this.m_vertices[outoIndex].y * (1 - outoLamdda) + this.m_vertices[outoIndex2].y * outoLamdda);
      var area = 0;
      var center = new b2Vec2();
      var p2 = this.m_vertices[intoIndex2];
      var p3;
      i = intoIndex2;
      while (i != outoIndex2) {
         i = (i + 1) % this.m_vertexCount;
         if (i == outoIndex2) p3 = outoVec;
         else p3 = this.m_vertices[i];
         var triangleArea = 0.5 * ((p2.x - intoVec.x) * (p3.y - intoVec.y) - (p2.y - intoVec.y) * (p3.x - intoVec.x));
         area += triangleArea;
         center.x += triangleArea * (intoVec.x + p2.x + p3.x) / 3;
         center.y += triangleArea * (intoVec.y + p2.y + p3.y) / 3;
         p2 = p3;
      }
      center.Multiply(1 / area);
      c.SetV(b2Math.MulX(xf, center));
      return area;
   }
   b2PolygonShape.prototype.GetVertexCount = function () {
      return this.m_vertexCount;
   }
   b2PolygonShape.prototype.GetVertices = function () {
      return this.m_vertices;
   }
   b2PolygonShape.prototype.GetNormals = function () {
      return this.m_normals;
   }
   b2PolygonShape.prototype.GetSupport = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_vertexCount; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return bestIndex;
   }
   b2PolygonShape.prototype.GetSupportVertex = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_vertexCount; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return this.m_vertices[bestIndex];
   }
   b2PolygonShape.prototype.Validate = function () {
      return false;
   }
   b2PolygonShape.prototype.b2PolygonShape = function () {
      this.__super.b2Shape.call(this);
      this.m_type = b2Shape.e_polygonShape;
      this.m_centroid = new b2Vec2();
      this.m_vertices = new Vector();
      this.m_normals = new Vector();
   }
   b2PolygonShape.prototype.Reserve = function (count) {
      if (count === undefined) count = 0;
      for (var i = parseInt(this.m_vertices.length); i < count; i++) {
         this.m_vertices[i] = new b2Vec2();
         this.m_normals[i] = new b2Vec2();
      }
   }
   b2PolygonShape.ComputeCentroid = function (vs, count) {
      if (count === undefined) count = 0;
      var c = new b2Vec2();
      var area = 0.0;
      var p1X = 0.0;
      var p1Y = 0.0;
      var inv3 = 1.0 / 3.0;
      for (var i = 0; i < count; ++i) {
         var p2 = vs[i];
         var p3 = i + 1 < count ? vs[parseInt(i + 1)] : vs[0];
         var e1X = p2.x - p1X;
         var e1Y = p2.y - p1Y;
         var e2X = p3.x - p1X;
         var e2Y = p3.y - p1Y;
         var D = (e1X * e2Y - e1Y * e2X);
         var triangleArea = 0.5 * D;area += triangleArea;
         c.x += triangleArea * inv3 * (p1X + p2.x + p3.x);
         c.y += triangleArea * inv3 * (p1Y + p2.y + p3.y);
      }
      c.x *= 1.0 / area;
      c.y *= 1.0 / area;
      return c;
   }
   b2PolygonShape.ComputeOBB = function (obb, vs, count) {
      if (count === undefined) count = 0;
      var i = 0;
      var p = new Vector(count + 1);
      for (i = 0;
      i < count; ++i) {
         p[i] = vs[i];
      }
      p[count] = p[0];
      var minArea = Number.MAX_VALUE;
      for (i = 1;
      i <= count; ++i) {
         var root = p[parseInt(i - 1)];
         var uxX = p[i].x - root.x;
         var uxY = p[i].y - root.y;
         var length = Math.sqrt(uxX * uxX + uxY * uxY);
         uxX /= length;
         uxY /= length;
         var uyX = (-uxY);
         var uyY = uxX;
         var lowerX = Number.MAX_VALUE;
         var lowerY = Number.MAX_VALUE;
         var upperX = (-Number.MAX_VALUE);
         var upperY = (-Number.MAX_VALUE);
         for (var j = 0; j < count; ++j) {
            var dX = p[j].x - root.x;
            var dY = p[j].y - root.y;
            var rX = (uxX * dX + uxY * dY);
            var rY = (uyX * dX + uyY * dY);
            if (rX < lowerX) lowerX = rX;
            if (rY < lowerY) lowerY = rY;
            if (rX > upperX) upperX = rX;
            if (rY > upperY) upperY = rY;
         }
         var area = (upperX - lowerX) * (upperY - lowerY);
         if (area < 0.95 * minArea) {
            minArea = area;
            obb.R.col1.x = uxX;
            obb.R.col1.y = uxY;
            obb.R.col2.x = uyX;
            obb.R.col2.y = uyY;
            var centerX = 0.5 * (lowerX + upperX);
            var centerY = 0.5 * (lowerY + upperY);
            var tMat = obb.R;
            obb.center.x = root.x + (tMat.col1.x * centerX + tMat.col2.x * centerY);
            obb.center.y = root.y + (tMat.col1.y * centerX + tMat.col2.y * centerY);
            obb.extents.x = 0.5 * (upperX - lowerX);
            obb.extents.y = 0.5 * (upperY - lowerY);
         }
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.Shapes.b2PolygonShape.s_mat = new b2Mat22();
   });
   b2Shape.b2Shape = function () {};
   b2Shape.prototype.Copy = function () {
      return null;
   }
   b2Shape.prototype.Set = function (other) {
      this.m_radius = other.m_radius;
   }
   b2Shape.prototype.GetType = function () {
      return this.m_type;
   }
   b2Shape.prototype.TestPoint = function (xf, p) {
      return false;
   }
   b2Shape.prototype.RayCast = function (output, input, transform) {
      return false;
   }
   b2Shape.prototype.ComputeAABB = function (aabb, xf) {}
   b2Shape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
   }
   b2Shape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      return 0;
   }
   b2Shape.TestOverlap = function (shape1, transform1, shape2, transform2) {
      var input = new b2DistanceInput();
      input.proxyA = new b2DistanceProxy();
      input.proxyA.Set(shape1);
      input.proxyB = new b2DistanceProxy();
      input.proxyB.Set(shape2);
      input.transformA = transform1;
      input.transformB = transform2;
      input.useRadii = true;
      var simplexCache = new b2SimplexCache();
      simplexCache.count = 0;
      var output = new b2DistanceOutput();
      b2Distance.Distance(output, simplexCache, input);
      return output.distance < 10.0 * Number.MIN_VALUE;
   }
   b2Shape.prototype.b2Shape = function () {
      this.m_type = b2Shape.e_unknownShape;
      this.m_radius = b2Settings.b2_linearSlop;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.Shapes.b2Shape.e_unknownShape = parseInt((-1));
      Box2D.Collision.Shapes.b2Shape.e_circleShape = 0;
      Box2D.Collision.Shapes.b2Shape.e_polygonShape = 1;
      Box2D.Collision.Shapes.b2Shape.e_edgeShape = 2;
      Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount = 3;
      Box2D.Collision.Shapes.b2Shape.e_hitCollide = 1;
      Box2D.Collision.Shapes.b2Shape.e_missCollide = 0;
      Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide = parseInt((-1));
   });
})();
(function () {
   var b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3;

   b2Color.b2Color = function () {
      this._r = 0;
      this._g = 0;
      this._b = 0;
   };
   b2Color.prototype.b2Color = function (rr, gg, bb) {
      if (rr === undefined) rr = 0;
      if (gg === undefined) gg = 0;
      if (bb === undefined) bb = 0;
      this._r = Box2D.parseUInt(255 * b2Math.Clamp(rr, 0.0, 1.0));
      this._g = Box2D.parseUInt(255 * b2Math.Clamp(gg, 0.0, 1.0));
      this._b = Box2D.parseUInt(255 * b2Math.Clamp(bb, 0.0, 1.0));
   }
   b2Color.prototype.Set = function (rr, gg, bb) {
      if (rr === undefined) rr = 0;
      if (gg === undefined) gg = 0;
      if (bb === undefined) bb = 0;
      this._r = Box2D.parseUInt(255 * b2Math.Clamp(rr, 0.0, 1.0));
      this._g = Box2D.parseUInt(255 * b2Math.Clamp(gg, 0.0, 1.0));
      this._b = Box2D.parseUInt(255 * b2Math.Clamp(bb, 0.0, 1.0));
   }
   Object.defineProperty(b2Color.prototype, 'r', {
      enumerable: false,
      configurable: true,
      set: function (rr) {
         if (rr === undefined) rr = 0;
         this._r = Box2D.parseUInt(255 * b2Math.Clamp(rr, 0.0, 1.0));
      }
   });
   Object.defineProperty(b2Color.prototype, 'g', {
      enumerable: false,
      configurable: true,
      set: function (gg) {
         if (gg === undefined) gg = 0;
         this._g = Box2D.parseUInt(255 * b2Math.Clamp(gg, 0.0, 1.0));
      }
   });
   Object.defineProperty(b2Color.prototype, 'b', {
      enumerable: false,
      configurable: true,
      set: function (bb) {
         if (bb === undefined) bb = 0;
         this._b = Box2D.parseUInt(255 * b2Math.Clamp(bb, 0.0, 1.0));
      }
   });
   Object.defineProperty(b2Color.prototype, 'color', {
      enumerable: false,
      configurable: true,
      get: function () {
         return (this._r << 16) | (this._g << 8) | (this._b);
      }
   });
   b2Settings.b2Settings = function () {};
   b2Settings.b2MixFriction = function (friction1, friction2) {
      if (friction1 === undefined) friction1 = 0;
      if (friction2 === undefined) friction2 = 0;
      return Math.sqrt(friction1 * friction2);
   }
   b2Settings.b2MixRestitution = function (restitution1, restitution2) {
      if (restitution1 === undefined) restitution1 = 0;
      if (restitution2 === undefined) restitution2 = 0;
      return restitution1 > restitution2 ? restitution1 : restitution2;
   }
   b2Settings.b2Assert = function (a) {
      if (!a) {
         throw "Assertion Failed";
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Common.b2Settings.VERSION = "2.1alpha";
      Box2D.Common.b2Settings.USHRT_MAX = 0x0000ffff;
      Box2D.Common.b2Settings.b2_pi = Math.PI;
      Box2D.Common.b2Settings.b2_maxManifoldPoints = 2;
      Box2D.Common.b2Settings.b2_aabbExtension = 0.1;
      Box2D.Common.b2Settings.b2_aabbMultiplier = 2.0;
      Box2D.Common.b2Settings.b2_polygonRadius = 2.0 * b2Settings.b2_linearSlop;
      Box2D.Common.b2Settings.b2_linearSlop = 0.005;
      Box2D.Common.b2Settings.b2_angularSlop = 2.0 / 180.0 * b2Settings.b2_pi;
      Box2D.Common.b2Settings.b2_toiSlop = 8.0 * b2Settings.b2_linearSlop;
      Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland = 32;
      Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland = 32;
      Box2D.Common.b2Settings.b2_velocityThreshold = 1.0;
      Box2D.Common.b2Settings.b2_maxLinearCorrection = 0.2;
      Box2D.Common.b2Settings.b2_maxAngularCorrection = 8.0 / 180.0 * b2Settings.b2_pi;
      Box2D.Common.b2Settings.b2_maxTranslation = 2.0;
      Box2D.Common.b2Settings.b2_maxTranslationSquared = b2Settings.b2_maxTranslation * b2Settings.b2_maxTranslation;
      Box2D.Common.b2Settings.b2_maxRotation = 0.5 * b2Settings.b2_pi;
      Box2D.Common.b2Settings.b2_maxRotationSquared = b2Settings.b2_maxRotation * b2Settings.b2_maxRotation;
      Box2D.Common.b2Settings.b2_contactBaumgarte = 0.2;
      Box2D.Common.b2Settings.b2_timeToSleep = 0.5;
      Box2D.Common.b2Settings.b2_linearSleepTolerance = 0.01;
      Box2D.Common.b2Settings.b2_angularSleepTolerance = 2.0 / 180.0 * b2Settings.b2_pi;
   });
})();
(function () {
   var b2AABB = Box2D.Collision.b2AABB,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3;

   b2Mat22.b2Mat22 = function () {
      this.col1 = new b2Vec2();
      this.col2 = new b2Vec2();
   };
   b2Mat22.prototype.b2Mat22 = function () {
      this.SetIdentity();
   }
   b2Mat22.FromAngle = function (angle) {
      if (angle === undefined) angle = 0;
      var mat = new b2Mat22();
      mat.Set(angle);
      return mat;
   }
   b2Mat22.FromVV = function (c1, c2) {
      var mat = new b2Mat22();
      mat.SetVV(c1, c2);
      return mat;
   }
   b2Mat22.prototype.Set = function (angle) {
      if (angle === undefined) angle = 0;
      var c = Math.cos(angle);
      var s = Math.sin(angle);
      this.col1.x = c;
      this.col2.x = (-s);
      this.col1.y = s;
      this.col2.y = c;
   }
   b2Mat22.prototype.SetVV = function (c1, c2) {
      this.col1.SetV(c1);
      this.col2.SetV(c2);
   }
   b2Mat22.prototype.Copy = function () {
      var mat = new b2Mat22();
      mat.SetM(this);
      return mat;
   }
   b2Mat22.prototype.SetM = function (m) {
      this.col1.SetV(m.col1);
      this.col2.SetV(m.col2);
   }
   b2Mat22.prototype.AddM = function (m) {
      this.col1.x += m.col1.x;
      this.col1.y += m.col1.y;
      this.col2.x += m.col2.x;
      this.col2.y += m.col2.y;
   }
   b2Mat22.prototype.SetIdentity = function () {
      this.col1.x = 1.0;
      this.col2.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 1.0;
   }
   b2Mat22.prototype.SetZero = function () {
      this.col1.x = 0.0;
      this.col2.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 0.0;
   }
   b2Mat22.prototype.GetAngle = function () {
      return Math.atan2(this.col1.y, this.col1.x);
   }
   b2Mat22.prototype.GetInverse = function (out) {
      var a = this.col1.x;
      var b = this.col2.x;
      var c = this.col1.y;
      var d = this.col2.y;
      var det = a * d - b * c;
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.col1.x = det * d;
      out.col2.x = (-det * b);
      out.col1.y = (-det * c);
      out.col2.y = det * a;
      return out;
   }
   b2Mat22.prototype.Solve = function (out, bX, bY) {
      if (bX === undefined) bX = 0;
      if (bY === undefined) bY = 0;
      var a11 = this.col1.x;
      var a12 = this.col2.x;
      var a21 = this.col1.y;
      var a22 = this.col2.y;
      var det = a11 * a22 - a12 * a21;
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.x = det * (a22 * bX - a12 * bY);
      out.y = det * (a11 * bY - a21 * bX);
      return out;
   }
   b2Mat22.prototype.Abs = function () {
      this.col1.Abs();
      this.col2.Abs();
   }
   b2Mat33.b2Mat33 = function () {
      this.col1 = new b2Vec3();
      this.col2 = new b2Vec3();
      this.col3 = new b2Vec3();
   };
   b2Mat33.prototype.b2Mat33 = function (c1, c2, c3) {
      if (c1 === undefined) c1 = null;
      if (c2 === undefined) c2 = null;
      if (c3 === undefined) c3 = null;
      if (!c1 && !c2 && !c3) {
         this.col1.SetZero();
         this.col2.SetZero();
         this.col3.SetZero();
      }
      else {
         this.col1.SetV(c1);
         this.col2.SetV(c2);
         this.col3.SetV(c3);
      }
   }
   b2Mat33.prototype.SetVVV = function (c1, c2, c3) {
      this.col1.SetV(c1);
      this.col2.SetV(c2);
      this.col3.SetV(c3);
   }
   b2Mat33.prototype.Copy = function () {
      return new b2Mat33(this.col1, this.col2, this.col3);
   }
   b2Mat33.prototype.SetM = function (m) {
      this.col1.SetV(m.col1);
      this.col2.SetV(m.col2);
      this.col3.SetV(m.col3);
   }
   b2Mat33.prototype.AddM = function (m) {
      this.col1.x += m.col1.x;
      this.col1.y += m.col1.y;
      this.col1.z += m.col1.z;
      this.col2.x += m.col2.x;
      this.col2.y += m.col2.y;
      this.col2.z += m.col2.z;
      this.col3.x += m.col3.x;
      this.col3.y += m.col3.y;
      this.col3.z += m.col3.z;
   }
   b2Mat33.prototype.SetIdentity = function () {
      this.col1.x = 1.0;
      this.col2.x = 0.0;
      this.col3.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 1.0;
      this.col3.y = 0.0;
      this.col1.z = 0.0;
      this.col2.z = 0.0;
      this.col3.z = 1.0;
   }
   b2Mat33.prototype.SetZero = function () {
      this.col1.x = 0.0;
      this.col2.x = 0.0;
      this.col3.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 0.0;
      this.col3.y = 0.0;
      this.col1.z = 0.0;
      this.col2.z = 0.0;
      this.col3.z = 0.0;
   }
   b2Mat33.prototype.Solve22 = function (out, bX, bY) {
      if (bX === undefined) bX = 0;
      if (bY === undefined) bY = 0;
      var a11 = this.col1.x;
      var a12 = this.col2.x;
      var a21 = this.col1.y;
      var a22 = this.col2.y;
      var det = a11 * a22 - a12 * a21;
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.x = det * (a22 * bX - a12 * bY);
      out.y = det * (a11 * bY - a21 * bX);
      return out;
   }
   b2Mat33.prototype.Solve33 = function (out, bX, bY, bZ) {
      if (bX === undefined) bX = 0;
      if (bY === undefined) bY = 0;
      if (bZ === undefined) bZ = 0;
      var a11 = this.col1.x;
      var a21 = this.col1.y;
      var a31 = this.col1.z;
      var a12 = this.col2.x;
      var a22 = this.col2.y;
      var a32 = this.col2.z;
      var a13 = this.col3.x;
      var a23 = this.col3.y;
      var a33 = this.col3.z;
      var det = a11 * (a22 * a33 - a32 * a23) + a21 * (a32 * a13 - a12 * a33) + a31 * (a12 * a23 - a22 * a13);
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.x = det * (bX * (a22 * a33 - a32 * a23) + bY * (a32 * a13 - a12 * a33) + bZ * (a12 * a23 - a22 * a13));
      out.y = det * (a11 * (bY * a33 - bZ * a23) + a21 * (bZ * a13 - bX * a33) + a31 * (bX * a23 - bY * a13));
      out.z = det * (a11 * (a22 * bZ - a32 * bY) + a21 * (a32 * bX - a12 * bZ) + a31 * (a12 * bY - a22 * bX));
      return out;
   }
   b2Math.b2Math = function () {};
   b2Math.IsValid = function (x) {
      if (x === undefined) x = 0;
      return isFinite(x);
   }
   b2Math.Dot = function (a, b) {
      return a.x * b.x + a.y * b.y;
   }
   b2Math.CrossVV = function (a, b) {
      return a.x * b.y - a.y * b.x;
   }
   b2Math.CrossVF = function (a, s) {
      if (s === undefined) s = 0;
      var v = new b2Vec2(s * a.y, (-s * a.x));
      return v;
   }
   b2Math.CrossFV = function (s, a) {
      if (s === undefined) s = 0;
      var v = new b2Vec2((-s * a.y), s * a.x);
      return v;
   }
   b2Math.MulMV = function (A, v) {
      var u = new b2Vec2(A.col1.x * v.x + A.col2.x * v.y, A.col1.y * v.x + A.col2.y * v.y);
      return u;
   }
   b2Math.MulTMV = function (A, v) {
      var u = new b2Vec2(b2Math.Dot(v, A.col1), b2Math.Dot(v, A.col2));
      return u;
   }
   b2Math.MulX = function (T, v) {
      var a = b2Math.MulMV(T.R, v);
      a.x += T.position.x;
      a.y += T.position.y;
      return a;
   }
   b2Math.MulXT = function (T, v) {
      var a = b2Math.SubtractVV(v, T.position);
      var tX = (a.x * T.R.col1.x + a.y * T.R.col1.y);
      a.y = (a.x * T.R.col2.x + a.y * T.R.col2.y);
      a.x = tX;
      return a;
   }
   b2Math.AddVV = function (a, b) {
      var v = new b2Vec2(a.x + b.x, a.y + b.y);
      return v;
   }
   b2Math.SubtractVV = function (a, b) {
      var v = new b2Vec2(a.x - b.x, a.y - b.y);
      return v;
   }
   b2Math.Distance = function (a, b) {
      var cX = a.x - b.x;
      var cY = a.y - b.y;
      return Math.sqrt(cX * cX + cY * cY);
   }
   b2Math.DistanceSquared = function (a, b) {
      var cX = a.x - b.x;
      var cY = a.y - b.y;
      return (cX * cX + cY * cY);
   }
   b2Math.MulFV = function (s, a) {
      if (s === undefined) s = 0;
      var v = new b2Vec2(s * a.x, s * a.y);
      return v;
   }
   b2Math.AddMM = function (A, B) {
      var C = b2Mat22.FromVV(b2Math.AddVV(A.col1, B.col1), b2Math.AddVV(A.col2, B.col2));
      return C;
   }
   b2Math.MulMM = function (A, B) {
      var C = b2Mat22.FromVV(b2Math.MulMV(A, B.col1), b2Math.MulMV(A, B.col2));
      return C;
   }
   b2Math.MulTMM = function (A, B) {
      var c1 = new b2Vec2(b2Math.Dot(A.col1, B.col1), b2Math.Dot(A.col2, B.col1));
      var c2 = new b2Vec2(b2Math.Dot(A.col1, B.col2), b2Math.Dot(A.col2, B.col2));
      var C = b2Mat22.FromVV(c1, c2);
      return C;
   }
   b2Math.Abs = function (a) {
      if (a === undefined) a = 0;
      return a > 0.0 ? a : (-a);
   }
   b2Math.AbsV = function (a) {
      var b = new b2Vec2(b2Math.Abs(a.x), b2Math.Abs(a.y));
      return b;
   }
   b2Math.AbsM = function (A) {
      var B = b2Mat22.FromVV(b2Math.AbsV(A.col1), b2Math.AbsV(A.col2));
      return B;
   }
   b2Math.Min = function (a, b) {
      if (a === undefined) a = 0;
      if (b === undefined) b = 0;
      return a < b ? a : b;
   }
   b2Math.MinV = function (a, b) {
      var c = new b2Vec2(b2Math.Min(a.x, b.x), b2Math.Min(a.y, b.y));
      return c;
   }
   b2Math.Max = function (a, b) {
      if (a === undefined) a = 0;
      if (b === undefined) b = 0;
      return a > b ? a : b;
   }
   b2Math.MaxV = function (a, b) {
      var c = new b2Vec2(b2Math.Max(a.x, b.x), b2Math.Max(a.y, b.y));
      return c;
   }
   b2Math.Clamp = function (a, low, high) {
      if (a === undefined) a = 0;
      if (low === undefined) low = 0;
      if (high === undefined) high = 0;
      return a < low ? low : a > high ? high : a;
   }
   b2Math.ClampV = function (a, low, high) {
      return b2Math.MaxV(low, b2Math.MinV(a, high));
   }
   b2Math.Swap = function (a, b) {
      var tmp = a[0];
      a[0] = b[0];
      b[0] = tmp;
   }
   b2Math.Random = function () {
      return Math.random() * 2 - 1;
   }
   b2Math.RandomRange = function (lo, hi) {
      if (lo === undefined) lo = 0;
      if (hi === undefined) hi = 0;
      var r = Math.random();
      r = (hi - lo) * r + lo;
      return r;
   }
   b2Math.NextPowerOfTwo = function (x) {
      if (x === undefined) x = 0;
      x |= (x >> 1) & 0x7FFFFFFF;
      x |= (x >> 2) & 0x3FFFFFFF;
      x |= (x >> 4) & 0x0FFFFFFF;
      x |= (x >> 8) & 0x00FFFFFF;
      x |= (x >> 16) & 0x0000FFFF;
      return x + 1;
   }
   b2Math.IsPowerOfTwo = function (x) {
      if (x === undefined) x = 0;
      var result = x > 0 && (x & (x - 1)) == 0;
      return result;
   }
   Box2D.postDefs.push(function () {
      Box2D.Common.Math.b2Math.b2Vec2_zero = new b2Vec2(0.0, 0.0);
      Box2D.Common.Math.b2Math.b2Mat22_identity = b2Mat22.FromVV(new b2Vec2(1.0, 0.0), new b2Vec2(0.0, 1.0));
      Box2D.Common.Math.b2Math.b2Transform_identity = new b2Transform(b2Math.b2Vec2_zero, b2Math.b2Mat22_identity);
   });
   b2Sweep.b2Sweep = function () {
      this.localCenter = new b2Vec2();
      this.c0 = new b2Vec2;
      this.c = new b2Vec2();
   };
   b2Sweep.prototype.Set = function (other) {
      this.localCenter.SetV(other.localCenter);
      this.c0.SetV(other.c0);
      this.c.SetV(other.c);
      this.a0 = other.a0;
      this.a = other.a;
      this.t0 = other.t0;
   }
   b2Sweep.prototype.Copy = function () {
      var copy = new b2Sweep();
      copy.localCenter.SetV(this.localCenter);
      copy.c0.SetV(this.c0);
      copy.c.SetV(this.c);
      copy.a0 = this.a0;
      copy.a = this.a;
      copy.t0 = this.t0;
      return copy;
   }
   b2Sweep.prototype.GetTransform = function (xf, alpha) {
      if (alpha === undefined) alpha = 0;
      xf.position.x = (1.0 - alpha) * this.c0.x + alpha * this.c.x;
      xf.position.y = (1.0 - alpha) * this.c0.y + alpha * this.c.y;
      var angle = (1.0 - alpha) * this.a0 + alpha * this.a;
      xf.R.Set(angle);
      var tMat = xf.R;
      xf.position.x -= (tMat.col1.x * this.localCenter.x + tMat.col2.x * this.localCenter.y);
      xf.position.y -= (tMat.col1.y * this.localCenter.x + tMat.col2.y * this.localCenter.y);
   }
   b2Sweep.prototype.Advance = function (t) {
      if (t === undefined) t = 0;
      if (this.t0 < t && 1.0 - this.t0 > Number.MIN_VALUE) {
         var alpha = (t - this.t0) / (1.0 - this.t0);
         this.c0.x = (1.0 - alpha) * this.c0.x + alpha * this.c.x;
         this.c0.y = (1.0 - alpha) * this.c0.y + alpha * this.c.y;
         this.a0 = (1.0 - alpha) * this.a0 + alpha * this.a;
         this.t0 = t;
      }
   }
   b2Transform.b2Transform = function () {
      this.position = new b2Vec2;
      this.R = new b2Mat22();
   };
   b2Transform.prototype.b2Transform = function (pos, r) {
      if (pos === undefined) pos = null;
      if (r === undefined) r = null;
      if (pos) {
         this.position.SetV(pos);
         this.R.SetM(r);
      }
   }
   b2Transform.prototype.Initialize = function (pos, r) {
      this.position.SetV(pos);
      this.R.SetM(r);
   }
   b2Transform.prototype.SetIdentity = function () {
      this.position.SetZero();
      this.R.SetIdentity();
   }
   b2Transform.prototype.Set = function (x) {
      this.position.SetV(x.position);
      this.R.SetM(x.R);
   }
   b2Transform.prototype.GetAngle = function () {
      return Math.atan2(this.R.col1.y, this.R.col1.x);
   }
   b2Vec2.b2Vec2 = function () {};
   b2Vec2.prototype.b2Vec2 = function (x_, y_) {
      if (x_ === undefined) x_ = 0;
      if (y_ === undefined) y_ = 0;
      this.x = x_;
      this.y = y_;
   }
   b2Vec2.prototype.SetZero = function () {
      this.x = 0.0;
      this.y = 0.0;
   }
   b2Vec2.prototype.Set = function (x_, y_) {
      if (x_ === undefined) x_ = 0;
      if (y_ === undefined) y_ = 0;
      this.x = x_;
      this.y = y_;
   }
   b2Vec2.prototype.SetV = function (v) {
      this.x = v.x;
      this.y = v.y;
   }
   b2Vec2.prototype.GetNegative = function () {
      return new b2Vec2((-this.x), (-this.y));
   }
   b2Vec2.prototype.NegativeSelf = function () {
      this.x = (-this.x);
      this.y = (-this.y);
   }
   b2Vec2.Make = function (x_, y_) {
      if (x_ === undefined) x_ = 0;
      if (y_ === undefined) y_ = 0;
      return new b2Vec2(x_, y_);
   }
   b2Vec2.prototype.Copy = function () {
      return new b2Vec2(this.x, this.y);
   }
   b2Vec2.prototype.Add = function (v) {
      this.x += v.x;
      this.y += v.y;
   }
   b2Vec2.prototype.Subtract = function (v) {
      this.x -= v.x;
      this.y -= v.y;
   }
   b2Vec2.prototype.Multiply = function (a) {
      if (a === undefined) a = 0;
      this.x *= a;
      this.y *= a;
   }
   b2Vec2.prototype.MulM = function (A) {
      var tX = this.x;
      this.x = A.col1.x * tX + A.col2.x * this.y;
      this.y = A.col1.y * tX + A.col2.y * this.y;
   }
   b2Vec2.prototype.MulTM = function (A) {
      var tX = b2Math.Dot(this, A.col1);
      this.y = b2Math.Dot(this, A.col2);
      this.x = tX;
   }
   b2Vec2.prototype.CrossVF = function (s) {
      if (s === undefined) s = 0;
      var tX = this.x;
      this.x = s * this.y;
      this.y = (-s * tX);
   }
   b2Vec2.prototype.CrossFV = function (s) {
      if (s === undefined) s = 0;
      var tX = this.x;
      this.x = (-s * this.y);
      this.y = s * tX;
   }
   b2Vec2.prototype.MinV = function (b) {
      this.x = this.x < b.x ? this.x : b.x;
      this.y = this.y < b.y ? this.y : b.y;
   }
   b2Vec2.prototype.MaxV = function (b) {
      this.x = this.x > b.x ? this.x : b.x;
      this.y = this.y > b.y ? this.y : b.y;
   }
   b2Vec2.prototype.Abs = function () {
      if (this.x < 0) this.x = (-this.x);
      if (this.y < 0) this.y = (-this.y);
   }
   b2Vec2.prototype.Length = function () {
      return Math.sqrt(this.x * this.x + this.y * this.y);
   }
   b2Vec2.prototype.LengthSquared = function () {
      return (this.x * this.x + this.y * this.y);
   }
   b2Vec2.prototype.Normalize = function () {
      var length = Math.sqrt(this.x * this.x + this.y * this.y);
      if (length < Number.MIN_VALUE) {
         return 0.0;
      }
      var invLength = 1.0 / length;
      this.x *= invLength;
      this.y *= invLength;
      return length;
   }
   b2Vec2.prototype.IsValid = function () {
      return b2Math.IsValid(this.x) && b2Math.IsValid(this.y);
   }
   b2Vec3.b2Vec3 = function () {};
   b2Vec3.prototype.b2Vec3 = function (x, y, z) {
      if (x === undefined) x = 0;
      if (y === undefined) y = 0;
      if (z === undefined) z = 0;
      this.x = x;
      this.y = y;
      this.z = z;
   }
   b2Vec3.prototype.SetZero = function () {
      this.x = this.y = this.z = 0.0;
   }
   b2Vec3.prototype.Set = function (x, y, z) {
      if (x === undefined) x = 0;
      if (y === undefined) y = 0;
      if (z === undefined) z = 0;
      this.x = x;
      this.y = y;
      this.z = z;
   }
   b2Vec3.prototype.SetV = function (v) {
      this.x = v.x;
      this.y = v.y;
      this.z = v.z;
   }
   b2Vec3.prototype.GetNegative = function () {
      return new b2Vec3((-this.x), (-this.y), (-this.z));
   }
   b2Vec3.prototype.NegativeSelf = function () {
      this.x = (-this.x);
      this.y = (-this.y);
      this.z = (-this.z);
   }
   b2Vec3.prototype.Copy = function () {
      return new b2Vec3(this.x, this.y, this.z);
   }
   b2Vec3.prototype.Add = function (v) {
      this.x += v.x;
      this.y += v.y;
      this.z += v.z;
   }
   b2Vec3.prototype.Subtract = function (v) {
      this.x -= v.x;
      this.y -= v.y;
      this.z -= v.z;
   }
   b2Vec3.prototype.Multiply = function (a) {
      if (a === undefined) a = 0;
      this.x *= a;
      this.y *= a;
      this.z *= a;
   }
})();
(function () {
   var b2ControllerEdge = Box2D.Dynamics.Controllers.b2ControllerEdge,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase,
      b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2CircleContact = Box2D.Dynamics.Contacts.b2CircleContact,
      b2Contact = Box2D.Dynamics.Contacts.b2Contact,
      b2ContactConstraint = Box2D.Dynamics.Contacts.b2ContactConstraint,
      b2ContactConstraintPoint = Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
      b2ContactEdge = Box2D.Dynamics.Contacts.b2ContactEdge,
      b2ContactFactory = Box2D.Dynamics.Contacts.b2ContactFactory,
      b2ContactRegister = Box2D.Dynamics.Contacts.b2ContactRegister,
      b2ContactResult = Box2D.Dynamics.Contacts.b2ContactResult,
      b2ContactSolver = Box2D.Dynamics.Contacts.b2ContactSolver,
      b2EdgeAndCircleContact = Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
      b2NullContact = Box2D.Dynamics.Contacts.b2NullContact,
      b2PolyAndCircleContact = Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
      b2PolyAndEdgeContact = Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
      b2PolygonContact = Box2D.Dynamics.Contacts.b2PolygonContact,
      b2PositionSolverManifold = Box2D.Dynamics.Contacts.b2PositionSolverManifold,
      b2Controller = Box2D.Dynamics.Controllers.b2Controller,
      b2DistanceJoint = Box2D.Dynamics.Joints.b2DistanceJoint,
      b2DistanceJointDef = Box2D.Dynamics.Joints.b2DistanceJointDef,
      b2FrictionJoint = Box2D.Dynamics.Joints.b2FrictionJoint,
      b2FrictionJointDef = Box2D.Dynamics.Joints.b2FrictionJointDef,
      b2GearJoint = Box2D.Dynamics.Joints.b2GearJoint,
      b2GearJointDef = Box2D.Dynamics.Joints.b2GearJointDef,
      b2Jacobian = Box2D.Dynamics.Joints.b2Jacobian,
      b2Joint = Box2D.Dynamics.Joints.b2Joint,
      b2JointDef = Box2D.Dynamics.Joints.b2JointDef,
      b2JointEdge = Box2D.Dynamics.Joints.b2JointEdge,
      b2LineJoint = Box2D.Dynamics.Joints.b2LineJoint,
      b2LineJointDef = Box2D.Dynamics.Joints.b2LineJointDef,
      b2MouseJoint = Box2D.Dynamics.Joints.b2MouseJoint,
      b2MouseJointDef = Box2D.Dynamics.Joints.b2MouseJointDef,
      b2PrismaticJoint = Box2D.Dynamics.Joints.b2PrismaticJoint,
      b2PrismaticJointDef = Box2D.Dynamics.Joints.b2PrismaticJointDef,
      b2PulleyJoint = Box2D.Dynamics.Joints.b2PulleyJoint,
      b2PulleyJointDef = Box2D.Dynamics.Joints.b2PulleyJointDef,
      b2RevoluteJoint = Box2D.Dynamics.Joints.b2RevoluteJoint,
      b2RevoluteJointDef = Box2D.Dynamics.Joints.b2RevoluteJointDef,
      b2WeldJoint = Box2D.Dynamics.Joints.b2WeldJoint,
      b2WeldJointDef = Box2D.Dynamics.Joints.b2WeldJointDef;

   b2Body.b2Body = function () {
      this.m_xf = new b2Transform();
      this.m_sweep = new b2Sweep();
      this.m_linearVelocity = new b2Vec2();
      this.m_force = new b2Vec2();
   };
   b2Body.prototype.connectEdges = function (s1, s2, angle1) {
      if (angle1 === undefined) angle1 = 0;
      var angle2 = Math.atan2(s2.GetDirectionVector().y, s2.GetDirectionVector().x);
      var coreOffset = Math.tan((angle2 - angle1) * 0.5);
      var core = b2Math.MulFV(coreOffset, s2.GetDirectionVector());
      core = b2Math.SubtractVV(core, s2.GetNormalVector());
      core = b2Math.MulFV(b2Settings.b2_toiSlop, core);
      core = b2Math.AddVV(core, s2.GetVertex1());
      var cornerDir = b2Math.AddVV(s1.GetDirectionVector(), s2.GetDirectionVector());
      cornerDir.Normalize();
      var convex = b2Math.Dot(s1.GetDirectionVector(), s2.GetNormalVector()) > 0.0;
      s1.SetNextEdge(s2, core, cornerDir, convex);
      s2.SetPrevEdge(s1, core, cornerDir, convex);
      return angle2;
   }
   b2Body.prototype.CreateFixture = function (def) {
      if (this.m_world.IsLocked() == true) {
         return null;
      }
      var fixture = new b2Fixture();
      fixture.Create(this, this.m_xf, def);
      if (this.m_flags & b2Body.e_activeFlag) {
         var broadPhase = this.m_world.m_contactManager.m_broadPhase;
         fixture.CreateProxy(broadPhase, this.m_xf);
      }
      fixture.m_next = this.m_fixtureList;
      this.m_fixtureList = fixture;
      ++this.m_fixtureCount;
      fixture.m_body = this;
      if (fixture.m_density > 0.0) {
         this.ResetMassData();
      }
      this.m_world.m_flags |= b2World.e_newFixture;
      return fixture;
   }
   b2Body.prototype.CreateFixture2 = function (shape, density) {
      if (density === undefined) density = 0.0;
      var def = new b2FixtureDef();
      def.shape = shape;
      def.density = density;
      return this.CreateFixture(def);
   }
   b2Body.prototype.DestroyFixture = function (fixture) {
      if (this.m_world.IsLocked() == true) {
         return;
      }
      var node = this.m_fixtureList;
      var ppF = null;
      var found = false;
      while (node != null) {
         if (node == fixture) {
            if (ppF) ppF.m_next = fixture.m_next;
            else this.m_fixtureList = fixture.m_next;
            found = true;
            break;
         }
         ppF = node;
         node = node.m_next;
      }
      var edge = this.m_contactList;
      while (edge) {
         var c = edge.contact;
         edge = edge.next;
         var fixtureA = c.GetFixtureA();
         var fixtureB = c.GetFixtureB();
         if (fixture == fixtureA || fixture == fixtureB) {
            this.m_world.m_contactManager.Destroy(c);
         }
      }
      if (this.m_flags & b2Body.e_activeFlag) {
         var broadPhase = this.m_world.m_contactManager.m_broadPhase;
         fixture.DestroyProxy(broadPhase);
      }
      else {}
      fixture.Destroy();
      fixture.m_body = null;
      fixture.m_next = null;
      --this.m_fixtureCount;
      this.ResetMassData();
   }
   b2Body.prototype.SetPositionAndAngle = function (position, angle) {
      if (angle === undefined) angle = 0;
      var f;
      if (this.m_world.IsLocked() == true) {
         return;
      }
      this.m_xf.R.Set(angle);
      this.m_xf.position.SetV(position);
      var tMat = this.m_xf.R;
      var tVec = this.m_sweep.localCenter;
      this.m_sweep.c.x = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      this.m_sweep.c.y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      this.m_sweep.c.x += this.m_xf.position.x;
      this.m_sweep.c.y += this.m_xf.position.y;
      this.m_sweep.c0.SetV(this.m_sweep.c);
      this.m_sweep.a0 = this.m_sweep.a = angle;
      var broadPhase = this.m_world.m_contactManager.m_broadPhase;
      for (f = this.m_fixtureList;
      f; f = f.m_next) {
         f.Synchronize(broadPhase, this.m_xf, this.m_xf);
      }
      this.m_world.m_contactManager.FindNewContacts();
   }
   b2Body.prototype.SetTransform = function (xf) {
      this.SetPositionAndAngle(xf.position, xf.GetAngle());
   }
   b2Body.prototype.GetTransform = function () {
      return this.m_xf;
   }
   b2Body.prototype.GetPosition = function () {
      return this.m_xf.position;
   }
   b2Body.prototype.SetPosition = function (position) {
      this.SetPositionAndAngle(position, this.GetAngle());
   }
   b2Body.prototype.GetAngle = function () {
      return this.m_sweep.a;
   }
   b2Body.prototype.SetAngle = function (angle) {
      if (angle === undefined) angle = 0;
      this.SetPositionAndAngle(this.GetPosition(), angle);
   }
   b2Body.prototype.GetWorldCenter = function () {
      return this.m_sweep.c;
   }
   b2Body.prototype.GetLocalCenter = function () {
      return this.m_sweep.localCenter;
   }
   b2Body.prototype.SetLinearVelocity = function (v) {
      if (this.m_type == b2Body.b2_staticBody) {
         return;
      }
      this.m_linearVelocity.SetV(v);
   }
   b2Body.prototype.GetLinearVelocity = function () {
      return this.m_linearVelocity;
   }
   b2Body.prototype.SetAngularVelocity = function (omega) {
      if (omega === undefined) omega = 0;
      if (this.m_type == b2Body.b2_staticBody) {
         return;
      }
      this.m_angularVelocity = omega;
   }
   b2Body.prototype.GetAngularVelocity = function () {
      return this.m_angularVelocity;
   }
   b2Body.prototype.GetDefinition = function () {
      var bd = new b2BodyDef();
      bd.type = this.GetType();
      bd.allowSleep = (this.m_flags & b2Body.e_allowSleepFlag) == b2Body.e_allowSleepFlag;
      bd.angle = this.GetAngle();
      bd.angularDamping = this.m_angularDamping;
      bd.angularVelocity = this.m_angularVelocity;
      bd.fixedRotation = (this.m_flags & b2Body.e_fixedRotationFlag) == b2Body.e_fixedRotationFlag;
      bd.bullet = (this.m_flags & b2Body.e_bulletFlag) == b2Body.e_bulletFlag;
      bd.awake = (this.m_flags & b2Body.e_awakeFlag) == b2Body.e_awakeFlag;
      bd.linearDamping = this.m_linearDamping;
      bd.linearVelocity.SetV(this.GetLinearVelocity());
      bd.position = this.GetPosition();
      bd.userData = this.GetUserData();
      return bd;
   }
   b2Body.prototype.ApplyForce = function (force, point) {
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      if (this.IsAwake() == false) {
         this.SetAwake(true);
      }
      this.m_force.x += force.x;
      this.m_force.y += force.y;
      this.m_torque += ((point.x - this.m_sweep.c.x) * force.y - (point.y - this.m_sweep.c.y) * force.x);
   }
   b2Body.prototype.ApplyTorque = function (torque) {
      if (torque === undefined) torque = 0;
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      if (this.IsAwake() == false) {
         this.SetAwake(true);
      }
      this.m_torque += torque;
   }
   b2Body.prototype.ApplyImpulse = function (impulse, point) {
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      if (this.IsAwake() == false) {
         this.SetAwake(true);
      }
      this.m_linearVelocity.x += this.m_invMass * impulse.x;
      this.m_linearVelocity.y += this.m_invMass * impulse.y;
      this.m_angularVelocity += this.m_invI * ((point.x - this.m_sweep.c.x) * impulse.y - (point.y - this.m_sweep.c.y) * impulse.x);
   }
   b2Body.prototype.Split = function (callback) {
      var linearVelocity = this.GetLinearVelocity().Copy();
      var angularVelocity = this.GetAngularVelocity();
      var center = this.GetWorldCenter();
      var body1 = this;
      var body2 = this.m_world.CreateBody(this.GetDefinition());
      var prev;
      for (var f = body1.m_fixtureList; f;) {
         if (callback(f)) {
            var next = f.m_next;
            if (prev) {
               prev.m_next = next;
            }
            else {
               body1.m_fixtureList = next;
            }
            body1.m_fixtureCount--;
            f.m_next = body2.m_fixtureList;
            body2.m_fixtureList = f;
            body2.m_fixtureCount++;
            f.m_body = body2;
            f = next;
         }
         else {
            prev = f;
            f = f.m_next;
         }
      }
      body1.ResetMassData();
      body2.ResetMassData();
      var center1 = body1.GetWorldCenter();
      var center2 = body2.GetWorldCenter();
      var velocity1 = b2Math.AddVV(linearVelocity, b2Math.CrossFV(angularVelocity, b2Math.SubtractVV(center1, center)));
      var velocity2 = b2Math.AddVV(linearVelocity, b2Math.CrossFV(angularVelocity, b2Math.SubtractVV(center2, center)));
      body1.SetLinearVelocity(velocity1);
      body2.SetLinearVelocity(velocity2);
      body1.SetAngularVelocity(angularVelocity);
      body2.SetAngularVelocity(angularVelocity);
      body1.SynchronizeFixtures();
      body2.SynchronizeFixtures();
      return body2;
   }
   b2Body.prototype.Merge = function (other) {
      var f;
      for (f = other.m_fixtureList;
      f;) {
         var next = f.m_next;
         other.m_fixtureCount--;
         f.m_next = this.m_fixtureList;
         this.m_fixtureList = f;
         this.m_fixtureCount++;
         f.m_body = body2;
         f = next;
      }
      body1.m_fixtureCount = 0;
      var body1 = this;
      var body2 = other;
      var center1 = body1.GetWorldCenter();
      var center2 = body2.GetWorldCenter();
      var velocity1 = body1.GetLinearVelocity().Copy();
      var velocity2 = body2.GetLinearVelocity().Copy();
      var angular1 = body1.GetAngularVelocity();
      var angular = body2.GetAngularVelocity();
      body1.ResetMassData();
      this.SynchronizeFixtures();
   }
   b2Body.prototype.GetMass = function () {
      return this.m_mass;
   }
   b2Body.prototype.GetInertia = function () {
      return this.m_I;
   }
   b2Body.prototype.GetMassData = function (data) {
      data.mass = this.m_mass;
      data.I = this.m_I;
      data.center.SetV(this.m_sweep.localCenter);
   }
   b2Body.prototype.SetMassData = function (massData) {
      b2Settings.b2Assert(this.m_world.IsLocked() == false);
      if (this.m_world.IsLocked() == true) {
         return;
      }
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      this.m_invMass = 0.0;
      this.m_I = 0.0;
      this.m_invI = 0.0;
      this.m_mass = massData.mass;
      if (this.m_mass <= 0.0) {
         this.m_mass = 1.0;
      }
      this.m_invMass = 1.0 / this.m_mass;
      if (massData.I > 0.0 && (this.m_flags & b2Body.e_fixedRotationFlag) == 0) {
         this.m_I = massData.I - this.m_mass * (massData.center.x * massData.center.x + massData.center.y * massData.center.y);
         this.m_invI = 1.0 / this.m_I;
      }
      var oldCenter = this.m_sweep.c.Copy();
      this.m_sweep.localCenter.SetV(massData.center);
      this.m_sweep.c0.SetV(b2Math.MulX(this.m_xf, this.m_sweep.localCenter));
      this.m_sweep.c.SetV(this.m_sweep.c0);
      this.m_linearVelocity.x += this.m_angularVelocity * (-(this.m_sweep.c.y - oldCenter.y));
      this.m_linearVelocity.y += this.m_angularVelocity * (+(this.m_sweep.c.x - oldCenter.x));
   }
   b2Body.prototype.ResetMassData = function () {
      this.m_mass = 0.0;
      this.m_invMass = 0.0;
      this.m_I = 0.0;
      this.m_invI = 0.0;
      this.m_sweep.localCenter.SetZero();
      if (this.m_type == b2Body.b2_staticBody || this.m_type == b2Body.b2_kinematicBody) {
         return;
      }
      var center = b2Vec2.Make(0, 0);
      for (var f = this.m_fixtureList; f; f = f.m_next) {
         if (f.m_density == 0.0) {
            continue;
         }
         var massData = f.GetMassData();
         this.m_mass += massData.mass;
         center.x += massData.center.x * massData.mass;
         center.y += massData.center.y * massData.mass;
         this.m_I += massData.I;
      }
      if (this.m_mass > 0.0) {
         this.m_invMass = 1.0 / this.m_mass;
         center.x *= this.m_invMass;
         center.y *= this.m_invMass;
      }
      else {
         this.m_mass = 1.0;
         this.m_invMass = 1.0;
      }
      if (this.m_I > 0.0 && (this.m_flags & b2Body.e_fixedRotationFlag) == 0) {
         this.m_I -= this.m_mass * (center.x * center.x + center.y * center.y);
         this.m_I *= this.m_inertiaScale;
         b2Settings.b2Assert(this.m_I > 0);
         this.m_invI = 1.0 / this.m_I;
      }
      else {
         this.m_I = 0.0;
         this.m_invI = 0.0;
      }
      var oldCenter = this.m_sweep.c.Copy();
      this.m_sweep.localCenter.SetV(center);
      this.m_sweep.c0.SetV(b2Math.MulX(this.m_xf, this.m_sweep.localCenter));
      this.m_sweep.c.SetV(this.m_sweep.c0);
      this.m_linearVelocity.x += this.m_angularVelocity * (-(this.m_sweep.c.y - oldCenter.y));
      this.m_linearVelocity.y += this.m_angularVelocity * (+(this.m_sweep.c.x - oldCenter.x));
   }
   b2Body.prototype.GetWorldPoint = function (localPoint) {
      var A = this.m_xf.R;
      var u = new b2Vec2(A.col1.x * localPoint.x + A.col2.x * localPoint.y, A.col1.y * localPoint.x + A.col2.y * localPoint.y);
      u.x += this.m_xf.position.x;
      u.y += this.m_xf.position.y;
      return u;
   }
   b2Body.prototype.GetWorldVector = function (localVector) {
      return b2Math.MulMV(this.m_xf.R, localVector);
   }
   b2Body.prototype.GetLocalPoint = function (worldPoint) {
      return b2Math.MulXT(this.m_xf, worldPoint);
   }
   b2Body.prototype.GetLocalVector = function (worldVector) {
      return b2Math.MulTMV(this.m_xf.R, worldVector);
   }
   b2Body.prototype.GetLinearVelocityFromWorldPoint = function (worldPoint) {
      return new b2Vec2(this.m_linearVelocity.x - this.m_angularVelocity * (worldPoint.y - this.m_sweep.c.y), this.m_linearVelocity.y + this.m_angularVelocity * (worldPoint.x - this.m_sweep.c.x));
   }
   b2Body.prototype.GetLinearVelocityFromLocalPoint = function (localPoint) {
      var A = this.m_xf.R;
      var worldPoint = new b2Vec2(A.col1.x * localPoint.x + A.col2.x * localPoint.y, A.col1.y * localPoint.x + A.col2.y * localPoint.y);
      worldPoint.x += this.m_xf.position.x;
      worldPoint.y += this.m_xf.position.y;
      return new b2Vec2(this.m_linearVelocity.x - this.m_angularVelocity * (worldPoint.y - this.m_sweep.c.y), this.m_linearVelocity.y + this.m_angularVelocity * (worldPoint.x - this.m_sweep.c.x));
   }
   b2Body.prototype.GetLinearDamping = function () {
      return this.m_linearDamping;
   }
   b2Body.prototype.SetLinearDamping = function (linearDamping) {
      if (linearDamping === undefined) linearDamping = 0;
      this.m_linearDamping = linearDamping;
   }
   b2Body.prototype.GetAngularDamping = function () {
      return this.m_angularDamping;
   }
   b2Body.prototype.SetAngularDamping = function (angularDamping) {
      if (angularDamping === undefined) angularDamping = 0;
      this.m_angularDamping = angularDamping;
   }
   b2Body.prototype.SetType = function (type) {
      if (type === undefined) type = 0;
      if (this.m_type == type) {
         return;
      }
      this.m_type = type;
      this.ResetMassData();
      if (this.m_type == b2Body.b2_staticBody) {
         this.m_linearVelocity.SetZero();
         this.m_angularVelocity = 0.0;
      }
      this.SetAwake(true);
      this.m_force.SetZero();
      this.m_torque = 0.0;
      for (var ce = this.m_contactList; ce; ce = ce.next) {
         ce.contact.FlagForFiltering();
      }
   }
   b2Body.prototype.GetType = function () {
      return this.m_type;
   }
   b2Body.prototype.SetBullet = function (flag) {
      if (flag) {
         this.m_flags |= b2Body.e_bulletFlag;
      }
      else {
         this.m_flags &= ~b2Body.e_bulletFlag;
      }
   }
   b2Body.prototype.IsBullet = function () {
      return (this.m_flags & b2Body.e_bulletFlag) == b2Body.e_bulletFlag;
   }
   b2Body.prototype.SetSleepingAllowed = function (flag) {
      if (flag) {
         this.m_flags |= b2Body.e_allowSleepFlag;
      }
      else {
         this.m_flags &= ~b2Body.e_allowSleepFlag;
         this.SetAwake(true);
      }
   }
   b2Body.prototype.SetAwake = function (flag) {
      if (flag) {
         this.m_flags |= b2Body.e_awakeFlag;
         this.m_sleepTime = 0.0;
      }
      else {
         this.m_flags &= ~b2Body.e_awakeFlag;
         this.m_sleepTime = 0.0;
         this.m_linearVelocity.SetZero();
         this.m_angularVelocity = 0.0;
         this.m_force.SetZero();
         this.m_torque = 0.0;
      }
   }
   b2Body.prototype.IsAwake = function () {
      return (this.m_flags & b2Body.e_awakeFlag) == b2Body.e_awakeFlag;
   }
   b2Body.prototype.SetFixedRotation = function (fixed) {
      if (fixed) {
         this.m_flags |= b2Body.e_fixedRotationFlag;
      }
      else {
         this.m_flags &= ~b2Body.e_fixedRotationFlag;
      }
      this.ResetMassData();
   }
   b2Body.prototype.IsFixedRotation = function () {
      return (this.m_flags & b2Body.e_fixedRotationFlag) == b2Body.e_fixedRotationFlag;
   }
   b2Body.prototype.SetActive = function (flag) {
      if (flag == this.IsActive()) {
         return;
      }
      var broadPhase;
      var f;
      if (flag) {
         this.m_flags |= b2Body.e_activeFlag;
         broadPhase = this.m_world.m_contactManager.m_broadPhase;
         for (f = this.m_fixtureList;
         f; f = f.m_next) {
            f.CreateProxy(broadPhase, this.m_xf);
         }
      }
      else {
         this.m_flags &= ~b2Body.e_activeFlag;
         broadPhase = this.m_world.m_contactManager.m_broadPhase;
         for (f = this.m_fixtureList;
         f; f = f.m_next) {
            f.DestroyProxy(broadPhase);
         }
         var ce = this.m_contactList;
         while (ce) {
            var ce0 = ce;
            ce = ce.next;
            this.m_world.m_contactManager.Destroy(ce0.contact);
         }
         this.m_contactList = null;
      }
   }
   b2Body.prototype.IsActive = function () {
      return (this.m_flags & b2Body.e_activeFlag) == b2Body.e_activeFlag;
   }
   b2Body.prototype.IsSleepingAllowed = function () {
      return (this.m_flags & b2Body.e_allowSleepFlag) == b2Body.e_allowSleepFlag;
   }
   b2Body.prototype.GetFixtureList = function () {
      return this.m_fixtureList;
   }
   b2Body.prototype.GetJointList = function () {
      return this.m_jointList;
   }
   b2Body.prototype.GetControllerList = function () {
      return this.m_controllerList;
   }
   b2Body.prototype.GetContactList = function () {
      return this.m_contactList;
   }
   b2Body.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Body.prototype.GetUserData = function () {
      return this.m_userData;
   }
   b2Body.prototype.SetUserData = function (data) {
      this.m_userData = data;
   }
   b2Body.prototype.GetWorld = function () {
      return this.m_world;
   }
   b2Body.prototype.b2Body = function (bd, world) {
      this.m_flags = 0;
      if (bd.bullet) {
         this.m_flags |= b2Body.e_bulletFlag;
      }
      if (bd.fixedRotation) {
         this.m_flags |= b2Body.e_fixedRotationFlag;
      }
      if (bd.allowSleep) {
         this.m_flags |= b2Body.e_allowSleepFlag;
      }
      if (bd.awake) {
         this.m_flags |= b2Body.e_awakeFlag;
      }
      if (bd.active) {
         this.m_flags |= b2Body.e_activeFlag;
      }
      this.m_world = world;
      this.m_xf.position.SetV(bd.position);
      this.m_xf.R.Set(bd.angle);
      this.m_sweep.localCenter.SetZero();
      this.m_sweep.t0 = 1.0;
      this.m_sweep.a0 = this.m_sweep.a = bd.angle;
      var tMat = this.m_xf.R;
      var tVec = this.m_sweep.localCenter;
      this.m_sweep.c.x = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      this.m_sweep.c.y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      this.m_sweep.c.x += this.m_xf.position.x;
      this.m_sweep.c.y += this.m_xf.position.y;
      this.m_sweep.c0.SetV(this.m_sweep.c);
      this.m_jointList = null;
      this.m_controllerList = null;
      this.m_contactList = null;
      this.m_controllerCount = 0;
      this.m_prev = null;
      this.m_next = null;
      this.m_linearVelocity.SetV(bd.linearVelocity);
      this.m_angularVelocity = bd.angularVelocity;
      this.m_linearDamping = bd.linearDamping;
      this.m_angularDamping = bd.angularDamping;
      this.m_force.Set(0.0, 0.0);
      this.m_torque = 0.0;
      this.m_sleepTime = 0.0;
      this.m_type = bd.type;
      if (this.m_type == b2Body.b2_dynamicBody) {
         this.m_mass = 1.0;
         this.m_invMass = 1.0;
      }
      else {
         this.m_mass = 0.0;
         this.m_invMass = 0.0;
      }
      this.m_I = 0.0;
      this.m_invI = 0.0;
      this.m_inertiaScale = bd.inertiaScale;
      this.m_userData = bd.userData;
      this.m_fixtureList = null;
      this.m_fixtureCount = 0;
   }
   b2Body.prototype.SynchronizeFixtures = function () {
      var xf1 = b2Body.s_xf1;
      xf1.R.Set(this.m_sweep.a0);
      var tMat = xf1.R;
      var tVec = this.m_sweep.localCenter;
      xf1.position.x = this.m_sweep.c0.x - (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      xf1.position.y = this.m_sweep.c0.y - (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var f;
      var broadPhase = this.m_world.m_contactManager.m_broadPhase;
      for (f = this.m_fixtureList;
      f; f = f.m_next) {
         f.Synchronize(broadPhase, xf1, this.m_xf);
      }
   }
   b2Body.prototype.SynchronizeTransform = function () {
      this.m_xf.R.Set(this.m_sweep.a);
      var tMat = this.m_xf.R;
      var tVec = this.m_sweep.localCenter;
      this.m_xf.position.x = this.m_sweep.c.x - (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      this.m_xf.position.y = this.m_sweep.c.y - (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
   }
   b2Body.prototype.ShouldCollide = function (other) {
      if (this.m_type != b2Body.b2_dynamicBody && other.m_type != b2Body.b2_dynamicBody) {
         return false;
      }
      for (var jn = this.m_jointList; jn; jn = jn.next) {
         if (jn.other == other) if (jn.joint.m_collideConnected == false) {
            return false;
         }
      }
      return true;
   }
   b2Body.prototype.Advance = function (t) {
      if (t === undefined) t = 0;
      this.m_sweep.Advance(t);
      this.m_sweep.c.SetV(this.m_sweep.c0);
      this.m_sweep.a = this.m_sweep.a0;
      this.SynchronizeTransform();
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2Body.s_xf1 = new b2Transform();
      Box2D.Dynamics.b2Body.e_islandFlag = 0x0001;
      Box2D.Dynamics.b2Body.e_awakeFlag = 0x0002;
      Box2D.Dynamics.b2Body.e_allowSleepFlag = 0x0004;
      Box2D.Dynamics.b2Body.e_bulletFlag = 0x0008;
      Box2D.Dynamics.b2Body.e_fixedRotationFlag = 0x0010;
      Box2D.Dynamics.b2Body.e_activeFlag = 0x0020;
      Box2D.Dynamics.b2Body.b2_staticBody = 0;
      Box2D.Dynamics.b2Body.b2_kinematicBody = 1;
      Box2D.Dynamics.b2Body.b2_dynamicBody = 2;
   });
   b2BodyDef.b2BodyDef = function () {
      this.position = new b2Vec2();
      this.linearVelocity = new b2Vec2();
   };
   b2BodyDef.prototype.b2BodyDef = function () {
      this.userData = null;
      this.position.Set(0.0, 0.0);
      this.angle = 0.0;
      this.linearVelocity.Set(0, 0);
      this.angularVelocity = 0.0;
      this.linearDamping = 0.0;
      this.angularDamping = 0.0;
      this.allowSleep = true;
      this.awake = true;
      this.fixedRotation = false;
      this.bullet = false;
      this.type = b2Body.b2_staticBody;
      this.active = true;
      this.inertiaScale = 1.0;
   }
   b2ContactFilter.b2ContactFilter = function () {};
   b2ContactFilter.prototype.ShouldCollide = function (fixtureA, fixtureB) {
      var filter1 = fixtureA.GetFilterData();
      var filter2 = fixtureB.GetFilterData();
      if (filter1.groupIndex == filter2.groupIndex && filter1.groupIndex != 0) {
         return filter1.groupIndex > 0;
      }
      var collide = (filter1.maskBits & filter2.categoryBits) != 0 && (filter1.categoryBits & filter2.maskBits) != 0;
      return collide;
   }
   b2ContactFilter.prototype.RayCollide = function (userData, fixture) {
      if (!userData) return true;
      return this.ShouldCollide((userData instanceof b2Fixture ? userData : null), fixture);
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2ContactFilter.b2_defaultFilter = new b2ContactFilter();
   });
   b2ContactImpulse.b2ContactImpulse = function () {
      this.normalImpulses = new Vector_a2j_Number(b2Settings.b2_maxManifoldPoints);
      this.tangentImpulses = new Vector_a2j_Number(b2Settings.b2_maxManifoldPoints);
   };
   b2ContactListener.b2ContactListener = function () {};
   b2ContactListener.prototype.BeginContact = function (contact) {}
   b2ContactListener.prototype.EndContact = function (contact) {}
   b2ContactListener.prototype.PreSolve = function (contact, oldManifold) {}
   b2ContactListener.prototype.PostSolve = function (contact, impulse) {}
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2ContactListener.b2_defaultListener = new b2ContactListener();
   });
   b2ContactManager.b2ContactManager = function () {};
   b2ContactManager.prototype.b2ContactManager = function () {
      this.m_world = null;
      this.m_contactCount = 0;
      this.m_contactFilter = b2ContactFilter.b2_defaultFilter;
      this.m_contactListener = b2ContactListener.b2_defaultListener;
      this.m_contactFactory = new b2ContactFactory(this.m_allocator);
      this.m_broadPhase = new b2DynamicTreeBroadPhase();
   }
   b2ContactManager.prototype.AddPair = function (proxyUserDataA, proxyUserDataB) {
      var fixtureA = (proxyUserDataA instanceof b2Fixture ? proxyUserDataA : null);
      var fixtureB = (proxyUserDataB instanceof b2Fixture ? proxyUserDataB : null);
      var bodyA = fixtureA.GetBody();
      var bodyB = fixtureB.GetBody();
      if (bodyA == bodyB) return;
      var edge = bodyB.GetContactList();
      while (edge) {
         if (edge.other == bodyA) {
            var fA = edge.contact.GetFixtureA();
            var fB = edge.contact.GetFixtureB();
            if (fA == fixtureA && fB == fixtureB) return;
            if (fA == fixtureB && fB == fixtureA) return;
         }
         edge = edge.next;
      }
      if (bodyB.ShouldCollide(bodyA) == false) {
         return;
      }
      if (this.m_contactFilter.ShouldCollide(fixtureA, fixtureB) == false) {
         return;
      }
      var c = this.m_contactFactory.Create(fixtureA, fixtureB);
      fixtureA = c.GetFixtureA();
      fixtureB = c.GetFixtureB();
      bodyA = fixtureA.m_body;
      bodyB = fixtureB.m_body;
      c.m_prev = null;
      c.m_next = this.m_world.m_contactList;
      if (this.m_world.m_contactList != null) {
         this.m_world.m_contactList.m_prev = c;
      }
      this.m_world.m_contactList = c;
      c.m_nodeA.contact = c;
      c.m_nodeA.other = bodyB;
      c.m_nodeA.prev = null;
      c.m_nodeA.next = bodyA.m_contactList;
      if (bodyA.m_contactList != null) {
         bodyA.m_contactList.prev = c.m_nodeA;
      }
      bodyA.m_contactList = c.m_nodeA;
      c.m_nodeB.contact = c;
      c.m_nodeB.other = bodyA;
      c.m_nodeB.prev = null;
      c.m_nodeB.next = bodyB.m_contactList;
      if (bodyB.m_contactList != null) {
         bodyB.m_contactList.prev = c.m_nodeB;
      }
      bodyB.m_contactList = c.m_nodeB;
      ++this.m_world.m_contactCount;
      return;
   }
   b2ContactManager.prototype.FindNewContacts = function () {
      this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this, this.AddPair));
   }
   b2ContactManager.prototype.Destroy = function (c) {
      var fixtureA = c.GetFixtureA();
      var fixtureB = c.GetFixtureB();
      var bodyA = fixtureA.GetBody();
      var bodyB = fixtureB.GetBody();
      if (c.IsTouching()) {
         this.m_contactListener.EndContact(c);
      }
      if (c.m_prev) {
         c.m_prev.m_next = c.m_next;
      }
      if (c.m_next) {
         c.m_next.m_prev = c.m_prev;
      }
      if (c == this.m_world.m_contactList) {
         this.m_world.m_contactList = c.m_next;
      }
      if (c.m_nodeA.prev) {
         c.m_nodeA.prev.next = c.m_nodeA.next;
      }
      if (c.m_nodeA.next) {
         c.m_nodeA.next.prev = c.m_nodeA.prev;
      }
      if (c.m_nodeA == bodyA.m_contactList) {
         bodyA.m_contactList = c.m_nodeA.next;
      }
      if (c.m_nodeB.prev) {
         c.m_nodeB.prev.next = c.m_nodeB.next;
      }
      if (c.m_nodeB.next) {
         c.m_nodeB.next.prev = c.m_nodeB.prev;
      }
      if (c.m_nodeB == bodyB.m_contactList) {
         bodyB.m_contactList = c.m_nodeB.next;
      }
      this.m_contactFactory.Destroy(c);
      --this.m_contactCount;
   }
   b2ContactManager.prototype.Collide = function () {
      var c = this.m_world.m_contactList;
      while (c) {
         var fixtureA = c.GetFixtureA();
         var fixtureB = c.GetFixtureB();
         var bodyA = fixtureA.GetBody();
         var bodyB = fixtureB.GetBody();
         if (bodyA.IsAwake() == false && bodyB.IsAwake() == false) {
            c = c.GetNext();
            continue;
         }
         if (c.m_flags & b2Contact.e_filterFlag) {
            if (bodyB.ShouldCollide(bodyA) == false) {
               var cNuke = c;
               c = cNuke.GetNext();
               this.Destroy(cNuke);
               continue;
            }
            if (this.m_contactFilter.ShouldCollide(fixtureA, fixtureB) == false) {
               cNuke = c;
               c = cNuke.GetNext();
               this.Destroy(cNuke);
               continue;
            }
            c.m_flags &= ~b2Contact.e_filterFlag;
         }
         var proxyA = fixtureA.m_proxy;
         var proxyB = fixtureB.m_proxy;
         var overlap = this.m_broadPhase.TestOverlap(proxyA, proxyB);
         if (overlap == false) {
            cNuke = c;
            c = cNuke.GetNext();
            this.Destroy(cNuke);
            continue;
         }
         c.Update(this.m_contactListener);
         c = c.GetNext();
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2ContactManager.s_evalCP = new b2ContactPoint();
   });
   b2DebugDraw.b2DebugDraw = function () {};
   b2DebugDraw.prototype.b2DebugDraw = function () {}
   b2DebugDraw.prototype.SetFlags = function (flags) {
      if (flags === undefined) flags = 0;
   }
   b2DebugDraw.prototype.GetFlags = function () {}
   b2DebugDraw.prototype.AppendFlags = function (flags) {
      if (flags === undefined) flags = 0;
   }
   b2DebugDraw.prototype.ClearFlags = function (flags) {
      if (flags === undefined) flags = 0;
   }
   b2DebugDraw.prototype.SetSprite = function (sprite) {}
   b2DebugDraw.prototype.GetSprite = function () {}
   b2DebugDraw.prototype.SetDrawScale = function (drawScale) {
      if (drawScale === undefined) drawScale = 0;
   }
   b2DebugDraw.prototype.GetDrawScale = function () {}
   b2DebugDraw.prototype.SetLineThickness = function (lineThickness) {
      if (lineThickness === undefined) lineThickness = 0;
   }
   b2DebugDraw.prototype.GetLineThickness = function () {}
   b2DebugDraw.prototype.SetAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
   }
   b2DebugDraw.prototype.GetAlpha = function () {}
   b2DebugDraw.prototype.SetFillAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
   }
   b2DebugDraw.prototype.GetFillAlpha = function () {}
   b2DebugDraw.prototype.SetXFormScale = function (xformScale) {
      if (xformScale === undefined) xformScale = 0;
   }
   b2DebugDraw.prototype.GetXFormScale = function () {}
   b2DebugDraw.prototype.DrawPolygon = function (vertices, vertexCount, color) {
      if (vertexCount === undefined) vertexCount = 0;
   }
   b2DebugDraw.prototype.DrawSolidPolygon = function (vertices, vertexCount, color) {
      if (vertexCount === undefined) vertexCount = 0;
   }
   b2DebugDraw.prototype.DrawCircle = function (center, radius, color) {
      if (radius === undefined) radius = 0;
   }
   b2DebugDraw.prototype.DrawSolidCircle = function (center, radius, axis, color) {
      if (radius === undefined) radius = 0;
   }
   b2DebugDraw.prototype.DrawSegment = function (p1, p2, color) {}
   b2DebugDraw.prototype.DrawTransform = function (xf) {}
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2DebugDraw.e_shapeBit = 0x0001;
      Box2D.Dynamics.b2DebugDraw.e_jointBit = 0x0002;
      Box2D.Dynamics.b2DebugDraw.e_aabbBit = 0x0004;
      Box2D.Dynamics.b2DebugDraw.e_pairBit = 0x0008;
      Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit = 0x0010;
      Box2D.Dynamics.b2DebugDraw.e_controllerBit = 0x0020;
   });
   b2DestructionListener.b2DestructionListener = function () {};
   b2DestructionListener.prototype.SayGoodbyeJoint = function (joint) {}
   b2DestructionListener.prototype.SayGoodbyeFixture = function (fixture) {}
   b2FilterData.b2FilterData = function () {
      this.categoryBits = 0x0001;
      this.maskBits = 0xFFFF;
      this.groupIndex = 0;
   };
   b2FilterData.prototype.Copy = function () {
      var copy = new b2FilterData();
      copy.categoryBits = this.categoryBits;
      copy.maskBits = this.maskBits;
      copy.groupIndex = this.groupIndex;
      return copy;
   }
   b2Fixture.b2Fixture = function () {
      this.m_filter = new b2FilterData();
   };
   b2Fixture.prototype.GetType = function () {
      return this.m_shape.GetType();
   }
   b2Fixture.prototype.GetShape = function () {
      return this.m_shape;
   }
   b2Fixture.prototype.SetSensor = function (sensor) {
      if (this.m_isSensor == sensor) return;
      this.m_isSensor = sensor;
      if (this.m_body == null) return;
      var edge = this.m_body.GetContactList();
      while (edge) {
         var contact = edge.contact;
         var fixtureA = contact.GetFixtureA();
         var fixtureB = contact.GetFixtureB();
         if (fixtureA == this || fixtureB == this) contact.SetSensor(fixtureA.IsSensor() || fixtureB.IsSensor());
         edge = edge.next;
      }
   }
   b2Fixture.prototype.IsSensor = function () {
      return this.m_isSensor;
   }
   b2Fixture.prototype.SetFilterData = function (filter) {
      this.m_filter = filter.Copy();
      if (this.m_body) return;
      var edge = this.m_body.GetContactList();
      while (edge) {
         var contact = edge.contact;
         var fixtureA = contact.GetFixtureA();
         var fixtureB = contact.GetFixtureB();
         if (fixtureA == this || fixtureB == this) contact.FlagForFiltering();
         edge = edge.next;
      }
   }
   b2Fixture.prototype.GetFilterData = function () {
      return this.m_filter.Copy();
   }
   b2Fixture.prototype.GetBody = function () {
      return this.m_body;
   }
   b2Fixture.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Fixture.prototype.GetUserData = function () {
      return this.m_userData;
   }
   b2Fixture.prototype.SetUserData = function (data) {
      this.m_userData = data;
   }
   b2Fixture.prototype.TestPoint = function (p) {
      return this.m_shape.TestPoint(this.m_body.GetTransform(), p);
   }
   b2Fixture.prototype.RayCast = function (output, input) {
      return this.m_shape.RayCast(output, input, this.m_body.GetTransform());
   }
   b2Fixture.prototype.GetMassData = function (massData) {
      if (massData === undefined) massData = null;
      if (massData == null) {
         massData = new b2MassData();
      }
      this.m_shape.ComputeMass(massData, this.m_density);
      return massData;
   }
   b2Fixture.prototype.SetDensity = function (density) {
      if (density === undefined) density = 0;
      this.m_density = density;
   }
   b2Fixture.prototype.GetDensity = function () {
      return this.m_density;
   }
   b2Fixture.prototype.GetFriction = function () {
      return this.m_friction;
   }
   b2Fixture.prototype.SetFriction = function (friction) {
      if (friction === undefined) friction = 0;
      this.m_friction = friction;
   }
   b2Fixture.prototype.GetRestitution = function () {
      return this.m_restitution;
   }
   b2Fixture.prototype.SetRestitution = function (restitution) {
      if (restitution === undefined) restitution = 0;
      this.m_restitution = restitution;
   }
   b2Fixture.prototype.GetAABB = function () {
      return this.m_aabb;
   }
   b2Fixture.prototype.b2Fixture = function () {
      this.m_aabb = new b2AABB();
      this.m_userData = null;
      this.m_body = null;
      this.m_next = null;
      this.m_shape = null;
      this.m_density = 0.0;
      this.m_friction = 0.0;
      this.m_restitution = 0.0;
   }
   b2Fixture.prototype.Create = function (body, xf, def) {
      this.m_userData = def.userData;
      this.m_friction = def.friction;
      this.m_restitution = def.restitution;
      this.m_body = body;
      this.m_next = null;
      this.m_filter = def.filter.Copy();
      this.m_isSensor = def.isSensor;
      this.m_shape = def.shape.Copy();
      this.m_density = def.density;
   }
   b2Fixture.prototype.Destroy = function () {
      this.m_shape = null;
   }
   b2Fixture.prototype.CreateProxy = function (broadPhase, xf) {
      this.m_shape.ComputeAABB(this.m_aabb, xf);
      this.m_proxy = broadPhase.CreateProxy(this.m_aabb, this);
   }
   b2Fixture.prototype.DestroyProxy = function (broadPhase) {
      if (this.m_proxy == null) {
         return;
      }
      broadPhase.DestroyProxy(this.m_proxy);
      this.m_proxy = null;
   }
   b2Fixture.prototype.Synchronize = function (broadPhase, transform1, transform2) {
      if (!this.m_proxy) return;
      var aabb1 = new b2AABB();
      var aabb2 = new b2AABB();
      this.m_shape.ComputeAABB(aabb1, transform1);
      this.m_shape.ComputeAABB(aabb2, transform2);
      this.m_aabb.Combine(aabb1, aabb2);
      var displacement = b2Math.SubtractVV(transform2.position, transform1.position);
      broadPhase.MoveProxy(this.m_proxy, this.m_aabb, displacement);
   }
   b2FixtureDef.b2FixtureDef = function () {
      this.filter = new b2FilterData();
   };
   b2FixtureDef.prototype.b2FixtureDef = function () {
      this.shape = null;
      this.userData = null;
      this.friction = 0.2;
      this.restitution = 0.0;
      this.density = 0.0;
      this.filter.categoryBits = 0x0001;
      this.filter.maskBits = 0xFFFF;
      this.filter.groupIndex = 0;
      this.isSensor = false;
   }
   b2Island.b2Island = function () {};
   b2Island.prototype.b2Island = function () {
      this.m_bodies = new Vector();
      this.m_contacts = new Vector();
      this.m_joints = new Vector();
   }
   b2Island.prototype.Initialize = function (bodyCapacity, contactCapacity, jointCapacity, allocator, listener, contactSolver) {
      if (bodyCapacity === undefined) bodyCapacity = 0;
      if (contactCapacity === undefined) contactCapacity = 0;
      if (jointCapacity === undefined) jointCapacity = 0;
      var i = 0;
      this.m_bodyCapacity = bodyCapacity;
      this.m_contactCapacity = contactCapacity;
      this.m_jointCapacity = jointCapacity;
      this.m_bodyCount = 0;
      this.m_contactCount = 0;
      this.m_jointCount = 0;
      this.m_allocator = allocator;
      this.m_listener = listener;
      this.m_contactSolver = contactSolver;
      for (i = this.m_bodies.length;
      i < bodyCapacity; i++)
      this.m_bodies[i] = null;
      for (i = this.m_contacts.length;
      i < contactCapacity; i++)
      this.m_contacts[i] = null;
      for (i = this.m_joints.length;
      i < jointCapacity; i++)
      this.m_joints[i] = null;
   }
   b2Island.prototype.Clear = function () {
      this.m_bodyCount = 0;
      this.m_contactCount = 0;
      this.m_jointCount = 0;
   }
   b2Island.prototype.Solve = function (step, gravity, allowSleep) {
      var i = 0;
      var j = 0;
      var b;
      var joint;
      for (i = 0;
      i < this.m_bodyCount; ++i) {
         b = this.m_bodies[i];
         if (b.GetType() != b2Body.b2_dynamicBody) continue;
         b.m_linearVelocity.x += step.dt * (gravity.x + b.m_invMass * b.m_force.x);
         b.m_linearVelocity.y += step.dt * (gravity.y + b.m_invMass * b.m_force.y);
         b.m_angularVelocity += step.dt * b.m_invI * b.m_torque;
         b.m_linearVelocity.Multiply(b2Math.Clamp(1.0 - step.dt * b.m_linearDamping, 0.0, 1.0));
         b.m_angularVelocity *= b2Math.Clamp(1.0 - step.dt * b.m_angularDamping, 0.0, 1.0);
      }
      this.m_contactSolver.Initialize(step, this.m_contacts, this.m_contactCount, this.m_allocator);
      var contactSolver = this.m_contactSolver;
      contactSolver.InitVelocityConstraints(step);
      for (i = 0;
      i < this.m_jointCount; ++i) {
         joint = this.m_joints[i];
         joint.InitVelocityConstraints(step);
      }
      for (i = 0;
      i < step.velocityIterations; ++i) {
         for (j = 0;
         j < this.m_jointCount; ++j) {
            joint = this.m_joints[j];
            joint.SolveVelocityConstraints(step);
         }
         contactSolver.SolveVelocityConstraints();
      }
      for (i = 0;
      i < this.m_jointCount; ++i) {
         joint = this.m_joints[i];
         joint.FinalizeVelocityConstraints();
      }
      contactSolver.FinalizeVelocityConstraints();
      for (i = 0;
      i < this.m_bodyCount; ++i) {
         b = this.m_bodies[i];
         if (b.GetType() == b2Body.b2_staticBody) continue;
         var translationX = step.dt * b.m_linearVelocity.x;
         var translationY = step.dt * b.m_linearVelocity.y;
         if ((translationX * translationX + translationY * translationY) > b2Settings.b2_maxTranslationSquared) {
            b.m_linearVelocity.Normalize();
            b.m_linearVelocity.x *= b2Settings.b2_maxTranslation * step.inv_dt;
            b.m_linearVelocity.y *= b2Settings.b2_maxTranslation * step.inv_dt;
         }
         var rotation = step.dt * b.m_angularVelocity;
         if (rotation * rotation > b2Settings.b2_maxRotationSquared) {
            if (b.m_angularVelocity < 0.0) {
               b.m_angularVelocity = (-b2Settings.b2_maxRotation * step.inv_dt);
            }
            else {
               b.m_angularVelocity = b2Settings.b2_maxRotation * step.inv_dt;
            }
         }
         b.m_sweep.c0.SetV(b.m_sweep.c);
         b.m_sweep.a0 = b.m_sweep.a;
         b.m_sweep.c.x += step.dt * b.m_linearVelocity.x;
         b.m_sweep.c.y += step.dt * b.m_linearVelocity.y;
         b.m_sweep.a += step.dt * b.m_angularVelocity;
         b.SynchronizeTransform();
      }
      for (i = 0;
      i < step.positionIterations; ++i) {
         var contactsOkay = contactSolver.SolvePositionConstraints(b2Settings.b2_contactBaumgarte);
         var jointsOkay = true;
         for (j = 0;
         j < this.m_jointCount; ++j) {
            joint = this.m_joints[j];
            var jointOkay = joint.SolvePositionConstraints(b2Settings.b2_contactBaumgarte);
            jointsOkay = jointsOkay && jointOkay;
         }
         if (contactsOkay && jointsOkay) {
            break;
         }
      }
      this.Report(contactSolver.m_constraints);
      if (allowSleep) {
         var minSleepTime = Number.MAX_VALUE;
         var linTolSqr = b2Settings.b2_linearSleepTolerance * b2Settings.b2_linearSleepTolerance;
         var angTolSqr = b2Settings.b2_angularSleepTolerance * b2Settings.b2_angularSleepTolerance;
         for (i = 0;
         i < this.m_bodyCount; ++i) {
            b = this.m_bodies[i];
            if (b.GetType() == b2Body.b2_staticBody) {
               continue;
            }
            if ((b.m_flags & b2Body.e_allowSleepFlag) == 0) {
               b.m_sleepTime = 0.0;
               minSleepTime = 0.0;
            }
            if ((b.m_flags & b2Body.e_allowSleepFlag) == 0 || b.m_angularVelocity * b.m_angularVelocity > angTolSqr || b2Math.Dot(b.m_linearVelocity, b.m_linearVelocity) > linTolSqr) {
               b.m_sleepTime = 0.0;
               minSleepTime = 0.0;
            }
            else {
               b.m_sleepTime += step.dt;
               minSleepTime = b2Math.Min(minSleepTime, b.m_sleepTime);
            }
         }
         if (minSleepTime >= b2Settings.b2_timeToSleep) {
            for (i = 0;
            i < this.m_bodyCount; ++i) {
               b = this.m_bodies[i];
               b.SetAwake(false);
            }
         }
      }
   }
   b2Island.prototype.SolveTOI = function (subStep) {
      var i = 0;
      var j = 0;
      this.m_contactSolver.Initialize(subStep, this.m_contacts, this.m_contactCount, this.m_allocator);
      var contactSolver = this.m_contactSolver;
      for (i = 0;
      i < this.m_jointCount; ++i) {
         this.m_joints[i].InitVelocityConstraints(subStep);
      }
      for (i = 0;
      i < subStep.velocityIterations; ++i) {
         contactSolver.SolveVelocityConstraints();
         for (j = 0;
         j < this.m_jointCount; ++j) {
            this.m_joints[j].SolveVelocityConstraints(subStep);
         }
      }
      for (i = 0;
      i < this.m_bodyCount; ++i) {
         var b = this.m_bodies[i];
         if (b.GetType() == b2Body.b2_staticBody) continue;
         var translationX = subStep.dt * b.m_linearVelocity.x;
         var translationY = subStep.dt * b.m_linearVelocity.y;
         if ((translationX * translationX + translationY * translationY) > b2Settings.b2_maxTranslationSquared) {
            b.m_linearVelocity.Normalize();
            b.m_linearVelocity.x *= b2Settings.b2_maxTranslation * subStep.inv_dt;
            b.m_linearVelocity.y *= b2Settings.b2_maxTranslation * subStep.inv_dt;
         }
         var rotation = subStep.dt * b.m_angularVelocity;
         if (rotation * rotation > b2Settings.b2_maxRotationSquared) {
            if (b.m_angularVelocity < 0.0) {
               b.m_angularVelocity = (-b2Settings.b2_maxRotation * subStep.inv_dt);
            }
            else {
               b.m_angularVelocity = b2Settings.b2_maxRotation * subStep.inv_dt;
            }
         }
         b.m_sweep.c0.SetV(b.m_sweep.c);
         b.m_sweep.a0 = b.m_sweep.a;
         b.m_sweep.c.x += subStep.dt * b.m_linearVelocity.x;
         b.m_sweep.c.y += subStep.dt * b.m_linearVelocity.y;
         b.m_sweep.a += subStep.dt * b.m_angularVelocity;
         b.SynchronizeTransform();
      }
      var k_toiBaumgarte = 0.75;
      for (i = 0;
      i < subStep.positionIterations; ++i) {
         var contactsOkay = contactSolver.SolvePositionConstraints(k_toiBaumgarte);
         var jointsOkay = true;
         for (j = 0;
         j < this.m_jointCount; ++j) {
            var jointOkay = this.m_joints[j].SolvePositionConstraints(b2Settings.b2_contactBaumgarte);
            jointsOkay = jointsOkay && jointOkay;
         }
         if (contactsOkay && jointsOkay) {
            break;
         }
      }
      this.Report(contactSolver.m_constraints);
   }
   b2Island.prototype.Report = function (constraints) {
      if (this.m_listener == null) {
         return;
      }
      for (var i = 0; i < this.m_contactCount; ++i) {
         var c = this.m_contacts[i];
         var cc = constraints[i];
         for (var j = 0; j < cc.pointCount; ++j) {
            b2Island.s_impulse.normalImpulses[j] = cc.points[j].normalImpulse;
            b2Island.s_impulse.tangentImpulses[j] = cc.points[j].tangentImpulse;
         }
         this.m_listener.PostSolve(c, b2Island.s_impulse);
      }
   }
   b2Island.prototype.AddBody = function (body) {
      body.m_islandIndex = this.m_bodyCount;
      this.m_bodies[this.m_bodyCount++] = body;
   }
   b2Island.prototype.AddContact = function (contact) {
      this.m_contacts[this.m_contactCount++] = contact;
   }
   b2Island.prototype.AddJoint = function (joint) {
      this.m_joints[this.m_jointCount++] = joint;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2Island.s_impulse = new b2ContactImpulse();
   });
   b2TimeStep.b2TimeStep = function () {};
   b2TimeStep.prototype.Set = function (step) {
      this.dt = step.dt;
      this.inv_dt = step.inv_dt;
      this.positionIterations = step.positionIterations;
      this.velocityIterations = step.velocityIterations;
      this.warmStarting = step.warmStarting;
   }
   b2World.b2World = function () {
      this.s_stack = new Vector();
      this.m_contactManager = new b2ContactManager();
      this.m_contactSolver = new b2ContactSolver();
      this.m_island = new b2Island();
   };
   b2World.prototype.b2World = function (gravity, doSleep) {
      this.m_destructionListener = null;
      this.m_debugDraw = null;
      this.m_bodyList = null;
      this.m_contactList = null;
      this.m_jointList = null;
      this.m_controllerList = null;
      this.m_bodyCount = 0;
      this.m_contactCount = 0;
      this.m_jointCount = 0;
      this.m_controllerCount = 0;
      b2World.m_warmStarting = true;
      b2World.m_continuousPhysics = true;
      this.m_allowSleep = doSleep;
      this.m_gravity = gravity;
      this.m_inv_dt0 = 0.0;
      this.m_contactManager.m_world = this;
      var bd = new b2BodyDef();
      this.m_groundBody = this.CreateBody(bd);
   }
   b2World.prototype.SetDestructionListener = function (listener) {
      this.m_destructionListener = listener;
   }
   b2World.prototype.SetContactFilter = function (filter) {
      this.m_contactManager.m_contactFilter = filter;
   }
   b2World.prototype.SetContactListener = function (listener) {
      this.m_contactManager.m_contactListener = listener;
   }
   b2World.prototype.SetDebugDraw = function (debugDraw) {
      this.m_debugDraw = debugDraw;
   }
   b2World.prototype.SetBroadPhase = function (broadPhase) {
      var oldBroadPhase = this.m_contactManager.m_broadPhase;
      this.m_contactManager.m_broadPhase = broadPhase;
      for (var b = this.m_bodyList; b; b = b.m_next) {
         for (var f = b.m_fixtureList; f; f = f.m_next) {
            f.m_proxy = broadPhase.CreateProxy(oldBroadPhase.GetFatAABB(f.m_proxy), f);
         }
      }
   }
   b2World.prototype.Validate = function () {
      this.m_contactManager.m_broadPhase.Validate();
   }
   b2World.prototype.GetProxyCount = function () {
      return this.m_contactManager.m_broadPhase.GetProxyCount();
   }
   b2World.prototype.CreateBody = function (def) {
      if (this.IsLocked() == true) {
         return null;
      }
      var b = new b2Body(def, this);
      b.m_prev = null;
      b.m_next = this.m_bodyList;
      if (this.m_bodyList) {
         this.m_bodyList.m_prev = b;
      }
      this.m_bodyList = b;
      ++this.m_bodyCount;
      return b;
   }
   b2World.prototype.DestroyBody = function (b) {
      if (this.IsLocked() == true) {
         return;
      }
      var jn = b.m_jointList;
      while (jn) {
         var jn0 = jn;
         jn = jn.next;
         if (this.m_destructionListener) {
            this.m_destructionListener.SayGoodbyeJoint(jn0.joint);
         }
         this.DestroyJoint(jn0.joint);
      }
      var coe = b.m_controllerList;
      while (coe) {
         var coe0 = coe;
         coe = coe.nextController;
         coe0.controller.RemoveBody(b);
      }
      var ce = b.m_contactList;
      while (ce) {
         var ce0 = ce;
         ce = ce.next;
         this.m_contactManager.Destroy(ce0.contact);
      }
      b.m_contactList = null;
      var f = b.m_fixtureList;
      while (f) {
         var f0 = f;
         f = f.m_next;
         if (this.m_destructionListener) {
            this.m_destructionListener.SayGoodbyeFixture(f0);
         }
         f0.DestroyProxy(this.m_contactManager.m_broadPhase);
         f0.Destroy();
      }
      b.m_fixtureList = null;
      b.m_fixtureCount = 0;
      if (b.m_prev) {
         b.m_prev.m_next = b.m_next;
      }
      if (b.m_next) {
         b.m_next.m_prev = b.m_prev;
      }
      if (b == this.m_bodyList) {
         this.m_bodyList = b.m_next;
      }--this.m_bodyCount;
   }
   b2World.prototype.CreateJoint = function (def) {
      var j = b2Joint.Create(def, null);
      j.m_prev = null;
      j.m_next = this.m_jointList;
      if (this.m_jointList) {
         this.m_jointList.m_prev = j;
      }
      this.m_jointList = j;
      ++this.m_jointCount;
      j.m_edgeA.joint = j;
      j.m_edgeA.other = j.m_bodyB;
      j.m_edgeA.prev = null;
      j.m_edgeA.next = j.m_bodyA.m_jointList;
      if (j.m_bodyA.m_jointList) j.m_bodyA.m_jointList.prev = j.m_edgeA;
      j.m_bodyA.m_jointList = j.m_edgeA;
      j.m_edgeB.joint = j;
      j.m_edgeB.other = j.m_bodyA;
      j.m_edgeB.prev = null;
      j.m_edgeB.next = j.m_bodyB.m_jointList;
      if (j.m_bodyB.m_jointList) j.m_bodyB.m_jointList.prev = j.m_edgeB;
      j.m_bodyB.m_jointList = j.m_edgeB;
      var bodyA = def.bodyA;
      var bodyB = def.bodyB;
      if (def.collideConnected == false) {
         var edge = bodyB.GetContactList();
         while (edge) {
            if (edge.other == bodyA) {
               edge.contact.FlagForFiltering();
            }
            edge = edge.next;
         }
      }
      return j;
   }
   b2World.prototype.DestroyJoint = function (j) {
      var collideConnected = j.m_collideConnected;
      if (j.m_prev) {
         j.m_prev.m_next = j.m_next;
      }
      if (j.m_next) {
         j.m_next.m_prev = j.m_prev;
      }
      if (j == this.m_jointList) {
         this.m_jointList = j.m_next;
      }
      var bodyA = j.m_bodyA;
      var bodyB = j.m_bodyB;
      bodyA.SetAwake(true);
      bodyB.SetAwake(true);
      if (j.m_edgeA.prev) {
         j.m_edgeA.prev.next = j.m_edgeA.next;
      }
      if (j.m_edgeA.next) {
         j.m_edgeA.next.prev = j.m_edgeA.prev;
      }
      if (j.m_edgeA == bodyA.m_jointList) {
         bodyA.m_jointList = j.m_edgeA.next;
      }
      j.m_edgeA.prev = null;
      j.m_edgeA.next = null;
      if (j.m_edgeB.prev) {
         j.m_edgeB.prev.next = j.m_edgeB.next;
      }
      if (j.m_edgeB.next) {
         j.m_edgeB.next.prev = j.m_edgeB.prev;
      }
      if (j.m_edgeB == bodyB.m_jointList) {
         bodyB.m_jointList = j.m_edgeB.next;
      }
      j.m_edgeB.prev = null;
      j.m_edgeB.next = null;
      b2Joint.Destroy(j, null);
      --this.m_jointCount;
      if (collideConnected == false) {
         var edge = bodyB.GetContactList();
         while (edge) {
            if (edge.other == bodyA) {
               edge.contact.FlagForFiltering();
            }
            edge = edge.next;
         }
      }
   }
   b2World.prototype.AddController = function (c) {
      c.m_next = this.m_controllerList;
      c.m_prev = null;
      this.m_controllerList = c;
      c.m_world = this;
      this.m_controllerCount++;
      return c;
   }
   b2World.prototype.RemoveController = function (c) {
      if (c.m_prev) c.m_prev.m_next = c.m_next;
      if (c.m_next) c.m_next.m_prev = c.m_prev;
      if (this.m_controllerList == c) this.m_controllerList = c.m_next;
      this.m_controllerCount--;
   }
   b2World.prototype.CreateController = function (controller) {
      if (controller.m_world != this) throw new Error("Controller can only be a member of one world");
      controller.m_next = this.m_controllerList;
      controller.m_prev = null;
      if (this.m_controllerList) this.m_controllerList.m_prev = controller;
      this.m_controllerList = controller;
      ++this.m_controllerCount;
      controller.m_world = this;
      return controller;
   }
   b2World.prototype.DestroyController = function (controller) {
      controller.Clear();
      if (controller.m_next) controller.m_next.m_prev = controller.m_prev;
      if (controller.m_prev) controller.m_prev.m_next = controller.m_next;
      if (controller == this.m_controllerList) this.m_controllerList = controller.m_next;
      --this.m_controllerCount;
   }
   b2World.prototype.SetWarmStarting = function (flag) {
      b2World.m_warmStarting = flag;
   }
   b2World.prototype.SetContinuousPhysics = function (flag) {
      b2World.m_continuousPhysics = flag;
   }
   b2World.prototype.GetBodyCount = function () {
      return this.m_bodyCount;
   }
   b2World.prototype.GetJointCount = function () {
      return this.m_jointCount;
   }
   b2World.prototype.GetContactCount = function () {
      return this.m_contactCount;
   }
   b2World.prototype.SetGravity = function (gravity) {
      this.m_gravity = gravity;
   }
   b2World.prototype.GetGravity = function () {
      return this.m_gravity;
   }
   b2World.prototype.GetGroundBody = function () {
      return this.m_groundBody;
   }
   b2World.prototype.Step = function (dt, velocityIterations, positionIterations) {
      if (dt === undefined) dt = 0;
      if (velocityIterations === undefined) velocityIterations = 0;
      if (positionIterations === undefined) positionIterations = 0;
      if (this.m_flags & b2World.e_newFixture) {
         this.m_contactManager.FindNewContacts();
         this.m_flags &= ~b2World.e_newFixture;
      }
      this.m_flags |= b2World.e_locked;
      var step = b2World.s_timestep2;
      step.dt = dt;
      step.velocityIterations = velocityIterations;
      step.positionIterations = positionIterations;
      if (dt > 0.0) {
         step.inv_dt = 1.0 / dt;
      }
      else {
         step.inv_dt = 0.0;
      }
      step.dtRatio = this.m_inv_dt0 * dt;
      step.warmStarting = b2World.m_warmStarting;
      this.m_contactManager.Collide();
      if (step.dt > 0.0) {
         this.Solve(step);
      }
      if (b2World.m_continuousPhysics && step.dt > 0.0) {
         this.SolveTOI(step);
      }
      if (step.dt > 0.0) {
         this.m_inv_dt0 = step.inv_dt;
      }
      this.m_flags &= ~b2World.e_locked;
   }
   b2World.prototype.ClearForces = function () {
      for (var body = this.m_bodyList; body; body = body.m_next) {
         body.m_force.SetZero();
         body.m_torque = 0.0;
      }
   }
   b2World.prototype.DrawDebugData = function () {
      if (this.m_debugDraw == null) {
         return;
      }
      this.m_debugDraw.m_sprite.graphics.clear();
      var flags = this.m_debugDraw.GetFlags();
      var i = 0;
      var b;
      var f;
      var s;
      var j;
      var bp;
      var invQ = new b2Vec2;
      var x1 = new b2Vec2;
      var x2 = new b2Vec2;
      var xf;
      var b1 = new b2AABB();
      var b2 = new b2AABB();
      var vs = [new b2Vec2(), new b2Vec2(), new b2Vec2(), new b2Vec2()];
      var color = new b2Color(0, 0, 0);
      if (flags & b2DebugDraw.e_shapeBit) {
         for (b = this.m_bodyList;
         b; b = b.m_next) {
            xf = b.m_xf;
            for (f = b.GetFixtureList();
            f; f = f.m_next) {
               s = f.GetShape();
               if (b.IsActive() == false) {
                  color.Set(0.5, 0.5, 0.3);
                  this.DrawShape(s, xf, color);
               }
               else if (b.GetType() == b2Body.b2_staticBody) {
                  color.Set(0.5, 0.9, 0.5);
                  this.DrawShape(s, xf, color);
               }
               else if (b.GetType() == b2Body.b2_kinematicBody) {
                  color.Set(0.5, 0.5, 0.9);
                  this.DrawShape(s, xf, color);
               }
               else if (b.IsAwake() == false) {
                  color.Set(0.6, 0.6, 0.6);
                  this.DrawShape(s, xf, color);
               }
               else {
                  color.Set(0.9, 0.7, 0.7);
                  this.DrawShape(s, xf, color);
               }
            }
         }
      }
      if (flags & b2DebugDraw.e_jointBit) {
         for (j = this.m_jointList;
         j; j = j.m_next) {
            this.DrawJoint(j);
         }
      }
      if (flags & b2DebugDraw.e_controllerBit) {
         for (var c = this.m_controllerList; c; c = c.m_next) {
            c.Draw(this.m_debugDraw);
         }
      }
      if (flags & b2DebugDraw.e_pairBit) {
         color.Set(0.3, 0.9, 0.9);
         for (var contact = this.m_contactManager.m_contactList; contact; contact = contact.GetNext()) {
            var fixtureA = contact.GetFixtureA();
            var fixtureB = contact.GetFixtureB();
            var cA = fixtureA.GetAABB().GetCenter();
            var cB = fixtureB.GetAABB().GetCenter();
            this.m_debugDraw.DrawSegment(cA, cB, color);
         }
      }
      if (flags & b2DebugDraw.e_aabbBit) {
         bp = this.m_contactManager.m_broadPhase;
         vs = [new b2Vec2(), new b2Vec2(), new b2Vec2(), new b2Vec2()];
         for (b = this.m_bodyList;
         b; b = b.GetNext()) {
            if (b.IsActive() == false) {
               continue;
            }
            for (f = b.GetFixtureList();
            f; f = f.GetNext()) {
               var aabb = bp.GetFatAABB(f.m_proxy);
               vs[0].Set(aabb.lowerBound.x, aabb.lowerBound.y);
               vs[1].Set(aabb.upperBound.x, aabb.lowerBound.y);
               vs[2].Set(aabb.upperBound.x, aabb.upperBound.y);
               vs[3].Set(aabb.lowerBound.x, aabb.upperBound.y);
               this.m_debugDraw.DrawPolygon(vs, 4, color);
            }
         }
      }
      if (flags & b2DebugDraw.e_centerOfMassBit) {
         for (b = this.m_bodyList;
         b; b = b.m_next) {
            xf = b2World.s_xf;
            xf.R = b.m_xf.R;
            xf.position = b.GetWorldCenter();
            this.m_debugDraw.DrawTransform(xf);
         }
      }
   }
   b2World.prototype.QueryAABB = function (callback, aabb) {
      var __this = this;
      var broadPhase = __this.m_contactManager.m_broadPhase;

      function WorldQueryWrapper(proxy) {
         return callback(broadPhase.GetUserData(proxy));
      };
      broadPhase.Query(WorldQueryWrapper, aabb);
   }
   b2World.prototype.QueryShape = function (callback, shape, transform) {
      var __this = this;
      if (transform === undefined) transform = null;
      if (transform == null) {
         transform = new b2Transform();
         transform.SetIdentity();
      }
      var broadPhase = __this.m_contactManager.m_broadPhase;

      function WorldQueryWrapper(proxy) {
         var fixture = (broadPhase.GetUserData(proxy) instanceof b2Fixture ? broadPhase.GetUserData(proxy) : null);
         if (b2Shape.TestOverlap(shape, transform, fixture.GetShape(), fixture.GetBody().GetTransform())) return callback(fixture);
         return true;
      };
      var aabb = new b2AABB();
      shape.ComputeAABB(aabb, transform);
      broadPhase.Query(WorldQueryWrapper, aabb);
   }
   b2World.prototype.QueryPoint = function (callback, p) {
      var __this = this;
      var broadPhase = __this.m_contactManager.m_broadPhase;

      function WorldQueryWrapper(proxy) {
         var fixture = (broadPhase.GetUserData(proxy) instanceof b2Fixture ? broadPhase.GetUserData(proxy) : null);
         if (fixture.TestPoint(p)) return callback(fixture);
         return true;
      };
      var aabb = new b2AABB();
      aabb.lowerBound.Set(p.x - b2Settings.b2_linearSlop, p.y - b2Settings.b2_linearSlop);
      aabb.upperBound.Set(p.x + b2Settings.b2_linearSlop, p.y + b2Settings.b2_linearSlop);
      broadPhase.Query(WorldQueryWrapper, aabb);
   }
   b2World.prototype.RayCast = function (callback, point1, point2) {
      var __this = this;
      var broadPhase = __this.m_contactManager.m_broadPhase;
      var output = new b2RayCastOutput;

      function RayCastWrapper(input, proxy) {
         var userData = broadPhase.GetUserData(proxy);
         var fixture = (userData instanceof b2Fixture ? userData : null);
         var hit = fixture.RayCast(output, input);
         if (hit) {
            var fraction = output.fraction;
            var point = new b2Vec2((1.0 - fraction) * point1.x + fraction * point2.x, (1.0 - fraction) * point1.y + fraction * point2.y);
            return callback(fixture, point, output.normal, fraction);
         }
         return input.maxFraction;
      };
      var input = new b2RayCastInput(point1, point2);
      broadPhase.RayCast(RayCastWrapper, input);
   }
   b2World.prototype.RayCastOne = function (point1, point2) {
      var __this = this;
      var result;

      function RayCastOneWrapper(fixture, point, normal, fraction) {
         if (fraction === undefined) fraction = 0;
         result = fixture;
         return fraction;
      };
      __this.RayCast(RayCastOneWrapper, point1, point2);
      return result;
   }
   b2World.prototype.RayCastAll = function (point1, point2) {
      var __this = this;
      var result = new Vector();

      function RayCastAllWrapper(fixture, point, normal, fraction) {
         if (fraction === undefined) fraction = 0;
         result[result.length] = fixture;
         return 1;
      };
      __this.RayCast(RayCastAllWrapper, point1, point2);
      return result;
   }
   b2World.prototype.GetBodyList = function () {
      return this.m_bodyList;
   }
   b2World.prototype.GetJointList = function () {
      return this.m_jointList;
   }
   b2World.prototype.GetContactList = function () {
      return this.m_contactList;
   }
   b2World.prototype.IsLocked = function () {
      return (this.m_flags & b2World.e_locked) > 0;
   }
   b2World.prototype.Solve = function (step) {
      var b;
      for (var controller = this.m_controllerList; controller; controller = controller.m_next) {
         controller.Step(step);
      }
      var island = this.m_island;
      island.Initialize(this.m_bodyCount, this.m_contactCount, this.m_jointCount, null, this.m_contactManager.m_contactListener, this.m_contactSolver);
      for (b = this.m_bodyList;
      b; b = b.m_next) {
         b.m_flags &= ~b2Body.e_islandFlag;
      }
      for (var c = this.m_contactList; c; c = c.m_next) {
         c.m_flags &= ~b2Contact.e_islandFlag;
      }
      for (var j = this.m_jointList; j; j = j.m_next) {
         j.m_islandFlag = false;
      }
      var stackSize = parseInt(this.m_bodyCount);
      var stack = this.s_stack;
      for (var seed = this.m_bodyList; seed; seed = seed.m_next) {
         if (seed.m_flags & b2Body.e_islandFlag) {
            continue;
         }
         if (seed.IsAwake() == false || seed.IsActive() == false) {
            continue;
         }
         if (seed.GetType() == b2Body.b2_staticBody) {
            continue;
         }
         island.Clear();
         var stackCount = 0;
         stack[stackCount++] = seed;
         seed.m_flags |= b2Body.e_islandFlag;
         while (stackCount > 0) {
            b = stack[--stackCount];
            island.AddBody(b);
            if (b.IsAwake() == false) {
               b.SetAwake(true);
            }
            if (b.GetType() == b2Body.b2_staticBody) {
               continue;
            }
            var other;
            for (var ce = b.m_contactList; ce; ce = ce.next) {
               if (ce.contact.m_flags & b2Contact.e_islandFlag) {
                  continue;
               }
               if (ce.contact.IsSensor() == true || ce.contact.IsEnabled() == false || ce.contact.IsTouching() == false) {
                  continue;
               }
               island.AddContact(ce.contact);
               ce.contact.m_flags |= b2Contact.e_islandFlag;
               other = ce.other;
               if (other.m_flags & b2Body.e_islandFlag) {
                  continue;
               }
               stack[stackCount++] = other;
               other.m_flags |= b2Body.e_islandFlag;
            }
            for (var jn = b.m_jointList; jn; jn = jn.next) {
               if (jn.joint.m_islandFlag == true) {
                  continue;
               }
               other = jn.other;
               if (other.IsActive() == false) {
                  continue;
               }
               island.AddJoint(jn.joint);
               jn.joint.m_islandFlag = true;
               if (other.m_flags & b2Body.e_islandFlag) {
                  continue;
               }
               stack[stackCount++] = other;
               other.m_flags |= b2Body.e_islandFlag;
            }
         }
         island.Solve(step, this.m_gravity, this.m_allowSleep);
         for (var i = 0; i < island.m_bodyCount; ++i) {
            b = island.m_bodies[i];
            if (b.GetType() == b2Body.b2_staticBody) {
               b.m_flags &= ~b2Body.e_islandFlag;
            }
         }
      }
      for (i = 0;
      i < stack.length; ++i) {
         if (!stack[i]) break;
         stack[i] = null;
      }
      for (b = this.m_bodyList;
      b; b = b.m_next) {
         if (b.IsAwake() == false || b.IsActive() == false) {
            continue;
         }
         if (b.GetType() == b2Body.b2_staticBody) {
            continue;
         }
         b.SynchronizeFixtures();
      }
      this.m_contactManager.FindNewContacts();
   }
   b2World.prototype.SolveTOI = function (step) {
      var b;
      var fA;
      var fB;
      var bA;
      var bB;
      var cEdge;
      var j;
      var island = this.m_island;
      island.Initialize(this.m_bodyCount, b2Settings.b2_maxTOIContactsPerIsland, b2Settings.b2_maxTOIJointsPerIsland, null, this.m_contactManager.m_contactListener, this.m_contactSolver);
      var queue = b2World.s_queue;
      for (b = this.m_bodyList;
      b; b = b.m_next) {
         b.m_flags &= ~b2Body.e_islandFlag;
         b.m_sweep.t0 = 0.0;
      }
      var c;
      for (c = this.m_contactList;
      c; c = c.m_next) {
         c.m_flags &= ~ (b2Contact.e_toiFlag | b2Contact.e_islandFlag);
      }
      for (j = this.m_jointList;
      j; j = j.m_next) {
         j.m_islandFlag = false;
      }
      for (;;) {
         var minContact = null;
         var minTOI = 1.0;
         for (c = this.m_contactList;
         c; c = c.m_next) {
            if (c.IsSensor() == true || c.IsEnabled() == false || c.IsContinuous() == false) {
               continue;
            }
            var toi = 1.0;
            if (c.m_flags & b2Contact.e_toiFlag) {
               toi = c.m_toi;
            }
            else {
               fA = c.m_fixtureA;
               fB = c.m_fixtureB;
               bA = fA.m_body;
               bB = fB.m_body;
               if ((bA.GetType() != b2Body.b2_dynamicBody || bA.IsAwake() == false) && (bB.GetType() != b2Body.b2_dynamicBody || bB.IsAwake() == false)) {
                  continue;
               }
               var t0 = bA.m_sweep.t0;
               if (bA.m_sweep.t0 < bB.m_sweep.t0) {
                  t0 = bB.m_sweep.t0;
                  bA.m_sweep.Advance(t0);
               }
               else if (bB.m_sweep.t0 < bA.m_sweep.t0) {
                  t0 = bA.m_sweep.t0;
                  bB.m_sweep.Advance(t0);
               }
               toi = c.ComputeTOI(bA.m_sweep, bB.m_sweep);
               b2Settings.b2Assert(0.0 <= toi && toi <= 1.0);
               if (toi > 0.0 && toi < 1.0) {
                  toi = (1.0 - toi) * t0 + toi;
                  if (toi > 1) toi = 1;
               }
               c.m_toi = toi;
               c.m_flags |= b2Contact.e_toiFlag;
            }
            if (Number.MIN_VALUE < toi && toi < minTOI) {
               minContact = c;
               minTOI = toi;
            }
         }
         if (minContact == null || 1.0 - 100.0 * Number.MIN_VALUE < minTOI) {
            break;
         }
         fA = minContact.m_fixtureA;
         fB = minContact.m_fixtureB;
         bA = fA.m_body;
         bB = fB.m_body;
         b2World.s_backupA.Set(bA.m_sweep);
         b2World.s_backupB.Set(bB.m_sweep);
         bA.Advance(minTOI);
         bB.Advance(minTOI);
         minContact.Update(this.m_contactManager.m_contactListener);
         minContact.m_flags &= ~b2Contact.e_toiFlag;
         if (minContact.IsSensor() == true || minContact.IsEnabled() == false) {
            bA.m_sweep.Set(b2World.s_backupA);
            bB.m_sweep.Set(b2World.s_backupB);
            bA.SynchronizeTransform();
            bB.SynchronizeTransform();
            continue;
         }
         if (minContact.IsTouching() == false) {
            continue;
         }
         var seed = bA;
         if (seed.GetType() != b2Body.b2_dynamicBody) {
            seed = bB;
         }
         island.Clear();
         var queueStart = 0;
         var queueSize = 0;
         queue[queueStart + queueSize++] = seed;
         seed.m_flags |= b2Body.e_islandFlag;
         while (queueSize > 0) {
            b = queue[queueStart++];
            --queueSize;
            island.AddBody(b);
            if (b.IsAwake() == false) {
               b.SetAwake(true);
            }
            if (b.GetType() != b2Body.b2_dynamicBody) {
               continue;
            }
            for (cEdge = b.m_contactList;
            cEdge; cEdge = cEdge.next) {
               if (island.m_contactCount == island.m_contactCapacity) {
                  break;
               }
               if (cEdge.contact.m_flags & b2Contact.e_islandFlag) {
                  continue;
               }
               if (cEdge.contact.IsSensor() == true || cEdge.contact.IsEnabled() == false || cEdge.contact.IsTouching() == false) {
                  continue;
               }
               island.AddContact(cEdge.contact);
               cEdge.contact.m_flags |= b2Contact.e_islandFlag;
               var other = cEdge.other;
               if (other.m_flags & b2Body.e_islandFlag) {
                  continue;
               }
               if (other.GetType() != b2Body.b2_staticBody) {
                  other.Advance(minTOI);
                  other.SetAwake(true);
               }
               queue[queueStart + queueSize] = other;
               ++queueSize;
               other.m_flags |= b2Body.e_islandFlag;
            }
            for (var jEdge = b.m_jointList; jEdge; jEdge = jEdge.next) {
               if (island.m_jointCount == island.m_jointCapacity) continue;
               if (jEdge.joint.m_islandFlag == true) continue;
               other = jEdge.other;
               if (other.IsActive() == false) {
                  continue;
               }
               island.AddJoint(jEdge.joint);
               jEdge.joint.m_islandFlag = true;
               if (other.m_flags & b2Body.e_islandFlag) continue;
               if (other.GetType() != b2Body.b2_staticBody) {
                  other.Advance(minTOI);
                  other.SetAwake(true);
               }
               queue[queueStart + queueSize] = other;
               ++queueSize;
               other.m_flags |= b2Body.e_islandFlag;
            }
         }
         var subStep = b2World.s_timestep;
         subStep.warmStarting = false;
         subStep.dt = (1.0 - minTOI) * step.dt;
         subStep.inv_dt = 1.0 / subStep.dt;
         subStep.dtRatio = 0.0;
         subStep.velocityIterations = step.velocityIterations;
         subStep.positionIterations = step.positionIterations;
         island.SolveTOI(subStep);
         var i = 0;
         for (i = 0;
         i < island.m_bodyCount; ++i) {
            b = island.m_bodies[i];
            b.m_flags &= ~b2Body.e_islandFlag;
            if (b.IsAwake() == false) {
               continue;
            }
            if (b.GetType() != b2Body.b2_dynamicBody) {
               continue;
            }
            b.SynchronizeFixtures();
            for (cEdge = b.m_contactList;
            cEdge; cEdge = cEdge.next) {
               cEdge.contact.m_flags &= ~b2Contact.e_toiFlag;
            }
         }
         for (i = 0;
         i < island.m_contactCount; ++i) {
            c = island.m_contacts[i];
            c.m_flags &= ~ (b2Contact.e_toiFlag | b2Contact.e_islandFlag);
         }
         for (i = 0;
         i < island.m_jointCount; ++i) {
            j = island.m_joints[i];
            j.m_islandFlag = false;
         }
         this.m_contactManager.FindNewContacts();
      }
   }
   b2World.prototype.DrawJoint = function (joint) {
      var b1 = joint.GetBodyA();
      var b2 = joint.GetBodyB();
      var xf1 = b1.m_xf;
      var xf2 = b2.m_xf;
      var x1 = xf1.position;
      var x2 = xf2.position;
      var p1 = joint.GetAnchorA();
      var p2 = joint.GetAnchorB();
      var color = b2World.s_jointColor;
      switch (joint.m_type) {
      case b2Joint.e_distanceJoint:
         this.m_debugDraw.DrawSegment(p1, p2, color);
         break;
      case b2Joint.e_pulleyJoint:
         {
            var pulley = ((joint instanceof b2PulleyJoint ? joint : null));
            var s1 = pulley.GetGroundAnchorA();
            var s2 = pulley.GetGroundAnchorB();
            this.m_debugDraw.DrawSegment(s1, p1, color);
            this.m_debugDraw.DrawSegment(s2, p2, color);
            this.m_debugDraw.DrawSegment(s1, s2, color);
         }
         break;
      case b2Joint.e_mouseJoint:
         this.m_debugDraw.DrawSegment(p1, p2, color);
         break;
      default:
         if (b1 != this.m_groundBody) this.m_debugDraw.DrawSegment(x1, p1, color);
         this.m_debugDraw.DrawSegment(p1, p2, color);
         if (b2 != this.m_groundBody) this.m_debugDraw.DrawSegment(x2, p2, color);
      }
   }
   b2World.prototype.DrawShape = function (shape, xf, color) {
      switch (shape.m_type) {
      case b2Shape.e_circleShape:
         {
            var circle = ((shape instanceof b2CircleShape ? shape : null));
            var center = b2Math.MulX(xf, circle.m_p);
            var radius = circle.m_radius;
            var axis = xf.R.col1;
            this.m_debugDraw.DrawSolidCircle(center, radius, axis, color);
         }
         break;
      case b2Shape.e_polygonShape:
         {
            var i = 0;
            var poly = ((shape instanceof b2PolygonShape ? shape : null));
            var vertexCount = parseInt(poly.GetVertexCount());
            var localVertices = poly.GetVertices();
            var vertices = new Vector(vertexCount);
            for (i = 0;
            i < vertexCount; ++i) {
               vertices[i] = b2Math.MulX(xf, localVertices[i]);
            }
            this.m_debugDraw.DrawSolidPolygon(vertices, vertexCount, color);
         }
         break;
      case b2Shape.e_edgeShape:
         {
            var edge = (shape instanceof b2EdgeShape ? shape : null);
            this.m_debugDraw.DrawSegment(b2Math.MulX(xf, edge.GetVertex1()), b2Math.MulX(xf, edge.GetVertex2()), color);
         }
         break;
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2World.s_timestep2 = new b2TimeStep();
      Box2D.Dynamics.b2World.s_xf = new b2Transform();
      Box2D.Dynamics.b2World.s_backupA = new b2Sweep();
      Box2D.Dynamics.b2World.s_backupB = new b2Sweep();
      Box2D.Dynamics.b2World.s_timestep = new b2TimeStep();
      Box2D.Dynamics.b2World.s_queue = new Vector();
      Box2D.Dynamics.b2World.s_jointColor = new b2Color(0.5, 0.8, 0.8);
      Box2D.Dynamics.b2World.e_newFixture = 0x0001;
      Box2D.Dynamics.b2World.e_locked = 0x0002;
   });
})();
(function () {
   var b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2CircleContact = Box2D.Dynamics.Contacts.b2CircleContact,
      b2Contact = Box2D.Dynamics.Contacts.b2Contact,
      b2ContactConstraint = Box2D.Dynamics.Contacts.b2ContactConstraint,
      b2ContactConstraintPoint = Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
      b2ContactEdge = Box2D.Dynamics.Contacts.b2ContactEdge,
      b2ContactFactory = Box2D.Dynamics.Contacts.b2ContactFactory,
      b2ContactRegister = Box2D.Dynamics.Contacts.b2ContactRegister,
      b2ContactResult = Box2D.Dynamics.Contacts.b2ContactResult,
      b2ContactSolver = Box2D.Dynamics.Contacts.b2ContactSolver,
      b2EdgeAndCircleContact = Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
      b2NullContact = Box2D.Dynamics.Contacts.b2NullContact,
      b2PolyAndCircleContact = Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
      b2PolyAndEdgeContact = Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
      b2PolygonContact = Box2D.Dynamics.Contacts.b2PolygonContact,
      b2PositionSolverManifold = Box2D.Dynamics.Contacts.b2PositionSolverManifold,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase;

   Box2D.inherit(b2CircleContact, Box2D.Dynamics.Contacts.b2Contact);
   b2CircleContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2CircleContact.b2CircleContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2CircleContact.Create = function (allocator) {
      return new b2CircleContact();
   }
   b2CircleContact.Destroy = function (contact, allocator) {}
   b2CircleContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
   }
   b2CircleContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      b2Collision.CollideCircles(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2CircleShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2CircleShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2Contact.b2Contact = function () {
      this.m_nodeA = new b2ContactEdge();
      this.m_nodeB = new b2ContactEdge();
      this.m_manifold = new b2Manifold();
      this.m_oldManifold = new b2Manifold();
   };
   b2Contact.prototype.GetManifold = function () {
      return this.m_manifold;
   }
   b2Contact.prototype.GetWorldManifold = function (worldManifold) {
      var bodyA = this.m_fixtureA.GetBody();
      var bodyB = this.m_fixtureB.GetBody();
      var shapeA = this.m_fixtureA.GetShape();
      var shapeB = this.m_fixtureB.GetShape();
      worldManifold.Initialize(this.m_manifold, bodyA.GetTransform(), shapeA.m_radius, bodyB.GetTransform(), shapeB.m_radius);
   }
   b2Contact.prototype.IsTouching = function () {
      return (this.m_flags & b2Contact.e_touchingFlag) == b2Contact.e_touchingFlag;
   }
   b2Contact.prototype.IsContinuous = function () {
      return (this.m_flags & b2Contact.e_continuousFlag) == b2Contact.e_continuousFlag;
   }
   b2Contact.prototype.SetSensor = function (sensor) {
      if (sensor) {
         this.m_flags |= b2Contact.e_sensorFlag;
      }
      else {
         this.m_flags &= ~b2Contact.e_sensorFlag;
      }
   }
   b2Contact.prototype.IsSensor = function () {
      return (this.m_flags & b2Contact.e_sensorFlag) == b2Contact.e_sensorFlag;
   }
   b2Contact.prototype.SetEnabled = function (flag) {
      if (flag) {
         this.m_flags |= b2Contact.e_enabledFlag;
      }
      else {
         this.m_flags &= ~b2Contact.e_enabledFlag;
      }
   }
   b2Contact.prototype.IsEnabled = function () {
      return (this.m_flags & b2Contact.e_enabledFlag) == b2Contact.e_enabledFlag;
   }
   b2Contact.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Contact.prototype.GetFixtureA = function () {
      return this.m_fixtureA;
   }
   b2Contact.prototype.GetFixtureB = function () {
      return this.m_fixtureB;
   }
   b2Contact.prototype.FlagForFiltering = function () {
      this.m_flags |= b2Contact.e_filterFlag;
   }
   b2Contact.prototype.b2Contact = function () {}
   b2Contact.prototype.Reset = function (fixtureA, fixtureB) {
      if (fixtureA === undefined) fixtureA = null;
      if (fixtureB === undefined) fixtureB = null;
      this.m_flags = b2Contact.e_enabledFlag;
      if (!fixtureA || !fixtureB) {
         this.m_fixtureA = null;
         this.m_fixtureB = null;
         return;
      }
      if (fixtureA.IsSensor() || fixtureB.IsSensor()) {
         this.m_flags |= b2Contact.e_sensorFlag;
      }
      var bodyA = fixtureA.GetBody();
      var bodyB = fixtureB.GetBody();
      if (bodyA.GetType() != b2Body.b2_dynamicBody || bodyA.IsBullet() || bodyB.GetType() != b2Body.b2_dynamicBody || bodyB.IsBullet()) {
         this.m_flags |= b2Contact.e_continuousFlag;
      }
      this.m_fixtureA = fixtureA;
      this.m_fixtureB = fixtureB;
      this.m_manifold.m_pointCount = 0;
      this.m_prev = null;
      this.m_next = null;
      this.m_nodeA.contact = null;
      this.m_nodeA.prev = null;
      this.m_nodeA.next = null;
      this.m_nodeA.other = null;
      this.m_nodeB.contact = null;
      this.m_nodeB.prev = null;
      this.m_nodeB.next = null;
      this.m_nodeB.other = null;
   }
   b2Contact.prototype.Update = function (listener) {
      var tManifold = this.m_oldManifold;
      this.m_oldManifold = this.m_manifold;
      this.m_manifold = tManifold;
      this.m_flags |= b2Contact.e_enabledFlag;
      var touching = false;
      var wasTouching = (this.m_flags & b2Contact.e_touchingFlag) == b2Contact.e_touchingFlag;
      var bodyA = this.m_fixtureA.m_body;
      var bodyB = this.m_fixtureB.m_body;
      var aabbOverlap = this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);
      if (this.m_flags & b2Contact.e_sensorFlag) {
         if (aabbOverlap) {
            var shapeA = this.m_fixtureA.GetShape();
            var shapeB = this.m_fixtureB.GetShape();
            var xfA = bodyA.GetTransform();
            var xfB = bodyB.GetTransform();
            touching = b2Shape.TestOverlap(shapeA, xfA, shapeB, xfB);
         }
         this.m_manifold.m_pointCount = 0;
      }
      else {
         if (bodyA.GetType() != b2Body.b2_dynamicBody || bodyA.IsBullet() || bodyB.GetType() != b2Body.b2_dynamicBody || bodyB.IsBullet()) {
            this.m_flags |= b2Contact.e_continuousFlag;
         }
         else {
            this.m_flags &= ~b2Contact.e_continuousFlag;
         }
         if (aabbOverlap) {
            this.Evaluate();
            touching = this.m_manifold.m_pointCount > 0;
            for (var i = 0; i < this.m_manifold.m_pointCount; ++i) {
               var mp2 = this.m_manifold.m_points[i];
               mp2.m_normalImpulse = 0.0;
               mp2.m_tangentImpulse = 0.0;
               var id2 = mp2.m_id;
               for (var j = 0; j < this.m_oldManifold.m_pointCount; ++j) {
                  var mp1 = this.m_oldManifold.m_points[j];
                  if (mp1.m_id.key == id2.key) {
                     mp2.m_normalImpulse = mp1.m_normalImpulse;
                     mp2.m_tangentImpulse = mp1.m_tangentImpulse;
                     break;
                  }
               }
            }
         }
         else {
            this.m_manifold.m_pointCount = 0;
         }
         if (touching != wasTouching) {
            bodyA.SetAwake(true);
            bodyB.SetAwake(true);
         }
      }
      if (touching) {
         this.m_flags |= b2Contact.e_touchingFlag;
      }
      else {
         this.m_flags &= ~b2Contact.e_touchingFlag;
      }
      if (wasTouching == false && touching == true) {
         listener.BeginContact(this);
      }
      if (wasTouching == true && touching == false) {
         listener.EndContact(this);
      }
      if ((this.m_flags & b2Contact.e_sensorFlag) == 0) {
         listener.PreSolve(this, this.m_oldManifold);
      }
   }
   b2Contact.prototype.Evaluate = function () {}
   b2Contact.prototype.ComputeTOI = function (sweepA, sweepB) {
      b2Contact.s_input.proxyA.Set(this.m_fixtureA.GetShape());
      b2Contact.s_input.proxyB.Set(this.m_fixtureB.GetShape());
      b2Contact.s_input.sweepA = sweepA;
      b2Contact.s_input.sweepB = sweepB;
      b2Contact.s_input.tolerance = b2Settings.b2_linearSlop;
      return b2TimeOfImpact.TimeOfImpact(b2Contact.s_input);
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag = 0x0001;
      Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag = 0x0002;
      Box2D.Dynamics.Contacts.b2Contact.e_islandFlag = 0x0004;
      Box2D.Dynamics.Contacts.b2Contact.e_toiFlag = 0x0008;
      Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag = 0x0010;
      Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag = 0x0020;
      Box2D.Dynamics.Contacts.b2Contact.e_filterFlag = 0x0040;
      Box2D.Dynamics.Contacts.b2Contact.s_input = new b2TOIInput();
   });
   b2ContactConstraint.b2ContactConstraint = function () {
      this.localPlaneNormal = new b2Vec2();
      this.localPoint = new b2Vec2();
      this.normal = new b2Vec2();
      this.normalMass = new b2Mat22();
      this.K = new b2Mat22();
   };
   b2ContactConstraint.prototype.b2ContactConstraint = function () {
      this.points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.points[i] = new b2ContactConstraintPoint();
      }
   }
   b2ContactConstraintPoint.b2ContactConstraintPoint = function () {
      this.localPoint = new b2Vec2();
      this.rA = new b2Vec2();
      this.rB = new b2Vec2();
   };
   b2ContactEdge.b2ContactEdge = function () {};
   b2ContactFactory.b2ContactFactory = function () {};
   b2ContactFactory.prototype.b2ContactFactory = function (allocator) {
      this.m_allocator = allocator;
      this.InitializeRegisters();
   }
   b2ContactFactory.prototype.AddType = function (createFcn, destroyFcn, type1, type2) {
      if (type1 === undefined) type1 = 0;
      if (type2 === undefined) type2 = 0;
      this.m_registers[type1][type2].createFcn = createFcn;
      this.m_registers[type1][type2].destroyFcn = destroyFcn;
      this.m_registers[type1][type2].primary = true;
      if (type1 != type2) {
         this.m_registers[type2][type1].createFcn = createFcn;
         this.m_registers[type2][type1].destroyFcn = destroyFcn;
         this.m_registers[type2][type1].primary = false;
      }
   }
   b2ContactFactory.prototype.InitializeRegisters = function () {
      this.m_registers = new Vector(b2Shape.e_shapeTypeCount);
      for (var i = 0; i < b2Shape.e_shapeTypeCount; i++) {
         this.m_registers[i] = new Vector(b2Shape.e_shapeTypeCount);
         for (var j = 0; j < b2Shape.e_shapeTypeCount; j++) {
            this.m_registers[i][j] = new b2ContactRegister();
         }
      }
      this.AddType(b2CircleContact.Create, b2CircleContact.Destroy, b2Shape.e_circleShape, b2Shape.e_circleShape);
      this.AddType(b2PolyAndCircleContact.Create, b2PolyAndCircleContact.Destroy, b2Shape.e_polygonShape, b2Shape.e_circleShape);
      this.AddType(b2PolygonContact.Create, b2PolygonContact.Destroy, b2Shape.e_polygonShape, b2Shape.e_polygonShape);
      this.AddType(b2EdgeAndCircleContact.Create, b2EdgeAndCircleContact.Destroy, b2Shape.e_edgeShape, b2Shape.e_circleShape);
      this.AddType(b2PolyAndEdgeContact.Create, b2PolyAndEdgeContact.Destroy, b2Shape.e_polygonShape, b2Shape.e_edgeShape);
   }
   b2ContactFactory.prototype.Create = function (fixtureA, fixtureB) {
      var type1 = parseInt(fixtureA.GetType());
      var type2 = parseInt(fixtureB.GetType());
      var reg = this.m_registers[type1][type2];
      var c;
      if (reg.pool) {
         c = reg.pool;
         reg.pool = c.m_next;
         reg.poolCount--;
         c.Reset(fixtureA, fixtureB);
         return c;
      }
      var createFcn = reg.createFcn;
      if (createFcn != null) {
         if (reg.primary) {
            c = createFcn(this.m_allocator);
            c.Reset(fixtureA, fixtureB);
            return c;
         }
         else {
            c = createFcn(this.m_allocator);
            c.Reset(fixtureB, fixtureA);
            return c;
         }
      }
      else {
         return null;
      }
   }
   b2ContactFactory.prototype.Destroy = function (contact) {
      if (contact.m_manifold.m_pointCount > 0) {
         contact.m_fixtureA.m_body.SetAwake(true);
         contact.m_fixtureB.m_body.SetAwake(true);
      }
      var type1 = parseInt(contact.m_fixtureA.GetType());
      var type2 = parseInt(contact.m_fixtureB.GetType());
      var reg = this.m_registers[type1][type2];
      if (true) {
         reg.poolCount++;
         contact.m_next = reg.pool;
         reg.pool = contact;
      }
      var destroyFcn = reg.destroyFcn;
      destroyFcn(contact, this.m_allocator);
   }
   b2ContactRegister.b2ContactRegister = function () {};
   b2ContactResult.b2ContactResult = function () {
      this.position = new b2Vec2();
      this.normal = new b2Vec2();
      this.id = new b2ContactID();
   };
   b2ContactSolver.b2ContactSolver = function () {
      this.m_step = new b2TimeStep();
      this.m_constraints = new Vector();
   };
   b2ContactSolver.prototype.b2ContactSolver = function () {}
   b2ContactSolver.prototype.Initialize = function (step, contacts, contactCount, allocator) {
      if (contactCount === undefined) contactCount = 0;
      var contact;
      this.m_step.Set(step);
      this.m_allocator = allocator;
      var i = 0;
      var tVec;
      var tMat;
      this.m_constraintCount = contactCount;
      while (this.m_constraints.length < this.m_constraintCount) {
         this.m_constraints[this.m_constraints.length] = new b2ContactConstraint();
      }
      for (i = 0;
      i < contactCount; ++i) {
         contact = contacts[i];
         var fixtureA = contact.m_fixtureA;
         var fixtureB = contact.m_fixtureB;
         var shapeA = fixtureA.m_shape;
         var shapeB = fixtureB.m_shape;
         var radiusA = shapeA.m_radius;
         var radiusB = shapeB.m_radius;
         var bodyA = fixtureA.m_body;
         var bodyB = fixtureB.m_body;
         var manifold = contact.GetManifold();
         var friction = b2Settings.b2MixFriction(fixtureA.GetFriction(), fixtureB.GetFriction());
         var restitution = b2Settings.b2MixRestitution(fixtureA.GetRestitution(), fixtureB.GetRestitution());
         var vAX = bodyA.m_linearVelocity.x;
         var vAY = bodyA.m_linearVelocity.y;
         var vBX = bodyB.m_linearVelocity.x;
         var vBY = bodyB.m_linearVelocity.y;
         var wA = bodyA.m_angularVelocity;
         var wB = bodyB.m_angularVelocity;
         b2Settings.b2Assert(manifold.m_pointCount > 0);
         b2ContactSolver.s_worldManifold.Initialize(manifold, bodyA.m_xf, radiusA, bodyB.m_xf, radiusB);
         var normalX = b2ContactSolver.s_worldManifold.m_normal.x;
         var normalY = b2ContactSolver.s_worldManifold.m_normal.y;
         var cc = this.m_constraints[i];
         cc.bodyA = bodyA;
         cc.bodyB = bodyB;
         cc.manifold = manifold;
         cc.normal.x = normalX;
         cc.normal.y = normalY;
         cc.pointCount = manifold.m_pointCount;
         cc.friction = friction;
         cc.restitution = restitution;
         cc.localPlaneNormal.x = manifold.m_localPlaneNormal.x;
         cc.localPlaneNormal.y = manifold.m_localPlaneNormal.y;
         cc.localPoint.x = manifold.m_localPoint.x;
         cc.localPoint.y = manifold.m_localPoint.y;
         cc.radius = radiusA + radiusB;
         cc.type = manifold.m_type;
         for (var k = 0; k < cc.pointCount; ++k) {
            var cp = manifold.m_points[k];
            var ccp = cc.points[k];
            ccp.normalImpulse = cp.m_normalImpulse;
            ccp.tangentImpulse = cp.m_tangentImpulse;
            ccp.localPoint.SetV(cp.m_localPoint);
            var rAX = ccp.rA.x = b2ContactSolver.s_worldManifold.m_points[k].x - bodyA.m_sweep.c.x;
            var rAY = ccp.rA.y = b2ContactSolver.s_worldManifold.m_points[k].y - bodyA.m_sweep.c.y;
            var rBX = ccp.rB.x = b2ContactSolver.s_worldManifold.m_points[k].x - bodyB.m_sweep.c.x;
            var rBY = ccp.rB.y = b2ContactSolver.s_worldManifold.m_points[k].y - bodyB.m_sweep.c.y;
            var rnA = rAX * normalY - rAY * normalX;
            var rnB = rBX * normalY - rBY * normalX;
            rnA *= rnA;
            rnB *= rnB;
            var kNormal = bodyA.m_invMass + bodyB.m_invMass + bodyA.m_invI * rnA + bodyB.m_invI * rnB;
            ccp.normalMass = 1.0 / kNormal;
            var kEqualized = bodyA.m_mass * bodyA.m_invMass + bodyB.m_mass * bodyB.m_invMass;
            kEqualized += bodyA.m_mass * bodyA.m_invI * rnA + bodyB.m_mass * bodyB.m_invI * rnB;
            ccp.equalizedMass = 1.0 / kEqualized;
            var tangentX = normalY;
            var tangentY = (-normalX);
            var rtA = rAX * tangentY - rAY * tangentX;
            var rtB = rBX * tangentY - rBY * tangentX;
            rtA *= rtA;
            rtB *= rtB;
            var kTangent = bodyA.m_invMass + bodyB.m_invMass + bodyA.m_invI * rtA + bodyB.m_invI * rtB;
            ccp.tangentMass = 1.0 / kTangent;
            ccp.velocityBias = 0.0;
            var tX = vBX + ((-wB * rBY)) - vAX - ((-wA * rAY));
            var tY = vBY + (wB * rBX) - vAY - (wA * rAX);
            var vRel = cc.normal.x * tX + cc.normal.y * tY;
            if (vRel < (-b2Settings.b2_velocityThreshold)) {
               ccp.velocityBias += (-cc.restitution * vRel);
            }
         }
         if (cc.pointCount == 2) {
            var ccp1 = cc.points[0];
            var ccp2 = cc.points[1];
            var invMassA = bodyA.m_invMass;
            var invIA = bodyA.m_invI;
            var invMassB = bodyB.m_invMass;
            var invIB = bodyB.m_invI;
            var rn1A = ccp1.rA.x * normalY - ccp1.rA.y * normalX;
            var rn1B = ccp1.rB.x * normalY - ccp1.rB.y * normalX;
            var rn2A = ccp2.rA.x * normalY - ccp2.rA.y * normalX;
            var rn2B = ccp2.rB.x * normalY - ccp2.rB.y * normalX;
            var k11 = invMassA + invMassB + invIA * rn1A * rn1A + invIB * rn1B * rn1B;
            var k22 = invMassA + invMassB + invIA * rn2A * rn2A + invIB * rn2B * rn2B;
            var k12 = invMassA + invMassB + invIA * rn1A * rn2A + invIB * rn1B * rn2B;
            var k_maxConditionNumber = 100.0;
            if (k11 * k11 < k_maxConditionNumber * (k11 * k22 - k12 * k12)) {
               cc.K.col1.Set(k11, k12);
               cc.K.col2.Set(k12, k22);
               cc.K.GetInverse(cc.normalMass);
            }
            else {
               cc.pointCount = 1;
            }
         }
      }
   }
   b2ContactSolver.prototype.InitVelocityConstraints = function (step) {
      var tVec;
      var tVec2;
      var tMat;
      for (var i = 0; i < this.m_constraintCount; ++i) {
         var c = this.m_constraints[i];
         var bodyA = c.bodyA;
         var bodyB = c.bodyB;
         var invMassA = bodyA.m_invMass;
         var invIA = bodyA.m_invI;
         var invMassB = bodyB.m_invMass;
         var invIB = bodyB.m_invI;
         var normalX = c.normal.x;
         var normalY = c.normal.y;
         var tangentX = normalY;
         var tangentY = (-normalX);
         var tX = 0;
         var j = 0;
         var tCount = 0;
         if (step.warmStarting) {
            tCount = c.pointCount;
            for (j = 0;
            j < tCount; ++j) {
               var ccp = c.points[j];
               ccp.normalImpulse *= step.dtRatio;
               ccp.tangentImpulse *= step.dtRatio;
               var PX = ccp.normalImpulse * normalX + ccp.tangentImpulse * tangentX;
               var PY = ccp.normalImpulse * normalY + ccp.tangentImpulse * tangentY;
               bodyA.m_angularVelocity -= invIA * (ccp.rA.x * PY - ccp.rA.y * PX);
               bodyA.m_linearVelocity.x -= invMassA * PX;
               bodyA.m_linearVelocity.y -= invMassA * PY;
               bodyB.m_angularVelocity += invIB * (ccp.rB.x * PY - ccp.rB.y * PX);
               bodyB.m_linearVelocity.x += invMassB * PX;
               bodyB.m_linearVelocity.y += invMassB * PY;
            }
         }
         else {
            tCount = c.pointCount;
            for (j = 0;
            j < tCount; ++j) {
               var ccp2 = c.points[j];
               ccp2.normalImpulse = 0.0;
               ccp2.tangentImpulse = 0.0;
            }
         }
      }
   }
   b2ContactSolver.prototype.SolveVelocityConstraints = function () {
      var j = 0;
      var ccp;
      var rAX = 0;
      var rAY = 0;
      var rBX = 0;
      var rBY = 0;
      var dvX = 0;
      var dvY = 0;
      var vn = 0;
      var vt = 0;
      var lambda = 0;
      var maxFriction = 0;
      var newImpulse = 0;
      var PX = 0;
      var PY = 0;
      var dX = 0;
      var dY = 0;
      var P1X = 0;
      var P1Y = 0;
      var P2X = 0;
      var P2Y = 0;
      var tMat;
      var tVec;
      for (var i = 0; i < this.m_constraintCount; ++i) {
         var c = this.m_constraints[i];
         var bodyA = c.bodyA;
         var bodyB = c.bodyB;
         var wA = bodyA.m_angularVelocity;
         var wB = bodyB.m_angularVelocity;
         var vA = bodyA.m_linearVelocity;
         var vB = bodyB.m_linearVelocity;
         var invMassA = bodyA.m_invMass;
         var invIA = bodyA.m_invI;
         var invMassB = bodyB.m_invMass;
         var invIB = bodyB.m_invI;
         var normalX = c.normal.x;
         var normalY = c.normal.y;
         var tangentX = normalY;
         var tangentY = (-normalX);
         var friction = c.friction;
         var tX = 0;
         for (j = 0;
         j < c.pointCount; j++) {
            ccp = c.points[j];
            dvX = vB.x - wB * ccp.rB.y - vA.x + wA * ccp.rA.y;
            dvY = vB.y + wB * ccp.rB.x - vA.y - wA * ccp.rA.x;
            vt = dvX * tangentX + dvY * tangentY;
            lambda = ccp.tangentMass * (-vt);
            maxFriction = friction * ccp.normalImpulse;
            newImpulse = b2Math.Clamp(ccp.tangentImpulse + lambda, (-maxFriction), maxFriction);
            lambda = newImpulse - ccp.tangentImpulse;
            PX = lambda * tangentX;
            PY = lambda * tangentY;
            vA.x -= invMassA * PX;
            vA.y -= invMassA * PY;
            wA -= invIA * (ccp.rA.x * PY - ccp.rA.y * PX);
            vB.x += invMassB * PX;
            vB.y += invMassB * PY;
            wB += invIB * (ccp.rB.x * PY - ccp.rB.y * PX);
            ccp.tangentImpulse = newImpulse;
         }
         var tCount = parseInt(c.pointCount);
         if (c.pointCount == 1) {
            ccp = c.points[0];
            dvX = vB.x + ((-wB * ccp.rB.y)) - vA.x - ((-wA * ccp.rA.y));
            dvY = vB.y + (wB * ccp.rB.x) - vA.y - (wA * ccp.rA.x);
            vn = dvX * normalX + dvY * normalY;
            lambda = (-ccp.normalMass * (vn - ccp.velocityBias));
            newImpulse = ccp.normalImpulse + lambda;
            newImpulse = newImpulse > 0 ? newImpulse : 0.0;
            lambda = newImpulse - ccp.normalImpulse;
            PX = lambda * normalX;
            PY = lambda * normalY;
            vA.x -= invMassA * PX;
            vA.y -= invMassA * PY;
            wA -= invIA * (ccp.rA.x * PY - ccp.rA.y * PX);
            vB.x += invMassB * PX;
            vB.y += invMassB * PY;
            wB += invIB * (ccp.rB.x * PY - ccp.rB.y * PX);
            ccp.normalImpulse = newImpulse;
         }
         else {
            var cp1 = c.points[0];
            var cp2 = c.points[1];
            var aX = cp1.normalImpulse;
            var aY = cp2.normalImpulse;
            var dv1X = vB.x - wB * cp1.rB.y - vA.x + wA * cp1.rA.y;
            var dv1Y = vB.y + wB * cp1.rB.x - vA.y - wA * cp1.rA.x;
            var dv2X = vB.x - wB * cp2.rB.y - vA.x + wA * cp2.rA.y;
            var dv2Y = vB.y + wB * cp2.rB.x - vA.y - wA * cp2.rA.x;
            var vn1 = dv1X * normalX + dv1Y * normalY;
            var vn2 = dv2X * normalX + dv2Y * normalY;
            var bX = vn1 - cp1.velocityBias;
            var bY = vn2 - cp2.velocityBias;
            tMat = c.K;
            bX -= tMat.col1.x * aX + tMat.col2.x * aY;
            bY -= tMat.col1.y * aX + tMat.col2.y * aY;
            var k_errorTol = 0.001;
            for (;;) {
               tMat = c.normalMass;
               var xX = (-(tMat.col1.x * bX + tMat.col2.x * bY));
               var xY = (-(tMat.col1.y * bX + tMat.col2.y * bY));
               if (xX >= 0.0 && xY >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               xX = (-cp1.normalMass * bX);
               xY = 0.0;
               vn1 = 0.0;
               vn2 = c.K.col1.y * xX + bY;
               if (xX >= 0.0 && vn2 >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               xX = 0.0;
               xY = (-cp2.normalMass * bY);
               vn1 = c.K.col2.x * xY + bX;
               vn2 = 0.0;
               if (xY >= 0.0 && vn1 >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               xX = 0.0;
               xY = 0.0;
               vn1 = bX;
               vn2 = bY;
               if (vn1 >= 0.0 && vn2 >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               break;
            }
         }
         bodyA.m_angularVelocity = wA;
         bodyB.m_angularVelocity = wB;
      }
   }
   b2ContactSolver.prototype.FinalizeVelocityConstraints = function () {
      for (var i = 0; i < this.m_constraintCount; ++i) {
         var c = this.m_constraints[i];
         var m = c.manifold;
         for (var j = 0; j < c.pointCount; ++j) {
            var point1 = m.m_points[j];
            var point2 = c.points[j];
            point1.m_normalImpulse = point2.normalImpulse;
            point1.m_tangentImpulse = point2.tangentImpulse;
         }
      }
   }
   b2ContactSolver.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var minSeparation = 0.0;
      for (var i = 0; i < this.m_constraintCount; i++) {
         var c = this.m_constraints[i];
         var bodyA = c.bodyA;
         var bodyB = c.bodyB;
         var invMassA = bodyA.m_mass * bodyA.m_invMass;
         var invIA = bodyA.m_mass * bodyA.m_invI;
         var invMassB = bodyB.m_mass * bodyB.m_invMass;
         var invIB = bodyB.m_mass * bodyB.m_invI;
         b2ContactSolver.s_psm.Initialize(c);
         var normal = b2ContactSolver.s_psm.m_normal;
         for (var j = 0; j < c.pointCount; j++) {
            var ccp = c.points[j];
            var point = b2ContactSolver.s_psm.m_points[j];
            var separation = b2ContactSolver.s_psm.m_separations[j];
            var rAX = point.x - bodyA.m_sweep.c.x;
            var rAY = point.y - bodyA.m_sweep.c.y;
            var rBX = point.x - bodyB.m_sweep.c.x;
            var rBY = point.y - bodyB.m_sweep.c.y;
            minSeparation = minSeparation < separation ? minSeparation : separation;
            var C = b2Math.Clamp(baumgarte * (separation + b2Settings.b2_linearSlop), (-b2Settings.b2_maxLinearCorrection), 0.0);
            var impulse = (-ccp.equalizedMass * C);
            var PX = impulse * normal.x;
            var PY = impulse * normal.y;bodyA.m_sweep.c.x -= invMassA * PX;
            bodyA.m_sweep.c.y -= invMassA * PY;
            bodyA.m_sweep.a -= invIA * (rAX * PY - rAY * PX);
            bodyA.SynchronizeTransform();
            bodyB.m_sweep.c.x += invMassB * PX;
            bodyB.m_sweep.c.y += invMassB * PY;
            bodyB.m_sweep.a += invIB * (rBX * PY - rBY * PX);
            bodyB.SynchronizeTransform();
         }
      }
      return minSeparation > (-1.5 * b2Settings.b2_linearSlop);
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold = new b2WorldManifold();
      Box2D.Dynamics.Contacts.b2ContactSolver.s_psm = new b2PositionSolverManifold();
   });
   Box2D.inherit(b2EdgeAndCircleContact, Box2D.Dynamics.Contacts.b2Contact);
   b2EdgeAndCircleContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2EdgeAndCircleContact.b2EdgeAndCircleContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2EdgeAndCircleContact.Create = function (allocator) {
      return new b2EdgeAndCircleContact();
   }
   b2EdgeAndCircleContact.Destroy = function (contact, allocator) {}
   b2EdgeAndCircleContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
   }
   b2EdgeAndCircleContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      this.b2CollideEdgeAndCircle(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2EdgeShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2CircleShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2EdgeAndCircleContact.prototype.b2CollideEdgeAndCircle = function (manifold, edge, xf1, circle, xf2) {}
   Box2D.inherit(b2NullContact, Box2D.Dynamics.Contacts.b2Contact);
   b2NullContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2NullContact.b2NullContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2NullContact.prototype.b2NullContact = function () {
      this.__super.b2Contact.call(this);
   }
   b2NullContact.prototype.Evaluate = function () {}
   Box2D.inherit(b2PolyAndCircleContact, Box2D.Dynamics.Contacts.b2Contact);
   b2PolyAndCircleContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2PolyAndCircleContact.b2PolyAndCircleContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2PolyAndCircleContact.Create = function (allocator) {
      return new b2PolyAndCircleContact();
   }
   b2PolyAndCircleContact.Destroy = function (contact, allocator) {}
   b2PolyAndCircleContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
      b2Settings.b2Assert(fixtureA.GetType() == b2Shape.e_polygonShape);
      b2Settings.b2Assert(fixtureB.GetType() == b2Shape.e_circleShape);
   }
   b2PolyAndCircleContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.m_body;
      var bB = this.m_fixtureB.m_body;
      b2Collision.CollidePolygonAndCircle(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2PolygonShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2CircleShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   Box2D.inherit(b2PolyAndEdgeContact, Box2D.Dynamics.Contacts.b2Contact);
   b2PolyAndEdgeContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2PolyAndEdgeContact.b2PolyAndEdgeContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2PolyAndEdgeContact.Create = function (allocator) {
      return new b2PolyAndEdgeContact();
   }
   b2PolyAndEdgeContact.Destroy = function (contact, allocator) {}
   b2PolyAndEdgeContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
      b2Settings.b2Assert(fixtureA.GetType() == b2Shape.e_polygonShape);
      b2Settings.b2Assert(fixtureB.GetType() == b2Shape.e_edgeShape);
   }
   b2PolyAndEdgeContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      this.b2CollidePolyAndEdge(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2PolygonShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2EdgeShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2PolyAndEdgeContact.prototype.b2CollidePolyAndEdge = function (manifold, polygon, xf1, edge, xf2) {}
   Box2D.inherit(b2PolygonContact, Box2D.Dynamics.Contacts.b2Contact);
   b2PolygonContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2PolygonContact.b2PolygonContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2PolygonContact.Create = function (allocator) {
      return new b2PolygonContact();
   }
   b2PolygonContact.Destroy = function (contact, allocator) {}
   b2PolygonContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
   }
   b2PolygonContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      b2Collision.CollidePolygons(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2PolygonShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2PolygonShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2PositionSolverManifold.b2PositionSolverManifold = function () {};
   b2PositionSolverManifold.prototype.b2PositionSolverManifold = function () {
      this.m_normal = new b2Vec2();
      this.m_separations = new Vector_a2j_Number(b2Settings.b2_maxManifoldPoints);
      this.m_points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.m_points[i] = new b2Vec2();
      }
   }
   b2PositionSolverManifold.prototype.Initialize = function (cc) {
      b2Settings.b2Assert(cc.pointCount > 0);
      var i = 0;
      var clipPointX = 0;
      var clipPointY = 0;
      var tMat;
      var tVec;
      var planePointX = 0;
      var planePointY = 0;
      switch (cc.type) {
      case b2Manifold.e_circles:
         {
            tMat = cc.bodyA.m_xf.R;
            tVec = cc.localPoint;
            var pointAX = cc.bodyA.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            var pointAY = cc.bodyA.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tMat = cc.bodyB.m_xf.R;
            tVec = cc.points[0].localPoint;
            var pointBX = cc.bodyB.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            var pointBY = cc.bodyB.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            var dX = pointBX - pointAX;
            var dY = pointBY - pointAY;
            var d2 = dX * dX + dY * dY;
            if (d2 > Number.MIN_VALUE * Number.MIN_VALUE) {
               var d = Math.sqrt(d2);
               this.m_normal.x = dX / d;
               this.m_normal.y = dY / d;
            }
            else {
               this.m_normal.x = 1.0;
               this.m_normal.y = 0.0;
            }
            this.m_points[0].x = 0.5 * (pointAX + pointBX);
            this.m_points[0].y = 0.5 * (pointAY + pointBY);
            this.m_separations[0] = dX * this.m_normal.x + dY * this.m_normal.y - cc.radius;
         }
         break;
      case b2Manifold.e_faceA:
         {
            tMat = cc.bodyA.m_xf.R;
            tVec = cc.localPlaneNormal;
            this.m_normal.x = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            this.m_normal.y = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = cc.bodyA.m_xf.R;
            tVec = cc.localPoint;
            planePointX = cc.bodyA.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            planePointY = cc.bodyA.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tMat = cc.bodyB.m_xf.R;
            for (i = 0;
            i < cc.pointCount; ++i) {
               tVec = cc.points[i].localPoint;
               clipPointX = cc.bodyB.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
               clipPointY = cc.bodyB.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
               this.m_separations[i] = (clipPointX - planePointX) * this.m_normal.x + (clipPointY - planePointY) * this.m_normal.y - cc.radius;
               this.m_points[i].x = clipPointX;
               this.m_points[i].y = clipPointY;
            }
         }
         break;
      case b2Manifold.e_faceB:
         {
            tMat = cc.bodyB.m_xf.R;
            tVec = cc.localPlaneNormal;
            this.m_normal.x = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            this.m_normal.y = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = cc.bodyB.m_xf.R;
            tVec = cc.localPoint;
            planePointX = cc.bodyB.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            planePointY = cc.bodyB.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tMat = cc.bodyA.m_xf.R;
            for (i = 0;
            i < cc.pointCount; ++i) {
               tVec = cc.points[i].localPoint;
               clipPointX = cc.bodyA.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
               clipPointY = cc.bodyA.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
               this.m_separations[i] = (clipPointX - planePointX) * this.m_normal.x + (clipPointY - planePointY) * this.m_normal.y - cc.radius;
               this.m_points[i].Set(clipPointX, clipPointY);
            }
            this.m_normal.x *= (-1);
            this.m_normal.y *= (-1);
         }
         break;
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA = new b2Vec2();
      Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB = new b2Vec2();
   });
})();
(function () {
   var b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2BuoyancyController = Box2D.Dynamics.Controllers.b2BuoyancyController,
      b2ConstantAccelController = Box2D.Dynamics.Controllers.b2ConstantAccelController,
      b2ConstantForceController = Box2D.Dynamics.Controllers.b2ConstantForceController,
      b2Controller = Box2D.Dynamics.Controllers.b2Controller,
      b2ControllerEdge = Box2D.Dynamics.Controllers.b2ControllerEdge,
      b2GravityController = Box2D.Dynamics.Controllers.b2GravityController,
      b2TensorDampingController = Box2D.Dynamics.Controllers.b2TensorDampingController;

   Box2D.inherit(b2BuoyancyController, Box2D.Dynamics.Controllers.b2Controller);
   b2BuoyancyController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2BuoyancyController.b2BuoyancyController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.normal = new b2Vec2(0, (-1));
      this.offset = 0;
      this.density = 0;
      this.velocity = new b2Vec2(0, 0);
      this.linearDrag = 2;
      this.angularDrag = 1;
      this.useDensity = false;
      this.useWorldGravity = true;
      this.gravity = null;
   };
   b2BuoyancyController.prototype.Step = function (step) {
      if (!this.m_bodyList) return;
      if (this.useWorldGravity) {
         this.gravity = this.GetWorld().GetGravity().Copy();
      }
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (body.IsAwake() == false) {
            continue;
         }
         var areac = new b2Vec2();
         var massc = new b2Vec2();
         var area = 0.0;
         var mass = 0.0;
         for (var fixture = body.GetFixtureList(); fixture; fixture = fixture.GetNext()) {
            var sc = new b2Vec2();
            var sarea = fixture.GetShape().ComputeSubmergedArea(this.normal, this.offset, body.GetTransform(), sc);
            area += sarea;
            areac.x += sarea * sc.x;
            areac.y += sarea * sc.y;
            var shapeDensity = 0;
            if (this.useDensity) {
               shapeDensity = 1;
            }
            else {
               shapeDensity = 1;
            }
            mass += sarea * shapeDensity;
            massc.x += sarea * sc.x * shapeDensity;
            massc.y += sarea * sc.y * shapeDensity;
         }
         areac.x /= area;
         areac.y /= area;
         massc.x /= mass;
         massc.y /= mass;
         if (area < Number.MIN_VALUE) continue;
         var buoyancyForce = this.gravity.GetNegative();
         buoyancyForce.Multiply(this.density * area);
         body.ApplyForce(buoyancyForce, massc);
         var dragForce = body.GetLinearVelocityFromWorldPoint(areac);
         dragForce.Subtract(this.velocity);
         dragForce.Multiply((-this.linearDrag * area));
         body.ApplyForce(dragForce, areac);
         body.ApplyTorque((-body.GetInertia() / body.GetMass() * area * body.GetAngularVelocity() * this.angularDrag));
      }
   }
   b2BuoyancyController.prototype.Draw = function (debugDraw) {
      var r = 1000;
      var p1 = new b2Vec2();
      var p2 = new b2Vec2();
      p1.x = this.normal.x * this.offset + this.normal.y * r;
      p1.y = this.normal.y * this.offset - this.normal.x * r;
      p2.x = this.normal.x * this.offset - this.normal.y * r;
      p2.y = this.normal.y * this.offset + this.normal.x * r;
      var color = new b2Color(0, 0, 1);
      debugDraw.DrawSegment(p1, p2, color);
   }
   Box2D.inherit(b2ConstantAccelController, Box2D.Dynamics.Controllers.b2Controller);
   b2ConstantAccelController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2ConstantAccelController.b2ConstantAccelController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.A = new b2Vec2(0, 0);
   };
   b2ConstantAccelController.prototype.Step = function (step) {
      var smallA = new b2Vec2(this.A.x * step.dt, this.A.y * step.dt);
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (!body.IsAwake()) continue;
         body.SetLinearVelocity(new b2Vec2(body.GetLinearVelocity().x + smallA.x, body.GetLinearVelocity().y + smallA.y));
      }
   }
   Box2D.inherit(b2ConstantForceController, Box2D.Dynamics.Controllers.b2Controller);
   b2ConstantForceController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2ConstantForceController.b2ConstantForceController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.F = new b2Vec2(0, 0);
   };
   b2ConstantForceController.prototype.Step = function (step) {
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (!body.IsAwake()) continue;
         body.ApplyForce(this.F, body.GetWorldCenter());
      }
   }
   b2Controller.b2Controller = function () {};
   b2Controller.prototype.Step = function (step) {}
   b2Controller.prototype.Draw = function (debugDraw) {}
   b2Controller.prototype.AddBody = function (body) {
      var edge = new b2ControllerEdge();
      edge.controller = this;
      edge.body = body;
      edge.nextBody = this.m_bodyList;
      edge.prevBody = null;
      this.m_bodyList = edge;
      if (edge.nextBody) edge.nextBody.prevBody = edge;
      this.m_bodyCount++;
      edge.nextController = body.m_controllerList;
      edge.prevController = null;
      body.m_controllerList = edge;
      if (edge.nextController) edge.nextController.prevController = edge;
      body.m_controllerCount++;
   }
   b2Controller.prototype.RemoveBody = function (body) {
      var edge = body.m_controllerList;
      while (edge && edge.controller != this)
      edge = edge.nextController;
      if (edge.prevBody) edge.prevBody.nextBody = edge.nextBody;
      if (edge.nextBody) edge.nextBody.prevBody = edge.prevBody;
      if (edge.nextController) edge.nextController.prevController = edge.prevController;
      if (edge.prevController) edge.prevController.nextController = edge.nextController;
      if (this.m_bodyList == edge) this.m_bodyList = edge.nextBody;
      if (body.m_controllerList == edge) body.m_controllerList = edge.nextController;
      body.m_controllerCount--;
      this.m_bodyCount--;
   }
   b2Controller.prototype.Clear = function () {
      while (this.m_bodyList)
      this.RemoveBody(this.m_bodyList.body);
   }
   b2Controller.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Controller.prototype.GetWorld = function () {
      return this.m_world;
   }
   b2Controller.prototype.GetBodyList = function () {
      return this.m_bodyList;
   }
   b2ControllerEdge.b2ControllerEdge = function () {};
   Box2D.inherit(b2GravityController, Box2D.Dynamics.Controllers.b2Controller);
   b2GravityController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2GravityController.b2GravityController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.G = 1;
      this.invSqr = true;
   };
   b2GravityController.prototype.Step = function (step) {
      var i = null;
      var body1 = null;
      var p1 = null;
      var mass1 = 0;
      var j = null;
      var body2 = null;
      var p2 = null;
      var dx = 0;
      var dy = 0;
      var r2 = 0;
      var f = null;
      if (this.invSqr) {
         for (i = this.m_bodyList;
         i; i = i.nextBody) {
            body1 = i.body;
            p1 = body1.GetWorldCenter();
            mass1 = body1.GetMass();
            for (j = this.m_bodyList;
            j != i; j = j.nextBody) {
               body2 = j.body;
               p2 = body2.GetWorldCenter();
               dx = p2.x - p1.x;
               dy = p2.y - p1.y;
               r2 = dx * dx + dy * dy;
               if (r2 < Number.MIN_VALUE) continue;
               f = new b2Vec2(dx, dy);
               f.Multiply(this.G / r2 / Math.sqrt(r2) * mass1 * body2.GetMass());
               if (body1.IsAwake()) body1.ApplyForce(f, p1);
               f.Multiply((-1));
               if (body2.IsAwake()) body2.ApplyForce(f, p2);
            }
         }
      }
      else {
         for (i = this.m_bodyList;
         i; i = i.nextBody) {
            body1 = i.body;
            p1 = body1.GetWorldCenter();
            mass1 = body1.GetMass();
            for (j = this.m_bodyList;
            j != i; j = j.nextBody) {
               body2 = j.body;
               p2 = body2.GetWorldCenter();
               dx = p2.x - p1.x;
               dy = p2.y - p1.y;
               r2 = dx * dx + dy * dy;
               if (r2 < Number.MIN_VALUE) continue;
               f = new b2Vec2(dx, dy);
               f.Multiply(this.G / r2 * mass1 * body2.GetMass());
               if (body1.IsAwake()) body1.ApplyForce(f, p1);
               f.Multiply((-1));
               if (body2.IsAwake()) body2.ApplyForce(f, p2);
            }
         }
      }
   }
   Box2D.inherit(b2TensorDampingController, Box2D.Dynamics.Controllers.b2Controller);
   b2TensorDampingController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2TensorDampingController.b2TensorDampingController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.T = new b2Mat22();
      this.maxTimestep = 0;
   };
   b2TensorDampingController.prototype.SetAxisAligned = function (xDamping, yDamping) {
      if (xDamping === undefined) xDamping = 0;
      if (yDamping === undefined) yDamping = 0;
      this.T.col1.x = (-xDamping);
      this.T.col1.y = 0;
      this.T.col2.x = 0;
      this.T.col2.y = (-yDamping);
      if (xDamping > 0 || yDamping > 0) {
         this.maxTimestep = 1 / Math.max(xDamping, yDamping);
      }
      else {
         this.maxTimestep = 0;
      }
   }
   b2TensorDampingController.prototype.Step = function (step) {
      var timestep = step.dt;
      if (timestep <= Number.MIN_VALUE) return;
      if (timestep > this.maxTimestep && this.maxTimestep > 0) timestep = this.maxTimestep;
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (!body.IsAwake()) {
            continue;
         }
         var damping = body.GetWorldVector(b2Math.MulMV(this.T, body.GetLocalVector(body.GetLinearVelocity())));
         body.SetLinearVelocity(new b2Vec2(body.GetLinearVelocity().x + damping.x * timestep, body.GetLinearVelocity().y + damping.y * timestep));
      }
   }
})();
(function () {
   var b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2DistanceJoint = Box2D.Dynamics.Joints.b2DistanceJoint,
      b2DistanceJointDef = Box2D.Dynamics.Joints.b2DistanceJointDef,
      b2FrictionJoint = Box2D.Dynamics.Joints.b2FrictionJoint,
      b2FrictionJointDef = Box2D.Dynamics.Joints.b2FrictionJointDef,
      b2GearJoint = Box2D.Dynamics.Joints.b2GearJoint,
      b2GearJointDef = Box2D.Dynamics.Joints.b2GearJointDef,
      b2Jacobian = Box2D.Dynamics.Joints.b2Jacobian,
      b2Joint = Box2D.Dynamics.Joints.b2Joint,
      b2JointDef = Box2D.Dynamics.Joints.b2JointDef,
      b2JointEdge = Box2D.Dynamics.Joints.b2JointEdge,
      b2LineJoint = Box2D.Dynamics.Joints.b2LineJoint,
      b2LineJointDef = Box2D.Dynamics.Joints.b2LineJointDef,
      b2MouseJoint = Box2D.Dynamics.Joints.b2MouseJoint,
      b2MouseJointDef = Box2D.Dynamics.Joints.b2MouseJointDef,
      b2PrismaticJoint = Box2D.Dynamics.Joints.b2PrismaticJoint,
      b2PrismaticJointDef = Box2D.Dynamics.Joints.b2PrismaticJointDef,
      b2PulleyJoint = Box2D.Dynamics.Joints.b2PulleyJoint,
      b2PulleyJointDef = Box2D.Dynamics.Joints.b2PulleyJointDef,
      b2RevoluteJoint = Box2D.Dynamics.Joints.b2RevoluteJoint,
      b2RevoluteJointDef = Box2D.Dynamics.Joints.b2RevoluteJointDef,
      b2WeldJoint = Box2D.Dynamics.Joints.b2WeldJoint,
      b2WeldJointDef = Box2D.Dynamics.Joints.b2WeldJointDef,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World;

   Box2D.inherit(b2DistanceJoint, Box2D.Dynamics.Joints.b2Joint);
   b2DistanceJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2DistanceJoint.b2DistanceJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_u = new b2Vec2();
   };
   b2DistanceJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2DistanceJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2DistanceJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse * this.m_u.x, inv_dt * this.m_impulse * this.m_u.y);
   }
   b2DistanceJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2DistanceJoint.prototype.GetLength = function () {
      return this.m_length;
   }
   b2DistanceJoint.prototype.SetLength = function (length) {
      if (length === undefined) length = 0;
      this.m_length = length;
   }
   b2DistanceJoint.prototype.GetFrequency = function () {
      return this.m_frequencyHz;
   }
   b2DistanceJoint.prototype.SetFrequency = function (hz) {
      if (hz === undefined) hz = 0;
      this.m_frequencyHz = hz;
   }
   b2DistanceJoint.prototype.GetDampingRatio = function () {
      return this.m_dampingRatio;
   }
   b2DistanceJoint.prototype.SetDampingRatio = function (ratio) {
      if (ratio === undefined) ratio = 0;
      this.m_dampingRatio = ratio;
   }
   b2DistanceJoint.prototype.b2DistanceJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_length = def.length;
      this.m_frequencyHz = def.frequencyHz;
      this.m_dampingRatio = def.dampingRatio;
      this.m_impulse = 0.0;
      this.m_gamma = 0.0;
      this.m_bias = 0.0;
   }
   b2DistanceJoint.prototype.InitVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      this.m_u.x = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      this.m_u.y = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      var length = Math.sqrt(this.m_u.x * this.m_u.x + this.m_u.y * this.m_u.y);
      if (length > b2Settings.b2_linearSlop) {
         this.m_u.Multiply(1.0 / length);
      }
      else {
         this.m_u.SetZero();
      }
      var cr1u = (r1X * this.m_u.y - r1Y * this.m_u.x);
      var cr2u = (r2X * this.m_u.y - r2Y * this.m_u.x);
      var invMass = bA.m_invMass + bA.m_invI * cr1u * cr1u + bB.m_invMass + bB.m_invI * cr2u * cr2u;
      this.m_mass = invMass != 0.0 ? 1.0 / invMass : 0.0;
      if (this.m_frequencyHz > 0.0) {
         var C = length - this.m_length;
         var omega = 2.0 * Math.PI * this.m_frequencyHz;
         var d = 2.0 * this.m_mass * this.m_dampingRatio * omega;
         var k = this.m_mass * omega * omega;
         this.m_gamma = step.dt * (d + step.dt * k);
         this.m_gamma = this.m_gamma != 0.0 ? 1 / this.m_gamma : 0.0;
         this.m_bias = C * step.dt * k * this.m_gamma;
         this.m_mass = invMass + this.m_gamma;
         this.m_mass = this.m_mass != 0.0 ? 1.0 / this.m_mass : 0.0;
      }
      if (step.warmStarting) {
         this.m_impulse *= step.dtRatio;
         var PX = this.m_impulse * this.m_u.x;
         var PY = this.m_impulse * this.m_u.y;
         bA.m_linearVelocity.x -= bA.m_invMass * PX;
         bA.m_linearVelocity.y -= bA.m_invMass * PY;
         bA.m_angularVelocity -= bA.m_invI * (r1X * PY - r1Y * PX);
         bB.m_linearVelocity.x += bB.m_invMass * PX;
         bB.m_linearVelocity.y += bB.m_invMass * PY;
         bB.m_angularVelocity += bB.m_invI * (r2X * PY - r2Y * PX);
      }
      else {
         this.m_impulse = 0.0;
      }
   }
   b2DistanceJoint.prototype.SolveVelocityConstraints = function (step) {
      var tMat;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var v1X = bA.m_linearVelocity.x + ((-bA.m_angularVelocity * r1Y));
      var v1Y = bA.m_linearVelocity.y + (bA.m_angularVelocity * r1X);
      var v2X = bB.m_linearVelocity.x + ((-bB.m_angularVelocity * r2Y));
      var v2Y = bB.m_linearVelocity.y + (bB.m_angularVelocity * r2X);
      var Cdot = (this.m_u.x * (v2X - v1X) + this.m_u.y * (v2Y - v1Y));
      var impulse = (-this.m_mass * (Cdot + this.m_bias + this.m_gamma * this.m_impulse));
      this.m_impulse += impulse;
      var PX = impulse * this.m_u.x;
      var PY = impulse * this.m_u.y;
      bA.m_linearVelocity.x -= bA.m_invMass * PX;
      bA.m_linearVelocity.y -= bA.m_invMass * PY;
      bA.m_angularVelocity -= bA.m_invI * (r1X * PY - r1Y * PX);
      bB.m_linearVelocity.x += bB.m_invMass * PX;
      bB.m_linearVelocity.y += bB.m_invMass * PY;
      bB.m_angularVelocity += bB.m_invI * (r2X * PY - r2Y * PX);
   }
   b2DistanceJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var tMat;
      if (this.m_frequencyHz > 0.0) {
         return true;
      }
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      var dY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      var length = Math.sqrt(dX * dX + dY * dY);
      dX /= length;
      dY /= length;
      var C = length - this.m_length;
      C = b2Math.Clamp(C, (-b2Settings.b2_maxLinearCorrection), b2Settings.b2_maxLinearCorrection);
      var impulse = (-this.m_mass * C);
      this.m_u.Set(dX, dY);
      var PX = impulse * this.m_u.x;
      var PY = impulse * this.m_u.y;
      bA.m_sweep.c.x -= bA.m_invMass * PX;
      bA.m_sweep.c.y -= bA.m_invMass * PY;
      bA.m_sweep.a -= bA.m_invI * (r1X * PY - r1Y * PX);
      bB.m_sweep.c.x += bB.m_invMass * PX;
      bB.m_sweep.c.y += bB.m_invMass * PY;
      bB.m_sweep.a += bB.m_invI * (r2X * PY - r2Y * PX);
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return b2Math.Abs(C) < b2Settings.b2_linearSlop;
   }
   Box2D.inherit(b2DistanceJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2DistanceJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2DistanceJointDef.b2DistanceJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2DistanceJointDef.prototype.b2DistanceJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_distanceJoint;
      this.length = 1.0;
      this.frequencyHz = 0.0;
      this.dampingRatio = 0.0;
   }
   b2DistanceJointDef.prototype.Initialize = function (bA, bB, anchorA, anchorB) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA.SetV(this.bodyA.GetLocalPoint(anchorA));
      this.localAnchorB.SetV(this.bodyB.GetLocalPoint(anchorB));
      var dX = anchorB.x - anchorA.x;
      var dY = anchorB.y - anchorA.y;
      this.length = Math.sqrt(dX * dX + dY * dY);
      this.frequencyHz = 0.0;
      this.dampingRatio = 0.0;
   }
   Box2D.inherit(b2FrictionJoint, Box2D.Dynamics.Joints.b2Joint);
   b2FrictionJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2FrictionJoint.b2FrictionJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchorA = new b2Vec2();
      this.m_localAnchorB = new b2Vec2();
      this.m_linearMass = new b2Mat22();
      this.m_linearImpulse = new b2Vec2();
   };
   b2FrictionJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
   }
   b2FrictionJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
   }
   b2FrictionJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_linearImpulse.x, inv_dt * this.m_linearImpulse.y);
   }
   b2FrictionJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_angularImpulse;
   }
   b2FrictionJoint.prototype.SetMaxForce = function (force) {
      if (force === undefined) force = 0;
      this.m_maxForce = force;
   }
   b2FrictionJoint.prototype.GetMaxForce = function () {
      return this.m_maxForce;
   }
   b2FrictionJoint.prototype.SetMaxTorque = function (torque) {
      if (torque === undefined) torque = 0;
      this.m_maxTorque = torque;
   }
   b2FrictionJoint.prototype.GetMaxTorque = function () {
      return this.m_maxTorque;
   }
   b2FrictionJoint.prototype.b2FrictionJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_localAnchorA.SetV(def.localAnchorA);
      this.m_localAnchorB.SetV(def.localAnchorB);
      this.m_linearMass.SetZero();
      this.m_angularMass = 0.0;
      this.m_linearImpulse.SetZero();
      this.m_angularImpulse = 0.0;
      this.m_maxForce = def.maxForce;
      this.m_maxTorque = def.maxTorque;
   }
   b2FrictionJoint.prototype.InitVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      var K = new b2Mat22();
      K.col1.x = mA + mB;
      K.col2.x = 0.0;
      K.col1.y = 0.0;
      K.col2.y = mA + mB;
      K.col1.x += iA * rAY * rAY;
      K.col2.x += (-iA * rAX * rAY);
      K.col1.y += (-iA * rAX * rAY);
      K.col2.y += iA * rAX * rAX;
      K.col1.x += iB * rBY * rBY;
      K.col2.x += (-iB * rBX * rBY);
      K.col1.y += (-iB * rBX * rBY);
      K.col2.y += iB * rBX * rBX;
      K.GetInverse(this.m_linearMass);
      this.m_angularMass = iA + iB;
      if (this.m_angularMass > 0.0) {
         this.m_angularMass = 1.0 / this.m_angularMass;
      }
      if (step.warmStarting) {
         this.m_linearImpulse.x *= step.dtRatio;
         this.m_linearImpulse.y *= step.dtRatio;
         this.m_angularImpulse *= step.dtRatio;
         var P = this.m_linearImpulse;
         bA.m_linearVelocity.x -= mA * P.x;
         bA.m_linearVelocity.y -= mA * P.y;
         bA.m_angularVelocity -= iA * (rAX * P.y - rAY * P.x + this.m_angularImpulse);
         bB.m_linearVelocity.x += mB * P.x;
         bB.m_linearVelocity.y += mB * P.y;
         bB.m_angularVelocity += iB * (rBX * P.y - rBY * P.x + this.m_angularImpulse);
      }
      else {
         this.m_linearImpulse.SetZero();
         this.m_angularImpulse = 0.0;
      }
   }
   b2FrictionJoint.prototype.SolveVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var vA = bA.m_linearVelocity;
      var wA = bA.m_angularVelocity;
      var vB = bB.m_linearVelocity;
      var wB = bB.m_angularVelocity;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var maxImpulse = 0; {
         var Cdot = wB - wA;
         var impulse = (-this.m_angularMass * Cdot);
         var oldImpulse = this.m_angularImpulse;
         maxImpulse = step.dt * this.m_maxTorque;
         this.m_angularImpulse = b2Math.Clamp(this.m_angularImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_angularImpulse - oldImpulse;
         wA -= iA * impulse;
         wB += iB * impulse;
      } {
         var CdotX = vB.x - wB * rBY - vA.x + wA * rAY;
         var CdotY = vB.y + wB * rBX - vA.y - wA * rAX;
         var impulseV = b2Math.MulMV(this.m_linearMass, new b2Vec2((-CdotX), (-CdotY)));
         var oldImpulseV = this.m_linearImpulse.Copy();
         this.m_linearImpulse.Add(impulseV);
         maxImpulse = step.dt * this.m_maxForce;
         if (this.m_linearImpulse.LengthSquared() > maxImpulse * maxImpulse) {
            this.m_linearImpulse.Normalize();
            this.m_linearImpulse.Multiply(maxImpulse);
         }
         impulseV = b2Math.SubtractVV(this.m_linearImpulse, oldImpulseV);
         vA.x -= mA * impulseV.x;
         vA.y -= mA * impulseV.y;
         wA -= iA * (rAX * impulseV.y - rAY * impulseV.x);
         vB.x += mB * impulseV.x;
         vB.y += mB * impulseV.y;
         wB += iB * (rBX * impulseV.y - rBY * impulseV.x);
      }
      bA.m_angularVelocity = wA;
      bB.m_angularVelocity = wB;
   }
   b2FrictionJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      return true;
   }
   Box2D.inherit(b2FrictionJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2FrictionJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2FrictionJointDef.b2FrictionJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2FrictionJointDef.prototype.b2FrictionJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_frictionJoint;
      this.maxForce = 0.0;
      this.maxTorque = 0.0;
   }
   b2FrictionJointDef.prototype.Initialize = function (bA, bB, anchor) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA.SetV(this.bodyA.GetLocalPoint(anchor));
      this.localAnchorB.SetV(this.bodyB.GetLocalPoint(anchor));
   }
   Box2D.inherit(b2GearJoint, Box2D.Dynamics.Joints.b2Joint);
   b2GearJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2GearJoint.b2GearJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_groundAnchor1 = new b2Vec2();
      this.m_groundAnchor2 = new b2Vec2();
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_J = new b2Jacobian();
   };
   b2GearJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2GearJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2GearJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse * this.m_J.linearB.x, inv_dt * this.m_impulse * this.m_J.linearB.y);
   }
   b2GearJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      var tMat = this.m_bodyB.m_xf.R;
      var rX = this.m_localAnchor1.x - this.m_bodyB.m_sweep.localCenter.x;
      var rY = this.m_localAnchor1.y - this.m_bodyB.m_sweep.localCenter.y;
      var tX = tMat.col1.x * rX + tMat.col2.x * rY;
      rY = tMat.col1.y * rX + tMat.col2.y * rY;
      rX = tX;
      var PX = this.m_impulse * this.m_J.linearB.x;
      var PY = this.m_impulse * this.m_J.linearB.y;
      return inv_dt * (this.m_impulse * this.m_J.angularB - rX * PY + rY * PX);
   }
   b2GearJoint.prototype.GetRatio = function () {
      return this.m_ratio;
   }
   b2GearJoint.prototype.SetRatio = function (ratio) {
      if (ratio === undefined) ratio = 0;
      this.m_ratio = ratio;
   }
   b2GearJoint.prototype.b2GearJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var type1 = parseInt(def.joint1.m_type);
      var type2 = parseInt(def.joint2.m_type);
      this.m_revolute1 = null;
      this.m_prismatic1 = null;
      this.m_revolute2 = null;
      this.m_prismatic2 = null;
      var coordinate1 = 0;
      var coordinate2 = 0;
      this.m_ground1 = def.joint1.GetBodyA();
      this.m_bodyA = def.joint1.GetBodyB();
      if (type1 == b2Joint.e_revoluteJoint) {
         this.m_revolute1 = (def.joint1 instanceof b2RevoluteJoint ? def.joint1 : null);
         this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1);
         this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2);
         coordinate1 = this.m_revolute1.GetJointAngle();
      }
      else {
         this.m_prismatic1 = (def.joint1 instanceof b2PrismaticJoint ? def.joint1 : null);
         this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1);
         this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2);
         coordinate1 = this.m_prismatic1.GetJointTranslation();
      }
      this.m_ground2 = def.joint2.GetBodyA();
      this.m_bodyB = def.joint2.GetBodyB();
      if (type2 == b2Joint.e_revoluteJoint) {
         this.m_revolute2 = (def.joint2 instanceof b2RevoluteJoint ? def.joint2 : null);
         this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1);
         this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2);
         coordinate2 = this.m_revolute2.GetJointAngle();
      }
      else {
         this.m_prismatic2 = (def.joint2 instanceof b2PrismaticJoint ? def.joint2 : null);
         this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1);
         this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2);
         coordinate2 = this.m_prismatic2.GetJointTranslation();
      }
      this.m_ratio = def.ratio;
      this.m_constant = coordinate1 + this.m_ratio * coordinate2;
      this.m_impulse = 0.0;
   }
   b2GearJoint.prototype.InitVelocityConstraints = function (step) {
      var g1 = this.m_ground1;
      var g2 = this.m_ground2;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var ugX = 0;
      var ugY = 0;
      var rX = 0;
      var rY = 0;
      var tMat;
      var tVec;
      var crug = 0;
      var tX = 0;
      var K = 0.0;
      this.m_J.SetZero();
      if (this.m_revolute1) {
         this.m_J.angularA = (-1.0);
         K += bA.m_invI;
      }
      else {
         tMat = g1.m_xf.R;
         tVec = this.m_prismatic1.m_localXAxis1;
         ugX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         ugY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tMat = bA.m_xf.R;
         rX = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         rY = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = tMat.col1.x * rX + tMat.col2.x * rY;
         rY = tMat.col1.y * rX + tMat.col2.y * rY;
         rX = tX;
         crug = rX * ugY - rY * ugX;
         this.m_J.linearA.Set((-ugX), (-ugY));
         this.m_J.angularA = (-crug);
         K += bA.m_invMass + bA.m_invI * crug * crug;
      }
      if (this.m_revolute2) {
         this.m_J.angularB = (-this.m_ratio);
         K += this.m_ratio * this.m_ratio * bB.m_invI;
      }
      else {
         tMat = g2.m_xf.R;
         tVec = this.m_prismatic2.m_localXAxis1;
         ugX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         ugY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tMat = bB.m_xf.R;
         rX = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         rY = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = tMat.col1.x * rX + tMat.col2.x * rY;
         rY = tMat.col1.y * rX + tMat.col2.y * rY;
         rX = tX;
         crug = rX * ugY - rY * ugX;
         this.m_J.linearB.Set((-this.m_ratio * ugX), (-this.m_ratio * ugY));
         this.m_J.angularB = (-this.m_ratio * crug);
         K += this.m_ratio * this.m_ratio * (bB.m_invMass + bB.m_invI * crug * crug);
      }
      this.m_mass = K > 0.0 ? 1.0 / K : 0.0;
      if (step.warmStarting) {
         bA.m_linearVelocity.x += bA.m_invMass * this.m_impulse * this.m_J.linearA.x;
         bA.m_linearVelocity.y += bA.m_invMass * this.m_impulse * this.m_J.linearA.y;
         bA.m_angularVelocity += bA.m_invI * this.m_impulse * this.m_J.angularA;
         bB.m_linearVelocity.x += bB.m_invMass * this.m_impulse * this.m_J.linearB.x;
         bB.m_linearVelocity.y += bB.m_invMass * this.m_impulse * this.m_J.linearB.y;
         bB.m_angularVelocity += bB.m_invI * this.m_impulse * this.m_J.angularB;
      }
      else {
         this.m_impulse = 0.0;
      }
   }
   b2GearJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var Cdot = this.m_J.Compute(bA.m_linearVelocity, bA.m_angularVelocity, bB.m_linearVelocity, bB.m_angularVelocity);
      var impulse = (-this.m_mass * Cdot);
      this.m_impulse += impulse;
      bA.m_linearVelocity.x += bA.m_invMass * impulse * this.m_J.linearA.x;
      bA.m_linearVelocity.y += bA.m_invMass * impulse * this.m_J.linearA.y;
      bA.m_angularVelocity += bA.m_invI * impulse * this.m_J.angularA;
      bB.m_linearVelocity.x += bB.m_invMass * impulse * this.m_J.linearB.x;
      bB.m_linearVelocity.y += bB.m_invMass * impulse * this.m_J.linearB.y;
      bB.m_angularVelocity += bB.m_invI * impulse * this.m_J.angularB;
   }
   b2GearJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var linearError = 0.0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var coordinate1 = 0;
      var coordinate2 = 0;
      if (this.m_revolute1) {
         coordinate1 = this.m_revolute1.GetJointAngle();
      }
      else {
         coordinate1 = this.m_prismatic1.GetJointTranslation();
      }
      if (this.m_revolute2) {
         coordinate2 = this.m_revolute2.GetJointAngle();
      }
      else {
         coordinate2 = this.m_prismatic2.GetJointTranslation();
      }
      var C = this.m_constant - (coordinate1 + this.m_ratio * coordinate2);
      var impulse = (-this.m_mass * C);
      bA.m_sweep.c.x += bA.m_invMass * impulse * this.m_J.linearA.x;
      bA.m_sweep.c.y += bA.m_invMass * impulse * this.m_J.linearA.y;
      bA.m_sweep.a += bA.m_invI * impulse * this.m_J.angularA;
      bB.m_sweep.c.x += bB.m_invMass * impulse * this.m_J.linearB.x;
      bB.m_sweep.c.y += bB.m_invMass * impulse * this.m_J.linearB.y;
      bB.m_sweep.a += bB.m_invI * impulse * this.m_J.angularB;
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return linearError < b2Settings.b2_linearSlop;
   }
   Box2D.inherit(b2GearJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2GearJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2GearJointDef.b2GearJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
   };
   b2GearJointDef.prototype.b2GearJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_gearJoint;
      this.joint1 = null;
      this.joint2 = null;
      this.ratio = 1.0;
   }
   b2Jacobian.b2Jacobian = function () {
      this.linearA = new b2Vec2();
      this.linearB = new b2Vec2();
   };
   b2Jacobian.prototype.SetZero = function () {
      this.linearA.SetZero();
      this.angularA = 0.0;
      this.linearB.SetZero();
      this.angularB = 0.0;
   }
   b2Jacobian.prototype.Set = function (x1, a1, x2, a2) {
      if (a1 === undefined) a1 = 0;
      if (a2 === undefined) a2 = 0;
      this.linearA.SetV(x1);
      this.angularA = a1;
      this.linearB.SetV(x2);
      this.angularB = a2;
   }
   b2Jacobian.prototype.Compute = function (x1, a1, x2, a2) {
      if (a1 === undefined) a1 = 0;
      if (a2 === undefined) a2 = 0;
      return (this.linearA.x * x1.x + this.linearA.y * x1.y) + this.angularA * a1 + (this.linearB.x * x2.x + this.linearB.y * x2.y) + this.angularB * a2;
   }
   b2Joint.b2Joint = function () {
      this.m_edgeA = new b2JointEdge();
      this.m_edgeB = new b2JointEdge();
      this.m_localCenterA = new b2Vec2();
      this.m_localCenterB = new b2Vec2();
   };
   b2Joint.prototype.GetType = function () {
      return this.m_type;
   }
   b2Joint.prototype.GetAnchorA = function () {
      return null;
   }
   b2Joint.prototype.GetAnchorB = function () {
      return null;
   }
   b2Joint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return null;
   }
   b2Joint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2Joint.prototype.GetBodyA = function () {
      return this.m_bodyA;
   }
   b2Joint.prototype.GetBodyB = function () {
      return this.m_bodyB;
   }
   b2Joint.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Joint.prototype.GetUserData = function () {
      return this.m_userData;
   }
   b2Joint.prototype.SetUserData = function (data) {
      this.m_userData = data;
   }
   b2Joint.prototype.IsActive = function () {
      return this.m_bodyA.IsActive() && this.m_bodyB.IsActive();
   }
   b2Joint.Create = function (def, allocator) {
      var joint = null;
      switch (def.type) {
      case b2Joint.e_distanceJoint:
         {
            joint = new b2DistanceJoint((def instanceof b2DistanceJointDef ? def : null));
         }
         break;
      case b2Joint.e_mouseJoint:
         {
            joint = new b2MouseJoint((def instanceof b2MouseJointDef ? def : null));
         }
         break;
      case b2Joint.e_prismaticJoint:
         {
            joint = new b2PrismaticJoint((def instanceof b2PrismaticJointDef ? def : null));
         }
         break;
      case b2Joint.e_revoluteJoint:
         {
            joint = new b2RevoluteJoint((def instanceof b2RevoluteJointDef ? def : null));
         }
         break;
      case b2Joint.e_pulleyJoint:
         {
            joint = new b2PulleyJoint((def instanceof b2PulleyJointDef ? def : null));
         }
         break;
      case b2Joint.e_gearJoint:
         {
            joint = new b2GearJoint((def instanceof b2GearJointDef ? def : null));
         }
         break;
      case b2Joint.e_lineJoint:
         {
            joint = new b2LineJoint((def instanceof b2LineJointDef ? def : null));
         }
         break;
      case b2Joint.e_weldJoint:
         {
            joint = new b2WeldJoint((def instanceof b2WeldJointDef ? def : null));
         }
         break;
      case b2Joint.e_frictionJoint:
         {
            joint = new b2FrictionJoint((def instanceof b2FrictionJointDef ? def : null));
         }
         break;
      default:
         break;
      }
      return joint;
   }
   b2Joint.Destroy = function (joint, allocator) {}
   b2Joint.prototype.b2Joint = function (def) {
      b2Settings.b2Assert(def.bodyA != def.bodyB);
      this.m_type = def.type;
      this.m_prev = null;
      this.m_next = null;
      this.m_bodyA = def.bodyA;
      this.m_bodyB = def.bodyB;
      this.m_collideConnected = def.collideConnected;
      this.m_islandFlag = false;
      this.m_userData = def.userData;
   }
   b2Joint.prototype.InitVelocityConstraints = function (step) {}
   b2Joint.prototype.SolveVelocityConstraints = function (step) {}
   b2Joint.prototype.FinalizeVelocityConstraints = function () {}
   b2Joint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      return false;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Joints.b2Joint.e_unknownJoint = 0;
      Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint = 1;
      Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint = 2;
      Box2D.Dynamics.Joints.b2Joint.e_distanceJoint = 3;
      Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint = 4;
      Box2D.Dynamics.Joints.b2Joint.e_mouseJoint = 5;
      Box2D.Dynamics.Joints.b2Joint.e_gearJoint = 6;
      Box2D.Dynamics.Joints.b2Joint.e_lineJoint = 7;
      Box2D.Dynamics.Joints.b2Joint.e_weldJoint = 8;
      Box2D.Dynamics.Joints.b2Joint.e_frictionJoint = 9;
      Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit = 0;
      Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit = 1;
      Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit = 2;
      Box2D.Dynamics.Joints.b2Joint.e_equalLimits = 3;
   });
   b2JointDef.b2JointDef = function () {};
   b2JointDef.prototype.b2JointDef = function () {
      this.type = b2Joint.e_unknownJoint;
      this.userData = null;
      this.bodyA = null;
      this.bodyB = null;
      this.collideConnected = false;
   }
   b2JointEdge.b2JointEdge = function () {};
   Box2D.inherit(b2LineJoint, Box2D.Dynamics.Joints.b2Joint);
   b2LineJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2LineJoint.b2LineJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_localXAxis1 = new b2Vec2();
      this.m_localYAxis1 = new b2Vec2();
      this.m_axis = new b2Vec2();
      this.m_perp = new b2Vec2();
      this.m_K = new b2Mat22();
      this.m_impulse = new b2Vec2();
   };
   b2LineJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2LineJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2LineJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * (this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.x), inv_dt * (this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.y));
   }
   b2LineJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.y;
   }
   b2LineJoint.prototype.GetJointTranslation = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var p1 = bA.GetWorldPoint(this.m_localAnchor1);
      var p2 = bB.GetWorldPoint(this.m_localAnchor2);
      var dX = p2.x - p1.x;
      var dY = p2.y - p1.y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var translation = axis.x * dX + axis.y * dY;
      return translation;
   }
   b2LineJoint.prototype.GetJointSpeed = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var p1X = bA.m_sweep.c.x + r1X;
      var p1Y = bA.m_sweep.c.y + r1Y;
      var p2X = bB.m_sweep.c.x + r2X;
      var p2Y = bB.m_sweep.c.y + r2Y;
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var v1 = bA.m_linearVelocity;
      var v2 = bB.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var w2 = bB.m_angularVelocity;
      var speed = (dX * ((-w1 * axis.y)) + dY * (w1 * axis.x)) + (axis.x * (((v2.x + ((-w2 * r2Y))) - v1.x) - ((-w1 * r1Y))) + axis.y * (((v2.y + (w2 * r2X)) - v1.y) - (w1 * r1X)));
      return speed;
   }
   b2LineJoint.prototype.IsLimitEnabled = function () {
      return this.m_enableLimit;
   }
   b2LineJoint.prototype.EnableLimit = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableLimit = flag;
   }
   b2LineJoint.prototype.GetLowerLimit = function () {
      return this.m_lowerTranslation;
   }
   b2LineJoint.prototype.GetUpperLimit = function () {
      return this.m_upperTranslation;
   }
   b2LineJoint.prototype.SetLimits = function (lower, upper) {
      if (lower === undefined) lower = 0;
      if (upper === undefined) upper = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_lowerTranslation = lower;
      this.m_upperTranslation = upper;
   }
   b2LineJoint.prototype.IsMotorEnabled = function () {
      return this.m_enableMotor;
   }
   b2LineJoint.prototype.EnableMotor = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableMotor = flag;
   }
   b2LineJoint.prototype.SetMotorSpeed = function (speed) {
      if (speed === undefined) speed = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_motorSpeed = speed;
   }
   b2LineJoint.prototype.GetMotorSpeed = function () {
      return this.m_motorSpeed;
   }
   b2LineJoint.prototype.SetMaxMotorForce = function (force) {
      if (force === undefined) force = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_maxMotorForce = force;
   }
   b2LineJoint.prototype.GetMaxMotorForce = function () {
      return this.m_maxMotorForce;
   }
   b2LineJoint.prototype.GetMotorForce = function () {
      return this.m_motorImpulse;
   }
   b2LineJoint.prototype.b2LineJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_localXAxis1.SetV(def.localAxisA);
      this.m_localYAxis1.x = (-this.m_localXAxis1.y);
      this.m_localYAxis1.y = this.m_localXAxis1.x;
      this.m_impulse.SetZero();
      this.m_motorMass = 0.0;
      this.m_motorImpulse = 0.0;
      this.m_lowerTranslation = def.lowerTranslation;
      this.m_upperTranslation = def.upperTranslation;
      this.m_maxMotorForce = def.maxMotorForce;
      this.m_motorSpeed = def.motorSpeed;
      this.m_enableLimit = def.enableLimit;
      this.m_enableMotor = def.enableMotor;
      this.m_limitState = b2Joint.e_inactiveLimit;
      this.m_axis.SetZero();
      this.m_perp.SetZero();
   }
   b2LineJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      this.m_localCenterA.SetV(bA.GetLocalCenter());
      this.m_localCenterB.SetV(bB.GetLocalCenter());
      var xf1 = bA.GetTransform();
      var xf2 = bB.GetTransform();
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      var dY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      this.m_invMassA = bA.m_invMass;
      this.m_invMassB = bB.m_invMass;
      this.m_invIA = bA.m_invI;
      this.m_invIB = bB.m_invI; {
         this.m_axis.SetV(b2Math.MulMV(xf1.R, this.m_localXAxis1));
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         this.m_motorMass = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_a1 * this.m_a1 + this.m_invIB * this.m_a2 * this.m_a2;
         this.m_motorMass = this.m_motorMass > Number.MIN_VALUE ? 1.0 / this.m_motorMass : 0.0;
      } {
         this.m_perp.SetV(b2Math.MulMV(xf1.R, this.m_localYAxis1));
         this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
         this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
         var m1 = this.m_invMassA;
         var m2 = this.m_invMassB;
         var i1 = this.m_invIA;
         var i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
      }
      if (this.m_enableLimit) {
         var jointTransition = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            this.m_limitState = b2Joint.e_equalLimits;
         }
         else if (jointTransition <= this.m_lowerTranslation) {
            if (this.m_limitState != b2Joint.e_atLowerLimit) {
               this.m_limitState = b2Joint.e_atLowerLimit;
               this.m_impulse.y = 0.0;
            }
         }
         else if (jointTransition >= this.m_upperTranslation) {
            if (this.m_limitState != b2Joint.e_atUpperLimit) {
               this.m_limitState = b2Joint.e_atUpperLimit;
               this.m_impulse.y = 0.0;
            }
         }
         else {
            this.m_limitState = b2Joint.e_inactiveLimit;
            this.m_impulse.y = 0.0;
         }
      }
      else {
         this.m_limitState = b2Joint.e_inactiveLimit;
      }
      if (this.m_enableMotor == false) {
         this.m_motorImpulse = 0.0;
      }
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_motorImpulse *= step.dtRatio;
         var PX = this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.x;
         var PY = this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.y;
         var L1 = this.m_impulse.x * this.m_s1 + (this.m_motorImpulse + this.m_impulse.y) * this.m_a1;
         var L2 = this.m_impulse.x * this.m_s2 + (this.m_motorImpulse + this.m_impulse.y) * this.m_a2;
         bA.m_linearVelocity.x -= this.m_invMassA * PX;
         bA.m_linearVelocity.y -= this.m_invMassA * PY;
         bA.m_angularVelocity -= this.m_invIA * L1;
         bB.m_linearVelocity.x += this.m_invMassB * PX;
         bB.m_linearVelocity.y += this.m_invMassB * PY;
         bB.m_angularVelocity += this.m_invIB * L2;
      }
      else {
         this.m_impulse.SetZero();
         this.m_motorImpulse = 0.0;
      }
   }
   b2LineJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var v1 = bA.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var v2 = bB.m_linearVelocity;
      var w2 = bB.m_angularVelocity;
      var PX = 0;
      var PY = 0;
      var L1 = 0;
      var L2 = 0;
      if (this.m_enableMotor && this.m_limitState != b2Joint.e_equalLimits) {
         var Cdot = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
         var oldImpulse = this.m_motorImpulse;
         var maxImpulse = step.dt * this.m_maxMotorForce;
         this.m_motorImpulse = b2Math.Clamp(this.m_motorImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_motorImpulse - oldImpulse;
         PX = impulse * this.m_axis.x;
         PY = impulse * this.m_axis.y;
         L1 = impulse * this.m_a1;
         L2 = impulse * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      var Cdot1 = this.m_perp.x * (v2.x - v1.x) + this.m_perp.y * (v2.y - v1.y) + this.m_s2 * w2 - this.m_s1 * w1;
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         var Cdot2 = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var f1 = this.m_impulse.Copy();
         var df = this.m_K.Solve(new b2Vec2(), (-Cdot1), (-Cdot2));
         this.m_impulse.Add(df);
         if (this.m_limitState == b2Joint.e_atLowerLimit) {
            this.m_impulse.y = b2Math.Max(this.m_impulse.y, 0.0);
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            this.m_impulse.y = b2Math.Min(this.m_impulse.y, 0.0);
         }
         var b = (-Cdot1) - (this.m_impulse.y - f1.y) * this.m_K.col2.x;
         var f2r = 0;
         if (this.m_K.col1.x != 0.0) {
            f2r = b / this.m_K.col1.x + f1.x;
         }
         else {
            f2r = f1.x;
         }
         this.m_impulse.x = f2r;
         df.x = this.m_impulse.x - f1.x;
         df.y = this.m_impulse.y - f1.y;
         PX = df.x * this.m_perp.x + df.y * this.m_axis.x;
         PY = df.x * this.m_perp.y + df.y * this.m_axis.y;
         L1 = df.x * this.m_s1 + df.y * this.m_a1;
         L2 = df.x * this.m_s2 + df.y * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      else {
         var df2 = 0;
         if (this.m_K.col1.x != 0.0) {
            df2 = ((-Cdot1)) / this.m_K.col1.x;
         }
         else {
            df2 = 0.0;
         }
         this.m_impulse.x += df2;
         PX = df2 * this.m_perp.x;
         PY = df2 * this.m_perp.y;
         L1 = df2 * this.m_s1;
         L2 = df2 * this.m_s2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      bA.m_linearVelocity.SetV(v1);
      bA.m_angularVelocity = w1;
      bB.m_linearVelocity.SetV(v2);
      bB.m_angularVelocity = w2;
   }
   b2LineJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var limitC = 0;
      var oldLimitImpulse = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var c1 = bA.m_sweep.c;
      var a1 = bA.m_sweep.a;
      var c2 = bB.m_sweep.c;
      var a2 = bB.m_sweep.a;
      var tMat;
      var tX = 0;
      var m1 = 0;
      var m2 = 0;
      var i1 = 0;
      var i2 = 0;
      var linearError = 0.0;
      var angularError = 0.0;
      var active = false;
      var C2 = 0.0;
      var R1 = b2Mat22.FromAngle(a1);
      var R2 = b2Mat22.FromAngle(a2);
      tMat = R1;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = R2;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = c2.x + r2X - c1.x - r1X;
      var dY = c2.y + r2Y - c1.y - r1Y;
      if (this.m_enableLimit) {
         this.m_axis = b2Math.MulMV(R1, this.m_localXAxis1);
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         var translation = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            C2 = b2Math.Clamp(translation, (-b2Settings.b2_maxLinearCorrection), b2Settings.b2_maxLinearCorrection);
            linearError = b2Math.Abs(translation);
            active = true;
         }
         else if (translation <= this.m_lowerTranslation) {
            C2 = b2Math.Clamp(translation - this.m_lowerTranslation + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
            linearError = this.m_lowerTranslation - translation;
            active = true;
         }
         else if (translation >= this.m_upperTranslation) {
            C2 = b2Math.Clamp(translation - this.m_upperTranslation + b2Settings.b2_linearSlop, 0.0, b2Settings.b2_maxLinearCorrection);
            linearError = translation - this.m_upperTranslation;
            active = true;
         }
      }
      this.m_perp = b2Math.MulMV(R1, this.m_localYAxis1);
      this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
      this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
      var impulse = new b2Vec2();
      var C1 = this.m_perp.x * dX + this.m_perp.y * dY;
      linearError = b2Math.Max(linearError, b2Math.Abs(C1));
      angularError = 0.0;
      if (active) {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
         this.m_K.Solve(impulse, (-C1), (-C2));
      }
      else {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         var k11 = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         var impulse1 = 0;
         if (k11 != 0.0) {
            impulse1 = ((-C1)) / k11;
         }
         else {
            impulse1 = 0.0;
         }
         impulse.x = impulse1;
         impulse.y = 0.0;
      }
      var PX = impulse.x * this.m_perp.x + impulse.y * this.m_axis.x;
      var PY = impulse.x * this.m_perp.y + impulse.y * this.m_axis.y;
      var L1 = impulse.x * this.m_s1 + impulse.y * this.m_a1;
      var L2 = impulse.x * this.m_s2 + impulse.y * this.m_a2;
      c1.x -= this.m_invMassA * PX;
      c1.y -= this.m_invMassA * PY;
      a1 -= this.m_invIA * L1;
      c2.x += this.m_invMassB * PX;
      c2.y += this.m_invMassB * PY;
      a2 += this.m_invIB * L2;
      bA.m_sweep.a = a1;
      bB.m_sweep.a = a2;
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return linearError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.inherit(b2LineJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2LineJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2LineJointDef.b2LineJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
      this.localAxisA = new b2Vec2();
   };
   b2LineJointDef.prototype.b2LineJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_lineJoint;
      this.localAxisA.Set(1.0, 0.0);
      this.enableLimit = false;
      this.lowerTranslation = 0.0;
      this.upperTranslation = 0.0;
      this.enableMotor = false;
      this.maxMotorForce = 0.0;
      this.motorSpeed = 0.0;
   }
   b2LineJointDef.prototype.Initialize = function (bA, bB, anchor, axis) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA = this.bodyA.GetLocalPoint(anchor);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchor);
      this.localAxisA = this.bodyA.GetLocalVector(axis);
   }
   Box2D.inherit(b2MouseJoint, Box2D.Dynamics.Joints.b2Joint);
   b2MouseJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2MouseJoint.b2MouseJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.K = new b2Mat22();
      this.K1 = new b2Mat22();
      this.K2 = new b2Mat22();
      this.m_localAnchor = new b2Vec2();
      this.m_target = new b2Vec2();
      this.m_impulse = new b2Vec2();
      this.m_mass = new b2Mat22();
      this.m_C = new b2Vec2();
   };
   b2MouseJoint.prototype.GetAnchorA = function () {
      return this.m_target;
   }
   b2MouseJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor);
   }
   b2MouseJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse.x, inv_dt * this.m_impulse.y);
   }
   b2MouseJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2MouseJoint.prototype.GetTarget = function () {
      return this.m_target;
   }
   b2MouseJoint.prototype.SetTarget = function (target) {
      if (this.m_bodyB.IsAwake() == false) {
         this.m_bodyB.SetAwake(true);
      }
      this.m_target = target;
   }
   b2MouseJoint.prototype.GetMaxForce = function () {
      return this.m_maxForce;
   }
   b2MouseJoint.prototype.SetMaxForce = function (maxForce) {
      if (maxForce === undefined) maxForce = 0;
      this.m_maxForce = maxForce;
   }
   b2MouseJoint.prototype.GetFrequency = function () {
      return this.m_frequencyHz;
   }
   b2MouseJoint.prototype.SetFrequency = function (hz) {
      if (hz === undefined) hz = 0;
      this.m_frequencyHz = hz;
   }
   b2MouseJoint.prototype.GetDampingRatio = function () {
      return this.m_dampingRatio;
   }
   b2MouseJoint.prototype.SetDampingRatio = function (ratio) {
      if (ratio === undefined) ratio = 0;
      this.m_dampingRatio = ratio;
   }
   b2MouseJoint.prototype.b2MouseJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_target.SetV(def.target);
      var tX = this.m_target.x - this.m_bodyB.m_xf.position.x;
      var tY = this.m_target.y - this.m_bodyB.m_xf.position.y;
      var tMat = this.m_bodyB.m_xf.R;
      this.m_localAnchor.x = (tX * tMat.col1.x + tY * tMat.col1.y);
      this.m_localAnchor.y = (tX * tMat.col2.x + tY * tMat.col2.y);
      this.m_maxForce = def.maxForce;
      this.m_impulse.SetZero();
      this.m_frequencyHz = def.frequencyHz;
      this.m_dampingRatio = def.dampingRatio;
      this.m_beta = 0.0;
      this.m_gamma = 0.0;
   }
   b2MouseJoint.prototype.InitVelocityConstraints = function (step) {
      var b = this.m_bodyB;
      var mass = b.GetMass();
      var omega = 2.0 * Math.PI * this.m_frequencyHz;
      var d = 2.0 * mass * this.m_dampingRatio * omega;
      var k = mass * omega * omega;
      this.m_gamma = step.dt * (d + step.dt * k);
      this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0.0;
      this.m_beta = step.dt * k * this.m_gamma;
      var tMat;tMat = b.m_xf.R;
      var rX = this.m_localAnchor.x - b.m_sweep.localCenter.x;
      var rY = this.m_localAnchor.y - b.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * rX + tMat.col2.x * rY);rY = (tMat.col1.y * rX + tMat.col2.y * rY);
      rX = tX;
      var invMass = b.m_invMass;
      var invI = b.m_invI;this.K1.col1.x = invMass;
      this.K1.col2.x = 0.0;
      this.K1.col1.y = 0.0;
      this.K1.col2.y = invMass;
      this.K2.col1.x = invI * rY * rY;
      this.K2.col2.x = (-invI * rX * rY);
      this.K2.col1.y = (-invI * rX * rY);
      this.K2.col2.y = invI * rX * rX;
      this.K.SetM(this.K1);
      this.K.AddM(this.K2);
      this.K.col1.x += this.m_gamma;
      this.K.col2.y += this.m_gamma;
      this.K.GetInverse(this.m_mass);
      this.m_C.x = b.m_sweep.c.x + rX - this.m_target.x;
      this.m_C.y = b.m_sweep.c.y + rY - this.m_target.y;
      b.m_angularVelocity *= 0.98;
      this.m_impulse.x *= step.dtRatio;
      this.m_impulse.y *= step.dtRatio;
      b.m_linearVelocity.x += invMass * this.m_impulse.x;
      b.m_linearVelocity.y += invMass * this.m_impulse.y;
      b.m_angularVelocity += invI * (rX * this.m_impulse.y - rY * this.m_impulse.x);
   }
   b2MouseJoint.prototype.SolveVelocityConstraints = function (step) {
      var b = this.m_bodyB;
      var tMat;
      var tX = 0;
      var tY = 0;
      tMat = b.m_xf.R;
      var rX = this.m_localAnchor.x - b.m_sweep.localCenter.x;
      var rY = this.m_localAnchor.y - b.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rX + tMat.col2.x * rY);
      rY = (tMat.col1.y * rX + tMat.col2.y * rY);
      rX = tX;
      var CdotX = b.m_linearVelocity.x + ((-b.m_angularVelocity * rY));
      var CdotY = b.m_linearVelocity.y + (b.m_angularVelocity * rX);
      tMat = this.m_mass;
      tX = CdotX + this.m_beta * this.m_C.x + this.m_gamma * this.m_impulse.x;
      tY = CdotY + this.m_beta * this.m_C.y + this.m_gamma * this.m_impulse.y;
      var impulseX = (-(tMat.col1.x * tX + tMat.col2.x * tY));
      var impulseY = (-(tMat.col1.y * tX + tMat.col2.y * tY));
      var oldImpulseX = this.m_impulse.x;
      var oldImpulseY = this.m_impulse.y;
      this.m_impulse.x += impulseX;
      this.m_impulse.y += impulseY;
      var maxImpulse = step.dt * this.m_maxForce;
      if (this.m_impulse.LengthSquared() > maxImpulse * maxImpulse) {
         this.m_impulse.Multiply(maxImpulse / this.m_impulse.Length());
      }
      impulseX = this.m_impulse.x - oldImpulseX;
      impulseY = this.m_impulse.y - oldImpulseY;
      b.m_linearVelocity.x += b.m_invMass * impulseX;
      b.m_linearVelocity.y += b.m_invMass * impulseY;
      b.m_angularVelocity += b.m_invI * (rX * impulseY - rY * impulseX);
   }
   b2MouseJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      return true;
   }
   Box2D.inherit(b2MouseJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2MouseJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2MouseJointDef.b2MouseJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.target = new b2Vec2();
   };
   b2MouseJointDef.prototype.b2MouseJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_mouseJoint;
      this.maxForce = 0.0;
      this.frequencyHz = 5.0;
      this.dampingRatio = 0.7;
   }
   Box2D.inherit(b2PrismaticJoint, Box2D.Dynamics.Joints.b2Joint);
   b2PrismaticJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2PrismaticJoint.b2PrismaticJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_localXAxis1 = new b2Vec2();
      this.m_localYAxis1 = new b2Vec2();
      this.m_axis = new b2Vec2();
      this.m_perp = new b2Vec2();
      this.m_K = new b2Mat33();
      this.m_impulse = new b2Vec3();
   };
   b2PrismaticJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2PrismaticJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2PrismaticJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * (this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x), inv_dt * (this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y));
   }
   b2PrismaticJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.y;
   }
   b2PrismaticJoint.prototype.GetJointTranslation = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var p1 = bA.GetWorldPoint(this.m_localAnchor1);
      var p2 = bB.GetWorldPoint(this.m_localAnchor2);
      var dX = p2.x - p1.x;
      var dY = p2.y - p1.y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var translation = axis.x * dX + axis.y * dY;
      return translation;
   }
   b2PrismaticJoint.prototype.GetJointSpeed = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var p1X = bA.m_sweep.c.x + r1X;
      var p1Y = bA.m_sweep.c.y + r1Y;
      var p2X = bB.m_sweep.c.x + r2X;
      var p2Y = bB.m_sweep.c.y + r2Y;
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var v1 = bA.m_linearVelocity;
      var v2 = bB.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var w2 = bB.m_angularVelocity;
      var speed = (dX * ((-w1 * axis.y)) + dY * (w1 * axis.x)) + (axis.x * (((v2.x + ((-w2 * r2Y))) - v1.x) - ((-w1 * r1Y))) + axis.y * (((v2.y + (w2 * r2X)) - v1.y) - (w1 * r1X)));
      return speed;
   }
   b2PrismaticJoint.prototype.IsLimitEnabled = function () {
      return this.m_enableLimit;
   }
   b2PrismaticJoint.prototype.EnableLimit = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableLimit = flag;
   }
   b2PrismaticJoint.prototype.GetLowerLimit = function () {
      return this.m_lowerTranslation;
   }
   b2PrismaticJoint.prototype.GetUpperLimit = function () {
      return this.m_upperTranslation;
   }
   b2PrismaticJoint.prototype.SetLimits = function (lower, upper) {
      if (lower === undefined) lower = 0;
      if (upper === undefined) upper = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_lowerTranslation = lower;
      this.m_upperTranslation = upper;
   }
   b2PrismaticJoint.prototype.IsMotorEnabled = function () {
      return this.m_enableMotor;
   }
   b2PrismaticJoint.prototype.EnableMotor = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableMotor = flag;
   }
   b2PrismaticJoint.prototype.SetMotorSpeed = function (speed) {
      if (speed === undefined) speed = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_motorSpeed = speed;
   }
   b2PrismaticJoint.prototype.GetMotorSpeed = function () {
      return this.m_motorSpeed;
   }
   b2PrismaticJoint.prototype.SetMaxMotorForce = function (force) {
      if (force === undefined) force = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_maxMotorForce = force;
   }
   b2PrismaticJoint.prototype.GetMotorForce = function () {
      return this.m_motorImpulse;
   }
   b2PrismaticJoint.prototype.b2PrismaticJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_localXAxis1.SetV(def.localAxisA);
      this.m_localYAxis1.x = (-this.m_localXAxis1.y);
      this.m_localYAxis1.y = this.m_localXAxis1.x;
      this.m_refAngle = def.referenceAngle;
      this.m_impulse.SetZero();
      this.m_motorMass = 0.0;
      this.m_motorImpulse = 0.0;
      this.m_lowerTranslation = def.lowerTranslation;
      this.m_upperTranslation = def.upperTranslation;
      this.m_maxMotorForce = def.maxMotorForce;
      this.m_motorSpeed = def.motorSpeed;
      this.m_enableLimit = def.enableLimit;
      this.m_enableMotor = def.enableMotor;
      this.m_limitState = b2Joint.e_inactiveLimit;
      this.m_axis.SetZero();
      this.m_perp.SetZero();
   }
   b2PrismaticJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      this.m_localCenterA.SetV(bA.GetLocalCenter());
      this.m_localCenterB.SetV(bB.GetLocalCenter());
      var xf1 = bA.GetTransform();
      var xf2 = bB.GetTransform();
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      var dY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      this.m_invMassA = bA.m_invMass;
      this.m_invMassB = bB.m_invMass;
      this.m_invIA = bA.m_invI;
      this.m_invIB = bB.m_invI; {
         this.m_axis.SetV(b2Math.MulMV(xf1.R, this.m_localXAxis1));
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         this.m_motorMass = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_a1 * this.m_a1 + this.m_invIB * this.m_a2 * this.m_a2;
         if (this.m_motorMass > Number.MIN_VALUE) this.m_motorMass = 1.0 / this.m_motorMass;
      } {
         this.m_perp.SetV(b2Math.MulMV(xf1.R, this.m_localYAxis1));
         this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
         this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
         var m1 = this.m_invMassA;
         var m2 = this.m_invMassB;
         var i1 = this.m_invIA;
         var i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 + i2 * this.m_s2;
         this.m_K.col1.z = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = i1 + i2;
         this.m_K.col2.z = i1 * this.m_a1 + i2 * this.m_a2;
         this.m_K.col3.x = this.m_K.col1.z;
         this.m_K.col3.y = this.m_K.col2.z;
         this.m_K.col3.z = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
      }
      if (this.m_enableLimit) {
         var jointTransition = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            this.m_limitState = b2Joint.e_equalLimits;
         }
         else if (jointTransition <= this.m_lowerTranslation) {
            if (this.m_limitState != b2Joint.e_atLowerLimit) {
               this.m_limitState = b2Joint.e_atLowerLimit;
               this.m_impulse.z = 0.0;
            }
         }
         else if (jointTransition >= this.m_upperTranslation) {
            if (this.m_limitState != b2Joint.e_atUpperLimit) {
               this.m_limitState = b2Joint.e_atUpperLimit;
               this.m_impulse.z = 0.0;
            }
         }
         else {
            this.m_limitState = b2Joint.e_inactiveLimit;
            this.m_impulse.z = 0.0;
         }
      }
      else {
         this.m_limitState = b2Joint.e_inactiveLimit;
      }
      if (this.m_enableMotor == false) {
         this.m_motorImpulse = 0.0;
      }
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_motorImpulse *= step.dtRatio;
         var PX = this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x;
         var PY = this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y;
         var L1 = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1;
         var L2 = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;
         bA.m_linearVelocity.x -= this.m_invMassA * PX;
         bA.m_linearVelocity.y -= this.m_invMassA * PY;
         bA.m_angularVelocity -= this.m_invIA * L1;
         bB.m_linearVelocity.x += this.m_invMassB * PX;
         bB.m_linearVelocity.y += this.m_invMassB * PY;
         bB.m_angularVelocity += this.m_invIB * L2;
      }
      else {
         this.m_impulse.SetZero();
         this.m_motorImpulse = 0.0;
      }
   }
   b2PrismaticJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var v1 = bA.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var v2 = bB.m_linearVelocity;
      var w2 = bB.m_angularVelocity;
      var PX = 0;
      var PY = 0;
      var L1 = 0;
      var L2 = 0;
      if (this.m_enableMotor && this.m_limitState != b2Joint.e_equalLimits) {
         var Cdot = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
         var oldImpulse = this.m_motorImpulse;
         var maxImpulse = step.dt * this.m_maxMotorForce;
         this.m_motorImpulse = b2Math.Clamp(this.m_motorImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_motorImpulse - oldImpulse;
         PX = impulse * this.m_axis.x;
         PY = impulse * this.m_axis.y;
         L1 = impulse * this.m_a1;
         L2 = impulse * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      var Cdot1X = this.m_perp.x * (v2.x - v1.x) + this.m_perp.y * (v2.y - v1.y) + this.m_s2 * w2 - this.m_s1 * w1;
      var Cdot1Y = w2 - w1;
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         var Cdot2 = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var f1 = this.m_impulse.Copy();
         var df = this.m_K.Solve33(new b2Vec3(), (-Cdot1X), (-Cdot1Y), (-Cdot2));
         this.m_impulse.Add(df);
         if (this.m_limitState == b2Joint.e_atLowerLimit) {
            this.m_impulse.z = b2Math.Max(this.m_impulse.z, 0.0);
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            this.m_impulse.z = b2Math.Min(this.m_impulse.z, 0.0);
         }
         var bX = (-Cdot1X) - (this.m_impulse.z - f1.z) * this.m_K.col3.x;
         var bY = (-Cdot1Y) - (this.m_impulse.z - f1.z) * this.m_K.col3.y;
         var f2r = this.m_K.Solve22(new b2Vec2(), bX, bY);
         f2r.x += f1.x;
         f2r.y += f1.y;
         this.m_impulse.x = f2r.x;
         this.m_impulse.y = f2r.y;
         df.x = this.m_impulse.x - f1.x;
         df.y = this.m_impulse.y - f1.y;
         df.z = this.m_impulse.z - f1.z;
         PX = df.x * this.m_perp.x + df.z * this.m_axis.x;
         PY = df.x * this.m_perp.y + df.z * this.m_axis.y;
         L1 = df.x * this.m_s1 + df.y + df.z * this.m_a1;
         L2 = df.x * this.m_s2 + df.y + df.z * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      else {
         var df2 = this.m_K.Solve22(new b2Vec2(), (-Cdot1X), (-Cdot1Y));
         this.m_impulse.x += df2.x;
         this.m_impulse.y += df2.y;
         PX = df2.x * this.m_perp.x;
         PY = df2.x * this.m_perp.y;
         L1 = df2.x * this.m_s1 + df2.y;
         L2 = df2.x * this.m_s2 + df2.y;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      bA.m_linearVelocity.SetV(v1);
      bA.m_angularVelocity = w1;
      bB.m_linearVelocity.SetV(v2);
      bB.m_angularVelocity = w2;
   }
   b2PrismaticJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var limitC = 0;
      var oldLimitImpulse = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var c1 = bA.m_sweep.c;
      var a1 = bA.m_sweep.a;
      var c2 = bB.m_sweep.c;
      var a2 = bB.m_sweep.a;
      var tMat;
      var tX = 0;
      var m1 = 0;
      var m2 = 0;
      var i1 = 0;
      var i2 = 0;
      var linearError = 0.0;
      var angularError = 0.0;
      var active = false;
      var C2 = 0.0;
      var R1 = b2Mat22.FromAngle(a1);
      var R2 = b2Mat22.FromAngle(a2);
      tMat = R1;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = R2;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = c2.x + r2X - c1.x - r1X;
      var dY = c2.y + r2Y - c1.y - r1Y;
      if (this.m_enableLimit) {
         this.m_axis = b2Math.MulMV(R1, this.m_localXAxis1);
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         var translation = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            C2 = b2Math.Clamp(translation, (-b2Settings.b2_maxLinearCorrection), b2Settings.b2_maxLinearCorrection);
            linearError = b2Math.Abs(translation);
            active = true;
         }
         else if (translation <= this.m_lowerTranslation) {
            C2 = b2Math.Clamp(translation - this.m_lowerTranslation + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
            linearError = this.m_lowerTranslation - translation;
            active = true;
         }
         else if (translation >= this.m_upperTranslation) {
            C2 = b2Math.Clamp(translation - this.m_upperTranslation + b2Settings.b2_linearSlop, 0.0, b2Settings.b2_maxLinearCorrection);
            linearError = translation - this.m_upperTranslation;
            active = true;
         }
      }
      this.m_perp = b2Math.MulMV(R1, this.m_localYAxis1);
      this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
      this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
      var impulse = new b2Vec3();
      var C1X = this.m_perp.x * dX + this.m_perp.y * dY;
      var C1Y = a2 - a1 - this.m_refAngle;
      linearError = b2Math.Max(linearError, b2Math.Abs(C1X));
      angularError = b2Math.Abs(C1Y);
      if (active) {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 + i2 * this.m_s2;
         this.m_K.col1.z = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = i1 + i2;
         this.m_K.col2.z = i1 * this.m_a1 + i2 * this.m_a2;
         this.m_K.col3.x = this.m_K.col1.z;
         this.m_K.col3.y = this.m_K.col2.z;
         this.m_K.col3.z = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
         this.m_K.Solve33(impulse, (-C1X), (-C1Y), (-C2));
      }
      else {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         var k11 = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         var k12 = i1 * this.m_s1 + i2 * this.m_s2;
         var k22 = i1 + i2;
         this.m_K.col1.Set(k11, k12, 0.0);
         this.m_K.col2.Set(k12, k22, 0.0);
         var impulse1 = this.m_K.Solve22(new b2Vec2(), (-C1X), (-C1Y));
         impulse.x = impulse1.x;
         impulse.y = impulse1.y;
         impulse.z = 0.0;
      }
      var PX = impulse.x * this.m_perp.x + impulse.z * this.m_axis.x;
      var PY = impulse.x * this.m_perp.y + impulse.z * this.m_axis.y;
      var L1 = impulse.x * this.m_s1 + impulse.y + impulse.z * this.m_a1;
      var L2 = impulse.x * this.m_s2 + impulse.y + impulse.z * this.m_a2;
      c1.x -= this.m_invMassA * PX;
      c1.y -= this.m_invMassA * PY;
      a1 -= this.m_invIA * L1;
      c2.x += this.m_invMassB * PX;
      c2.y += this.m_invMassB * PY;
      a2 += this.m_invIB * L2;
      bA.m_sweep.a = a1;
      bB.m_sweep.a = a2;
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return linearError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.inherit(b2PrismaticJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2PrismaticJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2PrismaticJointDef.b2PrismaticJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
      this.localAxisA = new b2Vec2();
   };
   b2PrismaticJointDef.prototype.b2PrismaticJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_prismaticJoint;
      this.localAxisA.Set(1.0, 0.0);
      this.referenceAngle = 0.0;
      this.enableLimit = false;
      this.lowerTranslation = 0.0;
      this.upperTranslation = 0.0;
      this.enableMotor = false;
      this.maxMotorForce = 0.0;
      this.motorSpeed = 0.0;
   }
   b2PrismaticJointDef.prototype.Initialize = function (bA, bB, anchor, axis) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA = this.bodyA.GetLocalPoint(anchor);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchor);
      this.localAxisA = this.bodyA.GetLocalVector(axis);
      this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
   }
   Box2D.inherit(b2PulleyJoint, Box2D.Dynamics.Joints.b2Joint);
   b2PulleyJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2PulleyJoint.b2PulleyJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_groundAnchor1 = new b2Vec2();
      this.m_groundAnchor2 = new b2Vec2();
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_u1 = new b2Vec2();
      this.m_u2 = new b2Vec2();
   };
   b2PulleyJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2PulleyJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2PulleyJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse * this.m_u2.x, inv_dt * this.m_impulse * this.m_u2.y);
   }
   b2PulleyJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2PulleyJoint.prototype.GetGroundAnchorA = function () {
      var a = this.m_ground.m_xf.position.Copy();
      a.Add(this.m_groundAnchor1);
      return a;
   }
   b2PulleyJoint.prototype.GetGroundAnchorB = function () {
      var a = this.m_ground.m_xf.position.Copy();
      a.Add(this.m_groundAnchor2);
      return a;
   }
   b2PulleyJoint.prototype.GetLength1 = function () {
      var p = this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
      var sX = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x;
      var sY = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y;
      var dX = p.x - sX;
      var dY = p.y - sY;
      return Math.sqrt(dX * dX + dY * dY);
   }
   b2PulleyJoint.prototype.GetLength2 = function () {
      var p = this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
      var sX = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x;
      var sY = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
      var dX = p.x - sX;
      var dY = p.y - sY;
      return Math.sqrt(dX * dX + dY * dY);
   }
   b2PulleyJoint.prototype.GetRatio = function () {
      return this.m_ratio;
   }
   b2PulleyJoint.prototype.b2PulleyJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_ground = this.m_bodyA.m_world.m_groundBody;
      this.m_groundAnchor1.x = def.groundAnchorA.x - this.m_ground.m_xf.position.x;
      this.m_groundAnchor1.y = def.groundAnchorA.y - this.m_ground.m_xf.position.y;
      this.m_groundAnchor2.x = def.groundAnchorB.x - this.m_ground.m_xf.position.x;
      this.m_groundAnchor2.y = def.groundAnchorB.y - this.m_ground.m_xf.position.y;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_ratio = def.ratio;
      this.m_constant = def.lengthA + this.m_ratio * def.lengthB;
      this.m_maxLength1 = b2Math.Min(def.maxLengthA, this.m_constant - this.m_ratio * b2PulleyJoint.b2_minPulleyLength);
      this.m_maxLength2 = b2Math.Min(def.maxLengthB, (this.m_constant - b2PulleyJoint.b2_minPulleyLength) / this.m_ratio);
      this.m_impulse = 0.0;
      this.m_limitImpulse1 = 0.0;
      this.m_limitImpulse2 = 0.0;
   }
   b2PulleyJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var p1X = bA.m_sweep.c.x + r1X;
      var p1Y = bA.m_sweep.c.y + r1Y;
      var p2X = bB.m_sweep.c.x + r2X;
      var p2Y = bB.m_sweep.c.y + r2Y;
      var s1X = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x;
      var s1Y = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y;
      var s2X = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x;
      var s2Y = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
      this.m_u1.Set(p1X - s1X, p1Y - s1Y);
      this.m_u2.Set(p2X - s2X, p2Y - s2Y);
      var length1 = this.m_u1.Length();
      var length2 = this.m_u2.Length();
      if (length1 > b2Settings.b2_linearSlop) {
         this.m_u1.Multiply(1.0 / length1);
      }
      else {
         this.m_u1.SetZero();
      }
      if (length2 > b2Settings.b2_linearSlop) {
         this.m_u2.Multiply(1.0 / length2);
      }
      else {
         this.m_u2.SetZero();
      }
      var C = this.m_constant - length1 - this.m_ratio * length2;
      if (C > 0.0) {
         this.m_state = b2Joint.e_inactiveLimit;
         this.m_impulse = 0.0;
      }
      else {
         this.m_state = b2Joint.e_atUpperLimit;
      }
      if (length1 < this.m_maxLength1) {
         this.m_limitState1 = b2Joint.e_inactiveLimit;
         this.m_limitImpulse1 = 0.0;
      }
      else {
         this.m_limitState1 = b2Joint.e_atUpperLimit;
      }
      if (length2 < this.m_maxLength2) {
         this.m_limitState2 = b2Joint.e_inactiveLimit;
         this.m_limitImpulse2 = 0.0;
      }
      else {
         this.m_limitState2 = b2Joint.e_atUpperLimit;
      }
      var cr1u1 = r1X * this.m_u1.y - r1Y * this.m_u1.x;
      var cr2u2 = r2X * this.m_u2.y - r2Y * this.m_u2.x;
      this.m_limitMass1 = bA.m_invMass + bA.m_invI * cr1u1 * cr1u1;
      this.m_limitMass2 = bB.m_invMass + bB.m_invI * cr2u2 * cr2u2;
      this.m_pulleyMass = this.m_limitMass1 + this.m_ratio * this.m_ratio * this.m_limitMass2;
      this.m_limitMass1 = 1.0 / this.m_limitMass1;
      this.m_limitMass2 = 1.0 / this.m_limitMass2;
      this.m_pulleyMass = 1.0 / this.m_pulleyMass;
      if (step.warmStarting) {
         this.m_impulse *= step.dtRatio;
         this.m_limitImpulse1 *= step.dtRatio;
         this.m_limitImpulse2 *= step.dtRatio;
         var P1X = ((-this.m_impulse) - this.m_limitImpulse1) * this.m_u1.x;
         var P1Y = ((-this.m_impulse) - this.m_limitImpulse1) * this.m_u1.y;
         var P2X = ((-this.m_ratio * this.m_impulse) - this.m_limitImpulse2) * this.m_u2.x;
         var P2Y = ((-this.m_ratio * this.m_impulse) - this.m_limitImpulse2) * this.m_u2.y;
         bA.m_linearVelocity.x += bA.m_invMass * P1X;
         bA.m_linearVelocity.y += bA.m_invMass * P1Y;
         bA.m_angularVelocity += bA.m_invI * (r1X * P1Y - r1Y * P1X);
         bB.m_linearVelocity.x += bB.m_invMass * P2X;
         bB.m_linearVelocity.y += bB.m_invMass * P2Y;
         bB.m_angularVelocity += bB.m_invI * (r2X * P2Y - r2Y * P2X);
      }
      else {
         this.m_impulse = 0.0;
         this.m_limitImpulse1 = 0.0;
         this.m_limitImpulse2 = 0.0;
      }
   }
   b2PulleyJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var v1X = 0;
      var v1Y = 0;
      var v2X = 0;
      var v2Y = 0;
      var P1X = 0;
      var P1Y = 0;
      var P2X = 0;
      var P2Y = 0;
      var Cdot = 0;
      var impulse = 0;
      var oldImpulse = 0;
      if (this.m_state == b2Joint.e_atUpperLimit) {
         v1X = bA.m_linearVelocity.x + ((-bA.m_angularVelocity * r1Y));
         v1Y = bA.m_linearVelocity.y + (bA.m_angularVelocity * r1X);
         v2X = bB.m_linearVelocity.x + ((-bB.m_angularVelocity * r2Y));
         v2Y = bB.m_linearVelocity.y + (bB.m_angularVelocity * r2X);
         Cdot = (-(this.m_u1.x * v1X + this.m_u1.y * v1Y)) - this.m_ratio * (this.m_u2.x * v2X + this.m_u2.y * v2Y);
         impulse = this.m_pulleyMass * ((-Cdot));
         oldImpulse = this.m_impulse;
         this.m_impulse = b2Math.Max(0.0, this.m_impulse + impulse);
         impulse = this.m_impulse - oldImpulse;
         P1X = (-impulse * this.m_u1.x);
         P1Y = (-impulse * this.m_u1.y);
         P2X = (-this.m_ratio * impulse * this.m_u2.x);
         P2Y = (-this.m_ratio * impulse * this.m_u2.y);
         bA.m_linearVelocity.x += bA.m_invMass * P1X;
         bA.m_linearVelocity.y += bA.m_invMass * P1Y;
         bA.m_angularVelocity += bA.m_invI * (r1X * P1Y - r1Y * P1X);
         bB.m_linearVelocity.x += bB.m_invMass * P2X;
         bB.m_linearVelocity.y += bB.m_invMass * P2Y;
         bB.m_angularVelocity += bB.m_invI * (r2X * P2Y - r2Y * P2X);
      }
      if (this.m_limitState1 == b2Joint.e_atUpperLimit) {
         v1X = bA.m_linearVelocity.x + ((-bA.m_angularVelocity * r1Y));
         v1Y = bA.m_linearVelocity.y + (bA.m_angularVelocity * r1X);
         Cdot = (-(this.m_u1.x * v1X + this.m_u1.y * v1Y));
         impulse = (-this.m_limitMass1 * Cdot);
         oldImpulse = this.m_limitImpulse1;
         this.m_limitImpulse1 = b2Math.Max(0.0, this.m_limitImpulse1 + impulse);
         impulse = this.m_limitImpulse1 - oldImpulse;
         P1X = (-impulse * this.m_u1.x);
         P1Y = (-impulse * this.m_u1.y);
         bA.m_linearVelocity.x += bA.m_invMass * P1X;
         bA.m_linearVelocity.y += bA.m_invMass * P1Y;
         bA.m_angularVelocity += bA.m_invI * (r1X * P1Y - r1Y * P1X);
      }
      if (this.m_limitState2 == b2Joint.e_atUpperLimit) {
         v2X = bB.m_linearVelocity.x + ((-bB.m_angularVelocity * r2Y));
         v2Y = bB.m_linearVelocity.y + (bB.m_angularVelocity * r2X);
         Cdot = (-(this.m_u2.x * v2X + this.m_u2.y * v2Y));
         impulse = (-this.m_limitMass2 * Cdot);
         oldImpulse = this.m_limitImpulse2;
         this.m_limitImpulse2 = b2Math.Max(0.0, this.m_limitImpulse2 + impulse);
         impulse = this.m_limitImpulse2 - oldImpulse;
         P2X = (-impulse * this.m_u2.x);
         P2Y = (-impulse * this.m_u2.y);
         bB.m_linearVelocity.x += bB.m_invMass * P2X;
         bB.m_linearVelocity.y += bB.m_invMass * P2Y;
         bB.m_angularVelocity += bB.m_invI * (r2X * P2Y - r2Y * P2X);
      }
   }
   b2PulleyJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var s1X = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x;
      var s1Y = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y;
      var s2X = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x;
      var s2Y = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
      var r1X = 0;
      var r1Y = 0;
      var r2X = 0;
      var r2Y = 0;
      var p1X = 0;
      var p1Y = 0;
      var p2X = 0;
      var p2Y = 0;
      var length1 = 0;
      var length2 = 0;
      var C = 0;
      var impulse = 0;
      var oldImpulse = 0;
      var oldLimitPositionImpulse = 0;
      var tX = 0;
      var linearError = 0.0;
      if (this.m_state == b2Joint.e_atUpperLimit) {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         p1X = bA.m_sweep.c.x + r1X;
         p1Y = bA.m_sweep.c.y + r1Y;
         p2X = bB.m_sweep.c.x + r2X;
         p2Y = bB.m_sweep.c.y + r2Y;
         this.m_u1.Set(p1X - s1X, p1Y - s1Y);
         this.m_u2.Set(p2X - s2X, p2Y - s2Y);
         length1 = this.m_u1.Length();
         length2 = this.m_u2.Length();
         if (length1 > b2Settings.b2_linearSlop) {
            this.m_u1.Multiply(1.0 / length1);
         }
         else {
            this.m_u1.SetZero();
         }
         if (length2 > b2Settings.b2_linearSlop) {
            this.m_u2.Multiply(1.0 / length2);
         }
         else {
            this.m_u2.SetZero();
         }
         C = this.m_constant - length1 - this.m_ratio * length2;
         linearError = b2Math.Max(linearError, (-C));
         C = b2Math.Clamp(C + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
         impulse = (-this.m_pulleyMass * C);
         p1X = (-impulse * this.m_u1.x);
         p1Y = (-impulse * this.m_u1.y);
         p2X = (-this.m_ratio * impulse * this.m_u2.x);
         p2Y = (-this.m_ratio * impulse * this.m_u2.y);
         bA.m_sweep.c.x += bA.m_invMass * p1X;
         bA.m_sweep.c.y += bA.m_invMass * p1Y;
         bA.m_sweep.a += bA.m_invI * (r1X * p1Y - r1Y * p1X);
         bB.m_sweep.c.x += bB.m_invMass * p2X;
         bB.m_sweep.c.y += bB.m_invMass * p2Y;
         bB.m_sweep.a += bB.m_invI * (r2X * p2Y - r2Y * p2X);
         bA.SynchronizeTransform();
         bB.SynchronizeTransform();
      }
      if (this.m_limitState1 == b2Joint.e_atUpperLimit) {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         p1X = bA.m_sweep.c.x + r1X;
         p1Y = bA.m_sweep.c.y + r1Y;
         this.m_u1.Set(p1X - s1X, p1Y - s1Y);
         length1 = this.m_u1.Length();
         if (length1 > b2Settings.b2_linearSlop) {
            this.m_u1.x *= 1.0 / length1;
            this.m_u1.y *= 1.0 / length1;
         }
         else {
            this.m_u1.SetZero();
         }
         C = this.m_maxLength1 - length1;
         linearError = b2Math.Max(linearError, (-C));
         C = b2Math.Clamp(C + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
         impulse = (-this.m_limitMass1 * C);
         p1X = (-impulse * this.m_u1.x);
         p1Y = (-impulse * this.m_u1.y);
         bA.m_sweep.c.x += bA.m_invMass * p1X;
         bA.m_sweep.c.y += bA.m_invMass * p1Y;
         bA.m_sweep.a += bA.m_invI * (r1X * p1Y - r1Y * p1X);
         bA.SynchronizeTransform();
      }
      if (this.m_limitState2 == b2Joint.e_atUpperLimit) {
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         p2X = bB.m_sweep.c.x + r2X;
         p2Y = bB.m_sweep.c.y + r2Y;
         this.m_u2.Set(p2X - s2X, p2Y - s2Y);
         length2 = this.m_u2.Length();
         if (length2 > b2Settings.b2_linearSlop) {
            this.m_u2.x *= 1.0 / length2;
            this.m_u2.y *= 1.0 / length2;
         }
         else {
            this.m_u2.SetZero();
         }
         C = this.m_maxLength2 - length2;
         linearError = b2Math.Max(linearError, (-C));
         C = b2Math.Clamp(C + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
         impulse = (-this.m_limitMass2 * C);
         p2X = (-impulse * this.m_u2.x);
         p2Y = (-impulse * this.m_u2.y);
         bB.m_sweep.c.x += bB.m_invMass * p2X;
         bB.m_sweep.c.y += bB.m_invMass * p2Y;
         bB.m_sweep.a += bB.m_invI * (r2X * p2Y - r2Y * p2X);
         bB.SynchronizeTransform();
      }
      return linearError < b2Settings.b2_linearSlop;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength = 2.0;
   });
   Box2D.inherit(b2PulleyJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2PulleyJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2PulleyJointDef.b2PulleyJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.groundAnchorA = new b2Vec2();
      this.groundAnchorB = new b2Vec2();
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2PulleyJointDef.prototype.b2PulleyJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_pulleyJoint;
      this.groundAnchorA.Set((-1.0), 1.0);
      this.groundAnchorB.Set(1.0, 1.0);
      this.localAnchorA.Set((-1.0), 0.0);
      this.localAnchorB.Set(1.0, 0.0);
      this.lengthA = 0.0;
      this.maxLengthA = 0.0;
      this.lengthB = 0.0;
      this.maxLengthB = 0.0;
      this.ratio = 1.0;
      this.collideConnected = true;
   }
   b2PulleyJointDef.prototype.Initialize = function (bA, bB, gaA, gaB, anchorA, anchorB, r) {
      if (r === undefined) r = 0;
      this.bodyA = bA;
      this.bodyB = bB;
      this.groundAnchorA.SetV(gaA);
      this.groundAnchorB.SetV(gaB);
      this.localAnchorA = this.bodyA.GetLocalPoint(anchorA);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchorB);
      var d1X = anchorA.x - gaA.x;
      var d1Y = anchorA.y - gaA.y;
      this.lengthA = Math.sqrt(d1X * d1X + d1Y * d1Y);
      var d2X = anchorB.x - gaB.x;
      var d2Y = anchorB.y - gaB.y;
      this.lengthB = Math.sqrt(d2X * d2X + d2Y * d2Y);
      this.ratio = r;
      var C = this.lengthA + this.ratio * this.lengthB;
      this.maxLengthA = C - this.ratio * b2PulleyJoint.b2_minPulleyLength;
      this.maxLengthB = (C - b2PulleyJoint.b2_minPulleyLength) / this.ratio;
   }
   Box2D.inherit(b2RevoluteJoint, Box2D.Dynamics.Joints.b2Joint);
   b2RevoluteJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2RevoluteJoint.b2RevoluteJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.K = new b2Mat22();
      this.K1 = new b2Mat22();
      this.K2 = new b2Mat22();
      this.K3 = new b2Mat22();
      this.impulse3 = new b2Vec3();
      this.impulse2 = new b2Vec2();
      this.reduced = new b2Vec2();
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_impulse = new b2Vec3();
      this.m_mass = new b2Mat33();
   };
   b2RevoluteJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2RevoluteJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2RevoluteJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse.x, inv_dt * this.m_impulse.y);
   }
   b2RevoluteJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.z;
   }
   b2RevoluteJoint.prototype.GetJointAngle = function () {
      return this.m_bodyB.m_sweep.a - this.m_bodyA.m_sweep.a - this.m_referenceAngle;
   }
   b2RevoluteJoint.prototype.GetJointSpeed = function () {
      return this.m_bodyB.m_angularVelocity - this.m_bodyA.m_angularVelocity;
   }
   b2RevoluteJoint.prototype.IsLimitEnabled = function () {
      return this.m_enableLimit;
   }
   b2RevoluteJoint.prototype.EnableLimit = function (flag) {
      this.m_enableLimit = flag;
   }
   b2RevoluteJoint.prototype.GetLowerLimit = function () {
      return this.m_lowerAngle;
   }
   b2RevoluteJoint.prototype.GetUpperLimit = function () {
      return this.m_upperAngle;
   }
   b2RevoluteJoint.prototype.SetLimits = function (lower, upper) {
      if (lower === undefined) lower = 0;
      if (upper === undefined) upper = 0;
      this.m_lowerAngle = lower;
      this.m_upperAngle = upper;
   }
   b2RevoluteJoint.prototype.IsMotorEnabled = function () {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      return this.m_enableMotor;
   }
   b2RevoluteJoint.prototype.EnableMotor = function (flag) {
      this.m_enableMotor = flag;
   }
   b2RevoluteJoint.prototype.SetMotorSpeed = function (speed) {
      if (speed === undefined) speed = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_motorSpeed = speed;
   }
   b2RevoluteJoint.prototype.GetMotorSpeed = function () {
      return this.m_motorSpeed;
   }
   b2RevoluteJoint.prototype.SetMaxMotorTorque = function (torque) {
      if (torque === undefined) torque = 0;
      this.m_maxMotorTorque = torque;
   }
   b2RevoluteJoint.prototype.GetMotorTorque = function () {
      return this.m_maxMotorTorque;
   }
   b2RevoluteJoint.prototype.b2RevoluteJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_referenceAngle = def.referenceAngle;
      this.m_impulse.SetZero();
      this.m_motorImpulse = 0.0;
      this.m_lowerAngle = def.lowerAngle;
      this.m_upperAngle = def.upperAngle;
      this.m_maxMotorTorque = def.maxMotorTorque;
      this.m_motorSpeed = def.motorSpeed;
      this.m_enableLimit = def.enableLimit;
      this.m_enableMotor = def.enableMotor;
      this.m_limitState = b2Joint.e_inactiveLimit;
   }
   b2RevoluteJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      if (this.m_enableMotor || this.m_enableLimit) {}
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var m1 = bA.m_invMass;
      var m2 = bB.m_invMass;
      var i1 = bA.m_invI;
      var i2 = bB.m_invI;
      this.m_mass.col1.x = m1 + m2 + r1Y * r1Y * i1 + r2Y * r2Y * i2;
      this.m_mass.col2.x = (-r1Y * r1X * i1) - r2Y * r2X * i2;
      this.m_mass.col3.x = (-r1Y * i1) - r2Y * i2;
      this.m_mass.col1.y = this.m_mass.col2.x;
      this.m_mass.col2.y = m1 + m2 + r1X * r1X * i1 + r2X * r2X * i2;
      this.m_mass.col3.y = r1X * i1 + r2X * i2;
      this.m_mass.col1.z = this.m_mass.col3.x;
      this.m_mass.col2.z = this.m_mass.col3.y;
      this.m_mass.col3.z = i1 + i2;
      this.m_motorMass = 1.0 / (i1 + i2);
      if (this.m_enableMotor == false) {
         this.m_motorImpulse = 0.0;
      }
      if (this.m_enableLimit) {
         var jointAngle = bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
         if (b2Math.Abs(this.m_upperAngle - this.m_lowerAngle) < 2.0 * b2Settings.b2_angularSlop) {
            this.m_limitState = b2Joint.e_equalLimits;
         }
         else if (jointAngle <= this.m_lowerAngle) {
            if (this.m_limitState != b2Joint.e_atLowerLimit) {
               this.m_impulse.z = 0.0;
            }
            this.m_limitState = b2Joint.e_atLowerLimit;
         }
         else if (jointAngle >= this.m_upperAngle) {
            if (this.m_limitState != b2Joint.e_atUpperLimit) {
               this.m_impulse.z = 0.0;
            }
            this.m_limitState = b2Joint.e_atUpperLimit;
         }
         else {
            this.m_limitState = b2Joint.e_inactiveLimit;
            this.m_impulse.z = 0.0;
         }
      }
      else {
         this.m_limitState = b2Joint.e_inactiveLimit;
      }
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_motorImpulse *= step.dtRatio;
         var PX = this.m_impulse.x;
         var PY = this.m_impulse.y;
         bA.m_linearVelocity.x -= m1 * PX;
         bA.m_linearVelocity.y -= m1 * PY;
         bA.m_angularVelocity -= i1 * ((r1X * PY - r1Y * PX) + this.m_motorImpulse + this.m_impulse.z);
         bB.m_linearVelocity.x += m2 * PX;
         bB.m_linearVelocity.y += m2 * PY;
         bB.m_angularVelocity += i2 * ((r2X * PY - r2Y * PX) + this.m_motorImpulse + this.m_impulse.z);
      }
      else {
         this.m_impulse.SetZero();
         this.m_motorImpulse = 0.0;
      }
   }
   b2RevoluteJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      var newImpulse = 0;
      var r1X = 0;
      var r1Y = 0;
      var r2X = 0;
      var r2Y = 0;
      var v1 = bA.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var v2 = bB.m_linearVelocity;
      var w2 = bB.m_angularVelocity;
      var m1 = bA.m_invMass;
      var m2 = bB.m_invMass;
      var i1 = bA.m_invI;
      var i2 = bB.m_invI;
      if (this.m_enableMotor && this.m_limitState != b2Joint.e_equalLimits) {
         var Cdot = w2 - w1 - this.m_motorSpeed;
         var impulse = this.m_motorMass * ((-Cdot));
         var oldImpulse = this.m_motorImpulse;
         var maxImpulse = step.dt * this.m_maxMotorTorque;
         this.m_motorImpulse = b2Math.Clamp(this.m_motorImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_motorImpulse - oldImpulse;
         w1 -= i1 * impulse;
         w2 += i2 * impulse;
      }
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         var Cdot1X = v2.x + ((-w2 * r2Y)) - v1.x - ((-w1 * r1Y));
         var Cdot1Y = v2.y + (w2 * r2X) - v1.y - (w1 * r1X);
         var Cdot2 = w2 - w1;
         this.m_mass.Solve33(this.impulse3, (-Cdot1X), (-Cdot1Y), (-Cdot2));
         if (this.m_limitState == b2Joint.e_equalLimits) {
            this.m_impulse.Add(this.impulse3);
         }
         else if (this.m_limitState == b2Joint.e_atLowerLimit) {
            newImpulse = this.m_impulse.z + this.impulse3.z;
            if (newImpulse < 0.0) {
               this.m_mass.Solve22(this.reduced, (-Cdot1X), (-Cdot1Y));
               this.impulse3.x = this.reduced.x;
               this.impulse3.y = this.reduced.y;
               this.impulse3.z = (-this.m_impulse.z);
               this.m_impulse.x += this.reduced.x;
               this.m_impulse.y += this.reduced.y;
               this.m_impulse.z = 0.0;
            }
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            newImpulse = this.m_impulse.z + this.impulse3.z;
            if (newImpulse > 0.0) {
               this.m_mass.Solve22(this.reduced, (-Cdot1X), (-Cdot1Y));
               this.impulse3.x = this.reduced.x;
               this.impulse3.y = this.reduced.y;
               this.impulse3.z = (-this.m_impulse.z);
               this.m_impulse.x += this.reduced.x;
               this.m_impulse.y += this.reduced.y;
               this.m_impulse.z = 0.0;
            }
         }
         v1.x -= m1 * this.impulse3.x;
         v1.y -= m1 * this.impulse3.y;
         w1 -= i1 * (r1X * this.impulse3.y - r1Y * this.impulse3.x + this.impulse3.z);
         v2.x += m2 * this.impulse3.x;
         v2.y += m2 * this.impulse3.y;
         w2 += i2 * (r2X * this.impulse3.y - r2Y * this.impulse3.x + this.impulse3.z);
      }
      else {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         var CdotX = v2.x + ((-w2 * r2Y)) - v1.x - ((-w1 * r1Y));
         var CdotY = v2.y + (w2 * r2X) - v1.y - (w1 * r1X);
         this.m_mass.Solve22(this.impulse2, (-CdotX), (-CdotY));
         this.m_impulse.x += this.impulse2.x;
         this.m_impulse.y += this.impulse2.y;
         v1.x -= m1 * this.impulse2.x;
         v1.y -= m1 * this.impulse2.y;
         w1 -= i1 * (r1X * this.impulse2.y - r1Y * this.impulse2.x);
         v2.x += m2 * this.impulse2.x;
         v2.y += m2 * this.impulse2.y;
         w2 += i2 * (r2X * this.impulse2.y - r2Y * this.impulse2.x);
      }
      bA.m_linearVelocity.SetV(v1);
      bA.m_angularVelocity = w1;
      bB.m_linearVelocity.SetV(v2);
      bB.m_angularVelocity = w2;
   }
   b2RevoluteJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var oldLimitImpulse = 0;
      var C = 0;
      var tMat;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var angularError = 0.0;
      var positionError = 0.0;
      var tX = 0;
      var impulseX = 0;
      var impulseY = 0;
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         var angle = bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
         var limitImpulse = 0.0;
         if (this.m_limitState == b2Joint.e_equalLimits) {
            C = b2Math.Clamp(angle - this.m_lowerAngle, (-b2Settings.b2_maxAngularCorrection), b2Settings.b2_maxAngularCorrection);
            limitImpulse = (-this.m_motorMass * C);
            angularError = b2Math.Abs(C);
         }
         else if (this.m_limitState == b2Joint.e_atLowerLimit) {
            C = angle - this.m_lowerAngle;
            angularError = (-C);
            C = b2Math.Clamp(C + b2Settings.b2_angularSlop, (-b2Settings.b2_maxAngularCorrection), 0.0);
            limitImpulse = (-this.m_motorMass * C);
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            C = angle - this.m_upperAngle;
            angularError = C;
            C = b2Math.Clamp(C - b2Settings.b2_angularSlop, 0.0, b2Settings.b2_maxAngularCorrection);
            limitImpulse = (-this.m_motorMass * C);
         }
         bA.m_sweep.a -= bA.m_invI * limitImpulse;
         bB.m_sweep.a += bB.m_invI * limitImpulse;
         bA.SynchronizeTransform();
         bB.SynchronizeTransform();
      } {
         tMat = bA.m_xf.R;
         var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         var CX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
         var CY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
         var CLengthSquared = CX * CX + CY * CY;
         var CLength = Math.sqrt(CLengthSquared);
         positionError = CLength;
         var invMass1 = bA.m_invMass;
         var invMass2 = bB.m_invMass;
         var invI1 = bA.m_invI;
         var invI2 = bB.m_invI;
         var k_allowedStretch = 10.0 * b2Settings.b2_linearSlop;
         if (CLengthSquared > k_allowedStretch * k_allowedStretch) {
            var uX = CX / CLength;
            var uY = CY / CLength;
            var k = invMass1 + invMass2;
            var m = 1.0 / k;
            impulseX = m * ((-CX));
            impulseY = m * ((-CY));
            var k_beta = 0.5;
            bA.m_sweep.c.x -= k_beta * invMass1 * impulseX;
            bA.m_sweep.c.y -= k_beta * invMass1 * impulseY;
            bB.m_sweep.c.x += k_beta * invMass2 * impulseX;
            bB.m_sweep.c.y += k_beta * invMass2 * impulseY;
            CX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
            CY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
         }
         this.K1.col1.x = invMass1 + invMass2;
         this.K1.col2.x = 0.0;
         this.K1.col1.y = 0.0;
         this.K1.col2.y = invMass1 + invMass2;
         this.K2.col1.x = invI1 * r1Y * r1Y;
         this.K2.col2.x = (-invI1 * r1X * r1Y);
         this.K2.col1.y = (-invI1 * r1X * r1Y);
         this.K2.col2.y = invI1 * r1X * r1X;
         this.K3.col1.x = invI2 * r2Y * r2Y;
         this.K3.col2.x = (-invI2 * r2X * r2Y);
         this.K3.col1.y = (-invI2 * r2X * r2Y);
         this.K3.col2.y = invI2 * r2X * r2X;
         this.K.SetM(this.K1);
         this.K.AddM(this.K2);
         this.K.AddM(this.K3);
         this.K.Solve(b2RevoluteJoint.tImpulse, (-CX), (-CY));
         impulseX = b2RevoluteJoint.tImpulse.x;
         impulseY = b2RevoluteJoint.tImpulse.y;
         bA.m_sweep.c.x -= bA.m_invMass * impulseX;
         bA.m_sweep.c.y -= bA.m_invMass * impulseY;
         bA.m_sweep.a -= bA.m_invI * (r1X * impulseY - r1Y * impulseX);
         bB.m_sweep.c.x += bB.m_invMass * impulseX;
         bB.m_sweep.c.y += bB.m_invMass * impulseY;
         bB.m_sweep.a += bB.m_invI * (r2X * impulseY - r2Y * impulseX);
         bA.SynchronizeTransform();
         bB.SynchronizeTransform();
      }
      return positionError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse = new b2Vec2();
   });
   Box2D.inherit(b2RevoluteJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2RevoluteJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2RevoluteJointDef.b2RevoluteJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2RevoluteJointDef.prototype.b2RevoluteJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_revoluteJoint;
      this.localAnchorA.Set(0.0, 0.0);
      this.localAnchorB.Set(0.0, 0.0);
      this.referenceAngle = 0.0;
      this.lowerAngle = 0.0;
      this.upperAngle = 0.0;
      this.maxMotorTorque = 0.0;
      this.motorSpeed = 0.0;
      this.enableLimit = false;
      this.enableMotor = false;
   }
   b2RevoluteJointDef.prototype.Initialize = function (bA, bB, anchor) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA = this.bodyA.GetLocalPoint(anchor);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchor);
      this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
   }
   Box2D.inherit(b2WeldJoint, Box2D.Dynamics.Joints.b2Joint);
   b2WeldJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2WeldJoint.b2WeldJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchorA = new b2Vec2();
      this.m_localAnchorB = new b2Vec2();
      this.m_impulse = new b2Vec3();
      this.m_mass = new b2Mat33();
   };
   b2WeldJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
   }
   b2WeldJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
   }
   b2WeldJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse.x, inv_dt * this.m_impulse.y);
   }
   b2WeldJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.z;
   }
   b2WeldJoint.prototype.b2WeldJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_localAnchorA.SetV(def.localAnchorA);
      this.m_localAnchorB.SetV(def.localAnchorB);
      this.m_referenceAngle = def.referenceAngle;
      this.m_impulse.SetZero();
      this.m_mass = new b2Mat33();
   }
   b2WeldJoint.prototype.InitVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      this.m_mass.col1.x = mA + mB + rAY * rAY * iA + rBY * rBY * iB;
      this.m_mass.col2.x = (-rAY * rAX * iA) - rBY * rBX * iB;
      this.m_mass.col3.x = (-rAY * iA) - rBY * iB;
      this.m_mass.col1.y = this.m_mass.col2.x;
      this.m_mass.col2.y = mA + mB + rAX * rAX * iA + rBX * rBX * iB;
      this.m_mass.col3.y = rAX * iA + rBX * iB;
      this.m_mass.col1.z = this.m_mass.col3.x;
      this.m_mass.col2.z = this.m_mass.col3.y;
      this.m_mass.col3.z = iA + iB;
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_impulse.z *= step.dtRatio;
         bA.m_linearVelocity.x -= mA * this.m_impulse.x;
         bA.m_linearVelocity.y -= mA * this.m_impulse.y;
         bA.m_angularVelocity -= iA * (rAX * this.m_impulse.y - rAY * this.m_impulse.x + this.m_impulse.z);
         bB.m_linearVelocity.x += mB * this.m_impulse.x;
         bB.m_linearVelocity.y += mB * this.m_impulse.y;
         bB.m_angularVelocity += iB * (rBX * this.m_impulse.y - rBY * this.m_impulse.x + this.m_impulse.z);
      }
      else {
         this.m_impulse.SetZero();
      }
   }
   b2WeldJoint.prototype.SolveVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var vA = bA.m_linearVelocity;
      var wA = bA.m_angularVelocity;
      var vB = bB.m_linearVelocity;
      var wB = bB.m_angularVelocity;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var Cdot1X = vB.x - wB * rBY - vA.x + wA * rAY;
      var Cdot1Y = vB.y + wB * rBX - vA.y - wA * rAX;
      var Cdot2 = wB - wA;
      var impulse = new b2Vec3();
      this.m_mass.Solve33(impulse, (-Cdot1X), (-Cdot1Y), (-Cdot2));
      this.m_impulse.Add(impulse);
      vA.x -= mA * impulse.x;
      vA.y -= mA * impulse.y;
      wA -= iA * (rAX * impulse.y - rAY * impulse.x + impulse.z);
      vB.x += mB * impulse.x;
      vB.y += mB * impulse.y;
      wB += iB * (rBX * impulse.y - rBY * impulse.x + impulse.z);
      bA.m_angularVelocity = wA;
      bB.m_angularVelocity = wB;
   }
   b2WeldJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      var C1X = bB.m_sweep.c.x + rBX - bA.m_sweep.c.x - rAX;
      var C1Y = bB.m_sweep.c.y + rBY - bA.m_sweep.c.y - rAY;
      var C2 = bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
      var k_allowedStretch = 10.0 * b2Settings.b2_linearSlop;
      var positionError = Math.sqrt(C1X * C1X + C1Y * C1Y);
      var angularError = b2Math.Abs(C2);
      if (positionError > k_allowedStretch) {
         iA *= 1.0;
         iB *= 1.0;
      }
      this.m_mass.col1.x = mA + mB + rAY * rAY * iA + rBY * rBY * iB;
      this.m_mass.col2.x = (-rAY * rAX * iA) - rBY * rBX * iB;
      this.m_mass.col3.x = (-rAY * iA) - rBY * iB;
      this.m_mass.col1.y = this.m_mass.col2.x;
      this.m_mass.col2.y = mA + mB + rAX * rAX * iA + rBX * rBX * iB;
      this.m_mass.col3.y = rAX * iA + rBX * iB;
      this.m_mass.col1.z = this.m_mass.col3.x;
      this.m_mass.col2.z = this.m_mass.col3.y;
      this.m_mass.col3.z = iA + iB;
      var impulse = new b2Vec3();
      this.m_mass.Solve33(impulse, (-C1X), (-C1Y), (-C2));
      bA.m_sweep.c.x -= mA * impulse.x;
      bA.m_sweep.c.y -= mA * impulse.y;
      bA.m_sweep.a -= iA * (rAX * impulse.y - rAY * impulse.x + impulse.z);
      bB.m_sweep.c.x += mB * impulse.x;
      bB.m_sweep.c.y += mB * impulse.y;
      bB.m_sweep.a += iB * (rBX * impulse.y - rBY * impulse.x + impulse.z);
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return positionError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.inherit(b2WeldJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2WeldJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2WeldJointDef.b2WeldJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2WeldJointDef.prototype.b2WeldJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_weldJoint;
      this.referenceAngle = 0.0;
   }
   b2WeldJointDef.prototype.Initialize = function (bA, bB, anchor) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA.SetV(this.bodyA.GetLocalPoint(anchor));
      this.localAnchorB.SetV(this.bodyB.GetLocalPoint(anchor));
      this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
   }
})();
(function () {
   var b2DebugDraw = Box2D.Dynamics.b2DebugDraw;
   b2DebugDraw.b2DebugDraw = function () {
      this.m_drawScale = 1.0;
      this.m_lineThickness = 1.0;
      this.m_alpha = 1.0;
      this.m_fillAlpha = 1.0;
      this.m_xformScale = 1.0;
      var __this = this;
      //#WORKAROUND
      this.m_sprite = {
         graphics: {
            clear: function () {
               __this.m_ctx.clearRect(0, 0, __this.m_ctx.canvas.width, __this.m_ctx.canvas.height)
            }
         }
      };
   };
   b2DebugDraw.prototype._color = function (color, alpha) {
      return "rgba(" + ((color & 0xFF0000) >> 16) + "," + ((color & 0xFF00) >> 8) + "," + (color & 0xFF) + "," + alpha + ")";
   };
   b2DebugDraw.prototype.b2DebugDraw = function () {
      this.m_drawFlags = 0;
   };
   b2DebugDraw.prototype.SetFlags = function (flags) {
      if (flags === undefined) flags = 0;
      this.m_drawFlags = flags;
   };
   b2DebugDraw.prototype.GetFlags = function () {
      return this.m_drawFlags;
   };
   b2DebugDraw.prototype.AppendFlags = function (flags) {
      if (flags === undefined) flags = 0;
      this.m_drawFlags |= flags;
   };
   b2DebugDraw.prototype.ClearFlags = function (flags) {
      if (flags === undefined) flags = 0;
      this.m_drawFlags &= ~flags;
   };
   b2DebugDraw.prototype.SetSprite = function (sprite) {
      this.m_ctx = sprite;
   };
   b2DebugDraw.prototype.GetSprite = function () {
      return this.m_ctx;
   };
   b2DebugDraw.prototype.SetDrawScale = function (drawScale) {
      if (drawScale === undefined) drawScale = 0;
      this.m_drawScale = drawScale;
   };
   b2DebugDraw.prototype.GetDrawScale = function () {
      return this.m_drawScale;
   };
   b2DebugDraw.prototype.SetLineThickness = function (lineThickness) {
      if (lineThickness === undefined) lineThickness = 0;
      this.m_lineThickness = lineThickness;
      this.m_ctx.strokeWidth = lineThickness;
   };
   b2DebugDraw.prototype.GetLineThickness = function () {
      return this.m_lineThickness;
   };
   b2DebugDraw.prototype.SetAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
      this.m_alpha = alpha;
   };
   b2DebugDraw.prototype.GetAlpha = function () {
      return this.m_alpha;
   };
   b2DebugDraw.prototype.SetFillAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
      this.m_fillAlpha = alpha;
   };
   b2DebugDraw.prototype.GetFillAlpha = function () {
      return this.m_fillAlpha;
   };
   b2DebugDraw.prototype.SetXFormScale = function (xformScale) {
      if (xformScale === undefined) xformScale = 0;
      this.m_xformScale = xformScale;
   };
   b2DebugDraw.prototype.GetXFormScale = function () {
      return this.m_xformScale;
   };
   b2DebugDraw.prototype.DrawPolygon = function (vertices, vertexCount, color) {
      if (!vertexCount) return;
      var s = this.m_ctx;
      var drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.moveTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      for (var i = 1; i < vertexCount; i++) {
         s.lineTo(vertices[i].x * drawScale, vertices[i].y * drawScale);
      }
      s.lineTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      s.closePath();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawSolidPolygon = function (vertices, vertexCount, color) {
      if (!vertexCount) return;
      var s = this.m_ctx;
      var drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.fillStyle = this._color(color.color, this.m_fillAlpha);
      s.moveTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      for (var i = 1; i < vertexCount; i++) {
         s.lineTo(vertices[i].x * drawScale, vertices[i].y * drawScale);
      }
      s.lineTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      s.closePath();
      s.fill();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawCircle = function (center, radius, color) {
      if (!radius) return;
      var s = this.m_ctx;
      var drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.arc(center.x * drawScale, center.y * drawScale, radius * drawScale, 0, Math.PI * 2, true);
      s.closePath();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawSolidCircle = function (center, radius, axis, color) {
      if (!radius) return;
      var s = this.m_ctx,
         drawScale = this.m_drawScale,
         cx = center.x * drawScale,
         cy = center.y * drawScale;
      s.moveTo(0, 0);
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.fillStyle = this._color(color.color, this.m_fillAlpha);
      s.arc(cx, cy, radius * drawScale, 0, Math.PI * 2, true);
      s.moveTo(cx, cy);
      s.lineTo((center.x + axis.x * radius) * drawScale, (center.y + axis.y * radius) * drawScale);
      s.closePath();
      s.fill();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawSegment = function (p1, p2, color) {
      var s = this.m_ctx,
         drawScale = this.m_drawScale;
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.beginPath();
      s.moveTo(p1.x * drawScale, p1.y * drawScale);
      s.lineTo(p2.x * drawScale, p2.y * drawScale);
      s.closePath();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawTransform = function (xf) {
      var s = this.m_ctx,
         drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(0xff0000, this.m_alpha);
      s.moveTo(xf.position.x * drawScale, xf.position.y * drawScale);
      s.lineTo((xf.position.x + this.m_xformScale * xf.R.col1.x) * drawScale, (xf.position.y + this.m_xformScale * xf.R.col1.y) * drawScale);

      s.strokeStyle = this._color(0xff00, this.m_alpha);
      s.moveTo(xf.position.x * drawScale, xf.position.y * drawScale);
      s.lineTo((xf.position.x + this.m_xformScale * xf.R.col2.x) * drawScale, (xf.position.y + this.m_xformScale * xf.R.col2.y) * drawScale);
      s.closePath();
      s.stroke();
   };
})();
var i;
for (i = 0; i < Box2D.postDefs.length; ++i) Box2D.postDefs[i]();

module.exports = Box2D
},{}]},{},["C:\\Users\\Sean\\Documents\\game_dev\\Infinite Sidescroller\\GameCode\\main.js"])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL0FwcERhdGEvUm9hbWluZy9ucG0vbm9kZV9tb2R1bGVzL3dhdGNoaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJCMmQuanMiLCJDb25maWcuanMiLCJDb250cm9sbGVycy9Bc3NldENvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9FbmVteUNvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9HYW1lQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0dyYXBoaWNzQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0lkZW50aWZpY2F0aW9uQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0luaXRDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvS2V5Ym9hcmRDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvUGh5c2ljc0NvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9SZWdpc3RlckFzQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1RlcnJhaW5Db250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvVGVycmFpblNsaWNlQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1Rlc3RDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvV29ybGRDb250cm9sbGVyLmpzIiwiR2FtZVV0aWxpdHkuanMiLCJJbmNsdWRlcy5qcyIsIkxvZ2ljL0FudExvZ2ljLmpzIiwiTG9naWMvSGVyb0xvZ2ljLmpzIiwiTW9kZWxzL0Fzc2V0TW9kZWwuanMiLCJNb2RlbHMvRW5lbXlNb2RlbC5qcyIsIk1vZGVscy9HYW1lTW9kZWwuanMiLCJNb2RlbHMvR3JhcGhpY3NNb2RlbC5qcyIsIk1vZGVscy9JZGVudGlmaWNhdGlvbk1vZGVsLmpzIiwiTW9kZWxzL0tleWJvYXJkTW9kZWwuanMiLCJNb2RlbHMvUGh5c2ljc01vZGVsLmpzIiwiTW9kZWxzL1JlZ2lzdGVyQXNNb2RlbC5qcyIsIk1vZGVscy9UZXJyYWluTW9kZWwuanMiLCJNb2RlbHMvVGVycmFpblNsaWNlTW9kZWwuanMiLCJNb2RlbHMvVGVzdE1vZGVsLmpzIiwiTW9kZWxzL1dvcmxkTW9kZWwuanMiLCJSZW5kZXJlcnMvQW50UmVuZGVyZXIuanMiLCJSZW5kZXJlcnMvSGVyb1JlbmRlcmVyLmpzIiwibWFpbi5qcyIsIm5vZGVfbW9kdWxlcy9ib3gyZHdlYi9ib3gyZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3b0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdlNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0tBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIFRoaXMgZmlsZSBjb250YWlucyBzaG9ydGN1dHMgZm9yIHRoZSBtZXRob2RzIG9mIHRoZSBCb3gyRCBsaWJyYXJ5IHRoYXQgYXJlIHVzZWRcclxuLy8gdG9vIG9mdGVuIHRvIHR5cGUgdGhlaXIgbG9uZyBuYW1lc1xyXG5cclxudmFyIEIyZCA9IGZ1bmN0aW9uKCl7XHJcblxyXG59O1xyXG5cclxuQjJkLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKXtcclxuXHRpbmNsdWRlKCk7XHJcblxyXG5cdHRoaXMuYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyO1xyXG5cdHRoaXMuYjJCb2R5RGVmID0gQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmO1xyXG5cdHRoaXMuYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5O1xyXG5cdHRoaXMuYjJGaXh0dXJlRGVmID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmO1xyXG5cdHRoaXMuYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlO1xyXG5cdHRoaXMuYjJXb3JsZCA9IEJveDJELkR5bmFtaWNzLmIyV29ybGQ7XHJcblx0dGhpcy5iMk1hc3NEYXRhID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMk1hc3NEYXRhO1xyXG5cdHRoaXMuYjJQb2x5Z29uU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyUG9seWdvblNoYXBlO1xyXG5cdHRoaXMuYjJDaXJjbGVTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZTtcclxuXHR0aGlzLmIyRGVidWdEcmF3ID0gQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXc7IFxyXG5cdHRoaXMuYjJDb250YWN0TGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lcjtcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBCMmQ7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkIyZFwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuT1RIRVJfU1RVRkZcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwidmFyIENvbmZpZyA9IGZ1bmN0aW9uKCl7XHJcblx0dGhpcy5TQ1JFRU5fVyA9IDA7IC8vIHNldCB1cCB3aGVuIHRoZSBwYWdlIGlzIGxvYWRlZCAodG8gOTUlIG9mIHdpZHRoIG9mIGNvbnRhaW5pbmcgZWxlbWVudCkgXHJcblx0dGhpcy5TQ1JFRU5fSCA9IDYwMDtcclxuXHJcblx0dGhpcy5NQUlOX0NBTlZBU19OQU1FID0gXCJkaXNwbGF5X2NhbnZhc1wiO1xyXG5cdHRoaXMuREVCVUdfQ0FOVkFTX05BTUUgPSBcImRlYnVnX2NhbnZhc1wiO1xyXG5cclxuXHQvLyBGcmFtZXMgUGVyIFNlY29uZC4gRXNzZW50aWFsbHksIGZyZXF1ZW5jeSBvZiBjcmVhdGVqcy5UaWNrZXIgXHJcblx0Ly8gV2FybmluZyEgRnJlcXVlbmN5IG9mIHRoZSBCb3gyRCBwaHlzaWNzIHVwZGF0ZXMgbWF5IGJlIGRpZmZlcmVudFxyXG5cdC8vIChDdXJyZW50bHkgbm90IGltcGxlbWVudGVkKVxyXG5cdHRoaXMuRlBTID0gMzA7IFxyXG5cclxuXHQvLyBCb3gyRCBzdHVmZiA+Pj5cclxuXHR0aGlzLkIyRCA9IHtcclxuXHRcdFNDQUxFOiAzMCxcclxuXHRcdFNQUzogNjAsIFx0XHRcdC8vIFN0ZXBzIFBlciBTZWNvbmRcclxuXHRcdFZFTE9DSVRZX0lUUjogOCxcdC8vIHZlbG9jaXR5IGl0ZXJhdGlvbnNcclxuXHRcdFBPU0lUSU9OX0lUUjogMyxcdC8vIHBvc2l0aW9uIGl0ZXJhdGlvbnNcclxuXHRcdGRlYnVnX2RyYXc6IGZhbHNlXHJcblx0fTtcclxuXHJcblx0dGhpcy5UZXJyYWluU2xpY2UgPSB7XHJcblx0XHRncmlkX3Jvd3M6IDIwLFxyXG5cdFx0Z3JpZF9jb2x1bW5zOiAyMCxcclxuXHRcdGNlbGxfdzogMSwgLy8gaW4gbWV0ZXJzXHJcblxyXG5cdFx0Ly8gaXMgYXV0b21hdGljYWxseSBpbmNyZW1lbnRlZCBlYWNoIHRpbWUgbmV3IFRlcnJhaW5TbGljZU1vZGVsIGlzIGluc3RhbnRpYXRlZDpcclxuXHRcdG5leHRfc2xpY2VfaWQ6IDAgXHJcblx0fTtcclxuXHRcclxuXHQvLyA8PDxcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IENvbmZpZztcclxuIiwiXHJcbnZhciBBc3NldENvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKXtcclxuXHQvKlxyXG5cdCAgIEFzc2V0Q29udHJvbGxlciBpcyBpbiBjaGFyZ2Ugb2Ygc2V0dGluZyB1cCBhbGwgYml0bWFwcy9hbmltYXRpb25zL290aGVyIHJlc291cmNlc1xyXG5cdCAgIGZvciBldmVyeW9uZSBlbHNlLlxyXG4gICAqL1xyXG5cclxuXHQvLyB1c2UgQXNzZXRNb2RlbC5sb2FkZXIuZ2V0UmVzdWx0KFwiaWRfb2ZfdGhlX2Fzc2V0XCIpO1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKGFzc2V0X3BhdGgpe1xyXG5cdFx0aW5jbHVkZSgpO1x0XHJcblxyXG5cdFx0LyogVE9ETyBtYWtlIG1vZGVsIHdpdGggdGhlIGVhc2lseSBtYW5hZ2VkIHRhYmxlcyBvZiByZXNvdXJjZXMgd2hpY2ggd2lsbCBiZVxyXG5cdFx0ICAgYWRkZWQgdG8gdGhlIGxvYWRlciBhdXRvbWF0aWNhbGx5XHJcblx0XHQqL1xyXG5cclxuXHRcdC8vbG9hZGVyID0gbmV3IGNyZWF0ZWpzLkxvYWRRdWV1ZShmYWxzZSk7IC8vIGxvYWRpbmcgcmVzb3Vyc2VzIHVzaW5nIHByZWxvYWQuanNcclxuXHRcdC8vbG9hZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjb21wbGV0ZVwiLCBoYW5kbGVDb21wbGV0ZSk7XHJcblx0XHR2YXIgbWFuaWZlc3QgPSBBc3NldE1vZGVsLm1hbmlmZXN0O1x0XHJcblx0XHRBc3NldE1vZGVsLmxvYWRlci5sb2FkTWFuaWZlc3QobWFuaWZlc3QsIHRydWUsIGFzc2V0X3BhdGgpO1xyXG5cdFx0XHJcblx0fTtcclxuXHJcblx0dmFyIHBvc3RfaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiB0aGlzIGZ1bmN0aW9uIHdpbGwgYmUgZG9uZSBkaWZmZXJlbnRseSBhdCBzb21lIHBvaW50XHJcblx0XHQgKiBpdCdsbCBoYXZlIHNvbWV0aGluZyB0byBkbyB3aXRoIHJlZmFjdG9yaW5nIEluaXRDb250cm9sbGVyXHJcblx0XHQgKi9cclxuXHJcblx0XHQvL0Fzc2V0TW9kZWwuYW5pbWF0aW9uc1tcImFudFwiXSA9IG5ldyBjcmVhdGVqcy5TcHJpdGVTaGVldCh7XHJcblx0XHRcdC8vXCJmcmFtZXJhdGVcIjogMC4yLFxyXG5cdFx0XHQvL1wiaW1hZ2VzXCI6IFtnZXRfYXNzZXQoXCJBbnQxXCIpLCBnZXRfYXNzZXQoXCJBbnQyXCIpLCBnZXRfYXNzZXQoXCJBbnQzXCIpXSxcclxuXHRcdFx0Ly9cImZyYW1lc1wiOiB7IFwicmVnWFwiOiAzLCBcInJlZ1lcIjogNiwgXCJoZWlnaHRcIjogMjUsIFwid2lkdGhcIjogNTAsIFwiY291bnRcIjogNn0sXHJcblx0XHRcdC8vXCJhbmltYXRpb25zXCI6IHtcclxuXHRcdFx0XHQvL1wid2Fsa1wiOiBbMCwgMSwgXCJ3YWxrXCJdLFxyXG5cdFx0XHRcdC8vXCJ1cHNpZGVfZG93blwiOiBbMiwgMywgXCJ1cHNpZGVfZG93blwiXSxcclxuXHRcdFx0XHQvL1wiZGVhdGhcIjogWzQsIDUsIFwiZGVhdGhcIl1cclxuXHRcdFx0Ly99XHJcblx0XHQvL30pXHJcblxyXG5cdH07XHJcblx0XHJcblxyXG5cdHZhciBnZXRfYXNzZXQgPSBmdW5jdGlvbihpZCl7XHJcblxyXG5cdFx0dmFyIHJlc3VsdCA9IEFzc2V0TW9kZWwubG9hZGVyLmdldFJlc3VsdChpZCk7XHJcblxyXG5cdFx0aWYoIXJlc3VsdCl7XHJcblx0XHRcdHRocm93IFwiRXJyb3I6IGFzc2V0IHdpdGggaWQgXCIgKyBpZCArIFwiIGNvdWxkIG5vdCBiZSBsb2FkZWQuXCIgK1xyXG5cdFx0XHRcdFwiIENoZWNrIHRoYXQgaWQgaXMgdmFsaWQgYW5kIHRoYXQgYXNzZXRzIHdlcmUgcHJvcGVybHkgbG9hZGVkXCI7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiByZXN1bHQ7XHJcblx0fTtcclxuXHRcdFxyXG5cclxuXHJcblx0XHJcblx0cmV0dXJuIHtcclxuXHRcdGluaXQ6IGluaXQsXHJcblx0XHRnZXRfYXNzZXQ6IGdldF9hc3NldCxcclxuXHR9O1xyXG5cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQXNzZXRDb250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiQXNzZXRDb250cm9sbGVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUXHJcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cclxuXHJcbiIsIlxyXG52YXIgRW5lbXlDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0LyogRGVzY3JpcHRpb25cclxuXHQqL1xyXG5cclxuXHR2YXIgdHlwZV9sb2dpY190YWJsZTtcclxuXHRcclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiBpcyByYW4gZnJvbSB0aGUgSW5pdENvbnRyb2xsZXIgb25jZSB3aGVuIHRoZSBnYW1lIGlzIGxvYWRlZCAqL1xyXG5cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHNcclxuXHJcblx0XHR0eXBlX2xvZ2ljX3RhYmxlID0ge1xyXG5cdFx0XHRcImFudFwiOiBBbnRMb2dpYyxcclxuXHRcdFx0XCJoZXJvXCI6IEhlcm9Mb2dpYyxcclxuXHRcdH07XHJcblxyXG5cdFx0dmFyIGltcG9ydHMgPSB7UmVnaXN0ZXJBc0NvbnRyb2xsZXI6IFJlZ2lzdGVyQXNDb250cm9sbGVyLFxyXG5cdFx0XHRQaHlzaWNzQ29udHJvbGxlcjogUGh5c2ljc0NvbnRyb2xsZXIsXHJcblx0XHRcdElkZW50aWZpY2F0aW9uQ29udHJvbGxlcjogSWRlbnRpZmljYXRpb25Db250cm9sbGVyLFxyXG5cdFx0XHRLZXlib2FyZENvbnRyb2xsZXI6IEtleWJvYXJkQ29udHJvbGxlcixcclxuXHRcdFx0QjJkOiBCMmRcclxuXHRcdH07XHJcblxyXG5cdFx0Zm9yKHR5cGUgaW4gdHlwZV9sb2dpY190YWJsZSl7XHJcblx0XHRcdHZhciBsb2dpYyA9IHR5cGVfbG9naWNfdGFibGVbdHlwZV07XHJcblx0XHRcdGxvZ2ljLmluaXQoaW1wb3J0cyk7XHJcblxyXG5cdFx0XHRpZihsb2dpYy5iZWdpbl9jb250YWN0KXtcclxuXHRcdFx0XHRQaHlzaWNzQ29udHJvbGxlci5saXN0ZW5fZm9yX2NvbnRhY3Rfd2l0aCh0eXBlLCBcIkJlZ2luQ29udGFjdFwiLCBsb2dpYy5iZWdpbl9jb250YWN0KTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhsb2dpYyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKGxvZ2ljLmVuZF9jb250YWN0KXtcclxuXHRcdFx0XHRQaHlzaWNzQ29udHJvbGxlci5saXN0ZW5fZm9yX2NvbnRhY3Rfd2l0aCh0eXBlLCBcIkVuZENvbnRhY3RcIiwgbG9naWMuZW5kX2NvbnRhY3QpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZihsb2dpYy5wcmVfc29sdmUpe1xyXG5cdFx0XHRcdFBoeXNpY3NDb250cm9sbGVyLmxpc3Rlbl9mb3JfY29udGFjdF93aXRoKHR5cGUsIFwiUHJlU29sdmVcIiwgbG9naWMucHJlX3NvbHZlKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYobG9naWMucG9zdF9zb2x2ZSl7XHJcblx0XHRcdFx0UGh5c2ljc0NvbnRyb2xsZXIubGlzdGVuX2Zvcl9jb250YWN0X3dpdGgodHlwZSwgXCJQb3N0U29sdmVcIiwgbG9naWMucG9zdF9zb2x2ZSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblxyXG5cdFx0c3Bhd24oMTAsIDEwLCBcImhlcm9cIik7XHJcblx0fTtcclxuXHJcblx0dmFyIHNwYXduID0gZnVuY3Rpb24oeCwgeSwgdHlwZSl7XHJcblx0XHQvKipcclxuXHRcdCogc3Bhd24gZW50aXR5IG9mIHRoZSBnaXZlbiB0eXBlIGF0IHRoZSBnaXZlbiBjb29yZGluYXRlc1xyXG5cdFx0KiBhbHNvIHJlZ2lzdGVyZXMgdGhpbmcgYXMgYXdhaXRpbmcgZ3JhcGhpY3MgaW5pdGlhbGl6YXRpb25cclxuXHRcdCovXHJcblx0XHR2YXIgbG9naWMgPSB0eXBlX2xvZ2ljX3RhYmxlW3R5cGVdO1xyXG5cclxuXHRcdGlmKGxvZ2ljKXtcclxuXHRcdFx0dmFyIG5ld19lbnRpdHkgPSBsb2dpYy5zcGF3bih4LCB5KTtcclxuXHRcdFx0UmVnaXN0ZXJBc0NvbnRyb2xsZXIucmVnaXN0ZXJfYXMoXCJhd2FpdGluZ19ncmFwaGljc19pbml0aWFsaXphdGlvblwiLCBuZXdfZW50aXR5KVxyXG5cdFx0XHR2YXIgbG9naWNfdXBkX2xpc3QgPSBFbmVteU1vZGVsLmZvcl9sb2dpY191cGRhdGVbdHlwZV07XHJcblx0XHRcdGlmKGxvZ2ljX3VwZF9saXN0KXtcclxuXHRcdFx0XHRsb2dpY191cGRfbGlzdC5wdXNoKG5ld19lbnRpdHkpO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRFbmVteU1vZGVsLmZvcl9sb2dpY191cGRhdGVbdHlwZV0gPSBbbmV3X2VudGl0eV1cclxuXHRcdFx0fVxyXG5cdFx0fWVsc2V7XHJcblx0XHRcdHRocm93IFwiTG9naWMgZm9yIHRoZSB0eXBlIFwiICsgdHlwZSArIFwiIGlzIG5vdCBkZWZpbmVkXCI7XHJcblx0XHR9XHJcblx0XHRcclxuXHJcblx0fTtcclxuXHRcclxuXHJcblx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKGRlbHRhKXtcclxuXHRcdC8qIGlzIHJhbiBlYWNoIHRpY2sgZnJvbSB0aGUgR2FtZUNvbnRyb2xsZXIudXBkYXRlX2FsbCAqL1xyXG5cdFx0dmFyIGRlYnVnX2NvbW1hbmRzID0gS2V5Ym9hcmRDb250cm9sbGVyLmRlYnVnX2NvbW1hbmRzKCk7XHJcblxyXG5cdFx0Ly8gZGVtb25zdHJhdGlvbiBwdXJwb3Nlc1xyXG5cdFx0aWYoZGVidWdfY29tbWFuZHMoXCJzcGF3bl9hbnRcIikpe1xyXG5cdFx0XHR2YXIgbmV3X2FudCA9IHNwYXduKE1hdGgucmFuZG9tKCkqNTAgKyAxMCwgMTAsIFwiYW50XCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvcih2YXIgdHlwZSBpbiBFbmVteU1vZGVsLmZvcl9sb2dpY191cGRhdGUpe1xyXG5cdFx0XHR2YXIgbGlzdCA9IEVuZW15TW9kZWwuZm9yX2xvZ2ljX3VwZGF0ZVt0eXBlXTtcclxuXHJcblx0XHRcdHZhciBsb2dpYyA9IHR5cGVfbG9naWNfdGFibGVbdHlwZV07XHJcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0XHRsb2dpYy50aWNrX0FJKGxpc3RbaV0pO1xyXG5cdFx0XHR9XHJcblx0XHR9IC8vIGVuZCBmb3IgaW4gXHJcblxyXG5cdH07XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHQvLyBkZWNsYXJlIHB1YmxpY1xyXG5cdFx0aW5pdDogaW5pdCwgXHJcblx0XHR1cGRhdGU6IHVwZGF0ZSxcclxuXHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRW5lbXlDb250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiRW5lbXlDb250cm9sbGVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUIHwgSW5jbHVkZXMuY2hvaWNlcy5MT0dJQ1xyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJcclxuXHJcbnZhciBHYW1lQ29udHJvbGxlciA9IChmdW5jdGlvbigpe1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHRpbmNsdWRlKCk7XHJcblx0fTtcclxuXHRcdFxyXG5cclxuXHR2YXIgdXBkYXRlX2FsbCA9IGZ1bmN0aW9uKGV2ZW50KXtcclxuXHRcdC8qXHJcblx0XHQgKiBtYWluIGZ1bmN0aW9uIHByZXR0eSBtdWNoXHJcblx0XHQgKiBldmVyeWdoaW5nIGVsc2UgaXMgY2FsbGVkIGZyb20gaGVyZSBldmVyeSB0aWNrXHJcblx0XHQgKi9cclxuXHRcdFxyXG5cdFx0aWYgKCFjcmVhdGVqcy5UaWNrZXIucGF1c2VkKXtcclxuXHRcdFx0dmFyIGRlbHRhID0gZXZlbnQuZGVsdGE7XHJcblxyXG5cdFx0XHQvLyAhISEhIHdvcmxkIHNpbXVsYXRpb24gc3RlcCBnb2VzIHNvbWV3aGVyZSByaWdodCBoZXJlXHJcblx0XHRcdC8vIGFzIHBlciBjdXJyZW50IGRlc2lnbiwgd2lsbCB0YWtlIGRlbHRhIGFzIGFuIGFyZ3VtZW50XHJcblx0XHRcclxuXHRcdFx0Ly9UZXJyYWluQ29udHJvbGxlci5nZW5lcmF0ZV90ZXJyYWluKCk7IFxyXG5cdFx0XHQvL1BsYXllckNvbnRyb2xsZXIudXBkYXRlKCk7XHJcblx0XHRcclxuXHRcdFx0V29ybGRDb250cm9sbGVyLnVwZGF0ZShkZWx0YSk7XHJcblxyXG5cdFx0XHRUZXJyYWluQ29udHJvbGxlci51cGRhdGUoKTtcclxuXHRcdFx0RW5lbXlDb250cm9sbGVyLnVwZGF0ZSgpO1xyXG5cclxuXHRcdFx0Ly8gU2hvdWxkIGJlIGNhbGxlZCBhZnRlciBhbGwgbW92ZW1lbnQgb2Ygb2JqZWN0cyBpcyBkb25lOlxyXG5cdFx0XHRHcmFwaGljc0NvbnRyb2xsZXIudXBkYXRlKCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRpbml0OiBpbml0LFxyXG5cdFx0dXBkYXRlX2FsbDogdXBkYXRlX2FsbCxcclxuXHR9O1xyXG5cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR2FtZUNvbnRyb2xsZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRjdXJyZW50X21vZHVsZTogXCJHYW1lQ29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJcclxudmFyIEdyYXBoaWNzQ29udHJvbGxlciA9IChmdW5jdGlvbigpe1xyXG5cdC8qIGFsbCB0aGUgZ3JhcGhpY3Mgc3R1ZmYuIGFuZCB3aGF0IGRpZCB5b3UgZXhwZWN0P1xyXG5cdCovXHJcblxyXG5cdHZhciBnZXRfYXNzZXQ7IFxyXG5cdHZhciBoZXJvLCBhbnQ7IC8vIGZvciBxdWlja2VyIGFjY2Vzc1xyXG5cdHZhciB0eXBlX3JlbmVyZXJfdGFibGU7XHJcblx0dmFyIEdyYXBoaWNzO1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiBpcyByYW4gZnJvbSB0aGUgSW5pdENvbnRyb2xsZXIgb25jZSB3aGVuIHRoZSBnYW1lIGlzIGxvYWRlZCAqL1xyXG5cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHNcclxuXHJcblx0XHQvLyB0aGlzIHdpbGwgYmUgcGFzc2VkIHRvIHJlbmRlcmVyZXNcclxuXHRcdEdyYXBoaWNzID0ge3JlcXVlc3RfYW5pbWF0ZWQ6IHJlcXVlc3RfYW5pbWF0ZWQsIHJlZ19mb3JfcmVuZGVyOiByZWdfZm9yX3JlbmRlciwgXHJcblx0XHRcdHNldF9yZWdfcG9zaXRpb246IHNldF9yZWdfcG9zaXRpb24sIHJlcXVlc3RfYml0bWFwOiByZXF1ZXN0X2JpdG1hcH07XHJcblxyXG5cdFx0dHlwZV9yZW5kZXJlcl90YWJsZSA9IHtcclxuXHRcdC8vIHR5cGU6XHRyZW5kZXJlcjpcclxuXHRcdFx0XCJhbnRcIjogQW50UmVuZGVyZXIsXHJcblx0XHRcdFwiaGVyb1wiOiBIZXJvUmVuZGVyZXIsXHJcblx0XHR9O1xyXG5cclxuXHRcdGdldF9hc3NldCA9IEFzc2V0Q29udHJvbGxlci5nZXRfYXNzZXQ7IC8vIGZvciBxdWlja2VyIGFjY2Vzc1xyXG5cclxuXHRcdGluaXRfYW5pbWF0aW9ucygpO1xyXG5cclxuXHJcblx0XHRHcmFwaGljc01vZGVsLnN0YWdlID0gbmV3IGNyZWF0ZWpzLlN0YWdlKENvbmZpZy5NQUlOX0NBTlZBU19OQU1FKTtcclxuXHRcdEdyYXBoaWNzTW9kZWwuc3RhZ2UuY2FudmFzLndpZHRoID0gQ29uZmlnLlNDUkVFTl9XO1xyXG5cdFx0R3JhcGhpY3NNb2RlbC5zdGFnZS5jYW52YXMuaGVpZ2h0ID0gQ29uZmlnLlNDUkVFTl9IO1xyXG5cclxuXHRcdFxyXG5cdFx0XHJcblx0XHQvL0dyYXBoaWNzTW9kZWwuY2FtZXJhLmZvbGxvd2luZyA9IGhlcm87XHJcbiAgICAgICAgLy9QSVpaQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBXHJcblx0XHRHcmFwaGljc01vZGVsLnNjb3JlID0gbmV3IGNyZWF0ZWpzLlRleHQoKTtcclxuXHRcdHJlZ19mb3JfcmVuZGVyKEdyYXBoaWNzTW9kZWwuc2NvcmUpO1xyXG5cdFx0R3JhcGhpY3NNb2RlbC5oZWFsdGggPSBuZXcgY3JlYXRlanMuVGV4dCgpO1xyXG5cdFx0cmVnX2Zvcl9yZW5kZXIoR3JhcGhpY3NNb2RlbC5oZWFsdGgpO1xyXG5cdFx0aHVkX3RlbXAoKTtcclxuXHJcblx0XHQvLyBUT0RPOiBpbml0IGFsbCByZW5kZXJlcnM7IGNoYW5nZSBJbmNsdWRlcyB0byBwYWNrYWdlIHJlbmRlcmVyc1xyXG5cdFx0QW50UmVuZGVyZXIuaW5pdCh7Z2V0X2Fzc2V0OiBBc3NldENvbnRyb2xsZXIuZ2V0X2Fzc2V0LCB9KTtcclxuXHR9O1xyXG4gICAgXHJcblx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKGRlbHRhKXtcclxuXHRcdC8qIGlzIHJhbiBlYWNoIHRpY2sgZnJvbSB0aGUgR2FtZUNvbnRyb2xsZXIudXBkYXRlX2FsbCAqL1xyXG5cclxuXHQgICAgdXBkYXRlX2NhbWVyYSgpOyAvLyBuZWVkcyB0byBiZSB1cGRhdGVkIGZpcnN0XHJcblxyXG5cdFx0cmVnaXN0ZXJfbmV3X3N0dWZmKCk7XHJcblxyXG5cdFx0Y2hlY2tfZm9yX25ld190ZXJyYWluKCk7XHJcblxyXG5cdFx0cmVuZGVyX3RoaW5ncygpO1xyXG5cdFx0c3luY2hyb25pemVfdG9fcGh5c2ljYWxfYm9kaWVzKCk7XHJcblxyXG5cdCAgICAvL1BJWlpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFcclxuXHRcdGh1ZF90ZW1wX3VwZGF0ZSgpO1xyXG5cclxuXHRcdC8vIDw8PDxcclxuXHRcdFxyXG5cdFx0R3JhcGhpY3NNb2RlbC5zdGFnZS51cGRhdGUoKTtcclxuXHR9O1xyXG5cclxuXHR2YXIgcmVnaXN0ZXJfbmV3X3N0dWZmID0gZnVuY3Rpb24oKXtcclxuXHRcdC8qKlxyXG5cdFx0KiBkZXNjcmlwdGlvblxyXG5cdFx0Ki9cclxuXHJcblx0XHQvLyByZXRyaWV2ZSBpbnN0YW5jZXMgb2YgcGh5c2ljYWwgdGhpbmdzIHRoYXQgZG8gbm90IGhhdmUgZ3JhcGhpY3MgeWV0XHJcblx0XHR2YXIgbmV3X3N0dWZmID0gUmVnaXN0ZXJBc0NvbnRyb2xsZXIucmV0cmlldmVfcmVnaXN0ZXJlZF9hcyhcImF3YWl0aW5nX2dyYXBoaWNzX2luaXRpYWxpemF0aW9uXCIpO1xyXG5cclxuXHRcdHZhciBsZW5ndGggPSBuZXdfc3R1ZmYubGVuZ3RoXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspe1xyXG5cdFx0XHR2YXIgbmV3X29iaiA9IG5ld19zdHVmZi5wb3AoKTtcclxuXHRcdFx0aWYodHlwZV9yZW5kZXJlcl90YWJsZVtuZXdfb2JqLnR5cGVdKXtcclxuXHRcdFx0XHQvLyBpZiByZW5kZXJlciBleGlzdHMgZm9yIHRoaXMgdHlwZSwgcmVnaXN0ZXIgdGhyb3VnaCBpdFxyXG5cdFx0XHRcdHR5cGVfcmVuZGVyZXJfdGFibGVbbmV3X29iai50eXBlXS5yZWdpc3RlcihuZXdfb2JqLCBHcmFwaGljcyk7XHRcclxuXHJcblx0XHRcdFx0aWYoR3JhcGhpY3NNb2RlbC5zcGVjaWFsX3JlbmRlcltuZXdfb2JqLnR5cGVdKXtcclxuXHRcdFx0XHRcdEdyYXBoaWNzTW9kZWwuc3BlY2lhbF9yZW5kZXJbbmV3X29iai50eXBlXS5wdXNoKG5ld19vYmopO1xyXG5cdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0R3JhcGhpY3NNb2RlbC5zcGVjaWFsX3JlbmRlcltuZXdfb2JqLnR5cGVdID0gW25ld19vYmpdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0Y29uc29sZS5sb2cobmV3X29iaik7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0dGhyb3cgXCJObyByZW5kZXJlciBmb3VuZCBmb3IgdGhlIHR5cGUgXCIgKyBTdHJpbmcobmV3X29iai50eXBlKSArXHJcblx0XHRcdFx0XHRcIiBjb25maXJtIHRoYXQgcmVuZGVyZXIgZXhpc3RzIGFuZCBpcyBhZGRlZCB0byB0aGUgR3JhcGhpY3NDb250cm9sbGVyLnR5cGVfcmVuZGVyZXJfdGFibGVcIlxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdH07XHJcblx0XHJcblx0dmFyIHJlbmRlcl90aGluZ3MgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyoqXHJcblx0XHQqIGNhbGwgcmVuZGVyZXJzIGZvciBldmVyeXRoaW5nXHJcblx0XHQqL1xyXG5cdFx0XHJcblx0XHR2YXIgdG9fcmVuZGVyID0gR3JhcGhpY3NNb2RlbC5zcGVjaWFsX3JlbmRlcjtcclxuXHJcblx0XHRmb3IodmFyIHR5cGUgaW4gdG9fcmVuZGVyKXtcclxuXHJcblx0XHRcdHZhciBsaXN0ID0gdG9fcmVuZGVyW3R5cGVdO1xyXG5cdFx0XHR2YXIgcmVuZGVyZXIgPSB0eXBlX3JlbmRlcmVyX3RhYmxlW3R5cGVdO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspe1xyXG5cdFx0XHRcdHJlbmRlcmVyLnJlbmRlcihsaXN0W2ldLCBHcmFwaGljcyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblx0XHRcclxuXHR9O1xyXG5cdFxyXG5cclxuICAgIC8vREVMRVRFIE1FIFBJWlpBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBXHJcblx0dmFyIGh1ZF90ZW1wID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICBHcmFwaGljc01vZGVsLmhlYWx0aC50ZXh0ID0gXCIxMDBcIjtcclxuXHQgICAgR3JhcGhpY3NNb2RlbC5oZWFsdGgueCA9IDEwO1xyXG5cdCAgICBHcmFwaGljc01vZGVsLmhlYWx0aC55ID0gMzA7XHJcblx0ICAgIEdyYXBoaWNzTW9kZWwuaGVhbHRoLmZvbnQgPSBcIjIwcHggQXJpYWxcIjtcclxuXHQgICAgR3JhcGhpY3NNb2RlbC5oZWFsdGguY29sb3IgPSBcIiNmZjAwMDBcIjtcclxuXHQgICAgR3JhcGhpY3NNb2RlbC5zY29yZS50ZXh0ID0gXCIxMFwiO1xyXG5cdCAgICBHcmFwaGljc01vZGVsLnNjb3JlLnggPSAxMDtcclxuXHQgICAgR3JhcGhpY3NNb2RlbC5zY29yZS55ID0gMTA7XHJcblx0ICAgIEdyYXBoaWNzTW9kZWwuc2NvcmUuZm9udCA9IFwiMjBweCBBcmlhbFwiO1xyXG5cdH1cclxuXHJcbiAgICAvL0RFTEVURSBNRSBQSVpaQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQVxyXG5cdHZhciBodWRfdGVtcF91cGRhdGUgPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgIHRlbXBfc2NvcmUgPSBwYXJzZUludChHcmFwaGljc01vZGVsLnNjb3JlLnRleHQpO1xyXG5cdCAgICB0ZW1wX3Njb3JlICs9IDE7XHJcblx0ICAgIEdyYXBoaWNzTW9kZWwuc2NvcmUudGV4dCA9IHRlbXBfc2NvcmUudG9TdHJpbmcoKTtcclxuXHR9XHJcblx0XHJcblx0dmFyIHVwZGF0ZV9oZWFsdGggPSBmdW5jdGlvbihwYXNzZWQpIHtcclxuXHRcclxuXHRHcmFwaGljc01vZGVsLmhlYWx0aC50ZXh0ID0gcGFzc2VkO1xyXG5cdC8vY29uc29sZS5sb2coXCJJJ3ZlIGJlZW4gY2FsbGVkXCIpO1xyXG5cdH1cclxuXHJcblx0dmFyIHVwZGF0ZV9jYW1lcmEgPSBmdW5jdGlvbigpe1xyXG5cdFx0dmFyIGNhbWVyYSA9IEdyYXBoaWNzTW9kZWwuY2FtZXJhO1xyXG5cdFx0dmFyIGNlbnRlciA9IGNhbWVyYS5jZW50ZXI7XHJcblxyXG5cdFx0Y2VudGVyLnggPSBDb25maWcuU0NSRUVOX1cvMiAtIGNhbWVyYS5vZmZzZXRfZnJvbV9mb2xsb3dlZC54O1xyXG5cdFx0Y2VudGVyLnkgPSBDb25maWcuU0NSRUVOX0gvMiAtIGNhbWVyYS5vZmZzZXRfZnJvbV9mb2xsb3dlZC55O1xyXG5cclxuXHRcdGlmKGNhbWVyYS5mb2xsb3dpbmcgIT0gbnVsbCl7XHJcblx0XHRcdGNhbWVyYS5vZmZzZXQueCA9IGNlbnRlci54IC0gY2FtZXJhLmZvbGxvd2luZy5waHlzaWNhbF9pbnN0YW5jZS5ib2R5LkdldFdvcmxkQ2VudGVyKCkueCAqIENvbmZpZy5CMkQuU0NBTEU7XHJcblx0XHRcdGNhbWVyYS5vZmZzZXQueSA9ICBjZW50ZXIueSAtIGNhbWVyYS5mb2xsb3dpbmcucGh5c2ljYWxfaW5zdGFuY2UuYm9keS5HZXRXb3JsZENlbnRlcigpLnkgKiBDb25maWcuQjJELlNDQUxFO1xyXG5cdFx0fVxyXG5cclxuXHRcdGFkanVzdF9kZWJ1Z19kcmF3KCk7IC8vIGdvZXMgbGFzdFxyXG5cdH07XHJcblxyXG5cdFxyXG5cclxuXHJcblx0Ly8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcblx0dmFyIGFkanVzdF9kZWJ1Z19kcmF3ID0gZnVuY3Rpb24oKXtcclxuXHRcdHZhciBjYW1lcmEgPSBHcmFwaGljc01vZGVsLmNhbWVyYTtcclxuXHRcdFRlc3RDb250cm9sbGVyLnNldF9kZWJ1Z19vZmZzZXQoY2FtZXJhLm9mZnNldC54LCBjYW1lcmEub2Zmc2V0LnkpO1xyXG5cdH07XHJcblxyXG5cdHZhciBpbml0X2FuaW1hdGlvbnMgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHJcblx0XHRcclxuXHR9O1xyXG5cdFxyXG5cdHZhciByZXF1ZXN0X2JpdG1hcCA9IGZ1bmN0aW9uKGlkKXtcclxuXHRcdC8vIGlmIGlkIGlzIGludmFsaWQsIHRocm93IG1lYW5pbmdmdWwgZXhjZXB0aW9uP1xyXG5cdFx0dmFyIGJpdG1hcCA9IG5ldyBjcmVhdGVqcy5CaXRtYXAoZ2V0X2Fzc2V0KGlkKSk7XHJcblx0XHQvLyBtb3JlIGNvbXBsaWNhdGVkIHNldHRpbmcgZm9yIHJlZ2lzdHJhdGlvbiBwb3NpdGlvbiBtYXkgYmUgbmVlZGVkLCBkZXBlbmRpbmcgb24gdGhlIGJvZHkgYXR0YWNoZWRcclxuXHRcdGlmICghKGJpdG1hcC5pbWFnZSkpe1xyXG5cdFx0XHR0aHJvdyBcIkVycm9yOiBpbWFnZSB3YXNuJ3QgY29ycmVjdGx5IGxvYWRlZCBmb3IgdGhpcyBiaXRtYXBcIjtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Yml0bWFwLnJlZ1ggPSBiaXRtYXAuaW1hZ2Uud2lkdGgvMjtcclxuXHRcdGJpdG1hcC5yZWdZID0gYml0bWFwLmltYWdlLmhlaWdodC8yO1xyXG5cclxuXHRcdHJldHVybiBiaXRtYXA7XHJcblx0XHQvLyBUT0RPIHJlc2VhcmNoIERpc3BsYXlPYmplY3QncyBjYWNoaW5nLiBhbmQgbWF5YmUgaW5jb3Jwb3JhdGVcclxuXHR9O1xyXG5cclxuXHR2YXIgcmVxdWVzdF9hbmltYXRlZCA9IGZ1bmN0aW9uKGlkLCBzdGFydF9mcmFtZSl7XHJcblx0XHQvLyB0aGlzIGltcGxlbWVudGF0aW9uIGlzIHRlbXBvcmFyeVxyXG5cdFx0Ly8gdW50aWwgSSBzZXR1cCBlZmZpY2llbnQgZmFjaWxpdHkgZm9yIGRlZmluaW5nIHNwcml0ZXNoZWV0c1xyXG5cdFx0Ly8gd2l0aGluIEdyYXBoaWNzQ29udHJvbGxlclxyXG5cclxuXHRcdGlmKCFpZCB8fCAhc3RhcnRfZnJhbWUpe1xyXG5cdFx0XHRpZighaWQpe1xyXG5cdFx0XHRcdHRocm93IFwid3JvbmcgaWRcIjtcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0dGhyb3cgXCJ3cm9uZyBzdGFydF9mcmFtZVwiO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cclxuXHRcdHZhciBzcHJpdGUgPSBuZXcgY3JlYXRlanMuU3ByaXRlKGlkLCBzdGFydF9mcmFtZSk7XHJcblxyXG5cdFx0cmV0dXJuIHNwcml0ZTtcclxuXHR9O1xyXG5cclxuXHRcclxuXHRcclxuXHR2YXIgc3luY2hyb25pemVfdG9fcGh5c2ljYWxfYm9kaWVzID0gZnVuY3Rpb24oKXtcclxuXHJcblx0XHR2YXIgdGlsZXMgPSBHcmFwaGljc01vZGVsLmFsbF9waHlzaWNhbDtcclxuXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGlsZXMubGVuZ3RoOyBpKyspe1xyXG5cdFx0XHR2YXIgdGlsZSA9IHRpbGVzW2ldO1xyXG5cdFx0XHR2YXIgYm9keSA9IHRpbGUucGh5c2ljYWxfaW5zdGFuY2UuYm9keTtcclxuXHJcblx0XHRcdHZhciB0aWxlX3BvcyA9IHRyYW5zX3h5KGJvZHkuR2V0V29ybGRDZW50ZXIoKSk7XHJcblxyXG5cdFx0XHR0aWxlLnggPSB0aWxlX3Bvcy54O1xyXG5cdFx0XHR0aWxlLnkgPSB0aWxlX3Bvcy55O1xyXG5cdFx0fVxyXG5cclxuXHR9O1xyXG5cdFxyXG5cclxuXHR2YXIgY2hlY2tfZm9yX25ld190ZXJyYWluID0gZnVuY3Rpb24oKXtcclxuXHRcdC8qIElmIG5ldyB0ZXJyYWluIGhhcyBiZWVuIGdlbmVyYXRlZCwgcmVuZGVyIGl0XHJcblx0XHQgKi9cclxuXHJcblx0XHR2YXIgbmV3X3NsaWNlcyA9IFRlcnJhaW5Db250cm9sbGVyLkdldE5ld1RlcnJhaW5TbGljZXMoKTtcclxuXHRcdHdoaWxlKG5ld19zbGljZXMubGVuZ3RoID4gMCl7XHJcblxyXG5cdFx0XHR2YXIgc2xpY2UgPSBuZXdfc2xpY2VzLnBvcCgpO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNsaWNlLmdyaWRfcm93czsgaSsrKXtcclxuXHRcdFx0XHQvKiBncmFwaGljcyBwYXNzLiBzaG91bGQgYmUgcHJvYmFibHkgbW92ZWQgdG8gdGhlIGdyYXBoaWNzIGNvbnRyb2xsZXJcclxuXHRcdFx0XHQgKiBkaWRuJ3QgZGVjaWRlIG9uIGl0IHlldFxyXG5cdFx0XHRcdCAqL1xyXG5cclxuXHJcblx0XHRcdFx0dmFyIGx2bCA9IHNsaWNlLmdyaWRfcm93cyAtIGk7IC8vIGxldmVsIGZyb20gdGhlIGJvdHRvbVxyXG5cclxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgc2xpY2UuZ3JpZF9jb2x1bW5zOyBqKyspe1xyXG5cdFx0XHRcdFx0dmFyIGlkID0gc2xpY2UuZ3JpZFtpXVtqXS5pZDtcclxuXHRcdFx0XHRcdGlmKGlkICE9IDApe1xyXG5cdFx0XHRcdFx0XHQvLyBUT0RPOiBzaG91bGQgbWFrZSBwcm9wZXIgdGVycmFpbiBjb2xsZWN0aW9uIHRoaW5nIHRvIHB1bGwgZnJvbSBcclxuXHRcdFx0XHRcdFx0dmFyIHRpbGVfdGV4dHVyZSA9IFtcImdyYXNzXCIsIFwibWlkZGxlX3RlcnJhaW5cIiwgXCJib3R0b21fdGVycmFpblwiXVtpZC0xXTtcclxuXHRcdFx0XHRcdFx0dmFyIHRpbGUgPSByZXF1ZXN0X2JpdG1hcCh0aWxlX3RleHR1cmUpO1xyXG5cdFx0XHRcdFx0XHR2YXIgcGh5c2ljYWxfaW5zdGFuY2UgPSBzbGljZS5ncmlkW2ldW2pdO1xyXG5cdFx0XHRcdFx0XHR2YXIgYm9keV9wb3NpdGlvbiA9IHBoeXNpY2FsX2luc3RhbmNlLmJvZHkuR2V0V29ybGRDZW50ZXIoKTtcclxuXHRcdFx0XHRcdFx0dmFyIHRyYW5zX3BvcyA9IHRyYW5zX3h5KGJvZHlfcG9zaXRpb24pO1xyXG5cdFx0XHRcdFx0XHR0aWxlLnggPSB0cmFuc19wb3MueDtcclxuXHRcdFx0XHRcdFx0dGlsZS55ID0gdHJhbnNfcG9zLnk7XHJcblx0XHRcdFx0XHRcdHJlZ19mb3JfcmVuZGVyKHRpbGUsIHBoeXNpY2FsX2luc3RhbmNlKTtcclxuXHRcdFx0XHRcdH0gLy8gZmlcclxuXHJcblxyXG5cdFx0XHRcdH0gLy8gZW5kIGZvclxyXG5cclxuXHRcdFx0fS8vZW5kIGZvclxyXG5cclxuXHRcdH0gLy8gZW5kIHdoaWxlXHJcblxyXG5cdH07IC8vIGVuZCBjaGVja19mb3JfbmV3X3RlcnJhaW5cclxuXHJcblx0dmFyIHRyYW5zX3h5ID0gZnVuY3Rpb24ocG9zaXRpb25fdmVjdG9yX3Vuc2NhbGVkKXtcclxuXHRcdC8vIHRha2VzIHBvc2l0aW9uIHZlY3RvciB3aXRoIHZhbHVlcyBpbiBtZXRlcnMsIHRyYW5zbGF0ZXNcclxuXHRcdC8vIGl0IHRvIHBpeGVsIHBvc2l0aW9uIHRha2luZyB0aGUgY2FtZXJhIHBvc2l0aW9uIGludG8gYWNjb3VudFxyXG5cdFx0dmFyIGNhbWVyYSA9IEdyYXBoaWNzTW9kZWwuY2FtZXJhO1xyXG5cclxuXHRcdHZhciB4ID0gKHBvc2l0aW9uX3ZlY3Rvcl91bnNjYWxlZC54ICogQ29uZmlnLkIyRC5TQ0FMRSkgKyBjYW1lcmEub2Zmc2V0Lng7XHJcblx0XHR2YXIgeSA9IChwb3NpdGlvbl92ZWN0b3JfdW5zY2FsZWQueSAqIENvbmZpZy5CMkQuU0NBTEUpICsgY2FtZXJhLm9mZnNldC55O1xyXG5cclxuXHRcdHJldHVybiB7eDogeCwgeTogeX07XHRcclxuXHR9O1xyXG5cclxuXHR2YXIgc2V0X3JlZ19wb3NpdGlvbiA9IGZ1bmN0aW9uKGVhc2VsanNfb2JqLCBvZmZzZXRfeCwgb2Zmc2V0X3kpe1xyXG5cdFx0Ly8gc2V0cyByZWdpc3RyYXRpb24gcG9zaXRpb24gb2YgdGhlIGVhc2VsanMgb2JqZWN0XHJcblx0XHQvLyByZWdpc3JhdGlvbiBwb3NpdGlvbiBpcyB0aGUgcmVsYXRpdmUgcG9pbnQgb2YgdGhlIG9iamVjdFxyXG5cdFx0Ly8gdGhhdCB5b3UgbW92ZSB3aGVuIHlvdSBzZXQgb2JqZWN0J3MgeCBhbmQgeSBjb29yZGluYXRzXHJcblx0XHQvLyBpLmUuIGlmIHJlZy4gcG9zaXRpb24gb2YgdGhlIHBsYXllciBpcyBoZWFkLCBhbmQgeW91IHNldCB0aGVpclxyXG5cdFx0Ly8gcG9zaXRpb24gdG8gKDAsIDApLCB0aGVpciBoZWFkIHdpbGwgYmUgYXQgKDAsIDApXHJcblx0XHQvLyBjdXJyZW50bHkgdGhlIHJlZ2lzdHJhdGlvbiBwb3NpdGlvbiBpcyBzZXQgdG8gdGhlIG1pZGRsZSBvZiB0aGUgYm9keVxyXG5cdFx0Ly8gdG8gbWF0Y2ggd2hhdCBib3gyZCBkb2VzXHJcblx0XHQvLyBsYXN0IHR3byBhcmd1bWVudHMgYXJlIG9wdGlvbmFsIGFuZCBzZXQgUElYRUwgb2Zmc2V0IGZyb20gdGhlIG5vcm1hbCByZWdpc3RyYXRpb25cclxuXHRcdC8vIHBvc2l0aW9uXHJcblx0XHRcclxuXHRcdC8vIHRoaXMgaWYgc3RhdGVtZW50IHNob3VsZCBiZSB0ZW1wb3JhcnlcclxuXHRcdGlmKGVhc2VsanNfb2JqLmltYWdlKXtcclxuXHRcdFx0dmFyIHcgPSBlYXNlbGpzX29iai5pbWFnZS53aWR0aDtcdFxyXG5cdFx0XHR2YXIgaCA9IGVhc2VsanNfb2JqLmltYWdlLmhlaWdodDtcdFxyXG5cdFx0fWVsc2V7XHJcblx0XHRcdHZhciB3ID0gZWFzZWxqc19vYmouc3ByaXRlU2hlZXQuX2ZyYW1lV2lkdGg7XHJcblx0XHRcdHZhciBoID0gZWFzZWxqc19vYmouc3ByaXRlU2hlZXQuX2ZyYW1lSGVpZ2h0O1xyXG5cdFx0fTtcclxuXHJcblx0XHR2YXIgb2Zmc2V0X3ggPSBvZmZzZXRfeCB8fCAwO1xyXG5cdFx0dmFyIG9mZnNldF95ID0gb2Zmc2V0X3kgfHwgMDtcclxuXHJcblx0XHRlYXNlbGpzX29iai5yZWdYID0gdy8yICsgb2Zmc2V0X3g7XHJcblx0XHRlYXNlbGpzX29iai5yZWdZID0gaC8yICsgb2Zmc2V0X3k7XHJcblxyXG5cdH07XHJcblxyXG5cdHZhciByZWdfZm9yX3JlbmRlciA9IGZ1bmN0aW9uKGVhc2VsanNfb2JqLCBwaHlzaWNhbF9pbnN0YW5jZSl7XHJcblx0XHQvLyByZWdpc3RlcmVzIG9iamVjdCBmb3IgcmVuZGVyaW5nIHdpdGhpbiBncmFwaGljcyBjb250cm9sbGVyXHJcblx0XHQvLyBpZiAoT1BUSU9OQUwhKSBwaHlzaWNhbF9pbnN0YW5jZSBpcyBnaXZlbiwgZ3JhcGhpY3MgY29udHJvbGxlciB3aWxsIGF1dG9tYXRpY2FsbHlcclxuXHRcdC8vIHNldCB0aGUgZWFzZWxqc19vYmoncyBwb3NpdGlvbiB0byBwb3NpdGlvbiBvZiB0aGF0IGJvZHksIGVhY2ggdGljay5cclxuXHRcdC8vIGlmIHRoZSB0eXBlIG9mIHRoZSBwaHlzaWNhbCBpbnN0YW5jZSBpcyBhc3NvY2lhdGVkIHdpdGggc29tZSByZW5kZXJlclxyXG5cdFx0XHRcclxuXHRcdGlmKHBoeXNpY2FsX2luc3RhbmNlKXtcclxuXHJcblx0XHRcdGVhc2VsanNfb2JqLnBoeXNpY2FsX2luc3RhbmNlID0gcGh5c2ljYWxfaW5zdGFuY2U7XHJcblx0XHRcdEdyYXBoaWNzTW9kZWwuYWxsX3BoeXNpY2FsLnB1c2goZWFzZWxqc19vYmopO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRBZGRUb1N0YWdlKGVhc2VsanNfb2JqKTtcclxuXHR9O1xyXG5cclxuXHR2YXIgQWRkVG9TdGFnZSA9IGZ1bmN0aW9uKGVsZW1lbnQpe1xyXG5cdFx0Ly8gY2FuIGJlIHVwZGF0ZWQgbGF0ZXIgdG8gbWFuYWdlIHotaW5kZXggb3Igd2hhdGV2ZXJcclxuXHRcdEdyYXBoaWNzTW9kZWwuc3RhZ2UuYWRkQ2hpbGQoZWxlbWVudCk7XHJcblx0fTtcclxuXHJcblx0dmFyIGdldF9zdGFnZSA9IGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gR3JhcGhpY3NNb2RlbC5zdGFnZTtcclxuXHR9O1xyXG5cdFxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0dXBkYXRlOiB1cGRhdGUsXHJcblx0XHRnZXRfc3RhZ2U6IGdldF9zdGFnZSxcclxuXHRcdHVwZGF0ZV9oZWFsdGg6IHVwZGF0ZV9oZWFsdGgsXHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR3JhcGhpY3NDb250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiR3JhcGhpY3NDb250cm9sbGVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUIHwgSW5jbHVkZXMuY2hvaWNlcy5SRU5ERVJFUlNcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwiXHJcbnZhciBJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKXtcclxuXHQvKiBJcyBpbiBjaGFyZ2Ugb2YgZ2l2aW5nIHVuaXF1ZSBJRCdzIHRvIGV2ZXJ5dGhpbmdcclxuXHQgKiB0aGF0IHdhbnRzIHRoZW1cclxuXHQqL1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiBpcyByYW4gZnJvbSB0aGUgSW5pdENvbnRyb2xsZXIgb25jZSB3aGVuIHRoZSBnYW1lIGlzIGxvYWRlZCAqL1xyXG5cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHNcclxuXHJcblx0XHQvLyBjcmVhdGUgMTAwIGlkJ3NcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCAxMDA7IGkrKyl7XHJcblx0XHRcdHZhciBpZCA9IElkZW50aWZpY2F0aW9uTW9kZWwubmV4dF9pZCArKztcclxuXHRcdFx0SWRlbnRpZmljYXRpb25Nb2RlbC5mcmVlX2lkcy5wdXNoKGlkKTtcclxuXHRcdFx0SWRlbnRpZmljYXRpb25Nb2RlbC5pZF9tYXRjaGluZ1tpZF0gPSBudWxsO1xyXG5cdFx0fVxyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgdXBkYXRlID0gZnVuY3Rpb24oZGVsdGEpe1xyXG5cdFx0LyogaXMgcmFuIGVhY2ggdGljayBmcm9tIHRoZSBHYW1lQ29udHJvbGxlci51cGRhdGVfYWxsICovXHJcblx0XHQvLyBjbGVhbnVwIGlkcywgaWYgdG9vIG1hbnkgZnJlZSBpZHMgKGxpa2UgaWYgbm9uLWZyZWUgaWQncyA8IGZyZWUgaWQncy8xMFxyXG5cdFx0XHJcblx0XHQvL1RPRE86IG1ha2UgZnVuY3Rpb24gdG8gYWN0dWFsbHkgYmUgY2FsbGVkIGZyb20gdGhlIEdhbWVDb250cm9sbGVyLnVwZGF0ZV9hbGxcclxuXHRcdC8vIFRPRE86IGxvb3AgdGhyb3VnaCBhbGwgbm9uLWZyZWUgaWQncywgYW5kIGlmIGFueSBvZiB0aGVtIHJlZmVyZW5jZSBudWxsLFxyXG5cdFx0Ly8gcmVtb3ZlICh1bnJlZ2lzdGVyKSB0aGVtO1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgYXNzaWduX2lkID0gZnVuY3Rpb24ob2JqLCBzZXRfaWQpe1xyXG5cdFx0LyoqXHJcblx0XHQqIGFzc2lnbnMgaWQgdG8gdGhlIG9iamVjdFxyXG5cdFx0KiBzZXRzIHByb3BlcnR5IGlkIG9uIHRoZSBvYmplY3QgZ2l2ZW4uIHlvdSBjYW4gZ2l2ZSBPUFRJT05BTCBwYXJhbWV0ZXJcclxuXHRcdCogc2V0X2lkIHdoaWNoIHNob3VsZCBiZSBhIGZ1bmN0aW9uIHRoYXQgdGFrZXMgb2JqZWN0IGFuZCBpZCBhbmQgYXNzaWduc1xyXG5cdFx0KiBpZCB0byB0aGUgb2JqZWN0LiB0aGlzIGNhbiBiZSB1c2VmdWwgaWYgeW91IHdhbnQgdG8gc3RvcmUgaWQgaW4gc29tZSB1bnVzdWFsXHJcblx0XHQqIHBsYWNlLCBvciBwZXJmb3JtIHNvbWUgZXh0cmEgb3BlcmF0aW9ucyBiZWZvcmUgaWQgaXMgYXNzaWduZWRcclxuXHRcdCpcclxuXHRcdCogcmV0dXJuIGlkIGFzc2lnbmVkXHJcblx0XHQqIElkZW50aWZpY2F0aW9uQ29udHJvbGxlciB3aWxsIHJlbWVtYmVyIHRoYXQgdGhpcyBpZCBoYXMgYmVlbiBhc3NpZ25lZFxyXG5cdFx0KiB0aGlzIG9iamVjdFxyXG5cdFx0Ki9cclxuXHRcdHZhciBmcmVlID0gSWRlbnRpZmljYXRpb25Nb2RlbC5mcmVlX2lkcztcclxuXHRcdHZhciBpZDtcclxuXHJcblx0XHQvLyBnZXQgZnJlZSBpZFxyXG5cdFx0aWYoZnJlZS5sZW5ndGggPiAwKXtcclxuXHRcdFx0aWQgPSBmcmVlLnBvcCgpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdGlkID0gSWRlbnRpZmljYXRpb25Nb2RlbC5uZXh0X2lkKys7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gc2V0IGlkIG9uIHRoZSBvYmplY3QuIHRocm91Z2ggZnVuY3Rpb24gaWYgcHJvdmlkZWRcclxuXHRcdGlmKHNldF9pZCl7XHJcblx0XHRcdHNldF9pZChvYmosIGlkKTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRvYmouaWQgPSBpZDtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBhc3NvY2lhdGUgaWQgd2l0aCB0aGUgb2JqZWN0IG9ialxyXG5cdFx0SWRlbnRpZmljYXRpb25Nb2RlbC5pZF9tYXRjaGluZ1tpZF0gPSBvYmo7XHJcblxyXG5cdFx0cmV0dXJuIGlkXHJcblx0fTtcclxuXHJcblx0dmFyIGdldF9ieV9pZCA9IGZ1bmN0aW9uKGlkKXtcclxuXHRcdC8qKlxyXG5cdFx0KiBnZXQgb2JqZWN0IGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4gaWRcclxuXHRcdCovXHJcblx0XHRyZXR1cm4gSWRlbnRpZmljYXRpb25Nb2RlbC5pZF9tYXRjaGluZ1tpZF07XHJcblx0fTtcclxuXHJcblx0dmFyIHJlbW92ZV9pZCA9IGZ1bmN0aW9uKGlkKXtcclxuXHRcdC8qKlxyXG5cdFx0KiBtYXJrIGlkIGFzIGZyZWUgYW5kIG5vIGxvbmdlciBhc3NpY2lhdGUgaXQgd2l0aCBhbnkgb2JqZWN0XHJcblx0XHQqIG5vdGljZSB0aGF0IHlvdSB5b3Vyc2VsZiBpcyByZXNwb25zaWJsZSBmb3IgbWFraW5nIHN1cmVcclxuXHRcdCogdGhhdCBvYmplY3QgdGhhdCB3YXMgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaWQgZG9lc24ndCB0aGlua1xyXG5cdFx0KiB0aGF0IGhlIGlzIHN0aWxsIGFzc2lnbmVkIHRoaXMgaXNcclxuXHRcdCovXHJcblxyXG5cdFx0Ly8gVE9ETzogbWFrZSBzdXJlIHRoYXQgYWxsIGtub3duIHBsYWNlcyB0aGF0IHVzZSBpZHMgKFBoeXNpY3NDb250cm9sbGVycydcclxuXHRcdC8vIGNvbnRhY3QgbGlzdGVuZXIgZm9yIGV4YW1wbGUpIGFyZSBub3RpZmllZCB0aGF0IGlkIGhhZCBiZWVuIHVucmVnaXN0ZXJlZFxyXG5cdFx0SWRlbnRpZmljYXRpb25Nb2RlbC5pZF9tYXRjaGluZ1tpZF0gPSBudWxsO1xyXG5cdFx0SWRlbnRpZmljYXRpb25Nb2RlbC5mcmVlX2lkcy5wdXNoKGlkKTtcclxuXHR9O1xyXG5cdFxyXG5cdHZhciBhc3NpZ25fdHlwZSA9IGZ1bmN0aW9uKG9iaiwgdHlwZSl7XHJcblx0XHQvKipcclxuXHRcdCogYXNzaWducyB3YW50ZWQgdHlwZSAoc3RyaW5nKSB0byB0aGUgZ2l2ZW5cclxuXHRcdCogbW9kZWwgZGVmaW5pdGlvblxyXG5cdFx0KiBpZiB5b3UgdHJ5IHRvIGFzc2lnbiBzYW1lIHR5cGUgdHdpY2UsIHRocm93cyBleGNlcHRpb247XHJcblx0XHQqIElkLi4uQ29udHJvbGxlciBhbGxvd3MgeW91IHRvIHJldHJpZXZlIG1vZGVsXHJcblx0XHQqL1xyXG5cclxuXHRcdHZhciB0eXBlcyA9IElkZW50aWZpY2F0aW9uTW9kZWwudHlwZXM7XHJcblx0XHRpZih0eXBlc1t0eXBlXSl7XHJcblx0XHRcdHRocm93IFwiRXJyb3I6IHR5cGUgXCIgKyB0eXBlICsgXCIgaXMgYWxyZWFkeSByZWdpc3RlcmVkLiBcIiArXHJcblx0XHRcdFx0XCJZb3UgY2FuJ3QgcmVnaXN0ZXIgdGhlIHNhbWUgdHlwZSB0d2ljZVwiO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdHR5cGVzW3R5cGVdID0gb2JqO1xyXG5cdFx0XHRvYmoucHJvdG90eXBlLnR5cGUgPSB0eXBlO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0fTtcclxuXHJcblx0dmFyIGdldF9ieV90eXBlID0gZnVuY3Rpb24odHlwZSl7XHJcblx0XHQvKipcclxuXHRcdCogZ2V0cyBvYmplY3QgYnkgaXQncyB0eXBlXHJcblx0XHQqL1xyXG5cdFx0dmFyIHR5cGVzID0gSWRlbnRpZmljYXRpb25Nb2RlbC50eXBlcztcclxuXHRcdGlmKHR5cGVzW3R5cGVdKXtcclxuXHRcdFx0cmV0dXJuIHR5cGVzW3R5cGVdO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdHRocm93IFwiRXJyb3I6IHR5cGUgXCIgKyB0eXBlICsgXCIgd2Fzbid0IGRlZmluZWQgeWV0XCI7XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHRcclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0dXBkYXRlOiB1cGRhdGUsXHJcblx0XHRhc3NpZ25faWQ6IGFzc2lnbl9pZCxcclxuXHRcdGdldF9ieV9pZDogZ2V0X2J5X2lkLFxyXG5cdFx0cmVtb3ZlX2lkOiByZW1vdmVfaWQsXHJcblx0XHRhc3NpZ25fdHlwZTogYXNzaWduX3R5cGUsXHJcblx0XHRnZXRfYnlfdHlwZTogZ2V0X2J5X3R5cGUsXHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gSWRlbnRpZmljYXRpb25Db250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiSWRlbnRpZmljYXRpb25Db250cm9sbGVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5PV05fTU9ERUxcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwidmFyIEluaXRDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0Ly8gd2h5IGRvIHlvdSB3YW50IHRvIHB1dCBpbml0aWFsaXphdGlvbiBvZiBldmVyeXRoaW5nIGludG8gdGhlIEluaXRDb250cm9sbGVyP1xyXG5cdC8vIEJlY2F1c2UgaWYgaW5pdGlhbGl6YXRpb24gb2Ygc210aCBkZXBlbmRzIG9uIGluaXRpYWxpemF0aW9uIG9mIHNtdGggZWxzZSxcclxuXHQvLyBpdCdzIGVhc2llciB0byBjb250cm9sIGhlcmVcclxuXHQvL1xyXG5cdC8vIGUuZy4gaWYgeW91IHRyeSB0byBkbyB2YXIgZm9vID0gJCgnI2ZvbycpOyBzb21ld2hlcmUgaW4gb3RoZXIgbW9kdWxlLFxyXG5cdC8vIHlvdSBjYW4gZ2V0IGZvbyA9IG51bGw7IGFzIGNvZGUgb2YgdGhhdCBtb2R1bGUgY2FuIGV4ZWN1dGUgYmVmb3JlIHRoZSBodG1sIGRvY3VtZW50XHJcblx0Ly8gd2FzIGZ1bGx5IGxvYWRlZCwgYnV0ID5Jbml0Q29udHJvbGxlci5pbml0PCBpcyBjYWxsZWQgYWZ0ZXIgZG9jdW1lbnQgd2FzIGxvYWRlZCwgc29cclxuXHQvLyAtMSBwb3RlbnRpYWwgcHJvYmxlbS4gQnR3LCBhdCB0aGlzIG1vbWVudCBpbiB0aW1lIHRoZSB0aGUgc3R1ZmYgaXMgc2V0IHRvIHdvcmsgdGhhdCB3YXlcclxuXHQvLyB1c2luZyBodG1sICg8Ym9keSBvbmxvYWQ9Li4uKTsgbWF5YmUgdXNpbmcgSlMgd291bGQgYmUgYmV0dGVyPyBJZGs7XHJcblx0XHRcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbihtb2RlKXtcclxuXHRcdGluY2x1ZGUoKTtcclxuXHJcblx0XHRlbmFibGVfYXJyb3drZXlfc2Nyb2xsKGZhbHNlKTtcclxuXHRcdHNldHVwX3NjcmVlbigpO1xyXG5cdFx0c2V0dXBfZXZlbnRzKCk7XHJcblxyXG5cdFx0aW5pdF9hbGxfbW9kdWxlcyhtb2RlKTsgLy8gY2FsbCAuaW5pdCBmdW5jdGlvbiBvZiBldmVyeW9uZS4gZS5nLiBQbGF5ZXJDb250cm9sbGVyLmluaXQoKTsgZXRjLlxyXG5cclxuXHRcdFxyXG5cdFx0Ly8gTm90aWNlIHRoYXQgYXNzZXQgZGVwZW5kZW50IHN0dWZmIGRvZXNuJ3QgKGFuZCBtdXN0bid0KSBzdGFydCB1bnRpbFxyXG5cdFx0Ly8gYWxsIGFzc2V0cyBhcmUgY29tcGxldGVseSBsb2FkZWQuIFRoYXQgaW5jbHVkZXMgdGlja2VyLCBpLmUuIG5vIHRpY2tzIGFyZSBwcm9jZXNzZWRcclxuXHRcdC8vIHVudGlsIGV2ZXJ5dGhpbmcgaXMgbG9hZGVkLiBJZiB5b3Ugd2FudCBzb21ldGhpbmcgZGlmZmVyZW50LCBlLmcuIGRpc3BsYXkgc29tZSBzb3J0IG9mIGxvYWRpbmdcclxuXHRcdC8vIGFuaW1hdGlvbiAtIGxldCBtZSBrbm93LlxyXG5cdFx0Ly8gTG9vayBpbnRvIHRoZSBzZXR1cF9hc3NldF9kZXBlbmRlbnQgZnVuY3Rpb25cclxuXHRcdFx0QXNzZXRNb2RlbC5sb2FkZXIgPSBuZXcgY3JlYXRlanMuTG9hZFF1ZXVlKGZhbHNlKTsgLy8gbG9hZGluZyByZXNvdXJzZXMgdXNpbmcgcHJlbG9hZC5qc1xyXG5cdFx0XHRBc3NldE1vZGVsLmxvYWRlci5hZGRFdmVudExpc3RlbmVyKFwiY29tcGxldGVcIiwgc2V0dXBfYXNzZXRfZGVwZW5kYW50KTtcclxuXHJcblx0XHQvLyBpZiBtb3JlIHN0dWZmIG5lZWRzIHRvIGJlIGRvbmUgZm9yIHRoZSB0ZXN0IG1vZGUsIFxyXG5cdFx0Ly8gb3IgbW9yZSB0eXBlcyBvZiBpdCBuZWVkcyB0byBiZSBhZGRlZFxyXG5cdFx0Ly8geW91IGNhbiBzYWZlbHkgbWFrZSB0aGUgZm9sbG93aW5nIGEgc2VwYXJhdGUgZnVuY3Rpb25cclxuXHRcdFx0dmFyIGFzc2V0X3BhdGggPSAobW9kZSA9PSBcInRlc3RcIikgPyBcIi4vYXNzZXRzL2FydC9cIiA6IFwiLi4vR2FtZUNvZGUvYXNzZXRzL2FydC9cIjtcclxuXHJcblx0XHRBc3NldENvbnRyb2xsZXIuaW5pdChhc3NldF9wYXRoKTtcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIGluaXRfYWxsX21vZHVsZXMgPSBmdW5jdGlvbihtb2RlKXtcclxuXHRcdC8vIFRPRE86IGJldHRlciB3YXkgdG8gZG8gc3R1ZmYgbGlrZSB0aGF0IChjYWxsIGNlcnRhaW4gZnVuY3Rpb25cclxuXHRcdC8vIG9mIGV2ZXJ5IG1vZHVsZSBpbiB0aGUgb3JkZXIuIFxyXG5cdFx0Ly8gQWxzbywgaW5pdCBhbmQgdXBkYXRlIGZ1bmN0aW9ucyBvZiBlYWNoIG1vZHVsZSBzaG91bGQgcHJvYmFibHlcclxuXHRcdC8vIGFjY2VwdCBzb21lIGFyZ3VtZW50LiBJIHRoaW5rIHRvIG1ha2UgdGhpcyBhcmd1bWVudCBhbiBvYmplY3QsXHJcblx0XHQvLyB0aGlzIHdheSB3ZSBjYW4gYWRkIG1vcmUgdGhpbmdzIHRvIGJlIHBhc3NlZCB3L28gYW55IHByb2JsZW0gYW5kXHJcblx0XHQvLyB3ZSB3b24ndCBuZWVkIHRvIGNoYW5nZSBhbnl0aGluZ1xyXG5cdFx0XHJcblx0XHRCMmQuaW5pdCgpOyAvLyBnb2VzIGZpcnN0XHJcblx0XHRJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0UmVnaXN0ZXJBc0NvbnRyb2xsZXIuaW5pdCgpO1xyXG5cclxuXHRcdC8vQXNzZXRDb250cm9sbGVyLmluaXQoKTsgLy8gY2FsbGVkIGZyb20gdGhlIEluaXRDb250cm9sbGVyLmluaXQvLyBzdHVmZiBoYXMgdG8gY2hhbmdlXHJcblx0XHRHYW1lQ29udHJvbGxlci5pbml0KCk7XHJcblx0XHRLZXlib2FyZENvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0UGh5c2ljc0NvbnRyb2xsZXIuaW5pdCgpO1xyXG5cclxuXHRcdFRlc3RDb250cm9sbGVyLmluaXQobW9kZSk7XHJcblxyXG5cdFx0Ly9QbGF5ZXJDb250cm9sbGVyLmluaXQoKTtcclxuXHRcdFRlcnJhaW5Db250cm9sbGVyLmluaXQoKTtcclxuXHRcdFRlcnJhaW5TbGljZUNvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0V29ybGRDb250cm9sbGVyLmluaXQoKTtcclxuXHJcblx0XHQvLyBXQVJOSU5HISEhIEdyYXBoaWNzQ29udHJvbGxlci5pbml0IGlzIGNhbGxlZCBmcm9tIHRoZVxyXG5cdFx0Ly8gc2V0dXBfYXNzZXRfZGVwZW5kZW50IGZ1bmN0aW9uIGFzIGl0LCB3ZWxsLCBkZXBlbmRzIG9uIGFzc2V0cyBiZWluZyBsb2FkZWRcclxuXHJcblx0fTtcclxuXHJcblxyXG5cdHZhciBlbmFibGVfYXJyb3drZXlfc2Nyb2xsID0gZnVuY3Rpb24oZW5hYmxlX3Njcm9sbCl7XHJcblx0XHRpZihlbmFibGVfc2Nyb2xsID09IGZhbHNlKXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKXsgLy8gLmdldEVsZW1lbnRCeUlkKFwiZGlzcGxheV9jYW52YXNcIilcclxuXHRcdFx0XHRhcnJvd3MgPSBbMzcsIDM4LCAzOSwgNDBdOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG5cdFx0XHRcdGlmKGFycm93cy5pbmRleE9mKGUua2V5Q29kZSkgPiAtMSl7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcblx0XHRcdFx0fWVsc2V7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHRcdFx0XHR9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG5cdFx0XHR9KSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHRcdH1cdFx0XHJcblx0fTtcclxuXHRcclxuXHR2YXIgc2V0dXBfc2NyZWVuID0gZnVuY3Rpb24oKXtcclxuXHJcblx0XHQvLyBTZXR0aW5nIHVwIG90aGVyIHN0dWZmOlxyXG5cdFx0Ly8gZS5nIHNldHVwIGNhbnZhcyBzaXplXHJcblx0XHRcclxuXHRcdC8vIFRPRE86IGFsbG93IHJlc2l6ZXM/XHJcblxyXG5cdFx0Q29uZmlnLlNDUkVFTl9XID0gJCgnI2NhbnZhc19jb250YWluZXInKS53aWR0aCgpOyAvLyBpcyBkeW5hbWljYWxseSBzZXQgdG8gcGl4ZWwgd2lkdGggb2YgdGhlIGNvbnRhaW5pbmcgZWxlbWVudFxyXG5cclxuXHRcdC8vIHBvc3NpYmxlIHJlc2l6aW5nIHRlY2huaXF1ZTogXHJcblx0XHQvLyBodHRwOi8vd3d3LmZhYmlvYmlvbmRpLmNvbS9ibG9nLzIwMTIvMDgvY3JlYXRlanMtYW5kLWh0bWw1LWNhbnZhcy1yZXNpemUtZnVsbHNjcmVlbi1hbmQtbGlxdWlkLWxheW91dHMvXHJcblxyXG5cdFx0XHJcblx0XHQvLyQoJyNkZWJ1Z19jYW52YXMnKS53aWR0aChTdHJpbmcoU0NSRUVOX1cpICsgXCJweFwiKTtcclxuXHRcdC8vJCgnI2Rpc3BsYXlfY2FudmFzJykud2lkdGgoU3RyaW5nKFNDUkVFTl9XKSArIFwicHhcIik7XHJcblxyXG5cdFx0Ly8kKCcjZGVidWdfY2FudmFzJykuaGVpZ2h0KFN0cmluZyhTQ1JFRU5fSCkgKyBcInB4XCIpO1xyXG5cdFx0Ly8kKCcjZGlzcGxheV9jYW52YXMnKS5oZWlnaHQoU3RyaW5nKFNDUkVFTl9IKSArIFwicHhcIik7XHJcblx0XHRcclxuXHR9O1xyXG5cclxuXHR2YXIgc2V0dXBfdGlja2VyID0gZnVuY3Rpb24oKXtcclxuXHJcblx0XHRjcmVhdGVqcy5UaWNrZXIuc2V0RlBTKENvbmZpZy5GUFMpO1xyXG5cclxuXHRcdC8vIHRpY2tlcjogb24gZWFjaCB0aWNrIGNhbGwgR2FtZUNvbnRyb2xsZXIudXBkYXRlX2FsbCgpO1xyXG5cdFx0Y3JlYXRlanMuVGlja2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0aWNrXCIsIEdhbWVDb250cm9sbGVyLnVwZGF0ZV9hbGwpO1xyXG5cclxuXHRcclxuXHR9O1xyXG5cclxuXHR2YXIgc2V0dXBfZXZlbnRzID0gZnVuY3Rpb24oKXtcclxuXHJcblxyXG5cdFx0Ly8ga2V5Ym9hcmQgaW5wdXQgZXZlbnQ6IG9uIGVhY2gga2V5Ym9hcmQgZXZlbnQgY2FsbCBhcHByb3ByaWF0ZSBLZXlib2FyZENvbnRyb2xsZXIgZnVuY3Rpb25cclxuXHRcdGRvY3VtZW50Lm9ua2V5ZG93biA9IEtleWJvYXJkQ29udHJvbGxlci5rZXlkb3duO1xyXG5cdFx0ZG9jdW1lbnQub25rZXl1cCA9IEtleWJvYXJkQ29udHJvbGxlci5rZXl1cDtcclxuXHJcblx0XHRcdC8vIG9uIGludGVycnVwdCBldmVudDogc3RvcC9wYXVzZSB0aWNrZXIgP1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgc2V0dXBfYXNzZXRfZGVwZW5kYW50ID0gZnVuY3Rpb24oKXtcclxuXHRcdC8vIHRoaXMgbWF5IG5lZWQgdG8gbW92ZSB0byBlaXRoZXIgbG9hZF9nYW1lIG9yIHNvbWUgc29ydCBvZiByZXNpemluZyBmdW5jdGlvblxyXG5cdFx0XHJcblx0XHRFbmVteUNvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0R3JhcGhpY3NDb250cm9sbGVyLmluaXQoKTtcclxuXHJcblxyXG5cdFx0c2V0dXBfdGlja2VyKCk7XHJcblxyXG5cdFx0Ly9UZXJyYWluQ29udHJvbGxlci5nZW5lcmF0ZV90ZXJyYWluKCk7IC8vIEluaXRpYWwgdGVycmFpbiBnZW5lcmF0aW9uIC8vIGRlcHJlY2F0ZWQsIGdlbmVyYXRpb24gd2lsbCBiZSBjYWxsZWQgZnJvbSB1cGRhdGUgZWFjaCB0aWNrXHJcblx0fTtcclxuXHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRpbml0OiBpbml0LFxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEluaXRDb250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiSW5pdENvbnRyb2xsZXJcIiwgXHJcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkFMTFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJ2YXIgS2V5Ym9hcmRDb250cm9sbGVyID0gKGZ1bmN0aW9uKClcclxue1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcclxuXHRcdGluY2x1ZGUoKTtcclxuXHR9O1xyXG5cdFxyXG5cdHZhciBnZXRfYWN0aXZlX2NvbW1hbmRzX2Z1bmN0aW9uID0gZnVuY3Rpb24odGFibGUpe1xyXG5cdFx0Ly8gZ2V0IGFsbCBjb21tYW5kcyBhc3NvY2lhdGVkIHdpdGgga2V5cyB0aGF0IGFyZSBkZWZpbmVkIGluIHRoZSA+dGFibGU8LFxyXG5cdFx0Ly8gYW5kIGFyZSBjdXJyZW50bHkgcHJlc3NlZFxyXG5cdFx0Ly9cclxuXHRcdC8vIHJldHVybnM6IGFycmF5IG9mIGNvbW1hbmRzXHJcblx0XHQvL1xyXG5cdFx0Ly8gVE9ETzogUkVGQUNUT1IgdGhpcyBmdW5jdGlvbiB0byB3b3JrIGJldHRlciBhbmQgc28gcGVvcGxlIGRvIG5vdFxyXG5cdFx0Ly8gbmVlZCB0byBjYWxsIGl0IGVhY2ggdGljay4gaW5zdGVhZCB0aGV5IHNob3VsZCBnZXQgcmVmZXJlbmNlIHRvIGZ1bmN0aW9uIG9uZSB0aW1lXHJcblx0XHQvLyBhbmQgc3RheSB1cGRhdGVkIG9uIHRoZSBhY3RpdmUgY29tbWFuZHNcclxuXHRcdFxyXG5cdFx0dmFyIGNvbW1hbmRzID0gW107XHJcblx0XHRcclxuXHRcdCQuZWFjaChLZXlib2FyZE1vZGVsLnRyYW5zbGF0aW9uX3RhYmxlcy5jb2RlX3RvX25hbWUsIGZ1bmN0aW9uKGtleSwgY21kKXtcclxuXHRcdFx0aWYoS2V5Ym9hcmRNb2RlbC5rZXlzW2tleV0gJiYgdGFibGVbY21kXSl7XHJcblx0XHRcdFx0Y29tbWFuZHMucHVzaCh0YWJsZVtjbWRdKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0dmFyIGdldF9rZXkgPSBmdW5jdGlvbihrZXkpe1xyXG5cdFx0XHRpZihjb21tYW5kcy5pbmRleE9mKGtleSkgPiAtMSl7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZVxyXG5cdFx0XHR9O1xyXG5cdFx0fTtcclxuXHJcblx0XHRyZXR1cm4gZ2V0X2tleTtcclxuXHR9O1xyXG5cclxuXHQvLyBwdWJsaWM6XHJcblx0XHJcblx0dmFyIGtleWRvd24gPSBmdW5jdGlvbihldmVudCl7XHJcblx0XHRLZXlib2FyZE1vZGVsLmtleXNbZXZlbnQua2V5Q29kZV0gPSB0cnVlO1xyXG5cdH07XHJcblxyXG5cdHZhciBrZXl1cCA9IGZ1bmN0aW9uKGV2ZW50KXtcclxuXHRcdGRlbGV0ZSBLZXlib2FyZE1vZGVsLmtleXNbZXZlbnQua2V5Q29kZV07XHJcblx0fTtcclxuXHJcblxyXG5cdHZhciBtb3ZlbWVudF9jb21tYW5kcyA9IGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gZ2V0X2FjdGl2ZV9jb21tYW5kc19mdW5jdGlvbihLZXlib2FyZE1vZGVsLnRyYW5zbGF0aW9uX3RhYmxlcy5tb3ZlbWVudCk7XHJcblx0fTtcclxuXHJcblx0dmFyIGRlYnVnX2NvbW1hbmRzID0gZnVuY3Rpb24oKXtcclxuXHRcdC8qKlxyXG5cdFx0KiBjb21tYW5kcyBhY3RpdmUgaW4gZGVidWcgbW9kZVxyXG5cdFx0Ki9cclxuXHRcdHJldHVybiBnZXRfYWN0aXZlX2NvbW1hbmRzX2Z1bmN0aW9uKEtleWJvYXJkTW9kZWwudHJhbnNsYXRpb25fdGFibGVzLmRlYnVnKTtcclxuXHR9O1xyXG5cdFxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0a2V5ZG93bjoga2V5ZG93bixcclxuXHRcdGtleXVwOiBrZXl1cCxcclxuXHJcblx0XHRtb3ZlbWVudF9jb21tYW5kczogbW92ZW1lbnRfY29tbWFuZHMsXHJcblx0XHRkZWJ1Z19jb21tYW5kczogZGVidWdfY29tbWFuZHMsXHJcblx0XHRpbml0OiBpbml0LFxyXG5cdH07XHJcblxyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBLZXlib2FyZENvbnRyb2xsZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRjdXJyZW50X21vZHVsZTogXCJLZXlib2FyZENvbnRyb2xsZXJcIiwgXHJcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFRcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwiLy8gTm90ZXM6XHJcbi8vIG5vdGljZSB0aGF0IHlvdSBjYW4gcmV1c2UgYm9keSBkZWZpbml0aW9ucyBtdWx0aXBsZSB0aW1lcywgaXQgbWFrZXMgc2Vuc2UgdG8gaGF2ZVxyXG4vLyBjb2xsZWN0aW9uIG9mIGJvZHkgZGVmaW5pdGlvbnMgdGhhdCBhcmUgY29tbW9ubHkgdXNlIGFuZCBtYXliZSBhbGxvdyBzb21lIHNvcnQgb2YgXHJcbi8vIGluaGVyaXRhbmNlIChpLmUuIHlvdSBjYW4gbWFrZSBzb21lIGRlZmluaXRpb24gb24gdG9wIG9mIHRoZSBhbm90aGVyIGRlZmluaXRpb24pXHJcbi8vIC8vIGJvZGllcyBhcmUgYWxsb3dlZCB0byBoYXZlIHVzZXJEYXRhIG9uIHRoZW0gdGhhdCBpcyBqdXN0IHJlZmVyZW5jZSB0byBzb21lIG9iamVjdC5cclxuLy8gbWF5IGJlIHVzZWZ1bCBpbiBzb21lIHNpdHVhdGlvbnNcclxuLy9cclxuLy8gUXVlc3Rpb246XHJcbi8vIGRvZXMgaXQgbWFrZSBzZW5zZSB0byBhbGxvdyB1c2VycyB0byBwYXNzIGFueSBwcm9wZXJ0aWVzIGFzIHBhcnQgb2Ygb2JqZWN0IGRlZmluaXRpb25cclxuLy8gYW5kIGp1c3QgYXBwbHkgdGhvc2UgcHJvcGVydGllcyBhdXRvbWF0aWNhbGx5IHRvIHRoZSB1c2VyRGF0YSBwcm9wZXJ0eSBvZiBib2R5P1xyXG5cclxudmFyIEIyZENvbmZpZztcclxuXHJcbnZhciBQaHlzaWNzQ29udHJvbGxlciA9IChmdW5jdGlvbigpe1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHRpbmNsdWRlKCk7XHJcblxyXG5cdFx0QjJkQ29uZmlnID0gQ29uZmlnLkIyRDtcclxuXHJcblx0XHRQaHlzaWNzTW9kZWwuc2NhbGUgPSBCMmRDb25maWcuU0NBTEU7XHJcblx0XHRQaHlzaWNzTW9kZWwuc3RlcF9hbW91bnQgPSAxLyhCMmRDb25maWcuU1BTKTtcclxuXHJcblx0XHRQaHlzaWNzTW9kZWwuZ3Jhdml0eSA9IG5ldyBCMmQuYjJWZWMyKDAsMjApOyAvLyBlYXJ0aCBncmF2aXR5XHJcblx0XHRQaHlzaWNzTW9kZWwud29ybGQgPSBuZXcgQjJkLmIyV29ybGQoUGh5c2ljc01vZGVsLmdyYXZpdHksIHRydWUpO1xyXG5cclxuXHRcdGluaXRfY29sbGlzaW9uX2xpc3RlbmVyKCk7XHJcblxyXG5cdH07XHJcblx0XHJcblx0dmFyIHN0ZXAgPSBmdW5jdGlvbiAoZGVsdGFfbXMpIHtcclxuXHRcdC8vICE/IHNob3VsZCBJIHNldCB1cHBlciBsaW1pdCBvbiBkZWx0YSB0byBwcmV2ZW50IHdvcmxkIGZyb21cclxuXHRcdC8vIGZhc3QgZm9yd2FyZGluZyBpZiB0aGUgdGlja2VyIHdhcyBwYXVzZWQ/IG9yIHRoYXQgaXMgbm90IGEgcHJvYmxlbSBpbiBvdXIgY2FzZT9cclxuXHRcdC8vIGludmVzdGlnYXRpb24gaXMgbmVlZGVkXHJcblxyXG5cdFx0dmFyIGRlbHRhID0gZGVsdGFfbXMvMTAwMDtcclxuXHJcblx0XHRQaHlzaWNzTW9kZWwudGltZVRvQ292ZXIgKz0gZGVsdGE7XHJcblxyXG5cdFx0d2hpbGUgKFBoeXNpY3NNb2RlbC50aW1lVG9Db3ZlciA+IFBoeXNpY3NNb2RlbC5zdGVwX2Ftb3VudCkge1xyXG5cdFx0XHRQaHlzaWNzTW9kZWwudGltZVRvQ292ZXIgLT0gUGh5c2ljc01vZGVsLnN0ZXBfYW1vdW50O1xyXG5cdFx0XHRQaHlzaWNzTW9kZWwud29ybGQuU3RlcChcclxuXHRcdFx0XHRQaHlzaWNzTW9kZWwuc3RlcF9hbW91bnQsXHJcblx0XHRcdFx0QjJkQ29uZmlnLlBPU0lUSU9OX0lUUiwgLy8gdmVsb2NpdHkgaXRlcmF0aW9uc1xyXG5cdFx0XHRcdEIyZENvbmZpZy5WRUxPQ0lUWV9JVFIgLy8gcG9zaXRpb24gaXRlcmF0aW9uc1xyXG5cdFx0XHQpO1xyXG5cdFx0fVxyXG5cdH07ICAvLyBlbmQgc3RlcCBcclxuXHJcblx0dmFyIGRyYXdfZGVidWcgPSBmdW5jdGlvbigpe1xyXG5cdFx0aWYgKEIyZENvbmZpZy5kZWJ1Z19kcmF3KSB7XHJcblx0XHRcdFBoeXNpY3NNb2RlbC53b3JsZC5EcmF3RGVidWdEYXRhKCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0dmFyIGdldF9wYXJlbnRfY2hhaW4gPSBmdW5jdGlvbih0ZW1wbGF0ZSwgZGVmYXVsdF9kZWYpe1xyXG5cdFx0dmFyIG5leHQgPSB0ZW1wbGF0ZTtcclxuXHRcdHZhciBhbmNlc3RvcnMgPSBbXTtcclxuXHJcblx0XHR3aGlsZShuZXh0ICE9IG51bGwpe1xyXG5cdFx0XHRhbmNlc3RvcnMucHVzaChuZXh0KTtcclxuXHRcdFx0bmV4dCA9IG5leHRbXCJwYXJlbnRcIl07XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoZGVmYXVsdF9kZWYpe1xyXG5cdFx0XHRhbmNlc3RvcnMucHVzaChkZWZhdWx0X2RlZik7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGFuY2VzdG9ycztcclxuXHRcdFxyXG5cdH07XHJcblxyXG5cdHZhciBhcHBseV9wYXJlbnRzID0gZnVuY3Rpb24odGVtcGxhdGVfbmFtZSwgdGVtcGxhdGVfY29sbGVjdGlvbil7XHJcblx0XHQvLyBUT0RPOiByZWZhY3RvciB0aGUgY29kZSBzbyB0aGlzIHRoaW5nIGlzIGRvbmUgb25seSBvbmNlXHJcblx0XHQvLyBhdCB0aGUgbG9hZCB0aW1cclxuXHRcdC8vIHRoYXQgY291bGQgcHJvYmFibHkgYmUgZG9uZSBldmVuIGZvciBvdGhlciB0aGluZ3MuXHJcblx0XHQvLyBpZGVhOiBzdG9yZSBjb21waWxlZCBib2R5L2ZpeHR1cmUgZXRjLiB0b2dldGhlciB3aXRoIHRoZVxyXG5cdFx0Ly8gdGVtcGxhdGUuIHRoaXMgd2F5IHlvdSdsbCBoYXZlIGVhc3kgYWNjZXNzIHRvIHRoZSBhbGwgZGVmaW5lZFxyXG5cdFx0Ly8gb3B0aW9ucyBmb3IgZGVidWdnaW5nO1xyXG5cdFx0XHJcblx0XHR2YXIgZGVmYXVsdF90bXBsYXRlID0gdGVtcGxhdGVfY29sbGVjdGlvbltcImRlZmF1bHRcIl07XHJcblxyXG5cdFx0dmFyIGNoYWluID0gZ2V0X3BhcmVudF9jaGFpbih0ZW1wbGF0ZV9jb2xsZWN0aW9uW3RlbXBsYXRlX25hbWVdLCBkZWZhdWx0X3RtcGxhdGUpO1xyXG5cclxuXHRcdHZhciBmaW5hbF9kZWZpbml0aW9uID0ge307XHJcblxyXG5cdFx0Zm9yKHZhciBpID0gY2hhaW4ubGVuZ3RoIC0gMTsgaSA+PSAwIDsgaS0tKXtcclxuXHRcdFx0Ly8gbWF5IGJlIG5lZWRlZCB0byBiZSBtYWRlIG1vcmUgZWZmaWNpZW50IGJ5IG1vdmluZyB0aGUgb3RoZXIgd2F5XHJcblx0XHRcdC8vIGFuZCBub3QgY29uc2lkZXJpbmcgb3B0aW9ucyB0aGF0IHdlcmUgYWxyZWFkeSBlbmNvdW50ZXJlZCBpbiBjaGlsZHJlblxyXG5cdFx0XHR2YXIgY3VycmVudCA9IGNoYWluW2ldO1xyXG5cclxuXHJcblx0XHRcdGZvcih2YXIgcHJvcCBpbiBjdXJyZW50KXtcclxuXHRcdFx0XHRmaW5hbF9kZWZpbml0aW9uW3Byb3BdID0gY3VycmVudFtwcm9wXTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBmaW5hbF9kZWZpbml0aW9uO1xyXG5cdH07IC8vIGVuZCBhcHBseV9wYXJlbnRzXHJcblx0XHRcclxuXHR2YXIgdGFyZ2V0X3Byb3BzID0ge1xyXG5cdFx0Ym9keV9kZWY6IFtcclxuXHRcdFx0XCJhY3RpdmVcIixcclxuXHRcdFx0XCJhbGxvd1NsZWVwXCIsXHJcblx0XHRcdFwiYW5nbGVcIixcclxuXHRcdFx0XCJhbmd1bGFyRGFtcGluZ1wiLFxyXG5cdFx0XHRcImFuZ3VsYXJWZWxvY2l0eVwiLFxyXG5cdFx0XHRcImF3YWtlXCIsXHJcblx0XHRcdFwiYnVsbGV0XCIsXHJcblx0XHRcdFwiZml4ZWRSb3RhdGlvblwiLFxyXG5cdFx0XHRcImluZXJ0aWFTY2FsZVwiLFxyXG5cdFx0XHRcImxpbmVhckRhbXBpbmdcIixcclxuXHRcdFx0XCJsaW5lYXJWZWxvY2l0eVwiLFxyXG5cdFx0XHRcInBvc2l0aW9uXCIsXHJcblx0XHRcdFwidHlwZVwiLFxyXG5cdFx0XHQvL1widXNlckRhdGFcIiAvLyBkb2Vzbid0IHNlZW0gdG8gcHJvcGVybHkgd29yaywgZG9pbmcgaXQgZGlmZmVyZW50bHlcclxuXHRcdF0sXHJcblx0XHRmaXh0dXJlX2RlZjogW1xyXG5cdFx0XHRcImRlbnNpdHlcIixcclxuXHRcdFx0Ly9cImZpbHRlclwiLCBpbXBsZW1lbnQgbGF0ZXIgaWYgbmVlZGVkXHJcblx0XHRcdFwiZnJpY3Rpb25cIixcclxuXHRcdFx0XCJpc1NlbnNvclwiLFxyXG5cdFx0XHRcInJlc3RpdHV0aW9uXCIsXHJcblx0XHRcdFwic2hhcGVcIixcclxuXHRcdFx0XCJ1c2VyRGF0YVwiXHJcblx0XHRdXHJcblx0fTtcclxuXHJcblx0dmFyIGFwcGx5X3Byb3BlcnR5X2xpc3QgPSBmdW5jdGlvbihzb3VyY2UsIGRlc3RpbmF0aW9uLCBsaXN0KXtcclxuXHRcdC8qKlxyXG5cdFx0ICogdGFrZXMgdHdvIG9iamVjdHMgYW5kIHRoZSBsaXN0IG9mIHN0cmluZ3NcclxuXHRcdCAqIGNvcGllcyBhbGwgcHJvcGVydGllcyB3aXRoIG5hbWVzIGZvdW5kIGluIHRoZSBsaXN0XHJcblx0XHQgKiBmcm9tIHNvdXJjZSB0byBkZXN0aW5hdGlvblxyXG5cdFx0ICogc2NpcHMgcHJvcGVydGllcyB3aGljaCBhcmUgbnVsbC91bmRlZmluZWRcclxuXHRcdCAqL1xyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0dmFyIHByb3AgPSBsaXN0W2ldO1xyXG5cdFx0XHRpZihzb3VyY2VbcHJvcF0gIT0gbnVsbCl7XHJcblx0XHRcdFx0ZGVzdGluYXRpb25bcHJvcF0gPSBzb3VyY2VbcHJvcF07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZGVzdGluYXRpb247XHJcblx0fTtcclxuXHJcblx0dmFyIFByb3BlcnR5VW5kZWZpbmVkID0gZnVuY3Rpb24gUHJvcGVydHlVbmRlZmluZWQocHJvcGVydHlfbmFtZSl7XHJcblx0XHR0aGlzLm5hbWUgPSBcIlByb3BlcnR5VW5kZWZpbmVkXCI7XHJcblx0XHR0aGlzLm1lc3NhZ2UgPSBcIkVycm9yOiBcIiArIHByb3BlcnR5X25hbWUgKyBcIiBpcyBub3QgZGVmaW5lZFwiO1xyXG5cdH07XHJcblx0UHJvcGVydHlVbmRlZmluZWQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xyXG5cdFByb3BlcnR5VW5kZWZpbmVkLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFByb3BlcnR5VW5kZWZpbmVkO1xyXG5cclxuXHR2YXIgZ2V0X2Zvcm1hbF9ib2R5X2RlZiA9IGZ1bmN0aW9uKG5vbl9mb3JtYWxfZGVmKXtcclxuXHRcdC8qKlxyXG5cdFx0ICogdHVybiBub24gZm9ybWFsIGRlZmluaXRpb24gaW50byB0aGUgZm9ybWFsIG9uZVxyXG5cdFx0ICogbm9uLWZvcm1hbCBkZWZpbml0aW9uIGlzIGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zXHJcblx0XHQgKiBwcm9wZXJ0aWVzIFNPTUUgb2Ygd2hpY2ggYXJlIGJveDJkIHByb3BlcnRpZXMgb3IgYXJlIFxyXG5cdFx0ICogaW50ZW5kZWQgdG8gYmUgdHJhbnNmb3JtZWQgaW50byBzdWNoLiBFLmcuIHRoZSBub24tZm9ybWFsXHJcblx0XHQgKiBkZWZpbml0aW9uIG1heSBjb250YWluIHByb3BlcnRpZXMgdnggYW5kIHZ5IHdoaWNoIHdpbGwgYmUgdHJhbnNmb3JtZWRcclxuXHRcdCAqIGludG8gdGhlIGxpbmVhclZlbG9jaXR5IHZlY3RvciBpbiB0aGUgZm9ybWFsIGRlZmluaXRpb25cclxuXHRcdCAqL1xyXG5cclxuXHRcdHZhciBuZmRlZiA9IG5vbl9mb3JtYWxfZGVmO1xyXG5cclxuXHRcdHZhciBkZWZpbml0aW9uID0gbmV3IEIyZC5iMkJvZHlEZWYoKTtcclxuXHJcblx0XHRpZihuZmRlZi52eCAhPSBudWxsICYmIG5mZGVmLnZ5ICE9IG51bGwpe1xyXG5cdFx0XHQvLyBjaGVjayBmb3IgaW5mb3JtYWwgcGFyYW1ldGVyIHNwZWNpZmljYXRpb24gZmlyc3RcclxuXHRcdFx0bmZkZWYubGluZWFyVmVsb2NpdHkgPSBuZXcgQjJkLmIyVmVjMihuZmRlZi52eCwgbmZkZWYudnkpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdC8vIG1heWJlIHRoZSBsaW5lYXJWZWxvY2l0eSB3YXMgc3BlY2lmaWVkIGRpcmVjdGx5IGFzIHZlY3RvcixcclxuXHRcdFx0Ly8gYW5kIG5vdCB0aHJvdWdoIGluZm9ybWFsIHBhcmFtZXRlcnM7IGNoZWNraW5nIHRoYXQsIGFuZCBpZiBub3QsXHJcblx0XHRcdC8vIGV4Y2VwdGlvblxyXG5cdFx0XHRpZighKG5mZGVmLmxpbmVhclZlbG9jaXR5KSl7XHJcblx0XHRcdFx0dGhyb3cgbmV3IFByb3BlcnR5VW5kZWZpbmVkKFwibGluZWFyVmVsb2NpdHlcIik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZihuZmRlZi54ICE9IG51bGwgJiYgbmZkZWYueSAhPSBudWxsKXtcclxuXHRcdFx0Ly8gc2FtZSBwcm9jZWR1cmUgYXMgZm9yIHRoZSBsaW5lYXIgdmVsb2NpdHlcclxuXHRcdFx0Ly8gY2hlY2tpbmcgZm9yIGluZm9ybWFsIHNwZWNpZmljYXRpb24gaGVyZVxyXG5cdFx0XHQvLyBhbmQgaWYgcHJlc2VudCwgdHVybmluZyBpbnRvIHRoZSBmb3JtYWxcclxuXHRcdFx0bmZkZWYucG9zaXRpb24gPSBuZXcgQjJkLmIyVmVjMihuZmRlZi54LCBuZmRlZi55KTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHQvLyBjaGVja2luZyBpZiBmb3JtYWwgd2FzIHNwZWNpZmllZCBkaXJlY3RseVxyXG5cdFx0XHRpZighKG5mZGVmLnBvc2l0aW9uKSl7XHJcblx0XHRcdFx0Ly8gaWYgbm90LCB0aHJvdyBjdXN0b20gZXhjZXB0aW9uXHJcblx0XHRcdFx0dGhyb3cgbmV3IFByb3BlcnR5VW5kZWZpbmVkKFwicG9zaXRpb25cIik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZihuZmRlZi50eXBlKXtcclxuXHRcdFx0bmZkZWYudHlwZSA9IHtcclxuXHRcdFx0XHRcInN0YXRpY1wiOiBCMmQuYjJCb2R5LmIyX3N0YXRpY0JvZHksIFxyXG5cdFx0XHRcdFwiZHluYW1pY1wiOiBCMmQuYjJCb2R5LmIyX2R5bmFtaWNCb2R5LFxyXG5cdFx0XHRcdFwia2luZW1hdGljXCI6IEIyZC5iMkJvZHkuYjJfa2luZW1hdGljQm9keVxyXG5cdFx0XHR9W25mZGVmLnR5cGVdOyAvLyB0dXJuIHN0cmluZy10eXBlIGludG8gYjJkIHR5cGVcclxuXHRcdH1lbHNle1xyXG5cdFx0XHR0aHJvdyBuZXcgUHJvcGVydHlVbmRlZmluZWQoXCJ0eXBlXCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGFwcGx5X3Byb3BlcnR5X2xpc3QobmZkZWYsIGRlZmluaXRpb24sIHRhcmdldF9wcm9wcy5ib2R5X2RlZik7XHJcblxyXG5cdFx0cmV0dXJuIGRlZmluaXRpb247XHJcblxyXG5cdH07XHJcblxyXG5cdHZhciBnZXRfZm9ybWFsX2ZpeHR1cmVfZGVmID0gZnVuY3Rpb24obm9uX2Zvcm1hbF9kZWYpe1xyXG5cdFx0LyoqXHJcblx0XHQgKiB0dXJucyBub24tZm9ybWFsIGRlZmluaXRpb24gaW50byB0aGUgZm9ybWFsIG9uZVxyXG5cdFx0ICogc2VlIGdldF9mcm9tYWxfYm9keV9kZWYgZm9yIGV4cGxhbmF0aW9uXHJcblx0XHQgKi9cclxuXHJcblx0XHR2YXIgbmZkZWYgPSBub25fZm9ybWFsX2RlZjtcclxuXHRcdHZhciBzaGFwZSA9IG5mZGVmLnNoYXBlO1xyXG5cdFx0dmFyIGZpeHR1cmVfZGVmID0gbmV3IEIyZC5iMkZpeHR1cmVEZWYoKTtcclxuXHJcblx0XHRhcHBseV9wcm9wZXJ0eV9saXN0KG5vbl9mb3JtYWxfZGVmLCBmaXh0dXJlX2RlZiwgdGFyZ2V0X3Byb3BzLmZpeHR1cmVfZGVmKTtcclxuXHJcblx0XHRzd2l0Y2ggKHNoYXBlKSB7XHJcblx0XHRcdGNhc2UgXCJyZWN0YW5nbGVcIjpcclxuXHJcblx0XHRcdFx0aWYobmZkZWYud2lkdGggIT0gbnVsbCAmJiBuZmRlZi5oZWlnaHQgIT0gbnVsbCl7XHJcblx0XHRcdFx0XHRmaXh0dXJlX2RlZi5zaGFwZSA9IG5ldyBCMmQuYjJQb2x5Z29uU2hhcGUoKTtcclxuXHRcdFx0XHRcdGlmIChuZmRlZi5vZmZzZXQgIT0gbnVsbCl7XHJcblx0XHRcdFx0XHRcdHZhciBvZmZzZXQgPSBuZXcgQjJkLmIyVmVjMihuZmRlZi5vZmZzZXQueCAsbmZkZWYub2Zmc2V0LnkpO1xyXG5cdFx0XHRcdFx0XHRmaXh0dXJlX2RlZi5zaGFwZS5TZXRBc09yaWVudGVkQm94KG5mZGVmLndpZHRoLzIsIG5mZGVmLmhlaWdodC8yLCBvZmZzZXQsIDApO1xyXG5cdFx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHRcdGZpeHR1cmVfZGVmLnNoYXBlLlNldEFzQm94KG5mZGVmLndpZHRoLzIsIG5mZGVmLmhlaWdodC8yKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcIndpZHRoIG9yIGhlaWdodFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJwb2x5Z29uXCI6XHJcblxyXG5cdFx0XHRcdGlmKG5mZGVmLnBvaW50cyAhPSBudWxsKXtcclxuXHRcdFx0XHRcdGZpeHR1cmVfZGVmLnNoYXBlID0gbmV3IEIyZC5iMlBvbHlnb25TaGFwZSgpO1xyXG5cdFx0XHRcdFx0Zml4dHVyZV9kZWYuc2hhcGUuU2V0QXNBcnJheShuZmRlZi5wb2ludHMsIG5mZGVmLnBvaW50cy5sZW5ndGgpO1xyXG5cdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0dGhyb3cgbmV3IFByb3BlcnR5VW5kZWZpbmVkKFwicG9pbnRzXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBcImNpcmNsZVwiOlxyXG5cclxuXHRcdFx0XHRpZihuZmRlZi5yYWRpdXMgIT0gbnVsbCl7XHJcblx0XHRcdFx0XHRmaXh0dXJlX2RlZi5zaGFwZSA9IG5ldyBCMmQuYjJDaXJjbGVTaGFwZShuZmRlZi5yYWRpdXMpO1xyXG5cdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0dGhyb3cgbmV3IFByb3BlcnR5VW5kZWZpbmVkKFwicmFkaXVzXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHR0aHJvdyBcIkVycm9yOiBzaGFwZSBtdXN0IGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nOiBcIiArIFxyXG5cdFx0XHRcdFx0J1wicG9seWdvblwiLCBcInJlY3RhbmdsZVwiLCBcImNpcmNsZVwiLiBZb3Ugc3BlY2lmaWVkOiAnICtcclxuXHRcdFx0XHRcdFN0cmluZyhzaGFwZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGZpeHR1cmVfZGVmO1xyXG5cclxuXHR9O1xyXG5cdFxyXG5cclxuXHR2YXIgZ2V0X2JvZHkgPSBmdW5jdGlvbihub25fZm9ybWFsX2RlZiwgZW50aXR5X2luc3RhbmNlKXtcclxuXHRcdC8qKlxyXG5cdFx0ICogdGFrZXMgbm9uLWZvcm1hbCBkZWZpbml0aW9uXHJcblx0XHQgKiByZXR1cm5zIGJvZHkgYmFzZWQgb24gdGhpcyBkZWZpbml0aW9uXHJcblx0XHQgKlxyXG5cdFx0ICovXHJcblx0XHRpZiAoZW50aXR5X2luc3RhbmNlID09IG51bGwpe1xyXG5cdFx0dGhyb3cgbmV3IFByb3BlcnR5VW5kZWZpbmVkKFwiZW50aXR5X2luc3RhbmNlXCIpO1xyXG5cdFx0fVxyXG5cdFx0dmFyIGRlZmluaXRpb24gPSBnZXRfZm9ybWFsX2JvZHlfZGVmKG5vbl9mb3JtYWxfZGVmKTtcclxuXHJcblx0XHR2YXIgYm9keSA9IFBoeXNpY3NNb2RlbC53b3JsZC5DcmVhdGVCb2R5KGRlZmluaXRpb24pO1xyXG5cclxuXHRcdC8vaWYoYm9keS51c2VyRGF0YSA9PSBudWxsKXtcclxuXHRcdFx0Ly9ib2R5LnVzZXJEYXRhID0ge307XHJcblx0XHQvL31cclxuXHJcblx0XHQvLyBhcHBlbmQgcGFzc2VkIGRlZmluaXRpb24gdG8gdGhlIHVzZXIgZGF0YSBvZiB0aGUgYm9keVxyXG5cdFx0Ly8gZm9yIGRlYnVnZ2luZyBwdXJwb3NlcywgYW5kIGFsc28gdG8gYWxsb3cgZWFzeSBzcGVjaWZpY2F0aW9uIG9mIFxyXG5cdFx0Ly8gY3VzdG9tIHBhcmFtZXRlcnMgZHVyaW5nIGRlZmluaXRpb24uIElmIHRoaXMgd2lsbCBjYXVzZSBjb25mdXNpb24sXHJcblx0XHQvLyBJJ2xsIHJlbW92ZSB0aGF0XHJcblx0XHQvL2JvZHkudXNlckRhdGEuZGVmID0gbm9uX2Zvcm1hbF9kZWY7XHJcblx0XHRib2R5LlNldFVzZXJEYXRhKHtkZWY6IG5vbl9mb3JtYWxfZGVmLCBlbnRpdHlfaW5zdGFuY2U6IGVudGl0eV9pbnN0YW5jZX0pO1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gYm9keTtcclxuXHRcclxuXHR9O1xyXG5cclxuXHR2YXIgYXR0YWNoX2ZpeHR1cmUgPSBmdW5jdGlvbihib2R5LCBub25fZm9ybWFsX2RlZiwgZml4dHVyZV9uYW1lKXtcclxuXHRcdC8qKlxyXG5cdFx0ICogZ2l2ZW4gYjJkIGJvZHksIChub24tZm9ybWFsKSBmaXh0dXJlIGRlZmluaXRpb24gYW5kIChPUFRJT05BTCkgZml4dHVyZV9uYW1lXHJcblx0XHQgKiB0aGlzIGZ1bmN0aW9uIGF0dGFjaGVzIGZpeHR1cmUgdG8gdGhlIGJvZHlcclxuXHRcdCAqL1xyXG5cclxuXHRcdHZhciBmaXh0dXJlX2RlZiA9IGdldF9mb3JtYWxfZml4dHVyZV9kZWYobm9uX2Zvcm1hbF9kZWYpO1xyXG5cclxuXHRcdGlmKGZpeHR1cmVfZGVmLnVzZXJEYXRhID09IG51bGwpe1xyXG5cdFx0XHRmaXh0dXJlX2RlZi51c2VyRGF0YSA9IHt9O1xyXG5cdFx0fVxyXG5cclxuXHRcdGZpeHR1cmVfZGVmLnVzZXJEYXRhLmRlZiA9IG5vbl9mb3JtYWxfZGVmO1xyXG5cdFx0Zml4dHVyZV9kZWYudXNlckRhdGEubmFtZSA9IGZpeHR1cmVfbmFtZTtcclxuXHRcdFxyXG5cdFx0Ym9keS5DcmVhdGVGaXh0dXJlKGZpeHR1cmVfZGVmKTtcclxuXHRcdFxyXG5cdH07XHJcblxyXG5cdHZhciBhdHRhY2hfc2Vuc29ycyA9IGZ1bmN0aW9uKGJvZHkpe1xyXG5cdFx0dmFyIFNFTlNPUl9USElDS05FU1MgPSAwLjE7XHJcblx0XHRcclxuXHRcdC8vIGdldCB0aGUgd2lkdGggYW5kIGhlaWdodCBvZiB0aGUgYm9keSdzIG1haW4gZml4dHVyZVxyXG5cdFx0Ly8gYW5kIGNyZWF0ZSA0IHNlbnNvciBmaXh0dXJlcyBiYXNlZCBvbiB0aG9zZSBwYXJhbWV0ZXJzXHJcblx0XHQvLyBjYWxjdWxhdGUgb2Zmc2V0IG9mIHNlbnNvcnMgc28gdGhhdCB0aGV5IG1hdGNoIHRoZSBtYWluIGZpeHR1cmVcclxuXHRcdHZhciB4ID0gYm9keS5HZXRQb3NpdGlvbigpLng7XHJcblx0XHR2YXIgeSA9IGJvZHkuR2V0UG9zaXRpb24oKS55O1xyXG5cclxuXHRcdC8vIFRPRE86IGNoYW5nZSB0byBnZXR0aW5nIGRpbWVudGlvbnMgb2YgbWFpbiBmaXh0dXJlXHJcblx0XHR2YXIgaCA9IGJvZHkuR2V0Rml4dHVyZUxpc3QoKS5HZXRBQUJCKCkuR2V0RXh0ZW50cygpLnk7XHJcblx0XHR2YXIgdyA9IGJvZHkuR2V0Rml4dHVyZUxpc3QoKS5HZXRBQUJCKCkuR2V0RXh0ZW50cygpLng7XHJcblx0XHRcclxuXHRcdC8vYXR0YWNoIHRvcCBmaXh0dXJlXHJcblx0XHR2YXIgdG9wX3NlbnNvciA9IHt9O1xyXG5cdFx0dG9wX3NlbnNvci5zaGFwZSA9IFwicmVjdGFuZ2xlXCI7XHJcblx0XHR0b3Bfc2Vuc29yLmRlbnNpdHkgPSAwO1xyXG5cdFx0dG9wX3NlbnNvci5pc1NlbnNvciA9IHRydWU7XHJcblx0XHR0b3Bfc2Vuc29yLmhlaWdodCA9IFNFTlNPUl9USElDS05FU1M7XHJcblx0XHR0b3Bfc2Vuc29yLndpZHRoID0gdyoyIC0gU0VOU09SX1RISUNLTkVTUyoyO1xyXG5cdFx0dG9wX3NlbnNvci5vZmZzZXQgPSB7eDowLCB5OiAoLTEqaCkgKyBTRU5TT1JfVEhJQ0tORVNTLzJ9O1xyXG5cdFx0YXR0YWNoX2ZpeHR1cmUoYm9keSx0b3Bfc2Vuc29yLFwidG9wXCIpO1xyXG5cdFx0XHJcblx0XHQvL2F0dGFjaCBib3R0b20gZml4dHVyZVxyXG5cdFx0dmFyIGJvdHRvbV9zZW5zb3IgPSB0b3Bfc2Vuc29yO1xyXG5cdFx0Ym90dG9tX3NlbnNvci5vZmZzZXQgPSB7eDowLCB5OiBoIC0gU0VOU09SX1RISUNLTkVTUy8yfTtcclxuXHRcdGF0dGFjaF9maXh0dXJlKGJvZHksYm90dG9tX3NlbnNvcixcImJvdHRvbVwiKTtcclxuXHRcdFxyXG5cdFx0Ly9hdHRhY2ggbGVmdCBmaXh0dXJlXHJcblx0XHR2YXIgbGVmdF9zZW5zb3IgPSB0b3Bfc2Vuc29yO1xyXG5cdFx0bGVmdF9zZW5zb3IuaGVpZ2h0ID0gaCoyIC0gU0VOU09SX1RISUNLTkVTUyoyO1xyXG5cdFx0bGVmdF9zZW5zb3Iud2lkdGggPSBTRU5TT1JfVEhJQ0tORVNTO1xyXG5cdFx0bGVmdF9zZW5zb3Iub2Zmc2V0ID0ge3g6KC0xKncpICsgU0VOU09SX1RISUNLTkVTUy8yLHk6MH07XHJcblx0XHRhdHRhY2hfZml4dHVyZShib2R5LGxlZnRfc2Vuc29yLFwibGVmdFwiKTtcclxuXHRcdFxyXG5cdFx0Ly9hdHRhY2ggcmlnaHQgZml4dHVyZVxyXG5cdFx0dmFyIHJpZ2h0X3NlbnNvciA9IGxlZnRfc2Vuc29yO1xyXG5cdFx0cmlnaHRfc2Vuc29yLm9mZnNldCA9IHt4OncgLSBTRU5TT1JfVEhJQ0tORVNTLzIsIHk6MH07XHJcblx0XHRhdHRhY2hfZml4dHVyZShib2R5LHJpZ2h0X3NlbnNvcixcInJpZ2h0XCIpO1xyXG5cdH07XHJcblx0XHJcblx0XHJcblx0XHJcblxyXG5cdHZhciBnZXRfcmVjdGFuZ3VsYXIgPSBmdW5jdGlvbihkZWYsIGVudGl0eV9pbnN0YW5jZSl7XHJcblx0XHQvLyBnZXQgYXBwcm9wcmlhdGUgdGVtcGxhdGUgY29sbGVjdGlvbiB0byBkcmF3IGZyb21cclxuXHRcdHZhciB0ZW1wbGF0ZV9uYW1lID0gZW50aXR5X2luc3RhbmNlLnR5cGU7XHJcblx0XHR2YXIgdGVtcGxhdGVfY29sbGVjdGlvbiA9IFBoeXNpY3NNb2RlbC5yX3RlbXBsYXRlcztcclxuXHRcdHZhciBjb21waWxlZF90ZW1wbGF0ZSA9IGFwcGx5X3BhcmVudHModGVtcGxhdGVfbmFtZSwgdGVtcGxhdGVfY29sbGVjdGlvbik7XHJcblxyXG5cdFx0Ly8gYXBwbHkgY3VzdG9tIG92ZXJyaWRlXHJcblx0XHR2YXIgZmluYWxfZGVmID0gY29tcGlsZWRfdGVtcGxhdGU7XHJcblx0XHRmb3IodmFyIHByb3AgaW4gZGVmKXtcclxuXHRcdFx0ZmluYWxfZGVmW3Byb3BdID0gZGVmW3Byb3BdO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZpbmFsX2RlZi5zaGFwZSA9IFwicmVjdGFuZ2xlXCI7XHJcblxyXG5cdFx0Ly8gZmluYWxfZGVmIGNvbnRhaW5zIGFsbCBmaW5hbCBkYXRhLCBhYm91dCBib2R5IHdlIGFyZSBhYm91dCB0byBjcmVhdGVcclxuXHRcdC8vIGl0IHRha2VzIGludG8gYWNjb3VudCB0ZW1wbGF0ZSBnaXZlbiBhbmQgYWxsIGl0J3MgcGFyZW50c1xyXG5cdFx0Ly8gYW5kIGFsc28gbWFudWFsbHkgc3BlY2lmaWVkIHBhcmFtZXRlcnMuIEhvd2V2ZXIsIHRoaXMgZGVmaW5pdGlvbiBpcyByYXcsXHJcblx0XHQvLyBpLmUuIHNvbWUgZGF0YSBpbiBpdCBtYXkgbm90IGJlIGluIGl0cyBmaW5hbCBmb3JtLCBlLmcuIGxpbmVhciB2ZWxvY2l0eSBpcyBzcGVjaWZpZWRcclxuXHRcdC8vIGFzIHR3byBwYXJhbWV0ZXJzLCB2eCBhbmQgdnksIHdoaWxlIGl0IHdob3VsZCBiZSBjb252ZXJ0ZWQgaW50byB0aGUgdmVjdG9yXHJcblx0XHQvLyBmb3IgYm94MmQuIHNvIGZpbmFsX2RlZiBpcyBhIGZpbmFsIGRlc2NyaXB0aW9uLCBidXQgbm90IGluIGZpbmFsIGZvcm1cclxuXHJcblxyXG5cdFx0dmFyIGJvZHkgPSBnZXRfYm9keShmaW5hbF9kZWYsIGVudGl0eV9pbnN0YW5jZSk7XHJcblx0XHQgXHJcblx0XHRhdHRhY2hfZml4dHVyZShib2R5LCBmaW5hbF9kZWYsIFwibWFpblwiKTtcclxuXHRcdFxyXG5cdFx0Ly9JZiB0aGUgb2JqZWN0IGhhcyBkaXJlY3Rpb25hbCBzZW5zb3JzLCBhdHRhY2ggc2Vuc29ycyBoZXJlXHJcblx0XHRpZihmaW5hbF9kZWYuYm9yZGVyX3NlbnNvcnMpe1xyXG5cdFx0XHRhdHRhY2hfc2Vuc29ycyhib2R5KTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gYm9keTtcclxuXHR9O1xyXG5cclxuXHR2YXIgZ2V0X2NpcmN1bGFyID0gZnVuY3Rpb24oZGVmLCB0ZW1wbGF0ZSl7XHJcblx0XHR2YXIgdHlwZSA9IFwiY2lyY3VsYXJcIjtcclxuXHRcdC8vIGRvbnQnIGZvcmdldCBhYm91dCByZWZhY3RvcmluZyBzb21lIHN0dWZmIGludG8gdGhlXHJcblx0XHQvLyBzZXRfY29tbW9uIGZ1bmN0aW9uXHJcblx0XHRcclxuXHRcdHZhciBkZWZpbml0aW9uID0gbmV3IEIyZC5iMkJvZHlEZWYoKTtcclxuXHRcdFxyXG5cdH07XHJcblx0XHRcclxuXHR2YXIgZ2V0X3BvbHlnb25hbCA9IGZ1bmN0aW9uKGRlZiwgdGVtcGxhdGUpe1xyXG5cdFx0dmFyIHR5cGUgPSBcInBvbHlnb25hbFwiO1xyXG5cdFx0XHJcblx0XHR2YXIgZGVmaW5pdGlvbiA9IG5ldyBCMmQuYjJCb2R5RGVmKCk7XHJcblx0XHRcclxuXHR9O1xyXG5cclxuXHR2YXIgc2V0X2RlYnVnX2RyYXcgPSBmdW5jdGlvbihkZWJ1Z19kcmF3KXtcclxuXHRcdFBoeXNpY3NNb2RlbC53b3JsZC5TZXREZWJ1Z0RyYXcoZGVidWdfZHJhdyk7XHJcblx0fTtcclxuXHJcblxyXG5cdFxyXG5cdHZhciBsaXN0ZW5fZm9yX2NvbnRhY3Rfd2l0aCA9IGZ1bmN0aW9uKHdoYXQsIGNvbGxpc2lvbl9ldmVudF9uYW1lLCBjdXN0b21fZnVuY3Rpb24pe1xyXG5cdFx0LyoqXHJcblx0XHQgKiBzZXR1cHMgY3VzdG9tX2Z1bmN0aW9uIHRvIGJlIGNhbGxlZCBlYWNoIHRpbWUgdGhlIGNvbGxpc2lvbiBldmVudCBcclxuXHRcdCAqIG9jY3VycyBhbmQgaW52b2x2ZXMgPndoYXQ8XHJcblx0XHQgKiBUQUtFUzpcclxuXHRcdCAqIFx0PndoYXQ8XHJcblx0XHQgKiBcdFx0c3RyaW5nIFxyXG5cdFx0ICogXHRcdGlkIG9mIGFuIG9iamVjdCAoXCIzODNcIikgb3IgaXQncyB0eXBlIChcInBsYXllclwiKVxyXG5cdFx0ICogXHQ+Y29sbGlzaW9uX2V2ZW50X25hbWU8XHJcblx0XHQgKiBcdFx0c3RyaW5nLiBvbmUgb2Y6XHJcblx0XHQgKiBcdFx0QmVnaW5Db250YWN0LCBFbmRDb250YWN0LCBQcmVTb2x2ZSwgUG9zdFNvbHZlXHJcblx0XHQgKiBcdD5jdXN0b21fZnVuY3Rpb248IFxyXG5cdFx0ICogXHRcdGZ1bmN0aW9uXHJcblx0XHQgKiBcdFx0ZnVuY3Rpb24gdG8gYmUgY2FsbGVkIG9uIG9uZSBvZiB0aG9zZSBldmVudHNcclxuXHRcdCAqIFx0XHRub3RpY2UgdGhhdCBmdW5jdGlvbiB3aWxsIGJlIHdyYXBwZWQsIHNvIGl0IHNob3VsZFxyXG5cdFx0ICogXHRcdGFjY2VwdCBleHRyYSBwYXJhbWV0ZXIgPmluZm88IHRoYXQgd2lsbCBjb250YWluXHJcblx0XHQgKiBcdFx0dW5wYWNrZWQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGNvbGxpc2lvblxyXG5cdFx0ICovXHJcblxyXG5cclxuXHRcdGlmKHdoYXQgPT0gbnVsbCl7XHJcblx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcIndoYXRcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoXHJcblx0XHRcdGNvbGxpc2lvbl9ldmVudF9uYW1lICE9IFwiQmVnaW5Db250YWN0XCIgJiYgY29sbGlzaW9uX2V2ZW50X25hbWUgIT0gXCJFbmRDb250YWN0XCIgJiZcclxuXHRcdFx0Y29sbGlzaW9uX2V2ZW50X25hbWUgIT0gXCJQcmVTb2x2ZVwiICYmIGNvbGxpc2lvbl9ldmVudF9uYW1lICE9IFwiUG9zdFNvbHZlXCIgXHJcblx0XHQpe1xyXG5cdFx0XHR0aHJvdyBcImNvbGxpc2lvbl9ldmVudF9uYW1lIHNob3VsZCBiZSBvbmUgb2Y6IFByZVNvbHZlLCBQb3N0U29sdmUsIEVuZENvbnRhY3QsIEJlZ2luQ29udGFjdFwiO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKGN1c3RvbV9mdW5jdGlvbiA9PSBudWxsIHx8IHR5cGVvZihjdXN0b21fZnVuY3Rpb24pICE9IFwiZnVuY3Rpb25cIil7XHJcblx0XHRcdHRocm93IFwiUHJvcGVydHkgY3VzdG9tX2Z1bmN0aW9uIGlzIG5vdCBkZWZpbmVkIG9yIGlzbid0IGEgZnVuY3Rpb25cIlxyXG5cdFx0fVxyXG5cclxuXHRcdHZhciB0YXJnZXRfZnVuY3Rpb25fdGFibGUgPSBQaHlzaWNzTW9kZWwuYXdhaXRpbmdfY29udGFjdFtjb2xsaXNpb25fZXZlbnRfbmFtZV07IFxyXG5cclxuXHRcdGlmKHRhcmdldF9mdW5jdGlvbl90YWJsZVt3aGF0XSA9PSBudWxsKXtcclxuXHRcdFx0dGFyZ2V0X2Z1bmN0aW9uX3RhYmxlW3doYXRdID0gW2N1c3RvbV9mdW5jdGlvbl07XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0dGFyZ2V0X2Z1bmN0aW9uX3RhYmxlW3doYXRdLnB1c2goY3VzdG9tX2Z1bmN0aW9uKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHRcdFxyXG5cdHZhciBpbml0X2NvbGxpc2lvbl9saXN0ZW5lciA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcclxuXHRcdC8qKlxyXG5cdFx0ICovXHJcblx0XHRcclxuXHRcdHZhciBjYWxsX2FsbCA9IGZ1bmN0aW9uKGxpc3QsIGFyZ3MsIGluZm8pe1xyXG5cdFx0XHQvKipcclxuXHRcdFx0ICogY2FsbCBhbGwgZnVuY3Rpb25zIGluIGxpc3QgcHJvdmlkaW5nIGFyZ3VtZW50c1xyXG5cdFx0XHQgKiBmcm9tIHRoZSBhcnJheSBhcmdzXHJcblx0XHRcdCAqIGlmIGxpc3QgZ2l2ZSBpcyBudWxsL3VuZGVmaW5lZCwgZG8gbm90aGluZ1xyXG5cdFx0XHQgKi9cclxuXHJcblx0XHRcdGlmKGxpc3QgIT0gbnVsbCl7XHJcblx0XHRcdFx0YXJncy5wdXNoKGluZm8pO1xyXG5cdFx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0XHRcdGxpc3RbaV0uYXBwbHkodGhpcywgYXJncyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cclxuXHRcdHZhciBnZXRfaWQgPSBmdW5jdGlvbihvYmope1xyXG5cdFx0XHR1c2VyRGF0YSA9IG9iai5HZXRVc2VyRGF0YSgpO1xyXG5cdFx0XHRpZih1c2VyRGF0YSAhPSBudWxsICYmIHVzZXJEYXRhLmlkICE9IG51bGwpe1xyXG5cdFx0XHRcdHJldHVybiB1c2VyRGF0YS5pZDtcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0cmV0dXJuIFwiW05PX0lEXVwiXHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHR9O1xyXG5cclxuXHRcdHZhciBnZXRfdHlwZSA9IGZ1bmN0aW9uKG9iail7XHJcblx0XHRcdHZhciB1c2VyRGF0YSA9IG9iai5HZXRVc2VyRGF0YSgpO1xyXG5cdFx0XHRpZih1c2VyRGF0YSAhPSBudWxsICYmIHVzZXJEYXRhLmVudGl0eV9pbnN0YW5jZS50eXBlICE9IG51bGwpe1xyXG5cdFx0XHRcdHJldHVybiB1c2VyRGF0YS5lbnRpdHlfaW5zdGFuY2UudHlwZTtcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHR9O1xyXG5cclxuXHRcdHZhciB1bnBhY2tfY29udGFjdF9pbmZvID0gZnVuY3Rpb24oY29udGFjdCwgbXlfdHlwZSl7XHJcblx0XHRcdC8qKlxyXG5cdFx0XHQgKiB1bnBhY2tzIGluZm8gYWJvdXQgdGhlIGNvbGxpc2lvbiBhbmQgXHJcblx0XHRcdCAqIHJldHVybnMgaXRcclxuXHRcdFx0ICogPm15X3R5cGU8IGlzIGFuIHR5cGUgb2YgYW4gb2JqZWN0IHRoYXQgd2lsbFxyXG5cdFx0XHQgKiBnbyB1bmRlciB0aGUgPk1lPCBwYXJhbWVldGVyIGluc2lkZSBvZiBpbmZvXHJcblx0XHRcdCAqIChBcyBvcHBvc2VkIHRvIFRoZW0sIHdoaWNoIGlzIHRoZSBvdGhlciBvYmplY3QpXHJcblx0XHRcdCAqL1xyXG5cdFx0XHRpZihteV90eXBlID09IG51bGwpe1xyXG5cdFx0XHRcdC8vID5teV90eXBlPCBpc24ndCBzdXBwb3NlZCB0byBiZSBudWxsL3VuZGVmaW5lZFxyXG5cdFx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcIm15X3R5cGVcIik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHZhciBBID0ge307XHJcblx0XHRcdHZhciBCID0ge307XHJcblxyXG5cdFx0XHRBLmZpeHR1cmUgPSBjb250YWN0Lm1fZml4dHVyZUE7XHJcblx0XHRcdEIuZml4dHVyZSA9IGNvbnRhY3QubV9maXh0dXJlQjtcclxuXHRcdFx0QS5ib2R5ID0gQS5maXh0dXJlLkdldEJvZHkoKTtcclxuXHRcdFx0Qi5ib2R5ID0gQi5maXh0dXJlLkdldEJvZHkoKTtcclxuXHJcblx0XHRcdEEuaWQgPSBnZXRfaWQoQS5ib2R5KTtcclxuXHRcdFx0Qi5pZCA9IGdldF9pZChCLmJvZHkpO1xyXG5cclxuXHRcdFx0Ly9BLmVudGl0eSA9IElkZW50aWZpY2F0aW9uQ29udHJvbGxlci5nZXRfYnlfaWQoQS5pZCk7XHJcblx0XHRcdC8vQi5lbnRpdHkgPSBJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuZ2V0X2J5X2lkKEIuaWQpO1xyXG5cdFx0XHRBLmVudGl0eSA9IEEuYm9keS5HZXRVc2VyRGF0YSgpLmVudGl0eV9pbnN0YW5jZTtcclxuXHRcdFx0Qi5lbnRpdHkgPSBCLmJvZHkuR2V0VXNlckRhdGEoKS5lbnRpdHlfaW5zdGFuY2U7XHJcblxyXG5cdFx0XHRBLnR5cGUgPSBnZXRfdHlwZShBLmJvZHkpO1xyXG5cdFx0XHRCLnR5cGUgPSBnZXRfdHlwZShCLmJvZHkpO1xyXG5cclxuXHRcdFx0QS5maXh0dXJlX25hbWUgPSBnZXRfY3VzdG9tX3Byb3BlcnR5KEEuZml4dHVyZSwgXCJuYW1lXCIpO1xyXG5cdFx0XHRCLmZpeHR1cmVfbmFtZSA9IGdldF9jdXN0b21fcHJvcGVydHkoQi5maXh0dXJlLCBcIm5hbWVcIik7XHJcblxyXG5cdFx0XHQvLyBUT0RPOiB1bnBhY2sgbW9yZSBpbmZvIGlmIG5lY2Vzc2FyeVxyXG5cclxuXHRcdFx0dmFyIGluZm8gPSB7fTtcclxuXHJcblx0XHRcdGlmKEEudHlwZSA9PSBteV90eXBlKXtcclxuXHRcdFx0XHRpbmZvLk1lID0gQTtcclxuXHRcdFx0XHRpbmZvLlRoZW0gPSBCO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRpbmZvLk1lID0gQjtcclxuXHRcdFx0XHRpbmZvLlRoZW0gPSBBO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm4gaW5mbztcclxuXHRcdFx0XHJcblx0XHR9O1xyXG5cdFx0XHJcblx0XHR2YXIgY29tbW9uX2NvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0LCBhcmdzLCBsaXN0cyl7XHJcblx0XHRcdC8vIGNyZWF0ZSBpbmZvLCBjYWxsIHJlc3BlY3RpdmUgZnVuY3Rpb25zIGZvciBlYWNoIGlkLiB1c2UgcHJvdmlkZWQgYXJndW1lbnRzID5hcmdzPFxyXG5cdFx0XHQvLyBsb29rdXAgaWRzIGluIHRoZSBwcm92aWRlZCB0YWJsZSBvZiBsaXN0cyA+bGlzdHM8XHJcblx0XHRcdFxyXG5cdFx0XHR2YXIgdHlwZTEgPSBnZXRfdHlwZShjb250YWN0Lm1fZml4dHVyZUEuR2V0Qm9keSgpKTtcclxuXHRcdFx0dmFyIHR5cGUyID0gZ2V0X3R5cGUoY29udGFjdC5tX2ZpeHR1cmVCLkdldEJvZHkoKSk7XHJcblxyXG5cclxuXHRcdFx0aWYodHlwZTEgIT0gbnVsbCl7XHJcblx0XHRcdFx0dmFyIGluZm8gPSB1bnBhY2tfY29udGFjdF9pbmZvKGFyZ3NbMF0sIHR5cGUxKTtcclxuXHRcdFx0XHRjYWxsX2FsbChsaXN0c1t0eXBlMV0sIGFyZ3MsIGluZm8pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZih0eXBlMiAhPSBudWxsKXtcclxuXHRcdFx0XHR2YXIgaW5mbyA9IHVucGFja19jb250YWN0X2luZm8oYXJnc1swXSwgdHlwZTIpO1xyXG5cdFx0XHRcdGNhbGxfYWxsKGxpc3RzW3R5cGUyXSwgYXJncywgaW5mbyk7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9O1xyXG5cdFx0XHJcblx0XHR2YXIgUHJlU29sdmUgPSBmdW5jdGlvbihjb250YWN0LCBpbXB1bHNlKXtcclxuXHRcdFx0XHJcblx0XHRcdHZhciBsaXN0cyA9IFBoeXNpY3NNb2RlbC5hd2FpdGluZ19jb250YWN0LlByZVNvbHZlO1xyXG5cclxuXHRcdFx0dmFyIGFyZ3MgPSBbY29udGFjdCwgaW1wdWxzZV07XHJcblxyXG5cdFx0XHRjb21tb25fY29udGFjdChjb250YWN0LCBhcmdzLCBsaXN0cyk7XHJcblx0XHJcblx0XHR9O1xyXG5cdFx0XHJcblx0XHR2YXIgUG9zdFNvbHZlID0gZnVuY3Rpb24oY29udGFjdCwgb2xkTWFuaWZvbGQpe1xyXG5cdFx0XHR2YXIgbGlzdHMgPSBQaHlzaWNzTW9kZWwuYXdhaXRpbmdfY29udGFjdC5Qb3N0U29sdmU7XHJcblxyXG5cdFx0XHR2YXIgYXJncyA9IFtjb250YWN0LCBvbGRNYW5pZm9sZF07XHJcblxyXG5cdFx0XHRjb21tb25fY29udGFjdChjb250YWN0LCBhcmdzLCBsaXN0cyk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHZhciBCZWdpbkNvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0KXtcclxuXHRcdFx0dmFyIGxpc3RzID0gUGh5c2ljc01vZGVsLmF3YWl0aW5nX2NvbnRhY3QuQmVnaW5Db250YWN0O1xyXG5cclxuXHRcdFx0dmFyIGFyZ3MgPSBbY29udGFjdF07XHJcblxyXG5cdFx0XHRjb21tb25fY29udGFjdChjb250YWN0LCBhcmdzLCBsaXN0cyk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHZhciBFbmRDb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCl7XHJcblx0XHRcdHZhciBsaXN0cyA9IFBoeXNpY3NNb2RlbC5hd2FpdGluZ19jb250YWN0LkVuZENvbnRhY3Q7XHJcblxyXG5cdFx0XHR2YXIgYXJncyA9IFtjb250YWN0XTtcclxuXHJcblx0XHRcdGNvbW1vbl9jb250YWN0KGNvbnRhY3QsIGFyZ3MsIGxpc3RzKTtcclxuXHRcdH07XHJcblx0XHRcclxuXHRcdFxyXG5cdFx0XHJcblx0XHR2YXIgbGlzdGVuZXIgPSBuZXcgQjJkLmIyQ29udGFjdExpc3RlbmVyO1xyXG5cdFx0bGlzdGVuZXIuUHJlU29sdmUgPSBQcmVTb2x2ZTtcclxuXHRcdGxpc3RlbmVyLlBvc3RTb2x2ZSA9IFBvc3RTb2x2ZTtcclxuXHRcdGxpc3RlbmVyLkJlZ2luQ29udGFjdCA9IEJlZ2luQ29udGFjdDtcclxuXHRcdGxpc3RlbmVyLkVuZENvbnRhY3QgPSBFbmRDb250YWN0O1xyXG5cdFx0XHJcblx0XHRQaHlzaWNzTW9kZWwud29ybGQuU2V0Q29udGFjdExpc3RlbmVyKGxpc3RlbmVyKTtcclxuXHRcclxuXHR9O1xyXG5cclxuXHR2YXIgZ2V0X2N1c3RvbV9wcm9wZXJ0eSA9IGZ1bmN0aW9uKGIyZF9vYmosIHByb3BlcnR5X25hbWUpe1xyXG5cdFx0XHJcblx0XHQvKipcclxuXHRcdCAqIGdpdmVuIGFueSBib3gyZCBvYmplY3QgdGhhdCBoYXMgR2V0VXNlckRhdGEgbWV0aG9kXHJcblx0XHQgKiB0aGlzIGZ1bmN0aW9uIHdpbGwgcmV0dXJuIGN1c3RvbSBwcm9wZXJ0eSB3aXRoIGdpdmVuXHJcblx0XHQgKiBwcm9wZXJ0eV9uYW1lIGlmIHRoaXMgcHJvcGVydHkgaXMgc2V0IG9uIHVzZXJEYXRhIG9mIHRoZSBvYmplY3RcclxuXHRcdCAqIGlmIG5vdCwgdGhlIGZ1bmN0aW9uIHJldHVybnMgbnVsbFxyXG5cdFx0ICovXHJcblx0XHR2YXIgdXNlcl9kYXRhID0gYjJkX29iai5HZXRVc2VyRGF0YSgpO1xyXG5cdFx0aWYodXNlcl9kYXRhICYmIHVzZXJfZGF0YVtwcm9wZXJ0eV9uYW1lXSl7XHJcblx0XHRcdHJldHVybiB1c2VyX2RhdGFbcHJvcGVydHlfbmFtZV07XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHRcclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0Z2V0X2JvZHk6IGdldF9ib2R5LFxyXG5cdFx0Z2V0X3JlY3Rhbmd1bGFyOiBnZXRfcmVjdGFuZ3VsYXIsXHJcblx0XHRzdGVwOiBzdGVwLFxyXG5cdFx0aW5pdDogaW5pdCxcclxuXHRcdHNldF9kZWJ1Z19kcmF3OiBzZXRfZGVidWdfZHJhdyxcclxuXHRcdGRyYXdfZGVidWc6IGRyYXdfZGVidWcsXHJcblx0XHRsaXN0ZW5fZm9yX2NvbnRhY3Rfd2l0aDogbGlzdGVuX2Zvcl9jb250YWN0X3dpdGgsXHJcblx0fTtcclxufSkoKTtcclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFBoeXNpY3NDb250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiUGh5c2ljc0NvbnRyb2xsZXJcIiwgXHJcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFRcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwiXHJcbnZhciBSZWdpc3RlckFzQ29udHJvbGxlciA9IChmdW5jdGlvbigpe1xyXG5cdC8qIEFsbG93cyB5b3UgdG8gcmVnaXN0ZXIgb2JqZWN0IGFzIHNvbWV0aGluZyxcclxuXHQgKiBmb3Igb3RoZXIgbW9kdWxlcyB0byBhY2Nlc3NcclxuXHQgKiBPbmUgdXNlIGNvdWxkIGJlIHJlZ2lzdGVyaW5nIG5ld2x5IGdlbmVyYXRlZCB0ZXJyYWluIHNsaWNlIGZyb20gdGhlIHNsaWNlIGNvbnRyb2xsZXIsXHJcblx0ICogZm9yIHRoZSBHcmFwaGljc0NvbnRyb2xsZXIgdG8gbm90aWNlIGFuZCBnZW5lcmF0ZSBncmFwaGljcyBmb3IgaXRcclxuXHQqL1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiBpcyByYW4gZnJvbSB0aGUgSW5pdENvbnRyb2xsZXIgb25jZSB3aGVuIHRoZSBnYW1lIGlzIGxvYWRlZCAqL1xyXG5cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHNcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKGRlbHRhKXtcclxuXHRcdC8qIGlzIHJhbiBlYWNoIHRpY2sgZnJvbSB0aGUgR2FtZUNvbnRyb2xsZXIudXBkYXRlX2FsbCAqL1xyXG5cclxuXHRcdC8vIFRPRE86IGF1dG9tYXRpY2FsbHkgZGVsZXRlIHN0dWZmIGRlcGVuZGluZyBvbiB0aW1lb3V0IHN0dWZmXHJcblx0XHQvLyBjYWxjdWxhdGUgdGltZW91dCBvZiBcclxuXHR9O1xyXG5cclxuXHR2YXIgcmVnaXN0ZXJfYXMgPSBmdW5jdGlvbih3aGF0LCBvYmope1xyXG5cdFx0LyoqXHJcblx0XHQqIHNpbXBsZSBvbmUgdGltZSBsb29rdXAgcmVnaXN0ZXJpbmcgb2Ygb2JqZWN0XHJcblx0XHQqID53aGF0PCAtIHN0cmluZy4gZS5nLiBcIm5ld190ZXJyYWluX3NsaWNlXCJcclxuXHRcdCogPm9iajwgLSBvYmplY3QgdG8gcmVnaXN0ZXJcclxuXHRcdCovXHJcblx0XHRcclxuXHRcdHZhciB0YWJsZSA9IFJlZ2lzdGVyQXNNb2RlbC5zaW1wbGVfb25lX3RpbWVfbG9va3VwO1xyXG5cclxuXHRcdGlmKHRhYmxlW3doYXRdKXtcclxuXHRcdFx0dGFibGVbd2hhdF0ucHVzaChvYmopO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdHRhYmxlW3doYXRdID0gW29ial07XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0dmFyIHJldHJpZXZlX3JlZ2lzdGVyZWRfYXMgPSBmdW5jdGlvbih3aGF0KXtcclxuXHRcdC8qKlxyXG5cdFx0KiByZXR1cm5zIHJlZmVyZW5jZSB0byB0aGUgb2JqZWN0IGNvbnRhdGluaW5nXHJcblx0XHQqIHRoaW5ncyBjdXJyZW50bHkgcmVnaXN0ZXJlZCBhcyA+d2hhdDxcclxuXHRcdCogeW91IGFyZSByZXNwb25zaWJsZSBmb3IgcG9wcGluZyAob3Igbm90IHBvcHBpbmcpIHRoZW1cclxuXHRcdCogZnJvbSB0aGUgYXJyYXkgdG8gbm8gbG9uZ2VyIGNvbnNpZWRlciAob3IgY29udGludWUgdG8gY29uc2lkZXIpXHJcblx0XHQqIHRoZW0gYXMgcmVnaXN0ZXJlZCBhcyA+d2hhdDxcclxuXHRcdCovXHJcblx0XHR2YXIgbGlzdCA9IFJlZ2lzdGVyQXNNb2RlbC5zaW1wbGVfb25lX3RpbWVfbG9va3VwW3doYXRdO1xyXG5cdFx0aWYobGlzdCl7XHJcblx0XHRcdHJldHVybiBsaXN0O1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdHJldHVybiBbXTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdH07XHJcblx0XHJcblx0XHJcblx0cmV0dXJuIHtcclxuXHRcdC8vIGRlY2xhcmUgcHVibGljXHJcblx0XHRpbml0OiBpbml0LCBcclxuXHRcdHVwZGF0ZTogdXBkYXRlLFxyXG5cdFx0cmVnaXN0ZXJfYXM6IHJlZ2lzdGVyX2FzLFxyXG5cdFx0cmV0cmlldmVfcmVnaXN0ZXJlZF9hczogcmV0cmlldmVfcmVnaXN0ZXJlZF9hc1xyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFJlZ2lzdGVyQXNDb250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiUmVnaXN0ZXJBc0NvbnRyb2xsZXJcIiwgXHJcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFRcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwiXHJcbnZhciBUZXJyYWluQ29udHJvbGxlciA9IChmdW5jdGlvbigpe1xyXG5cdC8qIHRoaXMgd2lsbCBiZSB0aGUgcGh5c2ljYWwgcmVwcmVzZW50YXRpb24gb2YgdGhlIHRlcnJhaW5cclxuXHQgKiBjdXJyZW50bHkgaXQgY29udGFpbnMgZ3JhcGhpY2FsIGJpdHMsIGJ1dCB0aGF0IHdpbGwgY2hhbmdlXHJcblx0ICovXHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcclxuXHRcdGluY2x1ZGUoKTtcclxuXHR9O1xyXG5cdFxyXG5cclxuXHR2YXIgdXBkYXRlID0gZnVuY3Rpb24oKXtcclxuXHRcdC8vIGNoZWNrIGZvciBhbnkgY2h1bmtzIHRvIGJlIHVubG9hZGVkL2RlbGV0ZWQgd2lsbCBnbyBoZXJlLCBmb3Igbm93XHJcblx0XHQvLyBtYXliZSBpdCdsbCBjaGVjayBmb3IgYWxsIHBsYXllcnMgdG8gYmUgc3VmZmljaWVudGx5IGZhciB0byB0aGUgcmlnaHRcclxuXHRcdC8vIG9mIGl0LCBtYXliZSBvbmUgY2h1bmsgaW4gYWR2YW5jZSwgb3Igc210aCBsaWtlIHRoYXRcclxuXHRcdHdoaWxlKFRlcnJhaW5Nb2RlbC50ZXJyYWluX3NsaWNlc19xdWV1ZS5sZW5ndGggPCA0KXtcclxuXHRcdFx0dmFyIHNsaWNlID0gTmV3VGVycmFpblNsaWNlKCk7XHJcblx0XHRcdFRlcnJhaW5Nb2RlbC50ZXJyYWluX3NsaWNlc19xdWV1ZS5wdXNoKHNsaWNlKTtcclxuXHRcdH07XHJcblx0fTtcclxuXHJcblxyXG5cdHZhciBOZXdUZXJyYWluU2xpY2UgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogdGhpcyB0YWtlcyBjYXJlIG9mIGFwcGVuZGluZyBuZXcgdGVycmFpbiBzbGljZSB0byB0aGUgZ2VuZXJhdGVkIHRlcnJhaW5cclxuXHRcdCAqIGl0IGNhbGN1bGF0ZXMgaXQncyBvcmlnaW4geCBhbmQgeSBwb3NpdGlvbnMgYW5kIHdoYXRldmVyIG90aGVyIHN0dWZmLFxyXG5cdFx0ICogZ2VuZXJhdGVzIHNsaWNlOyBzZXRzIHVwIGV2ZXJ5dGhpbmdcclxuXHRcdCAqL1xyXG5cclxuXHRcdHZhciBzbGljZSA9IFRlcnJhaW5TbGljZUNvbnRyb2xsZXIuZ2VuZXJhdGUoKTtcclxuXHRcdE1hcmtBc05ld1RlcnJhaW5TbGljZShzbGljZSk7IC8vIHNvIHRoYXQgZ3JhcGhpY3MgYW5kIG90aGVyIHN0dWZmIHdpbGwgbm90aWNlXHJcblxyXG5cdFx0cmV0dXJuIHNsaWNlO1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgcmV0cmlldmVfd29ybGRfcGFyYW1ldGVycyA9IGZ1bmN0aW9uKCl7fTtcclxuXHRcclxuXHR2YXIgZm9yX2VhY2hfdGlsZSA9IGZ1bmN0aW9uKGYpe1xyXG5cdFx0Ly8gdGFrZXMgZnVuY3Rpb24gPmY8IHRoYXQgdGFrZXMgdGhyZWUgcGFyYW1ldGVyczogdGlsZSAoZXNlbGpzIG9iamVjdCksXHJcblx0XHQvLyB0ZXJyYWluX2x2bCAoaW50KSwgYW5kIHRpbGVfaW5kZXggKGludClcclxuXHRcdC8vIGNhbGxzIHRoaXMgZnVuY3Rpb24gZm9yIGV2ZXJ5IHRpbGUgb2YgdGhlIHRlcnJhaW5cclxuXHRcdFxyXG5cdFx0dmFyIHF1ZXVlcyA9IFRlcnJhaW5Nb2RlbC50ZXJyYWluX3F1ZXVlcztcclxuXHJcblx0XHQkLmVhY2gocXVldWVzLCBmdW5jdGlvbih0ZXJyYWluX2x2bCl7XHJcblx0XHRcdCQuZWFjaChxdWV1ZXNbdGVycmFpbl9sdmxdLCBmdW5jdGlvbih0aWxlX2luZGV4KXtcclxuXHRcdFx0XHRmKHF1ZXVlc1t0ZXJyYWluX2x2bF1bdGlsZV9pbmRleF0sIHRlcnJhaW5fbHZsLCB0aWxlX2luZGV4KTtcclxuXHRcdFx0fSk7XHJcblx0XHR9KTtcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIG1vdmVfbGVmdCA9IGZ1bmN0aW9uKHBpeGVscyl7XHJcblx0XHQvLyBTaG91bGQgSSBzY3JhcCB0aGlzIGZ1bmN0aW9uIGFuZCBqdXN0IHVzZSA+bW92ZTwsIG9yIGlzIHRoaXMgYSBoZWxwZnVsIHNob3J0Y3V0P1xyXG5cdFx0XHJcblx0XHRtb3ZlKCgtMSkqcGl4ZWxzLCAwKTtcclxuXHJcblx0fTsgLy8gZW5kIG1vdmVfbGVmdFxyXG5cdFxyXG5cdHZhciBtb3ZlID0gZnVuY3Rpb24ob2Zmc2V0X3gsIG9mZnNldF95KXtcclxuXHRcdGlmKG9mZnNldF94ICE9IDApe1xyXG5cdFx0XHRmb3JfZWFjaF90aWxlKGZ1bmN0aW9uKHRpbGUsIHRlcnJhaW5fbHZsLCB0aWxlX2luZGV4KXtcclxuXHRcdFx0XHR0aWxlLnggKz0gb2Zmc2V0X3g7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdH0vLyBmaVxyXG5cclxuXHRcdGlmKG9mZnNldF95ICE9IDApe1xyXG5cdFx0XHRmb3JfZWFjaF90aWxlKGZ1bmN0aW9uKHRpbGUsIHRlcnJhaW5fbHZsLCB0aWxlX2luZGV4KXtcclxuXHRcdFx0XHR0aWxlLnkgKz0gb2Zmc2V0X3k7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fTtcclxuXHJcblx0dmFyIE1hcmtBc05ld1RlcnJhaW5TbGljZSA9IGZ1bmN0aW9uKHNsaWNlKXtcclxuXHRcdFRlcnJhaW5Nb2RlbC5uZXdfc2xpY2VzLnB1c2goc2xpY2UpO1xyXG5cdH07XHJcblxyXG5cdHZhciBOZXdTbGljZXNBdmFpbGFibGUgPSBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIChUZXJyYWluTW9kZWwubmV3X3NsaWNlcy5sZW5ndGggPiAwKTtcclxuXHR9O1xyXG5cclxuXHR2YXIgR2V0TmV3VGVycmFpblNsaWNlcyA9IGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gVGVycmFpbk1vZGVsLm5ld19zbGljZXM7XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdG1vdmVfbGVmdDogbW92ZV9sZWZ0LFxyXG5cdFx0bW92ZTogbW92ZSxcclxuXHRcdHVwZGF0ZTogdXBkYXRlLFxyXG5cdFx0aW5pdDogaW5pdCxcclxuXHRcdE5ld1RlcnJhaW5TbGljZTogTmV3VGVycmFpblNsaWNlLFxyXG5cdFx0TWFya0FzTmV3VGVycmFpblNsaWNlOiBNYXJrQXNOZXdUZXJyYWluU2xpY2UsXHJcblx0XHROZXdTbGljZXNBdmFpbGFibGU6IE5ld1NsaWNlc0F2YWlsYWJsZSxcclxuXHRcdEdldE5ld1RlcnJhaW5TbGljZXM6IEdldE5ld1RlcnJhaW5TbGljZXMsXHJcblx0fVxyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBUZXJyYWluQ29udHJvbGxlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIlRlcnJhaW5Db250cm9sbGVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUXHJcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cclxuXHJcbiIsIlxyXG52YXIgVGVycmFpblNsaWNlQ29udHJvbGxlciA9IChmdW5jdGlvbiAoKSB7XHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcclxuXHRcdC8qIGlzIHJhbiBmcm9tIHRoZSBJbml0Q29udHJvbGxlciBvbmNlIHdoZW4gdGhlIGdhbWUgaXMgbG9hZGVkICovXHJcblx0XHRpbmNsdWRlKCk7IC8vIHNhdGlzZnkgcmVxdWlyZW1lbnRzXHJcblx0XHRJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuYXNzaWduX3R5cGUoVGVycmFpblNsaWNlTW9kZWwuQ2VsbCwgXCJ0ZXJyYWluX2NlbGxcIik7XHJcblxyXG5cdH07XHJcblxyXG5cdHZhciB1cGRhdGUgPSBmdW5jdGlvbihzbGljZSl7XHJcblx0XHRcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIGdldF9uZXh0X29yaWdpbiA9IGZ1bmN0aW9uKCl7XHJcblx0fTtcclxuXHJcblx0dmFyIGdlbmVyYXRlID0gZnVuY3Rpb24oKXtcclxuXHJcblx0XHR2YXIgc2xpY2UgPSBuZXcgVGVycmFpblNsaWNlTW9kZWwuU2xpY2UoKTtcclxuXHJcblx0XHRzbGljZS5vcmlnaW4ueCA9IHNsaWNlLmlkICogc2xpY2UuZ3JpZF9jb2x1bW5zICogc2xpY2UuY2VsbF93O1xyXG5cdFx0c2xpY2Uub3JpZ2luLnkgPSAwO1xyXG5cclxuXHRcdC8vIFRPRE86IGlkJ3MgaW4gdGhpcyBmdW5jdGlvbiBzaG91bGQgYmUgYWN0dWFsbHkgY2FsbGVkIHR5cGVzIGFuZCByZWdpc3RlcmVkIGFjY29yZGluZ2x5XHJcblxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNsaWNlLmdyaWRfcm93czsgaSsrKXtcclxuXHRcdFx0LyogXHRhc3NpZ25pbmcgaWQnc1xyXG5cdFx0XHRcdHRoYXQgaXMgdGhlIGZpcnN0IHBhc3MuIGxhdGVyIGl0IG1heSBiZSB1c2VkIHRvIGxheW91dCBnZW5lcmFsIGZvcm0gb2YgdGhlIHRlcnJhaW5cclxuXHRcdFx0ICAgXHRhc3NpZ25pbmcgZWFjaCBjZWxsIGluIHRoZSBncmlkIHNvbWUgcm9sZSwgbWFya2VkIGJ5IGl0cyBpZC5cclxuXHRcdFx0IFx0dGhhdCByb2xlIG1heSBpbmNsdWRlIGZvciBpdCB0byBiZSBhIHBpZWNlIG9mIHRoZSBiaWdnZXIgb2JqZWN0ID4+PlxyXG5cdFx0XHQqL1xyXG5cclxuXHRcdFx0c2xpY2UuZ3JpZFtpXSA9IFtdO1xyXG5cdFx0XHR2YXIgbHZsID0gc2xpY2UuZ3JpZF9yb3dzIC0gaTsgLy8gbGV2ZWwgZnJvbSB0aGUgYm90dG9tXHJcblx0XHRcdHZhciBwcm9iID0gVGVycmFpblNsaWNlTW9kZWwubHZsX3Byb2JbbHZsXTtcclxuXHJcblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBzbGljZS5ncmlkX2NvbHVtbnM7IGorKyl7XHJcblx0XHRcdFx0aWYocHJvYil7XHJcblx0XHRcdFx0XHR2YXIgcmFuZG9tX2lkID0gR2FtZVV0aWxpdHkucmFuZG9tX2Nob2ljZShwcm9iLCBbMSwgMiwgM10pOyAvLyBjaG9zZSByYW5kb20gdGVycmFpbiB0aWxlIGlkXHJcblx0XHRcdFx0XHQvLyB0aGUgdGlsZSBpbiB0aGUgZ3JpZCBtaWdodCBiZSBtYWRlIHRvIGJlIHNlcGFyYXRlIG9iamVjdCBsYXRlclxyXG5cdFx0XHRcdFx0Ly8gdGhlIHRpbGVfaWQgd2lsbCBkZXRlcm1pbmUgdGhlIHR5cGUgb2Ygb2JqZWN0IGluIHRoYXQgdGlsZSxcclxuXHRcdFx0XHRcdC8vIHN1Y2ggYXMgdHlwZSBvZiB0ZXJyYWluIGV0Yy4gdGhlIHRpbGVzIHdpdGggZGlmZmVyZW50IGlkJ3MgZG8gbm90XHJcblx0XHRcdFx0XHQvLyBuZWNlc3NhcmlseSBkaWZmZXIgaW4gcGh5c2ljcyByZXByZXNlbnRhdGlvbiwgdGhleSBtaWdodCBqdXN0IGhhdmVcclxuXHRcdFx0XHRcdC8vIGRpZmZlcmVudCBhcHBlYXJhbmNlXHJcblx0XHRcdFx0XHRzbGljZS5ncmlkW2ldW2pdID0gbmV3IFRlcnJhaW5TbGljZU1vZGVsLkNlbGwocmFuZG9tX2lkKTtcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdC8vIDAgd2lsbCBiZSB0aGUgaWQgZm9yIHRoZSBcImFpclwiIGkuZS4gbm90aGluZ1xyXG5cdFx0XHRcdFx0c2xpY2UuZ3JpZFtpXVtqXSA9IG5ldyBUZXJyYWluU2xpY2VNb2RlbC5DZWxsKDApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSAvLyBmb3IgZW5kXHJcblx0XHRcdC8vIDw8PCBhc3NpZ25pbmcgaWRzXHJcblx0XHRcdFxyXG5cdFx0fSAvLyBmb3IgZW5kXHJcblxyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzbGljZS5ncmlkX3Jvd3M7IGkrKyl7XHJcblx0XHRcdC8qXHRjcmVhdGluZyBwaHlzaWNzIHJlcHJlc2VudGF0aW9uc1xyXG5cdFx0XHQgKlx0Mm5kIHBhc3M7IHRoaXMgd2lsbCBiZSB1c2VkIHRvIGNyZWF0ZSBhbGwgdGhlIG9iamVjdHMgYW5kIHN1Y2hcclxuXHRcdFx0ICpcdHBoeXNpY3Mtd2lzZS4gSXQgbWF5IGV4YW1pbmUgaWQncyBvZiB0aGUgYWRqYWNlbnQgdGlsZXMgdG8gZmluZFxyXG5cdFx0XHQgKlx0bGFyZ2VyIHBpZWNlcyBvZiB0ZXJyYWluIHRvIHVuaXRlIHVuZGVyIHRoZSBjb21tb24gYm91bmRpbmcgYm94XHJcblx0XHRcdCAqXHRpZiB0aGV5IGhhdmUgc2ltaWxhciBlbm91Z2ggcHJvcGVydGllcyBvciBiZWxvbmcgdG9nZXRoZXIgZm9yIHNvbWUgcmVhc29uXHJcblx0XHRcdCAqL1xyXG5cclxuXHRcdFx0dmFyIGx2bCA9IHNsaWNlLmdyaWRfcm93cyAtIGk7IC8vIGxldmVsIGZyb20gdGhlIGJvdHRvbVxyXG5cclxuXHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IHNsaWNlLmdyaWRfY29sdW1uczsgaisrKXtcclxuXHRcdFx0XHR2YXIgaWQgPSBzbGljZS5ncmlkW2ldW2pdLmlkO1xyXG5cdFx0XHRcdGlmKGlkICE9IDApeyAvLyBpZiBub3QgYWlyXHJcblx0XHRcdFx0XHR2YXIgeCA9IHNsaWNlLm9yaWdpbi54ICsgaiAqIHNsaWNlLmNlbGxfdyArIHNsaWNlLmNlbGxfdy8yO1xyXG5cdFx0XHRcdFx0dmFyIHkgPSBzbGljZS5vcmlnaW4ueSArIGkgKiBzbGljZS5jZWxsX3cgKyBzbGljZS5jZWxsX3cvMjtcclxuXHRcdFx0XHRcdHZhciBib2R5ID0gUGh5c2ljc0NvbnRyb2xsZXIuZ2V0X3JlY3Rhbmd1bGFyKHt4OiB4LCB5OiB5fSwgc2xpY2UuZ3JpZFtpXVtqXSk7XHJcblx0XHRcdFx0XHRzbGljZS5ncmlkW2ldW2pdLmJvZHkgPSBib2R5O1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdH0gLy8gZW5kIGZvclxyXG5cclxuXHRcdH0vL2VuZCBmb3JcclxuXHRcdFxyXG5cdFx0cmV0dXJuIHNsaWNlO1xyXG5cdH07XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHQvLyBkZWNsYXJlIHB1YmxpY1xyXG5cdFx0aW5pdDogaW5pdCwgXHJcblx0XHR1cGRhdGU6IHVwZGF0ZSxcclxuXHRcdGdlbmVyYXRlOiBnZW5lcmF0ZSxcclxuXHR9O1xyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBUZXJyYWluU2xpY2VDb250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiVGVycmFpblNsaWNlQ29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJ2YXIgVGVzdENvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKXtcclxuXHQvLyBwbGFjZWhvbGRlciBmb3IgaW1wbGVtZW50aW5nIHRlc3RpbmdcclxuXHQvLyBtYXkgYmUgY2hhbmdlZC9yZW1vdmVkL3VwZ3JhZGVkIGRlcGVuZGluZyBvbiBob3cgd2Ugd2lsbCBoYW5kbGUgb3VyIHRlc3RzXHJcblx0XHJcblx0XHJcblx0dmFyIHByZWluaXRfdGVzdHMgPSBmdW5jdGlvbigpe1xyXG5cdC8vRm9yIHRlc3RzIHJlcXVpcmluZyBydW4gYmVmb3JlIGluaXQgaXMgY2FsbGVkXHJcblx0XHJcblx0XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHR2YXIgdGVzdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvLyBpZiB5b3UgbmVlZCBzb21lIHNvcnQgb2YgdGVzdHMgbGF1bmNoZWQsIHRoaXMgaXMgb25lIG9mIHRoZSBwbGFjZXMgdG8gZG8gaXRcclxuXHRcdFFVbml0LnRlc3QoIFwiaGVsbG8gdGVzdFwiLCBmdW5jdGlvbiggYXNzZXJ0ICkge1xyXG5cdFx0XHRhc3NlcnQub2soIDEgPT0gXCIxXCIsIFwiUGFzc2VkIVwiICk7XHJcblx0XHR9KTtcclxuXHRcdEluY2x1ZGVzLmF1dG9tYXRlZF90ZXN0cygpO1xyXG5cdH07XHJcblxyXG5cdHZhciBwb3N0X2xvYWRpbmdfdGVzdHMgPSBmdW5jdGlvbigpe1xyXG5cdFx0Ly8gVE9ETzogY2FsbCB3aGVuIGxvYWRpbmcgYXNzZXRzIGlzIGNvbXBsZXRlZCBpZiB0aGVyZSBhcmUgc29tZSB0ZXN0cyB0aGF0IG5lZWRcclxuXHRcdC8vIHRvIGJlIGRvbmUgYXQgdGhhdCBtb21lbnQuIChSZWZlciB0byBJbml0Q29udHJvbGxlci5pbml0IGFuZCBcclxuXHRcdC8vIEluaXRDb250cm9sbGVyLnNldHVwX2Fzc2V0X2RlcGVuZGVudCBtZXRob2RzXHJcblx0fTtcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbihtb2RlKXtcclxuXHRcdGluY2x1ZGUoKTtcclxuXHRcdC8vIFNldHMgdXAgdGhlIGRlYnVnIGNhbnZhcyBkdXJpbmcgdGVzdGluZ1xyXG5cdFx0VGVzdE1vZGVsLmRfY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoQ29uZmlnLkRFQlVHX0NBTlZBU19OQU1FKTtcclxuXHJcblx0XHRpZihtb2RlID09IFwidGVzdFwiKXtcclxuXHRcdFx0VGVzdE1vZGVsLmNvbnRleHQgPSBUZXN0TW9kZWwuZF9jYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG5cdFx0XHRcclxuXHRcdFx0VGVzdE1vZGVsLmRlYnVnRHJhdyA9IG5ldyBCMmQuYjJEZWJ1Z0RyYXcoKTtcclxuXHRcdFx0VGVzdE1vZGVsLmRlYnVnRHJhdy5TZXRTcHJpdGUoVGVzdE1vZGVsLmNvbnRleHQpO1xyXG5cdFx0XHRUZXN0TW9kZWwuZGVidWdEcmF3LlNldERyYXdTY2FsZShDb25maWcuQjJELlNDQUxFKTtcclxuXHRcdFx0VGVzdE1vZGVsLmRlYnVnRHJhdy5TZXRGaWxsQWxwaGEoMC4zKTtcclxuXHRcdFx0VGVzdE1vZGVsLmRlYnVnRHJhdy5TZXRMaW5lVGhpY2tuZXNzKDEuMCk7XHJcblx0XHRcdFRlc3RNb2RlbC5kZWJ1Z0RyYXcuU2V0RmxhZ3MoQjJkLmIyRGVidWdEcmF3LmVfc2hhcGVCaXQgfCBCMmQuYjJEZWJ1Z0RyYXcuZV9qb2ludEJpdCk7XHJcblxyXG5cdFx0XHRQaHlzaWNzQ29udHJvbGxlci5zZXRfZGVidWdfZHJhdyhUZXN0TW9kZWwuZGVidWdEcmF3KTtcclxuXHJcblx0XHRcdENvbmZpZy5CMkQuZGVidWdfZHJhdyA9IHRydWU7XHJcblx0XHRcdC8vIFNjcmVlbl9XIHdhcyBzZXR1cCBvbmx5IGFmdGVyIHRoaXMgd2FzIGNhbGxlZFxyXG5cclxuXHRcdFx0VGVzdE1vZGVsLmRfY2FudmFzLndpZHRoID0gQ29uZmlnLlNDUkVFTl9XO1xyXG5cdFx0XHRUZXN0TW9kZWwuZF9jYW52YXMuaGVpZ2h0ID0gQ29uZmlnLlNDUkVFTl9IO1xyXG5cclxuXHRcdFx0Ly8kKCcjJytDb25maWcuREVCVUdfQ0FOVkFTX05BTUUpLnNob3coKTtcclxuXHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0Ly9kX2NhbnZhcy5oaWRlKCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHQvL3RoaXMgZnVuY3Rpb24gc2V0cyB0aGUgeCBhbmQgeSBvZmZzZXRzIG9mIHRoZSBkZWJ1ZyBjYW52YXNcclxuXHR2YXIgc2V0X2RlYnVnX29mZnNldCA9IGZ1bmN0aW9uKHhfb2Zmc2V0LCB5X29mZnNldCl7XHJcblx0XHRjb250ZXh0ID0gVGVzdE1vZGVsLmNvbnRleHQ7XHJcblx0XHRjb250ZXh0LnNhdmUoKTtcclxuXHRcdGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIENvbmZpZy5TQ1JFRU5fVywgQ29uZmlnLlNDUkVFTl9IKTtcclxuXHRcdGNvbnRleHQudHJhbnNsYXRlKHhfb2Zmc2V0LCB5X29mZnNldCk7XHJcblx0XHRQaHlzaWNzQ29udHJvbGxlci5kcmF3X2RlYnVnKCk7XHJcblx0XHRjb250ZXh0LnJlc3RvcmUoKTtcclxuXHR9O1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0aW5pdDogaW5pdCwgXHJcblx0XHR0ZXN0OiB0ZXN0LFxyXG5cdFx0cG9zdF9sb2FkaW5nX3Rlc3RzOiBwb3N0X2xvYWRpbmdfdGVzdHMsXHJcblx0XHRwcmVpbml0X3Rlc3RzOiBwcmVpbml0X3Rlc3RzLFxyXG5cdFx0c2V0X2RlYnVnX29mZnNldDogc2V0X2RlYnVnX29mZnNldFxyXG5cdH1cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gVGVzdENvbnRyb2xsZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRjdXJyZW50X21vZHVsZTogXCJUZXN0Q29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJcdFxyXG52YXIgV29ybGRDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0LyogYWxsIHRoZSBwaHlzaWNzIGNvbnRyb2wgb2YgdGhlIHdob2xlIHdvcmxkXHJcblx0Ki9cclxuXHJcbiAgICB2YXIgYm9keV90ZXN0O1xyXG4gICAgdmFyIGJvZHlfdGVzdDI7XHJcblx0Ly92YXIgdGVtcCA9IDA7XHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcclxuXHRcdC8qIGlzIHJhbiBmcm9tIHRoZSBJbml0Q29udHJvbGxlciBvbmNlIHdoZW4gdGhlIGdhbWUgaXMgbG9hZGVkICovXHJcblxyXG5cdFx0aW5jbHVkZSgpOyAvLyBzYXRpc2Z5IHJlcXVpcmVtZW50c1xyXG5cclxuXHRcdGJvZHlfdGVzdCA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7fSwgXCJ0ZXN0XCIpO1xyXG5cdFx0Ym9keV90ZXN0MiA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7fSwgXCJwbGF0Zm9ybVwiKTtcclxuXHR9O1xyXG5cclxuXHR2YXIgdXBkYXRlID0gZnVuY3Rpb24oZGVsdGEpe1xyXG5cdFx0LyogaXMgcmFuIGVhY2ggdGljayBmcm9tIHRoZSBHYW1lQ29udHJvbGxlci51cGRhdGVfYWxsICovXHJcblx0XHRQaHlzaWNzQ29udHJvbGxlci5zdGVwKGRlbHRhKTtcclxuXHJcblx0XHQvL2lmKHRlbXArKyA9PSAwKXtcclxuXHRcdFx0Ly9UZXJyYWluQ29udHJvbGxlci5OZXdUZXJyYWluU2xpY2UoKTtcclxuXHRcdC8vfVxyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgTWFya0FzTmV3VGVycmFpblNsaWNlID0gZnVuY3Rpb24oc2xpY2Upe1xyXG5cdFx0XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdC8vIGRlY2xhcmUgcHVibGljXHJcblx0XHRpbml0OiBpbml0LCBcclxuXHRcdHVwZGF0ZTogdXBkYXRlLFxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFdvcmxkQ29udHJvbGxlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIldvcmxkQ29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJ2YXIgR2FtZVV0aWxpdHkgPSAoZnVuY3Rpb24oKVxyXG57XHJcbiAgZnVuY3Rpb24gYXJyb3dfa2V5X3Njcm9sbGluZyhmbGFnKSB7XHJcbiAgICAvLyBDb25maWd1cmVzIGFycm93IGtleSBzY3JvbGxpbmcgZm9yIGNhbnZhc1xyXG4gICAgaWYgKGZsYWcgPT0gZmFsc2UpIHtcclxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChlKSB7IC8vIC5nZXRFbGVtZW50QnlJZChcImRpc3BsYXlfY2FudmFzXCIpXHJcbiAgICAgICAgYXJyb3dzID0gWzM3LCAzOCwgMzksIDQwXTtcclxuICAgICAgICBpZiAoYXJyb3dzLmluZGV4T2YoZS5rZXlDb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcblx0dmFyIGxnID0gZnVuY3Rpb24oKVxyXG5cdHtcclxuXHRcdC8qXHJcblx0XHQgKiBzaG9ydGN1dCB0byBjb25zb2xlLmxvZygpXHJcblx0XHQgKiBwcmludHMgYWxsIGFyZ3VtZW50cyB0byBjb25zb2xlXHJcblx0XHQgKiBmaXJzdCBhcmd1bWVudCBpcyB1c2VkIGFzIGEgbGFiZWwgZm9yIHRoZSByZXN0XHJcblx0XHQgKlxyXG5cdFx0ICogZWFjaCBsYWJlbGVkIGdyb3VwIGlzIGVuY2xvc2VkIGludG8gdGhlIGNvbG9yZWQgZGVsaW1pdGVyc1xyXG5cdFx0ICogPj4+IGFuZCA8PDwgc28gaXQncyBlYXNpbHkgZGlzdGluZ3Vpc2hlZC4gSSBmb3VuZCBpdCBoZWxwZnVsLFxyXG5cdFx0ICogaWYgeW91IGRvbid0IGxldCBtZSBrbm93LCBvciB1c2Ugc29tZXRoaW5nIGVsc2VcclxuXHRcdCAqL1xyXG5cdFx0Y29uc29sZS5sb2coXCIlcyAlYyAlc1wiLCBhcmd1bWVudHNbMF0sIFwiYmFja2dyb3VuZDogI0RBRjJCMVwiLCBcIj4+PlwiKTtcclxuXHRcdFxyXG5cdFx0Zm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuXHRcdHtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJcXHRcIiwgYXJndW1lbnRzW2ldKTtcclxuXHRcdH1cclxuXHRcdGNvbnNvbGUubG9nKFwiJWM8PDxcIiwgXCJiYWNrZ3JvdW5kOiAjREFGMkIxXCIpO1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgcmFuZG9tX2Nob2ljZSA9IGZ1bmN0aW9uKHByb2JhYmlsaXRpZXMsIGNob2ljZXMpe1xyXG5cdFx0LypcclxuXHRcdCAgIHRha2VzIDIgYXJyYXlzIHdpdGggZWxlbWVudHMgYXQgY29ycmVzcG9uZGluZyBpbmRleGVzXHJcblx0XHQgICBiZWluZyBjaG9pY2UgYW5kIGl0J3MgcHJvYmFiaWxpdHkuIHBpY2tzIHJhbmRvbSBvbmUuXHJcblx0XHQgICBjaG9pY2VzIGFyZSBhbnl0aGluZywgcHJvYmFiaWxpdHkgaXMgaW50ZWdlciBhLCBzdWNoIHRoYXRcclxuXHRcdCAgIHByb2JhYmlsaXR5IG9mIGEgY2hvaWNlIGlzIGEvMTAuIHdpdGggYSA8IDEwLCBvZiBjb3Vyc2VcclxuXHRcdCAgIGFuZCBwcm9iYWJpbGl0aWVzIGFkZGluZyB1cCB0byAxMC4gXHJcblx0XHQgICBZZXMsIGl0J3Mgbm90IHZlcnkgZ29vZCBpbXBsZW1lbnRhdGlvbiAocmVhZDogdGVycmlibGUpLCBcclxuXHRcdCAgIGFuZCBzaW5jZSB5b3Ugbm90aWNlZCwgbm93IGl0J3MgeW91ciBqb2IgdG8gaW1wcm92ZSBpdC5cclxuXHJcblx0XHQqL1xyXG5cclxuXHRcdC8vIGFycmF5IHdpdGggY2hvaWNlcyBkdXBsaWNhdGVkIGEgcHJvcGVyIGFtb3VudCBvZiB0aW1lcyBiYXNlZCBvblxyXG5cdFx0Ly8gdGhlaXIgcHJvYmFiaWxpdHlcclxuXHRcdHZhciBibGFoID0gW107IFxyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBjaG9pY2VzLmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IHByb2JhYmlsaXRpZXNbaV07IGorKyl7XHJcblx0XHRcdFx0YmxhaC5wdXNoKGNob2ljZXNbaV0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIHJhbmRfaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBibGFoLmxlbmd0aCk7XHJcblxyXG5cdFx0cmV0dXJuIGJsYWhbcmFuZF9pbmRleF07XHJcblx0fTtcclxuXHJcblx0XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRsZzogbGcsXHJcblx0XHRyYW5kb21fY2hvaWNlOiByYW5kb21fY2hvaWNlXHJcblx0fTtcclxuXHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVVdGlsaXR5O1xyXG4iLCJ2YXIgSW5jbHVkZSA9IGZ1bmN0aW9uKCl7XHJcblxyXG5cdHZhciBtb2R1bGVzO1xyXG5cclxuXHQvLyBzaW1wbGUgZW51bWVyYXRvciAvLyBvcHRpb24gY29kZXMgTVVTVCBiZSBwb3dlciBvZiAyIG9yIHN1bSBvZiBvdGhlciBvcHRpb25zICh3aXRoIDAgYmVpbmcgdGhlIG9ubHkgZXhjZXB0aW9uKSwgYW5kIHVuaXF1ZVxyXG5cdHZhciBjaG9pY2VzID0gKGZ1bmN0aW9uKCl7XHJcblx0XHQvLyBzaW1wbGUgb3B0aW9uczogbnVtYmVyaWMgdmFsdWUgbXVzdCBiZSAwIG9yIHNvbWUgcG93ZXIgb2YgMiwgbmFtZSBzaG91bGQgYmUgYWxsIGNhcHMgYW5kIHVuaXF1ZVxyXG5cdFx0dmFyIHJlc3VsdCA9IHtOT05FOiAwLCBBTExfQ09OVFJPTExFUlM6IDEsIEFMTF9NT0RFTFM6IDIsIE9XTl9NT0RFTDogNCwgT1RIRVJfU1RVRkY6IDgsIFJFTkRFUkVSUzogMTYsIExPR0lDOiAzMn07XHJcblxyXG5cdFx0Ly8gY29tcGxleCBvcHRpb25zOiBzaG91bGQgY29uc2lzdCBvZiBzaW1wbGUgb3B0aW9ucywgYml0d2lzZSghKSBPUidlZCBvciBBTkQnZWQgdG9nZXRoZXIgaW4gYW55IGZhc2hpb25cclxuXHRcdHJlc3VsdC5ERUZBVUxUID0gKHJlc3VsdC5BTExfQ09OVFJPTExFUlMgfCByZXN1bHQuT1dOX01PREVMIHwgcmVzdWx0Lk9USEVSX1NUVUZGKTtcclxuXHRcdHJlc3VsdC5BTEwgPSAgKHJlc3VsdC5BTExfQ09OVFJPTExFUlMgfCByZXN1bHQuQUxMX01PREVMUyB8IHJlc3VsdC5PVEhFUl9TVFVGRik7IFxyXG5cclxuXHRcdC8vIG9iamVjdCBpcyBpbW11dGFibGVcclxuXHRcdHJldHVybiBPYmplY3QuZnJlZXplKHJlc3VsdCk7XHJcblx0fSkoKTtcclxuXHJcblx0dmFyIG1vZHVsZV9uYW1lcyA9IHtcclxuXHRcdENvbnRyb2xsZXJzOiBbXHJcblx0XHRcdFwiQXNzZXRDb250cm9sbGVyXCIsXHJcblx0XHRcdFwiRW5lbXlDb250cm9sbGVyXCIsXHJcblx0XHRcdFwiR2FtZUNvbnRyb2xsZXJcIixcclxuXHRcdFx0XCJHcmFwaGljc0NvbnRyb2xsZXJcIixcclxuXHRcdFx0XCJJbml0Q29udHJvbGxlclwiLFxyXG5cdFx0XHRcIktleWJvYXJkQ29udHJvbGxlclwiLFxyXG5cdFx0XHRcIlBoeXNpY3NDb250cm9sbGVyXCIsXHJcblx0XHRcdC8vXCJQbGF5ZXJDb250cm9sbGVyXCIsXHJcblx0XHRcdFwiVGVycmFpbkNvbnRyb2xsZXJcIixcclxuXHRcdFx0XCJUZXJyYWluU2xpY2VDb250cm9sbGVyXCIsXHJcblx0XHRcdFwiVGVzdENvbnRyb2xsZXJcIixcclxuXHRcdFx0XCJXb3JsZENvbnRyb2xsZXJcIixcclxuXHRcdFx0Ly9cIkFudENvbnRyb2xsZXJcIixcclxuXHRcdFx0XCJJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXJcIixcclxuXHRcdFx0XCJSZWdpc3RlckFzQ29udHJvbGxlclwiLFxyXG5cdFx0XSxcclxuXHJcblx0XHRNb2RlbHM6IFtcclxuXHRcdFxyXG5cdFx0XHRcIkFzc2V0TW9kZWxcIixcclxuXHRcdFx0XCJHYW1lTW9kZWxcIixcclxuXHRcdFx0XCJHcmFwaGljc01vZGVsXCIsXHJcblx0XHRcdFwiS2V5Ym9hcmRNb2RlbFwiLFxyXG5cdFx0XHRcIlBoeXNpY3NNb2RlbFwiLFxyXG5cdFx0XHQvL1wiUGxheWVyTW9kZWxcIixcclxuXHRcdFx0XCJUZXJyYWluTW9kZWxcIixcclxuXHRcdFx0XCJUZXJyYWluU2xpY2VNb2RlbFwiLFxyXG5cdFx0XHRcIlRlc3RNb2RlbFwiLFxyXG5cdFx0XHRcIldvcmxkTW9kZWxcIixcclxuXHRcdFx0Ly9cIkFudE1vZGVsXCIsXHJcblx0XHRcdFwiRW5lbXlNb2RlbFwiLFxyXG5cdFx0XHRcIlJlZ2lzdGVyQXNNb2RlbFwiLFxyXG5cdFx0XSxcclxuXHJcblx0XHRPdGhlcjogW1xyXG5cdFx0XHJcblx0XHRcdFwiQjJkXCIsXHJcblx0XHRcdFwiQm94MkRcIixcclxuXHRcdFx0XCJDb25maWdcIixcclxuXHRcdFx0XCJHYW1lVXRpbGl0eVwiLFxyXG5cdFx0XSxcclxuXHJcblx0XHRSZW5kZXJlcnM6IFtcclxuXHRcdFx0XCJBbnRSZW5kZXJlclwiLFxyXG5cdFx0XHRcIkhlcm9SZW5kZXJlclwiLFxyXG5cdFx0XSxcclxuXHJcblx0XHRMb2dpYzogW1xyXG5cdFx0XHRcIkFudExvZ2ljXCIsXHJcblx0XHRcdFwiSGVyb0xvZ2ljXCIsXHJcblx0XHRdLFxyXG5cclxuXHR9Oy8vZW5kIG1vZHVsZV9uYW1lc1xyXG5cclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cclxuXHRcdG1vZHVsZXMgPSB7XHJcblx0XHRcdEFzc2V0Q29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvQXNzZXRDb250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRHcmFwaGljc0NvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL0dyYXBoaWNzQ29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0S2V5Ym9hcmRDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9LZXlib2FyZENvbnRyb2xsZXIuanNcIiksXHJcblx0XHRcdFBoeXNpY3NDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9QaHlzaWNzQ29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0Ly9QbGF5ZXJDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9QbGF5ZXJDb250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRUZXJyYWluQ29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvVGVycmFpbkNvbnRyb2xsZXIuanNcIiksXHJcblx0XHRcdFRlcnJhaW5TbGljZUNvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL1RlcnJhaW5TbGljZUNvbnRyb2xsZXIuanNcIiksXHJcblx0XHRcdFdvcmxkQ29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvV29ybGRDb250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRJbml0Q29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvSW5pdENvbnRyb2xsZXIuanNcIiksXHJcblx0XHRcdFRlc3RDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9UZXN0Q29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0R2FtZUNvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL0dhbWVDb250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRFbmVteUNvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL0VuZW15Q29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0Ly9BbnRDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9BbnRDb250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL0lkZW50aWZpY2F0aW9uQ29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0UmVnaXN0ZXJBc0NvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL1JlZ2lzdGVyQXNDb250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRcclxuXHRcdFx0XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBNb2RlbHNcclxuXHJcblx0XHRcdEdhbWVNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0dhbWVNb2RlbC5qc1wiKSxcclxuXHRcdFx0VGVycmFpblNsaWNlTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9UZXJyYWluU2xpY2VNb2RlbC5qc1wiKSxcclxuXHRcdFx0QXNzZXRNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0Fzc2V0TW9kZWwuanNcIiksXHJcblx0XHRcdFBoeXNpY3NNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL1BoeXNpY3NNb2RlbC5qc1wiKSxcclxuXHRcdFx0R3JhcGhpY3NNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0dyYXBoaWNzTW9kZWwuanNcIiksXHJcblx0XHRcdFRlcnJhaW5Nb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL1RlcnJhaW5Nb2RlbC5qc1wiKSxcclxuXHRcdFx0V29ybGRNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL1dvcmxkTW9kZWwuanNcIiksXHJcblx0XHRcdEtleWJvYXJkTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9LZXlib2FyZE1vZGVsLmpzXCIpLFxyXG5cdFx0XHQvL1BsYXllck1vZGVsOiByZXF1aXJlKFwiLi9Nb2RlbHMvUGxheWVyTW9kZWwuanNcIiksXHJcblx0XHRcdFRlc3RNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL1Rlc3RNb2RlbC5qc1wiKSxcclxuXHRcdFx0Ly9BbnRNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0FudE1vZGVsLmpzXCIpLFxyXG5cdFx0XHRJZGVudGlmaWNhdGlvbk1vZGVsOiByZXF1aXJlKFwiLi9Nb2RlbHMvSWRlbnRpZmljYXRpb25Nb2RlbC5qc1wiKSxcclxuXHRcdFx0RW5lbXlNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0VuZW15TW9kZWwuanNcIiksXHJcblx0XHRcdFJlZ2lzdGVyQXNNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL1JlZ2lzdGVyQXNNb2RlbC5qc1wiKSxcclxuXHRcdFx0XHJcblx0XHRcdFxyXG5cdFx0XHRcclxuXHRcdFx0XHRcclxuXHRcdFx0Ly8gT3RoZXIgc3R1ZmZcclxuXHRcdFx0XHJcblx0XHRcdENvbmZpZzogcmVxdWlyZShcIi4vQ29uZmlnLmpzXCIpLFxyXG5cdFx0XHRHYW1lVXRpbGl0eTogcmVxdWlyZShcIi4vR2FtZVV0aWxpdHkuanNcIiksXHJcblx0XHRcdEIyZDogcmVxdWlyZShcIi4vQjJkLmpzXCIpLFxyXG5cdFx0XHRCb3gyRDogcmVxdWlyZShcImJveDJkd2ViXCIpLFxyXG5cdFx0XHRcclxuXHRcdFx0Ly8gUmVuZGVyZXJzXHJcblx0XHRcdFxyXG5cdFx0XHRBbnRSZW5kZXJlcjogcmVxdWlyZShcIi4vUmVuZGVyZXJzL0FudFJlbmRlcmVyLmpzXCIpLFxyXG5cdFx0XHRIZXJvUmVuZGVyZXI6IHJlcXVpcmUoXCIuL1JlbmRlcmVycy9IZXJvUmVuZGVyZXIuanNcIiksXHJcblx0XHRcdFxyXG5cclxuXHRcdFx0Ly8gTG9naWNcclxuXHRcdFx0QW50TG9naWM6IHJlcXVpcmUoXCIuL0xvZ2ljL0FudExvZ2ljLmpzXCIpLFxyXG5cdFx0XHRIZXJvTG9naWM6IHJlcXVpcmUoXCIuL0xvZ2ljL0hlcm9Mb2dpYy5qc1wiKSxcclxuXHRcdFx0XHJcblx0XHRcdFxyXG5cclxuXHRcdH07XHJcblxyXG5cdH07IC8vIGVuZCBpbml0XHJcblxyXG5cdHZhciBvcHRpb25faXNfc2V0ID0gZnVuY3Rpb24od2hhdF9tb2RzX3NlbGVjdGVkLCBvcHRpb25zKXtcclxuXHRcdGlmKHdoYXRfbW9kc19zZWxlY3RlZCA9PSAwICYmIG9wdGlvbnMgPT0gMCl7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0Ly8gYmUgbWluZGZ1bCBvZiBiaXR3aXNlIG9wZXJhdG9yIGFoZWFkXHJcblx0XHRyZXR1cm4gKHdoYXRfbW9kc19zZWxlY3RlZCAmIG9wdGlvbnMpO1xyXG5cdH07Ly9lbmQgb3B0aW9uX2lzX3NldFxyXG5cclxuXHR2YXIgZ2V0X21vZHVsZSA9IGZ1bmN0aW9uKG5hbWUpe1xyXG5cdFx0Ly8gY2FuIGJlIG1vZGlmaWVkIHRvIHRocm93IG9iamVjdCBlcnJvciBpbnN0ZWFkIG9mIHNpbXBsZSBvbmVcclxuXHRcdC8vIGluIHRoYXQgY2FzZSBpdCBtYXkgY29udGFpbiBsaXN0IG9mIGRpZmluZWQgbW9kdWxlc1xyXG5cdFx0Ly8gbWF5IGFsc28gYmUgbW9kaWZpZWQgdG8gY2hlY2sgd2hldGhlciBtb2R1bGUgaXMgbWlzc2luZyBmcm9tIFxyXG5cdFx0Ly8gbW9kdWxlX25hbWVzLCBtb2R1bGVzLCBvciBib3RoLCBhbmQgZ2l2ZSBtb3JlIGFjY3VyYXRlIGRlc2NyaXB0aW9uXHJcblx0XHR2YXIgbWVzc2FnZSA9IFwiTW9kdWxlIFwiICsgbmFtZSArIFxyXG5cdFx0XHRcIiBpcyB1bmRlZmluZWQuIE5vdGUgdGhhdCB5b3UgbXVzdCBoYXJkY29kZSBhbGwgbmV3IG1vZHVsZXNcIiArIFxyXG5cdFx0XHRcIiBpbnRvIHRoZSBJbmNsdWRlcy5tb2R1bGVfbmFtZXMgQU5EIEluY2x1ZGVzLm1vZHVsZXMuXCJcclxuXHRcdFxyXG5cdFx0aWYobW9kdWxlcyl7XHJcblx0XHRcdGlmKG1vZHVsZXNbbmFtZV0pe1xyXG5cdFx0XHRcdHJldHVybiBtb2R1bGVzW25hbWVdO1xyXG5cdFx0XHR9ZWxzZSBpZihjb25zb2xlLndhcm4peyAvLyBjaGVjayBpZiBjb25zb2xlLndhcm4gaXMgYXZhaWxhYmxlXHJcblx0XHRcdFx0Y29uc29sZS53YXJuKG1lc3NhZ2UpO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHR0aHJvdyBtZXNzYWdlO1xyXG5cdFx0XHR9XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0dGhyb3cgXCJFcnJvcjogWW91IG11c3QgcnVuIHRoZSBJbmNsdWRlcy5pbml0KCkgYmVmb3JlIHlvdSBjYW4gdXNlIGFueSBtb2R1bGVzXCI7XHJcblx0XHR9XHJcblx0fTsvL2VuZCBnZXRfbW9kdWxlXHJcblx0XHJcblxyXG5cdHZhciBnZXRfbmFtZXMgPSBmdW5jdGlvbihjdXJyZW50X21vZHVsZV9uYW1lLCBvcHRpb25zX2NvZGUpe1xyXG5cdFx0dmFyIHJlc3VsdCA9IHtNb2RlbHM6IFtdLCBDb250cm9sbGVyczogW10sIE90aGVyOiBbXSwgUmVuZGVyZXJzOiBbXSwgTG9naWM6IFtdLH07XHJcblxyXG5cdFx0aWYob3B0aW9uX2lzX3NldChjaG9pY2VzLk5PTkUsIG9wdGlvbnNfY29kZSkpe1xyXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChvcHRpb25faXNfc2V0KGNob2ljZXMuQUxMX0NPTlRST0xMRVJTLCBvcHRpb25zX2NvZGUpKXtcclxuXHJcblx0XHRcdHZhciBjb250cm9sbGVyX25hbWVzID0gbW9kdWxlX25hbWVzLkNvbnRyb2xsZXJzO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGNvbnRyb2xsZXJfbmFtZXMubGVuZ3RoOyBpKyspe1xyXG5cclxuXHRcdFx0XHR2YXIgY3RsX25hbWUgPSBjb250cm9sbGVyX25hbWVzW2ldO1xyXG5cclxuXHRcdFx0XHRpZihjdGxfbmFtZSAhPSBjdXJyZW50X21vZHVsZV9uYW1lKXtcclxuXHRcdFx0XHRcdHJlc3VsdC5Db250cm9sbGVycy5wdXNoKGN0bF9uYW1lKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5BTExfTU9ERUxTLCBvcHRpb25zX2NvZGUpKXtcclxuXHRcdFx0cmVzdWx0Lk1vZGVscyA9IG1vZHVsZV9uYW1lcy5Nb2RlbHM7XHJcblx0XHR9ZWxzZSBpZihvcHRpb25faXNfc2V0KGNob2ljZXMuT1dOX01PREVMLCBvcHRpb25zX2NvZGUpKXtcclxuXHRcdFx0dmFyIG93bl9tb2RlbCA9IGN1cnJlbnRfbW9kdWxlX25hbWUucmVwbGFjZShcIkNvbnRyb2xsZXJcIiwgXCJNb2RlbFwiKTtcclxuXHRcdFx0cmVzdWx0Lk1vZGVscy5wdXNoKG93bl9tb2RlbCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYob3B0aW9uX2lzX3NldChjaG9pY2VzLk9USEVSX1NUVUZGLCBvcHRpb25zX2NvZGUpKXtcclxuXHRcdFx0cmVzdWx0Lk90aGVyID0gbW9kdWxlX25hbWVzLk90aGVyO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5SRU5ERVJFUlMsIG9wdGlvbnNfY29kZSkpe1xyXG5cdFx0XHRyZXN1bHQuUmVuZGVyZXJzID0gbW9kdWxlX25hbWVzLlJlbmRlcmVycztcclxuXHRcdH1cclxuXHJcblx0XHRpZihvcHRpb25faXNfc2V0KGNob2ljZXMuTE9HSUMsIG9wdGlvbnNfY29kZSkpe1xyXG5cdFx0XHRyZXN1bHQuTG9naWMgPSBtb2R1bGVfbmFtZXMuTG9naWM7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9Oy8vZW5kIGdldF9uYW1lc1xyXG5cclxuXHR2YXIgc2VjdGlvbnMgPSBbXCJNb2RlbHNcIiwgXCJDb250cm9sbGVyc1wiLCBcIk90aGVyXCIsIFwiUmVuZGVyZXJzXCIsIFwiTG9naWNcIl07XHJcblx0dmFyIGdldF9uYW1lX3N0YXRlbWVudHMgPSBmdW5jdGlvbihuYW1lcyl7XHJcblx0XHR2YXIgcmVzdWx0ID0gXCJcIjtcclxuXHRcdGZvcih2YXIgc2VjdGlvbl9pbmRleCA9IDA7IHNlY3Rpb25faW5kZXggPCBzZWN0aW9ucy5sZW5ndGg7IHNlY3Rpb25faW5kZXgrKyl7XHJcblx0XHRcdHZhciBzZWN0aW9uID0gc2VjdGlvbnNbc2VjdGlvbl9pbmRleF07XHJcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBuYW1lc1tzZWN0aW9uXS5sZW5ndGg7IGkrKyl7XHJcblx0XHRcdFx0cmVzdWx0ICs9IChcInZhciBcIiArIG5hbWVzW3NlY3Rpb25dW2ldICsgXCI7IFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiByZXN1bHQ7XHJcblx0XHRcclxuXHR9Oy8vZW5kIGdldF9uYW1lX3N0YXRlbWVudHNcclxuXHJcblx0dmFyIGdldF9tb2R1bGVfc3RhdGVtZW50cyA9IGZ1bmN0aW9uKG5hbWVzKXtcclxuXHRcdHZhciByZXN1bHQgPSBcIlwiO1xyXG5cdFx0Zm9yKHZhciBzZWN0aW9uX2luZGV4ID0gMDsgc2VjdGlvbl9pbmRleCA8IHNlY3Rpb25zLmxlbmd0aDsgc2VjdGlvbl9pbmRleCsrKXtcclxuXHRcdFx0dmFyIHNlY3Rpb24gPSBzZWN0aW9uc1tzZWN0aW9uX2luZGV4XTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IG5hbWVzW3NlY3Rpb25dLmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0XHRyZXN1bHQgKz0gKG5hbWVzW3NlY3Rpb25dW2ldICsgXCIgPSBJbmNsdWRlcy5nZXRfbW9kdWxlKFxcXCJcIiArIG5hbWVzW3NlY3Rpb25dW2ldICsgXCJcXFwiKTsgXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9Oy8vZW5kIGdldF9tb2R1bGVfc3RhdGVtZW50c1xyXG5cclxuXHR2YXIgZ2V0X2luY2x1ZGVfZGF0YSA9IGZ1bmN0aW9uKHBhcmFtcyl7XHJcblx0XHR2YXIgY3VycmVudF9tb2R1bGUgPSBwYXJhbXMuY3VycmVudF9tb2R1bGU7XHJcblx0XHR2YXIgaW5jbHVkZV9vcHRpb25zID0gcGFyYW1zLmluY2x1ZGVfb3B0aW9ucztcclxuXHRcdHZhciBuYW1lcyA9IGdldF9uYW1lcyhjdXJyZW50X21vZHVsZSwgaW5jbHVkZV9vcHRpb25zKTtcclxuXHJcblx0XHR2YXIgbmFtZV9zdGF0ZW1lbnRzID0gZ2V0X25hbWVfc3RhdGVtZW50cyhuYW1lcyk7XHJcblx0XHR2YXIgbW9kdWxlX3N0YXRlbWVudHMgPSBnZXRfbW9kdWxlX3N0YXRlbWVudHMobmFtZXMpO1xyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGltcG9ydGVkX21vZHVsZXM6IG5hbWVzLFxyXG5cdFx0XHRuYW1lX3N0YXRlbWVudHM6IG5hbWVfc3RhdGVtZW50cyxcclxuXHRcdFx0bW9kdWxlX3N0YXRlbWVudHM6IG1vZHVsZV9zdGF0ZW1lbnRzLFxyXG5cdFx0fTtcclxuXHJcblx0fTsvL2VuZCBnZXRfaW5jbHVkZV9kYXRhXHJcblxyXG5cdHZhciBhdXRvbWF0ZWRfdGVzdHMgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHJcblx0XHRRVW5pdC50ZXN0KFwib3B0aW9uIG1hdGNoaW5nIGZ1bmN0aW9uXCIsIGZ1bmN0aW9uKCBhc3NlcnQpIHtcclxuXHJcblx0XHRcdC8vSWYgYm90aCBhcmUgbm9uZVxyXG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLk5PTkUsIGNob2ljZXMuTk9ORSksIHRydWUpO1xyXG5cclxuXHRcdFx0YXNzZXJ0LnRocm93cyhvcHRpb25faXNfc2V0KGNob2ljZXMuTk9ORSwgLTEpKTtcclxuXHJcblx0XHRcdC8vSWYgYm90aCBtYXRjaCwgaXQgcmV0dXJucyB0aGUgdmFsdWUgb2YgY2hvaWNlc1xyXG5cdFx0XHQvL0lmIHRoZXkgZG9uJ3QgbWF0Y2gsIGl0IHJldHVybnMgMFxyXG5cdFx0XHRcclxuXHRcdFx0Ly9NQVRDSFxyXG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLkFMTF9DT05UUk9MTEVSUywgY2hvaWNlcy5BTExfQ09OVFJPTExFUlMpLCAxKTtcclxuXHRcdFx0YXNzZXJ0LmVxdWFsKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5BTExfTU9ERUxTLCBjaG9pY2VzLkFMTF9NT0RFTFMpLCAyKTtcclxuXHRcdFx0YXNzZXJ0LmVxdWFsKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5PVEhFUl9TVFVGRiwgY2hvaWNlcy5PVEhFUl9TVFVGRiksIDgpO1xyXG5cclxuXHRcdFx0Ly9NaXNtYXRjaFxyXG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLk5PTkUsIGNob2ljZXMuQUxMX0NPTlRST0xMRVJTKSwgMCk7XHJcblx0XHRcdGFzc2VydC5lcXVhbChvcHRpb25faXNfc2V0KGNob2ljZXMuT1RIRVJfU1RVRkYsIGNob2ljZXMuTk9ORSksIDApO1xyXG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLkFMTF9NT0RFTFMsIGNob2ljZXMuQUxMX0NPTlRST0xMRVJTKSwgMCk7XHJcblx0XHRcdGFzc2VydC5lcXVhbChvcHRpb25faXNfc2V0KGNob2ljZXMuT1dOX01PREVMLCBjaG9pY2VzLkFMTF9NT0RFTFMpLCAwKTtcclxuXHRcdH0pOy8vZW5kIG9wdGlvbiBtYXRjaGluZyB0ZXN0XHJcblx0XHRcclxuXHR9Oy8vZW5kIGF1dG9tYXRlZF90ZXN0c1xyXG5cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGluaXQ6IGluaXQsXHJcblx0XHRtb2R1bGVfbmFtZXM6IG1vZHVsZV9uYW1lcyxcclxuXHRcdGdldF9tb2R1bGU6IGdldF9tb2R1bGUsXHJcblx0XHRnZXRfaW5jbHVkZV9kYXRhOiBnZXRfaW5jbHVkZV9kYXRhLFxyXG5cdFx0Y2hvaWNlczogY2hvaWNlcyxcclxuXHRcdGF1dG9tYXRlZF90ZXN0czogYXV0b21hdGVkX3Rlc3RzXHJcblx0fTtcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBJbmNsdWRlO1xyXG5cclxuIiwidmFyIEFudEFJID0gKGZ1bmN0aW9uKCl7XHJcblxyXG5cdHZhciBBbnQgPSBmdW5jdGlvbigpe1xyXG5cdFx0Ly9kZWZpbmUgeW91ciBjb25zdGFudHMgaGVyZVxyXG5cdFx0dGhpcy5IID0gMzE7Ly9oZWlnaHRcclxuXHRcdHRoaXMuVyA9IDUwO1xyXG5cdFx0dGhpcy5zcHJpdGVfYXJyYXkgPSBbXTsgIC8vc2luZ2xlIHNvdXJjZSBmb3Igc3ByaXRlc1xyXG5cdFx0XHJcblx0XHR0aGlzLmhlcm9faHVydF9tZSA9IGZhbHNlO1xyXG5cdFx0dGhpcy5tZV9odXJ0X2hlcm8gPSBmYWxzZTtcclxuXHRcdHRoaXMuZGVhdGhfdGljayA9IDA7XHJcblxyXG5cdFx0Ly9zZXQgeW91ciBnYW1lIGxvZ2ljIHBhcmFtZXRlcnMgaGVyZVxyXG5cdFx0Ly90aGlzLm9iamVjdF9pZCA9IDE7IC8vaGFyZGNvZGUgYSB1bmlxdWUgaWRlbnRpZmllciBmb3IgZWFjaCBuZXcgZW5lbXkgY2xhc3NcclxuXHRcdHRoaXMuaHAgPSAyO1xyXG5cdFx0dGhpcy5zcGVlZCA9IDQ7XHJcblx0XHR0aGlzLmRhbWFnZSA9IDE7XHJcblx0XHQvL3RoaXMuYXR0YWNrX2Nvb2xkb3duID0gNDsgLy91c2UgdGhpcyBmb3IgZW5lbWllcyB3aG8gbmVlZFxyXG5cdFx0dGhpcy5jYW5fYXR0YWNrID0gdHJ1ZTsvL3VzZSB0aGlzIGZvciBlbmVtaWVzIHdobyBhbHRlcm5hdGUgYmV0d2VlbiBcclxuXHRcdC8vdGhpcy5jb29sZG93bl90aW1lcj0tMTtcclxuXHRcdHRoaXMuQUlfc3RhdGUgPSBcIndhbGtcIjsvL3VzZSB0aGlzIHRvIGtlZXAgdHJhY2sgb2YgdGhlIGVuZW15J3MgQUkgc3RhdGVcclxuXHR9O1xyXG5cclxuXHR2YXIgSWRlbnRpZmljYXRpb25Db250cm9sbGVyLCBQaHlzaWNzQ29udHJvbGxlciwgUmVnaXN0ZXJBc0NvbnRyb2xsZXI7XHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oaW1wb3J0cyl7XHJcblx0XHQvKipcclxuXHRcdCogaW5pdGlhbGl6ZSBhbmQgcmVnaXN0ZXIgc3R1ZmZcclxuXHRcdCovXHJcblxyXG5cdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyID0gaW1wb3J0cy5JZGVudGlmaWNhdGlvbkNvbnRyb2xsZXI7XHJcblx0XHRQaHlzaWNzQ29udHJvbGxlciA9IGltcG9ydHMuUGh5c2ljc0NvbnRyb2xsZXI7XHJcblx0XHRSZWdpc3RlckFzQ29udHJvbGxlciA9IGltcG9ydHMuUmVnaXN0ZXJBc0NvbnRyb2xsZXI7XHJcblxyXG5cdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyLmFzc2lnbl90eXBlKEFudCwgXCJhbnRcIik7XHRcclxuXHR9O1xyXG5cdFxyXG5cclxuXHR2YXIgc3Bhd24gPSBmdW5jdGlvbih4LCB5KXtcclxuXHRcdC8qKlxyXG5cdFx0KiBzcGF3biBhbnRcclxuXHRcdCovXHJcblxyXG5cdFx0dmFyIG5ld19hbnQgPSBuZXcgQW50KCk7XHJcblx0XHR2YXIgaWQgPSBJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuYXNzaWduX2lkKG5ld19hbnQpO1xyXG5cclxuXHRcdG5ld19hbnQuYm9keSA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7eDogeCwgeTogeSwgYm9yZGVyX3NlbnNvcnM6IHRydWV9LCBuZXdfYW50KTtcdFxyXG5cclxuXHRcdC8vIGxpc3RlbiBmb3IgdHlwZSwgcHV0IHNoaXQgaW50byB0aGUgRW5lbXlDb250cm9sbGVyXHJcblx0XHRQaHlzaWNzQ29udHJvbGxlci5saXN0ZW5fZm9yX2NvbnRhY3Rfd2l0aChpZCwgXCJCZWdpbkNvbnRhY3RcIiwgYmVnaW5fY29udGFjdCk7XHJcblx0XHRcclxuXHRcdHJldHVybiBuZXdfYW50O1xyXG5cclxuXHR9O1xyXG5cdFxyXG5cdHZhciB3b3VuZF9hbnQgPSBmdW5jdGlvbihhbnQsIHdvdW5kKXtcclxuXHJcblx0XHRhbnQuaHAgLT0gd291bmQ7XHJcblx0fVxyXG5cclxuXHR2YXIgdGlja19BSSA9IGZ1bmN0aW9uKGFudCwgU3R1ZmYpe1xyXG5cdFx0LyoqXHJcblx0XHQqIHRpY2sgdGhlIEFJIGZvciB0aGUgZ2l2ZW4gYW50XHJcblx0XHQqIGdldHMgaW5zdGFuY2Ugb2YgdGhlIGFudCBhbmRcclxuXHRcdCogPlN0dWZmPCB3aGljaCBpcyBvYmplY3QgY29udGFpbmluZyBmdW5jdGlvbnMgeW91IG5lZWRcclxuXHRcdCogYW5kIG90aGVyIHN0dWZmXHJcblx0XHQqL1xyXG5cclxuXHRcdC8vaWYgZW5lbXkgaXMgZGVhZCwgZGllXHJcblx0XHRpZiAoYW50LmhwID09IDEpIHtcclxuXHRcdFx0XHJcblx0XHRcdGlmIChhbnQuaGVyb19odXJ0X21lKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0d291bmRfYW50KGFudCwgMSk7XHJcblx0XHRcdFx0YW50Lmhlcm9faHVydF9tZSA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9IFxyXG5cdFx0ZWxzZSBpZiAoYW50LmhwIDw9IDAgJiYgYW50LmRlYXRoX3RpY2sgPT0gMzApIHtcclxuXHRcdFx0Ly9hbnQuYW50LkRlc3Ryb3lGaXh0dXJlKCk7XHJcblx0XHRcdGFudC5kZWF0aF90aWNrKys7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChhbnQuaHAgPD0gMCAmJiBhbnQuZGVhdGhfdGljayA+IDMwKXt9XHJcblx0XHRlbHNlIGlmIChhbnQuaHAgPD0gMCkge1xyXG5cdFx0XHRcclxuXHRcdFx0Y2hhbmdlX3N0YXRlKGFudCwgXCJkZWF0aFwiKTtcclxuXHRcdFx0YW50LmRlYXRoX3RpY2srKztcclxuXHRcdH1cclxuXHRcdC8vZWxzZSBtb3ZlICYgYXR0YWNrXHJcblx0XHJcblx0XHRlbHNlIHtcclxuXHJcblx0XHRcdGlmIChhbnQuQUlfc3RhdGUgPT0gXCJ3YWxrXCIpIHtcclxuXHRcdFx0XHR2YXIgQW50Ym9keSA9IGFudC5ib2R5O1xyXG5cdFx0XHRcdHZhciB2ZWxvY2l0eSA9IEFudGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKTtcclxuXHRcdFx0XHR2ZWxvY2l0eS54ID0gLWFudC5zcGVlZDtcclxuXHRcdFx0XHRBbnRib2R5LlNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5KTsgLy8gYm9keS5TZXRMaW5lYXJWZWxvY2l0eShuZXcgYjJWZWMyKDUsIDApKTsgd291bGQgd29yayB0b29cclxuXHRcdFx0XHRBbnRib2R5LlNldEF3YWtlKHRydWUpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChhbnQuY2FuX2F0dGFjayAmJiBhbnQubWVfaHVydF9oZXJvICYmIG1vZGVsLkFJX3N0YXRlID09IFwid2Fsa1wiKSBcclxuXHRcdFx0e1xyXG5cclxuXHRcdFx0XHRcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoYW50Lmhlcm9faHVydF9tZSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHdvdW5kX2FudChhbnQsIDEpO1xyXG5cdFx0XHRcdGFudC5oZXJvX2h1cnRfbWUgPSBmYWxzZTtcclxuXHRcdFx0XHRjaGFuZ2Vfc3RhdGUoYW50LCBcInVwc2lkZV9kb3duXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHJcblx0fTtcclxuXHRcclxuXHR2YXIgY2hhbmdlX3N0YXRlID0gZnVuY3Rpb24oYW50LCBwcm9ncmVzc19zdGF0ZSkge1xyXG5cdFx0YW50LkFJX3N0YXRlID0gcHJvZ3Jlc3Nfc3RhdGU7XHJcblxyXG5cdH1cclxuXHJcblx0Ly8gLy8gLy9TZXQgdXAgQ29sbGlzaW9uIGhhbmRsZXJcclxuXHRcclxuXHRcclxuXHR2YXIgYmVnaW5fY29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QsIGluZm8pe1xyXG5cdFx0Ly9oYW5kbGUgY29sbGlzaW9ucyBoZXJlXHJcblx0XHRcclxuXHRcdC8vY29uc29sZS5sb2coaW5mby5NZS5pZCwgXCI6XCIsIFwiTXkgZml4dHVyZVwiLCBcIidcIiArIGluZm8uTWUuZml4dHVyZV9uYW1lICsgXCInXCIsIFwiY2FtZSBpbnRvIGNvbnRhY3Qgd2l0aCBmaXh0dXJlXCIsIFxyXG5cdFx0XHQvL1wiJ1wiICsgaW5mby5UaGVtLmZpeHR1cmVfbmFtZSArIFwiJ1wiLCBcIm9mXCIsIGluZm8uVGhlbS5pZCk7XHJcblxyXG5cdFx0XHJcblx0XHQvL3ZhciBtZWFuX2hlcm87XHJcblx0XHQvL2lmKGluZm8uQS5ib2R5X2lkID09IFwiaGVyb1wiKVxyXG5cdFx0Ly97XHJcblx0XHRcdC8vbWVhbl9oZXJvID0gaW5mby5BO1xyXG5cdFx0XHQvL2lmKG1lYW5faGVyby5maXh0dXJlICE9IFwiYm90dG9tIHNlbnNvclwiICYmIEFudE1vZGVsLmNhbl9hdHRhY2spXHJcblx0XHRcdC8ve1xyXG5cdFx0XHRcdC8vYW50Lm1lX2h1cnRfaGVybyA9IHRydWU7XHJcblx0XHRcdC8vfVx0XHJcblx0XHRcdC8vZWxzZVxyXG5cdFx0XHQvL3tcclxuXHJcblx0XHRcdFx0Ly9BbnRNb2RlbC5oZXJvX2h1cnRfbWUgPSB0cnVlO1xyXG5cdFx0XHQvL31cclxuXHRcdC8vfVxyXG5cdFx0Ly9lbHNlIGlmKGluZm8uQi5ib2R5X2lkID09IFwiaGVyb1wiKVxyXG5cdFx0Ly97XHJcblx0XHRcdC8vbWVhbl9oZXJvID0gaW5mby5CO1xyXG5cdFx0XHQvL2lmKG1lYW5faGVyby5maXh0dXJlICE9IFwiYm90dG9tIHNlbnNvclwiICYmIEFudE1vZGVsLmNhbl9hdHRhY2spXHJcblx0XHRcdC8ve1xyXG5cdFx0XHRcdC8vYW50Lm1lX2h1cnRfaGVybyA9IHRydWU7XHJcblx0XHRcdC8vfVx0XHJcblx0XHRcdC8vZWxzZVxyXG5cdFx0XHQvL3tcclxuXHJcblx0XHRcdFx0Ly9BbnRNb2RlbC5oZXJvX2h1cnRfbWUgPSB0cnVlO1xyXG5cdFx0XHQvL31cclxuXHRcdC8vfVxyXG5cdH07XHJcblxyXG5cdHZhciBlbmRfY29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QsIG9sZE1hbmlmb2xkLCBpbmZvKSB7XHJcblxyXG5cdFx0XHRBbnRNb2RlbC5hbnRzW2luZm8uTWUuaWRdLm1lX2h1cnRfaGVybyA9IGZhbHNlO1xyXG5cclxuXHR9O1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0dGlja19BSTogdGlja19BSSxcclxuXHRcdHNwYXduOiBzcGF3bixcclxuXHRcdGluaXQ6IGluaXQsXHJcblx0XHRlbmRfY29udGFjdDogZW5kX2NvbnRhY3QsXHJcblx0XHRiZWdpbl9jb250YWN0OiBiZWdpbl9jb250YWN0XHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQW50QUk7XHJcbiIsInZhciBBbnRBSSA9IChmdW5jdGlvbigpe1xyXG5cclxuXHR0aGlzLlBsYXllciA9IGZ1bmN0aW9uKCl7XHJcblx0XHR0aGlzLmhwID0gMTAwO1xyXG5cdFx0dGhpcy53b3VuZCA9IGZhbHNlO1xyXG5cdFx0dGhpcy5qdW1wcyA9IDA7XHJcblx0fVxyXG5cclxuXHR2YXIgSWRlbnRpZmljYXRpb25Db250cm9sbGVyLCBQaHlzaWNzQ29udHJvbGxlciwgUmVnaXN0ZXJBc0NvbnRyb2xsZXIsIEtleWJvYXJkQ29udHJvbGxlciwgQjJkO1xyXG5cdHZhciBoZXJvO1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKGltcG9ydHMpe1xyXG5cdFx0LyoqXHJcblx0XHQqIGluaXRpYWxpemUgYW5kIHJlZ2lzdGVyIHN0dWZmXHJcblx0XHQqL1xyXG5cdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyID0gaW1wb3J0cy5JZGVudGlmaWNhdGlvbkNvbnRyb2xsZXI7XHJcblx0XHRQaHlzaWNzQ29udHJvbGxlciA9IGltcG9ydHMuUGh5c2ljc0NvbnRyb2xsZXI7XHJcblx0XHRSZWdpc3RlckFzQ29udHJvbGxlciA9IGltcG9ydHMuUmVnaXN0ZXJBc0NvbnRyb2xsZXI7XHJcblx0XHRLZXlib2FyZENvbnRyb2xsZXIgPSBpbXBvcnRzLktleWJvYXJkQ29udHJvbGxlcjtcclxuXHRcdEIyZCA9IGltcG9ydHMuQjJkO1xyXG5cclxuXHJcblx0XHRJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuYXNzaWduX3R5cGUoUGxheWVyLCBcImhlcm9cIik7XHRcclxuXHJcblx0fTtcclxuXHRcclxuXHJcblx0dmFyIHNwYXduID0gZnVuY3Rpb24oeCwgeSl7XHJcblx0XHR2YXIgaGVybyA9IG5ldyBQbGF5ZXIoKTtcclxuXHJcblx0XHRoZXJvLmJvZHkgPSBQaHlzaWNzQ29udHJvbGxlci5nZXRfcmVjdGFuZ3VsYXIoe3g6IHgsIHk6IHksIGJvcmRlcl9zZW5zb3JzOiB0cnVlfSwgaGVybyk7XHJcblxyXG5cdFx0aGVyby5ocCA9IDEwMDtcclxuXHRcdGhlcm8ud291bmQgPSBmYWxzZTtcclxuXHRcdGhlcm8uanVtcHMgPSAwO1xyXG5cclxuXHJcblx0XHRyZXR1cm4gaGVybztcclxuXHR9O1xyXG5cdFxyXG5cdHZhciB0aWNrX0FJID0gZnVuY3Rpb24oZW50aXR5KXtcclxuXHJcblx0XHRoZXJvID0gZW50aXR5O1xyXG5cdFx0XHJcblx0XHR2YXIgY21kcyA9IEtleWJvYXJkQ29udHJvbGxlci5tb3ZlbWVudF9jb21tYW5kcygpO1xyXG5cclxuXHRcdHZhciBNT1ZFTUVOVF9FREdFID0gNTAwOyAvLyB3aGVyZSB0ZXJyYWluIHN0YXJ0IHNjcm9sbGluZ1xyXG5cclxuXHJcblx0XHRpZihjbWRzKFwicmlnaHRcIikpe1xyXG5cdFx0ICAgIC8vIHRlbXBvcmFyeVxyXG5cclxuXHRcdCAgICBtb3ZlX3JpZ2h0KGhlcm8pO1xyXG5cdFx0fVxyXG5cdFx0aWYoY21kcyhcImxlZnRcIikpe1xyXG5cdFx0XHQvLyB0ZW1wb3JhcnlcclxuXHRcdCAgICBcclxuXHRcdCAgICBtb3ZlX2xlZnQoaGVybyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoY21kcyhcInVwXCIpKXtcclxuXHRcdFx0anVtcChoZXJvKTtcclxuXHRcdH1cclxuXHRcdGlmKGhlcm8ud291bmQpXHJcblx0XHR7XHJcblx0XHRcdGhlcm8uaHAtLTtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJUYWtpbmcgZGFtYWdlXCIpO1xyXG5cdFx0XHRHcmFwaGljc0NvbnRyb2xsZXIudXBkYXRlX2hlYWx0aChoZXJvLmhwKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0aWYoaGVyby5ocCA8PSAwKVxyXG5cdFx0e1xyXG5cdFx0XHRjcmVhdGVqcy5UaWNrZXIucGF1c2VkID0gdHJ1ZTtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJQbGF5ZXIgSXMgRGVhZFwiKTtcclxuXHRcdH1cclxuXHRcclxuXHR9O1xyXG5cclxuXHR2YXIgYmVnaW5fY29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QsIGluZm8pe1xyXG5cdFx0Ly9jb25zb2xlLmxvZyhpbmZvLk1lLmlkLCBcIjpcIiwgXCJNeSBmaXh0dXJlXCIsIFwiJ1wiICsgaW5mby5NZS5maXh0dXJlX25hbWUgKyBcIidcIiwgXCJjYW1lIGludG8gY29udGFjdCB3aXRoIGZpeHR1cmVcIiwgXHJcblx0XHRcdC8vXCInXCIgKyBpbmZvLlRoZW0uZml4dHVyZV9uYW1lICsgXCInXCIsIFwib2ZcIiwgaW5mby5UaGVtLmlkKTtcclxuXHRcdGNvbnNvbGUubG9nKFwiaGVyZVwiKTtcclxuXHRcdFxyXG5cdFx0aWYgKGluZm8uTWUuZml4dHVyZV9uYW1lID09IFwiYm90dG9tXCIpe1xyXG5cdFx0XHRpbmZvLk1lLmVudGl0eS5qdW1wcyA9IDA7XHJcblx0XHR9XHJcblx0XHRpZiAoaW5mby5NZS5maXh0dXJlX25hbWUgPT0gXCJ0b3BcIil7XHJcblx0XHRcdHRha2VfaGl0KGluZm8uTWUuZW50aXR5LCAxKTtcclxuXHRcdH1cclxuXHRcdFx0XHRcclxuXHR9O1xyXG5cclxuXHR2YXIgdGFrZV9oaXQgPSBmdW5jdGlvbihoZXJvLCBhbW91bnQpe1xyXG5cdFx0aGVyby5ocCAtPSBhbW91bnQ7XHJcblx0XHRHcmFwaGljc0NvbnRyb2xsZXIudXBkYXRlX2hlYWx0aChoZXJvLmhwKTtcclxuXHR9XHJcblxyXG5cdHZhciBlbmRfY29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QsIGluZm8pe1xyXG5cdFx0XHRcclxuXHRcdGluZm8uTWUuZW50aXR5LndvdW5kID0gZmFsc2U7XHJcblx0fTtcclxuXHJcblx0dmFyIG1vdmVfcmlnaHQgPSBmdW5jdGlvbihoZXJvKXtcclxuXHRcdHZhciBib2R5ID0gaGVyby5ib2R5O1xyXG5cdFx0dmFyIHZlbG9jaXR5ID0gYm9keS5HZXRMaW5lYXJWZWxvY2l0eSgpO1xyXG5cdFx0dmVsb2NpdHkueCA9IDU7XHJcblx0XHRib2R5LlNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5KTsgLy8gYm9keS5TZXRMaW5lYXJWZWxvY2l0eShuZXcgYjJWZWMyKDUsIDApKTsgd291bGQgd29yayB0b29cclxuXHRcdGJvZHkuU2V0QXdha2UodHJ1ZSk7XHJcblx0XHQvL2hlcm8ueCArPSAxMDsgLy8gb2xkXHJcblx0XHQvL2hlcm8ueCA9IChib2R5LkdldFBvc2l0aW9uKCkueCArIDEuNS8yKSAqIDMwIDsgXHJcblx0fTtcclxuXHJcblx0dmFyIGp1bXAgPSBmdW5jdGlvbihoZXJvKXtcclxuXHQgICAgdmFyIGJvZHkgPSBoZXJvLmJvZHk7XHJcblx0XHRpZiAoaGVyby5qdW1wcyA9PSAwKXtcclxuXHRcdCAgICBib2R5LkFwcGx5SW1wdWxzZShuZXcgQjJkLmIyVmVjMigwLCAtMTAwKSwgYm9keS5HZXRXb3JsZENlbnRlcigpKTtcclxuXHRcdCAgICBoZXJvLmp1bXBzICs9IDE7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChoZXJvLmp1bXBzID09IDEgJiYgYm9keS5HZXRMaW5lYXJWZWxvY2l0eSgpLnkgPiAtMSkge1xyXG5cdFx0ICAgIGJvZHkuQXBwbHlJbXB1bHNlKG5ldyBCMmQuYjJWZWMyKDAsIC0xMDApLCBib2R5LkdldFdvcmxkQ2VudGVyKCkpO1xyXG5cdFx0ICAgIGhlcm8uanVtcHMgKz0gMTtcclxuXHRcdH1cclxuXHJcblx0XHQvL2hlcm8ueSA9IGJvZHkuR2V0UG9zaXRpb24oKS55ICogMzA7XHJcblx0XHJcblx0fTtcclxuXHJcblx0dmFyIHNldF9jb29yZGluYXRlcyA9IGZ1bmN0aW9uKHBvc2l0aW9uX3ZlY3Rvcil7XHJcblx0XHQvLyBUT0RPOiByZW1vdmU7XHJcblx0XHQvLyB0ZW1wb3JhcnkvdGVzdGluZ1xyXG5cdFx0aGVyby54ID0gKHBvc2l0aW9uX3ZlY3Rvci54IC0gMS41LzIpICogMzAgO1xyXG5cdFx0aGVyby55ID0gKHBvc2l0aW9uX3ZlY3Rvci55ICsgMi41LzIpICogMzAgO1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgYjJiX2dldF9jb29yZGluYXRlcyA9IGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gaGVyby5ib2R5LkdldFdvcmxkQ2VudGVyKCk7XHJcblx0fTtcclxuXHJcblx0dmFyIG1vdmVfbGVmdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHR2YXIgdmVsb2NpdHkgPSBoZXJvLmJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKTtcclxuXHRcdHZlbG9jaXR5LnggPSAtNTtcclxuXHRcdGhlcm8uYm9keS5TZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eSk7IC8vIGhlcm8uU2V0TGluZWFyVmVsb2NpdHkobmV3IGIyVmVjMig1LCAwKSk7IHdvdWxkIHdvcmsgdG9vXHJcblx0XHRoZXJvLmJvZHkuU2V0QXdha2UodHJ1ZSk7XHJcblx0fTtcclxuXHJcblx0dmFyIG1vdmVfcmlnaHQgPSBmdW5jdGlvbigpe1xyXG5cdFx0dmFyIHZlbG9jaXR5ID0gaGVyby5ib2R5LkdldExpbmVhclZlbG9jaXR5KCk7XHJcblx0XHR2ZWxvY2l0eS54ID0gKzU7XHJcblx0XHRoZXJvLmJvZHkuU2V0TGluZWFyVmVsb2NpdHkodmVsb2NpdHkpOyAvLyBoZXJvLlNldExpbmVhclZlbG9jaXR5KG5ldyBiMlZlYzIoNSwgMCkpOyB3b3VsZCB3b3JrIHRvb1xyXG5cdFx0aGVyby5ib2R5LlNldEF3YWtlKHRydWUpO1xyXG5cdH07XHJcblxyXG5cdHZhciBtb3ZlID0gZnVuY3Rpb24ob2Zmc2V0X3gsIG9mZnNldF95KXtcclxuXHRcdC8vIHVuaW1wbGVtZW50ZWRcclxuXHRcdC8vIHNob3VsZCBpdCBoYXJkLXNldCBwb3NpdGlvbiAobm90IHNhZmUhKVxyXG5cdFx0Ly8gb3IganVzdCBhbGxvdyB0byBzZXQgYW55IHZlbG9jaXR5L2ltcHVsc2UgdmVjdG9yP1xyXG5cdH07XHJcblxyXG5cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdHRpY2tfQUk6IHRpY2tfQUksXHJcblx0XHRzcGF3bjogc3Bhd24sXHJcblx0XHRpbml0OiBpbml0LFxyXG5cdFx0YmVnaW5fY29udGFjdDogYmVnaW5fY29udGFjdCxcclxuXHRcdGVuZF9jb250YWN0OiBlbmRfY29udGFjdCxcclxuXHR9O1xyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBBbnRBSTtcclxuIiwidmFyIEFzc2V0TW9kZWwgPSBuZXcgZnVuY3Rpb24oKXtcclxuXHQvLyBBcyBhbHdheXMsIGFsbW9zdCBhbnl0aGluZyBpcyBpbml0aWFsaXplZCBpbiB0aGUgSW5pdENvbnRyb2xsZXJcclxuXHRcclxuXHR0aGlzLmxvYWRlcjtcclxuXHJcblx0dGhpcy5tYW5pZmVzdCA9IFsgLy8gZGVmaW5pbmcgcmVzb3VyY2VzIHRvIGJlIGxvYWRlZCBpbiBidWxrIHdpdGggcHJlbG9hZC5qc1xyXG5cdFx0XHR7c3JjOiBcImdyZWVrX3dhcnJpb3IucG5nXCIsIGlkOiBcImdyZWVrX3dhcnJpb3JcIn0sXHJcblx0XHRcdC8ve3NyYzosIGlkOn0sXHJcblx0XHRcdHtzcmM6IFwibWlkZGxlX3RlcnJhaW4ucG5nXCIsIGlkOlwibWlkZGxlX3RlcnJhaW5cIn0sXHJcblx0XHRcdHtzcmM6IFwiYm90dG9tX3RlcnJhaW4ucG5nXCIsIGlkOiBcImJvdHRvbV90ZXJyYWluXCJ9LFxyXG5cdFx0XHR7c3JjOiBcImdyYXNzLnBuZ1wiLCBpZDogXCJncmFzc1wifSxcclxuXHRcdFx0e3NyYzogXCJBbnRDaG9tcGVycy5wbmdcIiwgaWQ6IFwiQW50MVwifSxcclxuXHRcdFx0e3NyYzogXCJBbnRDaG9tcGVyczIucG5nXCIsIGlkOiBcIkFudDJcIn0sXHJcblx0XHRcdHtzcmM6IFwiQW50Q2hvbXBlcnNEZWF0aC5wbmdcIiwgaWQ6IFwiQW50M1wifVxyXG5cdFx0XTsgXHJcblx0XHQvLyBUT0RPIG1ha2UgYWRkaW5nIHJlc291cmNlcyBlYXNpZXI/IEF1dG9tYXRpYyBsb2FkaW5nIFxyXG5cdFx0Ly8gb2YgZXZlcnl0aGluZyBmcm9tIGFzc2V0cywgYXV0b21hdGljIG5hbWVzIGV0Yy4/XHJcblxyXG5cdHRoaXMuc2hhcGVzID0ge307IC8vIG1heWJlIHRoaXMgYXJlbid0IG5lZWRlZFxyXG5cclxuXHR0aGlzLmJpdG1hcHMgPSB7fTtcclxuXHJcblx0dGhpcy5hbmltYXRpb25zID0ge307XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBBc3NldE1vZGVsO1xyXG4iLCJ2YXIgRW5lbXlNb2RlbCA9IGZ1bmN0aW9uKCl7XHRcclxuXHQvLyBhc3NvY2lhdGVzIHR5cGUgd2l0aCB0aGUgQUlcclxuXHR0aGlzLnR5cGVfdG9fQUkgPSB7fTtcclxuXHJcblx0Ly8gREVQUkVDQVRFRFxyXG5cdHRoaXMuYW50cyA9IHt9O1xyXG5cclxuXHR0aGlzLmZvcl9sb2dpY191cGRhdGUgPSB7fTsgLy8ga2V5OiB0eXBlLCB2YWx1ZTogYXJyYXkgb2Ygb2JqZWN0c1xyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IEVuZW15TW9kZWw7XHJcblxyXG4iLCJ2YXIgR2FtZU1vZGVsID0gbmV3IGZ1bmN0aW9uKCl7IC8vIG1haW4gbW9kZWxcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVNb2RlbDtcclxuIiwidmFyIEdyYXBoaWNzTW9kZWwgPSBmdW5jdGlvbigpe1xyXG5cdHRoaXMuc3RhZ2U7IC8vIG1haW4gc3RhZ2UgdG8gd2hlcmUgZXZlcnl0aGluZyB3aWxsIGJlIGRyYXduXHJcblx0Ly8gbm90ZSB0aGF0IGV2ZXJ5IGdyYXBoaWNzIG9iamVjdCBtdXN0IGJlIGF1Z21lbnRlZCB3aXRoXHJcblx0Ly8gdGhlIHJlZmVyZW5jZSB0byB0aGUgY29ycmVzcG9uZGluZyBwaHlzaWNzIG9iamVjdCwgaWYgYW55XHJcblx0dGhpcy5oZXJvO1xyXG5cdHRoaXMub3RoZXJfcGxheWVycyA9IFtdOyAvLyBhcnJheSBvZiBwbGF5ZXJzIG90aGVyIHRoZW4gaGVybyBmb3IgbXVsdGlwbGF5ZXJcclxuXHR0aGlzLmFudDtcclxuICAgIC8vUElaWkFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFcclxuXHR0aGlzLmhlYWx0aDtcclxuXHR0aGlzLnNjb3JlO1xyXG5cdC8vIGFsbCBvYmplY3QgcmVnaXN0ZXJlZCBmb3IgY29udGluaW91cyB1cGRhdGUgdG8gbWF0Y2ggdGhlaXIgcGh5c2ljYWwgYm9keVxyXG5cdC8vIHBvc2l0aW9uIFxyXG5cdHRoaXMuYWxsX3BoeXNpY2FsID0gW107IFxyXG5cdHRoaXMuc3BlY2lhbF9yZW5kZXIgPSB7fTsgLy8gbWF0Y2hlcyB0eXBlIHdpdGggYXJyYXkgb2YgYWxsIG9iamVjdHMgb2YgdGhhdCB0eXBlIHRvIGJlIHJlbmRlcmVkXHJcblxyXG5cdC8vIGFsbCBzcHJpdGVzaGVldCBkZWZpbml0aW9ucyAoYWRkZWQgYXQgdGhlIGluaXRpYWxpemF0aW9uIHN0YWdlXHJcblx0Ly8gYmVjYXVzZSB0aGV5IG5lZWQgYXNzZXRzIHRvIGJlIGxvYWRlZClcclxuXHR0aGlzLnNwcml0ZXNoZWV0cyA9IHt9OyBcclxuXHJcblx0dGhpcy5jYW1lcmEgPSB7XHJcblx0XHQvLyBzaG91bGQgYmUgZWFzZWxqcyBvYmplY3Qgb3IgbnVsbFxyXG5cdFx0Zm9sbG93aW5nOiBudWxsLFxyXG5cclxuXHRcdC8vIGludGVybmFsIGNhbWVyYSBpbXBsZW1lbnRhdGlvbiB0aGluZyB0byBrbm93IGhvdyBmYXIgdG8gb2Zmc2V0IGZyb20gdGhlXHJcblx0XHQvLyBpbml0aWFsIHBvc2l0aW9uXHJcblx0XHRvZmZzZXQ6IHt4OiAwLCB5OiAwfSxcclxuXHJcblx0XHQvLyB0aGUgb2Zmc2V0IG9mIHRoZSBjYW1lcmEgZnJvbSB0aGUgZm9sbG93ZWQgb2JqZWN0XHJcblx0XHQvLyBlLmcuIG9mZnNldCBvZiB7eDogMTAwLCB5OiAxMDB9IHdpbGwgY2VudGVyIGNhbWVyYVxyXG5cdFx0Ly8gMTAwIHBpeGVscyB0byB0aGUgcmlnaHQgYW5kIDEwMCBwaXhlbHMgYmVsb3cgdGhlIGZvbGxvd2VkIG9iamVjdFxyXG5cdFx0b2Zmc2V0X2Zyb21fZm9sbG93ZWQ6IHt4OiA0MDAsIHk6IC0xMDB9LFxyXG5cdFx0Ly9vZmZzZXRfZnJvbV9mb2xsb3dlZDoge3g6IDMzMCwgeTogLTIwNX0sIC8vRk9SIEdBTUUgUEFHRVxyXG5cdFx0Ly8gdGhpcyBpcyBjZW50ZXIgb2YgdGhlIHNjcmVlbiBpbiBwaXhlbHMuIGdldHMgZHluYW1pY2FsbHkgcmVjYWxjdWxhdGVkIFxyXG5cdFx0Ly8gZHVyaW5nIHRoZSBjYW1lcmEgdXBkYXRlIHNvIGlmIGl0J3MgZXZlciBjaGFuZ2VkLCBjYW1lcmEgc3RpbGwgd29ya3MgYXMgZXhwZWN0ZWRcclxuXHRcdGNlbnRlcjoge3g6IDAsIHk6IDB9XHJcblxyXG5cdH07XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBuZXcgR3JhcGhpY3NNb2RlbDtcclxuXHJcbiIsIlxyXG52YXIgSWRlbnRpZmljYXRpb25Nb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblx0XHJcblx0Ly8gbmV4dCB1bmlxdWUgaWQgdG8gYmUgZ2l2ZW4gaWYgbm90IGZyZWUgaWQncyByZW1haW5cclxuXHR0aGlzLm5leHRfaWQgPSAwO1xyXG5cclxuXHQvLyBhcnJheSBvZiBmcmVlIGlkJ3MuIHB1c2ggd2hlbiBmcmVlZCwgcG9wIHdoZW4gZnJlZSBpZCBpcyBuZWVkZWRcclxuXHQvLyBpZiBhcnJheSBpcyBlbXB0eSwgZ2V0IG5leHQgaWQgdXNpbmcgPm5leHRfaWQ8XHJcblx0dGhpcy5mcmVlX2lkcyA9IFtdO1xyXG5cclxuXHQvLyBhcnJheSBtYXRjaGVzIGlkcyB0byB0aGVpciBjb3JyZXNwb25kaW5nIG9iamVjdHNcclxuXHR0aGlzLmlkX21hdGNoaW5nID0gW107XHJcblxyXG5cdC8vIHJlZ2lzdHJ5IG9mIHR5cGVzIHRvIG1ha2Ugc3VyZSB0aGF0IG5vIHR5cGUgaXMgcmVnaXN0ZXJkIHR3aWNlXHJcblx0Ly8gYW5kIGVuYWJsZSBwZW9wbGUgdG8gZ2V0IHRoZSBtb2RlbCBieSB0eXBlIG5hbWVcclxuXHR0aGlzLnR5cGVzID0ge31cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IElkZW50aWZpY2F0aW9uTW9kZWw7XHJcblxyXG5cclxuIiwidmFyIEtleWJvYXJkTW9kZWwgPSBmdW5jdGlvbigpe1xyXG5cdHRoaXMua2V5cyA9IHt9O1xyXG5cclxuXHR0aGlzLnRyYW5zbGF0aW9uX3RhYmxlcyA9IHtcclxuXHRcdGNvZGVfdG9fbmFtZToge1xyXG5cdFx0XHQ4OiAgIFwiYmFja3NwYWNlXCIsIC8vICBiYWNrc3BhY2VcclxuXHRcdFx0OTogICBcInRhYlwiLCAvLyAgdGFiXHJcblx0XHRcdDEzOiAgXCJlbnRlclwiLCAvLyAgZW50ZXJcclxuXHRcdFx0MTY6ICBcInNoaWZ0XCIsIC8vICBzaGlmdFxyXG5cdFx0XHQxNzogIFwiY3RybFwiLCAvLyAgY3RybFxyXG5cdFx0XHQxODogIFwiYWx0XCIsIC8vICBhbHRcclxuXHRcdFx0MTk6ICBcInBhdXNlL2JyZWFrXCIsIC8vICBwYXVzZS9icmVha1xyXG5cdFx0XHQyMDogIFwiY2FwcyBsb2NrXCIsIC8vICBjYXBzIGxvY2tcclxuXHRcdFx0Mjc6ICBcImVzY2FwZVwiLCAvLyAgZXNjYXBlXHJcblx0XHRcdDMzOiAgXCJwYWdlIHVwXCIsIC8vIHBhZ2UgdXAsIHRvIGF2b2lkIGRpc3BsYXlpbmcgYWx0ZXJuYXRlIGNoYXJhY3RlciBhbmQgY29uZnVzaW5nIHBlb3BsZVxyXG5cdFx0XHQzNDogIFwicGFnZSBkb3duXCIsIC8vIHBhZ2UgZG93blxyXG5cdFx0XHQzNTogIFwiZW5kXCIsIC8vIGVuZFxyXG5cdFx0XHQzNjogIFwiaG9tZVwiLCAvLyBob21lXHJcblx0XHRcdDM3OiAgXCJsZWZ0IGFycm93XCIsIC8vIGxlZnQgYXJyb3dcclxuXHRcdFx0Mzg6ICBcInVwIGFycm93XCIsIC8vIHVwIGFycm93XHJcblx0XHRcdDM5OiAgXCJyaWdodCBhcnJvd1wiLCAvLyByaWdodCBhcnJvd1xyXG5cdFx0XHQ0MDogIFwiZG93biBhcnJvd1wiLCAvLyBkb3duIGFycm93XHJcblx0XHRcdDQ1OiAgXCJpbnNlcnRcIiwgLy8gaW5zZXJ0XHJcblx0XHRcdDQ2OiAgXCJkZWxldGVcIiwgLy8gZGVsZXRlXHJcblx0XHRcdDQ4OiAgXCIwXCIsXHJcblx0XHRcdDQ5OiAgXCIxXCIsXHJcblx0XHRcdDUwOiAgXCIyXCIsXHJcblx0XHRcdDUxOiAgXCIzXCIsXHJcblx0XHRcdDUyOiAgXCI0XCIsXHJcblx0XHRcdDUzOiAgXCI1XCIsXHJcblx0XHRcdDU0OiAgXCI2XCIsXHJcblx0XHRcdDU1OiAgXCI3XCIsXHJcblx0XHRcdDU2OiAgXCI4XCIsXHJcblx0XHRcdDU3OiAgXCI5XCIsXHJcblx0XHRcdDY1OiAgXCJhXCIsXHJcblx0XHRcdDY2OiAgXCJiXCIsXHJcblx0XHRcdDY3OiAgXCJjXCIsXHJcblx0XHRcdDY4OiAgXCJkXCIsXHJcblx0XHRcdDY5OiAgXCJlXCIsXHJcblx0XHRcdDcwOiAgXCJmXCIsXHJcblx0XHRcdDcxOiAgXCJnXCIsXHJcblx0XHRcdDcyOiAgXCJoXCIsXHJcblx0XHRcdDczOiAgXCJpXCIsXHJcblx0XHRcdDc0OiAgXCJqXCIsXHJcblx0XHRcdDc1OiAgXCJrXCIsXHJcblx0XHRcdDc2OiAgXCJsXCIsXHJcblx0XHRcdDc3OiAgXCJtXCIsXHJcblx0XHRcdDc4OiAgXCJuXCIsXHJcblx0XHRcdDc5OiAgXCJvXCIsXHJcblx0XHRcdDgwOiAgXCJwXCIsXHJcblx0XHRcdDgxOiAgXCJxXCIsXHJcblx0XHRcdDgyOiAgXCJyXCIsXHJcblx0XHRcdDgzOiAgXCJzXCIsXHJcblx0XHRcdDg0OiAgXCJ0XCIsXHJcblx0XHRcdDg1OiAgXCJ1XCIsXHJcblx0XHRcdDg2OiAgXCJ2XCIsXHJcblx0XHRcdDg3OiAgXCJ3XCIsXHJcblx0XHRcdDg4OiAgXCJ4XCIsXHJcblx0XHRcdDg5OiAgXCJ5XCIsXHJcblx0XHRcdDkwOiAgXCJ6XCIsXHJcblx0XHRcdDkxOiAgXCJsZWZ0IHdpbmRvd1wiLCAvLyBsZWZ0IHdpbmRvd1xyXG5cdFx0XHQ5MjogIFwicmlnaHQgd2luZG93XCIsIC8vIHJpZ2h0IHdpbmRvd1xyXG5cdFx0XHQ5MzogIFwic2VsZWN0IGtleVwiLCAvLyBzZWxlY3Qga2V5XHJcblx0XHRcdDk2OiAgXCJudW1wYWQgMFwiLCAvLyBudW1wYWQgMFxyXG5cdFx0XHQ5NzogIFwibnVtcGFkIDFcIiwgLy8gbnVtcGFkIDFcclxuXHRcdFx0OTg6ICBcIm51bXBhZCAyXCIsIC8vIG51bXBhZCAyXHJcblx0XHRcdDk5OiAgXCJudW1wYWQgM1wiLCAvLyBudW1wYWQgM1xyXG5cdFx0XHQxMDA6IFwibnVtcGFkIDRcIiwgLy8gbnVtcGFkIDRcclxuXHRcdFx0MTAxOiBcIm51bXBhZCA1XCIsIC8vIG51bXBhZCA1XHJcblx0XHRcdDEwMjogXCJudW1wYWQgNlwiLCAvLyBudW1wYWQgNlxyXG5cdFx0XHQxMDM6IFwibnVtcGFkIDdcIiwgLy8gbnVtcGFkIDdcclxuXHRcdFx0MTA0OiBcIm51bXBhZCA4XCIsIC8vIG51bXBhZCA4XHJcblx0XHRcdDEwNTogXCJudW1wYWQgOVwiLCAvLyBudW1wYWQgOVxyXG5cdFx0XHQxMDY6IFwibXVsdGlwbHlcIiwgLy8gbXVsdGlwbHlcclxuXHRcdFx0MTA3OiBcImFkZFwiLCAvLyBhZGRcclxuXHRcdFx0MTA5OiBcInN1YnRyYWN0XCIsIC8vIHN1YnRyYWN0XHJcblx0XHRcdDExMDogXCJkZWNpbWFsIHBvaW50XCIsIC8vIGRlY2ltYWwgcG9pbnRcclxuXHRcdFx0MTExOiBcImRpdmlkZVwiLCAvLyBkaXZpZGVcclxuXHRcdFx0MTEyOiBcIkYxXCIsIC8vIEYxXHJcblx0XHRcdDExMzogXCJGMlwiLCAvLyBGMlxyXG5cdFx0XHQxMTQ6IFwiRjNcIiwgLy8gRjNcclxuXHRcdFx0MTE1OiBcIkY0XCIsIC8vIEY0XHJcblx0XHRcdDExNjogXCJGNVwiLCAvLyBGNVxyXG5cdFx0XHQxMTc6IFwiRjZcIiwgLy8gRjZcclxuXHRcdFx0MTE4OiBcIkY3XCIsIC8vIEY3XHJcblx0XHRcdDExOTogXCJGOFwiLCAvLyBGOFxyXG5cdFx0XHQxMjA6IFwiRjlcIiwgLy8gRjlcclxuXHRcdFx0MTIxOiBcIkYxMFwiLCAvLyBGMTBcclxuXHRcdFx0MTIyOiBcIkYxMVwiLCAvLyBGMTFcclxuXHRcdFx0MTIzOiBcIkYxMlwiLCAvLyBGMTJcclxuXHRcdFx0MTQ0OiBcIm51bSBsb2NrXCIsIC8vIG51bSBsb2NrXHJcblx0XHRcdDE0NTogXCJzY3JvbGwgbG9ja1wiLCAvLyBzY3JvbGwgbG9ja1xyXG5cdFx0XHQxODY6IFwiO1wiLCAvLyBzZW1pLWNvbG9uXHJcblx0XHRcdDE4NzogXCI9XCIsIC8vIGVxdWFsLXNpZ25cclxuXHRcdFx0MTg4OiBcIixcIiwgLy8gY29tbWFcclxuXHRcdFx0MTg5OiBcIi1cIiwgLy8gZGFzaFxyXG5cdFx0XHQxOTA6IFwiLlwiLCAvLyBwZXJpb2RcclxuXHRcdFx0MTkxOiBcIi9cIiwgLy8gZm9yd2FyZCBzbGFzaFxyXG5cdFx0XHQxOTI6IFwiYFwiLCAvLyBncmF2ZSBhY2NlbnRcclxuXHRcdFx0MjE5OiBcIltcIiwgLy8gb3BlbiBicmFja2V0XHJcblx0XHRcdDIyMDogXCJcXFxcXCIsIC8vIGJhY2sgc2xhc2hcclxuXHRcdFx0MjIxOiBcIl1cIiwgLy8gY2xvc2UgYnJhY2tldFxyXG5cdFx0XHQyMjI6IFwiJ1wiLCAvLyBzaW5nbGUgcXVvdGVcclxuXHRcdH0sXHJcblxyXG5cdFx0bW92ZW1lbnQ6IHtcclxuXHRcdFx0XCJsZWZ0IGFycm93XCI6IFwibGVmdFwiLFxyXG5cdFx0XHRcInVwIGFycm93XCI6IFwidXBcIixcclxuXHRcdFx0XCJkb3duIGFycm93XCI6IFwiZG93blwiLFxyXG5cdFx0XHRcInJpZ2h0IGFycm93XCI6IFwicmlnaHRcIixcclxuXHRcdH0sXHJcblx0XHRcclxuXHRcdGRlYnVnOiB7XHJcblx0XHRcdFwiYVwiOiBcInNwYXduX2FudFwiLFxyXG5cdFx0fSxcclxuXHJcblx0fVxyXG5cclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBLZXlib2FyZE1vZGVsO1xyXG5cclxuIiwiXHJcbnZhciBQaHlzaWNzTW9kZWwgPSBmdW5jdGlvbigpIHtcclxuXHRcclxuXHR0aGlzLmdyYXZpdHk7XHJcblx0dGhpcy53b3JsZDtcclxuIFxyXG5cdC8vIGdldHRpbmcgY29udGV4dCBvZiB0aGUgZGVidWcgY2FudmFzLCBmb3IgYm94MmQgdG8gZHJhdyBkZWJ1Z2dpbiBib3hlc1xyXG5cclxuXHQvLyB0aW1lVG9Db3ZlciBpcyB0aGUgdGltZSB0aGF0IHNpbXVsYXRpb24gbXVzdCBjb3ZlciB0byBjYXRjaCB1cCB0byB0aGUgcmVhbCB3b3JsZCB0aW1lO1xyXG5cdC8vIHNpbmNlIGNyZWF0ZWpzIHRpY2tlciBpcyB3aGF0IHdlIHVzZSBmb3IgdGltaW5nLCBhbmQgYm94MmQgdGlja3NcclxuXHQvLyBtdXN0IGJlIG9mIGNvbnN0YW50IGxlbmd0aCBhbmQgaW5kZXBlbmRlbnQgZnJvbSB0aGUgZ3JhcGhpY3MgZnJhbWVyYXRlLFxyXG5cdC8vIHdlIGtlZXAgdHJhY2sgb2YgdGltZSB0aGF0IHBhc3NlZCBzaW5jZSBsYXN0IGJveDJkIHN0ZXAgYnkgYWRkaW5nIHRpbWUgZGVsdGFzXHJcblx0Ly8gdG8gdGhlIHRpbWVUb0NvdmVyLiBUaGVuLCB3aGVuIHRpbWVUb0NvdmVyIGV4Y2VlZHMgZGVzaXJlZCBib3gyZCBzdGVwIGxlbmd0aCxcclxuXHQvLyB3ZSBwZXJmb3JtIHRoZSBzdGVwIGFuZCBzdWJ0cmFjdCB0aGUgY29ycmVzcG9uZGluZyB0aW1lIGZyb20gdGhlIHRpbWVUb0NvdmVyO1xyXG5cdC8vIElmIGFueXRoaW5nIGlzIHN0aWxsIHVuY2xlYXIsIGFzayBtZSAoQUspO1xyXG5cdFx0dGhpcy50aW1lVG9Db3ZlciA9IDA7IFxyXG5cclxuXHR0aGlzLnN0ZXBfYW1vdW50O1xyXG5cclxuXHR0aGlzLmF3YWl0aW5nX2NvbnRhY3QgPSB7XHJcblx0XHRQcmVTb2x2ZToge30sXHJcblx0XHRQb3N0U29sdmU6IHt9LFxyXG5cdFx0QmVnaW5Db250YWN0OiB7fSxcclxuXHRcdEVuZENvbnRhY3Q6IHt9LFxyXG5cdH07XHJcblxyXG59OyBcclxuXHJcbi8qXHJcbiAqIFBhcmFtZXRlcnMgZm9yIGIyZCBib2R5IGRlZmluaXRpb25cclxuXHRhY3RpdmU6IHRydWVcclxuXHRhbGxvd1NsZWVwOiB0cnVlXHJcblx0YW5nbGU6IDBcclxuXHRhbmd1bGFyRGFtcGluZzogMFxyXG5cdGFuZ3VsYXJWZWxvY2l0eTogMFxyXG5cdGF3YWtlOiB0cnVlXHJcblx0YnVsbGV0OiBmYWxzZVxyXG5cdGZpeGVkUm90YXRpb246IGZhbHNlXHJcblx0aW5lcnRpYVNjYWxlOiAxXHJcblx0bGluZWFyRGFtcGluZzogMFxyXG5cdGxpbmVhclZlbG9jaXR5OiBiMlZlYzJcclxuXHRwb3NpdGlvbjogYjJWZWMyXHJcblx0dHlwZTogMFxyXG5cdHVzZXJEYXRhOiBudWxsXHJcbiovXHJcblxyXG4vKlxyXG4gKiBGaXh0dXJlIGRlZmluaXRpb24gcGFyYW1ldGVyczpcclxuXHRkZW5zaXR5OiAwXHJcblx0ZmlsdGVyOiBiMkZpbHRlckRhdGFcclxuXHRmcmljdGlvbjogMC4yXHJcblx0aXNTZW5zb3I6IGZhbHNlXHJcblx0cmVzdGl0dXRpb246IDBcclxuXHRzaGFwZTogbnVsbFxyXG5cdHVzZXJEYXRhOiBudWxsXHJcbiAqL1xyXG5cclxuLy8gcmVjdGFuZ3VsYXJcclxuUGh5c2ljc01vZGVsLnByb3RvdHlwZS5yX3RlbXBsYXRlcyA9IHJfdGVtcGxhdGVzID0ge307XHJcbi8vIGNpcmN1bGFyXHJcblBoeXNpY3NNb2RlbC5wcm90b3R5cGUuY190ZW1wbGF0ZXMgPSBjX3RlbXBsYXRlcyA9IHt9O1xyXG4vLyBwb2x5Z29uYWxcclxuUGh5c2ljc01vZGVsLnByb3RvdHlwZS5wX3RlbXBsYXRlcyA9IHBfdGVtcGxhdGVzID0ge307XHJcblxyXG5cclxuXHJcbnJfdGVtcGxhdGVzW1wiZGVmYXVsdFwiXSA9IHtcclxuXHJcblx0Ly9zaGFwZTogXCJyZWN0YW5nbGVcIiwgLy8gaW1wbGllZCBmcm9tIHRoZSB0ZW1wbGF0ZSB0eXBlXHJcblx0eDogMyxcclxuXHR5OiAzLFxyXG5cdHZ4OiAwLFxyXG5cdHZ5OiAwLFxyXG5cclxuXHR3aWR0aDogNSxcclxuXHRoZWlnaHQ6IDUsXHJcblx0ZGVuc2l0eTogMixcclxuXHRmcmljdGlvbjogMSxcclxuXHRyZXN0aXR1dGlvbjogMC4yLFxyXG5cdGlzU2Vuc29yOiBmYWxzZSxcclxuXHJcblxyXG5cdGFjdGl2ZTogdHJ1ZSxcclxuXHRhbGxvd1NsZWVwOiB0cnVlLFxyXG5cdGFuZ2xlOiAwLFxyXG5cdGFuZ3VsYXJWZWxvY2l0eTogMCxcclxuXHRhd2FrZTogdHJ1ZSxcclxuXHRidWxsZXQ6IGZhbHNlLFxyXG5cdGZpeGVkUm90YXRpb246IGZhbHNlLFxyXG5cdHR5cGU6IFwiZHluYW1pY1wiLFxyXG5cclxufTtcclxuXHJcbnJfdGVtcGxhdGVzLmxpdmluZyA9IHtcclxuXHRmaXhlZFJvdGF0aW9uOiB0cnVlLFxyXG5cdGF3YWtlOiB0cnVlLFxyXG5cdGlzU2Vuc29yOiBmYWxzZSxcclxuXHQvL21vYmV4cCsrXHJcbn07XHJcblxyXG5yX3RlbXBsYXRlcy50ZXJyYWluX2NlbGwgPSB7XHJcblx0dHlwZTogXCJzdGF0aWNcIixcclxuXHR3aWR0aDogMSxcclxuXHRoZWlnaHQ6IDEsXHJcblx0Ly9tb2JleHArK1xyXG59O1xyXG5cclxucl90ZW1wbGF0ZXMuaGVybyA9IHtcclxuXHRwYXJlbnQ6IHJfdGVtcGxhdGVzLmxpdmluZyxcclxuXHR3aWR0aDogMS41LFxyXG5cdGhlaWdodDogMi41LFxyXG5cdHR5cGU6IFwiZHluYW1pY1wiLFxyXG5cdC8vbW9iZXhwKytcclxufTtcclxuXHJcbnJfdGVtcGxhdGVzLmFudCA9IHtcclxuXHRwYXJlbnQ6IHJfdGVtcGxhdGVzLmxpdmluZyxcclxuXHR3aWR0aDogMSxcclxuXHRoZWlnaHQ6IDAuNSxcclxuXHR0eXBlOiBcImR5bmFtaWNcIixcclxuXHR4OiA0MCxcclxuXHR5OiAxMCxcclxuXHQvL21vYmV4cCsrXHJcbn07XHJcblxyXG5yX3RlbXBsYXRlcy50ZXN0ID0ge1xyXG5cdHdpZHRoOiAxLFxyXG5cdGhlaWdodDogMixcclxuXHRmaXhlZFJvdGF0aW9uOiBmYWxzZSxcclxuXHQvL21vYmV4cCsrXHJcbn1cclxuXHJcbnJfdGVtcGxhdGVzLnBsYXRmb3JtID0ge1xyXG4gICAgeDogMTAsXHJcbiAgICB5OiAxMSxcclxuICAgIHdpZHRoOiAxMCxcclxuICAgIGhlaWdodDogLjUsXHJcbiAgICB0eXBlOiBcInN0YXRpY1wiLFxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBQaHlzaWNzTW9kZWw7XHJcbiIsInZhciBSZWdpc3RlckFzTW9kZWwgPSBmdW5jdGlvbigpe1xyXG5cdFxyXG5cdC8vIHJlZ2lzdGVyIHN0dWZmIGZvciBvbmUgdGltZSBsb29rdXBcclxuXHQvLyB0aGUgb25lIHJlcXVlc3Rpbmcgc3R1ZmYgaXMgc3VwcG9zZWQgdG8gcG9wIHRoZSBlYWNoIGV4YW1pbmVkIGVsZW1lbnRcclxuXHQvLyB0aGVyZSBpcyBubyB0aW1lb3V0cyBvciBhdXRvbWF0aWMgY2xlYW51cFxyXG5cdHRoaXMuc2ltcGxlX29uZV90aW1lX2xvb2t1cCA9IHt9O1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBuZXcgUmVnaXN0ZXJBc01vZGVsO1xyXG5cclxuIiwidmFyIFRlcnJhaW5Nb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblx0Ly9UaGlzIGlzIHBoeXNpY3MsIGZvciBncmFwaGljcyBsb29rIGludG8gdGhlIEdyYXBoaWNzQ29udHJvbGxlci9Nb2RlbFxyXG5cdHRoaXMudGVycmFpbl9zbGljZXNfcXVldWUgPSBbXTtcclxuXHR0aGlzLm5ld19zbGljZXMgPSBbXTtcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBUZXJyYWluTW9kZWw7XHJcbiIsIlRlcnJhaW5TbGljZUNvbmZpZyA9IHJlcXVpcmUgKFwiLi4vQ29uZmlnLmpzXCIpLlRlcnJhaW5TbGljZTtcclxuXHJcbnZhciBUZXJyYWluU2xpY2VNb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblxyXG5cdHRoaXMuU2xpY2UgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyoqXHJcblx0XHQqIHNsaWNlIFwibW9kZWxcIiB0byBiZSBpbnN0YW50aWF0ZWRcclxuXHRcdCovXHJcblx0XHRcclxuXHRcdFxyXG5cdFx0dGhpcy5pZCA9IFRlcnJhaW5TbGljZUNvbmZpZy5uZXh0X3NsaWNlX2lkKys7IC8vIGF1dG9tYXRpY2FsbCBhc3NpZ24gaWQgYW5kIGluY3JlbWVudCBcclxuXHJcblx0XHR0aGlzLmdyaWRfY29sdW1ucyA9IFRlcnJhaW5TbGljZUNvbmZpZy5ncmlkX2NvbHVtbnM7XHJcblx0XHR0aGlzLmdyaWRfcm93cyA9IFRlcnJhaW5TbGljZUNvbmZpZy5ncmlkX3Jvd3M7XHJcblx0XHR0aGlzLmNlbGxfdyA9IFRlcnJhaW5TbGljZUNvbmZpZy5jZWxsX3c7XHJcblx0XHRcclxuXHRcdC8vIGdyaWRbaV1bal0gaXMgdGhlIGVsZW1lbnQgaW4gdGhlIGkncyBjb2x1bW4gYW5kIGoncyByb3dcclxuXHRcdC8vIHRoZSBncmlkIGlzIG1haWQgdG8gbWF0Y2ggdGhlIHNjcmVlbiBjb29yZGluYXRlcyBhbmQgdGhlIGN1cnJlbnQgYm94MmQgY29vcmRpbmF0ZXNcclxuXHRcdC8vIGkuZS4gZ3JpZFswXVswXSBpcyB0aGUgb25lIGluIHRoZSB0b3AgbGVmdCBjb3JuZXIgb2YgdGhlIHRlcnJhaW4gc2xpY2VcclxuXHRcdC8vIGRvIHdlIHdhbnQgdG8gY2hhbmdlIGl0PyB3b3VsZCBpdCBiZSBlYXNpZXIgdG8gZ2VuZXJhdGUgdGVycmFpbiBpZiB3ZSBzdGFydCBhdCB0aGUgYm90dG9tP1xyXG5cdFx0Ly8gaWYgeWVzLCB0aGVuIHdoYXQgbWFrZXMgbW9yZSBzZW5zZSwgY2hhbmdpbmcgY29vcmRpbmF0ZSBzeXN0ZW1zIG9yIGp1c3Qgc3dpdGNoaW5nIGdlbmVyYXRpb25cclxuXHRcdC8vIGxvb3BzIGFyb3VuZD8gZGlzY3Vzc1xyXG5cdFx0Ly9cclxuXHRcdC8vIG5vdGljZSB0aGF0IHRoZSBncmlkIGlzIGEgdGVycmFpbiBnZW5lcmF0aW9uIGRldmljZSBvbmx5LiBvbmNlIHRlcnJhaW4gc2xpY2UgaXMgbG9hZGVkLFxyXG5cdFx0Ly8gYm94MmQgcGh5c2ljcyBzaW11bGF0aW9uIG1heSAoYW5kIHdpbGwpIGdvIG51dHMgb24gaXQsIGNoYW5naW5nIHdoYXRldmVyIGl0IHdhbnRzLFxyXG5cdFx0Ly8gYW5kIGNoYW5nZXMgd29uJ3QgYW55aG93IGJlIHJlZmxlY3RlZCBpbiB0aGUgZ3JpZC4gdG8ga2VlcCB0cmFjayBvZiBhbGwgdGhlIGJvZGllc1xyXG5cdFx0Ly8gaW4gdGhlIHRlcnJhaW4gc2xpY2UsIGlmIHRoYXQgd2lsbCBiZSBuZWVkZWQsIG90aGVyIG1lY2hhbmlzbXMgc2hvdWxkIGJlIHVzZWQuXHJcblx0XHQvLyBpZGVhOiBoYXZlIGEgY29sbGVjdGlvbnMgb2YgYm9kaWVzIGJ5IHR5cGUsIGFuZCBzZXR1cCBzZW5zb3IgY29sbGlzaW9uIGJlYW1zXHJcblx0XHQvLyBhdCB0aGUgdGVycmFpbiBzbGljZXMnIGJvdW5kYXJpZXMgdG8ga2VlcCB0cmFjayBvZiBib2RpZXMgZmx5aW5nIG92ZXIgZnJvbSBvbmVcclxuXHRcdC8vIHRlcnJhaW4gc2xpY2UgdG8gYW5vdGhlci4gQnR3LCBBbGksIEkgaGF0ZSB5b3UgZm9yIG1ha2luZyBtZSB0byB0eXBlIFwidGVycmFpbiBzbGljZVwiXHJcblx0XHQvLyBpbnN0ZWFkIG9mIHRoZSBcImNodW5rXCIgXHJcblx0XHR0aGlzLmdyaWQgPSBbXTtcclxuXHRcdFxyXG5cdFx0dGhpcy5vcmlnaW4gPSB7eDogbnVsbCwgeTogbnVsbH07XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuQ2VsbCA9IGZ1bmN0aW9uKGlkKXtcclxuXHRcdHRoaXMuaWQgPSBpZDtcclxuXHRcdHRoaXMuYm9keTtcclxuXHR9XHJcblx0XHJcblxyXG5cdFxyXG5cdFxyXG59O1xyXG5cclxuVGVycmFpblNsaWNlTW9kZWwucHJvdG90eXBlLmx2bF9wcm9iID0gW1xyXG5cdFs3LCAyLCAxXSxcclxuXHRbMCwgNywgM10sXHJcblx0WzAsIDEsIDldXHJcbl1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IFRlcnJhaW5TbGljZU1vZGVsO1xyXG4iLCJ2YXIgVGVzdE1vZGVsID0gZnVuY3Rpb24oKXtcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBUZXN0TW9kZWw7XHJcblxyXG4iLCJ2YXIgV29ybGRNb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblx0XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBXb3JsZE1vZGVsO1xyXG5cclxuIiwidmFyIEFudFJlbmRlcmVyID0gKGZ1bmN0aW9uKCl7XHJcblx0Ly8gVE9ETzogbWVjaGFuaXNtIGZvciBlYXN5IGZpbmRpbmcgb2YgbmV3IGFudHMgdG8gcmVuZGVyXHJcblxyXG5cdHZhciBzcHJpdGVzaGVldHMgPSB7fTtcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbihJbml0R3JhcGhpY3Mpe1xyXG5cdFx0LyoqXHJcblx0XHQqIHdpbGwgYmUgY2FsbGVkIG9uY2Ugd2hlbiBnYW1lIGlzIGxvYWRlZCBmcm9tIHRoZSBHcmFwaGljc0NvbnRyb2xsZXIuaW5pdFxyXG5cdFx0KiBpbml0aWFsaXplIHlvdSBhbmltYXRpb24gZGVmaW5pdGlvbnMgYW5kIG90aGVyIHN0dWZmIGhlcmVcclxuXHRcdCogPkluaXRHcmFwaGljczwgY29udGFpbnMgZ3JhcGhpY3MgZnVuY3Rpb25zIG5lZWRlZCAoYW5kIGF2YWlsYWJsZSkgZHVyaW5nIGluaXRpYWxpemF0aW9uXHJcblx0XHQqL1xyXG5cdFx0dmFyIGdldF9hc3NldCA9IEluaXRHcmFwaGljcy5nZXRfYXNzZXQ7XHJcblxyXG5cdFx0c3ByaXRlc2hlZXRzW1wiYW50XCJdID0gbmV3IGNyZWF0ZWpzLlNwcml0ZVNoZWV0KHtcclxuXHRcdFx0XCJmcmFtZXJhdGVcIjogMSxcclxuXHRcdFx0XCJpbWFnZXNcIjogW2dldF9hc3NldChcIkFudDFcIiksIGdldF9hc3NldChcIkFudDJcIiksIGdldF9hc3NldChcIkFudDNcIildLFxyXG5cdFx0XHRcImZyYW1lc1wiOiB7IFwicmVnWFwiOiAzLCBcInJlZ1lcIjogNiwgXCJoZWlnaHRcIjogMjUsIFwid2lkdGhcIjogNTAsIFwiY291bnRcIjogNn0sXHJcblx0XHRcdFwiYW5pbWF0aW9uc1wiOiB7XHJcblx0XHRcdFx0XCJ3YWxrXCI6IFswLCAxLCBcIndhbGtcIl0sXHJcblx0XHRcdFx0XCJ1cHNpZGVfZG93blwiOiBbMiwgMywgXCJ1cHNpZGVfZG93blwiXSxcclxuXHRcdFx0XHRcImRlYXRoXCI6IFs0LCA1LCBcImRlYXRoXCJdXHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblxyXG5cdH07XHJcblx0XHJcblx0dmFyIHJlZ2lzdGVyID0gZnVuY3Rpb24ocGh5c2ljYWxfaW5zdGFuY2UsIEdyYXBoaWNzKXtcclxuXHRcdC8qKlxyXG5cdFx0KiB0aGlzIGlzIGNhbGxlZCB3aGVuIG5ldyBhbnQgaXMgZmlyc3QgcmVnaXN0ZXJlZCBpbiBncmFwaGljcyBjb250cm9sbGVyXHJcblx0XHQqIHlvdSBhcmUgcmVzcG9uc2libGUgZm9yIHJlZ2lzdGVyaW5nIGl0IGZvciByZW5kZXJpbmcgZXRjLlxyXG5cdFx0KiA+R3JhcGhpY3M8IG9iamVjdCBnaXZlcyB5b3UgYWNjZXNzIHRvIHZhcmlvdXMgZnVuY3Rpb25zIGFuZCBtb2R1bGVzIHlvdSBhcmVcclxuXHRcdCogYWxsb3dlZCB0byB1c2VcclxuXHRcdCovXHJcblx0XHR2YXIgYW50X2FuaW1hdGlvbiA9IEdyYXBoaWNzLnJlcXVlc3RfYW5pbWF0ZWQoc3ByaXRlc2hlZXRzW1wiYW50XCJdLCBcIndhbGtcIik7XHJcblx0XHRHcmFwaGljcy5zZXRfcmVnX3Bvc2l0aW9uKGFudF9hbmltYXRpb24sIDAsIDApOyAvLyBjaGFuZ2UgdGhhdCB0byBhZGp1c3Qgc3ByaXRlIHBvc2l0aW9uIHJlbGF0aXZlIHRvIHRoZSBib2R5XHJcblx0XHRHcmFwaGljcy5yZWdfZm9yX3JlbmRlcihhbnRfYW5pbWF0aW9uLCBwaHlzaWNhbF9pbnN0YW5jZSk7IC8vIHNldHMgYW50X2FuaW1hdGlvbidzIHBvc2l0aW9uIHRvIHRyYWNrIHRoZSBhbnQncyBwb3NpdGlvbiAodXBkYXRlcyBlYWNoIHRpY2spXHJcblxyXG5cdH07XHJcblx0XHJcblxyXG5cdHZhciByZW5kZXIgPSBmdW5jdGlvbihhbnQsIEdyYXBoaWNzKXtcclxuXHRcdC8qKlxyXG5cdFx0KiB0YWtlcyA+YW50PCAodGhlIGFudCBvYmplY3QpIGFuZCBcclxuXHRcdCogPkdyYXBoaWNzPCB3aGljaCBpcyBhbiBvYmplY3QgY29udGFpbmluZyB2YXJpb3VzIGZ1bmN0aW9ucy9vYmplY3RzXHJcblx0XHQqIHBhc3NlZCBmcm9tIHRoZSBHcmFwaGljc0NvbnRyb2xsZXIgdG8gYWxsb3cgeW91IHRvIHByb3Blcmx5IHJlbmRlciB0aGUgYW50XHJcblx0XHQqIHdpbGwgYmUgY2FsbGVkIGVhY2ggdGlja1xyXG5cdFx0Ki9cclxuXHJcblx0XHQvLyBURU1QT1JBUlkgbmVlZHMgdG8gY2hhbmdlIHRvIHNvbWUgc29ydCBvZiBcclxuXHRcdC8vIHNwYXduaW5nIG5vdGlmaWNhdGlvbiBzeXN0ZW0gd2hpY2ggaXMgZ2VuZXJhbCBcclxuXHRcdC8vIGlkZWE6IGNoZWNrIGZvciB0eXBlIGFuZCBjYWxsIGZ1bmN0aW9uIHdpdGhpbmcgaW5kaXZpZHVhbCBSRU5ERVJFUlxyXG5cdFx0Ly8gdG8gY3JlYXRlIG5lZWRlZCBhbmltYXRpb25cclxuXHRcdFxyXG5cdFx0YW50X3NwZWNpYWxfcmVuZGVyX3RlbXAoYW50KTsgXHJcblx0XHRcclxuXHJcblx0fTtcclxuXHRcclxuXHR2YXIgYW50X3NwZWNpYWxfcmVuZGVyX3RlbXAgPSBmdW5jdGlvbihhbnQpe1xyXG5cdFx0LyogaG93IHRvIGhhbmRsZSBzcGVjaWFsIHJlbmRlcj8gVEVNUE9SQVJZICovXHJcblxyXG5cclxuXHRcdGlmKGFudC5BSV9zdGF0ZSA9PSBcImRlYXRoXCIpe1xyXG5cdFx0XHRhbnQuZ290b0FuZFN0b3AoXCJkZWF0aFwiKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZihhbnQuQUlfc3RhdGUgPT0gXCJ1cHNpZGVfZG93blwiKVxyXG5cdFx0e1xyXG5cdFx0XHRhbnQuZ290b0FuZFBsYXkoXCJ1cHNpZGVfZG93blwiKTtcclxuXHRcdH1cclxuXHJcblx0XHRcclxuXHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0cmVuZGVyOiByZW5kZXIsXHJcblx0XHRyZWdpc3RlcjogcmVnaXN0ZXJcclxuXHR9O1xyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBBbnRSZW5kZXJlcjtcclxuIiwidmFyIEhlcm9SZW5kZXJlciA9IChmdW5jdGlvbigpe1xyXG5cdC8vIFRPRE86IG1lY2hhbmlzbSBmb3IgZWFzeSBmaW5kaW5nIG9mIG5ldyBhbnRzIHRvIHJlbmRlclxyXG5cclxuXHR2YXIgc3ByaXRlc2hlZXRzID0ge307XHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oSW5pdEdyYXBoaWNzKXtcclxuXHRcdC8qKlxyXG5cdFx0KiB3aWxsIGJlIGNhbGxlZCBvbmNlIHdoZW4gZ2FtZSBpcyBsb2FkZWQgZnJvbSB0aGUgR3JhcGhpY3NDb250cm9sbGVyLmluaXRcclxuXHRcdCogaW5pdGlhbGl6ZSB5b3UgYW5pbWF0aW9uIGRlZmluaXRpb25zIGFuZCBvdGhlciBzdHVmZiBoZXJlXHJcblx0XHQqID5Jbml0R3JhcGhpY3M8IGNvbnRhaW5zIGdyYXBoaWNzIGZ1bmN0aW9ucyBuZWVkZWQgKGFuZCBhdmFpbGFibGUpIGR1cmluZyBpbml0aWFsaXphdGlvblxyXG5cdFx0Ki9cclxuXHRcdHZhciBnZXRfYXNzZXQgPSBJbml0R3JhcGhpY3MuZ2V0X2Fzc2V0O1xyXG5cclxuXHR9O1xyXG5cdFxyXG5cdHZhciByZWdpc3RlciA9IGZ1bmN0aW9uKHBoeXNpY2FsX2luc3RhbmNlLCBHcmFwaGljcyl7XHJcblx0XHQvKipcclxuXHRcdCogZGVzY3JpcHRpb25cclxuXHRcdCovXHJcblxyXG5cdFx0dmFyIGhlcm8gPSBHcmFwaGljcy5yZXF1ZXN0X2JpdG1hcChcImdyZWVrX3dhcnJpb3JcIik7XHJcblxyXG5cdFx0R3JhcGhpY3Muc2V0X3JlZ19wb3NpdGlvbihoZXJvLCAtMjAsICsxMCk7XHJcblx0XHRHcmFwaGljcy5yZWdfZm9yX3JlbmRlcihoZXJvLCBwaHlzaWNhbF9pbnN0YW5jZSk7XHJcblxyXG5cdH07XHJcblx0XHJcblxyXG5cdHZhciByZW5kZXIgPSBmdW5jdGlvbihoZXJvLCBHcmFwaGljcyl7XHJcblx0XHRcclxuXHR9O1xyXG5cdFxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0aW5pdDogaW5pdCwgXHJcblx0XHRyZW5kZXI6IHJlbmRlcixcclxuXHRcdHJlZ2lzdGVyOiByZWdpc3RlclxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEhlcm9SZW5kZXJlcjtcclxuIiwiXHJcbi8qXHJcbiAqIFJ1bGVzIGZvciB3b3JraW5nIG9uIHRoZSAoY2xpZW50LXNpZGUpIGdhbWUgY29kZTpcclxuICpcclxuICogMS4gSWYgeW91IHRoaW5rIHRoYXQgb25lIG9mIHRoZXNlIHJ1bGVzIGlzIHN0dXBpZCBvciB1c2VsZXNzLCB0ZWxsIG1lLCBhbG9uZyB3aXRoIHNvbWUgYmV0dGVyIHN1Z2dlc3Rpb25zLlxyXG4gKlxyXG4gKiAyLiBNb2RlbCBbbmFtZV1Nb2RlbCBjYW4gb25seSBiZSBhY2Nlc3NlZCB0aHJvdWdoIFtuYW1lXUNvbnRyb2xsZXIuIElmIHlvdSBuZWVkIHRvIGRvIHNvbWV0aGluZyB0byBcclxuICogXHRcdGNoYW5nZSBbbmFtZV1Nb2RlbCBmcm9tIFtvdGhlcl9uYW1lXUNvbnRyb2xsZXIsIHdyaXRlIGZ1bmN0aW9uIGluIHRoZSBbbmFtZV1Db250cm9sbGVyIHRoYXQgZG9lc1xyXG4gKiBcdFx0d2hhdCB5b3UgbmVlZCwgYW5kIGNhbGwgaXQgZnJvbSB0aGUgW290aGVyX25hbWVdQ29udHJvbGxlclxyXG4gKlxyXG4gKiAzLiBDb250cm9sbGVycyBhcmUgYWxsb3dlZCB0byBoYXZlIHByaXZhdGUgbWV0aG9kcy9maWVsZHMuIE1vZGVscyBhcmVuJ3QuIFxyXG4gKlxyXG4gKiA0LiBDb250cm9sbGVycyBhcmVuJ3QgYWxsb3dlZCB0byBoYXZlIHB1YmxpYyBkYXRhIGZpZWxkcy4gXHJcbiAqIFx0XHRUaG9zZSBkYXRhIGZpZWxkcyB0aGF0IGFyZSBwcmVzZW50IG11c3Qgbm90IHJlZmxlY3Qgc3RhdGUgb2YgdGhlIGdhbWUsIHRoZXkgbXVzdCBiZSByZWxhdGVkIHRvXHJcbiAqIFx0XHRzb21lIGludGVybmFsIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIGNvbnRyb2xsZXJcclxuICpcclxuICogNS4gSWYgeW91IHdyaXRlIHNvbWUgZnVuY3Rpb24gdGhhdCBkb2Vzbid0IGxvZ2ljYWxseSBiZWxvbmcgdG8gb25lIG9mIHRoZSBjb250cm9sbGVycyxcclxuICogXHRcdHB1dCBpdCBpbiB0aGUgVXRpbGl0eVxyXG4gKlxyXG4gKiA2LiBWYXJpYWJsZXMgYXJlIG5hbWVkIGxpa2UgdGhhdDogdmFyaWFibGVfbmFtZVxyXG4gKiBcdFx0RXhjZXB0IChzaW5nbGV0b24pY2xhc3MgbmFtZXMsIHRoYXQgYXJlIHdyaXR0ZW4gbGlrZSB0aGF0OiBDbGFzc05hbWVcclxuICpcclxuICogNy4gQW5kIGFsbCB0aGUgb2J2aW91cyBzdHVmZiB0aGF0IGV2ZXJ5b25lIGtub3dzOlxyXG4gKiBcdFx0ZnVuY3Rpb24gbXVzdCBkbyBvbmUgdGhpbmc7IGRvbid0IG1ha2UgZnVuY3Rpb24gcHVibGljIHVubGVzcyBpdCBuZWVkcyB0byBiZSB0aGF0OyBcclxuICogXHRcdGNvbW1lbnQgYW1iaWdpb3VzIGNvZGUsIGZvciBsYXJnZXIgZnVuY3Rpb25zIGluZGljYXRlIHRoZWlyIHB1cnBvc2UgKHRocm91Z2ggY29tbWVudGluZyk7XHJcbiAqL1xyXG5cclxuXHJcbi8vIG1haW4gbmFtZXNwYWNlIHRoYXQgaXMgZXhwb3NlZCB0byBnbG9iYWwgc2NvcGUgKHdpbmRvdyBvYmplY3QpXHJcbndpbmRvdy5zaWRlc2Nyb2xsZXJfZ2FtZSA9IChmdW5jdGlvbiBuYW1lc3BhY2UoKXtcclxuXHJcblx0XHR2YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdFx0Y3VycmVudF9tb2R1bGU6IFwiTm9uZVwiLCBcclxuXHRcdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5BTExfQ09OVFJPTExFUlNcclxuXHR9KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG5cdC8vIEdhbWUgaW5pdGlhdGlvbiBzZWN0aW9uOiA+Pj5cclxuXHRcdFxyXG5cdHZhciBsb2FkX2dhbWUgPSBmdW5jdGlvbihtb2RlKVxyXG5cdHtcclxuXHJcblx0XHRJbmNsdWRlcy5pbml0KCk7IC8vIGZpcnN0XHJcblx0XHRpbmNsdWRlKCk7IC8vIHNlY29uZFxyXG5cclxuXHRcdEluaXRDb250cm9sbGVyLmluaXQobW9kZSk7IC8vIGluaXQgYWxsIHRoZSBzdHVmZlxyXG5cclxuXHRcdGlmKG1vZGUgPT0gXCJ0ZXN0XCIpe1xyXG5cdFx0XHRUZXN0Q29udHJvbGxlci50ZXN0KCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblxyXG5cdHZhciBydW4gPSBmdW5jdGlvbihtb2RlKVxyXG5cdHtcclxuXHRcdC8vIGRvbmUgdGhpcyB3YXkgdG8gZW5zdXJlIHRoYXQgbG9hZF9nYW1lJ3MgaW50ZXJuYWxzIGFyZW4ndCBhY2Nlc3NpYmxlIHRvIHRoZSB3b3JsZDpcclxuXHRcdGxvYWRfZ2FtZShtb2RlKTtcclxuXHR9OyBcclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0cnVuOiBydW5cclxuXHR9OyAvLyBleHBvc2UgZnVuY3Rpb24gcnVuIHRvIHRoZSB3b3JsZFxyXG5cclxufSkoKTsgXHJcblxyXG4iLCIvKlxyXG4qIENvcHlyaWdodCAoYykgMjAwNi0yMDA3IEVyaW4gQ2F0dG8gaHR0cDovL3d3dy5ncGh5c2ljcy5jb21cclxuKlxyXG4qIFRoaXMgc29mdHdhcmUgaXMgcHJvdmlkZWQgJ2FzLWlzJywgd2l0aG91dCBhbnkgZXhwcmVzcyBvciBpbXBsaWVkXHJcbiogd2FycmFudHkuICBJbiBubyBldmVudCB3aWxsIHRoZSBhdXRob3JzIGJlIGhlbGQgbGlhYmxlIGZvciBhbnkgZGFtYWdlc1xyXG4qIGFyaXNpbmcgZnJvbSB0aGUgdXNlIG9mIHRoaXMgc29mdHdhcmUuXHJcbiogUGVybWlzc2lvbiBpcyBncmFudGVkIHRvIGFueW9uZSB0byB1c2UgdGhpcyBzb2Z0d2FyZSBmb3IgYW55IHB1cnBvc2UsXHJcbiogaW5jbHVkaW5nIGNvbW1lcmNpYWwgYXBwbGljYXRpb25zLCBhbmQgdG8gYWx0ZXIgaXQgYW5kIHJlZGlzdHJpYnV0ZSBpdFxyXG4qIGZyZWVseSwgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIHJlc3RyaWN0aW9uczpcclxuKiAxLiBUaGUgb3JpZ2luIG9mIHRoaXMgc29mdHdhcmUgbXVzdCBub3QgYmUgbWlzcmVwcmVzZW50ZWQ7IHlvdSBtdXN0IG5vdFxyXG4qIGNsYWltIHRoYXQgeW91IHdyb3RlIHRoZSBvcmlnaW5hbCBzb2Z0d2FyZS4gSWYgeW91IHVzZSB0aGlzIHNvZnR3YXJlXHJcbiogaW4gYSBwcm9kdWN0LCBhbiBhY2tub3dsZWRnbWVudCBpbiB0aGUgcHJvZHVjdCBkb2N1bWVudGF0aW9uIHdvdWxkIGJlXHJcbiogYXBwcmVjaWF0ZWQgYnV0IGlzIG5vdCByZXF1aXJlZC5cclxuKiAyLiBBbHRlcmVkIHNvdXJjZSB2ZXJzaW9ucyBtdXN0IGJlIHBsYWlubHkgbWFya2VkIGFzIHN1Y2gsIGFuZCBtdXN0IG5vdCBiZVxyXG4qIG1pc3JlcHJlc2VudGVkIGFzIGJlaW5nIHRoZSBvcmlnaW5hbCBzb2Z0d2FyZS5cclxuKiAzLiBUaGlzIG5vdGljZSBtYXkgbm90IGJlIHJlbW92ZWQgb3IgYWx0ZXJlZCBmcm9tIGFueSBzb3VyY2UgZGlzdHJpYnV0aW9uLlxyXG4qL1xyXG5cInVzZSBzdHJpY3RcIlxyXG5cclxudmFyIEJveDJEID0ge307XHJcblxyXG4oZnVuY3Rpb24gKGEyaiwgdW5kZWZpbmVkKSB7XHJcbiAgIFxyXG4gICBmdW5jdGlvbiBlbXB0eUZuKCkge307XHJcbiAgIGEyai5pbmhlcml0ID0gZnVuY3Rpb24oY2xzLCBiYXNlKSB7XHJcbiAgICAgIHZhciB0bXBDdHIgPSBjbHM7XHJcbiAgICAgIGVtcHR5Rm4ucHJvdG90eXBlID0gYmFzZS5wcm90b3R5cGU7XHJcbiAgICAgIGNscy5wcm90b3R5cGUgPSBuZXcgZW1wdHlGbjtcclxuICAgICAgY2xzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHRtcEN0cjtcclxuICAgfTtcclxuICAgXHJcbiAgIGEyai5nZW5lcmF0ZUNhbGxiYWNrID0gZnVuY3Rpb24gZ2VuZXJhdGVDYWxsYmFjayhjb250ZXh0LCBjYikge1xyXG4gICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICBjYi5hcHBseShjb250ZXh0LCBhcmd1bWVudHMpO1xyXG4gICAgICB9O1xyXG4gICB9O1xyXG4gICBcclxuICAgYTJqLk5WZWN0b3IgPSBmdW5jdGlvbiBOVmVjdG9yKGxlbmd0aCkge1xyXG4gICAgICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIGxlbmd0aCA9IDA7XHJcbiAgICAgIHZhciB0bXAgPSBuZXcgQXJyYXkobGVuZ3RoIHx8IDApO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgKytpKVxyXG4gICAgICB0bXBbaV0gPSAwO1xyXG4gICAgICByZXR1cm4gdG1wO1xyXG4gICB9O1xyXG4gICBcclxuICAgYTJqLmlzID0gZnVuY3Rpb24gaXMobzEsIG8yKSB7XHJcbiAgICAgIGlmIChvMSA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICBpZiAoKG8yIGluc3RhbmNlb2YgRnVuY3Rpb24pICYmIChvMSBpbnN0YW5jZW9mIG8yKSkgcmV0dXJuIHRydWU7XHJcbiAgICAgIGlmICgobzEuY29uc3RydWN0b3IuX19pbXBsZW1lbnRzICE9IHVuZGVmaW5lZCkgJiYgKG8xLmNvbnN0cnVjdG9yLl9faW1wbGVtZW50c1tvMl0pKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICB9O1xyXG4gICBcclxuICAgYTJqLnBhcnNlVUludCA9IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgcmV0dXJuIE1hdGguYWJzKHBhcnNlSW50KHYpKTtcclxuICAgfVxyXG4gICBcclxufSkoQm94MkQpO1xyXG5cclxuLy8jVE9ETyByZW1vdmUgYXNzaWdubWVudHMgZnJvbSBnbG9iYWwgbmFtZXNwYWNlXHJcbnZhciBWZWN0b3IgPSBBcnJheTtcclxudmFyIFZlY3Rvcl9hMmpfTnVtYmVyID0gQm94MkQuTlZlY3RvcjtcclxuLy9wYWNrYWdlIHN0cnVjdHVyZVxyXG5pZiAodHlwZW9mKEJveDJEKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQgPSB7fTtcclxuaWYgKHR5cGVvZihCb3gyRC5Db2xsaXNpb24pID09PSBcInVuZGVmaW5lZFwiKSBCb3gyRC5Db2xsaXNpb24gPSB7fTtcclxuaWYgKHR5cGVvZihCb3gyRC5Db2xsaXNpb24uU2hhcGVzKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuQ29sbGlzaW9uLlNoYXBlcyA9IHt9O1xyXG5pZiAodHlwZW9mKEJveDJELkNvbW1vbikgPT09IFwidW5kZWZpbmVkXCIpIEJveDJELkNvbW1vbiA9IHt9O1xyXG5pZiAodHlwZW9mKEJveDJELkNvbW1vbi5NYXRoKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuQ29tbW9uLk1hdGggPSB7fTtcclxuaWYgKHR5cGVvZihCb3gyRC5EeW5hbWljcykgPT09IFwidW5kZWZpbmVkXCIpIEJveDJELkR5bmFtaWNzID0ge307XHJcbmlmICh0eXBlb2YoQm94MkQuRHluYW1pY3MuQ29udGFjdHMpID09PSBcInVuZGVmaW5lZFwiKSBCb3gyRC5EeW5hbWljcy5Db250YWN0cyA9IHt9O1xyXG5pZiAodHlwZW9mKEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMgPSB7fTtcclxuaWYgKHR5cGVvZihCb3gyRC5EeW5hbWljcy5Kb2ludHMpID09PSBcInVuZGVmaW5lZFwiKSBCb3gyRC5EeW5hbWljcy5Kb2ludHMgPSB7fTtcclxuLy9wcmUtZGVmaW5pdGlvbnNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgQm94MkQuQ29sbGlzaW9uLklCcm9hZFBoYXNlID0gJ0JveDJELkNvbGxpc2lvbi5JQnJvYWRQaGFzZSc7XHJcblxyXG4gICBmdW5jdGlvbiBiMkFBQkIoKSB7XHJcbiAgICAgIGIyQUFCQi5iMkFBQkIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyQUFCQiA9IGIyQUFCQjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQm91bmQoKSB7XHJcbiAgICAgIGIyQm91bmQuYjJCb3VuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJCb3VuZCA9IGIyQm91bmQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkJvdW5kVmFsdWVzKCkge1xyXG4gICAgICBiMkJvdW5kVmFsdWVzLmIyQm91bmRWYWx1ZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQm91bmRWYWx1ZXMpIHRoaXMuYjJCb3VuZFZhbHVlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJCb3VuZFZhbHVlcyA9IGIyQm91bmRWYWx1ZXM7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbGxpc2lvbigpIHtcclxuICAgICAgYjJDb2xsaXNpb24uYjJDb2xsaXNpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uID0gYjJDb2xsaXNpb247XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RJRCgpIHtcclxuICAgICAgYjJDb250YWN0SUQuYjJDb250YWN0SUQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQ29udGFjdElEKSB0aGlzLmIyQ29udGFjdElELmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RJRCA9IGIyQ29udGFjdElEO1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0UG9pbnQoKSB7XHJcbiAgICAgIGIyQ29udGFjdFBvaW50LmIyQ29udGFjdFBvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RQb2ludCA9IGIyQ29udGFjdFBvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJEaXN0YW5jZSgpIHtcclxuICAgICAgYjJEaXN0YW5jZS5iMkRpc3RhbmNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlID0gYjJEaXN0YW5jZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRGlzdGFuY2VJbnB1dCgpIHtcclxuICAgICAgYjJEaXN0YW5jZUlucHV0LmIyRGlzdGFuY2VJbnB1dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZUlucHV0ID0gYjJEaXN0YW5jZUlucHV0O1xyXG5cclxuICAgZnVuY3Rpb24gYjJEaXN0YW5jZU91dHB1dCgpIHtcclxuICAgICAgYjJEaXN0YW5jZU91dHB1dC5iMkRpc3RhbmNlT3V0cHV0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlT3V0cHV0ID0gYjJEaXN0YW5jZU91dHB1dDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRGlzdGFuY2VQcm94eSgpIHtcclxuICAgICAgYjJEaXN0YW5jZVByb3h5LmIyRGlzdGFuY2VQcm94eS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZVByb3h5ID0gYjJEaXN0YW5jZVByb3h5O1xyXG5cclxuICAgZnVuY3Rpb24gYjJEeW5hbWljVHJlZSgpIHtcclxuICAgICAgYjJEeW5hbWljVHJlZS5iMkR5bmFtaWNUcmVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkR5bmFtaWNUcmVlKSB0aGlzLmIyRHluYW1pY1RyZWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWUgPSBiMkR5bmFtaWNUcmVlO1xyXG5cclxuICAgZnVuY3Rpb24gYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UoKSB7XHJcbiAgICAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLmIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSA9IGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlO1xyXG5cclxuICAgZnVuY3Rpb24gYjJEeW5hbWljVHJlZU5vZGUoKSB7XHJcbiAgICAgIGIyRHluYW1pY1RyZWVOb2RlLmIyRHluYW1pY1RyZWVOb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlTm9kZSA9IGIyRHluYW1pY1RyZWVOb2RlO1xyXG5cclxuICAgZnVuY3Rpb24gYjJEeW5hbWljVHJlZVBhaXIoKSB7XHJcbiAgICAgIGIyRHluYW1pY1RyZWVQYWlyLmIyRHluYW1pY1RyZWVQYWlyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlUGFpciA9IGIyRHluYW1pY1RyZWVQYWlyO1xyXG5cclxuICAgZnVuY3Rpb24gYjJNYW5pZm9sZCgpIHtcclxuICAgICAgYjJNYW5pZm9sZC5iMk1hbmlmb2xkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMk1hbmlmb2xkKSB0aGlzLmIyTWFuaWZvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGQgPSBiMk1hbmlmb2xkO1xyXG5cclxuICAgZnVuY3Rpb24gYjJNYW5pZm9sZFBvaW50KCkge1xyXG4gICAgICBiMk1hbmlmb2xkUG9pbnQuYjJNYW5pZm9sZFBvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMk1hbmlmb2xkUG9pbnQpIHRoaXMuYjJNYW5pZm9sZFBvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkUG9pbnQgPSBiMk1hbmlmb2xkUG9pbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMlBvaW50KCkge1xyXG4gICAgICBiMlBvaW50LmIyUG9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyUG9pbnQgPSBiMlBvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJSYXlDYXN0SW5wdXQoKSB7XHJcbiAgICAgIGIyUmF5Q2FzdElucHV0LmIyUmF5Q2FzdElucHV0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlJheUNhc3RJbnB1dCkgdGhpcy5iMlJheUNhc3RJbnB1dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJSYXlDYXN0SW5wdXQgPSBiMlJheUNhc3RJbnB1dDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUmF5Q2FzdE91dHB1dCgpIHtcclxuICAgICAgYjJSYXlDYXN0T3V0cHV0LmIyUmF5Q2FzdE91dHB1dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJSYXlDYXN0T3V0cHV0ID0gYjJSYXlDYXN0T3V0cHV0O1xyXG5cclxuICAgZnVuY3Rpb24gYjJTZWdtZW50KCkge1xyXG4gICAgICBiMlNlZ21lbnQuYjJTZWdtZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMlNlZ21lbnQgPSBiMlNlZ21lbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMlNlcGFyYXRpb25GdW5jdGlvbigpIHtcclxuICAgICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24uYjJTZXBhcmF0aW9uRnVuY3Rpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uID0gYjJTZXBhcmF0aW9uRnVuY3Rpb247XHJcblxyXG4gICBmdW5jdGlvbiBiMlNpbXBsZXgoKSB7XHJcbiAgICAgIGIyU2ltcGxleC5iMlNpbXBsZXguYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyU2ltcGxleCkgdGhpcy5iMlNpbXBsZXguYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleCA9IGIyU2ltcGxleDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyU2ltcGxleENhY2hlKCkge1xyXG4gICAgICBiMlNpbXBsZXhDYWNoZS5iMlNpbXBsZXhDYWNoZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4Q2FjaGUgPSBiMlNpbXBsZXhDYWNoZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyU2ltcGxleFZlcnRleCgpIHtcclxuICAgICAgYjJTaW1wbGV4VmVydGV4LmIyU2ltcGxleFZlcnRleC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4VmVydGV4ID0gYjJTaW1wbGV4VmVydGV4O1xyXG5cclxuICAgZnVuY3Rpb24gYjJUaW1lT2ZJbXBhY3QoKSB7XHJcbiAgICAgIGIyVGltZU9mSW1wYWN0LmIyVGltZU9mSW1wYWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdCA9IGIyVGltZU9mSW1wYWN0O1xyXG5cclxuICAgZnVuY3Rpb24gYjJUT0lJbnB1dCgpIHtcclxuICAgICAgYjJUT0lJbnB1dC5iMlRPSUlucHV0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMlRPSUlucHV0ID0gYjJUT0lJbnB1dDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyV29ybGRNYW5pZm9sZCgpIHtcclxuICAgICAgYjJXb3JsZE1hbmlmb2xkLmIyV29ybGRNYW5pZm9sZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJXb3JsZE1hbmlmb2xkKSB0aGlzLmIyV29ybGRNYW5pZm9sZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJXb3JsZE1hbmlmb2xkID0gYjJXb3JsZE1hbmlmb2xkO1xyXG5cclxuICAgZnVuY3Rpb24gQ2xpcFZlcnRleCgpIHtcclxuICAgICAgQ2xpcFZlcnRleC5DbGlwVmVydGV4LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5DbGlwVmVydGV4ID0gQ2xpcFZlcnRleDtcclxuXHJcbiAgIGZ1bmN0aW9uIEZlYXR1cmVzKCkge1xyXG4gICAgICBGZWF0dXJlcy5GZWF0dXJlcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uRmVhdHVyZXMgPSBGZWF0dXJlcztcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ2lyY2xlU2hhcGUoKSB7XHJcbiAgICAgIGIyQ2lyY2xlU2hhcGUuYjJDaXJjbGVTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJDaXJjbGVTaGFwZSkgdGhpcy5iMkNpcmNsZVNoYXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZSA9IGIyQ2lyY2xlU2hhcGU7XHJcblxyXG4gICBmdW5jdGlvbiBiMkVkZ2VDaGFpbkRlZigpIHtcclxuICAgICAgYjJFZGdlQ2hhaW5EZWYuYjJFZGdlQ2hhaW5EZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyRWRnZUNoYWluRGVmKSB0aGlzLmIyRWRnZUNoYWluRGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlQ2hhaW5EZWYgPSBiMkVkZ2VDaGFpbkRlZjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRWRnZVNoYXBlKCkge1xyXG4gICAgICBiMkVkZ2VTaGFwZS5iMkVkZ2VTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJFZGdlU2hhcGUpIHRoaXMuYjJFZGdlU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VTaGFwZSA9IGIyRWRnZVNoYXBlO1xyXG5cclxuICAgZnVuY3Rpb24gYjJNYXNzRGF0YSgpIHtcclxuICAgICAgYjJNYXNzRGF0YS5iMk1hc3NEYXRhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJNYXNzRGF0YSA9IGIyTWFzc0RhdGE7XHJcblxyXG4gICBmdW5jdGlvbiBiMlBvbHlnb25TaGFwZSgpIHtcclxuICAgICAgYjJQb2x5Z29uU2hhcGUuYjJQb2x5Z29uU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyUG9seWdvblNoYXBlKSB0aGlzLmIyUG9seWdvblNoYXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJQb2x5Z29uU2hhcGUgPSBiMlBvbHlnb25TaGFwZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyU2hhcGUoKSB7XHJcbiAgICAgIGIyU2hhcGUuYjJTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJTaGFwZSkgdGhpcy5iMlNoYXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSA9IGIyU2hhcGU7XHJcbiAgIEJveDJELkNvbW1vbi5iMmludGVybmFsID0gJ0JveDJELkNvbW1vbi5iMmludGVybmFsJztcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29sb3IoKSB7XHJcbiAgICAgIGIyQ29sb3IuYjJDb2xvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJDb2xvcikgdGhpcy5iMkNvbG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbW1vbi5iMkNvbG9yID0gYjJDb2xvcjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyU2V0dGluZ3MoKSB7XHJcbiAgICAgIGIyU2V0dGluZ3MuYjJTZXR0aW5ncy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyA9IGIyU2V0dGluZ3M7XHJcblxyXG4gICBmdW5jdGlvbiBiMk1hdDIyKCkge1xyXG4gICAgICBiMk1hdDIyLmIyTWF0MjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyTWF0MjIpIHRoaXMuYjJNYXQyMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDIyID0gYjJNYXQyMjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyTWF0MzMoKSB7XHJcbiAgICAgIGIyTWF0MzMuYjJNYXQzMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJNYXQzMykgdGhpcy5iMk1hdDMzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MzMgPSBiMk1hdDMzO1xyXG5cclxuICAgZnVuY3Rpb24gYjJNYXRoKCkge1xyXG4gICAgICBiMk1hdGguYjJNYXRoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aCA9IGIyTWF0aDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyU3dlZXAoKSB7XHJcbiAgICAgIGIyU3dlZXAuYjJTd2VlcC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwID0gYjJTd2VlcDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyVHJhbnNmb3JtKCkge1xyXG4gICAgICBiMlRyYW5zZm9ybS5iMlRyYW5zZm9ybS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJUcmFuc2Zvcm0pIHRoaXMuYjJUcmFuc2Zvcm0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29tbW9uLk1hdGguYjJUcmFuc2Zvcm0gPSBiMlRyYW5zZm9ybTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyVmVjMigpIHtcclxuICAgICAgYjJWZWMyLmIyVmVjMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJWZWMyKSB0aGlzLmIyVmVjMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIgPSBiMlZlYzI7XHJcblxyXG4gICBmdW5jdGlvbiBiMlZlYzMoKSB7XHJcbiAgICAgIGIyVmVjMy5iMlZlYzMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyVmVjMykgdGhpcy5iMlZlYzMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29tbW9uLk1hdGguYjJWZWMzID0gYjJWZWMzO1xyXG5cclxuICAgZnVuY3Rpb24gYjJCb2R5KCkge1xyXG4gICAgICBiMkJvZHkuYjJCb2R5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkJvZHkpIHRoaXMuYjJCb2R5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLmIyQm9keSA9IGIyQm9keTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQm9keURlZigpIHtcclxuICAgICAgYjJCb2R5RGVmLmIyQm9keURlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJCb2R5RGVmKSB0aGlzLmIyQm9keURlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMkJvZHlEZWYgPSBiMkJvZHlEZWY7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RGaWx0ZXIoKSB7XHJcbiAgICAgIGIyQ29udGFjdEZpbHRlci5iMkNvbnRhY3RGaWx0ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuYjJDb250YWN0RmlsdGVyID0gYjJDb250YWN0RmlsdGVyO1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0SW1wdWxzZSgpIHtcclxuICAgICAgYjJDb250YWN0SW1wdWxzZS5iMkNvbnRhY3RJbXB1bHNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEltcHVsc2UgPSBiMkNvbnRhY3RJbXB1bHNlO1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0TGlzdGVuZXIoKSB7XHJcbiAgICAgIGIyQ29udGFjdExpc3RlbmVyLmIyQ29udGFjdExpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLmIyQ29udGFjdExpc3RlbmVyID0gYjJDb250YWN0TGlzdGVuZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RNYW5hZ2VyKCkge1xyXG4gICAgICBiMkNvbnRhY3RNYW5hZ2VyLmIyQ29udGFjdE1hbmFnZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQ29udGFjdE1hbmFnZXIpIHRoaXMuYjJDb250YWN0TWFuYWdlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RNYW5hZ2VyID0gYjJDb250YWN0TWFuYWdlcjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRGVidWdEcmF3KCkge1xyXG4gICAgICBiMkRlYnVnRHJhdy5iMkRlYnVnRHJhdy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJEZWJ1Z0RyYXcpIHRoaXMuYjJEZWJ1Z0RyYXcuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXcgPSBiMkRlYnVnRHJhdztcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lcigpIHtcclxuICAgICAgYjJEZXN0cnVjdGlvbkxpc3RlbmVyLmIyRGVzdHJ1Y3Rpb25MaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMkRlc3RydWN0aW9uTGlzdGVuZXIgPSBiMkRlc3RydWN0aW9uTGlzdGVuZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkZpbHRlckRhdGEoKSB7XHJcbiAgICAgIGIyRmlsdGVyRGF0YS5iMkZpbHRlckRhdGEuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuYjJGaWx0ZXJEYXRhID0gYjJGaWx0ZXJEYXRhO1xyXG5cclxuICAgZnVuY3Rpb24gYjJGaXh0dXJlKCkge1xyXG4gICAgICBiMkZpeHR1cmUuYjJGaXh0dXJlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkZpeHR1cmUpIHRoaXMuYjJGaXh0dXJlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLmIyRml4dHVyZSA9IGIyRml4dHVyZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRml4dHVyZURlZigpIHtcclxuICAgICAgYjJGaXh0dXJlRGVmLmIyRml4dHVyZURlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJGaXh0dXJlRGVmKSB0aGlzLmIyRml4dHVyZURlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMkZpeHR1cmVEZWYgPSBiMkZpeHR1cmVEZWY7XHJcblxyXG4gICBmdW5jdGlvbiBiMklzbGFuZCgpIHtcclxuICAgICAgYjJJc2xhbmQuYjJJc2xhbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIySXNsYW5kKSB0aGlzLmIySXNsYW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLmIySXNsYW5kID0gYjJJc2xhbmQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMlRpbWVTdGVwKCkge1xyXG4gICAgICBiMlRpbWVTdGVwLmIyVGltZVN0ZXAuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuYjJUaW1lU3RlcCA9IGIyVGltZVN0ZXA7XHJcblxyXG4gICBmdW5jdGlvbiBiMldvcmxkKCkge1xyXG4gICAgICBiMldvcmxkLmIyV29ybGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyV29ybGQpIHRoaXMuYjJXb3JsZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMldvcmxkID0gYjJXb3JsZDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ2lyY2xlQ29udGFjdCgpIHtcclxuICAgICAgYjJDaXJjbGVDb250YWN0LmIyQ2lyY2xlQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNpcmNsZUNvbnRhY3QgPSBiMkNpcmNsZUNvbnRhY3Q7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRhY3QoKSB7XHJcbiAgICAgIGIyQ29udGFjdC5iMkNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQ29udGFjdCkgdGhpcy5iMkNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0ID0gYjJDb250YWN0O1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0Q29uc3RyYWludCgpIHtcclxuICAgICAgYjJDb250YWN0Q29uc3RyYWludC5iMkNvbnRhY3RDb25zdHJhaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkNvbnRhY3RDb25zdHJhaW50KSB0aGlzLmIyQ29udGFjdENvbnN0cmFpbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0Q29uc3RyYWludCA9IGIyQ29udGFjdENvbnN0cmFpbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RDb25zdHJhaW50UG9pbnQoKSB7XHJcbiAgICAgIGIyQ29udGFjdENvbnN0cmFpbnRQb2ludC5iMkNvbnRhY3RDb25zdHJhaW50UG9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0Q29uc3RyYWludFBvaW50ID0gYjJDb250YWN0Q29uc3RyYWludFBvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0RWRnZSgpIHtcclxuICAgICAgYjJDb250YWN0RWRnZS5iMkNvbnRhY3RFZGdlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdEVkZ2UgPSBiMkNvbnRhY3RFZGdlO1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0RmFjdG9yeSgpIHtcclxuICAgICAgYjJDb250YWN0RmFjdG9yeS5iMkNvbnRhY3RGYWN0b3J5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkNvbnRhY3RGYWN0b3J5KSB0aGlzLmIyQ29udGFjdEZhY3RvcnkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0RmFjdG9yeSA9IGIyQ29udGFjdEZhY3Rvcnk7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RSZWdpc3RlcigpIHtcclxuICAgICAgYjJDb250YWN0UmVnaXN0ZXIuYjJDb250YWN0UmVnaXN0ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0UmVnaXN0ZXIgPSBiMkNvbnRhY3RSZWdpc3RlcjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29udGFjdFJlc3VsdCgpIHtcclxuICAgICAgYjJDb250YWN0UmVzdWx0LmIyQ29udGFjdFJlc3VsdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RSZXN1bHQgPSBiMkNvbnRhY3RSZXN1bHQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RTb2x2ZXIoKSB7XHJcbiAgICAgIGIyQ29udGFjdFNvbHZlci5iMkNvbnRhY3RTb2x2ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQ29udGFjdFNvbHZlcikgdGhpcy5iMkNvbnRhY3RTb2x2ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0U29sdmVyID0gYjJDb250YWN0U29sdmVyO1xyXG5cclxuICAgZnVuY3Rpb24gYjJFZGdlQW5kQ2lyY2xlQ29udGFjdCgpIHtcclxuICAgICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5iMkVkZ2VBbmRDaXJjbGVDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyRWRnZUFuZENpcmNsZUNvbnRhY3QgPSBiMkVkZ2VBbmRDaXJjbGVDb250YWN0O1xyXG5cclxuICAgZnVuY3Rpb24gYjJOdWxsQ29udGFjdCgpIHtcclxuICAgICAgYjJOdWxsQ29udGFjdC5iMk51bGxDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMk51bGxDb250YWN0KSB0aGlzLmIyTnVsbENvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJOdWxsQ29udGFjdCA9IGIyTnVsbENvbnRhY3Q7XHJcblxyXG4gICBmdW5jdGlvbiBiMlBvbHlBbmRDaXJjbGVDb250YWN0KCkge1xyXG4gICAgICBiMlBvbHlBbmRDaXJjbGVDb250YWN0LmIyUG9seUFuZENpcmNsZUNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCA9IGIyUG9seUFuZENpcmNsZUNvbnRhY3Q7XHJcblxyXG4gICBmdW5jdGlvbiBiMlBvbHlBbmRFZGdlQ29udGFjdCgpIHtcclxuICAgICAgYjJQb2x5QW5kRWRnZUNvbnRhY3QuYjJQb2x5QW5kRWRnZUNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kRWRnZUNvbnRhY3QgPSBiMlBvbHlBbmRFZGdlQ29udGFjdDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUG9seWdvbkNvbnRhY3QoKSB7XHJcbiAgICAgIGIyUG9seWdvbkNvbnRhY3QuYjJQb2x5Z29uQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvbHlnb25Db250YWN0ID0gYjJQb2x5Z29uQ29udGFjdDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCgpIHtcclxuICAgICAgYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkKSB0aGlzLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQgPSBiMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkJ1b3lhbmN5Q29udHJvbGxlcigpIHtcclxuICAgICAgYjJCdW95YW5jeUNvbnRyb2xsZXIuYjJCdW95YW5jeUNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJCdW95YW5jeUNvbnRyb2xsZXIgPSBiMkJ1b3lhbmN5Q29udHJvbGxlcjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIoKSB7XHJcbiAgICAgIGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIuYjJDb25zdGFudEFjY2VsQ29udHJvbGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnN0YW50QWNjZWxDb250cm9sbGVyID0gYjJDb25zdGFudEFjY2VsQ29udHJvbGxlcjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIoKSB7XHJcbiAgICAgIGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIuYjJDb25zdGFudEZvcmNlQ29udHJvbGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyID0gYjJDb25zdGFudEZvcmNlQ29udHJvbGxlcjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29udHJvbGxlcigpIHtcclxuICAgICAgYjJDb250cm9sbGVyLmIyQ29udHJvbGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIgPSBiMkNvbnRyb2xsZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRyb2xsZXJFZGdlKCkge1xyXG4gICAgICBiMkNvbnRyb2xsZXJFZGdlLmIyQ29udHJvbGxlckVkZ2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyRWRnZSA9IGIyQ29udHJvbGxlckVkZ2U7XHJcblxyXG4gICBmdW5jdGlvbiBiMkdyYXZpdHlDb250cm9sbGVyKCkge1xyXG4gICAgICBiMkdyYXZpdHlDb250cm9sbGVyLmIyR3Jhdml0eUNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJHcmF2aXR5Q29udHJvbGxlciA9IGIyR3Jhdml0eUNvbnRyb2xsZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyKCkge1xyXG4gICAgICBiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyLmIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlciA9IGIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkRpc3RhbmNlSm9pbnQoKSB7XHJcbiAgICAgIGIyRGlzdGFuY2VKb2ludC5iMkRpc3RhbmNlSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyRGlzdGFuY2VKb2ludCkgdGhpcy5iMkRpc3RhbmNlSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRGlzdGFuY2VKb2ludCA9IGIyRGlzdGFuY2VKb2ludDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRGlzdGFuY2VKb2ludERlZigpIHtcclxuICAgICAgYjJEaXN0YW5jZUpvaW50RGVmLmIyRGlzdGFuY2VKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJEaXN0YW5jZUpvaW50RGVmKSB0aGlzLmIyRGlzdGFuY2VKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJEaXN0YW5jZUpvaW50RGVmID0gYjJEaXN0YW5jZUpvaW50RGVmO1xyXG5cclxuICAgZnVuY3Rpb24gYjJGcmljdGlvbkpvaW50KCkge1xyXG4gICAgICBiMkZyaWN0aW9uSm9pbnQuYjJGcmljdGlvbkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkZyaWN0aW9uSm9pbnQpIHRoaXMuYjJGcmljdGlvbkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkZyaWN0aW9uSm9pbnQgPSBiMkZyaWN0aW9uSm9pbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkZyaWN0aW9uSm9pbnREZWYoKSB7XHJcbiAgICAgIGIyRnJpY3Rpb25Kb2ludERlZi5iMkZyaWN0aW9uSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyRnJpY3Rpb25Kb2ludERlZikgdGhpcy5iMkZyaWN0aW9uSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRnJpY3Rpb25Kb2ludERlZiA9IGIyRnJpY3Rpb25Kb2ludERlZjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyR2VhckpvaW50KCkge1xyXG4gICAgICBiMkdlYXJKb2ludC5iMkdlYXJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJHZWFySm9pbnQpIHRoaXMuYjJHZWFySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyR2VhckpvaW50ID0gYjJHZWFySm9pbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkdlYXJKb2ludERlZigpIHtcclxuICAgICAgYjJHZWFySm9pbnREZWYuYjJHZWFySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyR2VhckpvaW50RGVmKSB0aGlzLmIyR2VhckpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkdlYXJKb2ludERlZiA9IGIyR2VhckpvaW50RGVmO1xyXG5cclxuICAgZnVuY3Rpb24gYjJKYWNvYmlhbigpIHtcclxuICAgICAgYjJKYWNvYmlhbi5iMkphY29iaWFuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkphY29iaWFuID0gYjJKYWNvYmlhbjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIySm9pbnQoKSB7XHJcbiAgICAgIGIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJKb2ludCkgdGhpcy5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50ID0gYjJKb2ludDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIySm9pbnREZWYoKSB7XHJcbiAgICAgIGIySm9pbnREZWYuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJKb2ludERlZikgdGhpcy5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmID0gYjJKb2ludERlZjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIySm9pbnRFZGdlKCkge1xyXG4gICAgICBiMkpvaW50RWRnZS5iMkpvaW50RWRnZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludEVkZ2UgPSBiMkpvaW50RWRnZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyTGluZUpvaW50KCkge1xyXG4gICAgICBiMkxpbmVKb2ludC5iMkxpbmVKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJMaW5lSm9pbnQpIHRoaXMuYjJMaW5lSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyTGluZUpvaW50ID0gYjJMaW5lSm9pbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkxpbmVKb2ludERlZigpIHtcclxuICAgICAgYjJMaW5lSm9pbnREZWYuYjJMaW5lSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyTGluZUpvaW50RGVmKSB0aGlzLmIyTGluZUpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkxpbmVKb2ludERlZiA9IGIyTGluZUpvaW50RGVmO1xyXG5cclxuICAgZnVuY3Rpb24gYjJNb3VzZUpvaW50KCkge1xyXG4gICAgICBiMk1vdXNlSm9pbnQuYjJNb3VzZUpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMk1vdXNlSm9pbnQpIHRoaXMuYjJNb3VzZUpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMk1vdXNlSm9pbnQgPSBiMk1vdXNlSm9pbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMk1vdXNlSm9pbnREZWYoKSB7XHJcbiAgICAgIGIyTW91c2VKb2ludERlZi5iMk1vdXNlSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyTW91c2VKb2ludERlZikgdGhpcy5iMk1vdXNlSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyTW91c2VKb2ludERlZiA9IGIyTW91c2VKb2ludERlZjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUHJpc21hdGljSm9pbnQoKSB7XHJcbiAgICAgIGIyUHJpc21hdGljSm9pbnQuYjJQcmlzbWF0aWNKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJQcmlzbWF0aWNKb2ludCkgdGhpcy5iMlByaXNtYXRpY0pvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlByaXNtYXRpY0pvaW50ID0gYjJQcmlzbWF0aWNKb2ludDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUHJpc21hdGljSm9pbnREZWYoKSB7XHJcbiAgICAgIGIyUHJpc21hdGljSm9pbnREZWYuYjJQcmlzbWF0aWNKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJQcmlzbWF0aWNKb2ludERlZikgdGhpcy5iMlByaXNtYXRpY0pvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlByaXNtYXRpY0pvaW50RGVmID0gYjJQcmlzbWF0aWNKb2ludERlZjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUHVsbGV5Sm9pbnQoKSB7XHJcbiAgICAgIGIyUHVsbGV5Sm9pbnQuYjJQdWxsZXlKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJQdWxsZXlKb2ludCkgdGhpcy5iMlB1bGxleUpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlB1bGxleUpvaW50ID0gYjJQdWxsZXlKb2ludDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUHVsbGV5Sm9pbnREZWYoKSB7XHJcbiAgICAgIGIyUHVsbGV5Sm9pbnREZWYuYjJQdWxsZXlKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJQdWxsZXlKb2ludERlZikgdGhpcy5iMlB1bGxleUpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlB1bGxleUpvaW50RGVmID0gYjJQdWxsZXlKb2ludERlZjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUmV2b2x1dGVKb2ludCgpIHtcclxuICAgICAgYjJSZXZvbHV0ZUpvaW50LmIyUmV2b2x1dGVKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJSZXZvbHV0ZUpvaW50KSB0aGlzLmIyUmV2b2x1dGVKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJSZXZvbHV0ZUpvaW50ID0gYjJSZXZvbHV0ZUpvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJSZXZvbHV0ZUpvaW50RGVmKCkge1xyXG4gICAgICBiMlJldm9sdXRlSm9pbnREZWYuYjJSZXZvbHV0ZUpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlJldm9sdXRlSm9pbnREZWYpIHRoaXMuYjJSZXZvbHV0ZUpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlJldm9sdXRlSm9pbnREZWYgPSBiMlJldm9sdXRlSm9pbnREZWY7XHJcblxyXG4gICBmdW5jdGlvbiBiMldlbGRKb2ludCgpIHtcclxuICAgICAgYjJXZWxkSm9pbnQuYjJXZWxkSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyV2VsZEpvaW50KSB0aGlzLmIyV2VsZEpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMldlbGRKb2ludCA9IGIyV2VsZEpvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJXZWxkSm9pbnREZWYoKSB7XHJcbiAgICAgIGIyV2VsZEpvaW50RGVmLmIyV2VsZEpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMldlbGRKb2ludERlZikgdGhpcy5iMldlbGRKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJXZWxkSm9pbnREZWYgPSBiMldlbGRKb2ludERlZjtcclxufSkoKTsgLy9kZWZpbml0aW9uc1xyXG5Cb3gyRC5wb3N0RGVmcyA9IFtdO1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYjJDaXJjbGVTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZSxcclxuICAgICAgYjJFZGdlQ2hhaW5EZWYgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZUNoYWluRGVmLFxyXG4gICAgICBiMkVkZ2VTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlU2hhcGUsXHJcbiAgICAgIGIyTWFzc0RhdGEgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyTWFzc0RhdGEsXHJcbiAgICAgIGIyUG9seWdvblNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlBvbHlnb25TaGFwZSxcclxuICAgICAgYjJTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSxcclxuICAgICAgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxyXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXHJcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcclxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXHJcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxyXG4gICAgICBiMk1hdGggPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGgsXHJcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxyXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxyXG4gICAgICBiMlZlYzIgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIsXHJcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyxcclxuICAgICAgYjJBQUJCID0gQm94MkQuQ29sbGlzaW9uLmIyQUFCQixcclxuICAgICAgYjJCb3VuZCA9IEJveDJELkNvbGxpc2lvbi5iMkJvdW5kLFxyXG4gICAgICBiMkJvdW5kVmFsdWVzID0gQm94MkQuQ29sbGlzaW9uLmIyQm91bmRWYWx1ZXMsXHJcbiAgICAgIGIyQ29sbGlzaW9uID0gQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLFxyXG4gICAgICBiMkNvbnRhY3RJRCA9IEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RJRCxcclxuICAgICAgYjJDb250YWN0UG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0UG9pbnQsXHJcbiAgICAgIGIyRGlzdGFuY2UgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZSxcclxuICAgICAgYjJEaXN0YW5jZUlucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VJbnB1dCxcclxuICAgICAgYjJEaXN0YW5jZU91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlT3V0cHV0LFxyXG4gICAgICBiMkRpc3RhbmNlUHJveHkgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZVByb3h5LFxyXG4gICAgICBiMkR5bmFtaWNUcmVlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWUsXHJcbiAgICAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLFxyXG4gICAgICBiMkR5bmFtaWNUcmVlTm9kZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlTm9kZSxcclxuICAgICAgYjJEeW5hbWljVHJlZVBhaXIgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZVBhaXIsXHJcbiAgICAgIGIyTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZCxcclxuICAgICAgYjJNYW5pZm9sZFBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGRQb2ludCxcclxuICAgICAgYjJQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMlBvaW50LFxyXG4gICAgICBiMlJheUNhc3RJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RJbnB1dCxcclxuICAgICAgYjJSYXlDYXN0T3V0cHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdE91dHB1dCxcclxuICAgICAgYjJTZWdtZW50ID0gQm94MkQuQ29sbGlzaW9uLmIyU2VnbWVudCxcclxuICAgICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24gPSBCb3gyRC5Db2xsaXNpb24uYjJTZXBhcmF0aW9uRnVuY3Rpb24sXHJcbiAgICAgIGIyU2ltcGxleCA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXgsXHJcbiAgICAgIGIyU2ltcGxleENhY2hlID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleENhY2hlLFxyXG4gICAgICBiMlNpbXBsZXhWZXJ0ZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4VmVydGV4LFxyXG4gICAgICBiMlRpbWVPZkltcGFjdCA9IEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdCxcclxuICAgICAgYjJUT0lJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlRPSUlucHV0LFxyXG4gICAgICBiMldvcmxkTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJXb3JsZE1hbmlmb2xkLFxyXG4gICAgICBDbGlwVmVydGV4ID0gQm94MkQuQ29sbGlzaW9uLkNsaXBWZXJ0ZXgsXHJcbiAgICAgIEZlYXR1cmVzID0gQm94MkQuQ29sbGlzaW9uLkZlYXR1cmVzLFxyXG4gICAgICBJQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5JQnJvYWRQaGFzZTtcclxuXHJcbiAgIGIyQUFCQi5iMkFBQkIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubG93ZXJCb3VuZCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy51cHBlckJvdW5kID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkFBQkIucHJvdG90eXBlLklzVmFsaWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBkWCA9IHRoaXMudXBwZXJCb3VuZC54IC0gdGhpcy5sb3dlckJvdW5kLng7XHJcbiAgICAgIHZhciBkWSA9IHRoaXMudXBwZXJCb3VuZC55IC0gdGhpcy5sb3dlckJvdW5kLnk7XHJcbiAgICAgIHZhciB2YWxpZCA9IGRYID49IDAuMCAmJiBkWSA+PSAwLjA7XHJcbiAgICAgIHZhbGlkID0gdmFsaWQgJiYgdGhpcy5sb3dlckJvdW5kLklzVmFsaWQoKSAmJiB0aGlzLnVwcGVyQm91bmQuSXNWYWxpZCgpO1xyXG4gICAgICByZXR1cm4gdmFsaWQ7XHJcbiAgIH1cclxuICAgYjJBQUJCLnByb3RvdHlwZS5HZXRDZW50ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKCh0aGlzLmxvd2VyQm91bmQueCArIHRoaXMudXBwZXJCb3VuZC54KSAvIDIsICh0aGlzLmxvd2VyQm91bmQueSArIHRoaXMudXBwZXJCb3VuZC55KSAvIDIpO1xyXG4gICB9XHJcbiAgIGIyQUFCQi5wcm90b3R5cGUuR2V0RXh0ZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoKHRoaXMudXBwZXJCb3VuZC54IC0gdGhpcy5sb3dlckJvdW5kLngpIC8gMiwgKHRoaXMudXBwZXJCb3VuZC55IC0gdGhpcy5sb3dlckJvdW5kLnkpIC8gMik7XHJcbiAgIH1cclxuICAgYjJBQUJCLnByb3RvdHlwZS5Db250YWlucyA9IGZ1bmN0aW9uIChhYWJiKSB7XHJcbiAgICAgIHZhciByZXN1bHQgPSB0cnVlO1xyXG4gICAgICByZXN1bHQgPSByZXN1bHQgJiYgdGhpcy5sb3dlckJvdW5kLnggPD0gYWFiYi5sb3dlckJvdW5kLng7XHJcbiAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiB0aGlzLmxvd2VyQm91bmQueSA8PSBhYWJiLmxvd2VyQm91bmQueTtcclxuICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIGFhYmIudXBwZXJCb3VuZC54IDw9IHRoaXMudXBwZXJCb3VuZC54O1xyXG4gICAgICByZXN1bHQgPSByZXN1bHQgJiYgYWFiYi51cHBlckJvdW5kLnkgPD0gdGhpcy51cHBlckJvdW5kLnk7XHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgIH1cclxuICAgYjJBQUJCLnByb3RvdHlwZS5SYXlDYXN0ID0gZnVuY3Rpb24gKG91dHB1dCwgaW5wdXQpIHtcclxuICAgICAgdmFyIHRtaW4gPSAoLU51bWJlci5NQVhfVkFMVUUpO1xyXG4gICAgICB2YXIgdG1heCA9IE51bWJlci5NQVhfVkFMVUU7XHJcbiAgICAgIHZhciBwWCA9IGlucHV0LnAxLng7XHJcbiAgICAgIHZhciBwWSA9IGlucHV0LnAxLnk7XHJcbiAgICAgIHZhciBkWCA9IGlucHV0LnAyLnggLSBpbnB1dC5wMS54O1xyXG4gICAgICB2YXIgZFkgPSBpbnB1dC5wMi55IC0gaW5wdXQucDEueTtcclxuICAgICAgdmFyIGFic0RYID0gTWF0aC5hYnMoZFgpO1xyXG4gICAgICB2YXIgYWJzRFkgPSBNYXRoLmFicyhkWSk7XHJcbiAgICAgIHZhciBub3JtYWwgPSBvdXRwdXQubm9ybWFsO1xyXG4gICAgICB2YXIgaW52X2QgPSAwO1xyXG4gICAgICB2YXIgdDEgPSAwO1xyXG4gICAgICB2YXIgdDIgPSAwO1xyXG4gICAgICB2YXIgdDMgPSAwO1xyXG4gICAgICB2YXIgcyA9IDA7IHtcclxuICAgICAgICAgaWYgKGFic0RYIDwgTnVtYmVyLk1JTl9WQUxVRSkge1xyXG4gICAgICAgICAgICBpZiAocFggPCB0aGlzLmxvd2VyQm91bmQueCB8fCB0aGlzLnVwcGVyQm91bmQueCA8IHBYKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGludl9kID0gMS4wIC8gZFg7XHJcbiAgICAgICAgICAgIHQxID0gKHRoaXMubG93ZXJCb3VuZC54IC0gcFgpICogaW52X2Q7XHJcbiAgICAgICAgICAgIHQyID0gKHRoaXMudXBwZXJCb3VuZC54IC0gcFgpICogaW52X2Q7XHJcbiAgICAgICAgICAgIHMgPSAoLTEuMCk7XHJcbiAgICAgICAgICAgIGlmICh0MSA+IHQyKSB7XHJcbiAgICAgICAgICAgICAgIHQzID0gdDE7XHJcbiAgICAgICAgICAgICAgIHQxID0gdDI7XHJcbiAgICAgICAgICAgICAgIHQyID0gdDM7XHJcbiAgICAgICAgICAgICAgIHMgPSAxLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQxID4gdG1pbikge1xyXG4gICAgICAgICAgICAgICBub3JtYWwueCA9IHM7XHJcbiAgICAgICAgICAgICAgIG5vcm1hbC55ID0gMDtcclxuICAgICAgICAgICAgICAgdG1pbiA9IHQxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRtYXggPSBNYXRoLm1pbih0bWF4LCB0Mik7XHJcbiAgICAgICAgICAgIGlmICh0bWluID4gdG1heCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH0ge1xyXG4gICAgICAgICBpZiAoYWJzRFkgPCBOdW1iZXIuTUlOX1ZBTFVFKSB7XHJcbiAgICAgICAgICAgIGlmIChwWSA8IHRoaXMubG93ZXJCb3VuZC55IHx8IHRoaXMudXBwZXJCb3VuZC55IDwgcFkpIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaW52X2QgPSAxLjAgLyBkWTtcclxuICAgICAgICAgICAgdDEgPSAodGhpcy5sb3dlckJvdW5kLnkgLSBwWSkgKiBpbnZfZDtcclxuICAgICAgICAgICAgdDIgPSAodGhpcy51cHBlckJvdW5kLnkgLSBwWSkgKiBpbnZfZDtcclxuICAgICAgICAgICAgcyA9ICgtMS4wKTtcclxuICAgICAgICAgICAgaWYgKHQxID4gdDIpIHtcclxuICAgICAgICAgICAgICAgdDMgPSB0MTtcclxuICAgICAgICAgICAgICAgdDEgPSB0MjtcclxuICAgICAgICAgICAgICAgdDIgPSB0MztcclxuICAgICAgICAgICAgICAgcyA9IDEuMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodDEgPiB0bWluKSB7XHJcbiAgICAgICAgICAgICAgIG5vcm1hbC55ID0gcztcclxuICAgICAgICAgICAgICAgbm9ybWFsLnggPSAwO1xyXG4gICAgICAgICAgICAgICB0bWluID0gdDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdG1heCA9IE1hdGgubWluKHRtYXgsIHQyKTtcclxuICAgICAgICAgICAgaWYgKHRtaW4gPiB0bWF4KSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBvdXRwdXQuZnJhY3Rpb24gPSB0bWluO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgfVxyXG4gICBiMkFBQkIucHJvdG90eXBlLlRlc3RPdmVybGFwID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgIHZhciBkMVggPSBvdGhlci5sb3dlckJvdW5kLnggLSB0aGlzLnVwcGVyQm91bmQueDtcclxuICAgICAgdmFyIGQxWSA9IG90aGVyLmxvd2VyQm91bmQueSAtIHRoaXMudXBwZXJCb3VuZC55O1xyXG4gICAgICB2YXIgZDJYID0gdGhpcy5sb3dlckJvdW5kLnggLSBvdGhlci51cHBlckJvdW5kLng7XHJcbiAgICAgIHZhciBkMlkgPSB0aGlzLmxvd2VyQm91bmQueSAtIG90aGVyLnVwcGVyQm91bmQueTtcclxuICAgICAgaWYgKGQxWCA+IDAuMCB8fCBkMVkgPiAwLjApIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKGQyWCA+IDAuMCB8fCBkMlkgPiAwLjApIHJldHVybiBmYWxzZTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgYjJBQUJCLkNvbWJpbmUgPSBmdW5jdGlvbiAoYWFiYjEsIGFhYmIyKSB7XHJcbiAgICAgIHZhciBhYWJiID0gbmV3IGIyQUFCQigpO1xyXG4gICAgICBhYWJiLkNvbWJpbmUoYWFiYjEsIGFhYmIyKTtcclxuICAgICAgcmV0dXJuIGFhYmI7XHJcbiAgIH1cclxuICAgYjJBQUJCLnByb3RvdHlwZS5Db21iaW5lID0gZnVuY3Rpb24gKGFhYmIxLCBhYWJiMikge1xyXG4gICAgICB0aGlzLmxvd2VyQm91bmQueCA9IE1hdGgubWluKGFhYmIxLmxvd2VyQm91bmQueCwgYWFiYjIubG93ZXJCb3VuZC54KTtcclxuICAgICAgdGhpcy5sb3dlckJvdW5kLnkgPSBNYXRoLm1pbihhYWJiMS5sb3dlckJvdW5kLnksIGFhYmIyLmxvd2VyQm91bmQueSk7XHJcbiAgICAgIHRoaXMudXBwZXJCb3VuZC54ID0gTWF0aC5tYXgoYWFiYjEudXBwZXJCb3VuZC54LCBhYWJiMi51cHBlckJvdW5kLngpO1xyXG4gICAgICB0aGlzLnVwcGVyQm91bmQueSA9IE1hdGgubWF4KGFhYmIxLnVwcGVyQm91bmQueSwgYWFiYjIudXBwZXJCb3VuZC55KTtcclxuICAgfVxyXG4gICBiMkJvdW5kLmIyQm91bmQgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJCb3VuZC5wcm90b3R5cGUuSXNMb3dlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLnZhbHVlICYgMSkgPT0gMDtcclxuICAgfVxyXG4gICBiMkJvdW5kLnByb3RvdHlwZS5Jc1VwcGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gKHRoaXMudmFsdWUgJiAxKSA9PSAxO1xyXG4gICB9XHJcbiAgIGIyQm91bmQucHJvdG90eXBlLlN3YXAgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICB2YXIgdGVtcFZhbHVlID0gdGhpcy52YWx1ZTtcclxuICAgICAgdmFyIHRlbXBQcm94eSA9IHRoaXMucHJveHk7XHJcbiAgICAgIHZhciB0ZW1wU3RhYmJpbmdDb3VudCA9IHRoaXMuc3RhYmJpbmdDb3VudDtcclxuICAgICAgdGhpcy52YWx1ZSA9IGIudmFsdWU7XHJcbiAgICAgIHRoaXMucHJveHkgPSBiLnByb3h5O1xyXG4gICAgICB0aGlzLnN0YWJiaW5nQ291bnQgPSBiLnN0YWJiaW5nQ291bnQ7XHJcbiAgICAgIGIudmFsdWUgPSB0ZW1wVmFsdWU7XHJcbiAgICAgIGIucHJveHkgPSB0ZW1wUHJveHk7XHJcbiAgICAgIGIuc3RhYmJpbmdDb3VudCA9IHRlbXBTdGFiYmluZ0NvdW50O1xyXG4gICB9XHJcbiAgIGIyQm91bmRWYWx1ZXMuYjJCb3VuZFZhbHVlcyA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkJvdW5kVmFsdWVzLnByb3RvdHlwZS5iMkJvdW5kVmFsdWVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmxvd2VyVmFsdWVzID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKCk7XHJcbiAgICAgIHRoaXMubG93ZXJWYWx1ZXNbMF0gPSAwLjA7XHJcbiAgICAgIHRoaXMubG93ZXJWYWx1ZXNbMV0gPSAwLjA7XHJcbiAgICAgIHRoaXMudXBwZXJWYWx1ZXMgPSBuZXcgVmVjdG9yX2Eyal9OdW1iZXIoKTtcclxuICAgICAgdGhpcy51cHBlclZhbHVlc1swXSA9IDAuMDtcclxuICAgICAgdGhpcy51cHBlclZhbHVlc1sxXSA9IDAuMDtcclxuICAgfVxyXG4gICBiMkNvbGxpc2lvbi5iMkNvbGxpc2lvbiA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkNvbGxpc2lvbi5DbGlwU2VnbWVudFRvTGluZSA9IGZ1bmN0aW9uICh2T3V0LCB2SW4sIG5vcm1hbCwgb2Zmc2V0KSB7XHJcbiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDtcclxuICAgICAgdmFyIGN2O1xyXG4gICAgICB2YXIgbnVtT3V0ID0gMDtcclxuICAgICAgY3YgPSB2SW5bMF07XHJcbiAgICAgIHZhciB2SW4wID0gY3YudjtcclxuICAgICAgY3YgPSB2SW5bMV07XHJcbiAgICAgIHZhciB2SW4xID0gY3YudjtcclxuICAgICAgdmFyIGRpc3RhbmNlMCA9IG5vcm1hbC54ICogdkluMC54ICsgbm9ybWFsLnkgKiB2SW4wLnkgLSBvZmZzZXQ7XHJcbiAgICAgIHZhciBkaXN0YW5jZTEgPSBub3JtYWwueCAqIHZJbjEueCArIG5vcm1hbC55ICogdkluMS55IC0gb2Zmc2V0O1xyXG4gICAgICBpZiAoZGlzdGFuY2UwIDw9IDAuMCkgdk91dFtudW1PdXQrK10uU2V0KHZJblswXSk7XHJcbiAgICAgIGlmIChkaXN0YW5jZTEgPD0gMC4wKSB2T3V0W251bU91dCsrXS5TZXQodkluWzFdKTtcclxuICAgICAgaWYgKGRpc3RhbmNlMCAqIGRpc3RhbmNlMSA8IDAuMCkge1xyXG4gICAgICAgICB2YXIgaW50ZXJwID0gZGlzdGFuY2UwIC8gKGRpc3RhbmNlMCAtIGRpc3RhbmNlMSk7XHJcbiAgICAgICAgIGN2ID0gdk91dFtudW1PdXRdO1xyXG4gICAgICAgICB2YXIgdFZlYyA9IGN2LnY7XHJcbiAgICAgICAgIHRWZWMueCA9IHZJbjAueCArIGludGVycCAqICh2SW4xLnggLSB2SW4wLngpO1xyXG4gICAgICAgICB0VmVjLnkgPSB2SW4wLnkgKyBpbnRlcnAgKiAodkluMS55IC0gdkluMC55KTtcclxuICAgICAgICAgY3YgPSB2T3V0W251bU91dF07XHJcbiAgICAgICAgIHZhciBjdjI7XHJcbiAgICAgICAgIGlmIChkaXN0YW5jZTAgPiAwLjApIHtcclxuICAgICAgICAgICAgY3YyID0gdkluWzBdO1xyXG4gICAgICAgICAgICBjdi5pZCA9IGN2Mi5pZDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY3YyID0gdkluWzFdO1xyXG4gICAgICAgICAgICBjdi5pZCA9IGN2Mi5pZDtcclxuICAgICAgICAgfSsrbnVtT3V0O1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBudW1PdXQ7XHJcbiAgIH1cclxuICAgYjJDb2xsaXNpb24uRWRnZVNlcGFyYXRpb24gPSBmdW5jdGlvbiAocG9seTEsIHhmMSwgZWRnZTEsIHBvbHkyLCB4ZjIpIHtcclxuICAgICAgaWYgKGVkZ2UxID09PSB1bmRlZmluZWQpIGVkZ2UxID0gMDtcclxuICAgICAgdmFyIGNvdW50MSA9IHBhcnNlSW50KHBvbHkxLm1fdmVydGV4Q291bnQpO1xyXG4gICAgICB2YXIgdmVydGljZXMxID0gcG9seTEubV92ZXJ0aWNlcztcclxuICAgICAgdmFyIG5vcm1hbHMxID0gcG9seTEubV9ub3JtYWxzO1xyXG4gICAgICB2YXIgY291bnQyID0gcGFyc2VJbnQocG9seTIubV92ZXJ0ZXhDb3VudCk7XHJcbiAgICAgIHZhciB2ZXJ0aWNlczIgPSBwb2x5Mi5tX3ZlcnRpY2VzO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRWZWM7XHJcbiAgICAgIHRNYXQgPSB4ZjEuUjtcclxuICAgICAgdFZlYyA9IG5vcm1hbHMxW2VkZ2UxXTtcclxuICAgICAgdmFyIG5vcm1hbDFXb3JsZFggPSAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHZhciBub3JtYWwxV29ybGRZID0gKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB0TWF0ID0geGYyLlI7XHJcbiAgICAgIHZhciBub3JtYWwxWCA9ICh0TWF0LmNvbDEueCAqIG5vcm1hbDFXb3JsZFggKyB0TWF0LmNvbDEueSAqIG5vcm1hbDFXb3JsZFkpO1xyXG4gICAgICB2YXIgbm9ybWFsMVkgPSAodE1hdC5jb2wyLnggKiBub3JtYWwxV29ybGRYICsgdE1hdC5jb2wyLnkgKiBub3JtYWwxV29ybGRZKTtcclxuICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgdmFyIG1pbkRvdCA9IE51bWJlci5NQVhfVkFMVUU7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQyOyArK2kpIHtcclxuICAgICAgICAgdFZlYyA9IHZlcnRpY2VzMltpXTtcclxuICAgICAgICAgdmFyIGRvdCA9IHRWZWMueCAqIG5vcm1hbDFYICsgdFZlYy55ICogbm9ybWFsMVk7XHJcbiAgICAgICAgIGlmIChkb3QgPCBtaW5Eb3QpIHtcclxuICAgICAgICAgICAgbWluRG90ID0gZG90O1xyXG4gICAgICAgICAgICBpbmRleCA9IGk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0VmVjID0gdmVydGljZXMxW2VkZ2UxXTtcclxuICAgICAgdE1hdCA9IHhmMS5SO1xyXG4gICAgICB2YXIgdjFYID0geGYxLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHZhciB2MVkgPSB4ZjEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgdFZlYyA9IHZlcnRpY2VzMltpbmRleF07XHJcbiAgICAgIHRNYXQgPSB4ZjIuUjtcclxuICAgICAgdmFyIHYyWCA9IHhmMi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB2YXIgdjJZID0geGYyLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHYyWCAtPSB2MVg7XHJcbiAgICAgIHYyWSAtPSB2MVk7XHJcbiAgICAgIHZhciBzZXBhcmF0aW9uID0gdjJYICogbm9ybWFsMVdvcmxkWCArIHYyWSAqIG5vcm1hbDFXb3JsZFk7XHJcbiAgICAgIHJldHVybiBzZXBhcmF0aW9uO1xyXG4gICB9XHJcbiAgIGIyQ29sbGlzaW9uLkZpbmRNYXhTZXBhcmF0aW9uID0gZnVuY3Rpb24gKGVkZ2VJbmRleCwgcG9seTEsIHhmMSwgcG9seTIsIHhmMikge1xyXG4gICAgICB2YXIgY291bnQxID0gcGFyc2VJbnQocG9seTEubV92ZXJ0ZXhDb3VudCk7XHJcbiAgICAgIHZhciBub3JtYWxzMSA9IHBvbHkxLm1fbm9ybWFscztcclxuICAgICAgdmFyIHRWZWM7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB0TWF0ID0geGYyLlI7XHJcbiAgICAgIHRWZWMgPSBwb2x5Mi5tX2NlbnRyb2lkO1xyXG4gICAgICB2YXIgZFggPSB4ZjIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgdmFyIGRZID0geGYyLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHRNYXQgPSB4ZjEuUjtcclxuICAgICAgdFZlYyA9IHBvbHkxLm1fY2VudHJvaWQ7XHJcbiAgICAgIGRYIC09IHhmMS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICBkWSAtPSB4ZjEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgdmFyIGRMb2NhbDFYID0gKGRYICogeGYxLlIuY29sMS54ICsgZFkgKiB4ZjEuUi5jb2wxLnkpO1xyXG4gICAgICB2YXIgZExvY2FsMVkgPSAoZFggKiB4ZjEuUi5jb2wyLnggKyBkWSAqIHhmMS5SLmNvbDIueSk7XHJcbiAgICAgIHZhciBlZGdlID0gMDtcclxuICAgICAgdmFyIG1heERvdCA9ICgtTnVtYmVyLk1BWF9WQUxVRSk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQxOyArK2kpIHtcclxuICAgICAgICAgdFZlYyA9IG5vcm1hbHMxW2ldO1xyXG4gICAgICAgICB2YXIgZG90ID0gKHRWZWMueCAqIGRMb2NhbDFYICsgdFZlYy55ICogZExvY2FsMVkpO1xyXG4gICAgICAgICBpZiAoZG90ID4gbWF4RG90KSB7XHJcbiAgICAgICAgICAgIG1heERvdCA9IGRvdDtcclxuICAgICAgICAgICAgZWRnZSA9IGk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB2YXIgcyA9IGIyQ29sbGlzaW9uLkVkZ2VTZXBhcmF0aW9uKHBvbHkxLCB4ZjEsIGVkZ2UsIHBvbHkyLCB4ZjIpO1xyXG4gICAgICB2YXIgcHJldkVkZ2UgPSBwYXJzZUludChlZGdlIC0gMSA+PSAwID8gZWRnZSAtIDEgOiBjb3VudDEgLSAxKTtcclxuICAgICAgdmFyIHNQcmV2ID0gYjJDb2xsaXNpb24uRWRnZVNlcGFyYXRpb24ocG9seTEsIHhmMSwgcHJldkVkZ2UsIHBvbHkyLCB4ZjIpO1xyXG4gICAgICB2YXIgbmV4dEVkZ2UgPSBwYXJzZUludChlZGdlICsgMSA8IGNvdW50MSA/IGVkZ2UgKyAxIDogMCk7XHJcbiAgICAgIHZhciBzTmV4dCA9IGIyQ29sbGlzaW9uLkVkZ2VTZXBhcmF0aW9uKHBvbHkxLCB4ZjEsIG5leHRFZGdlLCBwb2x5MiwgeGYyKTtcclxuICAgICAgdmFyIGJlc3RFZGdlID0gMDtcclxuICAgICAgdmFyIGJlc3RTZXBhcmF0aW9uID0gMDtcclxuICAgICAgdmFyIGluY3JlbWVudCA9IDA7XHJcbiAgICAgIGlmIChzUHJldiA+IHMgJiYgc1ByZXYgPiBzTmV4dCkge1xyXG4gICAgICAgICBpbmNyZW1lbnQgPSAoLTEpO1xyXG4gICAgICAgICBiZXN0RWRnZSA9IHByZXZFZGdlO1xyXG4gICAgICAgICBiZXN0U2VwYXJhdGlvbiA9IHNQcmV2O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKHNOZXh0ID4gcykge1xyXG4gICAgICAgICBpbmNyZW1lbnQgPSAxO1xyXG4gICAgICAgICBiZXN0RWRnZSA9IG5leHRFZGdlO1xyXG4gICAgICAgICBiZXN0U2VwYXJhdGlvbiA9IHNOZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBlZGdlSW5kZXhbMF0gPSBlZGdlO1xyXG4gICAgICAgICByZXR1cm4gcztcclxuICAgICAgfVxyXG4gICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICBpZiAoaW5jcmVtZW50ID09ICgtMSkpIGVkZ2UgPSBiZXN0RWRnZSAtIDEgPj0gMCA/IGJlc3RFZGdlIC0gMSA6IGNvdW50MSAtIDE7XHJcbiAgICAgICAgIGVsc2UgZWRnZSA9IGJlc3RFZGdlICsgMSA8IGNvdW50MSA/IGJlc3RFZGdlICsgMSA6IDA7cyA9IGIyQ29sbGlzaW9uLkVkZ2VTZXBhcmF0aW9uKHBvbHkxLCB4ZjEsIGVkZ2UsIHBvbHkyLCB4ZjIpO1xyXG4gICAgICAgICBpZiAocyA+IGJlc3RTZXBhcmF0aW9uKSB7XHJcbiAgICAgICAgICAgIGJlc3RFZGdlID0gZWRnZTtcclxuICAgICAgICAgICAgYmVzdFNlcGFyYXRpb24gPSBzO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVkZ2VJbmRleFswXSA9IGJlc3RFZGdlO1xyXG4gICAgICByZXR1cm4gYmVzdFNlcGFyYXRpb247XHJcbiAgIH1cclxuICAgYjJDb2xsaXNpb24uRmluZEluY2lkZW50RWRnZSA9IGZ1bmN0aW9uIChjLCBwb2x5MSwgeGYxLCBlZGdlMSwgcG9seTIsIHhmMikge1xyXG4gICAgICBpZiAoZWRnZTEgPT09IHVuZGVmaW5lZCkgZWRnZTEgPSAwO1xyXG4gICAgICB2YXIgY291bnQxID0gcGFyc2VJbnQocG9seTEubV92ZXJ0ZXhDb3VudCk7XHJcbiAgICAgIHZhciBub3JtYWxzMSA9IHBvbHkxLm1fbm9ybWFscztcclxuICAgICAgdmFyIGNvdW50MiA9IHBhcnNlSW50KHBvbHkyLm1fdmVydGV4Q291bnQpO1xyXG4gICAgICB2YXIgdmVydGljZXMyID0gcG9seTIubV92ZXJ0aWNlcztcclxuICAgICAgdmFyIG5vcm1hbHMyID0gcG9seTIubV9ub3JtYWxzO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRWZWM7XHJcbiAgICAgIHRNYXQgPSB4ZjEuUjtcclxuICAgICAgdFZlYyA9IG5vcm1hbHMxW2VkZ2UxXTtcclxuICAgICAgdmFyIG5vcm1hbDFYID0gKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB2YXIgbm9ybWFsMVkgPSAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHRNYXQgPSB4ZjIuUjtcclxuICAgICAgdmFyIHRYID0gKHRNYXQuY29sMS54ICogbm9ybWFsMVggKyB0TWF0LmNvbDEueSAqIG5vcm1hbDFZKTtcclxuICAgICAgbm9ybWFsMVkgPSAodE1hdC5jb2wyLnggKiBub3JtYWwxWCArIHRNYXQuY29sMi55ICogbm9ybWFsMVkpO1xyXG4gICAgICBub3JtYWwxWCA9IHRYO1xyXG4gICAgICB2YXIgaW5kZXggPSAwO1xyXG4gICAgICB2YXIgbWluRG90ID0gTnVtYmVyLk1BWF9WQUxVRTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDI7ICsraSkge1xyXG4gICAgICAgICB0VmVjID0gbm9ybWFsczJbaV07XHJcbiAgICAgICAgIHZhciBkb3QgPSAobm9ybWFsMVggKiB0VmVjLnggKyBub3JtYWwxWSAqIHRWZWMueSk7XHJcbiAgICAgICAgIGlmIChkb3QgPCBtaW5Eb3QpIHtcclxuICAgICAgICAgICAgbWluRG90ID0gZG90O1xyXG4gICAgICAgICAgICBpbmRleCA9IGk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB2YXIgdENsaXA7XHJcbiAgICAgIHZhciBpMSA9IHBhcnNlSW50KGluZGV4KTtcclxuICAgICAgdmFyIGkyID0gcGFyc2VJbnQoaTEgKyAxIDwgY291bnQyID8gaTEgKyAxIDogMCk7XHJcbiAgICAgIHRDbGlwID0gY1swXTtcclxuICAgICAgdFZlYyA9IHZlcnRpY2VzMltpMV07XHJcbiAgICAgIHRNYXQgPSB4ZjIuUjtcclxuICAgICAgdENsaXAudi54ID0geGYyLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHRDbGlwLnYueSA9IHhmMi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB0Q2xpcC5pZC5mZWF0dXJlcy5yZWZlcmVuY2VFZGdlID0gZWRnZTE7XHJcbiAgICAgIHRDbGlwLmlkLmZlYXR1cmVzLmluY2lkZW50RWRnZSA9IGkxO1xyXG4gICAgICB0Q2xpcC5pZC5mZWF0dXJlcy5pbmNpZGVudFZlcnRleCA9IDA7XHJcbiAgICAgIHRDbGlwID0gY1sxXTtcclxuICAgICAgdFZlYyA9IHZlcnRpY2VzMltpMl07XHJcbiAgICAgIHRNYXQgPSB4ZjIuUjtcclxuICAgICAgdENsaXAudi54ID0geGYyLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHRDbGlwLnYueSA9IHhmMi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB0Q2xpcC5pZC5mZWF0dXJlcy5yZWZlcmVuY2VFZGdlID0gZWRnZTE7XHJcbiAgICAgIHRDbGlwLmlkLmZlYXR1cmVzLmluY2lkZW50RWRnZSA9IGkyO1xyXG4gICAgICB0Q2xpcC5pZC5mZWF0dXJlcy5pbmNpZGVudFZlcnRleCA9IDE7XHJcbiAgIH1cclxuICAgYjJDb2xsaXNpb24uTWFrZUNsaXBQb2ludFZlY3RvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHIgPSBuZXcgVmVjdG9yKDIpO1xyXG4gICAgICByWzBdID0gbmV3IENsaXBWZXJ0ZXgoKTtcclxuICAgICAgclsxXSA9IG5ldyBDbGlwVmVydGV4KCk7XHJcbiAgICAgIHJldHVybiByO1xyXG4gICB9XHJcbiAgIGIyQ29sbGlzaW9uLkNvbGxpZGVQb2x5Z29ucyA9IGZ1bmN0aW9uIChtYW5pZm9sZCwgcG9seUEsIHhmQSwgcG9seUIsIHhmQikge1xyXG4gICAgICB2YXIgY3Y7XHJcbiAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDA7XHJcbiAgICAgIHZhciB0b3RhbFJhZGl1cyA9IHBvbHlBLm1fcmFkaXVzICsgcG9seUIubV9yYWRpdXM7XHJcbiAgICAgIHZhciBlZGdlQSA9IDA7XHJcbiAgICAgIGIyQ29sbGlzaW9uLnNfZWRnZUFPWzBdID0gZWRnZUE7XHJcbiAgICAgIHZhciBzZXBhcmF0aW9uQSA9IGIyQ29sbGlzaW9uLkZpbmRNYXhTZXBhcmF0aW9uKGIyQ29sbGlzaW9uLnNfZWRnZUFPLCBwb2x5QSwgeGZBLCBwb2x5QiwgeGZCKTtcclxuICAgICAgZWRnZUEgPSBiMkNvbGxpc2lvbi5zX2VkZ2VBT1swXTtcclxuICAgICAgaWYgKHNlcGFyYXRpb25BID4gdG90YWxSYWRpdXMpIHJldHVybjtcclxuICAgICAgdmFyIGVkZ2VCID0gMDtcclxuICAgICAgYjJDb2xsaXNpb24uc19lZGdlQk9bMF0gPSBlZGdlQjtcclxuICAgICAgdmFyIHNlcGFyYXRpb25CID0gYjJDb2xsaXNpb24uRmluZE1heFNlcGFyYXRpb24oYjJDb2xsaXNpb24uc19lZGdlQk8sIHBvbHlCLCB4ZkIsIHBvbHlBLCB4ZkEpO1xyXG4gICAgICBlZGdlQiA9IGIyQ29sbGlzaW9uLnNfZWRnZUJPWzBdO1xyXG4gICAgICBpZiAoc2VwYXJhdGlvbkIgPiB0b3RhbFJhZGl1cykgcmV0dXJuO1xyXG4gICAgICB2YXIgcG9seTE7XHJcbiAgICAgIHZhciBwb2x5MjtcclxuICAgICAgdmFyIHhmMTtcclxuICAgICAgdmFyIHhmMjtcclxuICAgICAgdmFyIGVkZ2UxID0gMDtcclxuICAgICAgdmFyIGZsaXAgPSAwO1xyXG4gICAgICB2YXIga19yZWxhdGl2ZVRvbCA9IDAuOTg7XHJcbiAgICAgIHZhciBrX2Fic29sdXRlVG9sID0gMC4wMDE7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICBpZiAoc2VwYXJhdGlvbkIgPiBrX3JlbGF0aXZlVG9sICogc2VwYXJhdGlvbkEgKyBrX2Fic29sdXRlVG9sKSB7XHJcbiAgICAgICAgIHBvbHkxID0gcG9seUI7XHJcbiAgICAgICAgIHBvbHkyID0gcG9seUE7XHJcbiAgICAgICAgIHhmMSA9IHhmQjtcclxuICAgICAgICAgeGYyID0geGZBO1xyXG4gICAgICAgICBlZGdlMSA9IGVkZ2VCO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX3R5cGUgPSBiMk1hbmlmb2xkLmVfZmFjZUI7XHJcbiAgICAgICAgIGZsaXAgPSAxO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBwb2x5MSA9IHBvbHlBO1xyXG4gICAgICAgICBwb2x5MiA9IHBvbHlCO1xyXG4gICAgICAgICB4ZjEgPSB4ZkE7XHJcbiAgICAgICAgIHhmMiA9IHhmQjtcclxuICAgICAgICAgZWRnZTEgPSBlZGdlQTtcclxuICAgICAgICAgbWFuaWZvbGQubV90eXBlID0gYjJNYW5pZm9sZC5lX2ZhY2VBO1xyXG4gICAgICAgICBmbGlwID0gMDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgaW5jaWRlbnRFZGdlID0gYjJDb2xsaXNpb24uc19pbmNpZGVudEVkZ2U7XHJcbiAgICAgIGIyQ29sbGlzaW9uLkZpbmRJbmNpZGVudEVkZ2UoaW5jaWRlbnRFZGdlLCBwb2x5MSwgeGYxLCBlZGdlMSwgcG9seTIsIHhmMik7XHJcbiAgICAgIHZhciBjb3VudDEgPSBwYXJzZUludChwb2x5MS5tX3ZlcnRleENvdW50KTtcclxuICAgICAgdmFyIHZlcnRpY2VzMSA9IHBvbHkxLm1fdmVydGljZXM7XHJcbiAgICAgIHZhciBsb2NhbF92MTEgPSB2ZXJ0aWNlczFbZWRnZTFdO1xyXG4gICAgICB2YXIgbG9jYWxfdjEyO1xyXG4gICAgICBpZiAoZWRnZTEgKyAxIDwgY291bnQxKSB7XHJcbiAgICAgICAgIGxvY2FsX3YxMiA9IHZlcnRpY2VzMVtwYXJzZUludChlZGdlMSArIDEpXTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgbG9jYWxfdjEyID0gdmVydGljZXMxWzBdO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBsb2NhbFRhbmdlbnQgPSBiMkNvbGxpc2lvbi5zX2xvY2FsVGFuZ2VudDtcclxuICAgICAgbG9jYWxUYW5nZW50LlNldChsb2NhbF92MTIueCAtIGxvY2FsX3YxMS54LCBsb2NhbF92MTIueSAtIGxvY2FsX3YxMS55KTtcclxuICAgICAgbG9jYWxUYW5nZW50Lk5vcm1hbGl6ZSgpO1xyXG4gICAgICB2YXIgbG9jYWxOb3JtYWwgPSBiMkNvbGxpc2lvbi5zX2xvY2FsTm9ybWFsO1xyXG4gICAgICBsb2NhbE5vcm1hbC54ID0gbG9jYWxUYW5nZW50Lnk7XHJcbiAgICAgIGxvY2FsTm9ybWFsLnkgPSAoLWxvY2FsVGFuZ2VudC54KTtcclxuICAgICAgdmFyIHBsYW5lUG9pbnQgPSBiMkNvbGxpc2lvbi5zX3BsYW5lUG9pbnQ7XHJcbiAgICAgIHBsYW5lUG9pbnQuU2V0KDAuNSAqIChsb2NhbF92MTEueCArIGxvY2FsX3YxMi54KSwgMC41ICogKGxvY2FsX3YxMS55ICsgbG9jYWxfdjEyLnkpKTtcclxuICAgICAgdmFyIHRhbmdlbnQgPSBiMkNvbGxpc2lvbi5zX3RhbmdlbnQ7XHJcbiAgICAgIHRNYXQgPSB4ZjEuUjtcclxuICAgICAgdGFuZ2VudC54ID0gKHRNYXQuY29sMS54ICogbG9jYWxUYW5nZW50LnggKyB0TWF0LmNvbDIueCAqIGxvY2FsVGFuZ2VudC55KTtcclxuICAgICAgdGFuZ2VudC55ID0gKHRNYXQuY29sMS55ICogbG9jYWxUYW5nZW50LnggKyB0TWF0LmNvbDIueSAqIGxvY2FsVGFuZ2VudC55KTtcclxuICAgICAgdmFyIHRhbmdlbnQyID0gYjJDb2xsaXNpb24uc190YW5nZW50MjtcclxuICAgICAgdGFuZ2VudDIueCA9ICgtdGFuZ2VudC54KTtcclxuICAgICAgdGFuZ2VudDIueSA9ICgtdGFuZ2VudC55KTtcclxuICAgICAgdmFyIG5vcm1hbCA9IGIyQ29sbGlzaW9uLnNfbm9ybWFsO1xyXG4gICAgICBub3JtYWwueCA9IHRhbmdlbnQueTtcclxuICAgICAgbm9ybWFsLnkgPSAoLXRhbmdlbnQueCk7XHJcbiAgICAgIHZhciB2MTEgPSBiMkNvbGxpc2lvbi5zX3YxMTtcclxuICAgICAgdmFyIHYxMiA9IGIyQ29sbGlzaW9uLnNfdjEyO1xyXG4gICAgICB2MTEueCA9IHhmMS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogbG9jYWxfdjExLnggKyB0TWF0LmNvbDIueCAqIGxvY2FsX3YxMS55KTtcclxuICAgICAgdjExLnkgPSB4ZjEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIGxvY2FsX3YxMS54ICsgdE1hdC5jb2wyLnkgKiBsb2NhbF92MTEueSk7XHJcbiAgICAgIHYxMi54ID0geGYxLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiBsb2NhbF92MTIueCArIHRNYXQuY29sMi54ICogbG9jYWxfdjEyLnkpO1xyXG4gICAgICB2MTIueSA9IHhmMS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogbG9jYWxfdjEyLnggKyB0TWF0LmNvbDIueSAqIGxvY2FsX3YxMi55KTtcclxuICAgICAgdmFyIGZyb250T2Zmc2V0ID0gbm9ybWFsLnggKiB2MTEueCArIG5vcm1hbC55ICogdjExLnk7XHJcbiAgICAgIHZhciBzaWRlT2Zmc2V0MSA9ICgtdGFuZ2VudC54ICogdjExLngpIC0gdGFuZ2VudC55ICogdjExLnkgKyB0b3RhbFJhZGl1cztcclxuICAgICAgdmFyIHNpZGVPZmZzZXQyID0gdGFuZ2VudC54ICogdjEyLnggKyB0YW5nZW50LnkgKiB2MTIueSArIHRvdGFsUmFkaXVzO1xyXG4gICAgICB2YXIgY2xpcFBvaW50czEgPSBiMkNvbGxpc2lvbi5zX2NsaXBQb2ludHMxO1xyXG4gICAgICB2YXIgY2xpcFBvaW50czIgPSBiMkNvbGxpc2lvbi5zX2NsaXBQb2ludHMyO1xyXG4gICAgICB2YXIgbnAgPSAwO1xyXG4gICAgICBucCA9IGIyQ29sbGlzaW9uLkNsaXBTZWdtZW50VG9MaW5lKGNsaXBQb2ludHMxLCBpbmNpZGVudEVkZ2UsIHRhbmdlbnQyLCBzaWRlT2Zmc2V0MSk7XHJcbiAgICAgIGlmIChucCA8IDIpIHJldHVybjtcclxuICAgICAgbnAgPSBiMkNvbGxpc2lvbi5DbGlwU2VnbWVudFRvTGluZShjbGlwUG9pbnRzMiwgY2xpcFBvaW50czEsIHRhbmdlbnQsIHNpZGVPZmZzZXQyKTtcclxuICAgICAgaWYgKG5wIDwgMikgcmV0dXJuO1xyXG4gICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwuU2V0Vihsb2NhbE5vcm1hbCk7XHJcbiAgICAgIG1hbmlmb2xkLm1fbG9jYWxQb2ludC5TZXRWKHBsYW5lUG9pbnQpO1xyXG4gICAgICB2YXIgcG9pbnRDb3VudCA9IDA7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50czsgKytpKSB7XHJcbiAgICAgICAgIGN2ID0gY2xpcFBvaW50czJbaV07XHJcbiAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gbm9ybWFsLnggKiBjdi52LnggKyBub3JtYWwueSAqIGN2LnYueSAtIGZyb250T2Zmc2V0O1xyXG4gICAgICAgICBpZiAoc2VwYXJhdGlvbiA8PSB0b3RhbFJhZGl1cykge1xyXG4gICAgICAgICAgICB2YXIgY3AgPSBtYW5pZm9sZC5tX3BvaW50c1twb2ludENvdW50XTtcclxuICAgICAgICAgICAgdE1hdCA9IHhmMi5SO1xyXG4gICAgICAgICAgICB2YXIgdFggPSBjdi52LnggLSB4ZjIucG9zaXRpb24ueDtcclxuICAgICAgICAgICAgdmFyIHRZID0gY3Yudi55IC0geGYyLnBvc2l0aW9uLnk7XHJcbiAgICAgICAgICAgIGNwLm1fbG9jYWxQb2ludC54ID0gKHRYICogdE1hdC5jb2wxLnggKyB0WSAqIHRNYXQuY29sMS55KTtcclxuICAgICAgICAgICAgY3AubV9sb2NhbFBvaW50LnkgPSAodFggKiB0TWF0LmNvbDIueCArIHRZICogdE1hdC5jb2wyLnkpO1xyXG4gICAgICAgICAgICBjcC5tX2lkLlNldChjdi5pZCk7XHJcbiAgICAgICAgICAgIGNwLm1faWQuZmVhdHVyZXMuZmxpcCA9IGZsaXA7XHJcbiAgICAgICAgICAgICsrcG9pbnRDb3VudDtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IHBvaW50Q291bnQ7XHJcbiAgIH1cclxuICAgYjJDb2xsaXNpb24uQ29sbGlkZUNpcmNsZXMgPSBmdW5jdGlvbiAobWFuaWZvbGQsIGNpcmNsZTEsIHhmMSwgY2lyY2xlMiwgeGYyKSB7XHJcbiAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDA7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgdE1hdCA9IHhmMS5SO1xyXG4gICAgICB0VmVjID0gY2lyY2xlMS5tX3A7XHJcbiAgICAgIHZhciBwMVggPSB4ZjEucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgdmFyIHAxWSA9IHhmMS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB0TWF0ID0geGYyLlI7XHJcbiAgICAgIHRWZWMgPSBjaXJjbGUyLm1fcDtcclxuICAgICAgdmFyIHAyWCA9IHhmMi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB2YXIgcDJZID0geGYyLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHZhciBkWCA9IHAyWCAtIHAxWDtcclxuICAgICAgdmFyIGRZID0gcDJZIC0gcDFZO1xyXG4gICAgICB2YXIgZGlzdFNxciA9IGRYICogZFggKyBkWSAqIGRZO1xyXG4gICAgICB2YXIgcmFkaXVzID0gY2lyY2xlMS5tX3JhZGl1cyArIGNpcmNsZTIubV9yYWRpdXM7XHJcbiAgICAgIGlmIChkaXN0U3FyID4gcmFkaXVzICogcmFkaXVzKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBtYW5pZm9sZC5tX3R5cGUgPSBiMk1hbmlmb2xkLmVfY2lyY2xlcztcclxuICAgICAgbWFuaWZvbGQubV9sb2NhbFBvaW50LlNldFYoY2lyY2xlMS5tX3ApO1xyXG4gICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwuU2V0WmVybygpO1xyXG4gICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSAxO1xyXG4gICAgICBtYW5pZm9sZC5tX3BvaW50c1swXS5tX2xvY2FsUG9pbnQuU2V0VihjaXJjbGUyLm1fcCk7XHJcbiAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1faWQua2V5ID0gMDtcclxuICAgfVxyXG4gICBiMkNvbGxpc2lvbi5Db2xsaWRlUG9seWdvbkFuZENpcmNsZSA9IGZ1bmN0aW9uIChtYW5pZm9sZCwgcG9seWdvbiwgeGYxLCBjaXJjbGUsIHhmMikge1xyXG4gICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSAwO1xyXG4gICAgICB2YXIgdFBvaW50O1xyXG4gICAgICB2YXIgZFggPSAwO1xyXG4gICAgICB2YXIgZFkgPSAwO1xyXG4gICAgICB2YXIgcG9zaXRpb25YID0gMDtcclxuICAgICAgdmFyIHBvc2l0aW9uWSA9IDA7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdE1hdCA9IHhmMi5SO1xyXG4gICAgICB0VmVjID0gY2lyY2xlLm1fcDtcclxuICAgICAgdmFyIGNYID0geGYyLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHZhciBjWSA9IHhmMi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICBkWCA9IGNYIC0geGYxLnBvc2l0aW9uLng7XHJcbiAgICAgIGRZID0gY1kgLSB4ZjEucG9zaXRpb24ueTtcclxuICAgICAgdE1hdCA9IHhmMS5SO1xyXG4gICAgICB2YXIgY0xvY2FsWCA9IChkWCAqIHRNYXQuY29sMS54ICsgZFkgKiB0TWF0LmNvbDEueSk7XHJcbiAgICAgIHZhciBjTG9jYWxZID0gKGRYICogdE1hdC5jb2wyLnggKyBkWSAqIHRNYXQuY29sMi55KTtcclxuICAgICAgdmFyIGRpc3QgPSAwO1xyXG4gICAgICB2YXIgbm9ybWFsSW5kZXggPSAwO1xyXG4gICAgICB2YXIgc2VwYXJhdGlvbiA9ICgtTnVtYmVyLk1BWF9WQUxVRSk7XHJcbiAgICAgIHZhciByYWRpdXMgPSBwb2x5Z29uLm1fcmFkaXVzICsgY2lyY2xlLm1fcmFkaXVzO1xyXG4gICAgICB2YXIgdmVydGV4Q291bnQgPSBwYXJzZUludChwb2x5Z29uLm1fdmVydGV4Q291bnQpO1xyXG4gICAgICB2YXIgdmVydGljZXMgPSBwb2x5Z29uLm1fdmVydGljZXM7XHJcbiAgICAgIHZhciBub3JtYWxzID0gcG9seWdvbi5tX25vcm1hbHM7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmVydGV4Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB0VmVjID0gdmVydGljZXNbaV07XHJcbiAgICAgICAgIGRYID0gY0xvY2FsWCAtIHRWZWMueDtcclxuICAgICAgICAgZFkgPSBjTG9jYWxZIC0gdFZlYy55O1xyXG4gICAgICAgICB0VmVjID0gbm9ybWFsc1tpXTtcclxuICAgICAgICAgdmFyIHMgPSB0VmVjLnggKiBkWCArIHRWZWMueSAqIGRZO1xyXG4gICAgICAgICBpZiAocyA+IHJhZGl1cykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKHMgPiBzZXBhcmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHNlcGFyYXRpb24gPSBzO1xyXG4gICAgICAgICAgICBub3JtYWxJbmRleCA9IGk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB2YXIgdmVydEluZGV4MSA9IHBhcnNlSW50KG5vcm1hbEluZGV4KTtcclxuICAgICAgdmFyIHZlcnRJbmRleDIgPSBwYXJzZUludCh2ZXJ0SW5kZXgxICsgMSA8IHZlcnRleENvdW50ID8gdmVydEluZGV4MSArIDEgOiAwKTtcclxuICAgICAgdmFyIHYxID0gdmVydGljZXNbdmVydEluZGV4MV07XHJcbiAgICAgIHZhciB2MiA9IHZlcnRpY2VzW3ZlcnRJbmRleDJdO1xyXG4gICAgICBpZiAoc2VwYXJhdGlvbiA8IE51bWJlci5NSU5fVkFMVUUpIHtcclxuICAgICAgICAgbWFuaWZvbGQubV9wb2ludENvdW50ID0gMTtcclxuICAgICAgICAgbWFuaWZvbGQubV90eXBlID0gYjJNYW5pZm9sZC5lX2ZhY2VBO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwuU2V0Vihub3JtYWxzW25vcm1hbEluZGV4XSk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQb2ludC54ID0gMC41ICogKHYxLnggKyB2Mi54KTtcclxuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBvaW50LnkgPSAwLjUgKiAodjEueSArIHYyLnkpO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX3BvaW50c1swXS5tX2xvY2FsUG9pbnQuU2V0VihjaXJjbGUubV9wKTtcclxuICAgICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9pZC5rZXkgPSAwO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIHUxID0gKGNMb2NhbFggLSB2MS54KSAqICh2Mi54IC0gdjEueCkgKyAoY0xvY2FsWSAtIHYxLnkpICogKHYyLnkgLSB2MS55KTtcclxuICAgICAgdmFyIHUyID0gKGNMb2NhbFggLSB2Mi54KSAqICh2MS54IC0gdjIueCkgKyAoY0xvY2FsWSAtIHYyLnkpICogKHYxLnkgLSB2Mi55KTtcclxuICAgICAgaWYgKHUxIDw9IDAuMCkge1xyXG4gICAgICAgICBpZiAoKGNMb2NhbFggLSB2MS54KSAqIChjTG9jYWxYIC0gdjEueCkgKyAoY0xvY2FsWSAtIHYxLnkpICogKGNMb2NhbFkgLSB2MS55KSA+IHJhZGl1cyAqIHJhZGl1cykgcmV0dXJuO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSAxO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX3R5cGUgPSBiMk1hbmlmb2xkLmVfZmFjZUE7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbC54ID0gY0xvY2FsWCAtIHYxLng7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbC55ID0gY0xvY2FsWSAtIHYxLnk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbC5Ob3JtYWxpemUoKTtcclxuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBvaW50LlNldFYodjEpO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX3BvaW50c1swXS5tX2xvY2FsUG9pbnQuU2V0VihjaXJjbGUubV9wKTtcclxuICAgICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9pZC5rZXkgPSAwO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKHUyIDw9IDApIHtcclxuICAgICAgICAgaWYgKChjTG9jYWxYIC0gdjIueCkgKiAoY0xvY2FsWCAtIHYyLngpICsgKGNMb2NhbFkgLSB2Mi55KSAqIChjTG9jYWxZIC0gdjIueSkgPiByYWRpdXMgKiByYWRpdXMpIHJldHVybjtcclxuICAgICAgICAgbWFuaWZvbGQubV9wb2ludENvdW50ID0gMTtcclxuICAgICAgICAgbWFuaWZvbGQubV90eXBlID0gYjJNYW5pZm9sZC5lX2ZhY2VBO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueCA9IGNMb2NhbFggLSB2Mi54O1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueSA9IGNMb2NhbFkgLSB2Mi55O1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwuTm9ybWFsaXplKCk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQb2ludC5TZXRWKHYyKTtcclxuICAgICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9sb2NhbFBvaW50LlNldFYoY2lyY2xlLm1fcCk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1faWQua2V5ID0gMDtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdmFyIGZhY2VDZW50ZXJYID0gMC41ICogKHYxLnggKyB2Mi54KTtcclxuICAgICAgICAgdmFyIGZhY2VDZW50ZXJZID0gMC41ICogKHYxLnkgKyB2Mi55KTtcclxuICAgICAgICAgc2VwYXJhdGlvbiA9IChjTG9jYWxYIC0gZmFjZUNlbnRlclgpICogbm9ybWFsc1t2ZXJ0SW5kZXgxXS54ICsgKGNMb2NhbFkgLSBmYWNlQ2VudGVyWSkgKiBub3JtYWxzW3ZlcnRJbmRleDFdLnk7XHJcbiAgICAgICAgIGlmIChzZXBhcmF0aW9uID4gcmFkaXVzKSByZXR1cm47XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDE7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fdHlwZSA9IGIyTWFuaWZvbGQuZV9mYWNlQTtcclxuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLnggPSBub3JtYWxzW3ZlcnRJbmRleDFdLng7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbC55ID0gbm9ybWFsc1t2ZXJ0SW5kZXgxXS55O1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwuTm9ybWFsaXplKCk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQb2ludC5TZXQoZmFjZUNlbnRlclgsIGZhY2VDZW50ZXJZKTtcclxuICAgICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9sb2NhbFBvaW50LlNldFYoY2lyY2xlLm1fcCk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1faWQua2V5ID0gMDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQ29sbGlzaW9uLlRlc3RPdmVybGFwID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgdmFyIHQxID0gYi5sb3dlckJvdW5kO1xyXG4gICAgICB2YXIgdDIgPSBhLnVwcGVyQm91bmQ7XHJcbiAgICAgIHZhciBkMVggPSB0MS54IC0gdDIueDtcclxuICAgICAgdmFyIGQxWSA9IHQxLnkgLSB0Mi55O1xyXG4gICAgICB0MSA9IGEubG93ZXJCb3VuZDtcclxuICAgICAgdDIgPSBiLnVwcGVyQm91bmQ7XHJcbiAgICAgIHZhciBkMlggPSB0MS54IC0gdDIueDtcclxuICAgICAgdmFyIGQyWSA9IHQxLnkgLSB0Mi55O1xyXG4gICAgICBpZiAoZDFYID4gMC4wIHx8IGQxWSA+IDAuMCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICBpZiAoZDJYID4gMC4wIHx8IGQyWSA+IDAuMCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfaW5jaWRlbnRFZGdlID0gYjJDb2xsaXNpb24uTWFrZUNsaXBQb2ludFZlY3RvcigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc19jbGlwUG9pbnRzMSA9IGIyQ29sbGlzaW9uLk1ha2VDbGlwUG9pbnRWZWN0b3IoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfY2xpcFBvaW50czIgPSBiMkNvbGxpc2lvbi5NYWtlQ2xpcFBvaW50VmVjdG9yKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX2VkZ2VBTyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigxKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfZWRnZUJPID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKDEpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc19sb2NhbFRhbmdlbnQgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX2xvY2FsTm9ybWFsID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc19wbGFuZVBvaW50ID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc19ub3JtYWwgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX3RhbmdlbnQgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX3RhbmdlbnQyID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc192MTEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX3YxMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLmIyQ29sbGlkZVBvbHlUZW1wVmVjID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uYjJfbnVsbEZlYXR1cmUgPSAweDAwMDAwMGZmO1xyXG4gICB9KTtcclxuICAgYjJDb250YWN0SUQuYjJDb250YWN0SUQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuZmVhdHVyZXMgPSBuZXcgRmVhdHVyZXMoKTtcclxuICAgfTtcclxuICAgYjJDb250YWN0SUQucHJvdG90eXBlLmIyQ29udGFjdElEID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmZlYXR1cmVzLl9tX2lkID0gdGhpcztcclxuICAgfVxyXG4gICBiMkNvbnRhY3RJRC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgIHRoaXMua2V5ID0gaWQuX2tleTtcclxuICAgfVxyXG4gICBiMkNvbnRhY3RJRC5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGlkID0gbmV3IGIyQ29udGFjdElEKCk7XHJcbiAgICAgIGlkLmtleSA9IHRoaXMua2V5O1xyXG4gICAgICByZXR1cm4gaWQ7XHJcbiAgIH1cclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIyQ29udGFjdElELnByb3RvdHlwZSwgJ2tleScsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgIHJldHVybiB0aGlzLl9rZXk7XHJcbiAgICAgIH1cclxuICAgfSk7XHJcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiMkNvbnRhY3RJRC5wcm90b3R5cGUsICdrZXknLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB2YWx1ZSA9IDA7XHJcbiAgICAgICAgIHRoaXMuX2tleSA9IHZhbHVlO1xyXG4gICAgICAgICB0aGlzLmZlYXR1cmVzLl9yZWZlcmVuY2VFZGdlID0gdGhpcy5fa2V5ICYgMHgwMDAwMDBmZjtcclxuICAgICAgICAgdGhpcy5mZWF0dXJlcy5faW5jaWRlbnRFZGdlID0gKCh0aGlzLl9rZXkgJiAweDAwMDBmZjAwKSA+PiA4KSAmIDB4MDAwMDAwZmY7XHJcbiAgICAgICAgIHRoaXMuZmVhdHVyZXMuX2luY2lkZW50VmVydGV4ID0gKCh0aGlzLl9rZXkgJiAweDAwZmYwMDAwKSA+PiAxNikgJiAweDAwMDAwMGZmO1xyXG4gICAgICAgICB0aGlzLmZlYXR1cmVzLl9mbGlwID0gKCh0aGlzLl9rZXkgJiAweGZmMDAwMDAwKSA+PiAyNCkgJiAweDAwMDAwMGZmO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBiMkNvbnRhY3RQb2ludC5iMkNvbnRhY3RQb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5ub3JtYWwgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMuaWQgPSBuZXcgYjJDb250YWN0SUQoKTtcclxuICAgfTtcclxuICAgYjJEaXN0YW5jZS5iMkRpc3RhbmNlID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyRGlzdGFuY2UuRGlzdGFuY2UgPSBmdW5jdGlvbiAob3V0cHV0LCBjYWNoZSwgaW5wdXQpIHtcclxuICAgICAgKytiMkRpc3RhbmNlLmIyX2dqa0NhbGxzO1xyXG4gICAgICB2YXIgcHJveHlBID0gaW5wdXQucHJveHlBO1xyXG4gICAgICB2YXIgcHJveHlCID0gaW5wdXQucHJveHlCO1xyXG4gICAgICB2YXIgdHJhbnNmb3JtQSA9IGlucHV0LnRyYW5zZm9ybUE7XHJcbiAgICAgIHZhciB0cmFuc2Zvcm1CID0gaW5wdXQudHJhbnNmb3JtQjtcclxuICAgICAgdmFyIHNpbXBsZXggPSBiMkRpc3RhbmNlLnNfc2ltcGxleDtcclxuICAgICAgc2ltcGxleC5SZWFkQ2FjaGUoY2FjaGUsIHByb3h5QSwgdHJhbnNmb3JtQSwgcHJveHlCLCB0cmFuc2Zvcm1CKTtcclxuICAgICAgdmFyIHZlcnRpY2VzID0gc2ltcGxleC5tX3ZlcnRpY2VzO1xyXG4gICAgICB2YXIga19tYXhJdGVycyA9IDIwO1xyXG4gICAgICB2YXIgc2F2ZUEgPSBiMkRpc3RhbmNlLnNfc2F2ZUE7XHJcbiAgICAgIHZhciBzYXZlQiA9IGIyRGlzdGFuY2Uuc19zYXZlQjtcclxuICAgICAgdmFyIHNhdmVDb3VudCA9IDA7XHJcbiAgICAgIHZhciBjbG9zZXN0UG9pbnQgPSBzaW1wbGV4LkdldENsb3Nlc3RQb2ludCgpO1xyXG4gICAgICB2YXIgZGlzdGFuY2VTcXIxID0gY2xvc2VzdFBvaW50Lkxlbmd0aFNxdWFyZWQoKTtcclxuICAgICAgdmFyIGRpc3RhbmNlU3FyMiA9IGRpc3RhbmNlU3FyMTtcclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICB2YXIgcDtcclxuICAgICAgdmFyIGl0ZXIgPSAwO1xyXG4gICAgICB3aGlsZSAoaXRlciA8IGtfbWF4SXRlcnMpIHtcclxuICAgICAgICAgc2F2ZUNvdW50ID0gc2ltcGxleC5tX2NvdW50O1xyXG4gICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICBpIDwgc2F2ZUNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgc2F2ZUFbaV0gPSB2ZXJ0aWNlc1tpXS5pbmRleEE7XHJcbiAgICAgICAgICAgIHNhdmVCW2ldID0gdmVydGljZXNbaV0uaW5kZXhCO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHN3aXRjaCAoc2ltcGxleC5tX2NvdW50KSB7XHJcbiAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgc2ltcGxleC5Tb2x2ZTIoKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgc2ltcGxleC5Tb2x2ZTMoKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZmFsc2UpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChzaW1wbGV4Lm1fY291bnQgPT0gMykge1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBwID0gc2ltcGxleC5HZXRDbG9zZXN0UG9pbnQoKTtcclxuICAgICAgICAgZGlzdGFuY2VTcXIyID0gcC5MZW5ndGhTcXVhcmVkKCk7XHJcbiAgICAgICAgIGlmIChkaXN0YW5jZVNxcjIgPiBkaXN0YW5jZVNxcjEpIHt9XHJcbiAgICAgICAgIGRpc3RhbmNlU3FyMSA9IGRpc3RhbmNlU3FyMjtcclxuICAgICAgICAgdmFyIGQgPSBzaW1wbGV4LkdldFNlYXJjaERpcmVjdGlvbigpO1xyXG4gICAgICAgICBpZiAoZC5MZW5ndGhTcXVhcmVkKCkgPCBOdW1iZXIuTUlOX1ZBTFVFICogTnVtYmVyLk1JTl9WQUxVRSkge1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgdmVydGV4ID0gdmVydGljZXNbc2ltcGxleC5tX2NvdW50XTtcclxuICAgICAgICAgdmVydGV4LmluZGV4QSA9IHByb3h5QS5HZXRTdXBwb3J0KGIyTWF0aC5NdWxUTVYodHJhbnNmb3JtQS5SLCBkLkdldE5lZ2F0aXZlKCkpKTtcclxuICAgICAgICAgdmVydGV4LndBID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQSwgcHJveHlBLkdldFZlcnRleCh2ZXJ0ZXguaW5kZXhBKSk7XHJcbiAgICAgICAgIHZlcnRleC5pbmRleEIgPSBwcm94eUIuR2V0U3VwcG9ydChiMk1hdGguTXVsVE1WKHRyYW5zZm9ybUIuUiwgZCkpO1xyXG4gICAgICAgICB2ZXJ0ZXgud0IgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1CLCBwcm94eUIuR2V0VmVydGV4KHZlcnRleC5pbmRleEIpKTtcclxuICAgICAgICAgdmVydGV4LncgPSBiMk1hdGguU3VidHJhY3RWVih2ZXJ0ZXgud0IsIHZlcnRleC53QSk7XHJcbiAgICAgICAgICsraXRlcjtcclxuICAgICAgICAgKytiMkRpc3RhbmNlLmIyX2dqa0l0ZXJzO1xyXG4gICAgICAgICB2YXIgZHVwbGljYXRlID0gZmFsc2U7XHJcbiAgICAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgICAgIGkgPCBzYXZlQ291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodmVydGV4LmluZGV4QSA9PSBzYXZlQVtpXSAmJiB2ZXJ0ZXguaW5kZXhCID09IHNhdmVCW2ldKSB7XHJcbiAgICAgICAgICAgICAgIGR1cGxpY2F0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKGR1cGxpY2F0ZSkge1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfSsrc2ltcGxleC5tX2NvdW50O1xyXG4gICAgICB9XHJcbiAgICAgIGIyRGlzdGFuY2UuYjJfZ2prTWF4SXRlcnMgPSBiMk1hdGguTWF4KGIyRGlzdGFuY2UuYjJfZ2prTWF4SXRlcnMsIGl0ZXIpO1xyXG4gICAgICBzaW1wbGV4LkdldFdpdG5lc3NQb2ludHMob3V0cHV0LnBvaW50QSwgb3V0cHV0LnBvaW50Qik7XHJcbiAgICAgIG91dHB1dC5kaXN0YW5jZSA9IGIyTWF0aC5TdWJ0cmFjdFZWKG91dHB1dC5wb2ludEEsIG91dHB1dC5wb2ludEIpLkxlbmd0aCgpO1xyXG4gICAgICBvdXRwdXQuaXRlcmF0aW9ucyA9IGl0ZXI7XHJcbiAgICAgIHNpbXBsZXguV3JpdGVDYWNoZShjYWNoZSk7XHJcbiAgICAgIGlmIChpbnB1dC51c2VSYWRpaSkge1xyXG4gICAgICAgICB2YXIgckEgPSBwcm94eUEubV9yYWRpdXM7XHJcbiAgICAgICAgIHZhciByQiA9IHByb3h5Qi5tX3JhZGl1cztcclxuICAgICAgICAgaWYgKG91dHB1dC5kaXN0YW5jZSA+IHJBICsgckIgJiYgb3V0cHV0LmRpc3RhbmNlID4gTnVtYmVyLk1JTl9WQUxVRSkge1xyXG4gICAgICAgICAgICBvdXRwdXQuZGlzdGFuY2UgLT0gckEgKyByQjtcclxuICAgICAgICAgICAgdmFyIG5vcm1hbCA9IGIyTWF0aC5TdWJ0cmFjdFZWKG91dHB1dC5wb2ludEIsIG91dHB1dC5wb2ludEEpO1xyXG4gICAgICAgICAgICBub3JtYWwuTm9ybWFsaXplKCk7XHJcbiAgICAgICAgICAgIG91dHB1dC5wb2ludEEueCArPSByQSAqIG5vcm1hbC54O1xyXG4gICAgICAgICAgICBvdXRwdXQucG9pbnRBLnkgKz0gckEgKiBub3JtYWwueTtcclxuICAgICAgICAgICAgb3V0cHV0LnBvaW50Qi54IC09IHJCICogbm9ybWFsLng7XHJcbiAgICAgICAgICAgIG91dHB1dC5wb2ludEIueSAtPSByQiAqIG5vcm1hbC55O1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICAgICAgICBwLnggPSAuNSAqIChvdXRwdXQucG9pbnRBLnggKyBvdXRwdXQucG9pbnRCLngpO1xyXG4gICAgICAgICAgICBwLnkgPSAuNSAqIChvdXRwdXQucG9pbnRBLnkgKyBvdXRwdXQucG9pbnRCLnkpO1xyXG4gICAgICAgICAgICBvdXRwdXQucG9pbnRBLnggPSBvdXRwdXQucG9pbnRCLnggPSBwLng7XHJcbiAgICAgICAgICAgIG91dHB1dC5wb2ludEEueSA9IG91dHB1dC5wb2ludEIueSA9IHAueTtcclxuICAgICAgICAgICAgb3V0cHV0LmRpc3RhbmNlID0gMC4wO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2Uuc19zaW1wbGV4ID0gbmV3IGIyU2ltcGxleCgpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZS5zX3NhdmVBID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKDMpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZS5zX3NhdmVCID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKDMpO1xyXG4gICB9KTtcclxuICAgYjJEaXN0YW5jZUlucHV0LmIyRGlzdGFuY2VJbnB1dCA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkRpc3RhbmNlT3V0cHV0LmIyRGlzdGFuY2VPdXRwdXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMucG9pbnRBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLnBvaW50QiA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJEaXN0YW5jZVByb3h5LmIyRGlzdGFuY2VQcm94eSA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkRpc3RhbmNlUHJveHkucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChzaGFwZSkge1xyXG4gICAgICBzd2l0Y2ggKHNoYXBlLkdldFR5cGUoKSkge1xyXG4gICAgICBjYXNlIGIyU2hhcGUuZV9jaXJjbGVTaGFwZTpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgY2lyY2xlID0gKHNoYXBlIGluc3RhbmNlb2YgYjJDaXJjbGVTaGFwZSA/IHNoYXBlIDogbnVsbCk7XHJcbiAgICAgICAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IG5ldyBWZWN0b3IoMSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1swXSA9IGNpcmNsZS5tX3A7XHJcbiAgICAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XHJcbiAgICAgICAgICAgIHRoaXMubV9yYWRpdXMgPSBjaXJjbGUubV9yYWRpdXM7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJTaGFwZS5lX3BvbHlnb25TaGFwZTpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgcG9seWdvbiA9IChzaGFwZSBpbnN0YW5jZW9mIGIyUG9seWdvblNoYXBlID8gc2hhcGUgOiBudWxsKTtcclxuICAgICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gcG9seWdvbi5tX3ZlcnRpY2VzO1xyXG4gICAgICAgICAgICB0aGlzLm1fY291bnQgPSBwb2x5Z29uLm1fdmVydGV4Q291bnQ7XHJcbiAgICAgICAgICAgIHRoaXMubV9yYWRpdXMgPSBwb2x5Z29uLm1fcmFkaXVzO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VQcm94eS5wcm90b3R5cGUuR2V0U3VwcG9ydCA9IGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgIHZhciBiZXN0SW5kZXggPSAwO1xyXG4gICAgICB2YXIgYmVzdFZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzWzBdLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbMF0ueSAqIGQueTtcclxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLm1fdmVydGljZXNbaV0ueCAqIGQueCArIHRoaXMubV92ZXJ0aWNlc1tpXS55ICogZC55O1xyXG4gICAgICAgICBpZiAodmFsdWUgPiBiZXN0VmFsdWUpIHtcclxuICAgICAgICAgICAgYmVzdEluZGV4ID0gaTtcclxuICAgICAgICAgICAgYmVzdFZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYmVzdEluZGV4O1xyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VQcm94eS5wcm90b3R5cGUuR2V0U3VwcG9ydFZlcnRleCA9IGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgIHZhciBiZXN0SW5kZXggPSAwO1xyXG4gICAgICB2YXIgYmVzdFZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzWzBdLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbMF0ueSAqIGQueTtcclxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLm1fY291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLm1fdmVydGljZXNbaV0ueCAqIGQueCArIHRoaXMubV92ZXJ0aWNlc1tpXS55ICogZC55O1xyXG4gICAgICAgICBpZiAodmFsdWUgPiBiZXN0VmFsdWUpIHtcclxuICAgICAgICAgICAgYmVzdEluZGV4ID0gaTtcclxuICAgICAgICAgICAgYmVzdFZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW2Jlc3RJbmRleF07XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZVByb3h5LnByb3RvdHlwZS5HZXRWZXJ0ZXhDb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jb3VudDtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlUHJveHkucHJvdG90eXBlLkdldFZlcnRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICBpZiAoaW5kZXggPT09IHVuZGVmaW5lZCkgaW5kZXggPSAwO1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KDAgPD0gaW5kZXggJiYgaW5kZXggPCB0aGlzLm1fY291bnQpO1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW2luZGV4XTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlLmIyRHluYW1pY1RyZWUgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuYjJEeW5hbWljVHJlZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3Jvb3QgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fZnJlZUxpc3QgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fcGF0aCA9IDA7XHJcbiAgICAgIHRoaXMubV9pbnNlcnRpb25Db3VudCA9IDA7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuQ3JlYXRlUHJveHkgPSBmdW5jdGlvbiAoYWFiYiwgdXNlckRhdGEpIHtcclxuICAgICAgdmFyIG5vZGUgPSB0aGlzLkFsbG9jYXRlTm9kZSgpO1xyXG4gICAgICB2YXIgZXh0ZW5kWCA9IGIyU2V0dGluZ3MuYjJfYWFiYkV4dGVuc2lvbjtcclxuICAgICAgdmFyIGV4dGVuZFkgPSBiMlNldHRpbmdzLmIyX2FhYmJFeHRlbnNpb247XHJcbiAgICAgIG5vZGUuYWFiYi5sb3dlckJvdW5kLnggPSBhYWJiLmxvd2VyQm91bmQueCAtIGV4dGVuZFg7XHJcbiAgICAgIG5vZGUuYWFiYi5sb3dlckJvdW5kLnkgPSBhYWJiLmxvd2VyQm91bmQueSAtIGV4dGVuZFk7XHJcbiAgICAgIG5vZGUuYWFiYi51cHBlckJvdW5kLnggPSBhYWJiLnVwcGVyQm91bmQueCArIGV4dGVuZFg7XHJcbiAgICAgIG5vZGUuYWFiYi51cHBlckJvdW5kLnkgPSBhYWJiLnVwcGVyQm91bmQueSArIGV4dGVuZFk7XHJcbiAgICAgIG5vZGUudXNlckRhdGEgPSB1c2VyRGF0YTtcclxuICAgICAgdGhpcy5JbnNlcnRMZWFmKG5vZGUpO1xyXG4gICAgICByZXR1cm4gbm9kZTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5EZXN0cm95UHJveHkgPSBmdW5jdGlvbiAocHJveHkpIHtcclxuICAgICAgdGhpcy5SZW1vdmVMZWFmKHByb3h5KTtcclxuICAgICAgdGhpcy5GcmVlTm9kZShwcm94eSk7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuTW92ZVByb3h5ID0gZnVuY3Rpb24gKHByb3h5LCBhYWJiLCBkaXNwbGFjZW1lbnQpIHtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChwcm94eS5Jc0xlYWYoKSk7XHJcbiAgICAgIGlmIChwcm94eS5hYWJiLkNvbnRhaW5zKGFhYmIpKSB7XHJcbiAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLlJlbW92ZUxlYWYocHJveHkpO1xyXG4gICAgICB2YXIgZXh0ZW5kWCA9IGIyU2V0dGluZ3MuYjJfYWFiYkV4dGVuc2lvbiArIGIyU2V0dGluZ3MuYjJfYWFiYk11bHRpcGxpZXIgKiAoZGlzcGxhY2VtZW50LnggPiAwID8gZGlzcGxhY2VtZW50LnggOiAoLWRpc3BsYWNlbWVudC54KSk7XHJcbiAgICAgIHZhciBleHRlbmRZID0gYjJTZXR0aW5ncy5iMl9hYWJiRXh0ZW5zaW9uICsgYjJTZXR0aW5ncy5iMl9hYWJiTXVsdGlwbGllciAqIChkaXNwbGFjZW1lbnQueSA+IDAgPyBkaXNwbGFjZW1lbnQueSA6ICgtZGlzcGxhY2VtZW50LnkpKTtcclxuICAgICAgcHJveHkuYWFiYi5sb3dlckJvdW5kLnggPSBhYWJiLmxvd2VyQm91bmQueCAtIGV4dGVuZFg7XHJcbiAgICAgIHByb3h5LmFhYmIubG93ZXJCb3VuZC55ID0gYWFiYi5sb3dlckJvdW5kLnkgLSBleHRlbmRZO1xyXG4gICAgICBwcm94eS5hYWJiLnVwcGVyQm91bmQueCA9IGFhYmIudXBwZXJCb3VuZC54ICsgZXh0ZW5kWDtcclxuICAgICAgcHJveHkuYWFiYi51cHBlckJvdW5kLnkgPSBhYWJiLnVwcGVyQm91bmQueSArIGV4dGVuZFk7XHJcbiAgICAgIHRoaXMuSW5zZXJ0TGVhZihwcm94eSk7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLlJlYmFsYW5jZSA9IGZ1bmN0aW9uIChpdGVyYXRpb25zKSB7XHJcbiAgICAgIGlmIChpdGVyYXRpb25zID09PSB1bmRlZmluZWQpIGl0ZXJhdGlvbnMgPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkgcmV0dXJuO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZXJhdGlvbnM7IGkrKykge1xyXG4gICAgICAgICB2YXIgbm9kZSA9IHRoaXMubV9yb290O1xyXG4gICAgICAgICB2YXIgYml0ID0gMDtcclxuICAgICAgICAgd2hpbGUgKG5vZGUuSXNMZWFmKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgbm9kZSA9ICh0aGlzLm1fcGF0aCA+PiBiaXQpICYgMSA/IG5vZGUuY2hpbGQyIDogbm9kZS5jaGlsZDE7XHJcbiAgICAgICAgICAgIGJpdCA9IChiaXQgKyAxKSAmIDMxO1xyXG4gICAgICAgICB9Kyt0aGlzLm1fcGF0aDtcclxuICAgICAgICAgdGhpcy5SZW1vdmVMZWFmKG5vZGUpO1xyXG4gICAgICAgICB0aGlzLkluc2VydExlYWYobm9kZSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5HZXRGYXRBQUJCID0gZnVuY3Rpb24gKHByb3h5KSB7XHJcbiAgICAgIHJldHVybiBwcm94eS5hYWJiO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLkdldFVzZXJEYXRhID0gZnVuY3Rpb24gKHByb3h5KSB7XHJcbiAgICAgIHJldHVybiBwcm94eS51c2VyRGF0YTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5RdWVyeSA9IGZ1bmN0aW9uIChjYWxsYmFjaywgYWFiYikge1xyXG4gICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkgcmV0dXJuO1xyXG4gICAgICB2YXIgc3RhY2sgPSBuZXcgVmVjdG9yKCk7XHJcbiAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgIHN0YWNrW2NvdW50KytdID0gdGhpcy5tX3Jvb3Q7XHJcbiAgICAgIHdoaWxlIChjb3VudCA+IDApIHtcclxuICAgICAgICAgdmFyIG5vZGUgPSBzdGFja1stLWNvdW50XTtcclxuICAgICAgICAgaWYgKG5vZGUuYWFiYi5UZXN0T3ZlcmxhcChhYWJiKSkge1xyXG4gICAgICAgICAgICBpZiAobm9kZS5Jc0xlYWYoKSkge1xyXG4gICAgICAgICAgICAgICB2YXIgcHJvY2VlZCA9IGNhbGxiYWNrKG5vZGUpO1xyXG4gICAgICAgICAgICAgICBpZiAoIXByb2NlZWQpIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgc3RhY2tbY291bnQrK10gPSBub2RlLmNoaWxkMTtcclxuICAgICAgICAgICAgICAgc3RhY2tbY291bnQrK10gPSBub2RlLmNoaWxkMjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5SYXlDYXN0ID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBpbnB1dCkge1xyXG4gICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkgcmV0dXJuO1xyXG4gICAgICB2YXIgcDEgPSBpbnB1dC5wMTtcclxuICAgICAgdmFyIHAyID0gaW5wdXQucDI7XHJcbiAgICAgIHZhciByID0gYjJNYXRoLlN1YnRyYWN0VlYocDEsIHAyKTtcclxuICAgICAgci5Ob3JtYWxpemUoKTtcclxuICAgICAgdmFyIHYgPSBiMk1hdGguQ3Jvc3NGVigxLjAsIHIpO1xyXG4gICAgICB2YXIgYWJzX3YgPSBiMk1hdGguQWJzVih2KTtcclxuICAgICAgdmFyIG1heEZyYWN0aW9uID0gaW5wdXQubWF4RnJhY3Rpb247XHJcbiAgICAgIHZhciBzZWdtZW50QUFCQiA9IG5ldyBiMkFBQkIoKTtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIHRZID0gMDsge1xyXG4gICAgICAgICB0WCA9IHAxLnggKyBtYXhGcmFjdGlvbiAqIChwMi54IC0gcDEueCk7XHJcbiAgICAgICAgIHRZID0gcDEueSArIG1heEZyYWN0aW9uICogKHAyLnkgLSBwMS55KTtcclxuICAgICAgICAgc2VnbWVudEFBQkIubG93ZXJCb3VuZC54ID0gTWF0aC5taW4ocDEueCwgdFgpO1xyXG4gICAgICAgICBzZWdtZW50QUFCQi5sb3dlckJvdW5kLnkgPSBNYXRoLm1pbihwMS55LCB0WSk7XHJcbiAgICAgICAgIHNlZ21lbnRBQUJCLnVwcGVyQm91bmQueCA9IE1hdGgubWF4KHAxLngsIHRYKTtcclxuICAgICAgICAgc2VnbWVudEFBQkIudXBwZXJCb3VuZC55ID0gTWF0aC5tYXgocDEueSwgdFkpO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBzdGFjayA9IG5ldyBWZWN0b3IoKTtcclxuICAgICAgdmFyIGNvdW50ID0gMDtcclxuICAgICAgc3RhY2tbY291bnQrK10gPSB0aGlzLm1fcm9vdDtcclxuICAgICAgd2hpbGUgKGNvdW50ID4gMCkge1xyXG4gICAgICAgICB2YXIgbm9kZSA9IHN0YWNrWy0tY291bnRdO1xyXG4gICAgICAgICBpZiAobm9kZS5hYWJiLlRlc3RPdmVybGFwKHNlZ21lbnRBQUJCKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgYyA9IG5vZGUuYWFiYi5HZXRDZW50ZXIoKTtcclxuICAgICAgICAgdmFyIGggPSBub2RlLmFhYmIuR2V0RXh0ZW50cygpO1xyXG4gICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IE1hdGguYWJzKHYueCAqIChwMS54IC0gYy54KSArIHYueSAqIChwMS55IC0gYy55KSkgLSBhYnNfdi54ICogaC54IC0gYWJzX3YueSAqIGgueTtcclxuICAgICAgICAgaWYgKHNlcGFyYXRpb24gPiAwLjApIGNvbnRpbnVlO1xyXG4gICAgICAgICBpZiAobm9kZS5Jc0xlYWYoKSkge1xyXG4gICAgICAgICAgICB2YXIgc3ViSW5wdXQgPSBuZXcgYjJSYXlDYXN0SW5wdXQoKTtcclxuICAgICAgICAgICAgc3ViSW5wdXQucDEgPSBpbnB1dC5wMTtcclxuICAgICAgICAgICAgc3ViSW5wdXQucDIgPSBpbnB1dC5wMjtcclxuICAgICAgICAgICAgc3ViSW5wdXQubWF4RnJhY3Rpb24gPSBpbnB1dC5tYXhGcmFjdGlvbjtcclxuICAgICAgICAgICAgbWF4RnJhY3Rpb24gPSBjYWxsYmFjayhzdWJJbnB1dCwgbm9kZSk7XHJcbiAgICAgICAgICAgIGlmIChtYXhGcmFjdGlvbiA9PSAwLjApIHJldHVybjtcclxuICAgICAgICAgICAgaWYgKG1heEZyYWN0aW9uID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgIHRYID0gcDEueCArIG1heEZyYWN0aW9uICogKHAyLnggLSBwMS54KTtcclxuICAgICAgICAgICAgICAgdFkgPSBwMS55ICsgbWF4RnJhY3Rpb24gKiAocDIueSAtIHAxLnkpO1xyXG4gICAgICAgICAgICAgICBzZWdtZW50QUFCQi5sb3dlckJvdW5kLnggPSBNYXRoLm1pbihwMS54LCB0WCk7XHJcbiAgICAgICAgICAgICAgIHNlZ21lbnRBQUJCLmxvd2VyQm91bmQueSA9IE1hdGgubWluKHAxLnksIHRZKTtcclxuICAgICAgICAgICAgICAgc2VnbWVudEFBQkIudXBwZXJCb3VuZC54ID0gTWF0aC5tYXgocDEueCwgdFgpO1xyXG4gICAgICAgICAgICAgICBzZWdtZW50QUFCQi51cHBlckJvdW5kLnkgPSBNYXRoLm1heChwMS55LCB0WSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc3RhY2tbY291bnQrK10gPSBub2RlLmNoaWxkMTtcclxuICAgICAgICAgICAgc3RhY2tbY291bnQrK10gPSBub2RlLmNoaWxkMjtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuQWxsb2NhdGVOb2RlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAodGhpcy5tX2ZyZWVMaXN0KSB7XHJcbiAgICAgICAgIHZhciBub2RlID0gdGhpcy5tX2ZyZWVMaXN0O1xyXG4gICAgICAgICB0aGlzLm1fZnJlZUxpc3QgPSBub2RlLnBhcmVudDtcclxuICAgICAgICAgbm9kZS5wYXJlbnQgPSBudWxsO1xyXG4gICAgICAgICBub2RlLmNoaWxkMSA9IG51bGw7XHJcbiAgICAgICAgIG5vZGUuY2hpbGQyID0gbnVsbDtcclxuICAgICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG5ldyBiMkR5bmFtaWNUcmVlTm9kZSgpO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLkZyZWVOb2RlID0gZnVuY3Rpb24gKG5vZGUpIHtcclxuICAgICAgbm9kZS5wYXJlbnQgPSB0aGlzLm1fZnJlZUxpc3Q7XHJcbiAgICAgIHRoaXMubV9mcmVlTGlzdCA9IG5vZGU7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuSW5zZXJ0TGVhZiA9IGZ1bmN0aW9uIChsZWFmKSB7XHJcbiAgICAgICsrdGhpcy5tX2luc2VydGlvbkNvdW50O1xyXG4gICAgICBpZiAodGhpcy5tX3Jvb3QgPT0gbnVsbCkge1xyXG4gICAgICAgICB0aGlzLm1fcm9vdCA9IGxlYWY7XHJcbiAgICAgICAgIHRoaXMubV9yb290LnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgY2VudGVyID0gbGVhZi5hYWJiLkdldENlbnRlcigpO1xyXG4gICAgICB2YXIgc2libGluZyA9IHRoaXMubV9yb290O1xyXG4gICAgICBpZiAoc2libGluZy5Jc0xlYWYoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZDEgPSBzaWJsaW5nLmNoaWxkMTtcclxuICAgICAgICAgICAgdmFyIGNoaWxkMiA9IHNpYmxpbmcuY2hpbGQyO1xyXG4gICAgICAgICAgICB2YXIgbm9ybTEgPSBNYXRoLmFicygoY2hpbGQxLmFhYmIubG93ZXJCb3VuZC54ICsgY2hpbGQxLmFhYmIudXBwZXJCb3VuZC54KSAvIDIgLSBjZW50ZXIueCkgKyBNYXRoLmFicygoY2hpbGQxLmFhYmIubG93ZXJCb3VuZC55ICsgY2hpbGQxLmFhYmIudXBwZXJCb3VuZC55KSAvIDIgLSBjZW50ZXIueSk7XHJcbiAgICAgICAgICAgIHZhciBub3JtMiA9IE1hdGguYWJzKChjaGlsZDIuYWFiYi5sb3dlckJvdW5kLnggKyBjaGlsZDIuYWFiYi51cHBlckJvdW5kLngpIC8gMiAtIGNlbnRlci54KSArIE1hdGguYWJzKChjaGlsZDIuYWFiYi5sb3dlckJvdW5kLnkgKyBjaGlsZDIuYWFiYi51cHBlckJvdW5kLnkpIC8gMiAtIGNlbnRlci55KTtcclxuICAgICAgICAgICAgaWYgKG5vcm0xIDwgbm9ybTIpIHtcclxuICAgICAgICAgICAgICAgc2libGluZyA9IGNoaWxkMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgc2libGluZyA9IGNoaWxkMjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHdoaWxlIChzaWJsaW5nLklzTGVhZigpID09IGZhbHNlKVxyXG4gICAgICB9XHJcbiAgICAgIHZhciBub2RlMSA9IHNpYmxpbmcucGFyZW50O1xyXG4gICAgICB2YXIgbm9kZTIgPSB0aGlzLkFsbG9jYXRlTm9kZSgpO1xyXG4gICAgICBub2RlMi5wYXJlbnQgPSBub2RlMTtcclxuICAgICAgbm9kZTIudXNlckRhdGEgPSBudWxsO1xyXG4gICAgICBub2RlMi5hYWJiLkNvbWJpbmUobGVhZi5hYWJiLCBzaWJsaW5nLmFhYmIpO1xyXG4gICAgICBpZiAobm9kZTEpIHtcclxuICAgICAgICAgaWYgKHNpYmxpbmcucGFyZW50LmNoaWxkMSA9PSBzaWJsaW5nKSB7XHJcbiAgICAgICAgICAgIG5vZGUxLmNoaWxkMSA9IG5vZGUyO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBub2RlMS5jaGlsZDIgPSBub2RlMjtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBub2RlMi5jaGlsZDEgPSBzaWJsaW5nO1xyXG4gICAgICAgICBub2RlMi5jaGlsZDIgPSBsZWFmO1xyXG4gICAgICAgICBzaWJsaW5nLnBhcmVudCA9IG5vZGUyO1xyXG4gICAgICAgICBsZWFmLnBhcmVudCA9IG5vZGUyO1xyXG4gICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIGlmIChub2RlMS5hYWJiLkNvbnRhaW5zKG5vZGUyLmFhYmIpKSBicmVhaztcclxuICAgICAgICAgICAgbm9kZTEuYWFiYi5Db21iaW5lKG5vZGUxLmNoaWxkMS5hYWJiLCBub2RlMS5jaGlsZDIuYWFiYik7XHJcbiAgICAgICAgICAgIG5vZGUyID0gbm9kZTE7XHJcbiAgICAgICAgICAgIG5vZGUxID0gbm9kZTEucGFyZW50O1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHdoaWxlIChub2RlMSlcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgbm9kZTIuY2hpbGQxID0gc2libGluZztcclxuICAgICAgICAgbm9kZTIuY2hpbGQyID0gbGVhZjtcclxuICAgICAgICAgc2libGluZy5wYXJlbnQgPSBub2RlMjtcclxuICAgICAgICAgbGVhZi5wYXJlbnQgPSBub2RlMjtcclxuICAgICAgICAgdGhpcy5tX3Jvb3QgPSBub2RlMjtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLlJlbW92ZUxlYWYgPSBmdW5jdGlvbiAobGVhZikge1xyXG4gICAgICBpZiAobGVhZiA9PSB0aGlzLm1fcm9vdCkge1xyXG4gICAgICAgICB0aGlzLm1fcm9vdCA9IG51bGw7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgbm9kZTIgPSBsZWFmLnBhcmVudDtcclxuICAgICAgdmFyIG5vZGUxID0gbm9kZTIucGFyZW50O1xyXG4gICAgICB2YXIgc2libGluZztcclxuICAgICAgaWYgKG5vZGUyLmNoaWxkMSA9PSBsZWFmKSB7XHJcbiAgICAgICAgIHNpYmxpbmcgPSBub2RlMi5jaGlsZDI7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHNpYmxpbmcgPSBub2RlMi5jaGlsZDE7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG5vZGUxKSB7XHJcbiAgICAgICAgIGlmIChub2RlMS5jaGlsZDEgPT0gbm9kZTIpIHtcclxuICAgICAgICAgICAgbm9kZTEuY2hpbGQxID0gc2libGluZztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbm9kZTEuY2hpbGQyID0gc2libGluZztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBzaWJsaW5nLnBhcmVudCA9IG5vZGUxO1xyXG4gICAgICAgICB0aGlzLkZyZWVOb2RlKG5vZGUyKTtcclxuICAgICAgICAgd2hpbGUgKG5vZGUxKSB7XHJcbiAgICAgICAgICAgIHZhciBvbGRBQUJCID0gbm9kZTEuYWFiYjtcclxuICAgICAgICAgICAgbm9kZTEuYWFiYiA9IGIyQUFCQi5Db21iaW5lKG5vZGUxLmNoaWxkMS5hYWJiLCBub2RlMS5jaGlsZDIuYWFiYik7XHJcbiAgICAgICAgICAgIGlmIChvbGRBQUJCLkNvbnRhaW5zKG5vZGUxLmFhYmIpKSBicmVhaztcclxuICAgICAgICAgICAgbm9kZTEgPSBub2RlMS5wYXJlbnQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX3Jvb3QgPSBzaWJsaW5nO1xyXG4gICAgICAgICBzaWJsaW5nLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgIHRoaXMuRnJlZU5vZGUobm9kZTIpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UuYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV90cmVlID0gbmV3IGIyRHluYW1pY1RyZWUoKTtcclxuICAgICAgdGhpcy5tX21vdmVCdWZmZXIgPSBuZXcgVmVjdG9yKCk7XHJcbiAgICAgIHRoaXMubV9wYWlyQnVmZmVyID0gbmV3IFZlY3RvcigpO1xyXG4gICAgICB0aGlzLm1fcGFpckNvdW50ID0gMDtcclxuICAgfTtcclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLkNyZWF0ZVByb3h5ID0gZnVuY3Rpb24gKGFhYmIsIHVzZXJEYXRhKSB7XHJcbiAgICAgIHZhciBwcm94eSA9IHRoaXMubV90cmVlLkNyZWF0ZVByb3h5KGFhYmIsIHVzZXJEYXRhKTtcclxuICAgICAgKyt0aGlzLm1fcHJveHlDb3VudDtcclxuICAgICAgdGhpcy5CdWZmZXJNb3ZlKHByb3h5KTtcclxuICAgICAgcmV0dXJuIHByb3h5O1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5EZXN0cm95UHJveHkgPSBmdW5jdGlvbiAocHJveHkpIHtcclxuICAgICAgdGhpcy5VbkJ1ZmZlck1vdmUocHJveHkpO1xyXG4gICAgICAtLXRoaXMubV9wcm94eUNvdW50O1xyXG4gICAgICB0aGlzLm1fdHJlZS5EZXN0cm95UHJveHkocHJveHkpO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5Nb3ZlUHJveHkgPSBmdW5jdGlvbiAocHJveHksIGFhYmIsIGRpc3BsYWNlbWVudCkge1xyXG4gICAgICB2YXIgYnVmZmVyID0gdGhpcy5tX3RyZWUuTW92ZVByb3h5KHByb3h5LCBhYWJiLCBkaXNwbGFjZW1lbnQpO1xyXG4gICAgICBpZiAoYnVmZmVyKSB7XHJcbiAgICAgICAgIHRoaXMuQnVmZmVyTW92ZShwcm94eSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuVGVzdE92ZXJsYXAgPSBmdW5jdGlvbiAocHJveHlBLCBwcm94eUIpIHtcclxuICAgICAgdmFyIGFhYmJBID0gdGhpcy5tX3RyZWUuR2V0RmF0QUFCQihwcm94eUEpO1xyXG4gICAgICB2YXIgYWFiYkIgPSB0aGlzLm1fdHJlZS5HZXRGYXRBQUJCKHByb3h5Qik7XHJcbiAgICAgIHJldHVybiBhYWJiQS5UZXN0T3ZlcmxhcChhYWJiQik7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLkdldFVzZXJEYXRhID0gZnVuY3Rpb24gKHByb3h5KSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5HZXRVc2VyRGF0YShwcm94eSk7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLkdldEZhdEFBQkIgPSBmdW5jdGlvbiAocHJveHkpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV90cmVlLkdldEZhdEFBQkIocHJveHkpO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5HZXRQcm94eUNvdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3Byb3h5Q291bnQ7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLlVwZGF0ZVBhaXJzID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgIHZhciBfX3RoaXMgPSB0aGlzO1xyXG4gICAgICBfX3RoaXMubV9wYWlyQ291bnQgPSAwO1xyXG4gICAgICB2YXIgaSA9IDAsXHJcbiAgICAgICAgIHF1ZXJ5UHJveHk7XHJcbiAgICAgICBmdW5jdGlvbiBRdWVyeUNhbGxiYWNrKHByb3h5KSB7XHJcbiAgICAgICAgICBpZiAocHJveHkgPT0gcXVlcnlQcm94eSkgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICBpZiAoX190aGlzLm1fcGFpckNvdW50ID09IF9fdGhpcy5tX3BhaXJCdWZmZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICBfX3RoaXMubV9wYWlyQnVmZmVyW19fdGhpcy5tX3BhaXJDb3VudF0gPSBuZXcgYjJEeW5hbWljVHJlZVBhaXIoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHZhciBwYWlyID0gX190aGlzLm1fcGFpckJ1ZmZlcltfX3RoaXMubV9wYWlyQ291bnRdO1xyXG4gICAgICAgICAgcGFpci5wcm94eUEgPSBwcm94eSA8IHF1ZXJ5UHJveHkgPyBwcm94eSA6IHF1ZXJ5UHJveHk7XHJcbiAgICAgICAgICBwYWlyLnByb3h5QiA9IHByb3h5ID49IHF1ZXJ5UHJveHkgPyBwcm94eSA6IHF1ZXJ5UHJveHk7KytfX3RoaXMubV9wYWlyQ291bnQ7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgIH07XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCBfX3RoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgIHF1ZXJ5UHJveHkgPSBfX3RoaXMubV9tb3ZlQnVmZmVyW2ldO1xyXG4gICAgICAgICB2YXIgZmF0QUFCQiA9IF9fdGhpcy5tX3RyZWUuR2V0RmF0QUFCQihxdWVyeVByb3h5KTtcclxuICAgICAgICAgX190aGlzLm1fdHJlZS5RdWVyeShRdWVyeUNhbGxiYWNrLCBmYXRBQUJCKTtcclxuICAgICAgfVxyXG4gICAgICBfX3RoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aCA9IDA7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgX190aGlzLm1fcGFpckNvdW50Oykge1xyXG4gICAgICAgICB2YXIgcHJpbWFyeVBhaXIgPSBfX3RoaXMubV9wYWlyQnVmZmVyW2ldO1xyXG4gICAgICAgICB2YXIgdXNlckRhdGFBID0gX190aGlzLm1fdHJlZS5HZXRVc2VyRGF0YShwcmltYXJ5UGFpci5wcm94eUEpO1xyXG4gICAgICAgICB2YXIgdXNlckRhdGFCID0gX190aGlzLm1fdHJlZS5HZXRVc2VyRGF0YShwcmltYXJ5UGFpci5wcm94eUIpO1xyXG4gICAgICAgICBjYWxsYmFjayh1c2VyRGF0YUEsIHVzZXJEYXRhQik7XHJcbiAgICAgICAgICsraTtcclxuICAgICAgICAgd2hpbGUgKGkgPCBfX3RoaXMubV9wYWlyQ291bnQpIHtcclxuICAgICAgICAgICAgdmFyIHBhaXIgPSBfX3RoaXMubV9wYWlyQnVmZmVyW2ldO1xyXG4gICAgICAgICAgICBpZiAocGFpci5wcm94eUEgIT0gcHJpbWFyeVBhaXIucHJveHlBIHx8IHBhaXIucHJveHlCICE9IHByaW1hcnlQYWlyLnByb3h5Qikge1xyXG4gICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfSsraTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLlF1ZXJ5ID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBhYWJiKSB7XHJcbiAgICAgIHRoaXMubV90cmVlLlF1ZXJ5KGNhbGxiYWNrLCBhYWJiKTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgaW5wdXQpIHtcclxuICAgICAgdGhpcy5tX3RyZWUuUmF5Q2FzdChjYWxsYmFjaywgaW5wdXQpO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5WYWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHt9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5SZWJhbGFuY2UgPSBmdW5jdGlvbiAoaXRlcmF0aW9ucykge1xyXG4gICAgICBpZiAoaXRlcmF0aW9ucyA9PT0gdW5kZWZpbmVkKSBpdGVyYXRpb25zID0gMDtcclxuICAgICAgdGhpcy5tX3RyZWUuUmViYWxhbmNlKGl0ZXJhdGlvbnMpO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5CdWZmZXJNb3ZlID0gZnVuY3Rpb24gKHByb3h5KSB7XHJcbiAgICAgIHRoaXMubV9tb3ZlQnVmZmVyW3RoaXMubV9tb3ZlQnVmZmVyLmxlbmd0aF0gPSBwcm94eTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuVW5CdWZmZXJNb3ZlID0gZnVuY3Rpb24gKHByb3h5KSB7XHJcbiAgICAgIHZhciBpID0gcGFyc2VJbnQodGhpcy5tX21vdmVCdWZmZXIuaW5kZXhPZihwcm94eSkpO1xyXG4gICAgICB0aGlzLm1fbW92ZUJ1ZmZlci5zcGxpY2UoaSwgMSk7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLkNvbXBhcmVQYWlycyA9IGZ1bmN0aW9uIChwYWlyMSwgcGFpcjIpIHtcclxuICAgICAgcmV0dXJuIDA7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UuX19pbXBsZW1lbnRzID0ge307XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLl9faW1wbGVtZW50c1tJQnJvYWRQaGFzZV0gPSB0cnVlO1xyXG4gICBiMkR5bmFtaWNUcmVlTm9kZS5iMkR5bmFtaWNUcmVlTm9kZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5hYWJiID0gbmV3IGIyQUFCQigpO1xyXG4gICB9O1xyXG4gICBiMkR5bmFtaWNUcmVlTm9kZS5wcm90b3R5cGUuSXNMZWFmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5jaGlsZDEgPT0gbnVsbDtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlUGFpci5iMkR5bmFtaWNUcmVlUGFpciA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMk1hbmlmb2xkLmIyTWFuaWZvbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9wb2ludENvdW50ID0gMDtcclxuICAgfTtcclxuICAgYjJNYW5pZm9sZC5wcm90b3R5cGUuYjJNYW5pZm9sZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3BvaW50cyA9IG5ldyBWZWN0b3IoYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50czsgaSsrKSB7XHJcbiAgICAgICAgIHRoaXMubV9wb2ludHNbaV0gPSBuZXcgYjJNYW5pZm9sZFBvaW50KCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2xvY2FsUGxhbmVOb3JtYWwgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbFBvaW50ID0gbmV3IGIyVmVjMigpO1xyXG4gICB9XHJcbiAgIGIyTWFuaWZvbGQucHJvdG90eXBlLlJlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7IGkrKykge1xyXG4gICAgICAgICAoKHRoaXMubV9wb2ludHNbaV0gaW5zdGFuY2VvZiBiMk1hbmlmb2xkUG9pbnQgPyB0aGlzLm1fcG9pbnRzW2ldIDogbnVsbCkpLlJlc2V0KCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2xvY2FsUGxhbmVOb3JtYWwuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxQb2ludC5TZXRaZXJvKCk7XHJcbiAgICAgIHRoaXMubV90eXBlID0gMDtcclxuICAgICAgdGhpcy5tX3BvaW50Q291bnQgPSAwO1xyXG4gICB9XHJcbiAgIGIyTWFuaWZvbGQucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgIHRoaXMubV9wb2ludENvdW50ID0gbS5tX3BvaW50Q291bnQ7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50czsgaSsrKSB7XHJcbiAgICAgICAgICgodGhpcy5tX3BvaW50c1tpXSBpbnN0YW5jZW9mIGIyTWFuaWZvbGRQb2ludCA/IHRoaXMubV9wb2ludHNbaV0gOiBudWxsKSkuU2V0KG0ubV9wb2ludHNbaV0pO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9sb2NhbFBsYW5lTm9ybWFsLlNldFYobS5tX2xvY2FsUGxhbmVOb3JtYWwpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxQb2ludC5TZXRWKG0ubV9sb2NhbFBvaW50KTtcclxuICAgICAgdGhpcy5tX3R5cGUgPSBtLm1fdHlwZTtcclxuICAgfVxyXG4gICBiMk1hbmlmb2xkLnByb3RvdHlwZS5Db3B5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgY29weSA9IG5ldyBiMk1hbmlmb2xkKCk7XHJcbiAgICAgIGNvcHkuU2V0KHRoaXMpO1xyXG4gICAgICByZXR1cm4gY29weTtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGQuZV9jaXJjbGVzID0gMHgwMDAxO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZC5lX2ZhY2VBID0gMHgwMDAyO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZC5lX2ZhY2VCID0gMHgwMDA0O1xyXG4gICB9KTtcclxuICAgYjJNYW5pZm9sZFBvaW50LmIyTWFuaWZvbGRQb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX2xvY2FsUG9pbnQgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9pZCA9IG5ldyBiMkNvbnRhY3RJRCgpO1xyXG4gICB9O1xyXG4gICBiMk1hbmlmb2xkUG9pbnQucHJvdG90eXBlLmIyTWFuaWZvbGRQb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5SZXNldCgpO1xyXG4gICB9XHJcbiAgIGIyTWFuaWZvbGRQb2ludC5wcm90b3R5cGUuUmVzZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9sb2NhbFBvaW50LlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX25vcm1hbEltcHVsc2UgPSAwLjA7XHJcbiAgICAgIHRoaXMubV90YW5nZW50SW1wdWxzZSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2lkLmtleSA9IDA7XHJcbiAgIH1cclxuICAgYjJNYW5pZm9sZFBvaW50LnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAobSkge1xyXG4gICAgICB0aGlzLm1fbG9jYWxQb2ludC5TZXRWKG0ubV9sb2NhbFBvaW50KTtcclxuICAgICAgdGhpcy5tX25vcm1hbEltcHVsc2UgPSBtLm1fbm9ybWFsSW1wdWxzZTtcclxuICAgICAgdGhpcy5tX3RhbmdlbnRJbXB1bHNlID0gbS5tX3RhbmdlbnRJbXB1bHNlO1xyXG4gICAgICB0aGlzLm1faWQuU2V0KG0ubV9pZCk7XHJcbiAgIH1cclxuICAgYjJQb2ludC5iMlBvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnAgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyUG9pbnQucHJvdG90eXBlLlN1cHBvcnQgPSBmdW5jdGlvbiAoeGYsIHZYLCB2WSkge1xyXG4gICAgICBpZiAodlggPT09IHVuZGVmaW5lZCkgdlggPSAwO1xyXG4gICAgICBpZiAodlkgPT09IHVuZGVmaW5lZCkgdlkgPSAwO1xyXG4gICAgICByZXR1cm4gdGhpcy5wO1xyXG4gICB9XHJcbiAgIGIyUG9pbnQucHJvdG90eXBlLkdldEZpcnN0VmVydGV4ID0gZnVuY3Rpb24gKHhmKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnA7XHJcbiAgIH1cclxuICAgYjJSYXlDYXN0SW5wdXQuYjJSYXlDYXN0SW5wdXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMucDEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMucDIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyUmF5Q2FzdElucHV0LnByb3RvdHlwZS5iMlJheUNhc3RJbnB1dCA9IGZ1bmN0aW9uIChwMSwgcDIsIG1heEZyYWN0aW9uKSB7XHJcbiAgICAgIGlmIChwMSA9PT0gdW5kZWZpbmVkKSBwMSA9IG51bGw7XHJcbiAgICAgIGlmIChwMiA9PT0gdW5kZWZpbmVkKSBwMiA9IG51bGw7XHJcbiAgICAgIGlmIChtYXhGcmFjdGlvbiA9PT0gdW5kZWZpbmVkKSBtYXhGcmFjdGlvbiA9IDE7XHJcbiAgICAgIGlmIChwMSkgdGhpcy5wMS5TZXRWKHAxKTtcclxuICAgICAgaWYgKHAyKSB0aGlzLnAyLlNldFYocDIpO1xyXG4gICAgICB0aGlzLm1heEZyYWN0aW9uID0gbWF4RnJhY3Rpb247XHJcbiAgIH1cclxuICAgYjJSYXlDYXN0T3V0cHV0LmIyUmF5Q2FzdE91dHB1dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5ub3JtYWwgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyU2VnbWVudC5iMlNlZ21lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMucDEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMucDIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyU2VnbWVudC5wcm90b3R5cGUuVGVzdFNlZ21lbnQgPSBmdW5jdGlvbiAobGFtYmRhLCBub3JtYWwsIHNlZ21lbnQsIG1heExhbWJkYSkge1xyXG4gICAgICBpZiAobWF4TGFtYmRhID09PSB1bmRlZmluZWQpIG1heExhbWJkYSA9IDA7XHJcbiAgICAgIHZhciBzID0gc2VnbWVudC5wMTtcclxuICAgICAgdmFyIHJYID0gc2VnbWVudC5wMi54IC0gcy54O1xyXG4gICAgICB2YXIgclkgPSBzZWdtZW50LnAyLnkgLSBzLnk7XHJcbiAgICAgIHZhciBkWCA9IHRoaXMucDIueCAtIHRoaXMucDEueDtcclxuICAgICAgdmFyIGRZID0gdGhpcy5wMi55IC0gdGhpcy5wMS55O1xyXG4gICAgICB2YXIgblggPSBkWTtcclxuICAgICAgdmFyIG5ZID0gKC1kWCk7XHJcbiAgICAgIHZhciBrX3Nsb3AgPSAxMDAuMCAqIE51bWJlci5NSU5fVkFMVUU7XHJcbiAgICAgIHZhciBkZW5vbSA9ICgtKHJYICogblggKyByWSAqIG5ZKSk7XHJcbiAgICAgIGlmIChkZW5vbSA+IGtfc2xvcCkge1xyXG4gICAgICAgICB2YXIgYlggPSBzLnggLSB0aGlzLnAxLng7XHJcbiAgICAgICAgIHZhciBiWSA9IHMueSAtIHRoaXMucDEueTtcclxuICAgICAgICAgdmFyIGEgPSAoYlggKiBuWCArIGJZICogblkpO1xyXG4gICAgICAgICBpZiAoMC4wIDw9IGEgJiYgYSA8PSBtYXhMYW1iZGEgKiBkZW5vbSkge1xyXG4gICAgICAgICAgICB2YXIgbXUyID0gKC1yWCAqIGJZKSArIHJZICogYlg7XHJcbiAgICAgICAgICAgIGlmICgoLWtfc2xvcCAqIGRlbm9tKSA8PSBtdTIgJiYgbXUyIDw9IGRlbm9tICogKDEuMCArIGtfc2xvcCkpIHtcclxuICAgICAgICAgICAgICAgYSAvPSBkZW5vbTtcclxuICAgICAgICAgICAgICAgdmFyIG5MZW4gPSBNYXRoLnNxcnQoblggKiBuWCArIG5ZICogblkpO1xyXG4gICAgICAgICAgICAgICBuWCAvPSBuTGVuO1xyXG4gICAgICAgICAgICAgICBuWSAvPSBuTGVuO1xyXG4gICAgICAgICAgICAgICBsYW1iZGFbMF0gPSBhO1xyXG4gICAgICAgICAgICAgICBub3JtYWwuU2V0KG5YLCBuWSk7XHJcbiAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgIH1cclxuICAgYjJTZWdtZW50LnByb3RvdHlwZS5FeHRlbmQgPSBmdW5jdGlvbiAoYWFiYikge1xyXG4gICAgICB0aGlzLkV4dGVuZEZvcndhcmQoYWFiYik7XHJcbiAgICAgIHRoaXMuRXh0ZW5kQmFja3dhcmQoYWFiYik7XHJcbiAgIH1cclxuICAgYjJTZWdtZW50LnByb3RvdHlwZS5FeHRlbmRGb3J3YXJkID0gZnVuY3Rpb24gKGFhYmIpIHtcclxuICAgICAgdmFyIGRYID0gdGhpcy5wMi54IC0gdGhpcy5wMS54O1xyXG4gICAgICB2YXIgZFkgPSB0aGlzLnAyLnkgLSB0aGlzLnAxLnk7XHJcbiAgICAgIHZhciBsYW1iZGEgPSBNYXRoLm1pbihkWCA+IDAgPyAoYWFiYi51cHBlckJvdW5kLnggLSB0aGlzLnAxLngpIC8gZFggOiBkWCA8IDAgPyAoYWFiYi5sb3dlckJvdW5kLnggLSB0aGlzLnAxLngpIC8gZFggOiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksXHJcbiAgICAgIGRZID4gMCA/IChhYWJiLnVwcGVyQm91bmQueSAtIHRoaXMucDEueSkgLyBkWSA6IGRZIDwgMCA/IChhYWJiLmxvd2VyQm91bmQueSAtIHRoaXMucDEueSkgLyBkWSA6IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSk7XHJcbiAgICAgIHRoaXMucDIueCA9IHRoaXMucDEueCArIGRYICogbGFtYmRhO1xyXG4gICAgICB0aGlzLnAyLnkgPSB0aGlzLnAxLnkgKyBkWSAqIGxhbWJkYTtcclxuICAgfVxyXG4gICBiMlNlZ21lbnQucHJvdG90eXBlLkV4dGVuZEJhY2t3YXJkID0gZnVuY3Rpb24gKGFhYmIpIHtcclxuICAgICAgdmFyIGRYID0gKC10aGlzLnAyLngpICsgdGhpcy5wMS54O1xyXG4gICAgICB2YXIgZFkgPSAoLXRoaXMucDIueSkgKyB0aGlzLnAxLnk7XHJcbiAgICAgIHZhciBsYW1iZGEgPSBNYXRoLm1pbihkWCA+IDAgPyAoYWFiYi51cHBlckJvdW5kLnggLSB0aGlzLnAyLngpIC8gZFggOiBkWCA8IDAgPyAoYWFiYi5sb3dlckJvdW5kLnggLSB0aGlzLnAyLngpIC8gZFggOiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksXHJcbiAgICAgIGRZID4gMCA/IChhYWJiLnVwcGVyQm91bmQueSAtIHRoaXMucDIueSkgLyBkWSA6IGRZIDwgMCA/IChhYWJiLmxvd2VyQm91bmQueSAtIHRoaXMucDIueSkgLyBkWSA6IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSk7XHJcbiAgICAgIHRoaXMucDEueCA9IHRoaXMucDIueCArIGRYICogbGFtYmRhO1xyXG4gICAgICB0aGlzLnAxLnkgPSB0aGlzLnAyLnkgKyBkWSAqIGxhbWJkYTtcclxuICAgfVxyXG4gICBiMlNlcGFyYXRpb25GdW5jdGlvbi5iMlNlcGFyYXRpb25GdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX2xvY2FsUG9pbnQgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9heGlzID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMlNlcGFyYXRpb25GdW5jdGlvbi5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChjYWNoZSwgcHJveHlBLCB0cmFuc2Zvcm1BLCBwcm94eUIsIHRyYW5zZm9ybUIpIHtcclxuICAgICAgdGhpcy5tX3Byb3h5QSA9IHByb3h5QTtcclxuICAgICAgdGhpcy5tX3Byb3h5QiA9IHByb3h5QjtcclxuICAgICAgdmFyIGNvdW50ID0gcGFyc2VJbnQoY2FjaGUuY291bnQpO1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KDAgPCBjb3VudCAmJiBjb3VudCA8IDMpO1xyXG4gICAgICB2YXIgbG9jYWxQb2ludEE7XHJcbiAgICAgIHZhciBsb2NhbFBvaW50QTE7XHJcbiAgICAgIHZhciBsb2NhbFBvaW50QTI7XHJcbiAgICAgIHZhciBsb2NhbFBvaW50QjtcclxuICAgICAgdmFyIGxvY2FsUG9pbnRCMTtcclxuICAgICAgdmFyIGxvY2FsUG9pbnRCMjtcclxuICAgICAgdmFyIHBvaW50QVggPSAwO1xyXG4gICAgICB2YXIgcG9pbnRBWSA9IDA7XHJcbiAgICAgIHZhciBwb2ludEJYID0gMDtcclxuICAgICAgdmFyIHBvaW50QlkgPSAwO1xyXG4gICAgICB2YXIgbm9ybWFsWCA9IDA7XHJcbiAgICAgIHZhciBub3JtYWxZID0gMDtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICB2YXIgcyA9IDA7XHJcbiAgICAgIHZhciBzZ24gPSAwO1xyXG4gICAgICBpZiAoY291bnQgPT0gMSkge1xyXG4gICAgICAgICB0aGlzLm1fdHlwZSA9IGIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfcG9pbnRzO1xyXG4gICAgICAgICBsb2NhbFBvaW50QSA9IHRoaXMubV9wcm94eUEuR2V0VmVydGV4KGNhY2hlLmluZGV4QVswXSk7XHJcbiAgICAgICAgIGxvY2FsUG9pbnRCID0gdGhpcy5tX3Byb3h5Qi5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhCWzBdKTtcclxuICAgICAgICAgdFZlYyA9IGxvY2FsUG9pbnRBO1xyXG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQS5SO1xyXG4gICAgICAgICBwb2ludEFYID0gdHJhbnNmb3JtQS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICBwb2ludEFZID0gdHJhbnNmb3JtQS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICB0VmVjID0gbG9jYWxQb2ludEI7XHJcbiAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1CLlI7XHJcbiAgICAgICAgIHBvaW50QlggPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgIHBvaW50QlkgPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgIHRoaXMubV9heGlzLnggPSBwb2ludEJYIC0gcG9pbnRBWDtcclxuICAgICAgICAgdGhpcy5tX2F4aXMueSA9IHBvaW50QlkgLSBwb2ludEFZO1xyXG4gICAgICAgICB0aGlzLm1fYXhpcy5Ob3JtYWxpemUoKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmIChjYWNoZS5pbmRleEJbMF0gPT0gY2FjaGUuaW5kZXhCWzFdKSB7XHJcbiAgICAgICAgIHRoaXMubV90eXBlID0gYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQTtcclxuICAgICAgICAgbG9jYWxQb2ludEExID0gdGhpcy5tX3Byb3h5QS5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhBWzBdKTtcclxuICAgICAgICAgbG9jYWxQb2ludEEyID0gdGhpcy5tX3Byb3h5QS5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhBWzFdKTtcclxuICAgICAgICAgbG9jYWxQb2ludEIgPSB0aGlzLm1fcHJveHlCLkdldFZlcnRleChjYWNoZS5pbmRleEJbMF0pO1xyXG4gICAgICAgICB0aGlzLm1fbG9jYWxQb2ludC54ID0gMC41ICogKGxvY2FsUG9pbnRBMS54ICsgbG9jYWxQb2ludEEyLngpO1xyXG4gICAgICAgICB0aGlzLm1fbG9jYWxQb2ludC55ID0gMC41ICogKGxvY2FsUG9pbnRBMS55ICsgbG9jYWxQb2ludEEyLnkpO1xyXG4gICAgICAgICB0aGlzLm1fYXhpcyA9IGIyTWF0aC5Dcm9zc1ZGKGIyTWF0aC5TdWJ0cmFjdFZWKGxvY2FsUG9pbnRBMiwgbG9jYWxQb2ludEExKSwgMS4wKTtcclxuICAgICAgICAgdGhpcy5tX2F4aXMuTm9ybWFsaXplKCk7XHJcbiAgICAgICAgIHRWZWMgPSB0aGlzLm1fYXhpcztcclxuICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUEuUjtcclxuICAgICAgICAgbm9ybWFsWCA9IHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XHJcbiAgICAgICAgIG5vcm1hbFkgPSB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICB0VmVjID0gdGhpcy5tX2xvY2FsUG9pbnQ7XHJcbiAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1BLlI7XHJcbiAgICAgICAgIHBvaW50QVggPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgIHBvaW50QVkgPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgIHRWZWMgPSBsb2NhbFBvaW50QjtcclxuICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUIuUjtcclxuICAgICAgICAgcG9pbnRCWCA9IHRyYW5zZm9ybUIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgcG9pbnRCWSA9IHRyYW5zZm9ybUIucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgcyA9IChwb2ludEJYIC0gcG9pbnRBWCkgKiBub3JtYWxYICsgKHBvaW50QlkgLSBwb2ludEFZKSAqIG5vcm1hbFk7XHJcbiAgICAgICAgIGlmIChzIDwgMC4wKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9heGlzLk5lZ2F0aXZlU2VsZigpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoY2FjaGUuaW5kZXhBWzBdID09IGNhY2hlLmluZGV4QVswXSkge1xyXG4gICAgICAgICB0aGlzLm1fdHlwZSA9IGIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfZmFjZUI7XHJcbiAgICAgICAgIGxvY2FsUG9pbnRCMSA9IHRoaXMubV9wcm94eUIuR2V0VmVydGV4KGNhY2hlLmluZGV4QlswXSk7XHJcbiAgICAgICAgIGxvY2FsUG9pbnRCMiA9IHRoaXMubV9wcm94eUIuR2V0VmVydGV4KGNhY2hlLmluZGV4QlsxXSk7XHJcbiAgICAgICAgIGxvY2FsUG9pbnRBID0gdGhpcy5tX3Byb3h5QS5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhBWzBdKTtcclxuICAgICAgICAgdGhpcy5tX2xvY2FsUG9pbnQueCA9IDAuNSAqIChsb2NhbFBvaW50QjEueCArIGxvY2FsUG9pbnRCMi54KTtcclxuICAgICAgICAgdGhpcy5tX2xvY2FsUG9pbnQueSA9IDAuNSAqIChsb2NhbFBvaW50QjEueSArIGxvY2FsUG9pbnRCMi55KTtcclxuICAgICAgICAgdGhpcy5tX2F4aXMgPSBiMk1hdGguQ3Jvc3NWRihiMk1hdGguU3VidHJhY3RWVihsb2NhbFBvaW50QjIsIGxvY2FsUG9pbnRCMSksIDEuMCk7XHJcbiAgICAgICAgIHRoaXMubV9heGlzLk5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICB0VmVjID0gdGhpcy5tX2F4aXM7XHJcbiAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1CLlI7XHJcbiAgICAgICAgIG5vcm1hbFggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICBub3JtYWxZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgdFZlYyA9IHRoaXMubV9sb2NhbFBvaW50O1xyXG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQi5SO1xyXG4gICAgICAgICBwb2ludEJYID0gdHJhbnNmb3JtQi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICBwb2ludEJZID0gdHJhbnNmb3JtQi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICB0VmVjID0gbG9jYWxQb2ludEE7XHJcbiAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1BLlI7XHJcbiAgICAgICAgIHBvaW50QVggPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgIHBvaW50QVkgPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgIHMgPSAocG9pbnRBWCAtIHBvaW50QlgpICogbm9ybWFsWCArIChwb2ludEFZIC0gcG9pbnRCWSkgKiBub3JtYWxZO1xyXG4gICAgICAgICBpZiAocyA8IDAuMCkge1xyXG4gICAgICAgICAgICB0aGlzLm1fYXhpcy5OZWdhdGl2ZVNlbGYoKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBsb2NhbFBvaW50QTEgPSB0aGlzLm1fcHJveHlBLkdldFZlcnRleChjYWNoZS5pbmRleEFbMF0pO1xyXG4gICAgICAgICBsb2NhbFBvaW50QTIgPSB0aGlzLm1fcHJveHlBLkdldFZlcnRleChjYWNoZS5pbmRleEFbMV0pO1xyXG4gICAgICAgICBsb2NhbFBvaW50QjEgPSB0aGlzLm1fcHJveHlCLkdldFZlcnRleChjYWNoZS5pbmRleEJbMF0pO1xyXG4gICAgICAgICBsb2NhbFBvaW50QjIgPSB0aGlzLm1fcHJveHlCLkdldFZlcnRleChjYWNoZS5pbmRleEJbMV0pO1xyXG4gICAgICAgICB2YXIgcEEgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1BLCBsb2NhbFBvaW50QSk7XHJcbiAgICAgICAgIHZhciBkQSA9IGIyTWF0aC5NdWxNVih0cmFuc2Zvcm1BLlIsIGIyTWF0aC5TdWJ0cmFjdFZWKGxvY2FsUG9pbnRBMiwgbG9jYWxQb2ludEExKSk7XHJcbiAgICAgICAgIHZhciBwQiA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUIsIGxvY2FsUG9pbnRCKTtcclxuICAgICAgICAgdmFyIGRCID0gYjJNYXRoLk11bE1WKHRyYW5zZm9ybUIuUiwgYjJNYXRoLlN1YnRyYWN0VlYobG9jYWxQb2ludEIyLCBsb2NhbFBvaW50QjEpKTtcclxuICAgICAgICAgdmFyIGEgPSBkQS54ICogZEEueCArIGRBLnkgKiBkQS55O1xyXG4gICAgICAgICB2YXIgZSA9IGRCLnggKiBkQi54ICsgZEIueSAqIGRCLnk7XHJcbiAgICAgICAgIHZhciByID0gYjJNYXRoLlN1YnRyYWN0VlYoZEIsIGRBKTtcclxuICAgICAgICAgdmFyIGMgPSBkQS54ICogci54ICsgZEEueSAqIHIueTtcclxuICAgICAgICAgdmFyIGYgPSBkQi54ICogci54ICsgZEIueSAqIHIueTtcclxuICAgICAgICAgdmFyIGIgPSBkQS54ICogZEIueCArIGRBLnkgKiBkQi55O1xyXG4gICAgICAgICB2YXIgZGVub20gPSBhICogZSAtIGIgKiBiO1xyXG4gICAgICAgICBzID0gMC4wO1xyXG4gICAgICAgICBpZiAoZGVub20gIT0gMC4wKSB7XHJcbiAgICAgICAgICAgIHMgPSBiMk1hdGguQ2xhbXAoKGIgKiBmIC0gYyAqIGUpIC8gZGVub20sIDAuMCwgMS4wKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgdCA9IChiICogcyArIGYpIC8gZTtcclxuICAgICAgICAgaWYgKHQgPCAwLjApIHtcclxuICAgICAgICAgICAgdCA9IDAuMDtcclxuICAgICAgICAgICAgcyA9IGIyTWF0aC5DbGFtcCgoYiAtIGMpIC8gYSwgMC4wLCAxLjApO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGxvY2FsUG9pbnRBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICAgICBsb2NhbFBvaW50QS54ID0gbG9jYWxQb2ludEExLnggKyBzICogKGxvY2FsUG9pbnRBMi54IC0gbG9jYWxQb2ludEExLngpO1xyXG4gICAgICAgICBsb2NhbFBvaW50QS55ID0gbG9jYWxQb2ludEExLnkgKyBzICogKGxvY2FsUG9pbnRBMi55IC0gbG9jYWxQb2ludEExLnkpO1xyXG4gICAgICAgICBsb2NhbFBvaW50QiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgICAgbG9jYWxQb2ludEIueCA9IGxvY2FsUG9pbnRCMS54ICsgcyAqIChsb2NhbFBvaW50QjIueCAtIGxvY2FsUG9pbnRCMS54KTtcclxuICAgICAgICAgbG9jYWxQb2ludEIueSA9IGxvY2FsUG9pbnRCMS55ICsgcyAqIChsb2NhbFBvaW50QjIueSAtIGxvY2FsUG9pbnRCMS55KTtcclxuICAgICAgICAgaWYgKHMgPT0gMC4wIHx8IHMgPT0gMS4wKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV90eXBlID0gYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQjtcclxuICAgICAgICAgICAgdGhpcy5tX2F4aXMgPSBiMk1hdGguQ3Jvc3NWRihiMk1hdGguU3VidHJhY3RWVihsb2NhbFBvaW50QjIsIGxvY2FsUG9pbnRCMSksIDEuMCk7XHJcbiAgICAgICAgICAgIHRoaXMubV9heGlzLk5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICB0aGlzLm1fbG9jYWxQb2ludCA9IGxvY2FsUG9pbnRCO1xyXG4gICAgICAgICAgICB0VmVjID0gdGhpcy5tX2F4aXM7XHJcbiAgICAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1CLlI7XHJcbiAgICAgICAgICAgIG5vcm1hbFggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICBub3JtYWxZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgICAgdFZlYyA9IHRoaXMubV9sb2NhbFBvaW50O1xyXG4gICAgICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQi5SO1xyXG4gICAgICAgICAgICBwb2ludEJYID0gdHJhbnNmb3JtQi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICBwb2ludEJZID0gdHJhbnNmb3JtQi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICB0VmVjID0gbG9jYWxQb2ludEE7XHJcbiAgICAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1BLlI7XHJcbiAgICAgICAgICAgIHBvaW50QVggPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHBvaW50QVkgPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHNnbiA9IChwb2ludEFYIC0gcG9pbnRCWCkgKiBub3JtYWxYICsgKHBvaW50QVkgLSBwb2ludEJZKSAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgIGlmIChzIDwgMC4wKSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9heGlzLk5lZ2F0aXZlU2VsZigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubV90eXBlID0gYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQTtcclxuICAgICAgICAgICAgdGhpcy5tX2F4aXMgPSBiMk1hdGguQ3Jvc3NWRihiMk1hdGguU3VidHJhY3RWVihsb2NhbFBvaW50QTIsIGxvY2FsUG9pbnRBMSksIDEuMCk7XHJcbiAgICAgICAgICAgIHRoaXMubV9sb2NhbFBvaW50ID0gbG9jYWxQb2ludEE7XHJcbiAgICAgICAgICAgIHRWZWMgPSB0aGlzLm1fYXhpcztcclxuICAgICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUEuUjtcclxuICAgICAgICAgICAgbm9ybWFsWCA9IHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIG5vcm1hbFkgPSB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICAgICB0VmVjID0gdGhpcy5tX2xvY2FsUG9pbnQ7XHJcbiAgICAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1BLlI7XHJcbiAgICAgICAgICAgIHBvaW50QVggPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHBvaW50QVkgPSB0cmFuc2Zvcm1BLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHRWZWMgPSBsb2NhbFBvaW50QjtcclxuICAgICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUIuUjtcclxuICAgICAgICAgICAgcG9pbnRCWCA9IHRyYW5zZm9ybUIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgICAgcG9pbnRCWSA9IHRyYW5zZm9ybUIucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgICAgc2duID0gKHBvaW50QlggLSBwb2ludEFYKSAqIG5vcm1hbFggKyAocG9pbnRCWSAtIHBvaW50QVkpICogbm9ybWFsWTtcclxuICAgICAgICAgICAgaWYgKHMgPCAwLjApIHtcclxuICAgICAgICAgICAgICAgdGhpcy5tX2F4aXMuTmVnYXRpdmVTZWxmKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24ucHJvdG90eXBlLkV2YWx1YXRlID0gZnVuY3Rpb24gKHRyYW5zZm9ybUEsIHRyYW5zZm9ybUIpIHtcclxuICAgICAgdmFyIGF4aXNBO1xyXG4gICAgICB2YXIgYXhpc0I7XHJcbiAgICAgIHZhciBsb2NhbFBvaW50QTtcclxuICAgICAgdmFyIGxvY2FsUG9pbnRCO1xyXG4gICAgICB2YXIgcG9pbnRBO1xyXG4gICAgICB2YXIgcG9pbnRCO1xyXG4gICAgICB2YXIgc2VwZXJhdGlvbiA9IDA7XHJcbiAgICAgIHZhciBub3JtYWw7XHJcbiAgICAgIHN3aXRjaCAodGhpcy5tX3R5cGUpIHtcclxuICAgICAgY2FzZSBiMlNlcGFyYXRpb25GdW5jdGlvbi5lX3BvaW50czpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBheGlzQSA9IGIyTWF0aC5NdWxUTVYodHJhbnNmb3JtQS5SLCB0aGlzLm1fYXhpcyk7XHJcbiAgICAgICAgICAgIGF4aXNCID0gYjJNYXRoLk11bFRNVih0cmFuc2Zvcm1CLlIsIHRoaXMubV9heGlzLkdldE5lZ2F0aXZlKCkpO1xyXG4gICAgICAgICAgICBsb2NhbFBvaW50QSA9IHRoaXMubV9wcm94eUEuR2V0U3VwcG9ydFZlcnRleChheGlzQSk7XHJcbiAgICAgICAgICAgIGxvY2FsUG9pbnRCID0gdGhpcy5tX3Byb3h5Qi5HZXRTdXBwb3J0VmVydGV4KGF4aXNCKTtcclxuICAgICAgICAgICAgcG9pbnRBID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQSwgbG9jYWxQb2ludEEpO1xyXG4gICAgICAgICAgICBwb2ludEIgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1CLCBsb2NhbFBvaW50Qik7XHJcbiAgICAgICAgICAgIHNlcGVyYXRpb24gPSAocG9pbnRCLnggLSBwb2ludEEueCkgKiB0aGlzLm1fYXhpcy54ICsgKHBvaW50Qi55IC0gcG9pbnRBLnkpICogdGhpcy5tX2F4aXMueTtcclxuICAgICAgICAgICAgcmV0dXJuIHNlcGVyYXRpb247XHJcbiAgICAgICAgIH1cclxuICAgICAgY2FzZSBiMlNlcGFyYXRpb25GdW5jdGlvbi5lX2ZhY2VBOlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIG5vcm1hbCA9IGIyTWF0aC5NdWxNVih0cmFuc2Zvcm1BLlIsIHRoaXMubV9heGlzKTtcclxuICAgICAgICAgICAgcG9pbnRBID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQSwgdGhpcy5tX2xvY2FsUG9pbnQpO1xyXG4gICAgICAgICAgICBheGlzQiA9IGIyTWF0aC5NdWxUTVYodHJhbnNmb3JtQi5SLCBub3JtYWwuR2V0TmVnYXRpdmUoKSk7XHJcbiAgICAgICAgICAgIGxvY2FsUG9pbnRCID0gdGhpcy5tX3Byb3h5Qi5HZXRTdXBwb3J0VmVydGV4KGF4aXNCKTtcclxuICAgICAgICAgICAgcG9pbnRCID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQiwgbG9jYWxQb2ludEIpO1xyXG4gICAgICAgICAgICBzZXBlcmF0aW9uID0gKHBvaW50Qi54IC0gcG9pbnRBLngpICogbm9ybWFsLnggKyAocG9pbnRCLnkgLSBwb2ludEEueSkgKiBub3JtYWwueTtcclxuICAgICAgICAgICAgcmV0dXJuIHNlcGVyYXRpb247XHJcbiAgICAgICAgIH1cclxuICAgICAgY2FzZSBiMlNlcGFyYXRpb25GdW5jdGlvbi5lX2ZhY2VCOlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIG5vcm1hbCA9IGIyTWF0aC5NdWxNVih0cmFuc2Zvcm1CLlIsIHRoaXMubV9heGlzKTtcclxuICAgICAgICAgICAgcG9pbnRCID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQiwgdGhpcy5tX2xvY2FsUG9pbnQpO1xyXG4gICAgICAgICAgICBheGlzQSA9IGIyTWF0aC5NdWxUTVYodHJhbnNmb3JtQS5SLCBub3JtYWwuR2V0TmVnYXRpdmUoKSk7XHJcbiAgICAgICAgICAgIGxvY2FsUG9pbnRBID0gdGhpcy5tX3Byb3h5QS5HZXRTdXBwb3J0VmVydGV4KGF4aXNBKTtcclxuICAgICAgICAgICAgcG9pbnRBID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQSwgbG9jYWxQb2ludEEpO1xyXG4gICAgICAgICAgICBzZXBlcmF0aW9uID0gKHBvaW50QS54IC0gcG9pbnRCLngpICogbm9ybWFsLnggKyAocG9pbnRBLnkgLSBwb2ludEIueSkgKiBub3JtYWwueTtcclxuICAgICAgICAgICAgcmV0dXJuIHNlcGVyYXRpb247XHJcbiAgICAgICAgIH1cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XHJcbiAgICAgICAgIHJldHVybiAwLjA7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfcG9pbnRzID0gMHgwMTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfZmFjZUEgPSAweDAyO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQiA9IDB4MDQ7XHJcbiAgIH0pO1xyXG4gICBiMlNpbXBsZXguYjJTaW1wbGV4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fdjEgPSBuZXcgYjJTaW1wbGV4VmVydGV4KCk7XHJcbiAgICAgIHRoaXMubV92MiA9IG5ldyBiMlNpbXBsZXhWZXJ0ZXgoKTtcclxuICAgICAgdGhpcy5tX3YzID0gbmV3IGIyU2ltcGxleFZlcnRleCgpO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXMgPSBuZXcgVmVjdG9yKDMpO1xyXG4gICB9O1xyXG4gICBiMlNpbXBsZXgucHJvdG90eXBlLmIyU2ltcGxleCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzBdID0gdGhpcy5tX3YxO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXNbMV0gPSB0aGlzLm1fdjI7XHJcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1syXSA9IHRoaXMubV92MztcclxuICAgfVxyXG4gICBiMlNpbXBsZXgucHJvdG90eXBlLlJlYWRDYWNoZSA9IGZ1bmN0aW9uIChjYWNoZSwgcHJveHlBLCB0cmFuc2Zvcm1BLCBwcm94eUIsIHRyYW5zZm9ybUIpIHtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCgwIDw9IGNhY2hlLmNvdW50ICYmIGNhY2hlLmNvdW50IDw9IDMpO1xyXG4gICAgICB2YXIgd0FMb2NhbDtcclxuICAgICAgdmFyIHdCTG9jYWw7XHJcbiAgICAgIHRoaXMubV9jb3VudCA9IGNhY2hlLmNvdW50O1xyXG4gICAgICB2YXIgdmVydGljZXMgPSB0aGlzLm1fdmVydGljZXM7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvdW50OyBpKyspIHtcclxuICAgICAgICAgdmFyIHYgPSB2ZXJ0aWNlc1tpXTtcclxuICAgICAgICAgdi5pbmRleEEgPSBjYWNoZS5pbmRleEFbaV07XHJcbiAgICAgICAgIHYuaW5kZXhCID0gY2FjaGUuaW5kZXhCW2ldO1xyXG4gICAgICAgICB3QUxvY2FsID0gcHJveHlBLkdldFZlcnRleCh2LmluZGV4QSk7XHJcbiAgICAgICAgIHdCTG9jYWwgPSBwcm94eUIuR2V0VmVydGV4KHYuaW5kZXhCKTtcclxuICAgICAgICAgdi53QSA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUEsIHdBTG9jYWwpO1xyXG4gICAgICAgICB2LndCID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQiwgd0JMb2NhbCk7XHJcbiAgICAgICAgIHYudyA9IGIyTWF0aC5TdWJ0cmFjdFZWKHYud0IsIHYud0EpO1xyXG4gICAgICAgICB2LmEgPSAwO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fY291bnQgPiAxKSB7XHJcbiAgICAgICAgIHZhciBtZXRyaWMxID0gY2FjaGUubWV0cmljO1xyXG4gICAgICAgICB2YXIgbWV0cmljMiA9IHRoaXMuR2V0TWV0cmljKCk7XHJcbiAgICAgICAgIGlmIChtZXRyaWMyIDwgLjUgKiBtZXRyaWMxIHx8IDIuMCAqIG1ldHJpYzEgPCBtZXRyaWMyIHx8IG1ldHJpYzIgPCBOdW1iZXIuTUlOX1ZBTFVFKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9jb3VudCA9IDA7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2NvdW50ID09IDApIHtcclxuICAgICAgICAgdiA9IHZlcnRpY2VzWzBdO1xyXG4gICAgICAgICB2LmluZGV4QSA9IDA7XHJcbiAgICAgICAgIHYuaW5kZXhCID0gMDtcclxuICAgICAgICAgd0FMb2NhbCA9IHByb3h5QS5HZXRWZXJ0ZXgoMCk7XHJcbiAgICAgICAgIHdCTG9jYWwgPSBwcm94eUIuR2V0VmVydGV4KDApO1xyXG4gICAgICAgICB2LndBID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQSwgd0FMb2NhbCk7XHJcbiAgICAgICAgIHYud0IgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1CLCB3QkxvY2FsKTtcclxuICAgICAgICAgdi53ID0gYjJNYXRoLlN1YnRyYWN0VlYodi53Qiwgdi53QSk7XHJcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlNpbXBsZXgucHJvdG90eXBlLldyaXRlQ2FjaGUgPSBmdW5jdGlvbiAoY2FjaGUpIHtcclxuICAgICAgY2FjaGUubWV0cmljID0gdGhpcy5HZXRNZXRyaWMoKTtcclxuICAgICAgY2FjaGUuY291bnQgPSBCb3gyRC5wYXJzZVVJbnQodGhpcy5tX2NvdW50KTtcclxuICAgICAgdmFyIHZlcnRpY2VzID0gdGhpcy5tX3ZlcnRpY2VzO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgaSsrKSB7XHJcbiAgICAgICAgIGNhY2hlLmluZGV4QVtpXSA9IEJveDJELnBhcnNlVUludCh2ZXJ0aWNlc1tpXS5pbmRleEEpO1xyXG4gICAgICAgICBjYWNoZS5pbmRleEJbaV0gPSBCb3gyRC5wYXJzZVVJbnQodmVydGljZXNbaV0uaW5kZXhCKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyU2ltcGxleC5wcm90b3R5cGUuR2V0U2VhcmNoRGlyZWN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xyXG4gICAgICBjYXNlIDE6XHJcbiAgICAgICAgIHJldHVybiB0aGlzLm1fdjEudy5HZXROZWdhdGl2ZSgpO1xyXG4gICAgICBjYXNlIDI6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGUxMiA9IGIyTWF0aC5TdWJ0cmFjdFZWKHRoaXMubV92Mi53LCB0aGlzLm1fdjEudyk7XHJcbiAgICAgICAgICAgIHZhciBzZ24gPSBiMk1hdGguQ3Jvc3NWVihlMTIsIHRoaXMubV92MS53LkdldE5lZ2F0aXZlKCkpO1xyXG4gICAgICAgICAgICBpZiAoc2duID4gMC4wKSB7XHJcbiAgICAgICAgICAgICAgIHJldHVybiBiMk1hdGguQ3Jvc3NGVigxLjAsIGUxMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIHJldHVybiBiMk1hdGguQ3Jvc3NWRihlMTIsIDEuMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyU2ltcGxleC5wcm90b3R5cGUuR2V0Q2xvc2VzdFBvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xyXG4gICAgICBjYXNlIDA6XHJcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZmFsc2UpO1xyXG4gICAgICAgICByZXR1cm4gbmV3IGIyVmVjMigpO1xyXG4gICAgICBjYXNlIDE6XHJcbiAgICAgICAgIHJldHVybiB0aGlzLm1fdjEudztcclxuICAgICAgY2FzZSAyOlxyXG4gICAgICAgICByZXR1cm4gbmV3IGIyVmVjMih0aGlzLm1fdjEuYSAqIHRoaXMubV92MS53LnggKyB0aGlzLm1fdjIuYSAqIHRoaXMubV92Mi53LngsIHRoaXMubV92MS5hICogdGhpcy5tX3YxLncueSArIHRoaXMubV92Mi5hICogdGhpcy5tX3YyLncueSk7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZmFsc2UpO1xyXG4gICAgICAgICByZXR1cm4gbmV3IGIyVmVjMigpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5HZXRXaXRuZXNzUG9pbnRzID0gZnVuY3Rpb24gKHBBLCBwQikge1xyXG4gICAgICBzd2l0Y2ggKHRoaXMubV9jb3VudCkge1xyXG4gICAgICBjYXNlIDA6XHJcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZmFsc2UpO1xyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAxOlxyXG4gICAgICAgICBwQS5TZXRWKHRoaXMubV92MS53QSk7XHJcbiAgICAgICAgIHBCLlNldFYodGhpcy5tX3YxLndCKTtcclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgMjpcclxuICAgICAgICAgcEEueCA9IHRoaXMubV92MS5hICogdGhpcy5tX3YxLndBLnggKyB0aGlzLm1fdjIuYSAqIHRoaXMubV92Mi53QS54O1xyXG4gICAgICAgICBwQS55ID0gdGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEud0EueSArIHRoaXMubV92Mi5hICogdGhpcy5tX3YyLndBLnk7XHJcbiAgICAgICAgIHBCLnggPSB0aGlzLm1fdjEuYSAqIHRoaXMubV92MS53Qi54ICsgdGhpcy5tX3YyLmEgKiB0aGlzLm1fdjIud0IueDtcclxuICAgICAgICAgcEIueSA9IHRoaXMubV92MS5hICogdGhpcy5tX3YxLndCLnkgKyB0aGlzLm1fdjIuYSAqIHRoaXMubV92Mi53Qi55O1xyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAzOlxyXG4gICAgICAgICBwQi54ID0gcEEueCA9IHRoaXMubV92MS5hICogdGhpcy5tX3YxLndBLnggKyB0aGlzLm1fdjIuYSAqIHRoaXMubV92Mi53QS54ICsgdGhpcy5tX3YzLmEgKiB0aGlzLm1fdjMud0EueDtcclxuICAgICAgICAgcEIueSA9IHBBLnkgPSB0aGlzLm1fdjEuYSAqIHRoaXMubV92MS53QS55ICsgdGhpcy5tX3YyLmEgKiB0aGlzLm1fdjIud0EueSArIHRoaXMubV92My5hICogdGhpcy5tX3YzLndBLnk7XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlNpbXBsZXgucHJvdG90eXBlLkdldE1ldHJpYyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcclxuICAgICAgY2FzZSAwOlxyXG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICAgcmV0dXJuIDAuMDtcclxuICAgICAgY2FzZSAxOlxyXG4gICAgICAgICByZXR1cm4gMC4wO1xyXG4gICAgICBjYXNlIDI6XHJcbiAgICAgICAgIHJldHVybiBiMk1hdGguU3VidHJhY3RWVih0aGlzLm1fdjEudywgdGhpcy5tX3YyLncpLkxlbmd0aCgpO1xyXG4gICAgICBjYXNlIDM6XHJcbiAgICAgICAgIHJldHVybiBiMk1hdGguQ3Jvc3NWVihiMk1hdGguU3VidHJhY3RWVih0aGlzLm1fdjIudywgdGhpcy5tX3YxLncpLCBiMk1hdGguU3VidHJhY3RWVih0aGlzLm1fdjMudywgdGhpcy5tX3YxLncpKTtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XHJcbiAgICAgICAgIHJldHVybiAwLjA7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlNpbXBsZXgucHJvdG90eXBlLlNvbHZlMiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHcxID0gdGhpcy5tX3YxLnc7XHJcbiAgICAgIHZhciB3MiA9IHRoaXMubV92Mi53O1xyXG4gICAgICB2YXIgZTEyID0gYjJNYXRoLlN1YnRyYWN0VlYodzIsIHcxKTtcclxuICAgICAgdmFyIGQxMl8yID0gKC0odzEueCAqIGUxMi54ICsgdzEueSAqIGUxMi55KSk7XHJcbiAgICAgIGlmIChkMTJfMiA8PSAwLjApIHtcclxuICAgICAgICAgdGhpcy5tX3YxLmEgPSAxLjA7XHJcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgZDEyXzEgPSAodzIueCAqIGUxMi54ICsgdzIueSAqIGUxMi55KTtcclxuICAgICAgaWYgKGQxMl8xIDw9IDAuMCkge1xyXG4gICAgICAgICB0aGlzLm1fdjIuYSA9IDEuMDtcclxuICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcclxuICAgICAgICAgdGhpcy5tX3YxLlNldCh0aGlzLm1fdjIpO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGludl9kMTIgPSAxLjAgLyAoZDEyXzEgKyBkMTJfMik7XHJcbiAgICAgIHRoaXMubV92MS5hID0gZDEyXzEgKiBpbnZfZDEyO1xyXG4gICAgICB0aGlzLm1fdjIuYSA9IGQxMl8yICogaW52X2QxMjtcclxuICAgICAgdGhpcy5tX2NvdW50ID0gMjtcclxuICAgfVxyXG4gICBiMlNpbXBsZXgucHJvdG90eXBlLlNvbHZlMyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHcxID0gdGhpcy5tX3YxLnc7XHJcbiAgICAgIHZhciB3MiA9IHRoaXMubV92Mi53O1xyXG4gICAgICB2YXIgdzMgPSB0aGlzLm1fdjMudztcclxuICAgICAgdmFyIGUxMiA9IGIyTWF0aC5TdWJ0cmFjdFZWKHcyLCB3MSk7XHJcbiAgICAgIHZhciB3MWUxMiA9IGIyTWF0aC5Eb3QodzEsIGUxMik7XHJcbiAgICAgIHZhciB3MmUxMiA9IGIyTWF0aC5Eb3QodzIsIGUxMik7XHJcbiAgICAgIHZhciBkMTJfMSA9IHcyZTEyO1xyXG4gICAgICB2YXIgZDEyXzIgPSAoLXcxZTEyKTtcclxuICAgICAgdmFyIGUxMyA9IGIyTWF0aC5TdWJ0cmFjdFZWKHczLCB3MSk7XHJcbiAgICAgIHZhciB3MWUxMyA9IGIyTWF0aC5Eb3QodzEsIGUxMyk7XHJcbiAgICAgIHZhciB3M2UxMyA9IGIyTWF0aC5Eb3QodzMsIGUxMyk7XHJcbiAgICAgIHZhciBkMTNfMSA9IHczZTEzO1xyXG4gICAgICB2YXIgZDEzXzIgPSAoLXcxZTEzKTtcclxuICAgICAgdmFyIGUyMyA9IGIyTWF0aC5TdWJ0cmFjdFZWKHczLCB3Mik7XHJcbiAgICAgIHZhciB3MmUyMyA9IGIyTWF0aC5Eb3QodzIsIGUyMyk7XHJcbiAgICAgIHZhciB3M2UyMyA9IGIyTWF0aC5Eb3QodzMsIGUyMyk7XHJcbiAgICAgIHZhciBkMjNfMSA9IHczZTIzO1xyXG4gICAgICB2YXIgZDIzXzIgPSAoLXcyZTIzKTtcclxuICAgICAgdmFyIG4xMjMgPSBiMk1hdGguQ3Jvc3NWVihlMTIsIGUxMyk7XHJcbiAgICAgIHZhciBkMTIzXzEgPSBuMTIzICogYjJNYXRoLkNyb3NzVlYodzIsIHczKTtcclxuICAgICAgdmFyIGQxMjNfMiA9IG4xMjMgKiBiMk1hdGguQ3Jvc3NWVih3MywgdzEpO1xyXG4gICAgICB2YXIgZDEyM18zID0gbjEyMyAqIGIyTWF0aC5Dcm9zc1ZWKHcxLCB3Mik7XHJcbiAgICAgIGlmIChkMTJfMiA8PSAwLjAgJiYgZDEzXzIgPD0gMC4wKSB7XHJcbiAgICAgICAgIHRoaXMubV92MS5hID0gMS4wO1xyXG4gICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGQxMl8xID4gMC4wICYmIGQxMl8yID4gMC4wICYmIGQxMjNfMyA8PSAwLjApIHtcclxuICAgICAgICAgdmFyIGludl9kMTIgPSAxLjAgLyAoZDEyXzEgKyBkMTJfMik7XHJcbiAgICAgICAgIHRoaXMubV92MS5hID0gZDEyXzEgKiBpbnZfZDEyO1xyXG4gICAgICAgICB0aGlzLm1fdjIuYSA9IGQxMl8yICogaW52X2QxMjtcclxuICAgICAgICAgdGhpcy5tX2NvdW50ID0gMjtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkMTNfMSA+IDAuMCAmJiBkMTNfMiA+IDAuMCAmJiBkMTIzXzIgPD0gMC4wKSB7XHJcbiAgICAgICAgIHZhciBpbnZfZDEzID0gMS4wIC8gKGQxM18xICsgZDEzXzIpO1xyXG4gICAgICAgICB0aGlzLm1fdjEuYSA9IGQxM18xICogaW52X2QxMztcclxuICAgICAgICAgdGhpcy5tX3YzLmEgPSBkMTNfMiAqIGludl9kMTM7XHJcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDI7XHJcbiAgICAgICAgIHRoaXMubV92Mi5TZXQodGhpcy5tX3YzKTtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkMTJfMSA8PSAwLjAgJiYgZDIzXzIgPD0gMC4wKSB7XHJcbiAgICAgICAgIHRoaXMubV92Mi5hID0gMS4wO1xyXG4gICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xyXG4gICAgICAgICB0aGlzLm1fdjEuU2V0KHRoaXMubV92Mik7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZDEzXzEgPD0gMC4wICYmIGQyM18xIDw9IDAuMCkge1xyXG4gICAgICAgICB0aGlzLm1fdjMuYSA9IDEuMDtcclxuICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcclxuICAgICAgICAgdGhpcy5tX3YxLlNldCh0aGlzLm1fdjMpO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGQyM18xID4gMC4wICYmIGQyM18yID4gMC4wICYmIGQxMjNfMSA8PSAwLjApIHtcclxuICAgICAgICAgdmFyIGludl9kMjMgPSAxLjAgLyAoZDIzXzEgKyBkMjNfMik7XHJcbiAgICAgICAgIHRoaXMubV92Mi5hID0gZDIzXzEgKiBpbnZfZDIzO1xyXG4gICAgICAgICB0aGlzLm1fdjMuYSA9IGQyM18yICogaW52X2QyMztcclxuICAgICAgICAgdGhpcy5tX2NvdW50ID0gMjtcclxuICAgICAgICAgdGhpcy5tX3YxLlNldCh0aGlzLm1fdjMpO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGludl9kMTIzID0gMS4wIC8gKGQxMjNfMSArIGQxMjNfMiArIGQxMjNfMyk7XHJcbiAgICAgIHRoaXMubV92MS5hID0gZDEyM18xICogaW52X2QxMjM7XHJcbiAgICAgIHRoaXMubV92Mi5hID0gZDEyM18yICogaW52X2QxMjM7XHJcbiAgICAgIHRoaXMubV92My5hID0gZDEyM18zICogaW52X2QxMjM7XHJcbiAgICAgIHRoaXMubV9jb3VudCA9IDM7XHJcbiAgIH1cclxuICAgYjJTaW1wbGV4Q2FjaGUuYjJTaW1wbGV4Q2FjaGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuaW5kZXhBID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKDMpO1xyXG4gICAgICB0aGlzLmluZGV4QiA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigzKTtcclxuICAgfTtcclxuICAgYjJTaW1wbGV4VmVydGV4LmIyU2ltcGxleFZlcnRleCA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMlNpbXBsZXhWZXJ0ZXgucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICB0aGlzLndBLlNldFYob3RoZXIud0EpO1xyXG4gICAgICB0aGlzLndCLlNldFYob3RoZXIud0IpO1xyXG4gICAgICB0aGlzLncuU2V0VihvdGhlci53KTtcclxuICAgICAgdGhpcy5hID0gb3RoZXIuYTtcclxuICAgICAgdGhpcy5pbmRleEEgPSBvdGhlci5pbmRleEE7XHJcbiAgICAgIHRoaXMuaW5kZXhCID0gb3RoZXIuaW5kZXhCO1xyXG4gICB9XHJcbiAgIGIyVGltZU9mSW1wYWN0LmIyVGltZU9mSW1wYWN0ID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyVGltZU9mSW1wYWN0LlRpbWVPZkltcGFjdCA9IGZ1bmN0aW9uIChpbnB1dCkge1xyXG4gICAgICArK2IyVGltZU9mSW1wYWN0LmIyX3RvaUNhbGxzO1xyXG4gICAgICB2YXIgcHJveHlBID0gaW5wdXQucHJveHlBO1xyXG4gICAgICB2YXIgcHJveHlCID0gaW5wdXQucHJveHlCO1xyXG4gICAgICB2YXIgc3dlZXBBID0gaW5wdXQuc3dlZXBBO1xyXG4gICAgICB2YXIgc3dlZXBCID0gaW5wdXQuc3dlZXBCO1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KHN3ZWVwQS50MCA9PSBzd2VlcEIudDApO1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KDEuMCAtIHN3ZWVwQS50MCA+IE51bWJlci5NSU5fVkFMVUUpO1xyXG4gICAgICB2YXIgcmFkaXVzID0gcHJveHlBLm1fcmFkaXVzICsgcHJveHlCLm1fcmFkaXVzO1xyXG4gICAgICB2YXIgdG9sZXJhbmNlID0gaW5wdXQudG9sZXJhbmNlO1xyXG4gICAgICB2YXIgYWxwaGEgPSAwLjA7XHJcbiAgICAgIHZhciBrX21heEl0ZXJhdGlvbnMgPSAxMDAwO1xyXG4gICAgICB2YXIgaXRlciA9IDA7XHJcbiAgICAgIHZhciB0YXJnZXQgPSAwLjA7XHJcbiAgICAgIGIyVGltZU9mSW1wYWN0LnNfY2FjaGUuY291bnQgPSAwO1xyXG4gICAgICBiMlRpbWVPZkltcGFjdC5zX2Rpc3RhbmNlSW5wdXQudXNlUmFkaWkgPSBmYWxzZTtcclxuICAgICAgZm9yICg7Oykge1xyXG4gICAgICAgICBzd2VlcEEuR2V0VHJhbnNmb3JtKGIyVGltZU9mSW1wYWN0LnNfeGZBLCBhbHBoYSk7XHJcbiAgICAgICAgIHN3ZWVwQi5HZXRUcmFuc2Zvcm0oYjJUaW1lT2ZJbXBhY3Quc194ZkIsIGFscGhhKTtcclxuICAgICAgICAgYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0LnByb3h5QSA9IHByb3h5QTtcclxuICAgICAgICAgYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0LnByb3h5QiA9IHByb3h5QjtcclxuICAgICAgICAgYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0LnRyYW5zZm9ybUEgPSBiMlRpbWVPZkltcGFjdC5zX3hmQTtcclxuICAgICAgICAgYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0LnRyYW5zZm9ybUIgPSBiMlRpbWVPZkltcGFjdC5zX3hmQjtcclxuICAgICAgICAgYjJEaXN0YW5jZS5EaXN0YW5jZShiMlRpbWVPZkltcGFjdC5zX2Rpc3RhbmNlT3V0cHV0LCBiMlRpbWVPZkltcGFjdC5zX2NhY2hlLCBiMlRpbWVPZkltcGFjdC5zX2Rpc3RhbmNlSW5wdXQpO1xyXG4gICAgICAgICBpZiAoYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZU91dHB1dC5kaXN0YW5jZSA8PSAwLjApIHtcclxuICAgICAgICAgICAgYWxwaGEgPSAxLjA7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGIyVGltZU9mSW1wYWN0LnNfZmNuLkluaXRpYWxpemUoYjJUaW1lT2ZJbXBhY3Quc19jYWNoZSwgcHJveHlBLCBiMlRpbWVPZkltcGFjdC5zX3hmQSwgcHJveHlCLCBiMlRpbWVPZkltcGFjdC5zX3hmQik7XHJcbiAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gYjJUaW1lT2ZJbXBhY3Quc19mY24uRXZhbHVhdGUoYjJUaW1lT2ZJbXBhY3Quc194ZkEsIGIyVGltZU9mSW1wYWN0LnNfeGZCKTtcclxuICAgICAgICAgaWYgKHNlcGFyYXRpb24gPD0gMC4wKSB7XHJcbiAgICAgICAgICAgIGFscGhhID0gMS4wO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAoaXRlciA9PSAwKSB7XHJcbiAgICAgICAgICAgIGlmIChzZXBhcmF0aW9uID4gcmFkaXVzKSB7XHJcbiAgICAgICAgICAgICAgIHRhcmdldCA9IGIyTWF0aC5NYXgocmFkaXVzIC0gdG9sZXJhbmNlLCAwLjc1ICogcmFkaXVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgdGFyZ2V0ID0gYjJNYXRoLk1heChzZXBhcmF0aW9uIC0gdG9sZXJhbmNlLCAwLjAyICogcmFkaXVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChzZXBhcmF0aW9uIC0gdGFyZ2V0IDwgMC41ICogdG9sZXJhbmNlKSB7XHJcbiAgICAgICAgICAgIGlmIChpdGVyID09IDApIHtcclxuICAgICAgICAgICAgICAgYWxwaGEgPSAxLjA7XHJcbiAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciBuZXdBbHBoYSA9IGFscGhhOyB7XHJcbiAgICAgICAgICAgIHZhciB4MSA9IGFscGhhO1xyXG4gICAgICAgICAgICB2YXIgeDIgPSAxLjA7XHJcbiAgICAgICAgICAgIHZhciBmMSA9IHNlcGFyYXRpb247XHJcbiAgICAgICAgICAgIHN3ZWVwQS5HZXRUcmFuc2Zvcm0oYjJUaW1lT2ZJbXBhY3Quc194ZkEsIHgyKTtcclxuICAgICAgICAgICAgc3dlZXBCLkdldFRyYW5zZm9ybShiMlRpbWVPZkltcGFjdC5zX3hmQiwgeDIpO1xyXG4gICAgICAgICAgICB2YXIgZjIgPSBiMlRpbWVPZkltcGFjdC5zX2Zjbi5FdmFsdWF0ZShiMlRpbWVPZkltcGFjdC5zX3hmQSwgYjJUaW1lT2ZJbXBhY3Quc194ZkIpO1xyXG4gICAgICAgICAgICBpZiAoZjIgPj0gdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgIGFscGhhID0gMS4wO1xyXG4gICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgcm9vdEl0ZXJDb3VudCA9IDA7XHJcbiAgICAgICAgICAgIGZvciAoOzspIHtcclxuICAgICAgICAgICAgICAgdmFyIHggPSAwO1xyXG4gICAgICAgICAgICAgICBpZiAocm9vdEl0ZXJDb3VudCAmIDEpIHtcclxuICAgICAgICAgICAgICAgICAgeCA9IHgxICsgKHRhcmdldCAtIGYxKSAqICh4MiAtIHgxKSAvIChmMiAtIGYxKTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgeCA9IDAuNSAqICh4MSArIHgyKTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBzd2VlcEEuR2V0VHJhbnNmb3JtKGIyVGltZU9mSW1wYWN0LnNfeGZBLCB4KTtcclxuICAgICAgICAgICAgICAgc3dlZXBCLkdldFRyYW5zZm9ybShiMlRpbWVPZkltcGFjdC5zX3hmQiwgeCk7XHJcbiAgICAgICAgICAgICAgIHZhciBmID0gYjJUaW1lT2ZJbXBhY3Quc19mY24uRXZhbHVhdGUoYjJUaW1lT2ZJbXBhY3Quc194ZkEsIGIyVGltZU9mSW1wYWN0LnNfeGZCKTtcclxuICAgICAgICAgICAgICAgaWYgKGIyTWF0aC5BYnMoZiAtIHRhcmdldCkgPCAwLjAyNSAqIHRvbGVyYW5jZSkge1xyXG4gICAgICAgICAgICAgICAgICBuZXdBbHBoYSA9IHg7XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGlmIChmID4gdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgIHgxID0geDtcclxuICAgICAgICAgICAgICAgICAgZjEgPSBmO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICB4MiA9IHg7XHJcbiAgICAgICAgICAgICAgICAgIGYyID0gZjtcclxuICAgICAgICAgICAgICAgfSsrcm9vdEl0ZXJDb3VudDtcclxuICAgICAgICAgICAgICAgKytiMlRpbWVPZkltcGFjdC5iMl90b2lSb290SXRlcnM7XHJcbiAgICAgICAgICAgICAgIGlmIChyb290SXRlckNvdW50ID09IDUwKSB7XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4Um9vdEl0ZXJzID0gYjJNYXRoLk1heChiMlRpbWVPZkltcGFjdC5iMl90b2lNYXhSb290SXRlcnMsIHJvb3RJdGVyQ291bnQpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChuZXdBbHBoYSA8ICgxLjAgKyAxMDAuMCAqIE51bWJlci5NSU5fVkFMVUUpICogYWxwaGEpIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYWxwaGEgPSBuZXdBbHBoYTtcclxuICAgICAgICAgaXRlcisrO1xyXG4gICAgICAgICArK2IyVGltZU9mSW1wYWN0LmIyX3RvaUl0ZXJzO1xyXG4gICAgICAgICBpZiAoaXRlciA9PSBrX21heEl0ZXJhdGlvbnMpIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBiMlRpbWVPZkltcGFjdC5iMl90b2lNYXhJdGVycyA9IGIyTWF0aC5NYXgoYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4SXRlcnMsIGl0ZXIpO1xyXG4gICAgICByZXR1cm4gYWxwaGE7XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5iMl90b2lDYWxscyA9IDA7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5iMl90b2lJdGVycyA9IDA7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5iMl90b2lNYXhJdGVycyA9IDA7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5iMl90b2lSb290SXRlcnMgPSAwO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4Um9vdEl0ZXJzID0gMDtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LnNfY2FjaGUgPSBuZXcgYjJTaW1wbGV4Q2FjaGUoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VJbnB1dCA9IG5ldyBiMkRpc3RhbmNlSW5wdXQoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LnNfeGZBID0gbmV3IGIyVHJhbnNmb3JtKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5zX3hmQiA9IG5ldyBiMlRyYW5zZm9ybSgpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3Quc19mY24gPSBuZXcgYjJTZXBhcmF0aW9uRnVuY3Rpb24oKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VPdXRwdXQgPSBuZXcgYjJEaXN0YW5jZU91dHB1dCgpO1xyXG4gICB9KTtcclxuICAgYjJUT0lJbnB1dC5iMlRPSUlucHV0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnByb3h5QSA9IG5ldyBiMkRpc3RhbmNlUHJveHkoKTtcclxuICAgICAgdGhpcy5wcm94eUIgPSBuZXcgYjJEaXN0YW5jZVByb3h5KCk7XHJcbiAgICAgIHRoaXMuc3dlZXBBID0gbmV3IGIyU3dlZXAoKTtcclxuICAgICAgdGhpcy5zd2VlcEIgPSBuZXcgYjJTd2VlcCgpO1xyXG4gICB9O1xyXG4gICBiMldvcmxkTWFuaWZvbGQuYjJXb3JsZE1hbmlmb2xkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fbm9ybWFsID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMldvcmxkTWFuaWZvbGQucHJvdG90eXBlLmIyV29ybGRNYW5pZm9sZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3BvaW50cyA9IG5ldyBWZWN0b3IoYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50czsgaSsrKSB7XHJcbiAgICAgICAgIHRoaXMubV9wb2ludHNbaV0gPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMldvcmxkTWFuaWZvbGQucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAobWFuaWZvbGQsIHhmQSwgcmFkaXVzQSwgeGZCLCByYWRpdXNCKSB7XHJcbiAgICAgIGlmIChyYWRpdXNBID09PSB1bmRlZmluZWQpIHJhZGl1c0EgPSAwO1xyXG4gICAgICBpZiAocmFkaXVzQiA9PT0gdW5kZWZpbmVkKSByYWRpdXNCID0gMDtcclxuICAgICAgaWYgKG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9PSAwKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgaSA9IDA7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIG5vcm1hbFggPSAwO1xyXG4gICAgICB2YXIgbm9ybWFsWSA9IDA7XHJcbiAgICAgIHZhciBwbGFuZVBvaW50WCA9IDA7XHJcbiAgICAgIHZhciBwbGFuZVBvaW50WSA9IDA7XHJcbiAgICAgIHZhciBjbGlwUG9pbnRYID0gMDtcclxuICAgICAgdmFyIGNsaXBQb2ludFkgPSAwO1xyXG4gICAgICBzd2l0Y2ggKG1hbmlmb2xkLm1fdHlwZSkge1xyXG4gICAgICBjYXNlIGIyTWFuaWZvbGQuZV9jaXJjbGVzOlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIHRNYXQgPSB4ZkEuUjtcclxuICAgICAgICAgICAgdFZlYyA9IG1hbmlmb2xkLm1fbG9jYWxQb2ludDtcclxuICAgICAgICAgICAgdmFyIHBvaW50QVggPSB4ZkEucG9zaXRpb24ueCArIHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHZhciBwb2ludEFZID0geGZBLnBvc2l0aW9uLnkgKyB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICAgICB0TWF0ID0geGZCLlI7XHJcbiAgICAgICAgICAgIHRWZWMgPSBtYW5pZm9sZC5tX3BvaW50c1swXS5tX2xvY2FsUG9pbnQ7XHJcbiAgICAgICAgICAgIHZhciBwb2ludEJYID0geGZCLnBvc2l0aW9uLnggKyB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRCWSA9IHhmQi5wb3NpdGlvbi55ICsgdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgICAgdmFyIGRYID0gcG9pbnRCWCAtIHBvaW50QVg7XHJcbiAgICAgICAgICAgIHZhciBkWSA9IHBvaW50QlkgLSBwb2ludEFZO1xyXG4gICAgICAgICAgICB2YXIgZDIgPSBkWCAqIGRYICsgZFkgKiBkWTtcclxuICAgICAgICAgICAgaWYgKGQyID4gTnVtYmVyLk1JTl9WQUxVRSAqIE51bWJlci5NSU5fVkFMVUUpIHtcclxuICAgICAgICAgICAgICAgdmFyIGQgPSBNYXRoLnNxcnQoZDIpO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnggPSBkWCAvIGQ7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueSA9IGRZIC8gZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ID0gMTtcclxuICAgICAgICAgICAgICAgdGhpcy5tX25vcm1hbC55ID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgY0FYID0gcG9pbnRBWCArIHJhZGl1c0EgKiB0aGlzLm1fbm9ybWFsLng7XHJcbiAgICAgICAgICAgIHZhciBjQVkgPSBwb2ludEFZICsgcmFkaXVzQSAqIHRoaXMubV9ub3JtYWwueTtcclxuICAgICAgICAgICAgdmFyIGNCWCA9IHBvaW50QlggLSByYWRpdXNCICogdGhpcy5tX25vcm1hbC54O1xyXG4gICAgICAgICAgICB2YXIgY0JZID0gcG9pbnRCWSAtIHJhZGl1c0IgKiB0aGlzLm1fbm9ybWFsLnk7XHJcbiAgICAgICAgICAgIHRoaXMubV9wb2ludHNbMF0ueCA9IDAuNSAqIChjQVggKyBjQlgpO1xyXG4gICAgICAgICAgICB0aGlzLm1fcG9pbnRzWzBdLnkgPSAwLjUgKiAoY0FZICsgY0JZKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMk1hbmlmb2xkLmVfZmFjZUE6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgdE1hdCA9IHhmQS5SO1xyXG4gICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsO1xyXG4gICAgICAgICAgICBub3JtYWxYID0gdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgICAgbm9ybWFsWSA9IHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHRNYXQgPSB4ZkEuUjtcclxuICAgICAgICAgICAgdFZlYyA9IG1hbmlmb2xkLm1fbG9jYWxQb2ludDtcclxuICAgICAgICAgICAgcGxhbmVQb2ludFggPSB4ZkEucG9zaXRpb24ueCArIHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHBsYW5lUG9pbnRZID0geGZBLnBvc2l0aW9uLnkgKyB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnggPSBub3JtYWxYO1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSBub3JtYWxZO1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICAgICBpIDwgbWFuaWZvbGQubV9wb2ludENvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgdE1hdCA9IHhmQi5SO1xyXG4gICAgICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9wb2ludHNbaV0ubV9sb2NhbFBvaW50O1xyXG4gICAgICAgICAgICAgICBjbGlwUG9pbnRYID0geGZCLnBvc2l0aW9uLnggKyB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICAgICBjbGlwUG9pbnRZID0geGZCLnBvc2l0aW9uLnkgKyB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fcG9pbnRzW2ldLnggPSBjbGlwUG9pbnRYICsgMC41ICogKHJhZGl1c0EgLSAoY2xpcFBvaW50WCAtIHBsYW5lUG9pbnRYKSAqIG5vcm1hbFggLSAoY2xpcFBvaW50WSAtIHBsYW5lUG9pbnRZKSAqIG5vcm1hbFkgLSByYWRpdXNCKSAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9wb2ludHNbaV0ueSA9IGNsaXBQb2ludFkgKyAwLjUgKiAocmFkaXVzQSAtIChjbGlwUG9pbnRYIC0gcGxhbmVQb2ludFgpICogbm9ybWFsWCAtIChjbGlwUG9pbnRZIC0gcGxhbmVQb2ludFkpICogbm9ybWFsWSAtIHJhZGl1c0IpICogbm9ybWFsWTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIGIyTWFuaWZvbGQuZV9mYWNlQjpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICB0TWF0ID0geGZCLlI7XHJcbiAgICAgICAgICAgIHRWZWMgPSBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWw7XHJcbiAgICAgICAgICAgIG5vcm1hbFggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICBub3JtYWxZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgICAgdE1hdCA9IHhmQi5SO1xyXG4gICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9sb2NhbFBvaW50O1xyXG4gICAgICAgICAgICBwbGFuZVBvaW50WCA9IHhmQi5wb3NpdGlvbi54ICsgdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgICAgcGxhbmVQb2ludFkgPSB4ZkIucG9zaXRpb24ueSArIHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueCA9ICgtbm9ybWFsWCk7XHJcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueSA9ICgtbm9ybWFsWSk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgICAgICAgIGkgPCBtYW5pZm9sZC5tX3BvaW50Q291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICAgICB0TWF0ID0geGZBLlI7XHJcbiAgICAgICAgICAgICAgIHRWZWMgPSBtYW5pZm9sZC5tX3BvaW50c1tpXS5tX2xvY2FsUG9pbnQ7XHJcbiAgICAgICAgICAgICAgIGNsaXBQb2ludFggPSB4ZkEucG9zaXRpb24ueCArIHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XHJcbiAgICAgICAgICAgICAgIGNsaXBQb2ludFkgPSB4ZkEucG9zaXRpb24ueSArIHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9wb2ludHNbaV0ueCA9IGNsaXBQb2ludFggKyAwLjUgKiAocmFkaXVzQiAtIChjbGlwUG9pbnRYIC0gcGxhbmVQb2ludFgpICogbm9ybWFsWCAtIChjbGlwUG9pbnRZIC0gcGxhbmVQb2ludFkpICogbm9ybWFsWSAtIHJhZGl1c0EpICogbm9ybWFsWDtcclxuICAgICAgICAgICAgICAgdGhpcy5tX3BvaW50c1tpXS55ID0gY2xpcFBvaW50WSArIDAuNSAqIChyYWRpdXNCIC0gKGNsaXBQb2ludFggLSBwbGFuZVBvaW50WCkgKiBub3JtYWxYIC0gKGNsaXBQb2ludFkgLSBwbGFuZVBvaW50WSkgKiBub3JtYWxZIC0gcmFkaXVzQSkgKiBub3JtYWxZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBDbGlwVmVydGV4LkNsaXBWZXJ0ZXggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMudiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5pZCA9IG5ldyBiMkNvbnRhY3RJRCgpO1xyXG4gICB9O1xyXG4gICBDbGlwVmVydGV4LnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgdGhpcy52LlNldFYob3RoZXIudik7XHJcbiAgICAgIHRoaXMuaWQuU2V0KG90aGVyLmlkKTtcclxuICAgfVxyXG4gICBGZWF0dXJlcy5GZWF0dXJlcyA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmVhdHVyZXMucHJvdG90eXBlLCAncmVmZXJlbmNlRWRnZScsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgIHJldHVybiB0aGlzLl9yZWZlcmVuY2VFZGdlO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmVhdHVyZXMucHJvdG90eXBlLCAncmVmZXJlbmNlRWRnZScsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0gMDtcclxuICAgICAgICAgdGhpcy5fcmVmZXJlbmNlRWRnZSA9IHZhbHVlO1xyXG4gICAgICAgICB0aGlzLl9tX2lkLl9rZXkgPSAodGhpcy5fbV9pZC5fa2V5ICYgMHhmZmZmZmYwMCkgfCAodGhpcy5fcmVmZXJlbmNlRWRnZSAmIDB4MDAwMDAwZmYpO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmVhdHVyZXMucHJvdG90eXBlLCAnaW5jaWRlbnRFZGdlJywge1xyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgcmV0dXJuIHRoaXMuX2luY2lkZW50RWRnZTtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ2luY2lkZW50RWRnZScsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0gMDtcclxuICAgICAgICAgdGhpcy5faW5jaWRlbnRFZGdlID0gdmFsdWU7XHJcbiAgICAgICAgIHRoaXMuX21faWQuX2tleSA9ICh0aGlzLl9tX2lkLl9rZXkgJiAweGZmZmYwMGZmKSB8ICgodGhpcy5faW5jaWRlbnRFZGdlIDw8IDgpICYgMHgwMDAwZmYwMCk7XHJcbiAgICAgIH1cclxuICAgfSk7XHJcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGZWF0dXJlcy5wcm90b3R5cGUsICdpbmNpZGVudFZlcnRleCcsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgIHJldHVybiB0aGlzLl9pbmNpZGVudFZlcnRleDtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ2luY2lkZW50VmVydGV4Jywge1xyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgdmFsdWUgPSAwO1xyXG4gICAgICAgICB0aGlzLl9pbmNpZGVudFZlcnRleCA9IHZhbHVlO1xyXG4gICAgICAgICB0aGlzLl9tX2lkLl9rZXkgPSAodGhpcy5fbV9pZC5fa2V5ICYgMHhmZjAwZmZmZikgfCAoKHRoaXMuX2luY2lkZW50VmVydGV4IDw8IDE2KSAmIDB4MDBmZjAwMDApO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmVhdHVyZXMucHJvdG90eXBlLCAnZmxpcCcsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgIHJldHVybiB0aGlzLl9mbGlwO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmVhdHVyZXMucHJvdG90eXBlLCAnZmxpcCcsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0gMDtcclxuICAgICAgICAgdGhpcy5fZmxpcCA9IHZhbHVlO1xyXG4gICAgICAgICB0aGlzLl9tX2lkLl9rZXkgPSAodGhpcy5fbV9pZC5fa2V5ICYgMHgwMGZmZmZmZikgfCAoKHRoaXMuX2ZsaXAgPDwgMjQpICYgMHhmZjAwMDAwMCk7XHJcbiAgICAgIH1cclxuICAgfSk7XHJcbn0pKCk7XHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgIHZhciBiMkNvbG9yID0gQm94MkQuQ29tbW9uLmIyQ29sb3IsXHJcbiAgICAgIGIyaW50ZXJuYWwgPSBCb3gyRC5Db21tb24uYjJpbnRlcm5hbCxcclxuICAgICAgYjJTZXR0aW5ncyA9IEJveDJELkNvbW1vbi5iMlNldHRpbmdzLFxyXG4gICAgICBiMkNpcmNsZVNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkNpcmNsZVNoYXBlLFxyXG4gICAgICBiMkVkZ2VDaGFpbkRlZiA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlQ2hhaW5EZWYsXHJcbiAgICAgIGIyRWRnZVNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VTaGFwZSxcclxuICAgICAgYjJNYXNzRGF0YSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJNYXNzRGF0YSxcclxuICAgICAgYjJQb2x5Z29uU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyUG9seWdvblNoYXBlLFxyXG4gICAgICBiMlNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLFxyXG4gICAgICBiMk1hdDIyID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQyMixcclxuICAgICAgYjJNYXQzMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MzMsXHJcbiAgICAgIGIyTWF0aCA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aCxcclxuICAgICAgYjJTd2VlcCA9IEJveDJELkNvbW1vbi5NYXRoLmIyU3dlZXAsXHJcbiAgICAgIGIyVHJhbnNmb3JtID0gQm94MkQuQ29tbW9uLk1hdGguYjJUcmFuc2Zvcm0sXHJcbiAgICAgIGIyVmVjMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMixcclxuICAgICAgYjJWZWMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMzLFxyXG4gICAgICBiMkJvZHkgPSBCb3gyRC5EeW5hbWljcy5iMkJvZHksXHJcbiAgICAgIGIyQm9keURlZiA9IEJveDJELkR5bmFtaWNzLmIyQm9keURlZixcclxuICAgICAgYjJDb250YWN0RmlsdGVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0RmlsdGVyLFxyXG4gICAgICBiMkNvbnRhY3RJbXB1bHNlID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0SW1wdWxzZSxcclxuICAgICAgYjJDb250YWN0TGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lcixcclxuICAgICAgYjJDb250YWN0TWFuYWdlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdE1hbmFnZXIsXHJcbiAgICAgIGIyRGVidWdEcmF3ID0gQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXcsXHJcbiAgICAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyRGVzdHJ1Y3Rpb25MaXN0ZW5lcixcclxuICAgICAgYjJGaWx0ZXJEYXRhID0gQm94MkQuRHluYW1pY3MuYjJGaWx0ZXJEYXRhLFxyXG4gICAgICBiMkZpeHR1cmUgPSBCb3gyRC5EeW5hbWljcy5iMkZpeHR1cmUsXHJcbiAgICAgIGIyRml4dHVyZURlZiA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZURlZixcclxuICAgICAgYjJJc2xhbmQgPSBCb3gyRC5EeW5hbWljcy5iMklzbGFuZCxcclxuICAgICAgYjJUaW1lU3RlcCA9IEJveDJELkR5bmFtaWNzLmIyVGltZVN0ZXAsXHJcbiAgICAgIGIyV29ybGQgPSBCb3gyRC5EeW5hbWljcy5iMldvcmxkLFxyXG4gICAgICBiMkFBQkIgPSBCb3gyRC5Db2xsaXNpb24uYjJBQUJCLFxyXG4gICAgICBiMkJvdW5kID0gQm94MkQuQ29sbGlzaW9uLmIyQm91bmQsXHJcbiAgICAgIGIyQm91bmRWYWx1ZXMgPSBCb3gyRC5Db2xsaXNpb24uYjJCb3VuZFZhbHVlcyxcclxuICAgICAgYjJDb2xsaXNpb24gPSBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24sXHJcbiAgICAgIGIyQ29udGFjdElEID0gQm94MkQuQ29sbGlzaW9uLmIyQ29udGFjdElELFxyXG4gICAgICBiMkNvbnRhY3RQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RQb2ludCxcclxuICAgICAgYjJEaXN0YW5jZSA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlLFxyXG4gICAgICBiMkRpc3RhbmNlSW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZUlucHV0LFxyXG4gICAgICBiMkRpc3RhbmNlT3V0cHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VPdXRwdXQsXHJcbiAgICAgIGIyRGlzdGFuY2VQcm94eSA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlUHJveHksXHJcbiAgICAgIGIyRHluYW1pY1RyZWUgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZSxcclxuICAgICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UsXHJcbiAgICAgIGIyRHluYW1pY1RyZWVOb2RlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVOb2RlLFxyXG4gICAgICBiMkR5bmFtaWNUcmVlUGFpciA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlUGFpcixcclxuICAgICAgYjJNYW5pZm9sZCA9IEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkLFxyXG4gICAgICBiMk1hbmlmb2xkUG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZFBvaW50LFxyXG4gICAgICBiMlBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyUG9pbnQsXHJcbiAgICAgIGIyUmF5Q2FzdElucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdElucHV0LFxyXG4gICAgICBiMlJheUNhc3RPdXRwdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJSYXlDYXN0T3V0cHV0LFxyXG4gICAgICBiMlNlZ21lbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJTZWdtZW50LFxyXG4gICAgICBiMlNlcGFyYXRpb25GdW5jdGlvbiA9IEJveDJELkNvbGxpc2lvbi5iMlNlcGFyYXRpb25GdW5jdGlvbixcclxuICAgICAgYjJTaW1wbGV4ID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleCxcclxuICAgICAgYjJTaW1wbGV4Q2FjaGUgPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4Q2FjaGUsXHJcbiAgICAgIGIyU2ltcGxleFZlcnRleCA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXhWZXJ0ZXgsXHJcbiAgICAgIGIyVGltZU9mSW1wYWN0ID0gQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LFxyXG4gICAgICBiMlRPSUlucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyVE9JSW5wdXQsXHJcbiAgICAgIGIyV29ybGRNYW5pZm9sZCA9IEJveDJELkNvbGxpc2lvbi5iMldvcmxkTWFuaWZvbGQsXHJcbiAgICAgIENsaXBWZXJ0ZXggPSBCb3gyRC5Db2xsaXNpb24uQ2xpcFZlcnRleCxcclxuICAgICAgRmVhdHVyZXMgPSBCb3gyRC5Db2xsaXNpb24uRmVhdHVyZXMsXHJcbiAgICAgIElCcm9hZFBoYXNlID0gQm94MkQuQ29sbGlzaW9uLklCcm9hZFBoYXNlO1xyXG5cclxuICAgQm94MkQuaW5oZXJpdChiMkNpcmNsZVNoYXBlLCBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUpO1xyXG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLnByb3RvdHlwZTtcclxuICAgYjJDaXJjbGVTaGFwZS5iMkNpcmNsZVNoYXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuYjJTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLm1fcCA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHMgPSBuZXcgYjJDaXJjbGVTaGFwZSgpO1xyXG4gICAgICBzLlNldCh0aGlzKTtcclxuICAgICAgcmV0dXJuIHM7XHJcbiAgIH1cclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5TZXQuY2FsbCh0aGlzLCBvdGhlcik7XHJcbiAgICAgIGlmIChCb3gyRC5pcyhvdGhlciwgYjJDaXJjbGVTaGFwZSkpIHtcclxuICAgICAgICAgdmFyIG90aGVyMiA9IChvdGhlciBpbnN0YW5jZW9mIGIyQ2lyY2xlU2hhcGUgPyBvdGhlciA6IG51bGwpO1xyXG4gICAgICAgICB0aGlzLm1fcC5TZXRWKG90aGVyMi5tX3ApO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuVGVzdFBvaW50ID0gZnVuY3Rpb24gKHRyYW5zZm9ybSwgcCkge1xyXG4gICAgICB2YXIgdE1hdCA9IHRyYW5zZm9ybS5SO1xyXG4gICAgICB2YXIgZFggPSB0cmFuc2Zvcm0ucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV9wLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubV9wLnkpO1xyXG4gICAgICB2YXIgZFkgPSB0cmFuc2Zvcm0ucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV9wLnggKyB0TWF0LmNvbDIueSAqIHRoaXMubV9wLnkpO1xyXG4gICAgICBkWCA9IHAueCAtIGRYO1xyXG4gICAgICBkWSA9IHAueSAtIGRZO1xyXG4gICAgICByZXR1cm4gKGRYICogZFggKyBkWSAqIGRZKSA8PSB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cztcclxuICAgfVxyXG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5SYXlDYXN0ID0gZnVuY3Rpb24gKG91dHB1dCwgaW5wdXQsIHRyYW5zZm9ybSkge1xyXG4gICAgICB2YXIgdE1hdCA9IHRyYW5zZm9ybS5SO1xyXG4gICAgICB2YXIgcG9zaXRpb25YID0gdHJhbnNmb3JtLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fcC54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fcC55KTtcclxuICAgICAgdmFyIHBvc2l0aW9uWSA9IHRyYW5zZm9ybS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX3AueCArIHRNYXQuY29sMi55ICogdGhpcy5tX3AueSk7XHJcbiAgICAgIHZhciBzWCA9IGlucHV0LnAxLnggLSBwb3NpdGlvblg7XHJcbiAgICAgIHZhciBzWSA9IGlucHV0LnAxLnkgLSBwb3NpdGlvblk7XHJcbiAgICAgIHZhciBiID0gKHNYICogc1ggKyBzWSAqIHNZKSAtIHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzO1xyXG4gICAgICB2YXIgclggPSBpbnB1dC5wMi54IC0gaW5wdXQucDEueDtcclxuICAgICAgdmFyIHJZID0gaW5wdXQucDIueSAtIGlucHV0LnAxLnk7XHJcbiAgICAgIHZhciBjID0gKHNYICogclggKyBzWSAqIHJZKTtcclxuICAgICAgdmFyIHJyID0gKHJYICogclggKyByWSAqIHJZKTtcclxuICAgICAgdmFyIHNpZ21hID0gYyAqIGMgLSByciAqIGI7XHJcbiAgICAgIGlmIChzaWdtYSA8IDAuMCB8fCByciA8IE51bWJlci5NSU5fVkFMVUUpIHtcclxuICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBhID0gKC0oYyArIE1hdGguc3FydChzaWdtYSkpKTtcclxuICAgICAgaWYgKDAuMCA8PSBhICYmIGEgPD0gaW5wdXQubWF4RnJhY3Rpb24gKiBycikge1xyXG4gICAgICAgICBhIC89IHJyO1xyXG4gICAgICAgICBvdXRwdXQuZnJhY3Rpb24gPSBhO1xyXG4gICAgICAgICBvdXRwdXQubm9ybWFsLnggPSBzWCArIGEgKiByWDtcclxuICAgICAgICAgb3V0cHV0Lm5vcm1hbC55ID0gc1kgKyBhICogclk7XHJcbiAgICAgICAgIG91dHB1dC5ub3JtYWwuTm9ybWFsaXplKCk7XHJcbiAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgfVxyXG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5Db21wdXRlQUFCQiA9IGZ1bmN0aW9uIChhYWJiLCB0cmFuc2Zvcm0pIHtcclxuICAgICAgdmFyIHRNYXQgPSB0cmFuc2Zvcm0uUjtcclxuICAgICAgdmFyIHBYID0gdHJhbnNmb3JtLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fcC54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fcC55KTtcclxuICAgICAgdmFyIHBZID0gdHJhbnNmb3JtLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0aGlzLm1fcC54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fcC55KTtcclxuICAgICAgYWFiYi5sb3dlckJvdW5kLlNldChwWCAtIHRoaXMubV9yYWRpdXMsIHBZIC0gdGhpcy5tX3JhZGl1cyk7XHJcbiAgICAgIGFhYmIudXBwZXJCb3VuZC5TZXQocFggKyB0aGlzLm1fcmFkaXVzLCBwWSArIHRoaXMubV9yYWRpdXMpO1xyXG4gICB9XHJcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLkNvbXB1dGVNYXNzID0gZnVuY3Rpb24gKG1hc3NEYXRhLCBkZW5zaXR5KSB7XHJcbiAgICAgIGlmIChkZW5zaXR5ID09PSB1bmRlZmluZWQpIGRlbnNpdHkgPSAwO1xyXG4gICAgICBtYXNzRGF0YS5tYXNzID0gZGVuc2l0eSAqIGIyU2V0dGluZ3MuYjJfcGkgKiB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cztcclxuICAgICAgbWFzc0RhdGEuY2VudGVyLlNldFYodGhpcy5tX3ApO1xyXG4gICAgICBtYXNzRGF0YS5JID0gbWFzc0RhdGEubWFzcyAqICgwLjUgKiB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cyArICh0aGlzLm1fcC54ICogdGhpcy5tX3AueCArIHRoaXMubV9wLnkgKiB0aGlzLm1fcC55KSk7XHJcbiAgIH1cclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuQ29tcHV0ZVN1Ym1lcmdlZEFyZWEgPSBmdW5jdGlvbiAobm9ybWFsLCBvZmZzZXQsIHhmLCBjKSB7XHJcbiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDtcclxuICAgICAgdmFyIHAgPSBiMk1hdGguTXVsWCh4ZiwgdGhpcy5tX3ApO1xyXG4gICAgICB2YXIgbCA9ICgtKGIyTWF0aC5Eb3Qobm9ybWFsLCBwKSAtIG9mZnNldCkpO1xyXG4gICAgICBpZiAobCA8ICgtdGhpcy5tX3JhZGl1cykgKyBOdW1iZXIuTUlOX1ZBTFVFKSB7XHJcbiAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChsID4gdGhpcy5tX3JhZGl1cykge1xyXG4gICAgICAgICBjLlNldFYocCk7XHJcbiAgICAgICAgIHJldHVybiBNYXRoLlBJICogdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIHIyID0gdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XHJcbiAgICAgIHZhciBsMiA9IGwgKiBsO1xyXG4gICAgICB2YXIgYXJlYSA9IHIyICogKE1hdGguYXNpbihsIC8gdGhpcy5tX3JhZGl1cykgKyBNYXRoLlBJIC8gMikgKyBsICogTWF0aC5zcXJ0KHIyIC0gbDIpO1xyXG4gICAgICB2YXIgY29tID0gKC0yIC8gMyAqIE1hdGgucG93KHIyIC0gbDIsIDEuNSkgLyBhcmVhKTtcclxuICAgICAgYy54ID0gcC54ICsgbm9ybWFsLnggKiBjb207XHJcbiAgICAgIGMueSA9IHAueSArIG5vcm1hbC55ICogY29tO1xyXG4gICAgICByZXR1cm4gYXJlYTtcclxuICAgfVxyXG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5HZXRMb2NhbFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3A7XHJcbiAgIH1cclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuU2V0TG9jYWxQb3NpdGlvbiA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xyXG4gICAgICB0aGlzLm1fcC5TZXRWKHBvc2l0aW9uKTtcclxuICAgfVxyXG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5HZXRSYWRpdXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fcmFkaXVzO1xyXG4gICB9XHJcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLlNldFJhZGl1cyA9IGZ1bmN0aW9uIChyYWRpdXMpIHtcclxuICAgICAgaWYgKHJhZGl1cyA9PT0gdW5kZWZpbmVkKSByYWRpdXMgPSAwO1xyXG4gICAgICB0aGlzLm1fcmFkaXVzID0gcmFkaXVzO1xyXG4gICB9XHJcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLmIyQ2lyY2xlU2hhcGUgPSBmdW5jdGlvbiAocmFkaXVzKSB7XHJcbiAgICAgIGlmIChyYWRpdXMgPT09IHVuZGVmaW5lZCkgcmFkaXVzID0gMDtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIyU2hhcGUuY2FsbCh0aGlzKTtcclxuICAgICAgdGhpcy5tX3R5cGUgPSBiMlNoYXBlLmVfY2lyY2xlU2hhcGU7XHJcbiAgICAgIHRoaXMubV9yYWRpdXMgPSByYWRpdXM7XHJcbiAgIH1cclxuICAgYjJFZGdlQ2hhaW5EZWYuYjJFZGdlQ2hhaW5EZWYgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJFZGdlQ2hhaW5EZWYucHJvdG90eXBlLmIyRWRnZUNoYWluRGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnZlcnRleENvdW50ID0gMDtcclxuICAgICAgdGhpcy5pc0FMb29wID0gdHJ1ZTtcclxuICAgICAgdGhpcy52ZXJ0aWNlcyA9IFtdO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJFZGdlU2hhcGUsIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSk7XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLnByb3RvdHlwZTtcclxuICAgYjJFZGdlU2hhcGUuYjJFZGdlU2hhcGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5iMlNoYXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMuc19zdXBwb3J0VmVjID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fdjEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV92MiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2NvcmVWMSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2NvcmVWMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX25vcm1hbCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2RpcmVjdGlvbiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2Nvcm5lckRpcjEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIyID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuVGVzdFBvaW50ID0gZnVuY3Rpb24gKHRyYW5zZm9ybSwgcCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLlJheUNhc3QgPSBmdW5jdGlvbiAob3V0cHV0LCBpbnB1dCwgdHJhbnNmb3JtKSB7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgclggPSBpbnB1dC5wMi54IC0gaW5wdXQucDEueDtcclxuICAgICAgdmFyIHJZID0gaW5wdXQucDIueSAtIGlucHV0LnAxLnk7XHJcbiAgICAgIHRNYXQgPSB0cmFuc2Zvcm0uUjtcclxuICAgICAgdmFyIHYxWCA9IHRyYW5zZm9ybS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX3YxLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubV92MS55KTtcclxuICAgICAgdmFyIHYxWSA9IHRyYW5zZm9ybS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX3YxLnggKyB0TWF0LmNvbDIueSAqIHRoaXMubV92MS55KTtcclxuICAgICAgdmFyIG5YID0gdHJhbnNmb3JtLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0aGlzLm1fdjIueCArIHRNYXQuY29sMi55ICogdGhpcy5tX3YyLnkpIC0gdjFZO1xyXG4gICAgICB2YXIgblkgPSAoLSh0cmFuc2Zvcm0ucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV92Mi54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fdjIueSkgLSB2MVgpKTtcclxuICAgICAgdmFyIGtfc2xvcCA9IDEwMC4wICogTnVtYmVyLk1JTl9WQUxVRTtcclxuICAgICAgdmFyIGRlbm9tID0gKC0oclggKiBuWCArIHJZICogblkpKTtcclxuICAgICAgaWYgKGRlbm9tID4ga19zbG9wKSB7XHJcbiAgICAgICAgIHZhciBiWCA9IGlucHV0LnAxLnggLSB2MVg7XHJcbiAgICAgICAgIHZhciBiWSA9IGlucHV0LnAxLnkgLSB2MVk7XHJcbiAgICAgICAgIHZhciBhID0gKGJYICogblggKyBiWSAqIG5ZKTtcclxuICAgICAgICAgaWYgKDAuMCA8PSBhICYmIGEgPD0gaW5wdXQubWF4RnJhY3Rpb24gKiBkZW5vbSkge1xyXG4gICAgICAgICAgICB2YXIgbXUyID0gKC1yWCAqIGJZKSArIHJZICogYlg7XHJcbiAgICAgICAgICAgIGlmICgoLWtfc2xvcCAqIGRlbm9tKSA8PSBtdTIgJiYgbXUyIDw9IGRlbm9tICogKDEuMCArIGtfc2xvcCkpIHtcclxuICAgICAgICAgICAgICAgYSAvPSBkZW5vbTtcclxuICAgICAgICAgICAgICAgb3V0cHV0LmZyYWN0aW9uID0gYTtcclxuICAgICAgICAgICAgICAgdmFyIG5MZW4gPSBNYXRoLnNxcnQoblggKiBuWCArIG5ZICogblkpO1xyXG4gICAgICAgICAgICAgICBvdXRwdXQubm9ybWFsLnggPSBuWCAvIG5MZW47XHJcbiAgICAgICAgICAgICAgIG91dHB1dC5ub3JtYWwueSA9IG5ZIC8gbkxlbjtcclxuICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuQ29tcHV0ZUFBQkIgPSBmdW5jdGlvbiAoYWFiYiwgdHJhbnNmb3JtKSB7XHJcbiAgICAgIHZhciB0TWF0ID0gdHJhbnNmb3JtLlI7XHJcbiAgICAgIHZhciB2MVggPSB0cmFuc2Zvcm0ucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV92MS54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fdjEueSk7XHJcbiAgICAgIHZhciB2MVkgPSB0cmFuc2Zvcm0ucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV92MS54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fdjEueSk7XHJcbiAgICAgIHZhciB2MlggPSB0cmFuc2Zvcm0ucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV92Mi54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fdjIueSk7XHJcbiAgICAgIHZhciB2MlkgPSB0cmFuc2Zvcm0ucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV92Mi54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fdjIueSk7XHJcbiAgICAgIGlmICh2MVggPCB2MlgpIHtcclxuICAgICAgICAgYWFiYi5sb3dlckJvdW5kLnggPSB2MVg7XHJcbiAgICAgICAgIGFhYmIudXBwZXJCb3VuZC54ID0gdjJYO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBhYWJiLmxvd2VyQm91bmQueCA9IHYyWDtcclxuICAgICAgICAgYWFiYi51cHBlckJvdW5kLnggPSB2MVg7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHYxWSA8IHYyWSkge1xyXG4gICAgICAgICBhYWJiLmxvd2VyQm91bmQueSA9IHYxWTtcclxuICAgICAgICAgYWFiYi51cHBlckJvdW5kLnkgPSB2Mlk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIGFhYmIubG93ZXJCb3VuZC55ID0gdjJZO1xyXG4gICAgICAgICBhYWJiLnVwcGVyQm91bmQueSA9IHYxWTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5Db21wdXRlTWFzcyA9IGZ1bmN0aW9uIChtYXNzRGF0YSwgZGVuc2l0eSkge1xyXG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMDtcclxuICAgICAgbWFzc0RhdGEubWFzcyA9IDA7XHJcbiAgICAgIG1hc3NEYXRhLmNlbnRlci5TZXRWKHRoaXMubV92MSk7XHJcbiAgICAgIG1hc3NEYXRhLkkgPSAwO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5Db21wdXRlU3VibWVyZ2VkQXJlYSA9IGZ1bmN0aW9uIChub3JtYWwsIG9mZnNldCwgeGYsIGMpIHtcclxuICAgICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSBvZmZzZXQgPSAwO1xyXG4gICAgICB2YXIgdjAgPSBuZXcgYjJWZWMyKG5vcm1hbC54ICogb2Zmc2V0LCBub3JtYWwueSAqIG9mZnNldCk7XHJcbiAgICAgIHZhciB2MSA9IGIyTWF0aC5NdWxYKHhmLCB0aGlzLm1fdjEpO1xyXG4gICAgICB2YXIgdjIgPSBiMk1hdGguTXVsWCh4ZiwgdGhpcy5tX3YyKTtcclxuICAgICAgdmFyIGQxID0gYjJNYXRoLkRvdChub3JtYWwsIHYxKSAtIG9mZnNldDtcclxuICAgICAgdmFyIGQyID0gYjJNYXRoLkRvdChub3JtYWwsIHYyKSAtIG9mZnNldDtcclxuICAgICAgaWYgKGQxID4gMCkge1xyXG4gICAgICAgICBpZiAoZDIgPiAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2MS54ID0gKC1kMiAvIChkMSAtIGQyKSAqIHYxLngpICsgZDEgLyAoZDEgLSBkMikgKiB2Mi54O1xyXG4gICAgICAgICAgICB2MS55ID0gKC1kMiAvIChkMSAtIGQyKSAqIHYxLnkpICsgZDEgLyAoZDEgLSBkMikgKiB2Mi55O1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIGlmIChkMiA+IDApIHtcclxuICAgICAgICAgICAgdjIueCA9ICgtZDIgLyAoZDEgLSBkMikgKiB2MS54KSArIGQxIC8gKGQxIC0gZDIpICogdjIueDtcclxuICAgICAgICAgICAgdjIueSA9ICgtZDIgLyAoZDEgLSBkMikgKiB2MS55KSArIGQxIC8gKGQxIC0gZDIpICogdjIueTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHt9XHJcbiAgICAgIH1cclxuICAgICAgYy54ID0gKHYwLnggKyB2MS54ICsgdjIueCkgLyAzO1xyXG4gICAgICBjLnkgPSAodjAueSArIHYxLnkgKyB2Mi55KSAvIDM7XHJcbiAgICAgIHJldHVybiAwLjUgKiAoKHYxLnggLSB2MC54KSAqICh2Mi55IC0gdjAueSkgLSAodjEueSAtIHYwLnkpICogKHYyLnggLSB2MC54KSk7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldExlbmd0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9sZW5ndGg7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldFZlcnRleDEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdjE7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldFZlcnRleDIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdjI7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldENvcmVWZXJ0ZXgxID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2NvcmVWMTtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0Q29yZVZlcnRleDIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fY29yZVYyO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXROb3JtYWxWZWN0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbm9ybWFsO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXREaXJlY3Rpb25WZWN0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZGlyZWN0aW9uO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXRDb3JuZXIxVmVjdG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2Nvcm5lckRpcjE7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldENvcm5lcjJWZWN0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fY29ybmVyRGlyMjtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuQ29ybmVyMUlzQ29udmV4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2Nvcm5lckNvbnZleDE7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkNvcm5lcjJJc0NvbnZleCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jb3JuZXJDb252ZXgyO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXRGaXJzdFZlcnRleCA9IGZ1bmN0aW9uICh4Zikge1xyXG4gICAgICB2YXIgdE1hdCA9IHhmLlI7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKHhmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fY29yZVYxLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubV9jb3JlVjEueSksIHhmLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0aGlzLm1fY29yZVYxLnggKyB0TWF0LmNvbDIueSAqIHRoaXMubV9jb3JlVjEueSkpO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXROZXh0RWRnZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9uZXh0RWRnZTtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0UHJldkVkZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fcHJldkVkZ2U7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLlN1cHBvcnQgPSBmdW5jdGlvbiAoeGYsIGRYLCBkWSkge1xyXG4gICAgICBpZiAoZFggPT09IHVuZGVmaW5lZCkgZFggPSAwO1xyXG4gICAgICBpZiAoZFkgPT09IHVuZGVmaW5lZCkgZFkgPSAwO1xyXG4gICAgICB2YXIgdE1hdCA9IHhmLlI7XHJcbiAgICAgIHZhciB2MVggPSB4Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX2NvcmVWMS54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fY29yZVYxLnkpO1xyXG4gICAgICB2YXIgdjFZID0geGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV9jb3JlVjEueCArIHRNYXQuY29sMi55ICogdGhpcy5tX2NvcmVWMS55KTtcclxuICAgICAgdmFyIHYyWCA9IHhmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fY29yZVYyLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubV9jb3JlVjIueSk7XHJcbiAgICAgIHZhciB2MlkgPSB4Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX2NvcmVWMi54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fY29yZVYyLnkpO1xyXG4gICAgICBpZiAoKHYxWCAqIGRYICsgdjFZICogZFkpID4gKHYyWCAqIGRYICsgdjJZICogZFkpKSB7XHJcbiAgICAgICAgIHRoaXMuc19zdXBwb3J0VmVjLnggPSB2MVg7XHJcbiAgICAgICAgIHRoaXMuc19zdXBwb3J0VmVjLnkgPSB2MVk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMuc19zdXBwb3J0VmVjLnggPSB2Mlg7XHJcbiAgICAgICAgIHRoaXMuc19zdXBwb3J0VmVjLnkgPSB2Mlk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRoaXMuc19zdXBwb3J0VmVjO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5iMkVkZ2VTaGFwZSA9IGZ1bmN0aW9uICh2MSwgdjIpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIyU2hhcGUuY2FsbCh0aGlzKTtcclxuICAgICAgdGhpcy5tX3R5cGUgPSBiMlNoYXBlLmVfZWRnZVNoYXBlO1xyXG4gICAgICB0aGlzLm1fcHJldkVkZ2UgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbmV4dEVkZ2UgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fdjEgPSB2MTtcclxuICAgICAgdGhpcy5tX3YyID0gdjI7XHJcbiAgICAgIHRoaXMubV9kaXJlY3Rpb24uU2V0KHRoaXMubV92Mi54IC0gdGhpcy5tX3YxLngsIHRoaXMubV92Mi55IC0gdGhpcy5tX3YxLnkpO1xyXG4gICAgICB0aGlzLm1fbGVuZ3RoID0gdGhpcy5tX2RpcmVjdGlvbi5Ob3JtYWxpemUoKTtcclxuICAgICAgdGhpcy5tX25vcm1hbC5TZXQodGhpcy5tX2RpcmVjdGlvbi55LCAoLXRoaXMubV9kaXJlY3Rpb24ueCkpO1xyXG4gICAgICB0aGlzLm1fY29yZVYxLlNldCgoLWIyU2V0dGluZ3MuYjJfdG9pU2xvcCAqICh0aGlzLm1fbm9ybWFsLnggLSB0aGlzLm1fZGlyZWN0aW9uLngpKSArIHRoaXMubV92MS54LCAoLWIyU2V0dGluZ3MuYjJfdG9pU2xvcCAqICh0aGlzLm1fbm9ybWFsLnkgLSB0aGlzLm1fZGlyZWN0aW9uLnkpKSArIHRoaXMubV92MS55KTtcclxuICAgICAgdGhpcy5tX2NvcmVWMi5TZXQoKC1iMlNldHRpbmdzLmIyX3RvaVNsb3AgKiAodGhpcy5tX25vcm1hbC54ICsgdGhpcy5tX2RpcmVjdGlvbi54KSkgKyB0aGlzLm1fdjIueCwgKC1iMlNldHRpbmdzLmIyX3RvaVNsb3AgKiAodGhpcy5tX25vcm1hbC55ICsgdGhpcy5tX2RpcmVjdGlvbi55KSkgKyB0aGlzLm1fdjIueSk7XHJcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIxID0gdGhpcy5tX25vcm1hbDtcclxuICAgICAgdGhpcy5tX2Nvcm5lckRpcjIuU2V0KCgtdGhpcy5tX25vcm1hbC54KSwgKC10aGlzLm1fbm9ybWFsLnkpKTtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuU2V0UHJldkVkZ2UgPSBmdW5jdGlvbiAoZWRnZSwgY29yZSwgY29ybmVyRGlyLCBjb252ZXgpIHtcclxuICAgICAgdGhpcy5tX3ByZXZFZGdlID0gZWRnZTtcclxuICAgICAgdGhpcy5tX2NvcmVWMSA9IGNvcmU7XHJcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIxID0gY29ybmVyRGlyO1xyXG4gICAgICB0aGlzLm1fY29ybmVyQ29udmV4MSA9IGNvbnZleDtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuU2V0TmV4dEVkZ2UgPSBmdW5jdGlvbiAoZWRnZSwgY29yZSwgY29ybmVyRGlyLCBjb252ZXgpIHtcclxuICAgICAgdGhpcy5tX25leHRFZGdlID0gZWRnZTtcclxuICAgICAgdGhpcy5tX2NvcmVWMiA9IGNvcmU7XHJcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIyID0gY29ybmVyRGlyO1xyXG4gICAgICB0aGlzLm1fY29ybmVyQ29udmV4MiA9IGNvbnZleDtcclxuICAgfVxyXG4gICBiMk1hc3NEYXRhLmIyTWFzc0RhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubWFzcyA9IDAuMDtcclxuICAgICAgdGhpcy5jZW50ZXIgPSBuZXcgYjJWZWMyKDAsIDApO1xyXG4gICAgICB0aGlzLkkgPSAwLjA7XHJcbiAgIH07XHJcbiAgIEJveDJELmluaGVyaXQoYjJQb2x5Z29uU2hhcGUsIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSk7XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLnByb3RvdHlwZTtcclxuICAgYjJQb2x5Z29uU2hhcGUuYjJQb2x5Z29uU2hhcGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5iMlNoYXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5Db3B5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgcyA9IG5ldyBiMlBvbHlnb25TaGFwZSgpO1xyXG4gICAgICBzLlNldCh0aGlzKTtcclxuICAgICAgcmV0dXJuIHM7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuU2V0LmNhbGwodGhpcywgb3RoZXIpO1xyXG4gICAgICBpZiAoQm94MkQuaXMob3RoZXIsIGIyUG9seWdvblNoYXBlKSkge1xyXG4gICAgICAgICB2YXIgb3RoZXIyID0gKG90aGVyIGluc3RhbmNlb2YgYjJQb2x5Z29uU2hhcGUgPyBvdGhlciA6IG51bGwpO1xyXG4gICAgICAgICB0aGlzLm1fY2VudHJvaWQuU2V0VihvdGhlcjIubV9jZW50cm9pZCk7XHJcbiAgICAgICAgIHRoaXMubV92ZXJ0ZXhDb3VudCA9IG90aGVyMi5tX3ZlcnRleENvdW50O1xyXG4gICAgICAgICB0aGlzLlJlc2VydmUodGhpcy5tX3ZlcnRleENvdW50KTtcclxuICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLm1fdmVydGljZXNbaV0uU2V0VihvdGhlcjIubV92ZXJ0aWNlc1tpXSk7XHJcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWxzW2ldLlNldFYob3RoZXIyLm1fbm9ybWFsc1tpXSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5TZXRBc0FycmF5ID0gZnVuY3Rpb24gKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCkge1xyXG4gICAgICBpZiAodmVydGV4Q291bnQgPT09IHVuZGVmaW5lZCkgdmVydGV4Q291bnQgPSAwO1xyXG4gICAgICB2YXIgdiA9IG5ldyBWZWN0b3IoKTtcclxuICAgICAgdmFyIGkgPSAwLFxyXG4gICAgICAgICB0VmVjO1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgdmVydGljZXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgdFZlYyA9IHZlcnRpY2VzW2ldO1xyXG4gICAgICAgICB2LnB1c2godFZlYyk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5TZXRBc1ZlY3Rvcih2LCB2ZXJ0ZXhDb3VudCk7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUuQXNBcnJheSA9IGZ1bmN0aW9uICh2ZXJ0aWNlcywgdmVydGV4Q291bnQpIHtcclxuICAgICAgaWYgKHZlcnRleENvdW50ID09PSB1bmRlZmluZWQpIHZlcnRleENvdW50ID0gMDtcclxuICAgICAgdmFyIHBvbHlnb25TaGFwZSA9IG5ldyBiMlBvbHlnb25TaGFwZSgpO1xyXG4gICAgICBwb2x5Z29uU2hhcGUuU2V0QXNBcnJheSh2ZXJ0aWNlcywgdmVydGV4Q291bnQpO1xyXG4gICAgICByZXR1cm4gcG9seWdvblNoYXBlO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5TZXRBc1ZlY3RvciA9IGZ1bmN0aW9uICh2ZXJ0aWNlcywgdmVydGV4Q291bnQpIHtcclxuICAgICAgaWYgKHZlcnRleENvdW50ID09PSB1bmRlZmluZWQpIHZlcnRleENvdW50ID0gMDtcclxuICAgICAgaWYgKHZlcnRleENvdW50ID09IDApIHZlcnRleENvdW50ID0gdmVydGljZXMubGVuZ3RoO1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KDIgPD0gdmVydGV4Q291bnQpO1xyXG4gICAgICB0aGlzLm1fdmVydGV4Q291bnQgPSB2ZXJ0ZXhDb3VudDtcclxuICAgICAgdGhpcy5SZXNlcnZlKHZlcnRleENvdW50KTtcclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyBpKyspIHtcclxuICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldLlNldFYodmVydGljZXNbaV0pO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgaTEgPSBwYXJzZUludChpKTtcclxuICAgICAgICAgdmFyIGkyID0gcGFyc2VJbnQoaSArIDEgPCB0aGlzLm1fdmVydGV4Q291bnQgPyBpICsgMSA6IDApO1xyXG4gICAgICAgICB2YXIgZWRnZSA9IGIyTWF0aC5TdWJ0cmFjdFZWKHRoaXMubV92ZXJ0aWNlc1tpMl0sIHRoaXMubV92ZXJ0aWNlc1tpMV0pO1xyXG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGVkZ2UuTGVuZ3RoU3F1YXJlZCgpID4gTnVtYmVyLk1JTl9WQUxVRSk7XHJcbiAgICAgICAgIHRoaXMubV9ub3JtYWxzW2ldLlNldFYoYjJNYXRoLkNyb3NzVkYoZWRnZSwgMS4wKSk7XHJcbiAgICAgICAgIHRoaXMubV9ub3JtYWxzW2ldLk5vcm1hbGl6ZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9jZW50cm9pZCA9IGIyUG9seWdvblNoYXBlLkNvbXB1dGVDZW50cm9pZCh0aGlzLm1fdmVydGljZXMsIHRoaXMubV92ZXJ0ZXhDb3VudCk7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUuQXNWZWN0b3IgPSBmdW5jdGlvbiAodmVydGljZXMsIHZlcnRleENvdW50KSB7XHJcbiAgICAgIGlmICh2ZXJ0ZXhDb3VudCA9PT0gdW5kZWZpbmVkKSB2ZXJ0ZXhDb3VudCA9IDA7XHJcbiAgICAgIHZhciBwb2x5Z29uU2hhcGUgPSBuZXcgYjJQb2x5Z29uU2hhcGUoKTtcclxuICAgICAgcG9seWdvblNoYXBlLlNldEFzVmVjdG9yKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCk7XHJcbiAgICAgIHJldHVybiBwb2x5Z29uU2hhcGU7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLlNldEFzQm94ID0gZnVuY3Rpb24gKGh4LCBoeSkge1xyXG4gICAgICBpZiAoaHggPT09IHVuZGVmaW5lZCkgaHggPSAwO1xyXG4gICAgICBpZiAoaHkgPT09IHVuZGVmaW5lZCkgaHkgPSAwO1xyXG4gICAgICB0aGlzLm1fdmVydGV4Q291bnQgPSA0O1xyXG4gICAgICB0aGlzLlJlc2VydmUoNCk7XHJcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1swXS5TZXQoKC1oeCksICgtaHkpKTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzFdLlNldChoeCwgKC1oeSkpO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXNbMl0uU2V0KGh4LCBoeSk7XHJcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1szXS5TZXQoKC1oeCksIGh5KTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbMF0uU2V0KDAuMCwgKC0xLjApKTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbMV0uU2V0KDEuMCwgMC4wKTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbMl0uU2V0KDAuMCwgMS4wKTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbM10uU2V0KCgtMS4wKSwgMC4wKTtcclxuICAgICAgdGhpcy5tX2NlbnRyb2lkLlNldFplcm8oKTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5Bc0JveCA9IGZ1bmN0aW9uIChoeCwgaHkpIHtcclxuICAgICAgaWYgKGh4ID09PSB1bmRlZmluZWQpIGh4ID0gMDtcclxuICAgICAgaWYgKGh5ID09PSB1bmRlZmluZWQpIGh5ID0gMDtcclxuICAgICAgdmFyIHBvbHlnb25TaGFwZSA9IG5ldyBiMlBvbHlnb25TaGFwZSgpO1xyXG4gICAgICBwb2x5Z29uU2hhcGUuU2V0QXNCb3goaHgsIGh5KTtcclxuICAgICAgcmV0dXJuIHBvbHlnb25TaGFwZTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuU2V0QXNPcmllbnRlZEJveCA9IGZ1bmN0aW9uIChoeCwgaHksIGNlbnRlciwgYW5nbGUpIHtcclxuICAgICAgaWYgKGh4ID09PSB1bmRlZmluZWQpIGh4ID0gMDtcclxuICAgICAgaWYgKGh5ID09PSB1bmRlZmluZWQpIGh5ID0gMDtcclxuICAgICAgaWYgKGNlbnRlciA9PT0gdW5kZWZpbmVkKSBjZW50ZXIgPSBudWxsO1xyXG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwLjA7XHJcbiAgICAgIHRoaXMubV92ZXJ0ZXhDb3VudCA9IDQ7XHJcbiAgICAgIHRoaXMuUmVzZXJ2ZSg0KTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzBdLlNldCgoLWh4KSwgKC1oeSkpO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXNbMV0uU2V0KGh4LCAoLWh5KSk7XHJcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1syXS5TZXQoaHgsIGh5KTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzNdLlNldCgoLWh4KSwgaHkpO1xyXG4gICAgICB0aGlzLm1fbm9ybWFsc1swXS5TZXQoMC4wLCAoLTEuMCkpO1xyXG4gICAgICB0aGlzLm1fbm9ybWFsc1sxXS5TZXQoMS4wLCAwLjApO1xyXG4gICAgICB0aGlzLm1fbm9ybWFsc1syXS5TZXQoMC4wLCAxLjApO1xyXG4gICAgICB0aGlzLm1fbm9ybWFsc1szXS5TZXQoKC0xLjApLCAwLjApO1xyXG4gICAgICB0aGlzLm1fY2VudHJvaWQgPSBjZW50ZXI7XHJcbiAgICAgIHZhciB4ZiA9IG5ldyBiMlRyYW5zZm9ybSgpO1xyXG4gICAgICB4Zi5wb3NpdGlvbiA9IGNlbnRlcjtcclxuICAgICAgeGYuUi5TZXQoYW5nbGUpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV92ZXJ0ZXhDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXSA9IGIyTWF0aC5NdWxYKHhmLCB0aGlzLm1fdmVydGljZXNbaV0pO1xyXG4gICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXSA9IGIyTWF0aC5NdWxNVih4Zi5SLCB0aGlzLm1fbm9ybWFsc1tpXSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5Bc09yaWVudGVkQm94ID0gZnVuY3Rpb24gKGh4LCBoeSwgY2VudGVyLCBhbmdsZSkge1xyXG4gICAgICBpZiAoaHggPT09IHVuZGVmaW5lZCkgaHggPSAwO1xyXG4gICAgICBpZiAoaHkgPT09IHVuZGVmaW5lZCkgaHkgPSAwO1xyXG4gICAgICBpZiAoY2VudGVyID09PSB1bmRlZmluZWQpIGNlbnRlciA9IG51bGw7XHJcbiAgICAgIGlmIChhbmdsZSA9PT0gdW5kZWZpbmVkKSBhbmdsZSA9IDAuMDtcclxuICAgICAgdmFyIHBvbHlnb25TaGFwZSA9IG5ldyBiMlBvbHlnb25TaGFwZSgpO1xyXG4gICAgICBwb2x5Z29uU2hhcGUuU2V0QXNPcmllbnRlZEJveChoeCwgaHksIGNlbnRlciwgYW5nbGUpO1xyXG4gICAgICByZXR1cm4gcG9seWdvblNoYXBlO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5TZXRBc0VkZ2UgPSBmdW5jdGlvbiAodjEsIHYyKSB7XHJcbiAgICAgIHRoaXMubV92ZXJ0ZXhDb3VudCA9IDI7XHJcbiAgICAgIHRoaXMuUmVzZXJ2ZSgyKTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzBdLlNldFYodjEpO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXNbMV0uU2V0Vih2Mik7XHJcbiAgICAgIHRoaXMubV9jZW50cm9pZC54ID0gMC41ICogKHYxLnggKyB2Mi54KTtcclxuICAgICAgdGhpcy5tX2NlbnRyb2lkLnkgPSAwLjUgKiAodjEueSArIHYyLnkpO1xyXG4gICAgICB0aGlzLm1fbm9ybWFsc1swXSA9IGIyTWF0aC5Dcm9zc1ZGKGIyTWF0aC5TdWJ0cmFjdFZWKHYyLCB2MSksIDEuMCk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWxzWzBdLk5vcm1hbGl6ZSgpO1xyXG4gICAgICB0aGlzLm1fbm9ybWFsc1sxXS54ID0gKC10aGlzLm1fbm9ybWFsc1swXS54KTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbMV0ueSA9ICgtdGhpcy5tX25vcm1hbHNbMF0ueSk7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUuQXNFZGdlID0gZnVuY3Rpb24gKHYxLCB2Mikge1xyXG4gICAgICB2YXIgcG9seWdvblNoYXBlID0gbmV3IGIyUG9seWdvblNoYXBlKCk7XHJcbiAgICAgIHBvbHlnb25TaGFwZS5TZXRBc0VkZ2UodjEsIHYyKTtcclxuICAgICAgcmV0dXJuIHBvbHlnb25TaGFwZTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuVGVzdFBvaW50ID0gZnVuY3Rpb24gKHhmLCBwKSB7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICB2YXIgdE1hdCA9IHhmLlI7XHJcbiAgICAgIHZhciB0WCA9IHAueCAtIHhmLnBvc2l0aW9uLng7XHJcbiAgICAgIHZhciB0WSA9IHAueSAtIHhmLnBvc2l0aW9uLnk7XHJcbiAgICAgIHZhciBwTG9jYWxYID0gKHRYICogdE1hdC5jb2wxLnggKyB0WSAqIHRNYXQuY29sMS55KTtcclxuICAgICAgdmFyIHBMb2NhbFkgPSAodFggKiB0TWF0LmNvbDIueCArIHRZICogdE1hdC5jb2wyLnkpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV92ZXJ0ZXhDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIHRWZWMgPSB0aGlzLm1fdmVydGljZXNbaV07XHJcbiAgICAgICAgIHRYID0gcExvY2FsWCAtIHRWZWMueDtcclxuICAgICAgICAgdFkgPSBwTG9jYWxZIC0gdFZlYy55O1xyXG4gICAgICAgICB0VmVjID0gdGhpcy5tX25vcm1hbHNbaV07XHJcbiAgICAgICAgIHZhciBkb3QgPSAodFZlYy54ICogdFggKyB0VmVjLnkgKiB0WSk7XHJcbiAgICAgICAgIGlmIChkb3QgPiAwLjApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLlJheUNhc3QgPSBmdW5jdGlvbiAob3V0cHV0LCBpbnB1dCwgdHJhbnNmb3JtKSB7XHJcbiAgICAgIHZhciBsb3dlciA9IDAuMDtcclxuICAgICAgdmFyIHVwcGVyID0gaW5wdXQubWF4RnJhY3Rpb247XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciB0WSA9IDA7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgdFggPSBpbnB1dC5wMS54IC0gdHJhbnNmb3JtLnBvc2l0aW9uLng7XHJcbiAgICAgIHRZID0gaW5wdXQucDEueSAtIHRyYW5zZm9ybS5wb3NpdGlvbi55O1xyXG4gICAgICB0TWF0ID0gdHJhbnNmb3JtLlI7XHJcbiAgICAgIHZhciBwMVggPSAodFggKiB0TWF0LmNvbDEueCArIHRZICogdE1hdC5jb2wxLnkpO1xyXG4gICAgICB2YXIgcDFZID0gKHRYICogdE1hdC5jb2wyLnggKyB0WSAqIHRNYXQuY29sMi55KTtcclxuICAgICAgdFggPSBpbnB1dC5wMi54IC0gdHJhbnNmb3JtLnBvc2l0aW9uLng7XHJcbiAgICAgIHRZID0gaW5wdXQucDIueSAtIHRyYW5zZm9ybS5wb3NpdGlvbi55O1xyXG4gICAgICB0TWF0ID0gdHJhbnNmb3JtLlI7XHJcbiAgICAgIHZhciBwMlggPSAodFggKiB0TWF0LmNvbDEueCArIHRZICogdE1hdC5jb2wxLnkpO1xyXG4gICAgICB2YXIgcDJZID0gKHRYICogdE1hdC5jb2wyLnggKyB0WSAqIHRNYXQuY29sMi55KTtcclxuICAgICAgdmFyIGRYID0gcDJYIC0gcDFYO1xyXG4gICAgICB2YXIgZFkgPSBwMlkgLSBwMVk7XHJcbiAgICAgIHZhciBpbmRleCA9IHBhcnNlSW50KCgtMSkpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV92ZXJ0ZXhDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIHRWZWMgPSB0aGlzLm1fdmVydGljZXNbaV07XHJcbiAgICAgICAgIHRYID0gdFZlYy54IC0gcDFYO1xyXG4gICAgICAgICB0WSA9IHRWZWMueSAtIHAxWTtcclxuICAgICAgICAgdFZlYyA9IHRoaXMubV9ub3JtYWxzW2ldO1xyXG4gICAgICAgICB2YXIgbnVtZXJhdG9yID0gKHRWZWMueCAqIHRYICsgdFZlYy55ICogdFkpO1xyXG4gICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAodFZlYy54ICogZFggKyB0VmVjLnkgKiBkWSk7XHJcbiAgICAgICAgIGlmIChkZW5vbWluYXRvciA9PSAwLjApIHtcclxuICAgICAgICAgICAgaWYgKG51bWVyYXRvciA8IDAuMCkge1xyXG4gICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGRlbm9taW5hdG9yIDwgMC4wICYmIG51bWVyYXRvciA8IGxvd2VyICogZGVub21pbmF0b3IpIHtcclxuICAgICAgICAgICAgICAgbG93ZXIgPSBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcclxuICAgICAgICAgICAgICAgaW5kZXggPSBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGRlbm9taW5hdG9yID4gMC4wICYmIG51bWVyYXRvciA8IHVwcGVyICogZGVub21pbmF0b3IpIHtcclxuICAgICAgICAgICAgICAgdXBwZXIgPSBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmICh1cHBlciA8IGxvd2VyIC0gTnVtYmVyLk1JTl9WQUxVRSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAoaW5kZXggPj0gMCkge1xyXG4gICAgICAgICBvdXRwdXQuZnJhY3Rpb24gPSBsb3dlcjtcclxuICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybS5SO1xyXG4gICAgICAgICB0VmVjID0gdGhpcy5tX25vcm1hbHNbaW5kZXhdO1xyXG4gICAgICAgICBvdXRwdXQubm9ybWFsLnggPSAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgIG91dHB1dC5ub3JtYWwueSA9ICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5Db21wdXRlQUFCQiA9IGZ1bmN0aW9uIChhYWJiLCB4Zikge1xyXG4gICAgICB2YXIgdE1hdCA9IHhmLlI7XHJcbiAgICAgIHZhciB0VmVjID0gdGhpcy5tX3ZlcnRpY2VzWzBdO1xyXG4gICAgICB2YXIgbG93ZXJYID0geGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgdmFyIGxvd2VyWSA9IHhmLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHZhciB1cHBlclggPSBsb3dlclg7XHJcbiAgICAgIHZhciB1cHBlclkgPSBsb3dlclk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyArK2kpIHtcclxuICAgICAgICAgdFZlYyA9IHRoaXMubV92ZXJ0aWNlc1tpXTtcclxuICAgICAgICAgdmFyIHZYID0geGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgdmFyIHZZID0geGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgbG93ZXJYID0gbG93ZXJYIDwgdlggPyBsb3dlclggOiB2WDtcclxuICAgICAgICAgbG93ZXJZID0gbG93ZXJZIDwgdlkgPyBsb3dlclkgOiB2WTtcclxuICAgICAgICAgdXBwZXJYID0gdXBwZXJYID4gdlggPyB1cHBlclggOiB2WDtcclxuICAgICAgICAgdXBwZXJZID0gdXBwZXJZID4gdlkgPyB1cHBlclkgOiB2WTtcclxuICAgICAgfVxyXG4gICAgICBhYWJiLmxvd2VyQm91bmQueCA9IGxvd2VyWCAtIHRoaXMubV9yYWRpdXM7XHJcbiAgICAgIGFhYmIubG93ZXJCb3VuZC55ID0gbG93ZXJZIC0gdGhpcy5tX3JhZGl1cztcclxuICAgICAgYWFiYi51cHBlckJvdW5kLnggPSB1cHBlclggKyB0aGlzLm1fcmFkaXVzO1xyXG4gICAgICBhYWJiLnVwcGVyQm91bmQueSA9IHVwcGVyWSArIHRoaXMubV9yYWRpdXM7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLkNvbXB1dGVNYXNzID0gZnVuY3Rpb24gKG1hc3NEYXRhLCBkZW5zaXR5KSB7XHJcbiAgICAgIGlmIChkZW5zaXR5ID09PSB1bmRlZmluZWQpIGRlbnNpdHkgPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX3ZlcnRleENvdW50ID09IDIpIHtcclxuICAgICAgICAgbWFzc0RhdGEuY2VudGVyLnggPSAwLjUgKiAodGhpcy5tX3ZlcnRpY2VzWzBdLnggKyB0aGlzLm1fdmVydGljZXNbMV0ueCk7XHJcbiAgICAgICAgIG1hc3NEYXRhLmNlbnRlci55ID0gMC41ICogKHRoaXMubV92ZXJ0aWNlc1swXS55ICsgdGhpcy5tX3ZlcnRpY2VzWzFdLnkpO1xyXG4gICAgICAgICBtYXNzRGF0YS5tYXNzID0gMC4wO1xyXG4gICAgICAgICBtYXNzRGF0YS5JID0gMC4wO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGNlbnRlclggPSAwLjA7XHJcbiAgICAgIHZhciBjZW50ZXJZID0gMC4wO1xyXG4gICAgICB2YXIgYXJlYSA9IDAuMDtcclxuICAgICAgdmFyIEkgPSAwLjA7XHJcbiAgICAgIHZhciBwMVggPSAwLjA7XHJcbiAgICAgIHZhciBwMVkgPSAwLjA7XHJcbiAgICAgIHZhciBrX2ludjMgPSAxLjAgLyAzLjA7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIHAyID0gdGhpcy5tX3ZlcnRpY2VzW2ldO1xyXG4gICAgICAgICB2YXIgcDMgPSBpICsgMSA8IHRoaXMubV92ZXJ0ZXhDb3VudCA/IHRoaXMubV92ZXJ0aWNlc1twYXJzZUludChpICsgMSldIDogdGhpcy5tX3ZlcnRpY2VzWzBdO1xyXG4gICAgICAgICB2YXIgZTFYID0gcDIueCAtIHAxWDtcclxuICAgICAgICAgdmFyIGUxWSA9IHAyLnkgLSBwMVk7XHJcbiAgICAgICAgIHZhciBlMlggPSBwMy54IC0gcDFYO1xyXG4gICAgICAgICB2YXIgZTJZID0gcDMueSAtIHAxWTtcclxuICAgICAgICAgdmFyIEQgPSBlMVggKiBlMlkgLSBlMVkgKiBlMlg7XHJcbiAgICAgICAgIHZhciB0cmlhbmdsZUFyZWEgPSAwLjUgKiBEO2FyZWEgKz0gdHJpYW5nbGVBcmVhO1xyXG4gICAgICAgICBjZW50ZXJYICs9IHRyaWFuZ2xlQXJlYSAqIGtfaW52MyAqIChwMVggKyBwMi54ICsgcDMueCk7XHJcbiAgICAgICAgIGNlbnRlclkgKz0gdHJpYW5nbGVBcmVhICoga19pbnYzICogKHAxWSArIHAyLnkgKyBwMy55KTtcclxuICAgICAgICAgdmFyIHB4ID0gcDFYO1xyXG4gICAgICAgICB2YXIgcHkgPSBwMVk7XHJcbiAgICAgICAgIHZhciBleDEgPSBlMVg7XHJcbiAgICAgICAgIHZhciBleTEgPSBlMVk7XHJcbiAgICAgICAgIHZhciBleDIgPSBlMlg7XHJcbiAgICAgICAgIHZhciBleTIgPSBlMlk7XHJcbiAgICAgICAgIHZhciBpbnR4MiA9IGtfaW52MyAqICgwLjI1ICogKGV4MSAqIGV4MSArIGV4MiAqIGV4MSArIGV4MiAqIGV4MikgKyAocHggKiBleDEgKyBweCAqIGV4MikpICsgMC41ICogcHggKiBweDtcclxuICAgICAgICAgdmFyIGludHkyID0ga19pbnYzICogKDAuMjUgKiAoZXkxICogZXkxICsgZXkyICogZXkxICsgZXkyICogZXkyKSArIChweSAqIGV5MSArIHB5ICogZXkyKSkgKyAwLjUgKiBweSAqIHB5O0kgKz0gRCAqIChpbnR4MiArIGludHkyKTtcclxuICAgICAgfVxyXG4gICAgICBtYXNzRGF0YS5tYXNzID0gZGVuc2l0eSAqIGFyZWE7XHJcbiAgICAgIGNlbnRlclggKj0gMS4wIC8gYXJlYTtcclxuICAgICAgY2VudGVyWSAqPSAxLjAgLyBhcmVhO1xyXG4gICAgICBtYXNzRGF0YS5jZW50ZXIuU2V0KGNlbnRlclgsIGNlbnRlclkpO1xyXG4gICAgICBtYXNzRGF0YS5JID0gZGVuc2l0eSAqIEk7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLkNvbXB1dGVTdWJtZXJnZWRBcmVhID0gZnVuY3Rpb24gKG5vcm1hbCwgb2Zmc2V0LCB4ZiwgYykge1xyXG4gICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7XHJcbiAgICAgIHZhciBub3JtYWxMID0gYjJNYXRoLk11bFRNVih4Zi5SLCBub3JtYWwpO1xyXG4gICAgICB2YXIgb2Zmc2V0TCA9IG9mZnNldCAtIGIyTWF0aC5Eb3Qobm9ybWFsLCB4Zi5wb3NpdGlvbik7XHJcbiAgICAgIHZhciBkZXB0aHMgPSBuZXcgVmVjdG9yX2Eyal9OdW1iZXIoKTtcclxuICAgICAgdmFyIGRpdmVDb3VudCA9IDA7XHJcbiAgICAgIHZhciBpbnRvSW5kZXggPSBwYXJzZUludCgoLTEpKTtcclxuICAgICAgdmFyIG91dG9JbmRleCA9IHBhcnNlSW50KCgtMSkpO1xyXG4gICAgICB2YXIgbGFzdFN1Ym1lcmdlZCA9IGZhbHNlO1xyXG4gICAgICB2YXIgaSA9IDA7XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xyXG4gICAgICAgICBkZXB0aHNbaV0gPSBiMk1hdGguRG90KG5vcm1hbEwsIHRoaXMubV92ZXJ0aWNlc1tpXSkgLSBvZmZzZXRMO1xyXG4gICAgICAgICB2YXIgaXNTdWJtZXJnZWQgPSBkZXB0aHNbaV0gPCAoLU51bWJlci5NSU5fVkFMVUUpO1xyXG4gICAgICAgICBpZiAoaSA+IDApIHtcclxuICAgICAgICAgICAgaWYgKGlzU3VibWVyZ2VkKSB7XHJcbiAgICAgICAgICAgICAgIGlmICghbGFzdFN1Ym1lcmdlZCkge1xyXG4gICAgICAgICAgICAgICAgICBpbnRvSW5kZXggPSBpIC0gMTtcclxuICAgICAgICAgICAgICAgICAgZGl2ZUNvdW50Kys7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgaWYgKGxhc3RTdWJtZXJnZWQpIHtcclxuICAgICAgICAgICAgICAgICAgb3V0b0luZGV4ID0gaSAtIDE7XHJcbiAgICAgICAgICAgICAgICAgIGRpdmVDb3VudCsrO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBsYXN0U3VibWVyZ2VkID0gaXNTdWJtZXJnZWQ7XHJcbiAgICAgIH1cclxuICAgICAgc3dpdGNoIChkaXZlQ291bnQpIHtcclxuICAgICAgY2FzZSAwOlxyXG4gICAgICAgICBpZiAobGFzdFN1Ym1lcmdlZCkge1xyXG4gICAgICAgICAgICB2YXIgbWQgPSBuZXcgYjJNYXNzRGF0YSgpO1xyXG4gICAgICAgICAgICB0aGlzLkNvbXB1dGVNYXNzKG1kLCAxKTtcclxuICAgICAgICAgICAgYy5TZXRWKGIyTWF0aC5NdWxYKHhmLCBtZC5jZW50ZXIpKTtcclxuICAgICAgICAgICAgcmV0dXJuIG1kLm1hc3M7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIDE6XHJcbiAgICAgICAgIGlmIChpbnRvSW5kZXggPT0gKC0xKSkge1xyXG4gICAgICAgICAgICBpbnRvSW5kZXggPSB0aGlzLm1fdmVydGV4Q291bnQgLSAxO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvdXRvSW5kZXggPSB0aGlzLm1fdmVydGV4Q291bnQgLSAxO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBpbnRvSW5kZXgyID0gcGFyc2VJbnQoKGludG9JbmRleCArIDEpICUgdGhpcy5tX3ZlcnRleENvdW50KTtcclxuICAgICAgdmFyIG91dG9JbmRleDIgPSBwYXJzZUludCgob3V0b0luZGV4ICsgMSkgJSB0aGlzLm1fdmVydGV4Q291bnQpO1xyXG4gICAgICB2YXIgaW50b0xhbWRkYSA9ICgwIC0gZGVwdGhzW2ludG9JbmRleF0pIC8gKGRlcHRoc1tpbnRvSW5kZXgyXSAtIGRlcHRoc1tpbnRvSW5kZXhdKTtcclxuICAgICAgdmFyIG91dG9MYW1kZGEgPSAoMCAtIGRlcHRoc1tvdXRvSW5kZXhdKSAvIChkZXB0aHNbb3V0b0luZGV4Ml0gLSBkZXB0aHNbb3V0b0luZGV4XSk7XHJcbiAgICAgIHZhciBpbnRvVmVjID0gbmV3IGIyVmVjMih0aGlzLm1fdmVydGljZXNbaW50b0luZGV4XS54ICogKDEgLSBpbnRvTGFtZGRhKSArIHRoaXMubV92ZXJ0aWNlc1tpbnRvSW5kZXgyXS54ICogaW50b0xhbWRkYSwgdGhpcy5tX3ZlcnRpY2VzW2ludG9JbmRleF0ueSAqICgxIC0gaW50b0xhbWRkYSkgKyB0aGlzLm1fdmVydGljZXNbaW50b0luZGV4Ml0ueSAqIGludG9MYW1kZGEpO1xyXG4gICAgICB2YXIgb3V0b1ZlYyA9IG5ldyBiMlZlYzIodGhpcy5tX3ZlcnRpY2VzW291dG9JbmRleF0ueCAqICgxIC0gb3V0b0xhbWRkYSkgKyB0aGlzLm1fdmVydGljZXNbb3V0b0luZGV4Ml0ueCAqIG91dG9MYW1kZGEsIHRoaXMubV92ZXJ0aWNlc1tvdXRvSW5kZXhdLnkgKiAoMSAtIG91dG9MYW1kZGEpICsgdGhpcy5tX3ZlcnRpY2VzW291dG9JbmRleDJdLnkgKiBvdXRvTGFtZGRhKTtcclxuICAgICAgdmFyIGFyZWEgPSAwO1xyXG4gICAgICB2YXIgY2VudGVyID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB2YXIgcDIgPSB0aGlzLm1fdmVydGljZXNbaW50b0luZGV4Ml07XHJcbiAgICAgIHZhciBwMztcclxuICAgICAgaSA9IGludG9JbmRleDI7XHJcbiAgICAgIHdoaWxlIChpICE9IG91dG9JbmRleDIpIHtcclxuICAgICAgICAgaSA9IChpICsgMSkgJSB0aGlzLm1fdmVydGV4Q291bnQ7XHJcbiAgICAgICAgIGlmIChpID09IG91dG9JbmRleDIpIHAzID0gb3V0b1ZlYztcclxuICAgICAgICAgZWxzZSBwMyA9IHRoaXMubV92ZXJ0aWNlc1tpXTtcclxuICAgICAgICAgdmFyIHRyaWFuZ2xlQXJlYSA9IDAuNSAqICgocDIueCAtIGludG9WZWMueCkgKiAocDMueSAtIGludG9WZWMueSkgLSAocDIueSAtIGludG9WZWMueSkgKiAocDMueCAtIGludG9WZWMueCkpO1xyXG4gICAgICAgICBhcmVhICs9IHRyaWFuZ2xlQXJlYTtcclxuICAgICAgICAgY2VudGVyLnggKz0gdHJpYW5nbGVBcmVhICogKGludG9WZWMueCArIHAyLnggKyBwMy54KSAvIDM7XHJcbiAgICAgICAgIGNlbnRlci55ICs9IHRyaWFuZ2xlQXJlYSAqIChpbnRvVmVjLnkgKyBwMi55ICsgcDMueSkgLyAzO1xyXG4gICAgICAgICBwMiA9IHAzO1xyXG4gICAgICB9XHJcbiAgICAgIGNlbnRlci5NdWx0aXBseSgxIC8gYXJlYSk7XHJcbiAgICAgIGMuU2V0VihiMk1hdGguTXVsWCh4ZiwgY2VudGVyKSk7XHJcbiAgICAgIHJldHVybiBhcmVhO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5HZXRWZXJ0ZXhDb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0ZXhDb3VudDtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuR2V0VmVydGljZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdmVydGljZXM7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLkdldE5vcm1hbHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbm9ybWFscztcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuR2V0U3VwcG9ydCA9IGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgIHZhciBiZXN0SW5kZXggPSAwO1xyXG4gICAgICB2YXIgYmVzdFZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzWzBdLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbMF0ueSAqIGQueTtcclxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLm1fdmVydGljZXNbaV0ueCAqIGQueCArIHRoaXMubV92ZXJ0aWNlc1tpXS55ICogZC55O1xyXG4gICAgICAgICBpZiAodmFsdWUgPiBiZXN0VmFsdWUpIHtcclxuICAgICAgICAgICAgYmVzdEluZGV4ID0gaTtcclxuICAgICAgICAgICAgYmVzdFZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYmVzdEluZGV4O1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5HZXRTdXBwb3J0VmVydGV4ID0gZnVuY3Rpb24gKGQpIHtcclxuICAgICAgdmFyIGJlc3RJbmRleCA9IDA7XHJcbiAgICAgIHZhciBiZXN0VmFsdWUgPSB0aGlzLm1fdmVydGljZXNbMF0ueCAqIGQueCArIHRoaXMubV92ZXJ0aWNlc1swXS55ICogZC55O1xyXG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRoaXMubV92ZXJ0ZXhDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMubV92ZXJ0aWNlc1tpXS54ICogZC54ICsgdGhpcy5tX3ZlcnRpY2VzW2ldLnkgKiBkLnk7XHJcbiAgICAgICAgIGlmICh2YWx1ZSA+IGJlc3RWYWx1ZSkge1xyXG4gICAgICAgICAgICBiZXN0SW5kZXggPSBpO1xyXG4gICAgICAgICAgICBiZXN0VmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdmVydGljZXNbYmVzdEluZGV4XTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuVmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuYjJQb2x5Z29uU2hhcGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMlNoYXBlLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMubV90eXBlID0gYjJTaGFwZS5lX3BvbHlnb25TaGFwZTtcclxuICAgICAgdGhpcy5tX2NlbnRyb2lkID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXMgPSBuZXcgVmVjdG9yKCk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWxzID0gbmV3IFZlY3RvcigpO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5SZXNlcnZlID0gZnVuY3Rpb24gKGNvdW50KSB7XHJcbiAgICAgIGlmIChjb3VudCA9PT0gdW5kZWZpbmVkKSBjb3VudCA9IDA7XHJcbiAgICAgIGZvciAodmFyIGkgPSBwYXJzZUludCh0aGlzLm1fdmVydGljZXMubGVuZ3RoKTsgaSA8IGNvdW50OyBpKyspIHtcclxuICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLkNvbXB1dGVDZW50cm9pZCA9IGZ1bmN0aW9uICh2cywgY291bnQpIHtcclxuICAgICAgaWYgKGNvdW50ID09PSB1bmRlZmluZWQpIGNvdW50ID0gMDtcclxuICAgICAgdmFyIGMgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHZhciBhcmVhID0gMC4wO1xyXG4gICAgICB2YXIgcDFYID0gMC4wO1xyXG4gICAgICB2YXIgcDFZID0gMC4wO1xyXG4gICAgICB2YXIgaW52MyA9IDEuMCAvIDMuMDtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7XHJcbiAgICAgICAgIHZhciBwMiA9IHZzW2ldO1xyXG4gICAgICAgICB2YXIgcDMgPSBpICsgMSA8IGNvdW50ID8gdnNbcGFyc2VJbnQoaSArIDEpXSA6IHZzWzBdO1xyXG4gICAgICAgICB2YXIgZTFYID0gcDIueCAtIHAxWDtcclxuICAgICAgICAgdmFyIGUxWSA9IHAyLnkgLSBwMVk7XHJcbiAgICAgICAgIHZhciBlMlggPSBwMy54IC0gcDFYO1xyXG4gICAgICAgICB2YXIgZTJZID0gcDMueSAtIHAxWTtcclxuICAgICAgICAgdmFyIEQgPSAoZTFYICogZTJZIC0gZTFZICogZTJYKTtcclxuICAgICAgICAgdmFyIHRyaWFuZ2xlQXJlYSA9IDAuNSAqIEQ7YXJlYSArPSB0cmlhbmdsZUFyZWE7XHJcbiAgICAgICAgIGMueCArPSB0cmlhbmdsZUFyZWEgKiBpbnYzICogKHAxWCArIHAyLnggKyBwMy54KTtcclxuICAgICAgICAgYy55ICs9IHRyaWFuZ2xlQXJlYSAqIGludjMgKiAocDFZICsgcDIueSArIHAzLnkpO1xyXG4gICAgICB9XHJcbiAgICAgIGMueCAqPSAxLjAgLyBhcmVhO1xyXG4gICAgICBjLnkgKj0gMS4wIC8gYXJlYTtcclxuICAgICAgcmV0dXJuIGM7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUuQ29tcHV0ZU9CQiA9IGZ1bmN0aW9uIChvYmIsIHZzLCBjb3VudCkge1xyXG4gICAgICBpZiAoY291bnQgPT09IHVuZGVmaW5lZCkgY291bnQgPSAwO1xyXG4gICAgICB2YXIgaSA9IDA7XHJcbiAgICAgIHZhciBwID0gbmV3IFZlY3Rvcihjb3VudCArIDEpO1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgY291bnQ7ICsraSkge1xyXG4gICAgICAgICBwW2ldID0gdnNbaV07XHJcbiAgICAgIH1cclxuICAgICAgcFtjb3VudF0gPSBwWzBdO1xyXG4gICAgICB2YXIgbWluQXJlYSA9IE51bWJlci5NQVhfVkFMVUU7XHJcbiAgICAgIGZvciAoaSA9IDE7XHJcbiAgICAgIGkgPD0gY291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgcm9vdCA9IHBbcGFyc2VJbnQoaSAtIDEpXTtcclxuICAgICAgICAgdmFyIHV4WCA9IHBbaV0ueCAtIHJvb3QueDtcclxuICAgICAgICAgdmFyIHV4WSA9IHBbaV0ueSAtIHJvb3QueTtcclxuICAgICAgICAgdmFyIGxlbmd0aCA9IE1hdGguc3FydCh1eFggKiB1eFggKyB1eFkgKiB1eFkpO1xyXG4gICAgICAgICB1eFggLz0gbGVuZ3RoO1xyXG4gICAgICAgICB1eFkgLz0gbGVuZ3RoO1xyXG4gICAgICAgICB2YXIgdXlYID0gKC11eFkpO1xyXG4gICAgICAgICB2YXIgdXlZID0gdXhYO1xyXG4gICAgICAgICB2YXIgbG93ZXJYID0gTnVtYmVyLk1BWF9WQUxVRTtcclxuICAgICAgICAgdmFyIGxvd2VyWSA9IE51bWJlci5NQVhfVkFMVUU7XHJcbiAgICAgICAgIHZhciB1cHBlclggPSAoLU51bWJlci5NQVhfVkFMVUUpO1xyXG4gICAgICAgICB2YXIgdXBwZXJZID0gKC1OdW1iZXIuTUFYX1ZBTFVFKTtcclxuICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjb3VudDsgKytqKSB7XHJcbiAgICAgICAgICAgIHZhciBkWCA9IHBbal0ueCAtIHJvb3QueDtcclxuICAgICAgICAgICAgdmFyIGRZID0gcFtqXS55IC0gcm9vdC55O1xyXG4gICAgICAgICAgICB2YXIgclggPSAodXhYICogZFggKyB1eFkgKiBkWSk7XHJcbiAgICAgICAgICAgIHZhciByWSA9ICh1eVggKiBkWCArIHV5WSAqIGRZKTtcclxuICAgICAgICAgICAgaWYgKHJYIDwgbG93ZXJYKSBsb3dlclggPSByWDtcclxuICAgICAgICAgICAgaWYgKHJZIDwgbG93ZXJZKSBsb3dlclkgPSByWTtcclxuICAgICAgICAgICAgaWYgKHJYID4gdXBwZXJYKSB1cHBlclggPSByWDtcclxuICAgICAgICAgICAgaWYgKHJZID4gdXBwZXJZKSB1cHBlclkgPSByWTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgYXJlYSA9ICh1cHBlclggLSBsb3dlclgpICogKHVwcGVyWSAtIGxvd2VyWSk7XHJcbiAgICAgICAgIGlmIChhcmVhIDwgMC45NSAqIG1pbkFyZWEpIHtcclxuICAgICAgICAgICAgbWluQXJlYSA9IGFyZWE7XHJcbiAgICAgICAgICAgIG9iYi5SLmNvbDEueCA9IHV4WDtcclxuICAgICAgICAgICAgb2JiLlIuY29sMS55ID0gdXhZO1xyXG4gICAgICAgICAgICBvYmIuUi5jb2wyLnggPSB1eVg7XHJcbiAgICAgICAgICAgIG9iYi5SLmNvbDIueSA9IHV5WTtcclxuICAgICAgICAgICAgdmFyIGNlbnRlclggPSAwLjUgKiAobG93ZXJYICsgdXBwZXJYKTtcclxuICAgICAgICAgICAgdmFyIGNlbnRlclkgPSAwLjUgKiAobG93ZXJZICsgdXBwZXJZKTtcclxuICAgICAgICAgICAgdmFyIHRNYXQgPSBvYmIuUjtcclxuICAgICAgICAgICAgb2JiLmNlbnRlci54ID0gcm9vdC54ICsgKHRNYXQuY29sMS54ICogY2VudGVyWCArIHRNYXQuY29sMi54ICogY2VudGVyWSk7XHJcbiAgICAgICAgICAgIG9iYi5jZW50ZXIueSA9IHJvb3QueSArICh0TWF0LmNvbDEueSAqIGNlbnRlclggKyB0TWF0LmNvbDIueSAqIGNlbnRlclkpO1xyXG4gICAgICAgICAgICBvYmIuZXh0ZW50cy54ID0gMC41ICogKHVwcGVyWCAtIGxvd2VyWCk7XHJcbiAgICAgICAgICAgIG9iYi5leHRlbnRzLnkgPSAwLjUgKiAodXBwZXJZIC0gbG93ZXJZKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJQb2x5Z29uU2hhcGUuc19tYXQgPSBuZXcgYjJNYXQyMigpO1xyXG4gICB9KTtcclxuICAgYjJTaGFwZS5iMlNoYXBlID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyU2hhcGUucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICB9XHJcbiAgIGIyU2hhcGUucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICB0aGlzLm1fcmFkaXVzID0gb3RoZXIubV9yYWRpdXM7XHJcbiAgIH1cclxuICAgYjJTaGFwZS5wcm90b3R5cGUuR2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV90eXBlO1xyXG4gICB9XHJcbiAgIGIyU2hhcGUucHJvdG90eXBlLlRlc3RQb2ludCA9IGZ1bmN0aW9uICh4ZiwgcCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgIH1cclxuICAgYjJTaGFwZS5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChvdXRwdXQsIGlucHV0LCB0cmFuc2Zvcm0pIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICB9XHJcbiAgIGIyU2hhcGUucHJvdG90eXBlLkNvbXB1dGVBQUJCID0gZnVuY3Rpb24gKGFhYmIsIHhmKSB7fVxyXG4gICBiMlNoYXBlLnByb3RvdHlwZS5Db21wdXRlTWFzcyA9IGZ1bmN0aW9uIChtYXNzRGF0YSwgZGVuc2l0eSkge1xyXG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMDtcclxuICAgfVxyXG4gICBiMlNoYXBlLnByb3RvdHlwZS5Db21wdXRlU3VibWVyZ2VkQXJlYSA9IGZ1bmN0aW9uIChub3JtYWwsIG9mZnNldCwgeGYsIGMpIHtcclxuICAgICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSBvZmZzZXQgPSAwO1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgfVxyXG4gICBiMlNoYXBlLlRlc3RPdmVybGFwID0gZnVuY3Rpb24gKHNoYXBlMSwgdHJhbnNmb3JtMSwgc2hhcGUyLCB0cmFuc2Zvcm0yKSB7XHJcbiAgICAgIHZhciBpbnB1dCA9IG5ldyBiMkRpc3RhbmNlSW5wdXQoKTtcclxuICAgICAgaW5wdXQucHJveHlBID0gbmV3IGIyRGlzdGFuY2VQcm94eSgpO1xyXG4gICAgICBpbnB1dC5wcm94eUEuU2V0KHNoYXBlMSk7XHJcbiAgICAgIGlucHV0LnByb3h5QiA9IG5ldyBiMkRpc3RhbmNlUHJveHkoKTtcclxuICAgICAgaW5wdXQucHJveHlCLlNldChzaGFwZTIpO1xyXG4gICAgICBpbnB1dC50cmFuc2Zvcm1BID0gdHJhbnNmb3JtMTtcclxuICAgICAgaW5wdXQudHJhbnNmb3JtQiA9IHRyYW5zZm9ybTI7XHJcbiAgICAgIGlucHV0LnVzZVJhZGlpID0gdHJ1ZTtcclxuICAgICAgdmFyIHNpbXBsZXhDYWNoZSA9IG5ldyBiMlNpbXBsZXhDYWNoZSgpO1xyXG4gICAgICBzaW1wbGV4Q2FjaGUuY291bnQgPSAwO1xyXG4gICAgICB2YXIgb3V0cHV0ID0gbmV3IGIyRGlzdGFuY2VPdXRwdXQoKTtcclxuICAgICAgYjJEaXN0YW5jZS5EaXN0YW5jZShvdXRwdXQsIHNpbXBsZXhDYWNoZSwgaW5wdXQpO1xyXG4gICAgICByZXR1cm4gb3V0cHV0LmRpc3RhbmNlIDwgMTAuMCAqIE51bWJlci5NSU5fVkFMVUU7XHJcbiAgIH1cclxuICAgYjJTaGFwZS5wcm90b3R5cGUuYjJTaGFwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3R5cGUgPSBiMlNoYXBlLmVfdW5rbm93blNoYXBlO1xyXG4gICAgICB0aGlzLm1fcmFkaXVzID0gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xyXG4gICB9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuZV91bmtub3duU2hhcGUgPSBwYXJzZUludCgoLTEpKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmVfY2lyY2xlU2hhcGUgPSAwO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuZV9wb2x5Z29uU2hhcGUgPSAxO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuZV9lZGdlU2hhcGUgPSAyO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuZV9zaGFwZVR5cGVDb3VudCA9IDM7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5lX2hpdENvbGxpZGUgPSAxO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuZV9taXNzQ29sbGlkZSA9IDA7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5lX3N0YXJ0c0luc2lkZUNvbGxpZGUgPSBwYXJzZUludCgoLTEpKTtcclxuICAgfSk7XHJcbn0pKCk7XHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgIHZhciBiMkNvbG9yID0gQm94MkQuQ29tbW9uLmIyQ29sb3IsXHJcbiAgICAgIGIyaW50ZXJuYWwgPSBCb3gyRC5Db21tb24uYjJpbnRlcm5hbCxcclxuICAgICAgYjJTZXR0aW5ncyA9IEJveDJELkNvbW1vbi5iMlNldHRpbmdzLFxyXG4gICAgICBiMk1hdDIyID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQyMixcclxuICAgICAgYjJNYXQzMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MzMsXHJcbiAgICAgIGIyTWF0aCA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aCxcclxuICAgICAgYjJTd2VlcCA9IEJveDJELkNvbW1vbi5NYXRoLmIyU3dlZXAsXHJcbiAgICAgIGIyVHJhbnNmb3JtID0gQm94MkQuQ29tbW9uLk1hdGguYjJUcmFuc2Zvcm0sXHJcbiAgICAgIGIyVmVjMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMixcclxuICAgICAgYjJWZWMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMzO1xyXG5cclxuICAgYjJDb2xvci5iMkNvbG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9yID0gMDtcclxuICAgICAgdGhpcy5fZyA9IDA7XHJcbiAgICAgIHRoaXMuX2IgPSAwO1xyXG4gICB9O1xyXG4gICBiMkNvbG9yLnByb3RvdHlwZS5iMkNvbG9yID0gZnVuY3Rpb24gKHJyLCBnZywgYmIpIHtcclxuICAgICAgaWYgKHJyID09PSB1bmRlZmluZWQpIHJyID0gMDtcclxuICAgICAgaWYgKGdnID09PSB1bmRlZmluZWQpIGdnID0gMDtcclxuICAgICAgaWYgKGJiID09PSB1bmRlZmluZWQpIGJiID0gMDtcclxuICAgICAgdGhpcy5fciA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAocnIsIDAuMCwgMS4wKSk7XHJcbiAgICAgIHRoaXMuX2cgPSBCb3gyRC5wYXJzZVVJbnQoMjU1ICogYjJNYXRoLkNsYW1wKGdnLCAwLjAsIDEuMCkpO1xyXG4gICAgICB0aGlzLl9iID0gQm94MkQucGFyc2VVSW50KDI1NSAqIGIyTWF0aC5DbGFtcChiYiwgMC4wLCAxLjApKTtcclxuICAgfVxyXG4gICBiMkNvbG9yLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAocnIsIGdnLCBiYikge1xyXG4gICAgICBpZiAocnIgPT09IHVuZGVmaW5lZCkgcnIgPSAwO1xyXG4gICAgICBpZiAoZ2cgPT09IHVuZGVmaW5lZCkgZ2cgPSAwO1xyXG4gICAgICBpZiAoYmIgPT09IHVuZGVmaW5lZCkgYmIgPSAwO1xyXG4gICAgICB0aGlzLl9yID0gQm94MkQucGFyc2VVSW50KDI1NSAqIGIyTWF0aC5DbGFtcChyciwgMC4wLCAxLjApKTtcclxuICAgICAgdGhpcy5fZyA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAoZ2csIDAuMCwgMS4wKSk7XHJcbiAgICAgIHRoaXMuX2IgPSBCb3gyRC5wYXJzZVVJbnQoMjU1ICogYjJNYXRoLkNsYW1wKGJiLCAwLjAsIDEuMCkpO1xyXG4gICB9XHJcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiMkNvbG9yLnByb3RvdHlwZSwgJ3InLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIHNldDogZnVuY3Rpb24gKHJyKSB7XHJcbiAgICAgICAgIGlmIChyciA9PT0gdW5kZWZpbmVkKSByciA9IDA7XHJcbiAgICAgICAgIHRoaXMuX3IgPSBCb3gyRC5wYXJzZVVJbnQoMjU1ICogYjJNYXRoLkNsYW1wKHJyLCAwLjAsIDEuMCkpO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYjJDb2xvci5wcm90b3R5cGUsICdnJywge1xyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uIChnZykge1xyXG4gICAgICAgICBpZiAoZ2cgPT09IHVuZGVmaW5lZCkgZ2cgPSAwO1xyXG4gICAgICAgICB0aGlzLl9nID0gQm94MkQucGFyc2VVSW50KDI1NSAqIGIyTWF0aC5DbGFtcChnZywgMC4wLCAxLjApKTtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIyQ29sb3IucHJvdG90eXBlLCAnYicsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgc2V0OiBmdW5jdGlvbiAoYmIpIHtcclxuICAgICAgICAgaWYgKGJiID09PSB1bmRlZmluZWQpIGJiID0gMDtcclxuICAgICAgICAgdGhpcy5fYiA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAoYmIsIDAuMCwgMS4wKSk7XHJcbiAgICAgIH1cclxuICAgfSk7XHJcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiMkNvbG9yLnByb3RvdHlwZSwgJ2NvbG9yJywge1xyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgcmV0dXJuICh0aGlzLl9yIDw8IDE2KSB8ICh0aGlzLl9nIDw8IDgpIHwgKHRoaXMuX2IpO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBiMlNldHRpbmdzLmIyU2V0dGluZ3MgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJTZXR0aW5ncy5iMk1peEZyaWN0aW9uID0gZnVuY3Rpb24gKGZyaWN0aW9uMSwgZnJpY3Rpb24yKSB7XHJcbiAgICAgIGlmIChmcmljdGlvbjEgPT09IHVuZGVmaW5lZCkgZnJpY3Rpb24xID0gMDtcclxuICAgICAgaWYgKGZyaWN0aW9uMiA9PT0gdW5kZWZpbmVkKSBmcmljdGlvbjIgPSAwO1xyXG4gICAgICByZXR1cm4gTWF0aC5zcXJ0KGZyaWN0aW9uMSAqIGZyaWN0aW9uMik7XHJcbiAgIH1cclxuICAgYjJTZXR0aW5ncy5iMk1peFJlc3RpdHV0aW9uID0gZnVuY3Rpb24gKHJlc3RpdHV0aW9uMSwgcmVzdGl0dXRpb24yKSB7XHJcbiAgICAgIGlmIChyZXN0aXR1dGlvbjEgPT09IHVuZGVmaW5lZCkgcmVzdGl0dXRpb24xID0gMDtcclxuICAgICAgaWYgKHJlc3RpdHV0aW9uMiA9PT0gdW5kZWZpbmVkKSByZXN0aXR1dGlvbjIgPSAwO1xyXG4gICAgICByZXR1cm4gcmVzdGl0dXRpb24xID4gcmVzdGl0dXRpb24yID8gcmVzdGl0dXRpb24xIDogcmVzdGl0dXRpb24yO1xyXG4gICB9XHJcbiAgIGIyU2V0dGluZ3MuYjJBc3NlcnQgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICBpZiAoIWEpIHtcclxuICAgICAgICAgdGhyb3cgXCJBc3NlcnRpb24gRmFpbGVkXCI7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuVkVSU0lPTiA9IFwiMi4xYWxwaGFcIjtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuVVNIUlRfTUFYID0gMHgwMDAwZmZmZjtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfcGkgPSBNYXRoLlBJO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyA9IDI7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX2FhYmJFeHRlbnNpb24gPSAwLjE7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX2FhYmJNdWx0aXBsaWVyID0gMi4wO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9wb2x5Z29uUmFkaXVzID0gMi4wICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wID0gMC4wMDU7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX2FuZ3VsYXJTbG9wID0gMi4wIC8gMTgwLjAgKiBiMlNldHRpbmdzLmIyX3BpO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl90b2lTbG9wID0gOC4wICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhUT0lDb250YWN0c1BlcklzbGFuZCA9IDMyO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhUT0lKb2ludHNQZXJJc2xhbmQgPSAzMjtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfdmVsb2NpdHlUaHJlc2hvbGQgPSAxLjA7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24gPSAwLjI7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX21heEFuZ3VsYXJDb3JyZWN0aW9uID0gOC4wIC8gMTgwLjAgKiBiMlNldHRpbmdzLmIyX3BpO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhUcmFuc2xhdGlvbiA9IDIuMDtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb25TcXVhcmVkID0gYjJTZXR0aW5ncy5iMl9tYXhUcmFuc2xhdGlvbiAqIGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb247XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX21heFJvdGF0aW9uID0gMC41ICogYjJTZXR0aW5ncy5iMl9waTtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb25TcXVhcmVkID0gYjJTZXR0aW5ncy5iMl9tYXhSb3RhdGlvbiAqIGIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb247XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX2NvbnRhY3RCYXVtZ2FydGUgPSAwLjI7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX3RpbWVUb1NsZWVwID0gMC41O1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9saW5lYXJTbGVlcFRvbGVyYW5jZSA9IDAuMDE7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX2FuZ3VsYXJTbGVlcFRvbGVyYW5jZSA9IDIuMCAvIDE4MC4wICogYjJTZXR0aW5ncy5iMl9waTtcclxuICAgfSk7XHJcbn0pKCk7XHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgIHZhciBiMkFBQkIgPSBCb3gyRC5Db2xsaXNpb24uYjJBQUJCLFxyXG4gICAgICBiMkNvbG9yID0gQm94MkQuQ29tbW9uLmIyQ29sb3IsXHJcbiAgICAgIGIyaW50ZXJuYWwgPSBCb3gyRC5Db21tb24uYjJpbnRlcm5hbCxcclxuICAgICAgYjJTZXR0aW5ncyA9IEJveDJELkNvbW1vbi5iMlNldHRpbmdzLFxyXG4gICAgICBiMk1hdDIyID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQyMixcclxuICAgICAgYjJNYXQzMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MzMsXHJcbiAgICAgIGIyTWF0aCA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aCxcclxuICAgICAgYjJTd2VlcCA9IEJveDJELkNvbW1vbi5NYXRoLmIyU3dlZXAsXHJcbiAgICAgIGIyVHJhbnNmb3JtID0gQm94MkQuQ29tbW9uLk1hdGguYjJUcmFuc2Zvcm0sXHJcbiAgICAgIGIyVmVjMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMixcclxuICAgICAgYjJWZWMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMzO1xyXG5cclxuICAgYjJNYXQyMi5iMk1hdDIyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNvbDEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMuY29sMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJNYXQyMi5wcm90b3R5cGUuYjJNYXQyMiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5TZXRJZGVudGl0eSgpO1xyXG4gICB9XHJcbiAgIGIyTWF0MjIuRnJvbUFuZ2xlID0gZnVuY3Rpb24gKGFuZ2xlKSB7XHJcbiAgICAgIGlmIChhbmdsZSA9PT0gdW5kZWZpbmVkKSBhbmdsZSA9IDA7XHJcbiAgICAgIHZhciBtYXQgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICBtYXQuU2V0KGFuZ2xlKTtcclxuICAgICAgcmV0dXJuIG1hdDtcclxuICAgfVxyXG4gICBiMk1hdDIyLkZyb21WViA9IGZ1bmN0aW9uIChjMSwgYzIpIHtcclxuICAgICAgdmFyIG1hdCA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIG1hdC5TZXRWVihjMSwgYzIpO1xyXG4gICAgICByZXR1cm4gbWF0O1xyXG4gICB9XHJcbiAgIGIyTWF0MjIucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChhbmdsZSkge1xyXG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwO1xyXG4gICAgICB2YXIgYyA9IE1hdGguY29zKGFuZ2xlKTtcclxuICAgICAgdmFyIHMgPSBNYXRoLnNpbihhbmdsZSk7XHJcbiAgICAgIHRoaXMuY29sMS54ID0gYztcclxuICAgICAgdGhpcy5jb2wyLnggPSAoLXMpO1xyXG4gICAgICB0aGlzLmNvbDEueSA9IHM7XHJcbiAgICAgIHRoaXMuY29sMi55ID0gYztcclxuICAgfVxyXG4gICBiMk1hdDIyLnByb3RvdHlwZS5TZXRWViA9IGZ1bmN0aW9uIChjMSwgYzIpIHtcclxuICAgICAgdGhpcy5jb2wxLlNldFYoYzEpO1xyXG4gICAgICB0aGlzLmNvbDIuU2V0VihjMik7XHJcbiAgIH1cclxuICAgYjJNYXQyMi5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIG1hdCA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIG1hdC5TZXRNKHRoaXMpO1xyXG4gICAgICByZXR1cm4gbWF0O1xyXG4gICB9XHJcbiAgIGIyTWF0MjIucHJvdG90eXBlLlNldE0gPSBmdW5jdGlvbiAobSkge1xyXG4gICAgICB0aGlzLmNvbDEuU2V0VihtLmNvbDEpO1xyXG4gICAgICB0aGlzLmNvbDIuU2V0VihtLmNvbDIpO1xyXG4gICB9XHJcbiAgIGIyTWF0MjIucHJvdG90eXBlLkFkZE0gPSBmdW5jdGlvbiAobSkge1xyXG4gICAgICB0aGlzLmNvbDEueCArPSBtLmNvbDEueDtcclxuICAgICAgdGhpcy5jb2wxLnkgKz0gbS5jb2wxLnk7XHJcbiAgICAgIHRoaXMuY29sMi54ICs9IG0uY29sMi54O1xyXG4gICAgICB0aGlzLmNvbDIueSArPSBtLmNvbDIueTtcclxuICAgfVxyXG4gICBiMk1hdDIyLnByb3RvdHlwZS5TZXRJZGVudGl0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jb2wxLnggPSAxLjA7XHJcbiAgICAgIHRoaXMuY29sMi54ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDEueSA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wyLnkgPSAxLjA7XHJcbiAgIH1cclxuICAgYjJNYXQyMi5wcm90b3R5cGUuU2V0WmVybyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jb2wxLnggPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMi54ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDEueSA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wyLnkgPSAwLjA7XHJcbiAgIH1cclxuICAgYjJNYXQyMi5wcm90b3R5cGUuR2V0QW5nbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBNYXRoLmF0YW4yKHRoaXMuY29sMS55LCB0aGlzLmNvbDEueCk7XHJcbiAgIH1cclxuICAgYjJNYXQyMi5wcm90b3R5cGUuR2V0SW52ZXJzZSA9IGZ1bmN0aW9uIChvdXQpIHtcclxuICAgICAgdmFyIGEgPSB0aGlzLmNvbDEueDtcclxuICAgICAgdmFyIGIgPSB0aGlzLmNvbDIueDtcclxuICAgICAgdmFyIGMgPSB0aGlzLmNvbDEueTtcclxuICAgICAgdmFyIGQgPSB0aGlzLmNvbDIueTtcclxuICAgICAgdmFyIGRldCA9IGEgKiBkIC0gYiAqIGM7XHJcbiAgICAgIGlmIChkZXQgIT0gMC4wKSB7XHJcbiAgICAgICAgIGRldCA9IDEuMCAvIGRldDtcclxuICAgICAgfVxyXG4gICAgICBvdXQuY29sMS54ID0gZGV0ICogZDtcclxuICAgICAgb3V0LmNvbDIueCA9ICgtZGV0ICogYik7XHJcbiAgICAgIG91dC5jb2wxLnkgPSAoLWRldCAqIGMpO1xyXG4gICAgICBvdXQuY29sMi55ID0gZGV0ICogYTtcclxuICAgICAgcmV0dXJuIG91dDtcclxuICAgfVxyXG4gICBiMk1hdDIyLnByb3RvdHlwZS5Tb2x2ZSA9IGZ1bmN0aW9uIChvdXQsIGJYLCBiWSkge1xyXG4gICAgICBpZiAoYlggPT09IHVuZGVmaW5lZCkgYlggPSAwO1xyXG4gICAgICBpZiAoYlkgPT09IHVuZGVmaW5lZCkgYlkgPSAwO1xyXG4gICAgICB2YXIgYTExID0gdGhpcy5jb2wxLng7XHJcbiAgICAgIHZhciBhMTIgPSB0aGlzLmNvbDIueDtcclxuICAgICAgdmFyIGEyMSA9IHRoaXMuY29sMS55O1xyXG4gICAgICB2YXIgYTIyID0gdGhpcy5jb2wyLnk7XHJcbiAgICAgIHZhciBkZXQgPSBhMTEgKiBhMjIgLSBhMTIgKiBhMjE7XHJcbiAgICAgIGlmIChkZXQgIT0gMC4wKSB7XHJcbiAgICAgICAgIGRldCA9IDEuMCAvIGRldDtcclxuICAgICAgfVxyXG4gICAgICBvdXQueCA9IGRldCAqIChhMjIgKiBiWCAtIGExMiAqIGJZKTtcclxuICAgICAgb3V0LnkgPSBkZXQgKiAoYTExICogYlkgLSBhMjEgKiBiWCk7XHJcbiAgICAgIHJldHVybiBvdXQ7XHJcbiAgIH1cclxuICAgYjJNYXQyMi5wcm90b3R5cGUuQWJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNvbDEuQWJzKCk7XHJcbiAgICAgIHRoaXMuY29sMi5BYnMoKTtcclxuICAgfVxyXG4gICBiMk1hdDMzLmIyTWF0MzMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuY29sMSA9IG5ldyBiMlZlYzMoKTtcclxuICAgICAgdGhpcy5jb2wyID0gbmV3IGIyVmVjMygpO1xyXG4gICAgICB0aGlzLmNvbDMgPSBuZXcgYjJWZWMzKCk7XHJcbiAgIH07XHJcbiAgIGIyTWF0MzMucHJvdG90eXBlLmIyTWF0MzMgPSBmdW5jdGlvbiAoYzEsIGMyLCBjMykge1xyXG4gICAgICBpZiAoYzEgPT09IHVuZGVmaW5lZCkgYzEgPSBudWxsO1xyXG4gICAgICBpZiAoYzIgPT09IHVuZGVmaW5lZCkgYzIgPSBudWxsO1xyXG4gICAgICBpZiAoYzMgPT09IHVuZGVmaW5lZCkgYzMgPSBudWxsO1xyXG4gICAgICBpZiAoIWMxICYmICFjMiAmJiAhYzMpIHtcclxuICAgICAgICAgdGhpcy5jb2wxLlNldFplcm8oKTtcclxuICAgICAgICAgdGhpcy5jb2wyLlNldFplcm8oKTtcclxuICAgICAgICAgdGhpcy5jb2wzLlNldFplcm8oKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5jb2wxLlNldFYoYzEpO1xyXG4gICAgICAgICB0aGlzLmNvbDIuU2V0VihjMik7XHJcbiAgICAgICAgIHRoaXMuY29sMy5TZXRWKGMzKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyTWF0MzMucHJvdG90eXBlLlNldFZWViA9IGZ1bmN0aW9uIChjMSwgYzIsIGMzKSB7XHJcbiAgICAgIHRoaXMuY29sMS5TZXRWKGMxKTtcclxuICAgICAgdGhpcy5jb2wyLlNldFYoYzIpO1xyXG4gICAgICB0aGlzLmNvbDMuU2V0VihjMyk7XHJcbiAgIH1cclxuICAgYjJNYXQzMy5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMk1hdDMzKHRoaXMuY29sMSwgdGhpcy5jb2wyLCB0aGlzLmNvbDMpO1xyXG4gICB9XHJcbiAgIGIyTWF0MzMucHJvdG90eXBlLlNldE0gPSBmdW5jdGlvbiAobSkge1xyXG4gICAgICB0aGlzLmNvbDEuU2V0VihtLmNvbDEpO1xyXG4gICAgICB0aGlzLmNvbDIuU2V0VihtLmNvbDIpO1xyXG4gICAgICB0aGlzLmNvbDMuU2V0VihtLmNvbDMpO1xyXG4gICB9XHJcbiAgIGIyTWF0MzMucHJvdG90eXBlLkFkZE0gPSBmdW5jdGlvbiAobSkge1xyXG4gICAgICB0aGlzLmNvbDEueCArPSBtLmNvbDEueDtcclxuICAgICAgdGhpcy5jb2wxLnkgKz0gbS5jb2wxLnk7XHJcbiAgICAgIHRoaXMuY29sMS56ICs9IG0uY29sMS56O1xyXG4gICAgICB0aGlzLmNvbDIueCArPSBtLmNvbDIueDtcclxuICAgICAgdGhpcy5jb2wyLnkgKz0gbS5jb2wyLnk7XHJcbiAgICAgIHRoaXMuY29sMi56ICs9IG0uY29sMi56O1xyXG4gICAgICB0aGlzLmNvbDMueCArPSBtLmNvbDMueDtcclxuICAgICAgdGhpcy5jb2wzLnkgKz0gbS5jb2wzLnk7XHJcbiAgICAgIHRoaXMuY29sMy56ICs9IG0uY29sMy56O1xyXG4gICB9XHJcbiAgIGIyTWF0MzMucHJvdG90eXBlLlNldElkZW50aXR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNvbDEueCA9IDEuMDtcclxuICAgICAgdGhpcy5jb2wyLnggPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMy54ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDEueSA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wyLnkgPSAxLjA7XHJcbiAgICAgIHRoaXMuY29sMy55ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDEueiA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wyLnogPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMy56ID0gMS4wO1xyXG4gICB9XHJcbiAgIGIyTWF0MzMucHJvdG90eXBlLlNldFplcm8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuY29sMS54ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDIueCA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wzLnggPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMS55ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDIueSA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wzLnkgPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMS56ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDIueiA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wzLnogPSAwLjA7XHJcbiAgIH1cclxuICAgYjJNYXQzMy5wcm90b3R5cGUuU29sdmUyMiA9IGZ1bmN0aW9uIChvdXQsIGJYLCBiWSkge1xyXG4gICAgICBpZiAoYlggPT09IHVuZGVmaW5lZCkgYlggPSAwO1xyXG4gICAgICBpZiAoYlkgPT09IHVuZGVmaW5lZCkgYlkgPSAwO1xyXG4gICAgICB2YXIgYTExID0gdGhpcy5jb2wxLng7XHJcbiAgICAgIHZhciBhMTIgPSB0aGlzLmNvbDIueDtcclxuICAgICAgdmFyIGEyMSA9IHRoaXMuY29sMS55O1xyXG4gICAgICB2YXIgYTIyID0gdGhpcy5jb2wyLnk7XHJcbiAgICAgIHZhciBkZXQgPSBhMTEgKiBhMjIgLSBhMTIgKiBhMjE7XHJcbiAgICAgIGlmIChkZXQgIT0gMC4wKSB7XHJcbiAgICAgICAgIGRldCA9IDEuMCAvIGRldDtcclxuICAgICAgfVxyXG4gICAgICBvdXQueCA9IGRldCAqIChhMjIgKiBiWCAtIGExMiAqIGJZKTtcclxuICAgICAgb3V0LnkgPSBkZXQgKiAoYTExICogYlkgLSBhMjEgKiBiWCk7XHJcbiAgICAgIHJldHVybiBvdXQ7XHJcbiAgIH1cclxuICAgYjJNYXQzMy5wcm90b3R5cGUuU29sdmUzMyA9IGZ1bmN0aW9uIChvdXQsIGJYLCBiWSwgYlopIHtcclxuICAgICAgaWYgKGJYID09PSB1bmRlZmluZWQpIGJYID0gMDtcclxuICAgICAgaWYgKGJZID09PSB1bmRlZmluZWQpIGJZID0gMDtcclxuICAgICAgaWYgKGJaID09PSB1bmRlZmluZWQpIGJaID0gMDtcclxuICAgICAgdmFyIGExMSA9IHRoaXMuY29sMS54O1xyXG4gICAgICB2YXIgYTIxID0gdGhpcy5jb2wxLnk7XHJcbiAgICAgIHZhciBhMzEgPSB0aGlzLmNvbDEuejtcclxuICAgICAgdmFyIGExMiA9IHRoaXMuY29sMi54O1xyXG4gICAgICB2YXIgYTIyID0gdGhpcy5jb2wyLnk7XHJcbiAgICAgIHZhciBhMzIgPSB0aGlzLmNvbDIuejtcclxuICAgICAgdmFyIGExMyA9IHRoaXMuY29sMy54O1xyXG4gICAgICB2YXIgYTIzID0gdGhpcy5jb2wzLnk7XHJcbiAgICAgIHZhciBhMzMgPSB0aGlzLmNvbDMuejtcclxuICAgICAgdmFyIGRldCA9IGExMSAqIChhMjIgKiBhMzMgLSBhMzIgKiBhMjMpICsgYTIxICogKGEzMiAqIGExMyAtIGExMiAqIGEzMykgKyBhMzEgKiAoYTEyICogYTIzIC0gYTIyICogYTEzKTtcclxuICAgICAgaWYgKGRldCAhPSAwLjApIHtcclxuICAgICAgICAgZGV0ID0gMS4wIC8gZGV0O1xyXG4gICAgICB9XHJcbiAgICAgIG91dC54ID0gZGV0ICogKGJYICogKGEyMiAqIGEzMyAtIGEzMiAqIGEyMykgKyBiWSAqIChhMzIgKiBhMTMgLSBhMTIgKiBhMzMpICsgYlogKiAoYTEyICogYTIzIC0gYTIyICogYTEzKSk7XHJcbiAgICAgIG91dC55ID0gZGV0ICogKGExMSAqIChiWSAqIGEzMyAtIGJaICogYTIzKSArIGEyMSAqIChiWiAqIGExMyAtIGJYICogYTMzKSArIGEzMSAqIChiWCAqIGEyMyAtIGJZICogYTEzKSk7XHJcbiAgICAgIG91dC56ID0gZGV0ICogKGExMSAqIChhMjIgKiBiWiAtIGEzMiAqIGJZKSArIGEyMSAqIChhMzIgKiBiWCAtIGExMiAqIGJaKSArIGEzMSAqIChhMTIgKiBiWSAtIGEyMiAqIGJYKSk7XHJcbiAgICAgIHJldHVybiBvdXQ7XHJcbiAgIH1cclxuICAgYjJNYXRoLmIyTWF0aCA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMk1hdGguSXNWYWxpZCA9IGZ1bmN0aW9uICh4KSB7XHJcbiAgICAgIGlmICh4ID09PSB1bmRlZmluZWQpIHggPSAwO1xyXG4gICAgICByZXR1cm4gaXNGaW5pdGUoeCk7XHJcbiAgIH1cclxuICAgYjJNYXRoLkRvdCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIHJldHVybiBhLnggKiBiLnggKyBhLnkgKiBiLnk7XHJcbiAgIH1cclxuICAgYjJNYXRoLkNyb3NzVlYgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICByZXR1cm4gYS54ICogYi55IC0gYS55ICogYi54O1xyXG4gICB9XHJcbiAgIGIyTWF0aC5Dcm9zc1ZGID0gZnVuY3Rpb24gKGEsIHMpIHtcclxuICAgICAgaWYgKHMgPT09IHVuZGVmaW5lZCkgcyA9IDA7XHJcbiAgICAgIHZhciB2ID0gbmV3IGIyVmVjMihzICogYS55LCAoLXMgKiBhLngpKTtcclxuICAgICAgcmV0dXJuIHY7XHJcbiAgIH1cclxuICAgYjJNYXRoLkNyb3NzRlYgPSBmdW5jdGlvbiAocywgYSkge1xyXG4gICAgICBpZiAocyA9PT0gdW5kZWZpbmVkKSBzID0gMDtcclxuICAgICAgdmFyIHYgPSBuZXcgYjJWZWMyKCgtcyAqIGEueSksIHMgKiBhLngpO1xyXG4gICAgICByZXR1cm4gdjtcclxuICAgfVxyXG4gICBiMk1hdGguTXVsTVYgPSBmdW5jdGlvbiAoQSwgdikge1xyXG4gICAgICB2YXIgdSA9IG5ldyBiMlZlYzIoQS5jb2wxLnggKiB2LnggKyBBLmNvbDIueCAqIHYueSwgQS5jb2wxLnkgKiB2LnggKyBBLmNvbDIueSAqIHYueSk7XHJcbiAgICAgIHJldHVybiB1O1xyXG4gICB9XHJcbiAgIGIyTWF0aC5NdWxUTVYgPSBmdW5jdGlvbiAoQSwgdikge1xyXG4gICAgICB2YXIgdSA9IG5ldyBiMlZlYzIoYjJNYXRoLkRvdCh2LCBBLmNvbDEpLCBiMk1hdGguRG90KHYsIEEuY29sMikpO1xyXG4gICAgICByZXR1cm4gdTtcclxuICAgfVxyXG4gICBiMk1hdGguTXVsWCA9IGZ1bmN0aW9uIChULCB2KSB7XHJcbiAgICAgIHZhciBhID0gYjJNYXRoLk11bE1WKFQuUiwgdik7XHJcbiAgICAgIGEueCArPSBULnBvc2l0aW9uLng7XHJcbiAgICAgIGEueSArPSBULnBvc2l0aW9uLnk7XHJcbiAgICAgIHJldHVybiBhO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5NdWxYVCA9IGZ1bmN0aW9uIChULCB2KSB7XHJcbiAgICAgIHZhciBhID0gYjJNYXRoLlN1YnRyYWN0VlYodiwgVC5wb3NpdGlvbik7XHJcbiAgICAgIHZhciB0WCA9IChhLnggKiBULlIuY29sMS54ICsgYS55ICogVC5SLmNvbDEueSk7XHJcbiAgICAgIGEueSA9IChhLnggKiBULlIuY29sMi54ICsgYS55ICogVC5SLmNvbDIueSk7XHJcbiAgICAgIGEueCA9IHRYO1xyXG4gICAgICByZXR1cm4gYTtcclxuICAgfVxyXG4gICBiMk1hdGguQWRkVlYgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICB2YXIgdiA9IG5ldyBiMlZlYzIoYS54ICsgYi54LCBhLnkgKyBiLnkpO1xyXG4gICAgICByZXR1cm4gdjtcclxuICAgfVxyXG4gICBiMk1hdGguU3VidHJhY3RWViA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIHZhciB2ID0gbmV3IGIyVmVjMihhLnggLSBiLngsIGEueSAtIGIueSk7XHJcbiAgICAgIHJldHVybiB2O1xyXG4gICB9XHJcbiAgIGIyTWF0aC5EaXN0YW5jZSA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIHZhciBjWCA9IGEueCAtIGIueDtcclxuICAgICAgdmFyIGNZID0gYS55IC0gYi55O1xyXG4gICAgICByZXR1cm4gTWF0aC5zcXJ0KGNYICogY1ggKyBjWSAqIGNZKTtcclxuICAgfVxyXG4gICBiMk1hdGguRGlzdGFuY2VTcXVhcmVkID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgdmFyIGNYID0gYS54IC0gYi54O1xyXG4gICAgICB2YXIgY1kgPSBhLnkgLSBiLnk7XHJcbiAgICAgIHJldHVybiAoY1ggKiBjWCArIGNZICogY1kpO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5NdWxGViA9IGZ1bmN0aW9uIChzLCBhKSB7XHJcbiAgICAgIGlmIChzID09PSB1bmRlZmluZWQpIHMgPSAwO1xyXG4gICAgICB2YXIgdiA9IG5ldyBiMlZlYzIocyAqIGEueCwgcyAqIGEueSk7XHJcbiAgICAgIHJldHVybiB2O1xyXG4gICB9XHJcbiAgIGIyTWF0aC5BZGRNTSA9IGZ1bmN0aW9uIChBLCBCKSB7XHJcbiAgICAgIHZhciBDID0gYjJNYXQyMi5Gcm9tVlYoYjJNYXRoLkFkZFZWKEEuY29sMSwgQi5jb2wxKSwgYjJNYXRoLkFkZFZWKEEuY29sMiwgQi5jb2wyKSk7XHJcbiAgICAgIHJldHVybiBDO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5NdWxNTSA9IGZ1bmN0aW9uIChBLCBCKSB7XHJcbiAgICAgIHZhciBDID0gYjJNYXQyMi5Gcm9tVlYoYjJNYXRoLk11bE1WKEEsIEIuY29sMSksIGIyTWF0aC5NdWxNVihBLCBCLmNvbDIpKTtcclxuICAgICAgcmV0dXJuIEM7XHJcbiAgIH1cclxuICAgYjJNYXRoLk11bFRNTSA9IGZ1bmN0aW9uIChBLCBCKSB7XHJcbiAgICAgIHZhciBjMSA9IG5ldyBiMlZlYzIoYjJNYXRoLkRvdChBLmNvbDEsIEIuY29sMSksIGIyTWF0aC5Eb3QoQS5jb2wyLCBCLmNvbDEpKTtcclxuICAgICAgdmFyIGMyID0gbmV3IGIyVmVjMihiMk1hdGguRG90KEEuY29sMSwgQi5jb2wyKSwgYjJNYXRoLkRvdChBLmNvbDIsIEIuY29sMikpO1xyXG4gICAgICB2YXIgQyA9IGIyTWF0MjIuRnJvbVZWKGMxLCBjMik7XHJcbiAgICAgIHJldHVybiBDO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5BYnMgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSBhID0gMDtcclxuICAgICAgcmV0dXJuIGEgPiAwLjAgPyBhIDogKC1hKTtcclxuICAgfVxyXG4gICBiMk1hdGguQWJzViA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgIHZhciBiID0gbmV3IGIyVmVjMihiMk1hdGguQWJzKGEueCksIGIyTWF0aC5BYnMoYS55KSk7XHJcbiAgICAgIHJldHVybiBiO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5BYnNNID0gZnVuY3Rpb24gKEEpIHtcclxuICAgICAgdmFyIEIgPSBiMk1hdDIyLkZyb21WVihiMk1hdGguQWJzVihBLmNvbDEpLCBiMk1hdGguQWJzVihBLmNvbDIpKTtcclxuICAgICAgcmV0dXJuIEI7XHJcbiAgIH1cclxuICAgYjJNYXRoLk1pbiA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIGlmIChhID09PSB1bmRlZmluZWQpIGEgPSAwO1xyXG4gICAgICBpZiAoYiA9PT0gdW5kZWZpbmVkKSBiID0gMDtcclxuICAgICAgcmV0dXJuIGEgPCBiID8gYSA6IGI7XHJcbiAgIH1cclxuICAgYjJNYXRoLk1pblYgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICB2YXIgYyA9IG5ldyBiMlZlYzIoYjJNYXRoLk1pbihhLngsIGIueCksIGIyTWF0aC5NaW4oYS55LCBiLnkpKTtcclxuICAgICAgcmV0dXJuIGM7XHJcbiAgIH1cclxuICAgYjJNYXRoLk1heCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIGlmIChhID09PSB1bmRlZmluZWQpIGEgPSAwO1xyXG4gICAgICBpZiAoYiA9PT0gdW5kZWZpbmVkKSBiID0gMDtcclxuICAgICAgcmV0dXJuIGEgPiBiID8gYSA6IGI7XHJcbiAgIH1cclxuICAgYjJNYXRoLk1heFYgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICB2YXIgYyA9IG5ldyBiMlZlYzIoYjJNYXRoLk1heChhLngsIGIueCksIGIyTWF0aC5NYXgoYS55LCBiLnkpKTtcclxuICAgICAgcmV0dXJuIGM7XHJcbiAgIH1cclxuICAgYjJNYXRoLkNsYW1wID0gZnVuY3Rpb24gKGEsIGxvdywgaGlnaCkge1xyXG4gICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSBhID0gMDtcclxuICAgICAgaWYgKGxvdyA9PT0gdW5kZWZpbmVkKSBsb3cgPSAwO1xyXG4gICAgICBpZiAoaGlnaCA9PT0gdW5kZWZpbmVkKSBoaWdoID0gMDtcclxuICAgICAgcmV0dXJuIGEgPCBsb3cgPyBsb3cgOiBhID4gaGlnaCA/IGhpZ2ggOiBhO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5DbGFtcFYgPSBmdW5jdGlvbiAoYSwgbG93LCBoaWdoKSB7XHJcbiAgICAgIHJldHVybiBiMk1hdGguTWF4Vihsb3csIGIyTWF0aC5NaW5WKGEsIGhpZ2gpKTtcclxuICAgfVxyXG4gICBiMk1hdGguU3dhcCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIHZhciB0bXAgPSBhWzBdO1xyXG4gICAgICBhWzBdID0gYlswXTtcclxuICAgICAgYlswXSA9IHRtcDtcclxuICAgfVxyXG4gICBiMk1hdGguUmFuZG9tID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIDIgLSAxO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5SYW5kb21SYW5nZSA9IGZ1bmN0aW9uIChsbywgaGkpIHtcclxuICAgICAgaWYgKGxvID09PSB1bmRlZmluZWQpIGxvID0gMDtcclxuICAgICAgaWYgKGhpID09PSB1bmRlZmluZWQpIGhpID0gMDtcclxuICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpO1xyXG4gICAgICByID0gKGhpIC0gbG8pICogciArIGxvO1xyXG4gICAgICByZXR1cm4gcjtcclxuICAgfVxyXG4gICBiMk1hdGguTmV4dFBvd2VyT2ZUd28gPSBmdW5jdGlvbiAoeCkge1xyXG4gICAgICBpZiAoeCA9PT0gdW5kZWZpbmVkKSB4ID0gMDtcclxuICAgICAgeCB8PSAoeCA+PiAxKSAmIDB4N0ZGRkZGRkY7XHJcbiAgICAgIHggfD0gKHggPj4gMikgJiAweDNGRkZGRkZGO1xyXG4gICAgICB4IHw9ICh4ID4+IDQpICYgMHgwRkZGRkZGRjtcclxuICAgICAgeCB8PSAoeCA+PiA4KSAmIDB4MDBGRkZGRkY7XHJcbiAgICAgIHggfD0gKHggPj4gMTYpICYgMHgwMDAwRkZGRjtcclxuICAgICAgcmV0dXJuIHggKyAxO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5Jc1Bvd2VyT2ZUd28gPSBmdW5jdGlvbiAoeCkge1xyXG4gICAgICBpZiAoeCA9PT0gdW5kZWZpbmVkKSB4ID0gMDtcclxuICAgICAgdmFyIHJlc3VsdCA9IHggPiAwICYmICh4ICYgKHggLSAxKSkgPT0gMDtcclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLmIyVmVjMl96ZXJvID0gbmV3IGIyVmVjMigwLjAsIDAuMCk7XHJcbiAgICAgIEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aC5iMk1hdDIyX2lkZW50aXR5ID0gYjJNYXQyMi5Gcm9tVlYobmV3IGIyVmVjMigxLjAsIDAuMCksIG5ldyBiMlZlYzIoMC4wLCAxLjApKTtcclxuICAgICAgQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLmIyVHJhbnNmb3JtX2lkZW50aXR5ID0gbmV3IGIyVHJhbnNmb3JtKGIyTWF0aC5iMlZlYzJfemVybywgYjJNYXRoLmIyTWF0MjJfaWRlbnRpdHkpO1xyXG4gICB9KTtcclxuICAgYjJTd2VlcC5iMlN3ZWVwID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmxvY2FsQ2VudGVyID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmMwID0gbmV3IGIyVmVjMjtcclxuICAgICAgdGhpcy5jID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMlN3ZWVwLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgdGhpcy5sb2NhbENlbnRlci5TZXRWKG90aGVyLmxvY2FsQ2VudGVyKTtcclxuICAgICAgdGhpcy5jMC5TZXRWKG90aGVyLmMwKTtcclxuICAgICAgdGhpcy5jLlNldFYob3RoZXIuYyk7XHJcbiAgICAgIHRoaXMuYTAgPSBvdGhlci5hMDtcclxuICAgICAgdGhpcy5hID0gb3RoZXIuYTtcclxuICAgICAgdGhpcy50MCA9IG90aGVyLnQwO1xyXG4gICB9XHJcbiAgIGIyU3dlZXAucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBjb3B5ID0gbmV3IGIyU3dlZXAoKTtcclxuICAgICAgY29weS5sb2NhbENlbnRlci5TZXRWKHRoaXMubG9jYWxDZW50ZXIpO1xyXG4gICAgICBjb3B5LmMwLlNldFYodGhpcy5jMCk7XHJcbiAgICAgIGNvcHkuYy5TZXRWKHRoaXMuYyk7XHJcbiAgICAgIGNvcHkuYTAgPSB0aGlzLmEwO1xyXG4gICAgICBjb3B5LmEgPSB0aGlzLmE7XHJcbiAgICAgIGNvcHkudDAgPSB0aGlzLnQwO1xyXG4gICAgICByZXR1cm4gY29weTtcclxuICAgfVxyXG4gICBiMlN3ZWVwLnByb3RvdHlwZS5HZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoeGYsIGFscGhhKSB7XHJcbiAgICAgIGlmIChhbHBoYSA9PT0gdW5kZWZpbmVkKSBhbHBoYSA9IDA7XHJcbiAgICAgIHhmLnBvc2l0aW9uLnggPSAoMS4wIC0gYWxwaGEpICogdGhpcy5jMC54ICsgYWxwaGEgKiB0aGlzLmMueDtcclxuICAgICAgeGYucG9zaXRpb24ueSA9ICgxLjAgLSBhbHBoYSkgKiB0aGlzLmMwLnkgKyBhbHBoYSAqIHRoaXMuYy55O1xyXG4gICAgICB2YXIgYW5nbGUgPSAoMS4wIC0gYWxwaGEpICogdGhpcy5hMCArIGFscGhhICogdGhpcy5hO1xyXG4gICAgICB4Zi5SLlNldChhbmdsZSk7XHJcbiAgICAgIHZhciB0TWF0ID0geGYuUjtcclxuICAgICAgeGYucG9zaXRpb24ueCAtPSAodE1hdC5jb2wxLnggKiB0aGlzLmxvY2FsQ2VudGVyLnggKyB0TWF0LmNvbDIueCAqIHRoaXMubG9jYWxDZW50ZXIueSk7XHJcbiAgICAgIHhmLnBvc2l0aW9uLnkgLT0gKHRNYXQuY29sMS55ICogdGhpcy5sb2NhbENlbnRlci54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLmxvY2FsQ2VudGVyLnkpO1xyXG4gICB9XHJcbiAgIGIyU3dlZXAucHJvdG90eXBlLkFkdmFuY2UgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICBpZiAodCA9PT0gdW5kZWZpbmVkKSB0ID0gMDtcclxuICAgICAgaWYgKHRoaXMudDAgPCB0ICYmIDEuMCAtIHRoaXMudDAgPiBOdW1iZXIuTUlOX1ZBTFVFKSB7XHJcbiAgICAgICAgIHZhciBhbHBoYSA9ICh0IC0gdGhpcy50MCkgLyAoMS4wIC0gdGhpcy50MCk7XHJcbiAgICAgICAgIHRoaXMuYzAueCA9ICgxLjAgLSBhbHBoYSkgKiB0aGlzLmMwLnggKyBhbHBoYSAqIHRoaXMuYy54O1xyXG4gICAgICAgICB0aGlzLmMwLnkgPSAoMS4wIC0gYWxwaGEpICogdGhpcy5jMC55ICsgYWxwaGEgKiB0aGlzLmMueTtcclxuICAgICAgICAgdGhpcy5hMCA9ICgxLjAgLSBhbHBoYSkgKiB0aGlzLmEwICsgYWxwaGEgKiB0aGlzLmE7XHJcbiAgICAgICAgIHRoaXMudDAgPSB0O1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJUcmFuc2Zvcm0uYjJUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgYjJWZWMyO1xyXG4gICAgICB0aGlzLlIgPSBuZXcgYjJNYXQyMigpO1xyXG4gICB9O1xyXG4gICBiMlRyYW5zZm9ybS5wcm90b3R5cGUuYjJUcmFuc2Zvcm0gPSBmdW5jdGlvbiAocG9zLCByKSB7XHJcbiAgICAgIGlmIChwb3MgPT09IHVuZGVmaW5lZCkgcG9zID0gbnVsbDtcclxuICAgICAgaWYgKHIgPT09IHVuZGVmaW5lZCkgciA9IG51bGw7XHJcbiAgICAgIGlmIChwb3MpIHtcclxuICAgICAgICAgdGhpcy5wb3NpdGlvbi5TZXRWKHBvcyk7XHJcbiAgICAgICAgIHRoaXMuUi5TZXRNKHIpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJUcmFuc2Zvcm0ucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAocG9zLCByKSB7XHJcbiAgICAgIHRoaXMucG9zaXRpb24uU2V0Vihwb3MpO1xyXG4gICAgICB0aGlzLlIuU2V0TShyKTtcclxuICAgfVxyXG4gICBiMlRyYW5zZm9ybS5wcm90b3R5cGUuU2V0SWRlbnRpdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMucG9zaXRpb24uU2V0WmVybygpO1xyXG4gICAgICB0aGlzLlIuU2V0SWRlbnRpdHkoKTtcclxuICAgfVxyXG4gICBiMlRyYW5zZm9ybS5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHgpIHtcclxuICAgICAgdGhpcy5wb3NpdGlvbi5TZXRWKHgucG9zaXRpb24pO1xyXG4gICAgICB0aGlzLlIuU2V0TSh4LlIpO1xyXG4gICB9XHJcbiAgIGIyVHJhbnNmb3JtLnByb3RvdHlwZS5HZXRBbmdsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIE1hdGguYXRhbjIodGhpcy5SLmNvbDEueSwgdGhpcy5SLmNvbDEueCk7XHJcbiAgIH1cclxuICAgYjJWZWMyLmIyVmVjMiA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMlZlYzIucHJvdG90eXBlLmIyVmVjMiA9IGZ1bmN0aW9uICh4XywgeV8pIHtcclxuICAgICAgaWYgKHhfID09PSB1bmRlZmluZWQpIHhfID0gMDtcclxuICAgICAgaWYgKHlfID09PSB1bmRlZmluZWQpIHlfID0gMDtcclxuICAgICAgdGhpcy54ID0geF87XHJcbiAgICAgIHRoaXMueSA9IHlfO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuU2V0WmVybyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy54ID0gMC4wO1xyXG4gICAgICB0aGlzLnkgPSAwLjA7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAoeF8sIHlfKSB7XHJcbiAgICAgIGlmICh4XyA9PT0gdW5kZWZpbmVkKSB4XyA9IDA7XHJcbiAgICAgIGlmICh5XyA9PT0gdW5kZWZpbmVkKSB5XyA9IDA7XHJcbiAgICAgIHRoaXMueCA9IHhfO1xyXG4gICAgICB0aGlzLnkgPSB5XztcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLlNldFYgPSBmdW5jdGlvbiAodikge1xyXG4gICAgICB0aGlzLnggPSB2Lng7XHJcbiAgICAgIHRoaXMueSA9IHYueTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLkdldE5lZ2F0aXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMigoLXRoaXMueCksICgtdGhpcy55KSk7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5OZWdhdGl2ZVNlbGYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMueCA9ICgtdGhpcy54KTtcclxuICAgICAgdGhpcy55ID0gKC10aGlzLnkpO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5NYWtlID0gZnVuY3Rpb24gKHhfLCB5Xykge1xyXG4gICAgICBpZiAoeF8gPT09IHVuZGVmaW5lZCkgeF8gPSAwO1xyXG4gICAgICBpZiAoeV8gPT09IHVuZGVmaW5lZCkgeV8gPSAwO1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMih4XywgeV8pO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIodGhpcy54LCB0aGlzLnkpO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuQWRkID0gZnVuY3Rpb24gKHYpIHtcclxuICAgICAgdGhpcy54ICs9IHYueDtcclxuICAgICAgdGhpcy55ICs9IHYueTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLlN1YnRyYWN0ID0gZnVuY3Rpb24gKHYpIHtcclxuICAgICAgdGhpcy54IC09IHYueDtcclxuICAgICAgdGhpcy55IC09IHYueTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLk11bHRpcGx5ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgaWYgKGEgPT09IHVuZGVmaW5lZCkgYSA9IDA7XHJcbiAgICAgIHRoaXMueCAqPSBhO1xyXG4gICAgICB0aGlzLnkgKj0gYTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLk11bE0gPSBmdW5jdGlvbiAoQSkge1xyXG4gICAgICB2YXIgdFggPSB0aGlzLng7XHJcbiAgICAgIHRoaXMueCA9IEEuY29sMS54ICogdFggKyBBLmNvbDIueCAqIHRoaXMueTtcclxuICAgICAgdGhpcy55ID0gQS5jb2wxLnkgKiB0WCArIEEuY29sMi55ICogdGhpcy55O1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuTXVsVE0gPSBmdW5jdGlvbiAoQSkge1xyXG4gICAgICB2YXIgdFggPSBiMk1hdGguRG90KHRoaXMsIEEuY29sMSk7XHJcbiAgICAgIHRoaXMueSA9IGIyTWF0aC5Eb3QodGhpcywgQS5jb2wyKTtcclxuICAgICAgdGhpcy54ID0gdFg7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5Dcm9zc1ZGID0gZnVuY3Rpb24gKHMpIHtcclxuICAgICAgaWYgKHMgPT09IHVuZGVmaW5lZCkgcyA9IDA7XHJcbiAgICAgIHZhciB0WCA9IHRoaXMueDtcclxuICAgICAgdGhpcy54ID0gcyAqIHRoaXMueTtcclxuICAgICAgdGhpcy55ID0gKC1zICogdFgpO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuQ3Jvc3NGViA9IGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgIGlmIChzID09PSB1bmRlZmluZWQpIHMgPSAwO1xyXG4gICAgICB2YXIgdFggPSB0aGlzLng7XHJcbiAgICAgIHRoaXMueCA9ICgtcyAqIHRoaXMueSk7XHJcbiAgICAgIHRoaXMueSA9IHMgKiB0WDtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLk1pblYgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICB0aGlzLnggPSB0aGlzLnggPCBiLnggPyB0aGlzLnggOiBiLng7XHJcbiAgICAgIHRoaXMueSA9IHRoaXMueSA8IGIueSA/IHRoaXMueSA6IGIueTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLk1heFYgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICB0aGlzLnggPSB0aGlzLnggPiBiLnggPyB0aGlzLnggOiBiLng7XHJcbiAgICAgIHRoaXMueSA9IHRoaXMueSA+IGIueSA/IHRoaXMueSA6IGIueTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLkFicyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgaWYgKHRoaXMueCA8IDApIHRoaXMueCA9ICgtdGhpcy54KTtcclxuICAgICAgaWYgKHRoaXMueSA8IDApIHRoaXMueSA9ICgtdGhpcy55KTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLkxlbmd0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkpO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuTGVuZ3RoU3F1YXJlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkpO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuTm9ybWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgbGVuZ3RoID0gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSk7XHJcbiAgICAgIGlmIChsZW5ndGggPCBOdW1iZXIuTUlOX1ZBTFVFKSB7XHJcbiAgICAgICAgIHJldHVybiAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGludkxlbmd0aCA9IDEuMCAvIGxlbmd0aDtcclxuICAgICAgdGhpcy54ICo9IGludkxlbmd0aDtcclxuICAgICAgdGhpcy55ICo9IGludkxlbmd0aDtcclxuICAgICAgcmV0dXJuIGxlbmd0aDtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLklzVmFsaWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBiMk1hdGguSXNWYWxpZCh0aGlzLngpICYmIGIyTWF0aC5Jc1ZhbGlkKHRoaXMueSk7XHJcbiAgIH1cclxuICAgYjJWZWMzLmIyVmVjMyA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMlZlYzMucHJvdG90eXBlLmIyVmVjMyA9IGZ1bmN0aW9uICh4LCB5LCB6KSB7XHJcbiAgICAgIGlmICh4ID09PSB1bmRlZmluZWQpIHggPSAwO1xyXG4gICAgICBpZiAoeSA9PT0gdW5kZWZpbmVkKSB5ID0gMDtcclxuICAgICAgaWYgKHogPT09IHVuZGVmaW5lZCkgeiA9IDA7XHJcbiAgICAgIHRoaXMueCA9IHg7XHJcbiAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgIHRoaXMueiA9IHo7XHJcbiAgIH1cclxuICAgYjJWZWMzLnByb3RvdHlwZS5TZXRaZXJvID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnggPSB0aGlzLnkgPSB0aGlzLnogPSAwLjA7XHJcbiAgIH1cclxuICAgYjJWZWMzLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAoeCwgeSwgeikge1xyXG4gICAgICBpZiAoeCA9PT0gdW5kZWZpbmVkKSB4ID0gMDtcclxuICAgICAgaWYgKHkgPT09IHVuZGVmaW5lZCkgeSA9IDA7XHJcbiAgICAgIGlmICh6ID09PSB1bmRlZmluZWQpIHogPSAwO1xyXG4gICAgICB0aGlzLnggPSB4O1xyXG4gICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICB0aGlzLnogPSB6O1xyXG4gICB9XHJcbiAgIGIyVmVjMy5wcm90b3R5cGUuU2V0ViA9IGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgIHRoaXMueCA9IHYueDtcclxuICAgICAgdGhpcy55ID0gdi55O1xyXG4gICAgICB0aGlzLnogPSB2Lno7XHJcbiAgIH1cclxuICAgYjJWZWMzLnByb3RvdHlwZS5HZXROZWdhdGl2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzMoKC10aGlzLngpLCAoLXRoaXMueSksICgtdGhpcy56KSk7XHJcbiAgIH1cclxuICAgYjJWZWMzLnByb3RvdHlwZS5OZWdhdGl2ZVNlbGYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMueCA9ICgtdGhpcy54KTtcclxuICAgICAgdGhpcy55ID0gKC10aGlzLnkpO1xyXG4gICAgICB0aGlzLnogPSAoLXRoaXMueik7XHJcbiAgIH1cclxuICAgYjJWZWMzLnByb3RvdHlwZS5Db3B5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMyh0aGlzLngsIHRoaXMueSwgdGhpcy56KTtcclxuICAgfVxyXG4gICBiMlZlYzMucHJvdG90eXBlLkFkZCA9IGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgIHRoaXMueCArPSB2Lng7XHJcbiAgICAgIHRoaXMueSArPSB2Lnk7XHJcbiAgICAgIHRoaXMueiArPSB2Lno7XHJcbiAgIH1cclxuICAgYjJWZWMzLnByb3RvdHlwZS5TdWJ0cmFjdCA9IGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgIHRoaXMueCAtPSB2Lng7XHJcbiAgICAgIHRoaXMueSAtPSB2Lnk7XHJcbiAgICAgIHRoaXMueiAtPSB2Lno7XHJcbiAgIH1cclxuICAgYjJWZWMzLnByb3RvdHlwZS5NdWx0aXBseSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgIGlmIChhID09PSB1bmRlZmluZWQpIGEgPSAwO1xyXG4gICAgICB0aGlzLnggKj0gYTtcclxuICAgICAgdGhpcy55ICo9IGE7XHJcbiAgICAgIHRoaXMueiAqPSBhO1xyXG4gICB9XHJcbn0pKCk7XHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgIHZhciBiMkNvbnRyb2xsZXJFZGdlID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyRWRnZSxcclxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXHJcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxyXG4gICAgICBiMk1hdGggPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGgsXHJcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxyXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxyXG4gICAgICBiMlZlYzIgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIsXHJcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyxcclxuICAgICAgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxyXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXHJcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcclxuICAgICAgYjJBQUJCID0gQm94MkQuQ29sbGlzaW9uLmIyQUFCQixcclxuICAgICAgYjJCb3VuZCA9IEJveDJELkNvbGxpc2lvbi5iMkJvdW5kLFxyXG4gICAgICBiMkJvdW5kVmFsdWVzID0gQm94MkQuQ29sbGlzaW9uLmIyQm91bmRWYWx1ZXMsXHJcbiAgICAgIGIyQ29sbGlzaW9uID0gQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLFxyXG4gICAgICBiMkNvbnRhY3RJRCA9IEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RJRCxcclxuICAgICAgYjJDb250YWN0UG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0UG9pbnQsXHJcbiAgICAgIGIyRGlzdGFuY2UgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZSxcclxuICAgICAgYjJEaXN0YW5jZUlucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VJbnB1dCxcclxuICAgICAgYjJEaXN0YW5jZU91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlT3V0cHV0LFxyXG4gICAgICBiMkRpc3RhbmNlUHJveHkgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZVByb3h5LFxyXG4gICAgICBiMkR5bmFtaWNUcmVlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWUsXHJcbiAgICAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLFxyXG4gICAgICBiMkR5bmFtaWNUcmVlTm9kZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlTm9kZSxcclxuICAgICAgYjJEeW5hbWljVHJlZVBhaXIgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZVBhaXIsXHJcbiAgICAgIGIyTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZCxcclxuICAgICAgYjJNYW5pZm9sZFBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGRQb2ludCxcclxuICAgICAgYjJQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMlBvaW50LFxyXG4gICAgICBiMlJheUNhc3RJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RJbnB1dCxcclxuICAgICAgYjJSYXlDYXN0T3V0cHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdE91dHB1dCxcclxuICAgICAgYjJTZWdtZW50ID0gQm94MkQuQ29sbGlzaW9uLmIyU2VnbWVudCxcclxuICAgICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24gPSBCb3gyRC5Db2xsaXNpb24uYjJTZXBhcmF0aW9uRnVuY3Rpb24sXHJcbiAgICAgIGIyU2ltcGxleCA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXgsXHJcbiAgICAgIGIyU2ltcGxleENhY2hlID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleENhY2hlLFxyXG4gICAgICBiMlNpbXBsZXhWZXJ0ZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4VmVydGV4LFxyXG4gICAgICBiMlRpbWVPZkltcGFjdCA9IEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdCxcclxuICAgICAgYjJUT0lJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlRPSUlucHV0LFxyXG4gICAgICBiMldvcmxkTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJXb3JsZE1hbmlmb2xkLFxyXG4gICAgICBDbGlwVmVydGV4ID0gQm94MkQuQ29sbGlzaW9uLkNsaXBWZXJ0ZXgsXHJcbiAgICAgIEZlYXR1cmVzID0gQm94MkQuQ29sbGlzaW9uLkZlYXR1cmVzLFxyXG4gICAgICBJQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5JQnJvYWRQaGFzZSxcclxuICAgICAgYjJDaXJjbGVTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZSxcclxuICAgICAgYjJFZGdlQ2hhaW5EZWYgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZUNoYWluRGVmLFxyXG4gICAgICBiMkVkZ2VTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlU2hhcGUsXHJcbiAgICAgIGIyTWFzc0RhdGEgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyTWFzc0RhdGEsXHJcbiAgICAgIGIyUG9seWdvblNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlBvbHlnb25TaGFwZSxcclxuICAgICAgYjJTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSxcclxuICAgICAgYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5LFxyXG4gICAgICBiMkJvZHlEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkJvZHlEZWYsXHJcbiAgICAgIGIyQ29udGFjdEZpbHRlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEZpbHRlcixcclxuICAgICAgYjJDb250YWN0SW1wdWxzZSA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEltcHVsc2UsXHJcbiAgICAgIGIyQ29udGFjdExpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0TGlzdGVuZXIsXHJcbiAgICAgIGIyQ29udGFjdE1hbmFnZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RNYW5hZ2VyLFxyXG4gICAgICBiMkRlYnVnRHJhdyA9IEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LFxyXG4gICAgICBiMkRlc3RydWN0aW9uTGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkRlc3RydWN0aW9uTGlzdGVuZXIsXHJcbiAgICAgIGIyRmlsdGVyRGF0YSA9IEJveDJELkR5bmFtaWNzLmIyRmlsdGVyRGF0YSxcclxuICAgICAgYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlLFxyXG4gICAgICBiMkZpeHR1cmVEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkZpeHR1cmVEZWYsXHJcbiAgICAgIGIySXNsYW5kID0gQm94MkQuRHluYW1pY3MuYjJJc2xhbmQsXHJcbiAgICAgIGIyVGltZVN0ZXAgPSBCb3gyRC5EeW5hbWljcy5iMlRpbWVTdGVwLFxyXG4gICAgICBiMldvcmxkID0gQm94MkQuRHluYW1pY3MuYjJXb3JsZCxcclxuICAgICAgYjJDaXJjbGVDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDaXJjbGVDb250YWN0LFxyXG4gICAgICBiMkNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QsXHJcbiAgICAgIGIyQ29udGFjdENvbnN0cmFpbnQgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RDb25zdHJhaW50LFxyXG4gICAgICBiMkNvbnRhY3RDb25zdHJhaW50UG9pbnQgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RDb25zdHJhaW50UG9pbnQsXHJcbiAgICAgIGIyQ29udGFjdEVkZ2UgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RFZGdlLFxyXG4gICAgICBiMkNvbnRhY3RGYWN0b3J5ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0RmFjdG9yeSxcclxuICAgICAgYjJDb250YWN0UmVnaXN0ZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RSZWdpc3RlcixcclxuICAgICAgYjJDb250YWN0UmVzdWx0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0UmVzdWx0LFxyXG4gICAgICBiMkNvbnRhY3RTb2x2ZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RTb2x2ZXIsXHJcbiAgICAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkVkZ2VBbmRDaXJjbGVDb250YWN0LFxyXG4gICAgICBiMk51bGxDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJOdWxsQ29udGFjdCxcclxuICAgICAgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9seUFuZENpcmNsZUNvbnRhY3QsXHJcbiAgICAgIGIyUG9seUFuZEVkZ2VDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kRWRnZUNvbnRhY3QsXHJcbiAgICAgIGIyUG9seWdvbkNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvbHlnb25Db250YWN0LFxyXG4gICAgICBiMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQsXHJcbiAgICAgIGIyQ29udHJvbGxlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcixcclxuICAgICAgYjJEaXN0YW5jZUpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRGlzdGFuY2VKb2ludCxcclxuICAgICAgYjJEaXN0YW5jZUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRGlzdGFuY2VKb2ludERlZixcclxuICAgICAgYjJGcmljdGlvbkpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRnJpY3Rpb25Kb2ludCxcclxuICAgICAgYjJGcmljdGlvbkpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRnJpY3Rpb25Kb2ludERlZixcclxuICAgICAgYjJHZWFySm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJHZWFySm9pbnQsXHJcbiAgICAgIGIyR2VhckpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyR2VhckpvaW50RGVmLFxyXG4gICAgICBiMkphY29iaWFuID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySmFjb2JpYW4sXHJcbiAgICAgIGIySm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCxcclxuICAgICAgYjJKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLFxyXG4gICAgICBiMkpvaW50RWRnZSA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RWRnZSxcclxuICAgICAgYjJMaW5lSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJMaW5lSm9pbnQsXHJcbiAgICAgIGIyTGluZUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyTGluZUpvaW50RGVmLFxyXG4gICAgICBiMk1vdXNlSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJNb3VzZUpvaW50LFxyXG4gICAgICBiMk1vdXNlSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJNb3VzZUpvaW50RGVmLFxyXG4gICAgICBiMlByaXNtYXRpY0pvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHJpc21hdGljSm9pbnQsXHJcbiAgICAgIGIyUHJpc21hdGljSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQcmlzbWF0aWNKb2ludERlZixcclxuICAgICAgYjJQdWxsZXlKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlB1bGxleUpvaW50LFxyXG4gICAgICBiMlB1bGxleUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHVsbGV5Sm9pbnREZWYsXHJcbiAgICAgIGIyUmV2b2x1dGVKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlJldm9sdXRlSm9pbnQsXHJcbiAgICAgIGIyUmV2b2x1dGVKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlJldm9sdXRlSm9pbnREZWYsXHJcbiAgICAgIGIyV2VsZEpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyV2VsZEpvaW50LFxyXG4gICAgICBiMldlbGRKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMldlbGRKb2ludERlZjtcclxuXHJcbiAgIGIyQm9keS5iMkJvZHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV94ZiA9IG5ldyBiMlRyYW5zZm9ybSgpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAgPSBuZXcgYjJTd2VlcCgpO1xyXG4gICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9mb3JjZSA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJCb2R5LnByb3RvdHlwZS5jb25uZWN0RWRnZXMgPSBmdW5jdGlvbiAoczEsIHMyLCBhbmdsZTEpIHtcclxuICAgICAgaWYgKGFuZ2xlMSA9PT0gdW5kZWZpbmVkKSBhbmdsZTEgPSAwO1xyXG4gICAgICB2YXIgYW5nbGUyID0gTWF0aC5hdGFuMihzMi5HZXREaXJlY3Rpb25WZWN0b3IoKS55LCBzMi5HZXREaXJlY3Rpb25WZWN0b3IoKS54KTtcclxuICAgICAgdmFyIGNvcmVPZmZzZXQgPSBNYXRoLnRhbigoYW5nbGUyIC0gYW5nbGUxKSAqIDAuNSk7XHJcbiAgICAgIHZhciBjb3JlID0gYjJNYXRoLk11bEZWKGNvcmVPZmZzZXQsIHMyLkdldERpcmVjdGlvblZlY3RvcigpKTtcclxuICAgICAgY29yZSA9IGIyTWF0aC5TdWJ0cmFjdFZWKGNvcmUsIHMyLkdldE5vcm1hbFZlY3RvcigpKTtcclxuICAgICAgY29yZSA9IGIyTWF0aC5NdWxGVihiMlNldHRpbmdzLmIyX3RvaVNsb3AsIGNvcmUpO1xyXG4gICAgICBjb3JlID0gYjJNYXRoLkFkZFZWKGNvcmUsIHMyLkdldFZlcnRleDEoKSk7XHJcbiAgICAgIHZhciBjb3JuZXJEaXIgPSBiMk1hdGguQWRkVlYoczEuR2V0RGlyZWN0aW9uVmVjdG9yKCksIHMyLkdldERpcmVjdGlvblZlY3RvcigpKTtcclxuICAgICAgY29ybmVyRGlyLk5vcm1hbGl6ZSgpO1xyXG4gICAgICB2YXIgY29udmV4ID0gYjJNYXRoLkRvdChzMS5HZXREaXJlY3Rpb25WZWN0b3IoKSwgczIuR2V0Tm9ybWFsVmVjdG9yKCkpID4gMC4wO1xyXG4gICAgICBzMS5TZXROZXh0RWRnZShzMiwgY29yZSwgY29ybmVyRGlyLCBjb252ZXgpO1xyXG4gICAgICBzMi5TZXRQcmV2RWRnZShzMSwgY29yZSwgY29ybmVyRGlyLCBjb252ZXgpO1xyXG4gICAgICByZXR1cm4gYW5nbGUyO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuQ3JlYXRlRml4dHVyZSA9IGZ1bmN0aW9uIChkZWYpIHtcclxuICAgICAgaWYgKHRoaXMubV93b3JsZC5Jc0xvY2tlZCgpID09IHRydWUpIHtcclxuICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGZpeHR1cmUgPSBuZXcgYjJGaXh0dXJlKCk7XHJcbiAgICAgIGZpeHR1cmUuQ3JlYXRlKHRoaXMsIHRoaXMubV94ZiwgZGVmKTtcclxuICAgICAgaWYgKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2FjdGl2ZUZsYWcpIHtcclxuICAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcbiAgICAgICAgIGZpeHR1cmUuQ3JlYXRlUHJveHkoYnJvYWRQaGFzZSwgdGhpcy5tX3hmKTtcclxuICAgICAgfVxyXG4gICAgICBmaXh0dXJlLm1fbmV4dCA9IHRoaXMubV9maXh0dXJlTGlzdDtcclxuICAgICAgdGhpcy5tX2ZpeHR1cmVMaXN0ID0gZml4dHVyZTtcclxuICAgICAgKyt0aGlzLm1fZml4dHVyZUNvdW50O1xyXG4gICAgICBmaXh0dXJlLm1fYm9keSA9IHRoaXM7XHJcbiAgICAgIGlmIChmaXh0dXJlLm1fZGVuc2l0eSA+IDAuMCkge1xyXG4gICAgICAgICB0aGlzLlJlc2V0TWFzc0RhdGEoKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fd29ybGQubV9mbGFncyB8PSBiMldvcmxkLmVfbmV3Rml4dHVyZTtcclxuICAgICAgcmV0dXJuIGZpeHR1cmU7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5DcmVhdGVGaXh0dXJlMiA9IGZ1bmN0aW9uIChzaGFwZSwgZGVuc2l0eSkge1xyXG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMC4wO1xyXG4gICAgICB2YXIgZGVmID0gbmV3IGIyRml4dHVyZURlZigpO1xyXG4gICAgICBkZWYuc2hhcGUgPSBzaGFwZTtcclxuICAgICAgZGVmLmRlbnNpdHkgPSBkZW5zaXR5O1xyXG4gICAgICByZXR1cm4gdGhpcy5DcmVhdGVGaXh0dXJlKGRlZik7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5EZXN0cm95Rml4dHVyZSA9IGZ1bmN0aW9uIChmaXh0dXJlKSB7XHJcbiAgICAgIGlmICh0aGlzLm1fd29ybGQuSXNMb2NrZWQoKSA9PSB0cnVlKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgbm9kZSA9IHRoaXMubV9maXh0dXJlTGlzdDtcclxuICAgICAgdmFyIHBwRiA9IG51bGw7XHJcbiAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xyXG4gICAgICB3aGlsZSAobm9kZSAhPSBudWxsKSB7XHJcbiAgICAgICAgIGlmIChub2RlID09IGZpeHR1cmUpIHtcclxuICAgICAgICAgICAgaWYgKHBwRikgcHBGLm1fbmV4dCA9IGZpeHR1cmUubV9uZXh0O1xyXG4gICAgICAgICAgICBlbHNlIHRoaXMubV9maXh0dXJlTGlzdCA9IGZpeHR1cmUubV9uZXh0O1xyXG4gICAgICAgICAgICBmb3VuZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHBwRiA9IG5vZGU7XHJcbiAgICAgICAgIG5vZGUgPSBub2RlLm1fbmV4dDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgZWRnZSA9IHRoaXMubV9jb250YWN0TGlzdDtcclxuICAgICAgd2hpbGUgKGVkZ2UpIHtcclxuICAgICAgICAgdmFyIGMgPSBlZGdlLmNvbnRhY3Q7XHJcbiAgICAgICAgIGVkZ2UgPSBlZGdlLm5leHQ7XHJcbiAgICAgICAgIHZhciBmaXh0dXJlQSA9IGMuR2V0Rml4dHVyZUEoKTtcclxuICAgICAgICAgdmFyIGZpeHR1cmVCID0gYy5HZXRGaXh0dXJlQigpO1xyXG4gICAgICAgICBpZiAoZml4dHVyZSA9PSBmaXh0dXJlQSB8fCBmaXh0dXJlID09IGZpeHR1cmVCKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLkRlc3Ryb3koYyk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfYWN0aXZlRmxhZykge1xyXG4gICAgICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcclxuICAgICAgICAgZml4dHVyZS5EZXN0cm95UHJveHkoYnJvYWRQaGFzZSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7fVxyXG4gICAgICBmaXh0dXJlLkRlc3Ryb3koKTtcclxuICAgICAgZml4dHVyZS5tX2JvZHkgPSBudWxsO1xyXG4gICAgICBmaXh0dXJlLm1fbmV4dCA9IG51bGw7XHJcbiAgICAgIC0tdGhpcy5tX2ZpeHR1cmVDb3VudDtcclxuICAgICAgdGhpcy5SZXNldE1hc3NEYXRhKCk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRQb3NpdGlvbkFuZEFuZ2xlID0gZnVuY3Rpb24gKHBvc2l0aW9uLCBhbmdsZSkge1xyXG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwO1xyXG4gICAgICB2YXIgZjtcclxuICAgICAgaWYgKHRoaXMubV93b3JsZC5Jc0xvY2tlZCgpID09IHRydWUpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV94Zi5SLlNldChhbmdsZSk7XHJcbiAgICAgIHRoaXMubV94Zi5wb3NpdGlvbi5TZXRWKHBvc2l0aW9uKTtcclxuICAgICAgdmFyIHRNYXQgPSB0aGlzLm1feGYuUjtcclxuICAgICAgdmFyIHRWZWMgPSB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXI7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLnggPSAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLnkgPSAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLnggKz0gdGhpcy5tX3hmLnBvc2l0aW9uLng7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLnkgKz0gdGhpcy5tX3hmLnBvc2l0aW9uLnk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jMC5TZXRWKHRoaXMubV9zd2VlcC5jKTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmEwID0gdGhpcy5tX3N3ZWVwLmEgPSBhbmdsZTtcclxuICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcbiAgICAgIGZvciAoZiA9IHRoaXMubV9maXh0dXJlTGlzdDtcclxuICAgICAgZjsgZiA9IGYubV9uZXh0KSB7XHJcbiAgICAgICAgIGYuU3luY2hyb25pemUoYnJvYWRQaGFzZSwgdGhpcy5tX3hmLCB0aGlzLm1feGYpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLkZpbmROZXdDb250YWN0cygpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHhmKSB7XHJcbiAgICAgIHRoaXMuU2V0UG9zaXRpb25BbmRBbmdsZSh4Zi5wb3NpdGlvbiwgeGYuR2V0QW5nbGUoKSk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1feGY7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV94Zi5wb3NpdGlvbjtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlNldFBvc2l0aW9uID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XHJcbiAgICAgIHRoaXMuU2V0UG9zaXRpb25BbmRBbmdsZShwb3NpdGlvbiwgdGhpcy5HZXRBbmdsZSgpKTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldEFuZ2xlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3N3ZWVwLmE7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRBbmdsZSA9IGZ1bmN0aW9uIChhbmdsZSkge1xyXG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwO1xyXG4gICAgICB0aGlzLlNldFBvc2l0aW9uQW5kQW5nbGUodGhpcy5HZXRQb3NpdGlvbigpLCBhbmdsZSk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRXb3JsZENlbnRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9zd2VlcC5jO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0TG9jYWxDZW50ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXI7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRMaW5lYXJWZWxvY2l0eSA9IGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LlNldFYodik7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRMaW5lYXJWZWxvY2l0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9saW5lYXJWZWxvY2l0eTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlNldEFuZ3VsYXJWZWxvY2l0eSA9IGZ1bmN0aW9uIChvbWVnYSkge1xyXG4gICAgICBpZiAob21lZ2EgPT09IHVuZGVmaW5lZCkgb21lZ2EgPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX3R5cGUgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgPSBvbWVnYTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldEFuZ3VsYXJWZWxvY2l0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXREZWZpbml0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgYmQgPSBuZXcgYjJCb2R5RGVmKCk7XHJcbiAgICAgIGJkLnR5cGUgPSB0aGlzLkdldFR5cGUoKTtcclxuICAgICAgYmQuYWxsb3dTbGVlcCA9ICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9hbGxvd1NsZWVwRmxhZykgPT0gYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWc7XHJcbiAgICAgIGJkLmFuZ2xlID0gdGhpcy5HZXRBbmdsZSgpO1xyXG4gICAgICBiZC5hbmd1bGFyRGFtcGluZyA9IHRoaXMubV9hbmd1bGFyRGFtcGluZztcclxuICAgICAgYmQuYW5ndWxhclZlbG9jaXR5ID0gdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgYmQuZml4ZWRSb3RhdGlvbiA9ICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZykgPT0gYjJCb2R5LmVfZml4ZWRSb3RhdGlvbkZsYWc7XHJcbiAgICAgIGJkLmJ1bGxldCA9ICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9idWxsZXRGbGFnKSA9PSBiMkJvZHkuZV9idWxsZXRGbGFnO1xyXG4gICAgICBiZC5hd2FrZSA9ICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9hd2FrZUZsYWcpID09IGIyQm9keS5lX2F3YWtlRmxhZztcclxuICAgICAgYmQubGluZWFyRGFtcGluZyA9IHRoaXMubV9saW5lYXJEYW1waW5nO1xyXG4gICAgICBiZC5saW5lYXJWZWxvY2l0eS5TZXRWKHRoaXMuR2V0TGluZWFyVmVsb2NpdHkoKSk7XHJcbiAgICAgIGJkLnBvc2l0aW9uID0gdGhpcy5HZXRQb3NpdGlvbigpO1xyXG4gICAgICBiZC51c2VyRGF0YSA9IHRoaXMuR2V0VXNlckRhdGEoKTtcclxuICAgICAgcmV0dXJuIGJkO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuQXBwbHlGb3JjZSA9IGZ1bmN0aW9uIChmb3JjZSwgcG9pbnQpIHtcclxuICAgICAgaWYgKHRoaXMubV90eXBlICE9IGIyQm9keS5iMl9keW5hbWljQm9keSkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuSXNBd2FrZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHRoaXMuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2ZvcmNlLnggKz0gZm9yY2UueDtcclxuICAgICAgdGhpcy5tX2ZvcmNlLnkgKz0gZm9yY2UueTtcclxuICAgICAgdGhpcy5tX3RvcnF1ZSArPSAoKHBvaW50LnggLSB0aGlzLm1fc3dlZXAuYy54KSAqIGZvcmNlLnkgLSAocG9pbnQueSAtIHRoaXMubV9zd2VlcC5jLnkpICogZm9yY2UueCk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5BcHBseVRvcnF1ZSA9IGZ1bmN0aW9uICh0b3JxdWUpIHtcclxuICAgICAgaWYgKHRvcnF1ZSA9PT0gdW5kZWZpbmVkKSB0b3JxdWUgPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX3R5cGUgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5Jc0F3YWtlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgdGhpcy5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fdG9ycXVlICs9IHRvcnF1ZTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkFwcGx5SW1wdWxzZSA9IGZ1bmN0aW9uIChpbXB1bHNlLCBwb2ludCkge1xyXG4gICAgICBpZiAodGhpcy5tX3R5cGUgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5Jc0F3YWtlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgdGhpcy5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkueCArPSB0aGlzLm1faW52TWFzcyAqIGltcHVsc2UueDtcclxuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnkgKz0gdGhpcy5tX2ludk1hc3MgKiBpbXB1bHNlLnk7XHJcbiAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKz0gdGhpcy5tX2ludkkgKiAoKHBvaW50LnggLSB0aGlzLm1fc3dlZXAuYy54KSAqIGltcHVsc2UueSAtIChwb2ludC55IC0gdGhpcy5tX3N3ZWVwLmMueSkgKiBpbXB1bHNlLngpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU3BsaXQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgdmFyIGxpbmVhclZlbG9jaXR5ID0gdGhpcy5HZXRMaW5lYXJWZWxvY2l0eSgpLkNvcHkoKTtcclxuICAgICAgdmFyIGFuZ3VsYXJWZWxvY2l0eSA9IHRoaXMuR2V0QW5ndWxhclZlbG9jaXR5KCk7XHJcbiAgICAgIHZhciBjZW50ZXIgPSB0aGlzLkdldFdvcmxkQ2VudGVyKCk7XHJcbiAgICAgIHZhciBib2R5MSA9IHRoaXM7XHJcbiAgICAgIHZhciBib2R5MiA9IHRoaXMubV93b3JsZC5DcmVhdGVCb2R5KHRoaXMuR2V0RGVmaW5pdGlvbigpKTtcclxuICAgICAgdmFyIHByZXY7XHJcbiAgICAgIGZvciAodmFyIGYgPSBib2R5MS5tX2ZpeHR1cmVMaXN0OyBmOykge1xyXG4gICAgICAgICBpZiAoY2FsbGJhY2soZikpIHtcclxuICAgICAgICAgICAgdmFyIG5leHQgPSBmLm1fbmV4dDtcclxuICAgICAgICAgICAgaWYgKHByZXYpIHtcclxuICAgICAgICAgICAgICAgcHJldi5tX25leHQgPSBuZXh0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICBib2R5MS5tX2ZpeHR1cmVMaXN0ID0gbmV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBib2R5MS5tX2ZpeHR1cmVDb3VudC0tO1xyXG4gICAgICAgICAgICBmLm1fbmV4dCA9IGJvZHkyLm1fZml4dHVyZUxpc3Q7XHJcbiAgICAgICAgICAgIGJvZHkyLm1fZml4dHVyZUxpc3QgPSBmO1xyXG4gICAgICAgICAgICBib2R5Mi5tX2ZpeHR1cmVDb3VudCsrO1xyXG4gICAgICAgICAgICBmLm1fYm9keSA9IGJvZHkyO1xyXG4gICAgICAgICAgICBmID0gbmV4dDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcHJldiA9IGY7XHJcbiAgICAgICAgICAgIGYgPSBmLm1fbmV4dDtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGJvZHkxLlJlc2V0TWFzc0RhdGEoKTtcclxuICAgICAgYm9keTIuUmVzZXRNYXNzRGF0YSgpO1xyXG4gICAgICB2YXIgY2VudGVyMSA9IGJvZHkxLkdldFdvcmxkQ2VudGVyKCk7XHJcbiAgICAgIHZhciBjZW50ZXIyID0gYm9keTIuR2V0V29ybGRDZW50ZXIoKTtcclxuICAgICAgdmFyIHZlbG9jaXR5MSA9IGIyTWF0aC5BZGRWVihsaW5lYXJWZWxvY2l0eSwgYjJNYXRoLkNyb3NzRlYoYW5ndWxhclZlbG9jaXR5LCBiMk1hdGguU3VidHJhY3RWVihjZW50ZXIxLCBjZW50ZXIpKSk7XHJcbiAgICAgIHZhciB2ZWxvY2l0eTIgPSBiMk1hdGguQWRkVlYobGluZWFyVmVsb2NpdHksIGIyTWF0aC5Dcm9zc0ZWKGFuZ3VsYXJWZWxvY2l0eSwgYjJNYXRoLlN1YnRyYWN0VlYoY2VudGVyMiwgY2VudGVyKSkpO1xyXG4gICAgICBib2R5MS5TZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eTEpO1xyXG4gICAgICBib2R5Mi5TZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eTIpO1xyXG4gICAgICBib2R5MS5TZXRBbmd1bGFyVmVsb2NpdHkoYW5ndWxhclZlbG9jaXR5KTtcclxuICAgICAgYm9keTIuU2V0QW5ndWxhclZlbG9jaXR5KGFuZ3VsYXJWZWxvY2l0eSk7XHJcbiAgICAgIGJvZHkxLlN5bmNocm9uaXplRml4dHVyZXMoKTtcclxuICAgICAgYm9keTIuU3luY2hyb25pemVGaXh0dXJlcygpO1xyXG4gICAgICByZXR1cm4gYm9keTI7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5NZXJnZSA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICB2YXIgZjtcclxuICAgICAgZm9yIChmID0gb3RoZXIubV9maXh0dXJlTGlzdDtcclxuICAgICAgZjspIHtcclxuICAgICAgICAgdmFyIG5leHQgPSBmLm1fbmV4dDtcclxuICAgICAgICAgb3RoZXIubV9maXh0dXJlQ291bnQtLTtcclxuICAgICAgICAgZi5tX25leHQgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XHJcbiAgICAgICAgIHRoaXMubV9maXh0dXJlTGlzdCA9IGY7XHJcbiAgICAgICAgIHRoaXMubV9maXh0dXJlQ291bnQrKztcclxuICAgICAgICAgZi5tX2JvZHkgPSBib2R5MjtcclxuICAgICAgICAgZiA9IG5leHQ7XHJcbiAgICAgIH1cclxuICAgICAgYm9keTEubV9maXh0dXJlQ291bnQgPSAwO1xyXG4gICAgICB2YXIgYm9keTEgPSB0aGlzO1xyXG4gICAgICB2YXIgYm9keTIgPSBvdGhlcjtcclxuICAgICAgdmFyIGNlbnRlcjEgPSBib2R5MS5HZXRXb3JsZENlbnRlcigpO1xyXG4gICAgICB2YXIgY2VudGVyMiA9IGJvZHkyLkdldFdvcmxkQ2VudGVyKCk7XHJcbiAgICAgIHZhciB2ZWxvY2l0eTEgPSBib2R5MS5HZXRMaW5lYXJWZWxvY2l0eSgpLkNvcHkoKTtcclxuICAgICAgdmFyIHZlbG9jaXR5MiA9IGJvZHkyLkdldExpbmVhclZlbG9jaXR5KCkuQ29weSgpO1xyXG4gICAgICB2YXIgYW5ndWxhcjEgPSBib2R5MS5HZXRBbmd1bGFyVmVsb2NpdHkoKTtcclxuICAgICAgdmFyIGFuZ3VsYXIgPSBib2R5Mi5HZXRBbmd1bGFyVmVsb2NpdHkoKTtcclxuICAgICAgYm9keTEuUmVzZXRNYXNzRGF0YSgpO1xyXG4gICAgICB0aGlzLlN5bmNocm9uaXplRml4dHVyZXMoKTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldE1hc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbWFzcztcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldEluZXJ0aWEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fSTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldE1hc3NEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgZGF0YS5tYXNzID0gdGhpcy5tX21hc3M7XHJcbiAgICAgIGRhdGEuSSA9IHRoaXMubV9JO1xyXG4gICAgICBkYXRhLmNlbnRlci5TZXRWKHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcik7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRNYXNzRGF0YSA9IGZ1bmN0aW9uIChtYXNzRGF0YSkge1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KHRoaXMubV93b3JsZC5Jc0xvY2tlZCgpID09IGZhbHNlKTtcclxuICAgICAgaWYgKHRoaXMubV93b3JsZC5Jc0xvY2tlZCgpID09IHRydWUpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9pbnZNYXNzID0gMC4wO1xyXG4gICAgICB0aGlzLm1fSSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2ludkkgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9tYXNzID0gbWFzc0RhdGEubWFzcztcclxuICAgICAgaWYgKHRoaXMubV9tYXNzIDw9IDAuMCkge1xyXG4gICAgICAgICB0aGlzLm1fbWFzcyA9IDEuMDtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1faW52TWFzcyA9IDEuMCAvIHRoaXMubV9tYXNzO1xyXG4gICAgICBpZiAobWFzc0RhdGEuSSA+IDAuMCAmJiAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfZml4ZWRSb3RhdGlvbkZsYWcpID09IDApIHtcclxuICAgICAgICAgdGhpcy5tX0kgPSBtYXNzRGF0YS5JIC0gdGhpcy5tX21hc3MgKiAobWFzc0RhdGEuY2VudGVyLnggKiBtYXNzRGF0YS5jZW50ZXIueCArIG1hc3NEYXRhLmNlbnRlci55ICogbWFzc0RhdGEuY2VudGVyLnkpO1xyXG4gICAgICAgICB0aGlzLm1faW52SSA9IDEuMCAvIHRoaXMubV9JO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBvbGRDZW50ZXIgPSB0aGlzLm1fc3dlZXAuYy5Db3B5KCk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlci5TZXRWKG1hc3NEYXRhLmNlbnRlcik7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jMC5TZXRWKGIyTWF0aC5NdWxYKHRoaXMubV94ZiwgdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyKSk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLlNldFYodGhpcy5tX3N3ZWVwLmMwKTtcclxuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnggKz0gdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSAqICgtKHRoaXMubV9zd2VlcC5jLnkgLSBvbGRDZW50ZXIueSkpO1xyXG4gICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkueSArPSB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICogKCsodGhpcy5tX3N3ZWVwLmMueCAtIG9sZENlbnRlci54KSk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5SZXNldE1hc3NEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fbWFzcyA9IDAuMDtcclxuICAgICAgdGhpcy5tX2ludk1hc3MgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9JID0gMC4wO1xyXG4gICAgICB0aGlzLm1faW52SSA9IDAuMDtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyLlNldFplcm8oKTtcclxuICAgICAgaWYgKHRoaXMubV90eXBlID09IGIyQm9keS5iMl9zdGF0aWNCb2R5IHx8IHRoaXMubV90eXBlID09IGIyQm9keS5iMl9raW5lbWF0aWNCb2R5KSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgY2VudGVyID0gYjJWZWMyLk1ha2UoMCwgMCk7XHJcbiAgICAgIGZvciAodmFyIGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xyXG4gICAgICAgICBpZiAoZi5tX2RlbnNpdHkgPT0gMC4wKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciBtYXNzRGF0YSA9IGYuR2V0TWFzc0RhdGEoKTtcclxuICAgICAgICAgdGhpcy5tX21hc3MgKz0gbWFzc0RhdGEubWFzcztcclxuICAgICAgICAgY2VudGVyLnggKz0gbWFzc0RhdGEuY2VudGVyLnggKiBtYXNzRGF0YS5tYXNzO1xyXG4gICAgICAgICBjZW50ZXIueSArPSBtYXNzRGF0YS5jZW50ZXIueSAqIG1hc3NEYXRhLm1hc3M7XHJcbiAgICAgICAgIHRoaXMubV9JICs9IG1hc3NEYXRhLkk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubV9tYXNzID4gMC4wKSB7XHJcbiAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMS4wIC8gdGhpcy5tX21hc3M7XHJcbiAgICAgICAgIGNlbnRlci54ICo9IHRoaXMubV9pbnZNYXNzO1xyXG4gICAgICAgICBjZW50ZXIueSAqPSB0aGlzLm1faW52TWFzcztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX21hc3MgPSAxLjA7XHJcbiAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMS4wO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fSSA+IDAuMCAmJiAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfZml4ZWRSb3RhdGlvbkZsYWcpID09IDApIHtcclxuICAgICAgICAgdGhpcy5tX0kgLT0gdGhpcy5tX21hc3MgKiAoY2VudGVyLnggKiBjZW50ZXIueCArIGNlbnRlci55ICogY2VudGVyLnkpO1xyXG4gICAgICAgICB0aGlzLm1fSSAqPSB0aGlzLm1faW5lcnRpYVNjYWxlO1xyXG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KHRoaXMubV9JID4gMCk7XHJcbiAgICAgICAgIHRoaXMubV9pbnZJID0gMS4wIC8gdGhpcy5tX0k7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9JID0gMC4wO1xyXG4gICAgICAgICB0aGlzLm1faW52SSA9IDAuMDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgb2xkQ2VudGVyID0gdGhpcy5tX3N3ZWVwLmMuQ29weSgpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIuU2V0VihjZW50ZXIpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYzAuU2V0VihiMk1hdGguTXVsWCh0aGlzLm1feGYsIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcikpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYy5TZXRWKHRoaXMubV9zd2VlcC5jMCk7XHJcbiAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS54ICs9IHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKiAoLSh0aGlzLm1fc3dlZXAuYy55IC0gb2xkQ2VudGVyLnkpKTtcclxuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnkgKz0gdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSAqICgrKHRoaXMubV9zd2VlcC5jLnggLSBvbGRDZW50ZXIueCkpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0V29ybGRQb2ludCA9IGZ1bmN0aW9uIChsb2NhbFBvaW50KSB7XHJcbiAgICAgIHZhciBBID0gdGhpcy5tX3hmLlI7XHJcbiAgICAgIHZhciB1ID0gbmV3IGIyVmVjMihBLmNvbDEueCAqIGxvY2FsUG9pbnQueCArIEEuY29sMi54ICogbG9jYWxQb2ludC55LCBBLmNvbDEueSAqIGxvY2FsUG9pbnQueCArIEEuY29sMi55ICogbG9jYWxQb2ludC55KTtcclxuICAgICAgdS54ICs9IHRoaXMubV94Zi5wb3NpdGlvbi54O1xyXG4gICAgICB1LnkgKz0gdGhpcy5tX3hmLnBvc2l0aW9uLnk7XHJcbiAgICAgIHJldHVybiB1O1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0V29ybGRWZWN0b3IgPSBmdW5jdGlvbiAobG9jYWxWZWN0b3IpIHtcclxuICAgICAgcmV0dXJuIGIyTWF0aC5NdWxNVih0aGlzLm1feGYuUiwgbG9jYWxWZWN0b3IpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0TG9jYWxQb2ludCA9IGZ1bmN0aW9uICh3b3JsZFBvaW50KSB7XHJcbiAgICAgIHJldHVybiBiMk1hdGguTXVsWFQodGhpcy5tX3hmLCB3b3JsZFBvaW50KTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldExvY2FsVmVjdG9yID0gZnVuY3Rpb24gKHdvcmxkVmVjdG9yKSB7XHJcbiAgICAgIHJldHVybiBiMk1hdGguTXVsVE1WKHRoaXMubV94Zi5SLCB3b3JsZFZlY3Rvcik7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRMaW5lYXJWZWxvY2l0eUZyb21Xb3JsZFBvaW50ID0gZnVuY3Rpb24gKHdvcmxkUG9pbnQpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIodGhpcy5tX2xpbmVhclZlbG9jaXR5LnggLSB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICogKHdvcmxkUG9pbnQueSAtIHRoaXMubV9zd2VlcC5jLnkpLCB0aGlzLm1fbGluZWFyVmVsb2NpdHkueSArIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKiAod29ybGRQb2ludC54IC0gdGhpcy5tX3N3ZWVwLmMueCkpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0TGluZWFyVmVsb2NpdHlGcm9tTG9jYWxQb2ludCA9IGZ1bmN0aW9uIChsb2NhbFBvaW50KSB7XHJcbiAgICAgIHZhciBBID0gdGhpcy5tX3hmLlI7XHJcbiAgICAgIHZhciB3b3JsZFBvaW50ID0gbmV3IGIyVmVjMihBLmNvbDEueCAqIGxvY2FsUG9pbnQueCArIEEuY29sMi54ICogbG9jYWxQb2ludC55LCBBLmNvbDEueSAqIGxvY2FsUG9pbnQueCArIEEuY29sMi55ICogbG9jYWxQb2ludC55KTtcclxuICAgICAgd29ybGRQb2ludC54ICs9IHRoaXMubV94Zi5wb3NpdGlvbi54O1xyXG4gICAgICB3b3JsZFBvaW50LnkgKz0gdGhpcy5tX3hmLnBvc2l0aW9uLnk7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKHRoaXMubV9saW5lYXJWZWxvY2l0eS54IC0gdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSAqICh3b3JsZFBvaW50LnkgLSB0aGlzLm1fc3dlZXAuYy55KSwgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnkgKyB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICogKHdvcmxkUG9pbnQueCAtIHRoaXMubV9zd2VlcC5jLngpKTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldExpbmVhckRhbXBpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbGluZWFyRGFtcGluZztcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlNldExpbmVhckRhbXBpbmcgPSBmdW5jdGlvbiAobGluZWFyRGFtcGluZykge1xyXG4gICAgICBpZiAobGluZWFyRGFtcGluZyA9PT0gdW5kZWZpbmVkKSBsaW5lYXJEYW1waW5nID0gMDtcclxuICAgICAgdGhpcy5tX2xpbmVhckRhbXBpbmcgPSBsaW5lYXJEYW1waW5nO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0QW5ndWxhckRhbXBpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYW5ndWxhckRhbXBpbmc7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRBbmd1bGFyRGFtcGluZyA9IGZ1bmN0aW9uIChhbmd1bGFyRGFtcGluZykge1xyXG4gICAgICBpZiAoYW5ndWxhckRhbXBpbmcgPT09IHVuZGVmaW5lZCkgYW5ndWxhckRhbXBpbmcgPSAwO1xyXG4gICAgICB0aGlzLm1fYW5ndWxhckRhbXBpbmcgPSBhbmd1bGFyRGFtcGluZztcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlNldFR5cGUgPSBmdW5jdGlvbiAodHlwZSkge1xyXG4gICAgICBpZiAodHlwZSA9PT0gdW5kZWZpbmVkKSB0eXBlID0gMDtcclxuICAgICAgaWYgKHRoaXMubV90eXBlID09IHR5cGUpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV90eXBlID0gdHlwZTtcclxuICAgICAgdGhpcy5SZXNldE1hc3NEYXRhKCk7XHJcbiAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xyXG4gICAgICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkuU2V0WmVybygpO1xyXG4gICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9mb3JjZS5TZXRaZXJvKCk7XHJcbiAgICAgIHRoaXMubV90b3JxdWUgPSAwLjA7XHJcbiAgICAgIGZvciAodmFyIGNlID0gdGhpcy5tX2NvbnRhY3RMaXN0OyBjZTsgY2UgPSBjZS5uZXh0KSB7XHJcbiAgICAgICAgIGNlLmNvbnRhY3QuRmxhZ0ZvckZpbHRlcmluZygpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRUeXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRCdWxsZXQgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICBpZiAoZmxhZykge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYnVsbGV0RmxhZztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkJvZHkuZV9idWxsZXRGbGFnO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5Jc0J1bGxldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9idWxsZXRGbGFnKSA9PSBiMkJvZHkuZV9idWxsZXRGbGFnO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0U2xlZXBpbmdBbGxvd2VkID0gZnVuY3Rpb24gKGZsYWcpIHtcclxuICAgICAgaWYgKGZsYWcpIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2FsbG93U2xlZXBGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyQm9keS5lX2FsbG93U2xlZXBGbGFnO1xyXG4gICAgICAgICB0aGlzLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRBd2FrZSA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgIGlmIChmbGFnKSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkJvZHkuZV9hd2FrZUZsYWc7XHJcbiAgICAgICAgIHRoaXMubV9zbGVlcFRpbWUgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyAmPSB+YjJCb2R5LmVfYXdha2VGbGFnO1xyXG4gICAgICAgICB0aGlzLm1fc2xlZXBUaW1lID0gMC4wO1xyXG4gICAgICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkuU2V0WmVybygpO1xyXG4gICAgICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gMC4wO1xyXG4gICAgICAgICB0aGlzLm1fZm9yY2UuU2V0WmVybygpO1xyXG4gICAgICAgICB0aGlzLm1fdG9ycXVlID0gMC4wO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5Jc0F3YWtlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2F3YWtlRmxhZykgPT0gYjJCb2R5LmVfYXdha2VGbGFnO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0Rml4ZWRSb3RhdGlvbiA9IGZ1bmN0aW9uIChmaXhlZCkge1xyXG4gICAgICBpZiAoZml4ZWQpIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuUmVzZXRNYXNzRGF0YSgpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuSXNGaXhlZFJvdGF0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnKSA9PSBiMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZztcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlNldEFjdGl2ZSA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgIGlmIChmbGFnID09IHRoaXMuSXNBY3RpdmUoKSkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGJyb2FkUGhhc2U7XHJcbiAgICAgIHZhciBmO1xyXG4gICAgICBpZiAoZmxhZykge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYWN0aXZlRmxhZztcclxuICAgICAgICAgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcclxuICAgICAgICAgZm9yIChmID0gdGhpcy5tX2ZpeHR1cmVMaXN0O1xyXG4gICAgICAgICBmOyBmID0gZi5tX25leHQpIHtcclxuICAgICAgICAgICAgZi5DcmVhdGVQcm94eShicm9hZFBoYXNlLCB0aGlzLm1feGYpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyAmPSB+YjJCb2R5LmVfYWN0aXZlRmxhZztcclxuICAgICAgICAgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcclxuICAgICAgICAgZm9yIChmID0gdGhpcy5tX2ZpeHR1cmVMaXN0O1xyXG4gICAgICAgICBmOyBmID0gZi5tX25leHQpIHtcclxuICAgICAgICAgICAgZi5EZXN0cm95UHJveHkoYnJvYWRQaGFzZSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIGNlID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xyXG4gICAgICAgICB3aGlsZSAoY2UpIHtcclxuICAgICAgICAgICAgdmFyIGNlMCA9IGNlO1xyXG4gICAgICAgICAgICBjZSA9IGNlLm5leHQ7XHJcbiAgICAgICAgICAgIHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLkRlc3Ryb3koY2UwLmNvbnRhY3QpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IG51bGw7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLklzQWN0aXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2FjdGl2ZUZsYWcpID09IGIyQm9keS5lX2FjdGl2ZUZsYWc7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5Jc1NsZWVwaW5nQWxsb3dlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9hbGxvd1NsZWVwRmxhZykgPT0gYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWc7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRGaXh0dXJlTGlzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9maXh0dXJlTGlzdDtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldEpvaW50TGlzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9qb2ludExpc3Q7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRDb250cm9sbGVyTGlzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jb250cm9sbGVyTGlzdDtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldENvbnRhY3RMaXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2NvbnRhY3RMaXN0O1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0TmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0VXNlckRhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdXNlckRhdGE7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRVc2VyRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRhdGE7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRXb3JsZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV93b3JsZDtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLmIyQm9keSA9IGZ1bmN0aW9uIChiZCwgd29ybGQpIHtcclxuICAgICAgdGhpcy5tX2ZsYWdzID0gMDtcclxuICAgICAgaWYgKGJkLmJ1bGxldCkge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYnVsbGV0RmxhZztcclxuICAgICAgfVxyXG4gICAgICBpZiAoYmQuZml4ZWRSb3RhdGlvbikge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfZml4ZWRSb3RhdGlvbkZsYWc7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGJkLmFsbG93U2xlZXApIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2FsbG93U2xlZXBGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiZC5hd2FrZSkge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYXdha2VGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiZC5hY3RpdmUpIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2FjdGl2ZUZsYWc7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX3dvcmxkID0gd29ybGQ7XHJcbiAgICAgIHRoaXMubV94Zi5wb3NpdGlvbi5TZXRWKGJkLnBvc2l0aW9uKTtcclxuICAgICAgdGhpcy5tX3hmLlIuU2V0KGJkLmFuZ2xlKTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLnQwID0gMS4wO1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYTAgPSB0aGlzLm1fc3dlZXAuYSA9IGJkLmFuZ2xlO1xyXG4gICAgICB2YXIgdE1hdCA9IHRoaXMubV94Zi5SO1xyXG4gICAgICB2YXIgdFZlYyA9IHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcjtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmMueCA9ICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmMueSA9ICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmMueCArPSB0aGlzLm1feGYucG9zaXRpb24ueDtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmMueSArPSB0aGlzLm1feGYucG9zaXRpb24ueTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmMwLlNldFYodGhpcy5tX3N3ZWVwLmMpO1xyXG4gICAgICB0aGlzLm1fam9pbnRMaXN0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJMaXN0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9wcmV2ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkuU2V0VihiZC5saW5lYXJWZWxvY2l0eSk7XHJcbiAgICAgIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgPSBiZC5hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHRoaXMubV9saW5lYXJEYW1waW5nID0gYmQubGluZWFyRGFtcGluZztcclxuICAgICAgdGhpcy5tX2FuZ3VsYXJEYW1waW5nID0gYmQuYW5ndWxhckRhbXBpbmc7XHJcbiAgICAgIHRoaXMubV9mb3JjZS5TZXQoMC4wLCAwLjApO1xyXG4gICAgICB0aGlzLm1fdG9ycXVlID0gMC4wO1xyXG4gICAgICB0aGlzLm1fc2xlZXBUaW1lID0gMC4wO1xyXG4gICAgICB0aGlzLm1fdHlwZSA9IGJkLnR5cGU7XHJcbiAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIHtcclxuICAgICAgICAgdGhpcy5tX21hc3MgPSAxLjA7XHJcbiAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMS4wO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fbWFzcyA9IDAuMDtcclxuICAgICAgICAgdGhpcy5tX2ludk1hc3MgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX0kgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9pbnZJID0gMC4wO1xyXG4gICAgICB0aGlzLm1faW5lcnRpYVNjYWxlID0gYmQuaW5lcnRpYVNjYWxlO1xyXG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBiZC51c2VyRGF0YTtcclxuICAgICAgdGhpcy5tX2ZpeHR1cmVMaXN0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2ZpeHR1cmVDb3VudCA9IDA7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TeW5jaHJvbml6ZUZpeHR1cmVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgeGYxID0gYjJCb2R5LnNfeGYxO1xyXG4gICAgICB4ZjEuUi5TZXQodGhpcy5tX3N3ZWVwLmEwKTtcclxuICAgICAgdmFyIHRNYXQgPSB4ZjEuUjtcclxuICAgICAgdmFyIHRWZWMgPSB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXI7XHJcbiAgICAgIHhmMS5wb3NpdGlvbi54ID0gdGhpcy5tX3N3ZWVwLmMwLnggLSAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHhmMS5wb3NpdGlvbi55ID0gdGhpcy5tX3N3ZWVwLmMwLnkgLSAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHZhciBmO1xyXG4gICAgICB2YXIgYnJvYWRQaGFzZSA9IHRoaXMubV93b3JsZC5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcclxuICAgICAgZm9yIChmID0gdGhpcy5tX2ZpeHR1cmVMaXN0O1xyXG4gICAgICBmOyBmID0gZi5tX25leHQpIHtcclxuICAgICAgICAgZi5TeW5jaHJvbml6ZShicm9hZFBoYXNlLCB4ZjEsIHRoaXMubV94Zik7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlN5bmNocm9uaXplVHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1feGYuUi5TZXQodGhpcy5tX3N3ZWVwLmEpO1xyXG4gICAgICB2YXIgdE1hdCA9IHRoaXMubV94Zi5SO1xyXG4gICAgICB2YXIgdFZlYyA9IHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcjtcclxuICAgICAgdGhpcy5tX3hmLnBvc2l0aW9uLnggPSB0aGlzLm1fc3dlZXAuYy54IC0gKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB0aGlzLm1feGYucG9zaXRpb24ueSA9IHRoaXMubV9zd2VlcC5jLnkgLSAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TaG91bGRDb2xsaWRlID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkgJiYgb3RoZXIubV90eXBlICE9IGIyQm9keS5iMl9keW5hbWljQm9keSkge1xyXG4gICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgZm9yICh2YXIgam4gPSB0aGlzLm1fam9pbnRMaXN0OyBqbjsgam4gPSBqbi5uZXh0KSB7XHJcbiAgICAgICAgIGlmIChqbi5vdGhlciA9PSBvdGhlcikgaWYgKGpuLmpvaW50Lm1fY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkFkdmFuY2UgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICBpZiAodCA9PT0gdW5kZWZpbmVkKSB0ID0gMDtcclxuICAgICAgdGhpcy5tX3N3ZWVwLkFkdmFuY2UodCk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLlNldFYodGhpcy5tX3N3ZWVwLmMwKTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmEgPSB0aGlzLm1fc3dlZXAuYTA7XHJcbiAgICAgIHRoaXMuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJCb2R5LnNfeGYxID0gbmV3IGIyVHJhbnNmb3JtKCk7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5lX2lzbGFuZEZsYWcgPSAweDAwMDE7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5lX2F3YWtlRmxhZyA9IDB4MDAwMjtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWcgPSAweDAwMDQ7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5lX2J1bGxldEZsYWcgPSAweDAwMDg7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnID0gMHgwMDEwO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuZV9hY3RpdmVGbGFnID0gMHgwMDIwO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuYjJfc3RhdGljQm9keSA9IDA7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5iMl9raW5lbWF0aWNCb2R5ID0gMTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJCb2R5LmIyX2R5bmFtaWNCb2R5ID0gMjtcclxuICAgfSk7XHJcbiAgIGIyQm9keURlZi5iMkJvZHlEZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubGluZWFyVmVsb2NpdHkgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyQm9keURlZi5wcm90b3R5cGUuYjJCb2R5RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnVzZXJEYXRhID0gbnVsbDtcclxuICAgICAgdGhpcy5wb3NpdGlvbi5TZXQoMC4wLCAwLjApO1xyXG4gICAgICB0aGlzLmFuZ2xlID0gMC4wO1xyXG4gICAgICB0aGlzLmxpbmVhclZlbG9jaXR5LlNldCgwLCAwKTtcclxuICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkgPSAwLjA7XHJcbiAgICAgIHRoaXMubGluZWFyRGFtcGluZyA9IDAuMDtcclxuICAgICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IDAuMDtcclxuICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdHJ1ZTtcclxuICAgICAgdGhpcy5hd2FrZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZml4ZWRSb3RhdGlvbiA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmJ1bGxldCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnR5cGUgPSBiMkJvZHkuYjJfc3RhdGljQm9keTtcclxuICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICB0aGlzLmluZXJ0aWFTY2FsZSA9IDEuMDtcclxuICAgfVxyXG4gICBiMkNvbnRhY3RGaWx0ZXIuYjJDb250YWN0RmlsdGVyID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyQ29udGFjdEZpbHRlci5wcm90b3R5cGUuU2hvdWxkQ29sbGlkZSA9IGZ1bmN0aW9uIChmaXh0dXJlQSwgZml4dHVyZUIpIHtcclxuICAgICAgdmFyIGZpbHRlcjEgPSBmaXh0dXJlQS5HZXRGaWx0ZXJEYXRhKCk7XHJcbiAgICAgIHZhciBmaWx0ZXIyID0gZml4dHVyZUIuR2V0RmlsdGVyRGF0YSgpO1xyXG4gICAgICBpZiAoZmlsdGVyMS5ncm91cEluZGV4ID09IGZpbHRlcjIuZ3JvdXBJbmRleCAmJiBmaWx0ZXIxLmdyb3VwSW5kZXggIT0gMCkge1xyXG4gICAgICAgICByZXR1cm4gZmlsdGVyMS5ncm91cEluZGV4ID4gMDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgY29sbGlkZSA9IChmaWx0ZXIxLm1hc2tCaXRzICYgZmlsdGVyMi5jYXRlZ29yeUJpdHMpICE9IDAgJiYgKGZpbHRlcjEuY2F0ZWdvcnlCaXRzICYgZmlsdGVyMi5tYXNrQml0cykgIT0gMDtcclxuICAgICAgcmV0dXJuIGNvbGxpZGU7XHJcbiAgIH1cclxuICAgYjJDb250YWN0RmlsdGVyLnByb3RvdHlwZS5SYXlDb2xsaWRlID0gZnVuY3Rpb24gKHVzZXJEYXRhLCBmaXh0dXJlKSB7XHJcbiAgICAgIGlmICghdXNlckRhdGEpIHJldHVybiB0cnVlO1xyXG4gICAgICByZXR1cm4gdGhpcy5TaG91bGRDb2xsaWRlKCh1c2VyRGF0YSBpbnN0YW5jZW9mIGIyRml4dHVyZSA/IHVzZXJEYXRhIDogbnVsbCksIGZpeHR1cmUpO1xyXG4gICB9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RGaWx0ZXIuYjJfZGVmYXVsdEZpbHRlciA9IG5ldyBiMkNvbnRhY3RGaWx0ZXIoKTtcclxuICAgfSk7XHJcbiAgIGIyQ29udGFjdEltcHVsc2UuYjJDb250YWN0SW1wdWxzZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5ub3JtYWxJbXB1bHNlcyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcihiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzKTtcclxuICAgICAgdGhpcy50YW5nZW50SW1wdWxzZXMgPSBuZXcgVmVjdG9yX2Eyal9OdW1iZXIoYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyk7XHJcbiAgIH07XHJcbiAgIGIyQ29udGFjdExpc3RlbmVyLmIyQ29udGFjdExpc3RlbmVyID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyQ29udGFjdExpc3RlbmVyLnByb3RvdHlwZS5CZWdpbkNvbnRhY3QgPSBmdW5jdGlvbiAoY29udGFjdCkge31cclxuICAgYjJDb250YWN0TGlzdGVuZXIucHJvdG90eXBlLkVuZENvbnRhY3QgPSBmdW5jdGlvbiAoY29udGFjdCkge31cclxuICAgYjJDb250YWN0TGlzdGVuZXIucHJvdG90eXBlLlByZVNvbHZlID0gZnVuY3Rpb24gKGNvbnRhY3QsIG9sZE1hbmlmb2xkKSB7fVxyXG4gICBiMkNvbnRhY3RMaXN0ZW5lci5wcm90b3R5cGUuUG9zdFNvbHZlID0gZnVuY3Rpb24gKGNvbnRhY3QsIGltcHVsc2UpIHt9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lci5iMl9kZWZhdWx0TGlzdGVuZXIgPSBuZXcgYjJDb250YWN0TGlzdGVuZXIoKTtcclxuICAgfSk7XHJcbiAgIGIyQ29udGFjdE1hbmFnZXIuYjJDb250YWN0TWFuYWdlciA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkNvbnRhY3RNYW5hZ2VyLnByb3RvdHlwZS5iMkNvbnRhY3RNYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fd29ybGQgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fY29udGFjdENvdW50ID0gMDtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RGaWx0ZXIgPSBiMkNvbnRhY3RGaWx0ZXIuYjJfZGVmYXVsdEZpbHRlcjtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RMaXN0ZW5lciA9IGIyQ29udGFjdExpc3RlbmVyLmIyX2RlZmF1bHRMaXN0ZW5lcjtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RGYWN0b3J5ID0gbmV3IGIyQ29udGFjdEZhY3RvcnkodGhpcy5tX2FsbG9jYXRvcik7XHJcbiAgICAgIHRoaXMubV9icm9hZFBoYXNlID0gbmV3IGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlKCk7XHJcbiAgIH1cclxuICAgYjJDb250YWN0TWFuYWdlci5wcm90b3R5cGUuQWRkUGFpciA9IGZ1bmN0aW9uIChwcm94eVVzZXJEYXRhQSwgcHJveHlVc2VyRGF0YUIpIHtcclxuICAgICAgdmFyIGZpeHR1cmVBID0gKHByb3h5VXNlckRhdGFBIGluc3RhbmNlb2YgYjJGaXh0dXJlID8gcHJveHlVc2VyRGF0YUEgOiBudWxsKTtcclxuICAgICAgdmFyIGZpeHR1cmVCID0gKHByb3h5VXNlckRhdGFCIGluc3RhbmNlb2YgYjJGaXh0dXJlID8gcHJveHlVc2VyRGF0YUIgOiBudWxsKTtcclxuICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEuR2V0Qm9keSgpO1xyXG4gICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5HZXRCb2R5KCk7XHJcbiAgICAgIGlmIChib2R5QSA9PSBib2R5QikgcmV0dXJuO1xyXG4gICAgICB2YXIgZWRnZSA9IGJvZHlCLkdldENvbnRhY3RMaXN0KCk7XHJcbiAgICAgIHdoaWxlIChlZGdlKSB7XHJcbiAgICAgICAgIGlmIChlZGdlLm90aGVyID09IGJvZHlBKSB7XHJcbiAgICAgICAgICAgIHZhciBmQSA9IGVkZ2UuY29udGFjdC5HZXRGaXh0dXJlQSgpO1xyXG4gICAgICAgICAgICB2YXIgZkIgPSBlZGdlLmNvbnRhY3QuR2V0Rml4dHVyZUIoKTtcclxuICAgICAgICAgICAgaWYgKGZBID09IGZpeHR1cmVBICYmIGZCID09IGZpeHR1cmVCKSByZXR1cm47XHJcbiAgICAgICAgICAgIGlmIChmQSA9PSBmaXh0dXJlQiAmJiBmQiA9PSBmaXh0dXJlQSkgcmV0dXJuO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVkZ2UgPSBlZGdlLm5leHQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGJvZHlCLlNob3VsZENvbGxpZGUoYm9keUEpID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2NvbnRhY3RGaWx0ZXIuU2hvdWxkQ29sbGlkZShmaXh0dXJlQSwgZml4dHVyZUIpID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgYyA9IHRoaXMubV9jb250YWN0RmFjdG9yeS5DcmVhdGUoZml4dHVyZUEsIGZpeHR1cmVCKTtcclxuICAgICAgZml4dHVyZUEgPSBjLkdldEZpeHR1cmVBKCk7XHJcbiAgICAgIGZpeHR1cmVCID0gYy5HZXRGaXh0dXJlQigpO1xyXG4gICAgICBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcclxuICAgICAgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XHJcbiAgICAgIGMubV9wcmV2ID0gbnVsbDtcclxuICAgICAgYy5tX25leHQgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TGlzdDtcclxuICAgICAgaWYgKHRoaXMubV93b3JsZC5tX2NvbnRhY3RMaXN0ICE9IG51bGwpIHtcclxuICAgICAgICAgdGhpcy5tX3dvcmxkLm1fY29udGFjdExpc3QubV9wcmV2ID0gYztcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fd29ybGQubV9jb250YWN0TGlzdCA9IGM7XHJcbiAgICAgIGMubV9ub2RlQS5jb250YWN0ID0gYztcclxuICAgICAgYy5tX25vZGVBLm90aGVyID0gYm9keUI7XHJcbiAgICAgIGMubV9ub2RlQS5wcmV2ID0gbnVsbDtcclxuICAgICAgYy5tX25vZGVBLm5leHQgPSBib2R5QS5tX2NvbnRhY3RMaXN0O1xyXG4gICAgICBpZiAoYm9keUEubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XHJcbiAgICAgICAgIGJvZHlBLm1fY29udGFjdExpc3QucHJldiA9IGMubV9ub2RlQTtcclxuICAgICAgfVxyXG4gICAgICBib2R5QS5tX2NvbnRhY3RMaXN0ID0gYy5tX25vZGVBO1xyXG4gICAgICBjLm1fbm9kZUIuY29udGFjdCA9IGM7XHJcbiAgICAgIGMubV9ub2RlQi5vdGhlciA9IGJvZHlBO1xyXG4gICAgICBjLm1fbm9kZUIucHJldiA9IG51bGw7XHJcbiAgICAgIGMubV9ub2RlQi5uZXh0ID0gYm9keUIubV9jb250YWN0TGlzdDtcclxuICAgICAgaWYgKGJvZHlCLm1fY29udGFjdExpc3QgIT0gbnVsbCkge1xyXG4gICAgICAgICBib2R5Qi5tX2NvbnRhY3RMaXN0LnByZXYgPSBjLm1fbm9kZUI7XHJcbiAgICAgIH1cclxuICAgICAgYm9keUIubV9jb250YWN0TGlzdCA9IGMubV9ub2RlQjtcclxuICAgICAgKyt0aGlzLm1fd29ybGQubV9jb250YWN0Q291bnQ7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICBiMkNvbnRhY3RNYW5hZ2VyLnByb3RvdHlwZS5GaW5kTmV3Q29udGFjdHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9icm9hZFBoYXNlLlVwZGF0ZVBhaXJzKEJveDJELmdlbmVyYXRlQ2FsbGJhY2sodGhpcywgdGhpcy5BZGRQYWlyKSk7XHJcbiAgIH1cclxuICAgYjJDb250YWN0TWFuYWdlci5wcm90b3R5cGUuRGVzdHJveSA9IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgIHZhciBmaXh0dXJlQSA9IGMuR2V0Rml4dHVyZUEoKTtcclxuICAgICAgdmFyIGZpeHR1cmVCID0gYy5HZXRGaXh0dXJlQigpO1xyXG4gICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5HZXRCb2R5KCk7XHJcbiAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLkdldEJvZHkoKTtcclxuICAgICAgaWYgKGMuSXNUb3VjaGluZygpKSB7XHJcbiAgICAgICAgIHRoaXMubV9jb250YWN0TGlzdGVuZXIuRW5kQ29udGFjdChjKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYy5tX3ByZXYpIHtcclxuICAgICAgICAgYy5tX3ByZXYubV9uZXh0ID0gYy5tX25leHQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGMubV9uZXh0KSB7XHJcbiAgICAgICAgIGMubV9uZXh0Lm1fcHJldiA9IGMubV9wcmV2O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChjID09IHRoaXMubV93b3JsZC5tX2NvbnRhY3RMaXN0KSB7XHJcbiAgICAgICAgIHRoaXMubV93b3JsZC5tX2NvbnRhY3RMaXN0ID0gYy5tX25leHQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGMubV9ub2RlQS5wcmV2KSB7XHJcbiAgICAgICAgIGMubV9ub2RlQS5wcmV2Lm5leHQgPSBjLm1fbm9kZUEubmV4dDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYy5tX25vZGVBLm5leHQpIHtcclxuICAgICAgICAgYy5tX25vZGVBLm5leHQucHJldiA9IGMubV9ub2RlQS5wcmV2O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChjLm1fbm9kZUEgPT0gYm9keUEubV9jb250YWN0TGlzdCkge1xyXG4gICAgICAgICBib2R5QS5tX2NvbnRhY3RMaXN0ID0gYy5tX25vZGVBLm5leHQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGMubV9ub2RlQi5wcmV2KSB7XHJcbiAgICAgICAgIGMubV9ub2RlQi5wcmV2Lm5leHQgPSBjLm1fbm9kZUIubmV4dDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYy5tX25vZGVCLm5leHQpIHtcclxuICAgICAgICAgYy5tX25vZGVCLm5leHQucHJldiA9IGMubV9ub2RlQi5wcmV2O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChjLm1fbm9kZUIgPT0gYm9keUIubV9jb250YWN0TGlzdCkge1xyXG4gICAgICAgICBib2R5Qi5tX2NvbnRhY3RMaXN0ID0gYy5tX25vZGVCLm5leHQ7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2NvbnRhY3RGYWN0b3J5LkRlc3Ryb3koYyk7XHJcbiAgICAgIC0tdGhpcy5tX2NvbnRhY3RDb3VudDtcclxuICAgfVxyXG4gICBiMkNvbnRhY3RNYW5hZ2VyLnByb3RvdHlwZS5Db2xsaWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgYyA9IHRoaXMubV93b3JsZC5tX2NvbnRhY3RMaXN0O1xyXG4gICAgICB3aGlsZSAoYykge1xyXG4gICAgICAgICB2YXIgZml4dHVyZUEgPSBjLkdldEZpeHR1cmVBKCk7XHJcbiAgICAgICAgIHZhciBmaXh0dXJlQiA9IGMuR2V0Rml4dHVyZUIoKTtcclxuICAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEuR2V0Qm9keSgpO1xyXG4gICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5HZXRCb2R5KCk7XHJcbiAgICAgICAgIGlmIChib2R5QS5Jc0F3YWtlKCkgPT0gZmFsc2UgJiYgYm9keUIuSXNBd2FrZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGMgPSBjLkdldE5leHQoKTtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKGMubV9mbGFncyAmIGIyQ29udGFjdC5lX2ZpbHRlckZsYWcpIHtcclxuICAgICAgICAgICAgaWYgKGJvZHlCLlNob3VsZENvbGxpZGUoYm9keUEpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgIHZhciBjTnVrZSA9IGM7XHJcbiAgICAgICAgICAgICAgIGMgPSBjTnVrZS5HZXROZXh0KCk7XHJcbiAgICAgICAgICAgICAgIHRoaXMuRGVzdHJveShjTnVrZSk7XHJcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1fY29udGFjdEZpbHRlci5TaG91bGRDb2xsaWRlKGZpeHR1cmVBLCBmaXh0dXJlQikgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgY051a2UgPSBjO1xyXG4gICAgICAgICAgICAgICBjID0gY051a2UuR2V0TmV4dCgpO1xyXG4gICAgICAgICAgICAgICB0aGlzLkRlc3Ryb3koY051a2UpO1xyXG4gICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjLm1fZmxhZ3MgJj0gfmIyQ29udGFjdC5lX2ZpbHRlckZsYWc7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIHByb3h5QSA9IGZpeHR1cmVBLm1fcHJveHk7XHJcbiAgICAgICAgIHZhciBwcm94eUIgPSBmaXh0dXJlQi5tX3Byb3h5O1xyXG4gICAgICAgICB2YXIgb3ZlcmxhcCA9IHRoaXMubV9icm9hZFBoYXNlLlRlc3RPdmVybGFwKHByb3h5QSwgcHJveHlCKTtcclxuICAgICAgICAgaWYgKG92ZXJsYXAgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY051a2UgPSBjO1xyXG4gICAgICAgICAgICBjID0gY051a2UuR2V0TmV4dCgpO1xyXG4gICAgICAgICAgICB0aGlzLkRlc3Ryb3koY051a2UpO1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBjLlVwZGF0ZSh0aGlzLm1fY29udGFjdExpc3RlbmVyKTtcclxuICAgICAgICAgYyA9IGMuR2V0TmV4dCgpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQ29udGFjdE1hbmFnZXIuc19ldmFsQ1AgPSBuZXcgYjJDb250YWN0UG9pbnQoKTtcclxuICAgfSk7XHJcbiAgIGIyRGVidWdEcmF3LmIyRGVidWdEcmF3ID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5iMkRlYnVnRHJhdyA9IGZ1bmN0aW9uICgpIHt9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRGbGFncyA9IGZ1bmN0aW9uIChmbGFncykge1xyXG4gICAgICBpZiAoZmxhZ3MgPT09IHVuZGVmaW5lZCkgZmxhZ3MgPSAwO1xyXG4gICB9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRGbGFncyA9IGZ1bmN0aW9uICgpIHt9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5BcHBlbmRGbGFncyA9IGZ1bmN0aW9uIChmbGFncykge1xyXG4gICAgICBpZiAoZmxhZ3MgPT09IHVuZGVmaW5lZCkgZmxhZ3MgPSAwO1xyXG4gICB9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5DbGVhckZsYWdzID0gZnVuY3Rpb24gKGZsYWdzKSB7XHJcbiAgICAgIGlmIChmbGFncyA9PT0gdW5kZWZpbmVkKSBmbGFncyA9IDA7XHJcbiAgIH1cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldFNwcml0ZSA9IGZ1bmN0aW9uIChzcHJpdGUpIHt9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRTcHJpdGUgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0RHJhd1NjYWxlID0gZnVuY3Rpb24gKGRyYXdTY2FsZSkge1xyXG4gICAgICBpZiAoZHJhd1NjYWxlID09PSB1bmRlZmluZWQpIGRyYXdTY2FsZSA9IDA7XHJcbiAgIH1cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldERyYXdTY2FsZSA9IGZ1bmN0aW9uICgpIHt9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRMaW5lVGhpY2tuZXNzID0gZnVuY3Rpb24gKGxpbmVUaGlja25lc3MpIHtcclxuICAgICAgaWYgKGxpbmVUaGlja25lc3MgPT09IHVuZGVmaW5lZCkgbGluZVRoaWNrbmVzcyA9IDA7XHJcbiAgIH1cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldExpbmVUaGlja25lc3MgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0QWxwaGEgPSBmdW5jdGlvbiAoYWxwaGEpIHtcclxuICAgICAgaWYgKGFscGhhID09PSB1bmRlZmluZWQpIGFscGhhID0gMDtcclxuICAgfVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0QWxwaGEgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0RmlsbEFscGhhID0gZnVuY3Rpb24gKGFscGhhKSB7XHJcbiAgICAgIGlmIChhbHBoYSA9PT0gdW5kZWZpbmVkKSBhbHBoYSA9IDA7XHJcbiAgIH1cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldEZpbGxBbHBoYSA9IGZ1bmN0aW9uICgpIHt9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRYRm9ybVNjYWxlID0gZnVuY3Rpb24gKHhmb3JtU2NhbGUpIHtcclxuICAgICAgaWYgKHhmb3JtU2NhbGUgPT09IHVuZGVmaW5lZCkgeGZvcm1TY2FsZSA9IDA7XHJcbiAgIH1cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldFhGb3JtU2NhbGUgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1BvbHlnb24gPSBmdW5jdGlvbiAodmVydGljZXMsIHZlcnRleENvdW50LCBjb2xvcikge1xyXG4gICAgICBpZiAodmVydGV4Q291bnQgPT09IHVuZGVmaW5lZCkgdmVydGV4Q291bnQgPSAwO1xyXG4gICB9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3U29saWRQb2x5Z29uID0gZnVuY3Rpb24gKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCwgY29sb3IpIHtcclxuICAgICAgaWYgKHZlcnRleENvdW50ID09PSB1bmRlZmluZWQpIHZlcnRleENvdW50ID0gMDtcclxuICAgfVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd0NpcmNsZSA9IGZ1bmN0aW9uIChjZW50ZXIsIHJhZGl1cywgY29sb3IpIHtcclxuICAgICAgaWYgKHJhZGl1cyA9PT0gdW5kZWZpbmVkKSByYWRpdXMgPSAwO1xyXG4gICB9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3U29saWRDaXJjbGUgPSBmdW5jdGlvbiAoY2VudGVyLCByYWRpdXMsIGF4aXMsIGNvbG9yKSB7XHJcbiAgICAgIGlmIChyYWRpdXMgPT09IHVuZGVmaW5lZCkgcmFkaXVzID0gMDtcclxuICAgfVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1NlZ21lbnQgPSBmdW5jdGlvbiAocDEsIHAyLCBjb2xvcikge31cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoeGYpIHt9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdy5lX3NoYXBlQml0ID0gMHgwMDAxO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdy5lX2pvaW50Qml0ID0gMHgwMDAyO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdy5lX2FhYmJCaXQgPSAweDAwMDQ7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LmVfcGFpckJpdCA9IDB4MDAwODtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXcuZV9jZW50ZXJPZk1hc3NCaXQgPSAweDAwMTA7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LmVfY29udHJvbGxlckJpdCA9IDB4MDAyMDtcclxuICAgfSk7XHJcbiAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lci5iMkRlc3RydWN0aW9uTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJEZXN0cnVjdGlvbkxpc3RlbmVyLnByb3RvdHlwZS5TYXlHb29kYnllSm9pbnQgPSBmdW5jdGlvbiAoam9pbnQpIHt9XHJcbiAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lci5wcm90b3R5cGUuU2F5R29vZGJ5ZUZpeHR1cmUgPSBmdW5jdGlvbiAoZml4dHVyZSkge31cclxuICAgYjJGaWx0ZXJEYXRhLmIyRmlsdGVyRGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jYXRlZ29yeUJpdHMgPSAweDAwMDE7XHJcbiAgICAgIHRoaXMubWFza0JpdHMgPSAweEZGRkY7XHJcbiAgICAgIHRoaXMuZ3JvdXBJbmRleCA9IDA7XHJcbiAgIH07XHJcbiAgIGIyRmlsdGVyRGF0YS5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGNvcHkgPSBuZXcgYjJGaWx0ZXJEYXRhKCk7XHJcbiAgICAgIGNvcHkuY2F0ZWdvcnlCaXRzID0gdGhpcy5jYXRlZ29yeUJpdHM7XHJcbiAgICAgIGNvcHkubWFza0JpdHMgPSB0aGlzLm1hc2tCaXRzO1xyXG4gICAgICBjb3B5Lmdyb3VwSW5kZXggPSB0aGlzLmdyb3VwSW5kZXg7XHJcbiAgICAgIHJldHVybiBjb3B5O1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5iMkZpeHR1cmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9maWx0ZXIgPSBuZXcgYjJGaWx0ZXJEYXRhKCk7XHJcbiAgIH07XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZS5HZXRUeXBlKCk7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXRTaGFwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZTtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLlNldFNlbnNvciA9IGZ1bmN0aW9uIChzZW5zb3IpIHtcclxuICAgICAgaWYgKHRoaXMubV9pc1NlbnNvciA9PSBzZW5zb3IpIHJldHVybjtcclxuICAgICAgdGhpcy5tX2lzU2Vuc29yID0gc2Vuc29yO1xyXG4gICAgICBpZiAodGhpcy5tX2JvZHkgPT0gbnVsbCkgcmV0dXJuO1xyXG4gICAgICB2YXIgZWRnZSA9IHRoaXMubV9ib2R5LkdldENvbnRhY3RMaXN0KCk7XHJcbiAgICAgIHdoaWxlIChlZGdlKSB7XHJcbiAgICAgICAgIHZhciBjb250YWN0ID0gZWRnZS5jb250YWN0O1xyXG4gICAgICAgICB2YXIgZml4dHVyZUEgPSBjb250YWN0LkdldEZpeHR1cmVBKCk7XHJcbiAgICAgICAgIHZhciBmaXh0dXJlQiA9IGNvbnRhY3QuR2V0Rml4dHVyZUIoKTtcclxuICAgICAgICAgaWYgKGZpeHR1cmVBID09IHRoaXMgfHwgZml4dHVyZUIgPT0gdGhpcykgY29udGFjdC5TZXRTZW5zb3IoZml4dHVyZUEuSXNTZW5zb3IoKSB8fCBmaXh0dXJlQi5Jc1NlbnNvcigpKTtcclxuICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuSXNTZW5zb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1faXNTZW5zb3I7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5TZXRGaWx0ZXJEYXRhID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICB0aGlzLm1fZmlsdGVyID0gZmlsdGVyLkNvcHkoKTtcclxuICAgICAgaWYgKHRoaXMubV9ib2R5KSByZXR1cm47XHJcbiAgICAgIHZhciBlZGdlID0gdGhpcy5tX2JvZHkuR2V0Q29udGFjdExpc3QoKTtcclxuICAgICAgd2hpbGUgKGVkZ2UpIHtcclxuICAgICAgICAgdmFyIGNvbnRhY3QgPSBlZGdlLmNvbnRhY3Q7XHJcbiAgICAgICAgIHZhciBmaXh0dXJlQSA9IGNvbnRhY3QuR2V0Rml4dHVyZUEoKTtcclxuICAgICAgICAgdmFyIGZpeHR1cmVCID0gY29udGFjdC5HZXRGaXh0dXJlQigpO1xyXG4gICAgICAgICBpZiAoZml4dHVyZUEgPT0gdGhpcyB8fCBmaXh0dXJlQiA9PSB0aGlzKSBjb250YWN0LkZsYWdGb3JGaWx0ZXJpbmcoKTtcclxuICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0RmlsdGVyRGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9maWx0ZXIuQ29weSgpO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0Qm9keSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5O1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0TmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0VXNlckRhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdXNlckRhdGE7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5TZXRVc2VyRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRhdGE7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5UZXN0UG9pbnQgPSBmdW5jdGlvbiAocCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3NoYXBlLlRlc3RQb2ludCh0aGlzLm1fYm9keS5HZXRUcmFuc2Zvcm0oKSwgcCk7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5SYXlDYXN0ID0gZnVuY3Rpb24gKG91dHB1dCwgaW5wdXQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZS5SYXlDYXN0KG91dHB1dCwgaW5wdXQsIHRoaXMubV9ib2R5LkdldFRyYW5zZm9ybSgpKTtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldE1hc3NEYXRhID0gZnVuY3Rpb24gKG1hc3NEYXRhKSB7XHJcbiAgICAgIGlmIChtYXNzRGF0YSA9PT0gdW5kZWZpbmVkKSBtYXNzRGF0YSA9IG51bGw7XHJcbiAgICAgIGlmIChtYXNzRGF0YSA9PSBudWxsKSB7XHJcbiAgICAgICAgIG1hc3NEYXRhID0gbmV3IGIyTWFzc0RhdGEoKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fc2hhcGUuQ29tcHV0ZU1hc3MobWFzc0RhdGEsIHRoaXMubV9kZW5zaXR5KTtcclxuICAgICAgcmV0dXJuIG1hc3NEYXRhO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuU2V0RGVuc2l0eSA9IGZ1bmN0aW9uIChkZW5zaXR5KSB7XHJcbiAgICAgIGlmIChkZW5zaXR5ID09PSB1bmRlZmluZWQpIGRlbnNpdHkgPSAwO1xyXG4gICAgICB0aGlzLm1fZGVuc2l0eSA9IGRlbnNpdHk7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXREZW5zaXR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2RlbnNpdHk7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXRGcmljdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9mcmljdGlvbjtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLlNldEZyaWN0aW9uID0gZnVuY3Rpb24gKGZyaWN0aW9uKSB7XHJcbiAgICAgIGlmIChmcmljdGlvbiA9PT0gdW5kZWZpbmVkKSBmcmljdGlvbiA9IDA7XHJcbiAgICAgIHRoaXMubV9mcmljdGlvbiA9IGZyaWN0aW9uO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0UmVzdGl0dXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fcmVzdGl0dXRpb247XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5TZXRSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uIChyZXN0aXR1dGlvbikge1xyXG4gICAgICBpZiAocmVzdGl0dXRpb24gPT09IHVuZGVmaW5lZCkgcmVzdGl0dXRpb24gPSAwO1xyXG4gICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSByZXN0aXR1dGlvbjtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldEFBQkIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYWFiYjtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLmIyRml4dHVyZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX2FhYmIgPSBuZXcgYjJBQUJCKCk7XHJcbiAgICAgIHRoaXMubV91c2VyRGF0YSA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ib2R5ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fc2hhcGUgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fZGVuc2l0eSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2ZyaWN0aW9uID0gMC4wO1xyXG4gICAgICB0aGlzLm1fcmVzdGl0dXRpb24gPSAwLjA7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5DcmVhdGUgPSBmdW5jdGlvbiAoYm9keSwgeGYsIGRlZikge1xyXG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBkZWYudXNlckRhdGE7XHJcbiAgICAgIHRoaXMubV9mcmljdGlvbiA9IGRlZi5mcmljdGlvbjtcclxuICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gZGVmLnJlc3RpdHV0aW9uO1xyXG4gICAgICB0aGlzLm1fYm9keSA9IGJvZHk7XHJcbiAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2ZpbHRlciA9IGRlZi5maWx0ZXIuQ29weSgpO1xyXG4gICAgICB0aGlzLm1faXNTZW5zb3IgPSBkZWYuaXNTZW5zb3I7XHJcbiAgICAgIHRoaXMubV9zaGFwZSA9IGRlZi5zaGFwZS5Db3B5KCk7XHJcbiAgICAgIHRoaXMubV9kZW5zaXR5ID0gZGVmLmRlbnNpdHk7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5EZXN0cm95ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fc2hhcGUgPSBudWxsO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuQ3JlYXRlUHJveHkgPSBmdW5jdGlvbiAoYnJvYWRQaGFzZSwgeGYpIHtcclxuICAgICAgdGhpcy5tX3NoYXBlLkNvbXB1dGVBQUJCKHRoaXMubV9hYWJiLCB4Zik7XHJcbiAgICAgIHRoaXMubV9wcm94eSA9IGJyb2FkUGhhc2UuQ3JlYXRlUHJveHkodGhpcy5tX2FhYmIsIHRoaXMpO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuRGVzdHJveVByb3h5ID0gZnVuY3Rpb24gKGJyb2FkUGhhc2UpIHtcclxuICAgICAgaWYgKHRoaXMubV9wcm94eSA9PSBudWxsKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBicm9hZFBoYXNlLkRlc3Ryb3lQcm94eSh0aGlzLm1fcHJveHkpO1xyXG4gICAgICB0aGlzLm1fcHJveHkgPSBudWxsO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuU3luY2hyb25pemUgPSBmdW5jdGlvbiAoYnJvYWRQaGFzZSwgdHJhbnNmb3JtMSwgdHJhbnNmb3JtMikge1xyXG4gICAgICBpZiAoIXRoaXMubV9wcm94eSkgcmV0dXJuO1xyXG4gICAgICB2YXIgYWFiYjEgPSBuZXcgYjJBQUJCKCk7XHJcbiAgICAgIHZhciBhYWJiMiA9IG5ldyBiMkFBQkIoKTtcclxuICAgICAgdGhpcy5tX3NoYXBlLkNvbXB1dGVBQUJCKGFhYmIxLCB0cmFuc2Zvcm0xKTtcclxuICAgICAgdGhpcy5tX3NoYXBlLkNvbXB1dGVBQUJCKGFhYmIyLCB0cmFuc2Zvcm0yKTtcclxuICAgICAgdGhpcy5tX2FhYmIuQ29tYmluZShhYWJiMSwgYWFiYjIpO1xyXG4gICAgICB2YXIgZGlzcGxhY2VtZW50ID0gYjJNYXRoLlN1YnRyYWN0VlYodHJhbnNmb3JtMi5wb3NpdGlvbiwgdHJhbnNmb3JtMS5wb3NpdGlvbik7XHJcbiAgICAgIGJyb2FkUGhhc2UuTW92ZVByb3h5KHRoaXMubV9wcm94eSwgdGhpcy5tX2FhYmIsIGRpc3BsYWNlbWVudCk7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlRGVmLmIyRml4dHVyZURlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5maWx0ZXIgPSBuZXcgYjJGaWx0ZXJEYXRhKCk7XHJcbiAgIH07XHJcbiAgIGIyRml4dHVyZURlZi5wcm90b3R5cGUuYjJGaXh0dXJlRGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnNoYXBlID0gbnVsbDtcclxuICAgICAgdGhpcy51c2VyRGF0YSA9IG51bGw7XHJcbiAgICAgIHRoaXMuZnJpY3Rpb24gPSAwLjI7XHJcbiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSAwLjA7XHJcbiAgICAgIHRoaXMuZGVuc2l0eSA9IDAuMDtcclxuICAgICAgdGhpcy5maWx0ZXIuY2F0ZWdvcnlCaXRzID0gMHgwMDAxO1xyXG4gICAgICB0aGlzLmZpbHRlci5tYXNrQml0cyA9IDB4RkZGRjtcclxuICAgICAgdGhpcy5maWx0ZXIuZ3JvdXBJbmRleCA9IDA7XHJcbiAgICAgIHRoaXMuaXNTZW5zb3IgPSBmYWxzZTtcclxuICAgfVxyXG4gICBiMklzbGFuZC5iMklzbGFuZCA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMklzbGFuZC5wcm90b3R5cGUuYjJJc2xhbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9ib2RpZXMgPSBuZXcgVmVjdG9yKCk7XHJcbiAgICAgIHRoaXMubV9jb250YWN0cyA9IG5ldyBWZWN0b3IoKTtcclxuICAgICAgdGhpcy5tX2pvaW50cyA9IG5ldyBWZWN0b3IoKTtcclxuICAgfVxyXG4gICBiMklzbGFuZC5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChib2R5Q2FwYWNpdHksIGNvbnRhY3RDYXBhY2l0eSwgam9pbnRDYXBhY2l0eSwgYWxsb2NhdG9yLCBsaXN0ZW5lciwgY29udGFjdFNvbHZlcikge1xyXG4gICAgICBpZiAoYm9keUNhcGFjaXR5ID09PSB1bmRlZmluZWQpIGJvZHlDYXBhY2l0eSA9IDA7XHJcbiAgICAgIGlmIChjb250YWN0Q2FwYWNpdHkgPT09IHVuZGVmaW5lZCkgY29udGFjdENhcGFjaXR5ID0gMDtcclxuICAgICAgaWYgKGpvaW50Q2FwYWNpdHkgPT09IHVuZGVmaW5lZCkgam9pbnRDYXBhY2l0eSA9IDA7XHJcbiAgICAgIHZhciBpID0gMDtcclxuICAgICAgdGhpcy5tX2JvZHlDYXBhY2l0eSA9IGJvZHlDYXBhY2l0eTtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RDYXBhY2l0eSA9IGNvbnRhY3RDYXBhY2l0eTtcclxuICAgICAgdGhpcy5tX2pvaW50Q2FwYWNpdHkgPSBqb2ludENhcGFjaXR5O1xyXG4gICAgICB0aGlzLm1fYm9keUNvdW50ID0gMDtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9qb2ludENvdW50ID0gMDtcclxuICAgICAgdGhpcy5tX2FsbG9jYXRvciA9IGFsbG9jYXRvcjtcclxuICAgICAgdGhpcy5tX2xpc3RlbmVyID0gbGlzdGVuZXI7XHJcbiAgICAgIHRoaXMubV9jb250YWN0U29sdmVyID0gY29udGFjdFNvbHZlcjtcclxuICAgICAgZm9yIChpID0gdGhpcy5tX2JvZGllcy5sZW5ndGg7XHJcbiAgICAgIGkgPCBib2R5Q2FwYWNpdHk7IGkrKylcclxuICAgICAgdGhpcy5tX2JvZGllc1tpXSA9IG51bGw7XHJcbiAgICAgIGZvciAoaSA9IHRoaXMubV9jb250YWN0cy5sZW5ndGg7XHJcbiAgICAgIGkgPCBjb250YWN0Q2FwYWNpdHk7IGkrKylcclxuICAgICAgdGhpcy5tX2NvbnRhY3RzW2ldID0gbnVsbDtcclxuICAgICAgZm9yIChpID0gdGhpcy5tX2pvaW50cy5sZW5ndGg7XHJcbiAgICAgIGkgPCBqb2ludENhcGFjaXR5OyBpKyspXHJcbiAgICAgIHRoaXMubV9qb2ludHNbaV0gPSBudWxsO1xyXG4gICB9XHJcbiAgIGIySXNsYW5kLnByb3RvdHlwZS5DbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX2JvZHlDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9jb250YWN0Q291bnQgPSAwO1xyXG4gICAgICB0aGlzLm1fam9pbnRDb3VudCA9IDA7XHJcbiAgIH1cclxuICAgYjJJc2xhbmQucHJvdG90eXBlLlNvbHZlID0gZnVuY3Rpb24gKHN0ZXAsIGdyYXZpdHksIGFsbG93U2xlZXApIHtcclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICB2YXIgaiA9IDA7XHJcbiAgICAgIHZhciBiO1xyXG4gICAgICB2YXIgam9pbnQ7XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCB0aGlzLm1fYm9keUNvdW50OyArK2kpIHtcclxuICAgICAgICAgYiA9IHRoaXMubV9ib2RpZXNbaV07XHJcbiAgICAgICAgIGlmIChiLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIGNvbnRpbnVlO1xyXG4gICAgICAgICBiLm1fbGluZWFyVmVsb2NpdHkueCArPSBzdGVwLmR0ICogKGdyYXZpdHkueCArIGIubV9pbnZNYXNzICogYi5tX2ZvcmNlLngpO1xyXG4gICAgICAgICBiLm1fbGluZWFyVmVsb2NpdHkueSArPSBzdGVwLmR0ICogKGdyYXZpdHkueSArIGIubV9pbnZNYXNzICogYi5tX2ZvcmNlLnkpO1xyXG4gICAgICAgICBiLm1fYW5ndWxhclZlbG9jaXR5ICs9IHN0ZXAuZHQgKiBiLm1faW52SSAqIGIubV90b3JxdWU7XHJcbiAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS5NdWx0aXBseShiMk1hdGguQ2xhbXAoMS4wIC0gc3RlcC5kdCAqIGIubV9saW5lYXJEYW1waW5nLCAwLjAsIDEuMCkpO1xyXG4gICAgICAgICBiLm1fYW5ndWxhclZlbG9jaXR5ICo9IGIyTWF0aC5DbGFtcCgxLjAgLSBzdGVwLmR0ICogYi5tX2FuZ3VsYXJEYW1waW5nLCAwLjAsIDEuMCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2NvbnRhY3RTb2x2ZXIuSW5pdGlhbGl6ZShzdGVwLCB0aGlzLm1fY29udGFjdHMsIHRoaXMubV9jb250YWN0Q291bnQsIHRoaXMubV9hbGxvY2F0b3IpO1xyXG4gICAgICB2YXIgY29udGFjdFNvbHZlciA9IHRoaXMubV9jb250YWN0U29sdmVyO1xyXG4gICAgICBjb250YWN0U29sdmVyLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzKHN0ZXApO1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraSkge1xyXG4gICAgICAgICBqb2ludCA9IHRoaXMubV9qb2ludHNbaV07XHJcbiAgICAgICAgIGpvaW50LkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzKHN0ZXApO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCBzdGVwLnZlbG9jaXR5SXRlcmF0aW9uczsgKytpKSB7XHJcbiAgICAgICAgIGZvciAoaiA9IDA7XHJcbiAgICAgICAgIGogPCB0aGlzLm1fam9pbnRDb3VudDsgKytqKSB7XHJcbiAgICAgICAgICAgIGpvaW50ID0gdGhpcy5tX2pvaW50c1tqXTtcclxuICAgICAgICAgICAgam9pbnQuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzKHN0ZXApO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGNvbnRhY3RTb2x2ZXIuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzKCk7XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHRoaXMubV9qb2ludENvdW50OyArK2kpIHtcclxuICAgICAgICAgam9pbnQgPSB0aGlzLm1fam9pbnRzW2ldO1xyXG4gICAgICAgICBqb2ludC5GaW5hbGl6ZVZlbG9jaXR5Q29uc3RyYWludHMoKTtcclxuICAgICAgfVxyXG4gICAgICBjb250YWN0U29sdmVyLkZpbmFsaXplVmVsb2NpdHlDb25zdHJhaW50cygpO1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgdGhpcy5tX2JvZHlDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIGIgPSB0aGlzLm1fYm9kaWVzW2ldO1xyXG4gICAgICAgICBpZiAoYi5HZXRUeXBlKCkgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIGNvbnRpbnVlO1xyXG4gICAgICAgICB2YXIgdHJhbnNsYXRpb25YID0gc3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS54O1xyXG4gICAgICAgICB2YXIgdHJhbnNsYXRpb25ZID0gc3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS55O1xyXG4gICAgICAgICBpZiAoKHRyYW5zbGF0aW9uWCAqIHRyYW5zbGF0aW9uWCArIHRyYW5zbGF0aW9uWSAqIHRyYW5zbGF0aW9uWSkgPiBiMlNldHRpbmdzLmIyX21heFRyYW5zbGF0aW9uU3F1YXJlZCkge1xyXG4gICAgICAgICAgICBiLm1fbGluZWFyVmVsb2NpdHkuTm9ybWFsaXplKCk7XHJcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS54ICo9IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gKiBzdGVwLmludl9kdDtcclxuICAgICAgICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnkgKj0gYjJTZXR0aW5ncy5iMl9tYXhUcmFuc2xhdGlvbiAqIHN0ZXAuaW52X2R0O1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciByb3RhdGlvbiA9IHN0ZXAuZHQgKiBiLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICAgICBpZiAocm90YXRpb24gKiByb3RhdGlvbiA+IGIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb25TcXVhcmVkKSB7XHJcbiAgICAgICAgICAgIGlmIChiLm1fYW5ndWxhclZlbG9jaXR5IDwgMC4wKSB7XHJcbiAgICAgICAgICAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgPSAoLWIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb24gKiBzdGVwLmludl9kdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgPSBiMlNldHRpbmdzLmIyX21heFJvdGF0aW9uICogc3RlcC5pbnZfZHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBiLm1fc3dlZXAuYzAuU2V0VihiLm1fc3dlZXAuYyk7XHJcbiAgICAgICAgIGIubV9zd2VlcC5hMCA9IGIubV9zd2VlcC5hO1xyXG4gICAgICAgICBiLm1fc3dlZXAuYy54ICs9IHN0ZXAuZHQgKiBiLm1fbGluZWFyVmVsb2NpdHkueDtcclxuICAgICAgICAgYi5tX3N3ZWVwLmMueSArPSBzdGVwLmR0ICogYi5tX2xpbmVhclZlbG9jaXR5Lnk7XHJcbiAgICAgICAgIGIubV9zd2VlcC5hICs9IHN0ZXAuZHQgKiBiLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICAgICBiLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHN0ZXAucG9zaXRpb25JdGVyYXRpb25zOyArK2kpIHtcclxuICAgICAgICAgdmFyIGNvbnRhY3RzT2theSA9IGNvbnRhY3RTb2x2ZXIuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzKGIyU2V0dGluZ3MuYjJfY29udGFjdEJhdW1nYXJ0ZSk7XHJcbiAgICAgICAgIHZhciBqb2ludHNPa2F5ID0gdHJ1ZTtcclxuICAgICAgICAgZm9yIChqID0gMDtcclxuICAgICAgICAgaiA8IHRoaXMubV9qb2ludENvdW50OyArK2opIHtcclxuICAgICAgICAgICAgam9pbnQgPSB0aGlzLm1fam9pbnRzW2pdO1xyXG4gICAgICAgICAgICB2YXIgam9pbnRPa2F5ID0gam9pbnQuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzKGIyU2V0dGluZ3MuYjJfY29udGFjdEJhdW1nYXJ0ZSk7XHJcbiAgICAgICAgICAgIGpvaW50c09rYXkgPSBqb2ludHNPa2F5ICYmIGpvaW50T2theTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAoY29udGFjdHNPa2F5ICYmIGpvaW50c09rYXkpIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLlJlcG9ydChjb250YWN0U29sdmVyLm1fY29uc3RyYWludHMpO1xyXG4gICAgICBpZiAoYWxsb3dTbGVlcCkge1xyXG4gICAgICAgICB2YXIgbWluU2xlZXBUaW1lID0gTnVtYmVyLk1BWF9WQUxVRTtcclxuICAgICAgICAgdmFyIGxpblRvbFNxciA9IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xlZXBUb2xlcmFuY2UgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsZWVwVG9sZXJhbmNlO1xyXG4gICAgICAgICB2YXIgYW5nVG9sU3FyID0gYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xlZXBUb2xlcmFuY2UgKiBiMlNldHRpbmdzLmIyX2FuZ3VsYXJTbGVlcFRvbGVyYW5jZTtcclxuICAgICAgICAgZm9yIChpID0gMDtcclxuICAgICAgICAgaSA8IHRoaXMubV9ib2R5Q291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICBiID0gdGhpcy5tX2JvZGllc1tpXTtcclxuICAgICAgICAgICAgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgoYi5tX2ZsYWdzICYgYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWcpID09IDApIHtcclxuICAgICAgICAgICAgICAgYi5tX3NsZWVwVGltZSA9IDAuMDtcclxuICAgICAgICAgICAgICAgbWluU2xlZXBUaW1lID0gMC4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgoYi5tX2ZsYWdzICYgYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWcpID09IDAgfHwgYi5tX2FuZ3VsYXJWZWxvY2l0eSAqIGIubV9hbmd1bGFyVmVsb2NpdHkgPiBhbmdUb2xTcXIgfHwgYjJNYXRoLkRvdChiLm1fbGluZWFyVmVsb2NpdHksIGIubV9saW5lYXJWZWxvY2l0eSkgPiBsaW5Ub2xTcXIpIHtcclxuICAgICAgICAgICAgICAgYi5tX3NsZWVwVGltZSA9IDAuMDtcclxuICAgICAgICAgICAgICAgbWluU2xlZXBUaW1lID0gMC4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICBiLm1fc2xlZXBUaW1lICs9IHN0ZXAuZHQ7XHJcbiAgICAgICAgICAgICAgIG1pblNsZWVwVGltZSA9IGIyTWF0aC5NaW4obWluU2xlZXBUaW1lLCBiLm1fc2xlZXBUaW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChtaW5TbGVlcFRpbWUgPj0gYjJTZXR0aW5ncy5iMl90aW1lVG9TbGVlcCkge1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICAgICBpIDwgdGhpcy5tX2JvZHlDb3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgIGIgPSB0aGlzLm1fYm9kaWVzW2ldO1xyXG4gICAgICAgICAgICAgICBiLlNldEF3YWtlKGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMklzbGFuZC5wcm90b3R5cGUuU29sdmVUT0kgPSBmdW5jdGlvbiAoc3ViU3RlcCkge1xyXG4gICAgICB2YXIgaSA9IDA7XHJcbiAgICAgIHZhciBqID0gMDtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RTb2x2ZXIuSW5pdGlhbGl6ZShzdWJTdGVwLCB0aGlzLm1fY29udGFjdHMsIHRoaXMubV9jb250YWN0Q291bnQsIHRoaXMubV9hbGxvY2F0b3IpO1xyXG4gICAgICB2YXIgY29udGFjdFNvbHZlciA9IHRoaXMubV9jb250YWN0U29sdmVyO1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB0aGlzLm1fam9pbnRzW2ldLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzKHN1YlN0ZXApO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCBzdWJTdGVwLnZlbG9jaXR5SXRlcmF0aW9uczsgKytpKSB7XHJcbiAgICAgICAgIGNvbnRhY3RTb2x2ZXIuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzKCk7XHJcbiAgICAgICAgIGZvciAoaiA9IDA7XHJcbiAgICAgICAgIGogPCB0aGlzLm1fam9pbnRDb3VudDsgKytqKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9qb2ludHNbal0uU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzKHN1YlN0ZXApO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHRoaXMubV9ib2R5Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgYiA9IHRoaXMubV9ib2RpZXNbaV07XHJcbiAgICAgICAgIGlmIChiLkdldFR5cGUoKSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkgY29udGludWU7XHJcbiAgICAgICAgIHZhciB0cmFuc2xhdGlvblggPSBzdWJTdGVwLmR0ICogYi5tX2xpbmVhclZlbG9jaXR5Lng7XHJcbiAgICAgICAgIHZhciB0cmFuc2xhdGlvblkgPSBzdWJTdGVwLmR0ICogYi5tX2xpbmVhclZlbG9jaXR5Lnk7XHJcbiAgICAgICAgIGlmICgodHJhbnNsYXRpb25YICogdHJhbnNsYXRpb25YICsgdHJhbnNsYXRpb25ZICogdHJhbnNsYXRpb25ZKSA+IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb25TcXVhcmVkKSB7XHJcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS5Ob3JtYWxpemUoKTtcclxuICAgICAgICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnggKj0gYjJTZXR0aW5ncy5iMl9tYXhUcmFuc2xhdGlvbiAqIHN1YlN0ZXAuaW52X2R0O1xyXG4gICAgICAgICAgICBiLm1fbGluZWFyVmVsb2NpdHkueSAqPSBiMlNldHRpbmdzLmIyX21heFRyYW5zbGF0aW9uICogc3ViU3RlcC5pbnZfZHQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIHJvdGF0aW9uID0gc3ViU3RlcC5kdCAqIGIubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgICAgIGlmIChyb3RhdGlvbiAqIHJvdGF0aW9uID4gYjJTZXR0aW5ncy5iMl9tYXhSb3RhdGlvblNxdWFyZWQpIHtcclxuICAgICAgICAgICAgaWYgKGIubV9hbmd1bGFyVmVsb2NpdHkgPCAwLjApIHtcclxuICAgICAgICAgICAgICAgYi5tX2FuZ3VsYXJWZWxvY2l0eSA9ICgtYjJTZXR0aW5ncy5iMl9tYXhSb3RhdGlvbiAqIHN1YlN0ZXAuaW52X2R0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgYi5tX2FuZ3VsYXJWZWxvY2l0eSA9IGIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb24gKiBzdWJTdGVwLmludl9kdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGIubV9zd2VlcC5jMC5TZXRWKGIubV9zd2VlcC5jKTtcclxuICAgICAgICAgYi5tX3N3ZWVwLmEwID0gYi5tX3N3ZWVwLmE7XHJcbiAgICAgICAgIGIubV9zd2VlcC5jLnggKz0gc3ViU3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS54O1xyXG4gICAgICAgICBiLm1fc3dlZXAuYy55ICs9IHN1YlN0ZXAuZHQgKiBiLm1fbGluZWFyVmVsb2NpdHkueTtcclxuICAgICAgICAgYi5tX3N3ZWVwLmEgKz0gc3ViU3RlcC5kdCAqIGIubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgICAgIGIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIga190b2lCYXVtZ2FydGUgPSAwLjc1O1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgc3ViU3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnM7ICsraSkge1xyXG4gICAgICAgICB2YXIgY29udGFjdHNPa2F5ID0gY29udGFjdFNvbHZlci5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMoa190b2lCYXVtZ2FydGUpO1xyXG4gICAgICAgICB2YXIgam9pbnRzT2theSA9IHRydWU7XHJcbiAgICAgICAgIGZvciAoaiA9IDA7XHJcbiAgICAgICAgIGogPCB0aGlzLm1fam9pbnRDb3VudDsgKytqKSB7XHJcbiAgICAgICAgICAgIHZhciBqb2ludE9rYXkgPSB0aGlzLm1fam9pbnRzW2pdLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyhiMlNldHRpbmdzLmIyX2NvbnRhY3RCYXVtZ2FydGUpO1xyXG4gICAgICAgICAgICBqb2ludHNPa2F5ID0gam9pbnRzT2theSAmJiBqb2ludE9rYXk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKGNvbnRhY3RzT2theSAmJiBqb2ludHNPa2F5KSB7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5SZXBvcnQoY29udGFjdFNvbHZlci5tX2NvbnN0cmFpbnRzKTtcclxuICAgfVxyXG4gICBiMklzbGFuZC5wcm90b3R5cGUuUmVwb3J0ID0gZnVuY3Rpb24gKGNvbnN0cmFpbnRzKSB7XHJcbiAgICAgIGlmICh0aGlzLm1fbGlzdGVuZXIgPT0gbnVsbCkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29udGFjdENvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIGMgPSB0aGlzLm1fY29udGFjdHNbaV07XHJcbiAgICAgICAgIHZhciBjYyA9IGNvbnN0cmFpbnRzW2ldO1xyXG4gICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNjLnBvaW50Q291bnQ7ICsraikge1xyXG4gICAgICAgICAgICBiMklzbGFuZC5zX2ltcHVsc2Uubm9ybWFsSW1wdWxzZXNbal0gPSBjYy5wb2ludHNbal0ubm9ybWFsSW1wdWxzZTtcclxuICAgICAgICAgICAgYjJJc2xhbmQuc19pbXB1bHNlLnRhbmdlbnRJbXB1bHNlc1tqXSA9IGNjLnBvaW50c1tqXS50YW5nZW50SW1wdWxzZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB0aGlzLm1fbGlzdGVuZXIuUG9zdFNvbHZlKGMsIGIySXNsYW5kLnNfaW1wdWxzZSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMklzbGFuZC5wcm90b3R5cGUuQWRkQm9keSA9IGZ1bmN0aW9uIChib2R5KSB7XHJcbiAgICAgIGJvZHkubV9pc2xhbmRJbmRleCA9IHRoaXMubV9ib2R5Q291bnQ7XHJcbiAgICAgIHRoaXMubV9ib2RpZXNbdGhpcy5tX2JvZHlDb3VudCsrXSA9IGJvZHk7XHJcbiAgIH1cclxuICAgYjJJc2xhbmQucHJvdG90eXBlLkFkZENvbnRhY3QgPSBmdW5jdGlvbiAoY29udGFjdCkge1xyXG4gICAgICB0aGlzLm1fY29udGFjdHNbdGhpcy5tX2NvbnRhY3RDb3VudCsrXSA9IGNvbnRhY3Q7XHJcbiAgIH1cclxuICAgYjJJc2xhbmQucHJvdG90eXBlLkFkZEpvaW50ID0gZnVuY3Rpb24gKGpvaW50KSB7XHJcbiAgICAgIHRoaXMubV9qb2ludHNbdGhpcy5tX2pvaW50Q291bnQrK10gPSBqb2ludDtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJJc2xhbmQuc19pbXB1bHNlID0gbmV3IGIyQ29udGFjdEltcHVsc2UoKTtcclxuICAgfSk7XHJcbiAgIGIyVGltZVN0ZXAuYjJUaW1lU3RlcCA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMlRpbWVTdGVwLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB0aGlzLmR0ID0gc3RlcC5kdDtcclxuICAgICAgdGhpcy5pbnZfZHQgPSBzdGVwLmludl9kdDtcclxuICAgICAgdGhpcy5wb3NpdGlvbkl0ZXJhdGlvbnMgPSBzdGVwLnBvc2l0aW9uSXRlcmF0aW9ucztcclxuICAgICAgdGhpcy52ZWxvY2l0eUl0ZXJhdGlvbnMgPSBzdGVwLnZlbG9jaXR5SXRlcmF0aW9ucztcclxuICAgICAgdGhpcy53YXJtU3RhcnRpbmcgPSBzdGVwLndhcm1TdGFydGluZztcclxuICAgfVxyXG4gICBiMldvcmxkLmIyV29ybGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuc19zdGFjayA9IG5ldyBWZWN0b3IoKTtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyID0gbmV3IGIyQ29udGFjdE1hbmFnZXIoKTtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RTb2x2ZXIgPSBuZXcgYjJDb250YWN0U29sdmVyKCk7XHJcbiAgICAgIHRoaXMubV9pc2xhbmQgPSBuZXcgYjJJc2xhbmQoKTtcclxuICAgfTtcclxuICAgYjJXb3JsZC5wcm90b3R5cGUuYjJXb3JsZCA9IGZ1bmN0aW9uIChncmF2aXR5LCBkb1NsZWVwKSB7XHJcbiAgICAgIHRoaXMubV9kZXN0cnVjdGlvbkxpc3RlbmVyID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2RlYnVnRHJhdyA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ib2R5TGlzdCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9qb2ludExpc3QgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fY29udHJvbGxlckxpc3QgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fYm9keUNvdW50ID0gMDtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9qb2ludENvdW50ID0gMDtcclxuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJDb3VudCA9IDA7XHJcbiAgICAgIGIyV29ybGQubV93YXJtU3RhcnRpbmcgPSB0cnVlO1xyXG4gICAgICBiMldvcmxkLm1fY29udGludW91c1BoeXNpY3MgPSB0cnVlO1xyXG4gICAgICB0aGlzLm1fYWxsb3dTbGVlcCA9IGRvU2xlZXA7XHJcbiAgICAgIHRoaXMubV9ncmF2aXR5ID0gZ3Jhdml0eTtcclxuICAgICAgdGhpcy5tX2ludl9kdDAgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlci5tX3dvcmxkID0gdGhpcztcclxuICAgICAgdmFyIGJkID0gbmV3IGIyQm9keURlZigpO1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kQm9keSA9IHRoaXMuQ3JlYXRlQm9keShiZCk7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuU2V0RGVzdHJ1Y3Rpb25MaXN0ZW5lciA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xyXG4gICAgICB0aGlzLm1fZGVzdHJ1Y3Rpb25MaXN0ZW5lciA9IGxpc3RlbmVyO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlNldENvbnRhY3RGaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlci5tX2NvbnRhY3RGaWx0ZXIgPSBmaWx0ZXI7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuU2V0Q29udGFjdExpc3RlbmVyID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XHJcbiAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlci5tX2NvbnRhY3RMaXN0ZW5lciA9IGxpc3RlbmVyO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlNldERlYnVnRHJhdyA9IGZ1bmN0aW9uIChkZWJ1Z0RyYXcpIHtcclxuICAgICAgdGhpcy5tX2RlYnVnRHJhdyA9IGRlYnVnRHJhdztcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5TZXRCcm9hZFBoYXNlID0gZnVuY3Rpb24gKGJyb2FkUGhhc2UpIHtcclxuICAgICAgdmFyIG9sZEJyb2FkUGhhc2UgPSB0aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlO1xyXG4gICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlID0gYnJvYWRQaGFzZTtcclxuICAgICAgZm9yICh2YXIgYiA9IHRoaXMubV9ib2R5TGlzdDsgYjsgYiA9IGIubV9uZXh0KSB7XHJcbiAgICAgICAgIGZvciAodmFyIGYgPSBiLm1fZml4dHVyZUxpc3Q7IGY7IGYgPSBmLm1fbmV4dCkge1xyXG4gICAgICAgICAgICBmLm1fcHJveHkgPSBicm9hZFBoYXNlLkNyZWF0ZVByb3h5KG9sZEJyb2FkUGhhc2UuR2V0RmF0QUFCQihmLm1fcHJveHkpLCBmKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuVmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2UuVmFsaWRhdGUoKTtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRQcm94eUNvdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZS5HZXRQcm94eUNvdW50KCk7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuQ3JlYXRlQm9keSA9IGZ1bmN0aW9uIChkZWYpIHtcclxuICAgICAgaWYgKHRoaXMuSXNMb2NrZWQoKSA9PSB0cnVlKSB7XHJcbiAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBiID0gbmV3IGIyQm9keShkZWYsIHRoaXMpO1xyXG4gICAgICBiLm1fcHJldiA9IG51bGw7XHJcbiAgICAgIGIubV9uZXh0ID0gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICAgICBpZiAodGhpcy5tX2JvZHlMaXN0KSB7XHJcbiAgICAgICAgIHRoaXMubV9ib2R5TGlzdC5tX3ByZXYgPSBiO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9ib2R5TGlzdCA9IGI7XHJcbiAgICAgICsrdGhpcy5tX2JvZHlDb3VudDtcclxuICAgICAgcmV0dXJuIGI7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuRGVzdHJveUJvZHkgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICBpZiAodGhpcy5Jc0xvY2tlZCgpID09IHRydWUpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBqbiA9IGIubV9qb2ludExpc3Q7XHJcbiAgICAgIHdoaWxlIChqbikge1xyXG4gICAgICAgICB2YXIgam4wID0gam47XHJcbiAgICAgICAgIGpuID0gam4ubmV4dDtcclxuICAgICAgICAgaWYgKHRoaXMubV9kZXN0cnVjdGlvbkxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9kZXN0cnVjdGlvbkxpc3RlbmVyLlNheUdvb2RieWVKb2ludChqbjAuam9pbnQpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHRoaXMuRGVzdHJveUpvaW50KGpuMC5qb2ludCk7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGNvZSA9IGIubV9jb250cm9sbGVyTGlzdDtcclxuICAgICAgd2hpbGUgKGNvZSkge1xyXG4gICAgICAgICB2YXIgY29lMCA9IGNvZTtcclxuICAgICAgICAgY29lID0gY29lLm5leHRDb250cm9sbGVyO1xyXG4gICAgICAgICBjb2UwLmNvbnRyb2xsZXIuUmVtb3ZlQm9keShiKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgY2UgPSBiLm1fY29udGFjdExpc3Q7XHJcbiAgICAgIHdoaWxlIChjZSkge1xyXG4gICAgICAgICB2YXIgY2UwID0gY2U7XHJcbiAgICAgICAgIGNlID0gY2UubmV4dDtcclxuICAgICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLkRlc3Ryb3koY2UwLmNvbnRhY3QpO1xyXG4gICAgICB9XHJcbiAgICAgIGIubV9jb250YWN0TGlzdCA9IG51bGw7XHJcbiAgICAgIHZhciBmID0gYi5tX2ZpeHR1cmVMaXN0O1xyXG4gICAgICB3aGlsZSAoZikge1xyXG4gICAgICAgICB2YXIgZjAgPSBmO1xyXG4gICAgICAgICBmID0gZi5tX25leHQ7XHJcbiAgICAgICAgIGlmICh0aGlzLm1fZGVzdHJ1Y3Rpb25MaXN0ZW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLm1fZGVzdHJ1Y3Rpb25MaXN0ZW5lci5TYXlHb29kYnllRml4dHVyZShmMCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZjAuRGVzdHJveVByb3h5KHRoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2UpO1xyXG4gICAgICAgICBmMC5EZXN0cm95KCk7XHJcbiAgICAgIH1cclxuICAgICAgYi5tX2ZpeHR1cmVMaXN0ID0gbnVsbDtcclxuICAgICAgYi5tX2ZpeHR1cmVDb3VudCA9IDA7XHJcbiAgICAgIGlmIChiLm1fcHJldikge1xyXG4gICAgICAgICBiLm1fcHJldi5tX25leHQgPSBiLm1fbmV4dDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYi5tX25leHQpIHtcclxuICAgICAgICAgYi5tX25leHQubV9wcmV2ID0gYi5tX3ByZXY7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGIgPT0gdGhpcy5tX2JvZHlMaXN0KSB7XHJcbiAgICAgICAgIHRoaXMubV9ib2R5TGlzdCA9IGIubV9uZXh0O1xyXG4gICAgICB9LS10aGlzLm1fYm9keUNvdW50O1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkNyZWF0ZUpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICB2YXIgaiA9IGIySm9pbnQuQ3JlYXRlKGRlZiwgbnVsbCk7XHJcbiAgICAgIGoubV9wcmV2ID0gbnVsbDtcclxuICAgICAgai5tX25leHQgPSB0aGlzLm1fam9pbnRMaXN0O1xyXG4gICAgICBpZiAodGhpcy5tX2pvaW50TGlzdCkge1xyXG4gICAgICAgICB0aGlzLm1fam9pbnRMaXN0Lm1fcHJldiA9IGo7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2pvaW50TGlzdCA9IGo7XHJcbiAgICAgICsrdGhpcy5tX2pvaW50Q291bnQ7XHJcbiAgICAgIGoubV9lZGdlQS5qb2ludCA9IGo7XHJcbiAgICAgIGoubV9lZGdlQS5vdGhlciA9IGoubV9ib2R5QjtcclxuICAgICAgai5tX2VkZ2VBLnByZXYgPSBudWxsO1xyXG4gICAgICBqLm1fZWRnZUEubmV4dCA9IGoubV9ib2R5QS5tX2pvaW50TGlzdDtcclxuICAgICAgaWYgKGoubV9ib2R5QS5tX2pvaW50TGlzdCkgai5tX2JvZHlBLm1fam9pbnRMaXN0LnByZXYgPSBqLm1fZWRnZUE7XHJcbiAgICAgIGoubV9ib2R5QS5tX2pvaW50TGlzdCA9IGoubV9lZGdlQTtcclxuICAgICAgai5tX2VkZ2VCLmpvaW50ID0gajtcclxuICAgICAgai5tX2VkZ2VCLm90aGVyID0gai5tX2JvZHlBO1xyXG4gICAgICBqLm1fZWRnZUIucHJldiA9IG51bGw7XHJcbiAgICAgIGoubV9lZGdlQi5uZXh0ID0gai5tX2JvZHlCLm1fam9pbnRMaXN0O1xyXG4gICAgICBpZiAoai5tX2JvZHlCLm1fam9pbnRMaXN0KSBqLm1fYm9keUIubV9qb2ludExpc3QucHJldiA9IGoubV9lZGdlQjtcclxuICAgICAgai5tX2JvZHlCLm1fam9pbnRMaXN0ID0gai5tX2VkZ2VCO1xyXG4gICAgICB2YXIgYm9keUEgPSBkZWYuYm9keUE7XHJcbiAgICAgIHZhciBib2R5QiA9IGRlZi5ib2R5QjtcclxuICAgICAgaWYgKGRlZi5jb2xsaWRlQ29ubmVjdGVkID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHZhciBlZGdlID0gYm9keUIuR2V0Q29udGFjdExpc3QoKTtcclxuICAgICAgICAgd2hpbGUgKGVkZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGVkZ2Uub3RoZXIgPT0gYm9keUEpIHtcclxuICAgICAgICAgICAgICAgZWRnZS5jb250YWN0LkZsYWdGb3JGaWx0ZXJpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGo7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuRGVzdHJveUpvaW50ID0gZnVuY3Rpb24gKGopIHtcclxuICAgICAgdmFyIGNvbGxpZGVDb25uZWN0ZWQgPSBqLm1fY29sbGlkZUNvbm5lY3RlZDtcclxuICAgICAgaWYgKGoubV9wcmV2KSB7XHJcbiAgICAgICAgIGoubV9wcmV2Lm1fbmV4dCA9IGoubV9uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChqLm1fbmV4dCkge1xyXG4gICAgICAgICBqLm1fbmV4dC5tX3ByZXYgPSBqLm1fcHJldjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoaiA9PSB0aGlzLm1fam9pbnRMaXN0KSB7XHJcbiAgICAgICAgIHRoaXMubV9qb2ludExpc3QgPSBqLm1fbmV4dDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgYm9keUEgPSBqLm1fYm9keUE7XHJcbiAgICAgIHZhciBib2R5QiA9IGoubV9ib2R5QjtcclxuICAgICAgYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIGJvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICBpZiAoai5tX2VkZ2VBLnByZXYpIHtcclxuICAgICAgICAgai5tX2VkZ2VBLnByZXYubmV4dCA9IGoubV9lZGdlQS5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChqLm1fZWRnZUEubmV4dCkge1xyXG4gICAgICAgICBqLm1fZWRnZUEubmV4dC5wcmV2ID0gai5tX2VkZ2VBLnByZXY7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGoubV9lZGdlQSA9PSBib2R5QS5tX2pvaW50TGlzdCkge1xyXG4gICAgICAgICBib2R5QS5tX2pvaW50TGlzdCA9IGoubV9lZGdlQS5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGoubV9lZGdlQS5wcmV2ID0gbnVsbDtcclxuICAgICAgai5tX2VkZ2VBLm5leHQgPSBudWxsO1xyXG4gICAgICBpZiAoai5tX2VkZ2VCLnByZXYpIHtcclxuICAgICAgICAgai5tX2VkZ2VCLnByZXYubmV4dCA9IGoubV9lZGdlQi5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChqLm1fZWRnZUIubmV4dCkge1xyXG4gICAgICAgICBqLm1fZWRnZUIubmV4dC5wcmV2ID0gai5tX2VkZ2VCLnByZXY7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGoubV9lZGdlQiA9PSBib2R5Qi5tX2pvaW50TGlzdCkge1xyXG4gICAgICAgICBib2R5Qi5tX2pvaW50TGlzdCA9IGoubV9lZGdlQi5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGoubV9lZGdlQi5wcmV2ID0gbnVsbDtcclxuICAgICAgai5tX2VkZ2VCLm5leHQgPSBudWxsO1xyXG4gICAgICBiMkpvaW50LkRlc3Ryb3koaiwgbnVsbCk7XHJcbiAgICAgIC0tdGhpcy5tX2pvaW50Q291bnQ7XHJcbiAgICAgIGlmIChjb2xsaWRlQ29ubmVjdGVkID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHZhciBlZGdlID0gYm9keUIuR2V0Q29udGFjdExpc3QoKTtcclxuICAgICAgICAgd2hpbGUgKGVkZ2UpIHtcclxuICAgICAgICAgICAgaWYgKGVkZ2Uub3RoZXIgPT0gYm9keUEpIHtcclxuICAgICAgICAgICAgICAgZWRnZS5jb250YWN0LkZsYWdGb3JGaWx0ZXJpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5BZGRDb250cm9sbGVyID0gZnVuY3Rpb24gKGMpIHtcclxuICAgICAgYy5tX25leHQgPSB0aGlzLm1fY29udHJvbGxlckxpc3Q7XHJcbiAgICAgIGMubV9wcmV2ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJMaXN0ID0gYztcclxuICAgICAgYy5tX3dvcmxkID0gdGhpcztcclxuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJDb3VudCsrO1xyXG4gICAgICByZXR1cm4gYztcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5SZW1vdmVDb250cm9sbGVyID0gZnVuY3Rpb24gKGMpIHtcclxuICAgICAgaWYgKGMubV9wcmV2KSBjLm1fcHJldi5tX25leHQgPSBjLm1fbmV4dDtcclxuICAgICAgaWYgKGMubV9uZXh0KSBjLm1fbmV4dC5tX3ByZXYgPSBjLm1fcHJldjtcclxuICAgICAgaWYgKHRoaXMubV9jb250cm9sbGVyTGlzdCA9PSBjKSB0aGlzLm1fY29udHJvbGxlckxpc3QgPSBjLm1fbmV4dDtcclxuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJDb3VudC0tO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkNyZWF0ZUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoY29udHJvbGxlcikge1xyXG4gICAgICBpZiAoY29udHJvbGxlci5tX3dvcmxkICE9IHRoaXMpIHRocm93IG5ldyBFcnJvcihcIkNvbnRyb2xsZXIgY2FuIG9ubHkgYmUgYSBtZW1iZXIgb2Ygb25lIHdvcmxkXCIpO1xyXG4gICAgICBjb250cm9sbGVyLm1fbmV4dCA9IHRoaXMubV9jb250cm9sbGVyTGlzdDtcclxuICAgICAgY29udHJvbGxlci5tX3ByZXYgPSBudWxsO1xyXG4gICAgICBpZiAodGhpcy5tX2NvbnRyb2xsZXJMaXN0KSB0aGlzLm1fY29udHJvbGxlckxpc3QubV9wcmV2ID0gY29udHJvbGxlcjtcclxuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJMaXN0ID0gY29udHJvbGxlcjtcclxuICAgICAgKyt0aGlzLm1fY29udHJvbGxlckNvdW50O1xyXG4gICAgICBjb250cm9sbGVyLm1fd29ybGQgPSB0aGlzO1xyXG4gICAgICByZXR1cm4gY29udHJvbGxlcjtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5EZXN0cm95Q29udHJvbGxlciA9IGZ1bmN0aW9uIChjb250cm9sbGVyKSB7XHJcbiAgICAgIGNvbnRyb2xsZXIuQ2xlYXIoKTtcclxuICAgICAgaWYgKGNvbnRyb2xsZXIubV9uZXh0KSBjb250cm9sbGVyLm1fbmV4dC5tX3ByZXYgPSBjb250cm9sbGVyLm1fcHJldjtcclxuICAgICAgaWYgKGNvbnRyb2xsZXIubV9wcmV2KSBjb250cm9sbGVyLm1fcHJldi5tX25leHQgPSBjb250cm9sbGVyLm1fbmV4dDtcclxuICAgICAgaWYgKGNvbnRyb2xsZXIgPT0gdGhpcy5tX2NvbnRyb2xsZXJMaXN0KSB0aGlzLm1fY29udHJvbGxlckxpc3QgPSBjb250cm9sbGVyLm1fbmV4dDtcclxuICAgICAgLS10aGlzLm1fY29udHJvbGxlckNvdW50O1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlNldFdhcm1TdGFydGluZyA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgIGIyV29ybGQubV93YXJtU3RhcnRpbmcgPSBmbGFnO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlNldENvbnRpbnVvdXNQaHlzaWNzID0gZnVuY3Rpb24gKGZsYWcpIHtcclxuICAgICAgYjJXb3JsZC5tX2NvbnRpbnVvdXNQaHlzaWNzID0gZmxhZztcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRCb2R5Q291bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUNvdW50O1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkdldEpvaW50Q291bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fam9pbnRDb3VudDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRDb250YWN0Q291bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fY29udGFjdENvdW50O1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlNldEdyYXZpdHkgPSBmdW5jdGlvbiAoZ3Jhdml0eSkge1xyXG4gICAgICB0aGlzLm1fZ3Jhdml0eSA9IGdyYXZpdHk7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0R3Jhdml0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ncmF2aXR5O1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkdldEdyb3VuZEJvZHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZ3JvdW5kQm9keTtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5TdGVwID0gZnVuY3Rpb24gKGR0LCB2ZWxvY2l0eUl0ZXJhdGlvbnMsIHBvc2l0aW9uSXRlcmF0aW9ucykge1xyXG4gICAgICBpZiAoZHQgPT09IHVuZGVmaW5lZCkgZHQgPSAwO1xyXG4gICAgICBpZiAodmVsb2NpdHlJdGVyYXRpb25zID09PSB1bmRlZmluZWQpIHZlbG9jaXR5SXRlcmF0aW9ucyA9IDA7XHJcbiAgICAgIGlmIChwb3NpdGlvbkl0ZXJhdGlvbnMgPT09IHVuZGVmaW5lZCkgcG9zaXRpb25JdGVyYXRpb25zID0gMDtcclxuICAgICAgaWYgKHRoaXMubV9mbGFncyAmIGIyV29ybGQuZV9uZXdGaXh0dXJlKSB7XHJcbiAgICAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlci5GaW5kTmV3Q29udGFjdHMoKTtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMldvcmxkLmVfbmV3Rml4dHVyZTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJXb3JsZC5lX2xvY2tlZDtcclxuICAgICAgdmFyIHN0ZXAgPSBiMldvcmxkLnNfdGltZXN0ZXAyO1xyXG4gICAgICBzdGVwLmR0ID0gZHQ7XHJcbiAgICAgIHN0ZXAudmVsb2NpdHlJdGVyYXRpb25zID0gdmVsb2NpdHlJdGVyYXRpb25zO1xyXG4gICAgICBzdGVwLnBvc2l0aW9uSXRlcmF0aW9ucyA9IHBvc2l0aW9uSXRlcmF0aW9ucztcclxuICAgICAgaWYgKGR0ID4gMC4wKSB7XHJcbiAgICAgICAgIHN0ZXAuaW52X2R0ID0gMS4wIC8gZHQ7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHN0ZXAuaW52X2R0ID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIHN0ZXAuZHRSYXRpbyA9IHRoaXMubV9pbnZfZHQwICogZHQ7XHJcbiAgICAgIHN0ZXAud2FybVN0YXJ0aW5nID0gYjJXb3JsZC5tX3dhcm1TdGFydGluZztcclxuICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLkNvbGxpZGUoKTtcclxuICAgICAgaWYgKHN0ZXAuZHQgPiAwLjApIHtcclxuICAgICAgICAgdGhpcy5Tb2x2ZShzdGVwKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYjJXb3JsZC5tX2NvbnRpbnVvdXNQaHlzaWNzICYmIHN0ZXAuZHQgPiAwLjApIHtcclxuICAgICAgICAgdGhpcy5Tb2x2ZVRPSShzdGVwKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoc3RlcC5kdCA+IDAuMCkge1xyXG4gICAgICAgICB0aGlzLm1faW52X2R0MCA9IHN0ZXAuaW52X2R0O1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9mbGFncyAmPSB+YjJXb3JsZC5lX2xvY2tlZDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5DbGVhckZvcmNlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgZm9yICh2YXIgYm9keSA9IHRoaXMubV9ib2R5TGlzdDsgYm9keTsgYm9keSA9IGJvZHkubV9uZXh0KSB7XHJcbiAgICAgICAgIGJvZHkubV9mb3JjZS5TZXRaZXJvKCk7XHJcbiAgICAgICAgIGJvZHkubV90b3JxdWUgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5EcmF3RGVidWdEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAodGhpcy5tX2RlYnVnRHJhdyA9PSBudWxsKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fZGVidWdEcmF3Lm1fc3ByaXRlLmdyYXBoaWNzLmNsZWFyKCk7XHJcbiAgICAgIHZhciBmbGFncyA9IHRoaXMubV9kZWJ1Z0RyYXcuR2V0RmxhZ3MoKTtcclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICB2YXIgYjtcclxuICAgICAgdmFyIGY7XHJcbiAgICAgIHZhciBzO1xyXG4gICAgICB2YXIgajtcclxuICAgICAgdmFyIGJwO1xyXG4gICAgICB2YXIgaW52USA9IG5ldyBiMlZlYzI7XHJcbiAgICAgIHZhciB4MSA9IG5ldyBiMlZlYzI7XHJcbiAgICAgIHZhciB4MiA9IG5ldyBiMlZlYzI7XHJcbiAgICAgIHZhciB4ZjtcclxuICAgICAgdmFyIGIxID0gbmV3IGIyQUFCQigpO1xyXG4gICAgICB2YXIgYjIgPSBuZXcgYjJBQUJCKCk7XHJcbiAgICAgIHZhciB2cyA9IFtuZXcgYjJWZWMyKCksIG5ldyBiMlZlYzIoKSwgbmV3IGIyVmVjMigpLCBuZXcgYjJWZWMyKCldO1xyXG4gICAgICB2YXIgY29sb3IgPSBuZXcgYjJDb2xvcigwLCAwLCAwKTtcclxuICAgICAgaWYgKGZsYWdzICYgYjJEZWJ1Z0RyYXcuZV9zaGFwZUJpdCkge1xyXG4gICAgICAgICBmb3IgKGIgPSB0aGlzLm1fYm9keUxpc3Q7XHJcbiAgICAgICAgIGI7IGIgPSBiLm1fbmV4dCkge1xyXG4gICAgICAgICAgICB4ZiA9IGIubV94ZjtcclxuICAgICAgICAgICAgZm9yIChmID0gYi5HZXRGaXh0dXJlTGlzdCgpO1xyXG4gICAgICAgICAgICBmOyBmID0gZi5tX25leHQpIHtcclxuICAgICAgICAgICAgICAgcyA9IGYuR2V0U2hhcGUoKTtcclxuICAgICAgICAgICAgICAgaWYgKGIuSXNBY3RpdmUoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICBjb2xvci5TZXQoMC41LCAwLjUsIDAuMyk7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuRHJhd1NoYXBlKHMsIHhmLCBjb2xvcik7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgZWxzZSBpZiAoYi5HZXRUeXBlKCkgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgY29sb3IuU2V0KDAuNSwgMC45LCAwLjUpO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLkRyYXdTaGFwZShzLCB4ZiwgY29sb3IpO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGVsc2UgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9raW5lbWF0aWNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbG9yLlNldCgwLjUsIDAuNSwgMC45KTtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5EcmF3U2hhcGUocywgeGYsIGNvbG9yKTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBlbHNlIGlmIChiLklzQXdha2UoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICBjb2xvci5TZXQoMC42LCAwLjYsIDAuNik7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuRHJhd1NoYXBlKHMsIHhmLCBjb2xvcik7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbG9yLlNldCgwLjksIDAuNywgMC43KTtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5EcmF3U2hhcGUocywgeGYsIGNvbG9yKTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAoZmxhZ3MgJiBiMkRlYnVnRHJhdy5lX2pvaW50Qml0KSB7XHJcbiAgICAgICAgIGZvciAoaiA9IHRoaXMubV9qb2ludExpc3Q7XHJcbiAgICAgICAgIGo7IGogPSBqLm1fbmV4dCkge1xyXG4gICAgICAgICAgICB0aGlzLkRyYXdKb2ludChqKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChmbGFncyAmIGIyRGVidWdEcmF3LmVfY29udHJvbGxlckJpdCkge1xyXG4gICAgICAgICBmb3IgKHZhciBjID0gdGhpcy5tX2NvbnRyb2xsZXJMaXN0OyBjOyBjID0gYy5tX25leHQpIHtcclxuICAgICAgICAgICAgYy5EcmF3KHRoaXMubV9kZWJ1Z0RyYXcpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGZsYWdzICYgYjJEZWJ1Z0RyYXcuZV9wYWlyQml0KSB7XHJcbiAgICAgICAgIGNvbG9yLlNldCgwLjMsIDAuOSwgMC45KTtcclxuICAgICAgICAgZm9yICh2YXIgY29udGFjdCA9IHRoaXMubV9jb250YWN0TWFuYWdlci5tX2NvbnRhY3RMaXN0OyBjb250YWN0OyBjb250YWN0ID0gY29udGFjdC5HZXROZXh0KCkpIHtcclxuICAgICAgICAgICAgdmFyIGZpeHR1cmVBID0gY29udGFjdC5HZXRGaXh0dXJlQSgpO1xyXG4gICAgICAgICAgICB2YXIgZml4dHVyZUIgPSBjb250YWN0LkdldEZpeHR1cmVCKCk7XHJcbiAgICAgICAgICAgIHZhciBjQSA9IGZpeHR1cmVBLkdldEFBQkIoKS5HZXRDZW50ZXIoKTtcclxuICAgICAgICAgICAgdmFyIGNCID0gZml4dHVyZUIuR2V0QUFCQigpLkdldENlbnRlcigpO1xyXG4gICAgICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KGNBLCBjQiwgY29sb3IpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGZsYWdzICYgYjJEZWJ1Z0RyYXcuZV9hYWJiQml0KSB7XHJcbiAgICAgICAgIGJwID0gdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcclxuICAgICAgICAgdnMgPSBbbmV3IGIyVmVjMigpLCBuZXcgYjJWZWMyKCksIG5ldyBiMlZlYzIoKSwgbmV3IGIyVmVjMigpXTtcclxuICAgICAgICAgZm9yIChiID0gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICAgICAgICBiOyBiID0gYi5HZXROZXh0KCkpIHtcclxuICAgICAgICAgICAgaWYgKGIuSXNBY3RpdmUoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGYgPSBiLkdldEZpeHR1cmVMaXN0KCk7XHJcbiAgICAgICAgICAgIGY7IGYgPSBmLkdldE5leHQoKSkge1xyXG4gICAgICAgICAgICAgICB2YXIgYWFiYiA9IGJwLkdldEZhdEFBQkIoZi5tX3Byb3h5KTtcclxuICAgICAgICAgICAgICAgdnNbMF0uU2V0KGFhYmIubG93ZXJCb3VuZC54LCBhYWJiLmxvd2VyQm91bmQueSk7XHJcbiAgICAgICAgICAgICAgIHZzWzFdLlNldChhYWJiLnVwcGVyQm91bmQueCwgYWFiYi5sb3dlckJvdW5kLnkpO1xyXG4gICAgICAgICAgICAgICB2c1syXS5TZXQoYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55KTtcclxuICAgICAgICAgICAgICAgdnNbM10uU2V0KGFhYmIubG93ZXJCb3VuZC54LCBhYWJiLnVwcGVyQm91bmQueSk7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1BvbHlnb24odnMsIDQsIGNvbG9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGZsYWdzICYgYjJEZWJ1Z0RyYXcuZV9jZW50ZXJPZk1hc3NCaXQpIHtcclxuICAgICAgICAgZm9yIChiID0gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICAgICAgICBiOyBiID0gYi5tX25leHQpIHtcclxuICAgICAgICAgICAgeGYgPSBiMldvcmxkLnNfeGY7XHJcbiAgICAgICAgICAgIHhmLlIgPSBiLm1feGYuUjtcclxuICAgICAgICAgICAgeGYucG9zaXRpb24gPSBiLkdldFdvcmxkQ2VudGVyKCk7XHJcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1RyYW5zZm9ybSh4Zik7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlF1ZXJ5QUFCQiA9IGZ1bmN0aW9uIChjYWxsYmFjaywgYWFiYikge1xyXG4gICAgICB2YXIgX190aGlzID0gdGhpcztcclxuICAgICAgdmFyIGJyb2FkUGhhc2UgPSBfX3RoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcblxyXG4gICAgICBmdW5jdGlvbiBXb3JsZFF1ZXJ5V3JhcHBlcihwcm94eSkge1xyXG4gICAgICAgICByZXR1cm4gY2FsbGJhY2soYnJvYWRQaGFzZS5HZXRVc2VyRGF0YShwcm94eSkpO1xyXG4gICAgICB9O1xyXG4gICAgICBicm9hZFBoYXNlLlF1ZXJ5KFdvcmxkUXVlcnlXcmFwcGVyLCBhYWJiKTtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5RdWVyeVNoYXBlID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBzaGFwZSwgdHJhbnNmb3JtKSB7XHJcbiAgICAgIHZhciBfX3RoaXMgPSB0aGlzO1xyXG4gICAgICBpZiAodHJhbnNmb3JtID09PSB1bmRlZmluZWQpIHRyYW5zZm9ybSA9IG51bGw7XHJcbiAgICAgIGlmICh0cmFuc2Zvcm0gPT0gbnVsbCkge1xyXG4gICAgICAgICB0cmFuc2Zvcm0gPSBuZXcgYjJUcmFuc2Zvcm0oKTtcclxuICAgICAgICAgdHJhbnNmb3JtLlNldElkZW50aXR5KCk7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGJyb2FkUGhhc2UgPSBfX3RoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcblxyXG4gICAgICBmdW5jdGlvbiBXb3JsZFF1ZXJ5V3JhcHBlcihwcm94eSkge1xyXG4gICAgICAgICB2YXIgZml4dHVyZSA9IChicm9hZFBoYXNlLkdldFVzZXJEYXRhKHByb3h5KSBpbnN0YW5jZW9mIGIyRml4dHVyZSA/IGJyb2FkUGhhc2UuR2V0VXNlckRhdGEocHJveHkpIDogbnVsbCk7XHJcbiAgICAgICAgIGlmIChiMlNoYXBlLlRlc3RPdmVybGFwKHNoYXBlLCB0cmFuc2Zvcm0sIGZpeHR1cmUuR2V0U2hhcGUoKSwgZml4dHVyZS5HZXRCb2R5KCkuR2V0VHJhbnNmb3JtKCkpKSByZXR1cm4gY2FsbGJhY2soZml4dHVyZSk7XHJcbiAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9O1xyXG4gICAgICB2YXIgYWFiYiA9IG5ldyBiMkFBQkIoKTtcclxuICAgICAgc2hhcGUuQ29tcHV0ZUFBQkIoYWFiYiwgdHJhbnNmb3JtKTtcclxuICAgICAgYnJvYWRQaGFzZS5RdWVyeShXb3JsZFF1ZXJ5V3JhcHBlciwgYWFiYik7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuUXVlcnlQb2ludCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgcCkge1xyXG4gICAgICB2YXIgX190aGlzID0gdGhpcztcclxuICAgICAgdmFyIGJyb2FkUGhhc2UgPSBfX3RoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcblxyXG4gICAgICBmdW5jdGlvbiBXb3JsZFF1ZXJ5V3JhcHBlcihwcm94eSkge1xyXG4gICAgICAgICB2YXIgZml4dHVyZSA9IChicm9hZFBoYXNlLkdldFVzZXJEYXRhKHByb3h5KSBpbnN0YW5jZW9mIGIyRml4dHVyZSA/IGJyb2FkUGhhc2UuR2V0VXNlckRhdGEocHJveHkpIDogbnVsbCk7XHJcbiAgICAgICAgIGlmIChmaXh0dXJlLlRlc3RQb2ludChwKSkgcmV0dXJuIGNhbGxiYWNrKGZpeHR1cmUpO1xyXG4gICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfTtcclxuICAgICAgdmFyIGFhYmIgPSBuZXcgYjJBQUJCKCk7XHJcbiAgICAgIGFhYmIubG93ZXJCb3VuZC5TZXQocC54IC0gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wLCBwLnkgLSBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApO1xyXG4gICAgICBhYWJiLnVwcGVyQm91bmQuU2V0KHAueCArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgcC55ICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKTtcclxuICAgICAgYnJvYWRQaGFzZS5RdWVyeShXb3JsZFF1ZXJ5V3JhcHBlciwgYWFiYik7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgcG9pbnQxLCBwb2ludDIpIHtcclxuICAgICAgdmFyIF9fdGhpcyA9IHRoaXM7XHJcbiAgICAgIHZhciBicm9hZFBoYXNlID0gX190aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlO1xyXG4gICAgICB2YXIgb3V0cHV0ID0gbmV3IGIyUmF5Q2FzdE91dHB1dDtcclxuXHJcbiAgICAgIGZ1bmN0aW9uIFJheUNhc3RXcmFwcGVyKGlucHV0LCBwcm94eSkge1xyXG4gICAgICAgICB2YXIgdXNlckRhdGEgPSBicm9hZFBoYXNlLkdldFVzZXJEYXRhKHByb3h5KTtcclxuICAgICAgICAgdmFyIGZpeHR1cmUgPSAodXNlckRhdGEgaW5zdGFuY2VvZiBiMkZpeHR1cmUgPyB1c2VyRGF0YSA6IG51bGwpO1xyXG4gICAgICAgICB2YXIgaGl0ID0gZml4dHVyZS5SYXlDYXN0KG91dHB1dCwgaW5wdXQpO1xyXG4gICAgICAgICBpZiAoaGl0KSB7XHJcbiAgICAgICAgICAgIHZhciBmcmFjdGlvbiA9IG91dHB1dC5mcmFjdGlvbjtcclxuICAgICAgICAgICAgdmFyIHBvaW50ID0gbmV3IGIyVmVjMigoMS4wIC0gZnJhY3Rpb24pICogcG9pbnQxLnggKyBmcmFjdGlvbiAqIHBvaW50Mi54LCAoMS4wIC0gZnJhY3Rpb24pICogcG9pbnQxLnkgKyBmcmFjdGlvbiAqIHBvaW50Mi55KTtcclxuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGZpeHR1cmUsIHBvaW50LCBvdXRwdXQubm9ybWFsLCBmcmFjdGlvbik7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgcmV0dXJuIGlucHV0Lm1heEZyYWN0aW9uO1xyXG4gICAgICB9O1xyXG4gICAgICB2YXIgaW5wdXQgPSBuZXcgYjJSYXlDYXN0SW5wdXQocG9pbnQxLCBwb2ludDIpO1xyXG4gICAgICBicm9hZFBoYXNlLlJheUNhc3QoUmF5Q2FzdFdyYXBwZXIsIGlucHV0KTtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5SYXlDYXN0T25lID0gZnVuY3Rpb24gKHBvaW50MSwgcG9pbnQyKSB7XHJcbiAgICAgIHZhciBfX3RoaXMgPSB0aGlzO1xyXG4gICAgICB2YXIgcmVzdWx0O1xyXG5cclxuICAgICAgZnVuY3Rpb24gUmF5Q2FzdE9uZVdyYXBwZXIoZml4dHVyZSwgcG9pbnQsIG5vcm1hbCwgZnJhY3Rpb24pIHtcclxuICAgICAgICAgaWYgKGZyYWN0aW9uID09PSB1bmRlZmluZWQpIGZyYWN0aW9uID0gMDtcclxuICAgICAgICAgcmVzdWx0ID0gZml4dHVyZTtcclxuICAgICAgICAgcmV0dXJuIGZyYWN0aW9uO1xyXG4gICAgICB9O1xyXG4gICAgICBfX3RoaXMuUmF5Q2FzdChSYXlDYXN0T25lV3JhcHBlciwgcG9pbnQxLCBwb2ludDIpO1xyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlJheUNhc3RBbGwgPSBmdW5jdGlvbiAocG9pbnQxLCBwb2ludDIpIHtcclxuICAgICAgdmFyIF9fdGhpcyA9IHRoaXM7XHJcbiAgICAgIHZhciByZXN1bHQgPSBuZXcgVmVjdG9yKCk7XHJcblxyXG4gICAgICBmdW5jdGlvbiBSYXlDYXN0QWxsV3JhcHBlcihmaXh0dXJlLCBwb2ludCwgbm9ybWFsLCBmcmFjdGlvbikge1xyXG4gICAgICAgICBpZiAoZnJhY3Rpb24gPT09IHVuZGVmaW5lZCkgZnJhY3Rpb24gPSAwO1xyXG4gICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBmaXh0dXJlO1xyXG4gICAgICAgICByZXR1cm4gMTtcclxuICAgICAgfTtcclxuICAgICAgX190aGlzLlJheUNhc3QoUmF5Q2FzdEFsbFdyYXBwZXIsIHBvaW50MSwgcG9pbnQyKTtcclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRCb2R5TGlzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5TGlzdDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRKb2ludExpc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fam9pbnRMaXN0O1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkdldENvbnRhY3RMaXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2NvbnRhY3RMaXN0O1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLklzTG9ja2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyV29ybGQuZV9sb2NrZWQpID4gMDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5Tb2x2ZSA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciBiO1xyXG4gICAgICBmb3IgKHZhciBjb250cm9sbGVyID0gdGhpcy5tX2NvbnRyb2xsZXJMaXN0OyBjb250cm9sbGVyOyBjb250cm9sbGVyID0gY29udHJvbGxlci5tX25leHQpIHtcclxuICAgICAgICAgY29udHJvbGxlci5TdGVwKHN0ZXApO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBpc2xhbmQgPSB0aGlzLm1faXNsYW5kO1xyXG4gICAgICBpc2xhbmQuSW5pdGlhbGl6ZSh0aGlzLm1fYm9keUNvdW50LCB0aGlzLm1fY29udGFjdENvdW50LCB0aGlzLm1fam9pbnRDb3VudCwgbnVsbCwgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fY29udGFjdExpc3RlbmVyLCB0aGlzLm1fY29udGFjdFNvbHZlcik7XHJcbiAgICAgIGZvciAoYiA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgYjsgYiA9IGIubV9uZXh0KSB7XHJcbiAgICAgICAgIGIubV9mbGFncyAmPSB+YjJCb2R5LmVfaXNsYW5kRmxhZztcclxuICAgICAgfVxyXG4gICAgICBmb3IgKHZhciBjID0gdGhpcy5tX2NvbnRhY3RMaXN0OyBjOyBjID0gYy5tX25leHQpIHtcclxuICAgICAgICAgYy5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV9pc2xhbmRGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAodmFyIGogPSB0aGlzLm1fam9pbnRMaXN0OyBqOyBqID0gai5tX25leHQpIHtcclxuICAgICAgICAgai5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgc3RhY2tTaXplID0gcGFyc2VJbnQodGhpcy5tX2JvZHlDb3VudCk7XHJcbiAgICAgIHZhciBzdGFjayA9IHRoaXMuc19zdGFjaztcclxuICAgICAgZm9yICh2YXIgc2VlZCA9IHRoaXMubV9ib2R5TGlzdDsgc2VlZDsgc2VlZCA9IHNlZWQubV9uZXh0KSB7XHJcbiAgICAgICAgIGlmIChzZWVkLm1fZmxhZ3MgJiBiMkJvZHkuZV9pc2xhbmRGbGFnKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChzZWVkLklzQXdha2UoKSA9PSBmYWxzZSB8fCBzZWVkLklzQWN0aXZlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKHNlZWQuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlzbGFuZC5DbGVhcigpO1xyXG4gICAgICAgICB2YXIgc3RhY2tDb3VudCA9IDA7XHJcbiAgICAgICAgIHN0YWNrW3N0YWNrQ291bnQrK10gPSBzZWVkO1xyXG4gICAgICAgICBzZWVkLm1fZmxhZ3MgfD0gYjJCb2R5LmVfaXNsYW5kRmxhZztcclxuICAgICAgICAgd2hpbGUgKHN0YWNrQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgIGIgPSBzdGFja1stLXN0YWNrQ291bnRdO1xyXG4gICAgICAgICAgICBpc2xhbmQuQWRkQm9keShiKTtcclxuICAgICAgICAgICAgaWYgKGIuSXNBd2FrZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgIGIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBvdGhlcjtcclxuICAgICAgICAgICAgZm9yICh2YXIgY2UgPSBiLm1fY29udGFjdExpc3Q7IGNlOyBjZSA9IGNlLm5leHQpIHtcclxuICAgICAgICAgICAgICAgaWYgKGNlLmNvbnRhY3QubV9mbGFncyAmIGIyQ29udGFjdC5lX2lzbGFuZEZsYWcpIHtcclxuICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgaWYgKGNlLmNvbnRhY3QuSXNTZW5zb3IoKSA9PSB0cnVlIHx8IGNlLmNvbnRhY3QuSXNFbmFibGVkKCkgPT0gZmFsc2UgfHwgY2UuY29udGFjdC5Jc1RvdWNoaW5nKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgaXNsYW5kLkFkZENvbnRhY3QoY2UuY29udGFjdCk7XHJcbiAgICAgICAgICAgICAgIGNlLmNvbnRhY3QubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9pc2xhbmRGbGFnO1xyXG4gICAgICAgICAgICAgICBvdGhlciA9IGNlLm90aGVyO1xyXG4gICAgICAgICAgICAgICBpZiAob3RoZXIubV9mbGFncyAmIGIyQm9keS5lX2lzbGFuZEZsYWcpIHtcclxuICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgc3RhY2tbc3RhY2tDb3VudCsrXSA9IG90aGVyO1xyXG4gICAgICAgICAgICAgICBvdGhlci5tX2ZsYWdzIHw9IGIyQm9keS5lX2lzbGFuZEZsYWc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgam4gPSBiLm1fam9pbnRMaXN0OyBqbjsgam4gPSBqbi5uZXh0KSB7XHJcbiAgICAgICAgICAgICAgIGlmIChqbi5qb2ludC5tX2lzbGFuZEZsYWcgPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBvdGhlciA9IGpuLm90aGVyO1xyXG4gICAgICAgICAgICAgICBpZiAob3RoZXIuSXNBY3RpdmUoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBpc2xhbmQuQWRkSm9pbnQoam4uam9pbnQpO1xyXG4gICAgICAgICAgICAgICBqbi5qb2ludC5tX2lzbGFuZEZsYWcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICBpZiAob3RoZXIubV9mbGFncyAmIGIyQm9keS5lX2lzbGFuZEZsYWcpIHtcclxuICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgc3RhY2tbc3RhY2tDb3VudCsrXSA9IG90aGVyO1xyXG4gICAgICAgICAgICAgICBvdGhlci5tX2ZsYWdzIHw9IGIyQm9keS5lX2lzbGFuZEZsYWc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBpc2xhbmQuU29sdmUoc3RlcCwgdGhpcy5tX2dyYXZpdHksIHRoaXMubV9hbGxvd1NsZWVwKTtcclxuICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpc2xhbmQubV9ib2R5Q291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICBiID0gaXNsYW5kLm1fYm9kaWVzW2ldO1xyXG4gICAgICAgICAgICBpZiAoYi5HZXRUeXBlKCkgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcclxuICAgICAgICAgICAgICAgYi5tX2ZsYWdzICY9IH5iMkJvZHkuZV9pc2xhbmRGbGFnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgc3RhY2subGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgaWYgKCFzdGFja1tpXSkgYnJlYWs7XHJcbiAgICAgICAgIHN0YWNrW2ldID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGIgPSB0aGlzLm1fYm9keUxpc3Q7XHJcbiAgICAgIGI7IGIgPSBiLm1fbmV4dCkge1xyXG4gICAgICAgICBpZiAoYi5Jc0F3YWtlKCkgPT0gZmFsc2UgfHwgYi5Jc0FjdGl2ZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChiLkdldFR5cGUoKSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBiLlN5bmNocm9uaXplRml4dHVyZXMoKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIuRmluZE5ld0NvbnRhY3RzKCk7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuU29sdmVUT0kgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgYjtcclxuICAgICAgdmFyIGZBO1xyXG4gICAgICB2YXIgZkI7XHJcbiAgICAgIHZhciBiQTtcclxuICAgICAgdmFyIGJCO1xyXG4gICAgICB2YXIgY0VkZ2U7XHJcbiAgICAgIHZhciBqO1xyXG4gICAgICB2YXIgaXNsYW5kID0gdGhpcy5tX2lzbGFuZDtcclxuICAgICAgaXNsYW5kLkluaXRpYWxpemUodGhpcy5tX2JvZHlDb3VudCwgYjJTZXR0aW5ncy5iMl9tYXhUT0lDb250YWN0c1BlcklzbGFuZCwgYjJTZXR0aW5ncy5iMl9tYXhUT0lKb2ludHNQZXJJc2xhbmQsIG51bGwsIHRoaXMubV9jb250YWN0TWFuYWdlci5tX2NvbnRhY3RMaXN0ZW5lciwgdGhpcy5tX2NvbnRhY3RTb2x2ZXIpO1xyXG4gICAgICB2YXIgcXVldWUgPSBiMldvcmxkLnNfcXVldWU7XHJcbiAgICAgIGZvciAoYiA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgYjsgYiA9IGIubV9uZXh0KSB7XHJcbiAgICAgICAgIGIubV9mbGFncyAmPSB+YjJCb2R5LmVfaXNsYW5kRmxhZztcclxuICAgICAgICAgYi5tX3N3ZWVwLnQwID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBjO1xyXG4gICAgICBmb3IgKGMgPSB0aGlzLm1fY29udGFjdExpc3Q7XHJcbiAgICAgIGM7IGMgPSBjLm1fbmV4dCkge1xyXG4gICAgICAgICBjLm1fZmxhZ3MgJj0gfiAoYjJDb250YWN0LmVfdG9pRmxhZyB8IGIyQ29udGFjdC5lX2lzbGFuZEZsYWcpO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaiA9IHRoaXMubV9qb2ludExpc3Q7XHJcbiAgICAgIGo7IGogPSBqLm1fbmV4dCkge1xyXG4gICAgICAgICBqLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoOzspIHtcclxuICAgICAgICAgdmFyIG1pbkNvbnRhY3QgPSBudWxsO1xyXG4gICAgICAgICB2YXIgbWluVE9JID0gMS4wO1xyXG4gICAgICAgICBmb3IgKGMgPSB0aGlzLm1fY29udGFjdExpc3Q7XHJcbiAgICAgICAgIGM7IGMgPSBjLm1fbmV4dCkge1xyXG4gICAgICAgICAgICBpZiAoYy5Jc1NlbnNvcigpID09IHRydWUgfHwgYy5Jc0VuYWJsZWQoKSA9PSBmYWxzZSB8fCBjLklzQ29udGludW91cygpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0b2kgPSAxLjA7XHJcbiAgICAgICAgICAgIGlmIChjLm1fZmxhZ3MgJiBiMkNvbnRhY3QuZV90b2lGbGFnKSB7XHJcbiAgICAgICAgICAgICAgIHRvaSA9IGMubV90b2k7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIGZBID0gYy5tX2ZpeHR1cmVBO1xyXG4gICAgICAgICAgICAgICBmQiA9IGMubV9maXh0dXJlQjtcclxuICAgICAgICAgICAgICAgYkEgPSBmQS5tX2JvZHk7XHJcbiAgICAgICAgICAgICAgIGJCID0gZkIubV9ib2R5O1xyXG4gICAgICAgICAgICAgICBpZiAoKGJBLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkgfHwgYkEuSXNBd2FrZSgpID09IGZhbHNlKSAmJiAoYkIuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9keW5hbWljQm9keSB8fCBiQi5Jc0F3YWtlKCkgPT0gZmFsc2UpKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIHZhciB0MCA9IGJBLm1fc3dlZXAudDA7XHJcbiAgICAgICAgICAgICAgIGlmIChiQS5tX3N3ZWVwLnQwIDwgYkIubV9zd2VlcC50MCkge1xyXG4gICAgICAgICAgICAgICAgICB0MCA9IGJCLm1fc3dlZXAudDA7XHJcbiAgICAgICAgICAgICAgICAgIGJBLm1fc3dlZXAuQWR2YW5jZSh0MCk7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgZWxzZSBpZiAoYkIubV9zd2VlcC50MCA8IGJBLm1fc3dlZXAudDApIHtcclxuICAgICAgICAgICAgICAgICAgdDAgPSBiQS5tX3N3ZWVwLnQwO1xyXG4gICAgICAgICAgICAgICAgICBiQi5tX3N3ZWVwLkFkdmFuY2UodDApO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIHRvaSA9IGMuQ29tcHV0ZVRPSShiQS5tX3N3ZWVwLCBiQi5tX3N3ZWVwKTtcclxuICAgICAgICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCgwLjAgPD0gdG9pICYmIHRvaSA8PSAxLjApO1xyXG4gICAgICAgICAgICAgICBpZiAodG9pID4gMC4wICYmIHRvaSA8IDEuMCkge1xyXG4gICAgICAgICAgICAgICAgICB0b2kgPSAoMS4wIC0gdG9pKSAqIHQwICsgdG9pO1xyXG4gICAgICAgICAgICAgICAgICBpZiAodG9pID4gMSkgdG9pID0gMTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBjLm1fdG9pID0gdG9pO1xyXG4gICAgICAgICAgICAgICBjLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfdG9pRmxhZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoTnVtYmVyLk1JTl9WQUxVRSA8IHRvaSAmJiB0b2kgPCBtaW5UT0kpIHtcclxuICAgICAgICAgICAgICAgbWluQ29udGFjdCA9IGM7XHJcbiAgICAgICAgICAgICAgIG1pblRPSSA9IHRvaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChtaW5Db250YWN0ID09IG51bGwgfHwgMS4wIC0gMTAwLjAgKiBOdW1iZXIuTUlOX1ZBTFVFIDwgbWluVE9JKSB7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGZBID0gbWluQ29udGFjdC5tX2ZpeHR1cmVBO1xyXG4gICAgICAgICBmQiA9IG1pbkNvbnRhY3QubV9maXh0dXJlQjtcclxuICAgICAgICAgYkEgPSBmQS5tX2JvZHk7XHJcbiAgICAgICAgIGJCID0gZkIubV9ib2R5O1xyXG4gICAgICAgICBiMldvcmxkLnNfYmFja3VwQS5TZXQoYkEubV9zd2VlcCk7XHJcbiAgICAgICAgIGIyV29ybGQuc19iYWNrdXBCLlNldChiQi5tX3N3ZWVwKTtcclxuICAgICAgICAgYkEuQWR2YW5jZShtaW5UT0kpO1xyXG4gICAgICAgICBiQi5BZHZhbmNlKG1pblRPSSk7XHJcbiAgICAgICAgIG1pbkNvbnRhY3QuVXBkYXRlKHRoaXMubV9jb250YWN0TWFuYWdlci5tX2NvbnRhY3RMaXN0ZW5lcik7XHJcbiAgICAgICAgIG1pbkNvbnRhY3QubV9mbGFncyAmPSB+YjJDb250YWN0LmVfdG9pRmxhZztcclxuICAgICAgICAgaWYgKG1pbkNvbnRhY3QuSXNTZW5zb3IoKSA9PSB0cnVlIHx8IG1pbkNvbnRhY3QuSXNFbmFibGVkKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgYkEubV9zd2VlcC5TZXQoYjJXb3JsZC5zX2JhY2t1cEEpO1xyXG4gICAgICAgICAgICBiQi5tX3N3ZWVwLlNldChiMldvcmxkLnNfYmFja3VwQik7XHJcbiAgICAgICAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgICAgICAgIGJCLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChtaW5Db250YWN0LklzVG91Y2hpbmcoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgc2VlZCA9IGJBO1xyXG4gICAgICAgICBpZiAoc2VlZC5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XHJcbiAgICAgICAgICAgIHNlZWQgPSBiQjtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpc2xhbmQuQ2xlYXIoKTtcclxuICAgICAgICAgdmFyIHF1ZXVlU3RhcnQgPSAwO1xyXG4gICAgICAgICB2YXIgcXVldWVTaXplID0gMDtcclxuICAgICAgICAgcXVldWVbcXVldWVTdGFydCArIHF1ZXVlU2l6ZSsrXSA9IHNlZWQ7XHJcbiAgICAgICAgIHNlZWQubV9mbGFncyB8PSBiMkJvZHkuZV9pc2xhbmRGbGFnO1xyXG4gICAgICAgICB3aGlsZSAocXVldWVTaXplID4gMCkge1xyXG4gICAgICAgICAgICBiID0gcXVldWVbcXVldWVTdGFydCsrXTtcclxuICAgICAgICAgICAgLS1xdWV1ZVNpemU7XHJcbiAgICAgICAgICAgIGlzbGFuZC5BZGRCb2R5KGIpO1xyXG4gICAgICAgICAgICBpZiAoYi5Jc0F3YWtlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgYi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYi5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoY0VkZ2UgPSBiLm1fY29udGFjdExpc3Q7XHJcbiAgICAgICAgICAgIGNFZGdlOyBjRWRnZSA9IGNFZGdlLm5leHQpIHtcclxuICAgICAgICAgICAgICAgaWYgKGlzbGFuZC5tX2NvbnRhY3RDb3VudCA9PSBpc2xhbmQubV9jb250YWN0Q2FwYWNpdHkpIHtcclxuICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgaWYgKGNFZGdlLmNvbnRhY3QubV9mbGFncyAmIGIyQ29udGFjdC5lX2lzbGFuZEZsYWcpIHtcclxuICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgaWYgKGNFZGdlLmNvbnRhY3QuSXNTZW5zb3IoKSA9PSB0cnVlIHx8IGNFZGdlLmNvbnRhY3QuSXNFbmFibGVkKCkgPT0gZmFsc2UgfHwgY0VkZ2UuY29udGFjdC5Jc1RvdWNoaW5nKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgaXNsYW5kLkFkZENvbnRhY3QoY0VkZ2UuY29udGFjdCk7XHJcbiAgICAgICAgICAgICAgIGNFZGdlLmNvbnRhY3QubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9pc2xhbmRGbGFnO1xyXG4gICAgICAgICAgICAgICB2YXIgb3RoZXIgPSBjRWRnZS5vdGhlcjtcclxuICAgICAgICAgICAgICAgaWYgKG90aGVyLm1fZmxhZ3MgJiBiMkJvZHkuZV9pc2xhbmRGbGFnKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGlmIChvdGhlci5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgb3RoZXIuQWR2YW5jZShtaW5UT0kpO1xyXG4gICAgICAgICAgICAgICAgICBvdGhlci5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBxdWV1ZVtxdWV1ZVN0YXJ0ICsgcXVldWVTaXplXSA9IG90aGVyO1xyXG4gICAgICAgICAgICAgICArK3F1ZXVlU2l6ZTtcclxuICAgICAgICAgICAgICAgb3RoZXIubV9mbGFncyB8PSBiMkJvZHkuZV9pc2xhbmRGbGFnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAodmFyIGpFZGdlID0gYi5tX2pvaW50TGlzdDsgakVkZ2U7IGpFZGdlID0gakVkZ2UubmV4dCkge1xyXG4gICAgICAgICAgICAgICBpZiAoaXNsYW5kLm1fam9pbnRDb3VudCA9PSBpc2xhbmQubV9qb2ludENhcGFjaXR5KSBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgaWYgKGpFZGdlLmpvaW50Lm1faXNsYW5kRmxhZyA9PSB0cnVlKSBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgb3RoZXIgPSBqRWRnZS5vdGhlcjtcclxuICAgICAgICAgICAgICAgaWYgKG90aGVyLklzQWN0aXZlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgaXNsYW5kLkFkZEpvaW50KGpFZGdlLmpvaW50KTtcclxuICAgICAgICAgICAgICAgakVkZ2Uuam9pbnQubV9pc2xhbmRGbGFnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgaWYgKG90aGVyLm1fZmxhZ3MgJiBiMkJvZHkuZV9pc2xhbmRGbGFnKSBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgaWYgKG90aGVyLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xyXG4gICAgICAgICAgICAgICAgICBvdGhlci5BZHZhbmNlKG1pblRPSSk7XHJcbiAgICAgICAgICAgICAgICAgIG90aGVyLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIHF1ZXVlW3F1ZXVlU3RhcnQgKyBxdWV1ZVNpemVdID0gb3RoZXI7XHJcbiAgICAgICAgICAgICAgICsrcXVldWVTaXplO1xyXG4gICAgICAgICAgICAgICBvdGhlci5tX2ZsYWdzIHw9IGIyQm9keS5lX2lzbGFuZEZsYWc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgc3ViU3RlcCA9IGIyV29ybGQuc190aW1lc3RlcDtcclxuICAgICAgICAgc3ViU3RlcC53YXJtU3RhcnRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgc3ViU3RlcC5kdCA9ICgxLjAgLSBtaW5UT0kpICogc3RlcC5kdDtcclxuICAgICAgICAgc3ViU3RlcC5pbnZfZHQgPSAxLjAgLyBzdWJTdGVwLmR0O1xyXG4gICAgICAgICBzdWJTdGVwLmR0UmF0aW8gPSAwLjA7XHJcbiAgICAgICAgIHN1YlN0ZXAudmVsb2NpdHlJdGVyYXRpb25zID0gc3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7XHJcbiAgICAgICAgIHN1YlN0ZXAucG9zaXRpb25JdGVyYXRpb25zID0gc3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnM7XHJcbiAgICAgICAgIGlzbGFuZC5Tb2x2ZVRPSShzdWJTdGVwKTtcclxuICAgICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICBpIDwgaXNsYW5kLm1fYm9keUNvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgYiA9IGlzbGFuZC5tX2JvZGllc1tpXTtcclxuICAgICAgICAgICAgYi5tX2ZsYWdzICY9IH5iMkJvZHkuZV9pc2xhbmRGbGFnO1xyXG4gICAgICAgICAgICBpZiAoYi5Jc0F3YWtlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGIuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9keW5hbWljQm9keSkge1xyXG4gICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBiLlN5bmNocm9uaXplRml4dHVyZXMoKTtcclxuICAgICAgICAgICAgZm9yIChjRWRnZSA9IGIubV9jb250YWN0TGlzdDtcclxuICAgICAgICAgICAgY0VkZ2U7IGNFZGdlID0gY0VkZ2UubmV4dCkge1xyXG4gICAgICAgICAgICAgICBjRWRnZS5jb250YWN0Lm1fZmxhZ3MgJj0gfmIyQ29udGFjdC5lX3RvaUZsYWc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICBpIDwgaXNsYW5kLm1fY29udGFjdENvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgYyA9IGlzbGFuZC5tX2NvbnRhY3RzW2ldO1xyXG4gICAgICAgICAgICBjLm1fZmxhZ3MgJj0gfiAoYjJDb250YWN0LmVfdG9pRmxhZyB8IGIyQ29udGFjdC5lX2lzbGFuZEZsYWcpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgICAgIGkgPCBpc2xhbmQubV9qb2ludENvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgaiA9IGlzbGFuZC5tX2pvaW50c1tpXTtcclxuICAgICAgICAgICAgai5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIuRmluZE5ld0NvbnRhY3RzKCk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5EcmF3Sm9pbnQgPSBmdW5jdGlvbiAoam9pbnQpIHtcclxuICAgICAgdmFyIGIxID0gam9pbnQuR2V0Qm9keUEoKTtcclxuICAgICAgdmFyIGIyID0gam9pbnQuR2V0Qm9keUIoKTtcclxuICAgICAgdmFyIHhmMSA9IGIxLm1feGY7XHJcbiAgICAgIHZhciB4ZjIgPSBiMi5tX3hmO1xyXG4gICAgICB2YXIgeDEgPSB4ZjEucG9zaXRpb247XHJcbiAgICAgIHZhciB4MiA9IHhmMi5wb3NpdGlvbjtcclxuICAgICAgdmFyIHAxID0gam9pbnQuR2V0QW5jaG9yQSgpO1xyXG4gICAgICB2YXIgcDIgPSBqb2ludC5HZXRBbmNob3JCKCk7XHJcbiAgICAgIHZhciBjb2xvciA9IGIyV29ybGQuc19qb2ludENvbG9yO1xyXG4gICAgICBzd2l0Y2ggKGpvaW50Lm1fdHlwZSkge1xyXG4gICAgICBjYXNlIGIySm9pbnQuZV9kaXN0YW5jZUpvaW50OlxyXG4gICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHAxLCBwMiwgY29sb3IpO1xyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMkpvaW50LmVfcHVsbGV5Sm9pbnQ6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIHB1bGxleSA9ICgoam9pbnQgaW5zdGFuY2VvZiBiMlB1bGxleUpvaW50ID8gam9pbnQgOiBudWxsKSk7XHJcbiAgICAgICAgICAgIHZhciBzMSA9IHB1bGxleS5HZXRHcm91bmRBbmNob3JBKCk7XHJcbiAgICAgICAgICAgIHZhciBzMiA9IHB1bGxleS5HZXRHcm91bmRBbmNob3JCKCk7XHJcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQoczEsIHAxLCBjb2xvcik7XHJcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQoczIsIHAyLCBjb2xvcik7XHJcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQoczEsIHMyLCBjb2xvcik7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX21vdXNlSm9pbnQ6XHJcbiAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQocDEsIHAyLCBjb2xvcik7XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgICBpZiAoYjEgIT0gdGhpcy5tX2dyb3VuZEJvZHkpIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQoeDEsIHAxLCBjb2xvcik7XHJcbiAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQocDEsIHAyLCBjb2xvcik7XHJcbiAgICAgICAgIGlmIChiMiAhPSB0aGlzLm1fZ3JvdW5kQm9keSkgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U2VnbWVudCh4MiwgcDIsIGNvbG9yKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkRyYXdTaGFwZSA9IGZ1bmN0aW9uIChzaGFwZSwgeGYsIGNvbG9yKSB7XHJcbiAgICAgIHN3aXRjaCAoc2hhcGUubV90eXBlKSB7XHJcbiAgICAgIGNhc2UgYjJTaGFwZS5lX2NpcmNsZVNoYXBlOlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBjaXJjbGUgPSAoKHNoYXBlIGluc3RhbmNlb2YgYjJDaXJjbGVTaGFwZSA/IHNoYXBlIDogbnVsbCkpO1xyXG4gICAgICAgICAgICB2YXIgY2VudGVyID0gYjJNYXRoLk11bFgoeGYsIGNpcmNsZS5tX3ApO1xyXG4gICAgICAgICAgICB2YXIgcmFkaXVzID0gY2lyY2xlLm1fcmFkaXVzO1xyXG4gICAgICAgICAgICB2YXIgYXhpcyA9IHhmLlIuY29sMTtcclxuICAgICAgICAgICAgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U29saWRDaXJjbGUoY2VudGVyLCByYWRpdXMsIGF4aXMsIGNvbG9yKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMlNoYXBlLmVfcG9seWdvblNoYXBlOlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBpID0gMDtcclxuICAgICAgICAgICAgdmFyIHBvbHkgPSAoKHNoYXBlIGluc3RhbmNlb2YgYjJQb2x5Z29uU2hhcGUgPyBzaGFwZSA6IG51bGwpKTtcclxuICAgICAgICAgICAgdmFyIHZlcnRleENvdW50ID0gcGFyc2VJbnQocG9seS5HZXRWZXJ0ZXhDb3VudCgpKTtcclxuICAgICAgICAgICAgdmFyIGxvY2FsVmVydGljZXMgPSBwb2x5LkdldFZlcnRpY2VzKCk7XHJcbiAgICAgICAgICAgIHZhciB2ZXJ0aWNlcyA9IG5ldyBWZWN0b3IodmVydGV4Q291bnQpO1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICAgICBpIDwgdmVydGV4Q291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICB2ZXJ0aWNlc1tpXSA9IGIyTWF0aC5NdWxYKHhmLCBsb2NhbFZlcnRpY2VzW2ldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTb2xpZFBvbHlnb24odmVydGljZXMsIHZlcnRleENvdW50LCBjb2xvcik7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJTaGFwZS5lX2VkZ2VTaGFwZTpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgZWRnZSA9IChzaGFwZSBpbnN0YW5jZW9mIGIyRWRnZVNoYXBlID8gc2hhcGUgOiBudWxsKTtcclxuICAgICAgICAgICAgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U2VnbWVudChiMk1hdGguTXVsWCh4ZiwgZWRnZS5HZXRWZXJ0ZXgxKCkpLCBiMk1hdGguTXVsWCh4ZiwgZWRnZS5HZXRWZXJ0ZXgyKCkpLCBjb2xvcik7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5zX3RpbWVzdGVwMiA9IG5ldyBiMlRpbWVTdGVwKCk7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyV29ybGQuc194ZiA9IG5ldyBiMlRyYW5zZm9ybSgpO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMldvcmxkLnNfYmFja3VwQSA9IG5ldyBiMlN3ZWVwKCk7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyV29ybGQuc19iYWNrdXBCID0gbmV3IGIyU3dlZXAoKTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5zX3RpbWVzdGVwID0gbmV3IGIyVGltZVN0ZXAoKTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5zX3F1ZXVlID0gbmV3IFZlY3RvcigpO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMldvcmxkLnNfam9pbnRDb2xvciA9IG5ldyBiMkNvbG9yKDAuNSwgMC44LCAwLjgpO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMldvcmxkLmVfbmV3Rml4dHVyZSA9IDB4MDAwMTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5lX2xvY2tlZCA9IDB4MDAwMjtcclxuICAgfSk7XHJcbn0pKCk7XHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgIHZhciBiMkNpcmNsZVNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkNpcmNsZVNoYXBlLFxyXG4gICAgICBiMkVkZ2VDaGFpbkRlZiA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlQ2hhaW5EZWYsXHJcbiAgICAgIGIyRWRnZVNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VTaGFwZSxcclxuICAgICAgYjJNYXNzRGF0YSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJNYXNzRGF0YSxcclxuICAgICAgYjJQb2x5Z29uU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyUG9seWdvblNoYXBlLFxyXG4gICAgICBiMlNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLFxyXG4gICAgICBiMkNpcmNsZUNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNpcmNsZUNvbnRhY3QsXHJcbiAgICAgIGIyQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdCxcclxuICAgICAgYjJDb250YWN0Q29uc3RyYWludCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdENvbnN0cmFpbnQsXHJcbiAgICAgIGIyQ29udGFjdENvbnN0cmFpbnRQb2ludCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdENvbnN0cmFpbnRQb2ludCxcclxuICAgICAgYjJDb250YWN0RWRnZSA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdEVkZ2UsXHJcbiAgICAgIGIyQ29udGFjdEZhY3RvcnkgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RGYWN0b3J5LFxyXG4gICAgICBiMkNvbnRhY3RSZWdpc3RlciA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFJlZ2lzdGVyLFxyXG4gICAgICBiMkNvbnRhY3RSZXN1bHQgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RSZXN1bHQsXHJcbiAgICAgIGIyQ29udGFjdFNvbHZlciA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFNvbHZlcixcclxuICAgICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyRWRnZUFuZENpcmNsZUNvbnRhY3QsXHJcbiAgICAgIGIyTnVsbENvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMk51bGxDb250YWN0LFxyXG4gICAgICBiMlBvbHlBbmRDaXJjbGVDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCxcclxuICAgICAgYjJQb2x5QW5kRWRnZUNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvbHlBbmRFZGdlQ29udGFjdCxcclxuICAgICAgYjJQb2x5Z29uQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9seWdvbkNvbnRhY3QsXHJcbiAgICAgIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCxcclxuICAgICAgYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5LFxyXG4gICAgICBiMkJvZHlEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkJvZHlEZWYsXHJcbiAgICAgIGIyQ29udGFjdEZpbHRlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEZpbHRlcixcclxuICAgICAgYjJDb250YWN0SW1wdWxzZSA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEltcHVsc2UsXHJcbiAgICAgIGIyQ29udGFjdExpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0TGlzdGVuZXIsXHJcbiAgICAgIGIyQ29udGFjdE1hbmFnZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RNYW5hZ2VyLFxyXG4gICAgICBiMkRlYnVnRHJhdyA9IEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LFxyXG4gICAgICBiMkRlc3RydWN0aW9uTGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkRlc3RydWN0aW9uTGlzdGVuZXIsXHJcbiAgICAgIGIyRmlsdGVyRGF0YSA9IEJveDJELkR5bmFtaWNzLmIyRmlsdGVyRGF0YSxcclxuICAgICAgYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlLFxyXG4gICAgICBiMkZpeHR1cmVEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkZpeHR1cmVEZWYsXHJcbiAgICAgIGIySXNsYW5kID0gQm94MkQuRHluYW1pY3MuYjJJc2xhbmQsXHJcbiAgICAgIGIyVGltZVN0ZXAgPSBCb3gyRC5EeW5hbWljcy5iMlRpbWVTdGVwLFxyXG4gICAgICBiMldvcmxkID0gQm94MkQuRHluYW1pY3MuYjJXb3JsZCxcclxuICAgICAgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxyXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXHJcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcclxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXHJcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxyXG4gICAgICBiMk1hdGggPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGgsXHJcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxyXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxyXG4gICAgICBiMlZlYzIgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIsXHJcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyxcclxuICAgICAgYjJBQUJCID0gQm94MkQuQ29sbGlzaW9uLmIyQUFCQixcclxuICAgICAgYjJCb3VuZCA9IEJveDJELkNvbGxpc2lvbi5iMkJvdW5kLFxyXG4gICAgICBiMkJvdW5kVmFsdWVzID0gQm94MkQuQ29sbGlzaW9uLmIyQm91bmRWYWx1ZXMsXHJcbiAgICAgIGIyQ29sbGlzaW9uID0gQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLFxyXG4gICAgICBiMkNvbnRhY3RJRCA9IEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RJRCxcclxuICAgICAgYjJDb250YWN0UG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0UG9pbnQsXHJcbiAgICAgIGIyRGlzdGFuY2UgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZSxcclxuICAgICAgYjJEaXN0YW5jZUlucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VJbnB1dCxcclxuICAgICAgYjJEaXN0YW5jZU91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlT3V0cHV0LFxyXG4gICAgICBiMkRpc3RhbmNlUHJveHkgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZVByb3h5LFxyXG4gICAgICBiMkR5bmFtaWNUcmVlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWUsXHJcbiAgICAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLFxyXG4gICAgICBiMkR5bmFtaWNUcmVlTm9kZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlTm9kZSxcclxuICAgICAgYjJEeW5hbWljVHJlZVBhaXIgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZVBhaXIsXHJcbiAgICAgIGIyTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZCxcclxuICAgICAgYjJNYW5pZm9sZFBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGRQb2ludCxcclxuICAgICAgYjJQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMlBvaW50LFxyXG4gICAgICBiMlJheUNhc3RJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RJbnB1dCxcclxuICAgICAgYjJSYXlDYXN0T3V0cHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdE91dHB1dCxcclxuICAgICAgYjJTZWdtZW50ID0gQm94MkQuQ29sbGlzaW9uLmIyU2VnbWVudCxcclxuICAgICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24gPSBCb3gyRC5Db2xsaXNpb24uYjJTZXBhcmF0aW9uRnVuY3Rpb24sXHJcbiAgICAgIGIyU2ltcGxleCA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXgsXHJcbiAgICAgIGIyU2ltcGxleENhY2hlID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleENhY2hlLFxyXG4gICAgICBiMlNpbXBsZXhWZXJ0ZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4VmVydGV4LFxyXG4gICAgICBiMlRpbWVPZkltcGFjdCA9IEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdCxcclxuICAgICAgYjJUT0lJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlRPSUlucHV0LFxyXG4gICAgICBiMldvcmxkTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJXb3JsZE1hbmlmb2xkLFxyXG4gICAgICBDbGlwVmVydGV4ID0gQm94MkQuQ29sbGlzaW9uLkNsaXBWZXJ0ZXgsXHJcbiAgICAgIEZlYXR1cmVzID0gQm94MkQuQ29sbGlzaW9uLkZlYXR1cmVzLFxyXG4gICAgICBJQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5JQnJvYWRQaGFzZTtcclxuXHJcbiAgIEJveDJELmluaGVyaXQoYjJDaXJjbGVDb250YWN0LCBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QpO1xyXG4gICBiMkNpcmNsZUNvbnRhY3QucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QucHJvdG90eXBlO1xyXG4gICBiMkNpcmNsZUNvbnRhY3QuYjJDaXJjbGVDb250YWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuYjJDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIGIyQ2lyY2xlQ29udGFjdC5DcmVhdGUgPSBmdW5jdGlvbiAoYWxsb2NhdG9yKSB7XHJcbiAgICAgIHJldHVybiBuZXcgYjJDaXJjbGVDb250YWN0KCk7XHJcbiAgIH1cclxuICAgYjJDaXJjbGVDb250YWN0LkRlc3Ryb3kgPSBmdW5jdGlvbiAoY29udGFjdCwgYWxsb2NhdG9yKSB7fVxyXG4gICBiMkNpcmNsZUNvbnRhY3QucHJvdG90eXBlLlJlc2V0ID0gZnVuY3Rpb24gKGZpeHR1cmVBLCBmaXh0dXJlQikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuUmVzZXQuY2FsbCh0aGlzLCBmaXh0dXJlQSwgZml4dHVyZUIpO1xyXG4gICB9XHJcbiAgIGIyQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuRXZhbHVhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9maXh0dXJlQS5HZXRCb2R5KCk7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9maXh0dXJlQi5HZXRCb2R5KCk7XHJcbiAgICAgIGIyQ29sbGlzaW9uLkNvbGxpZGVDaXJjbGVzKHRoaXMubV9tYW5pZm9sZCwgKHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJDaXJjbGVTaGFwZSA/IHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpIDogbnVsbCksIGJBLm1feGYsICh0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyQ2lyY2xlU2hhcGUgPyB0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKSA6IG51bGwpLCBiQi5tX3hmKTtcclxuICAgfVxyXG4gICBiMkNvbnRhY3QuYjJDb250YWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fbm9kZUEgPSBuZXcgYjJDb250YWN0RWRnZSgpO1xyXG4gICAgICB0aGlzLm1fbm9kZUIgPSBuZXcgYjJDb250YWN0RWRnZSgpO1xyXG4gICAgICB0aGlzLm1fbWFuaWZvbGQgPSBuZXcgYjJNYW5pZm9sZCgpO1xyXG4gICAgICB0aGlzLm1fb2xkTWFuaWZvbGQgPSBuZXcgYjJNYW5pZm9sZCgpO1xyXG4gICB9O1xyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLkdldE1hbmlmb2xkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX21hbmlmb2xkO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuR2V0V29ybGRNYW5pZm9sZCA9IGZ1bmN0aW9uICh3b3JsZE1hbmlmb2xkKSB7XHJcbiAgICAgIHZhciBib2R5QSA9IHRoaXMubV9maXh0dXJlQS5HZXRCb2R5KCk7XHJcbiAgICAgIHZhciBib2R5QiA9IHRoaXMubV9maXh0dXJlQi5HZXRCb2R5KCk7XHJcbiAgICAgIHZhciBzaGFwZUEgPSB0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKTtcclxuICAgICAgdmFyIHNoYXBlQiA9IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpO1xyXG4gICAgICB3b3JsZE1hbmlmb2xkLkluaXRpYWxpemUodGhpcy5tX21hbmlmb2xkLCBib2R5QS5HZXRUcmFuc2Zvcm0oKSwgc2hhcGVBLm1fcmFkaXVzLCBib2R5Qi5HZXRUcmFuc2Zvcm0oKSwgc2hhcGVCLm1fcmFkaXVzKTtcclxuICAgfVxyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLklzVG91Y2hpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJDb250YWN0LmVfdG91Y2hpbmdGbGFnKSA9PSBiMkNvbnRhY3QuZV90b3VjaGluZ0ZsYWc7XHJcbiAgIH1cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5Jc0NvbnRpbnVvdXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJDb250YWN0LmVfY29udGludW91c0ZsYWcpID09IGIyQ29udGFjdC5lX2NvbnRpbnVvdXNGbGFnO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuU2V0U2Vuc29yID0gZnVuY3Rpb24gKHNlbnNvcikge1xyXG4gICAgICBpZiAoc2Vuc29yKSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9zZW5zb3JGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyQ29udGFjdC5lX3NlbnNvckZsYWc7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLklzU2Vuc29yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX3NlbnNvckZsYWcpID09IGIyQ29udGFjdC5lX3NlbnNvckZsYWc7XHJcbiAgIH1cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5TZXRFbmFibGVkID0gZnVuY3Rpb24gKGZsYWcpIHtcclxuICAgICAgaWYgKGZsYWcpIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQ29udGFjdC5lX2VuYWJsZWRGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyQ29udGFjdC5lX2VuYWJsZWRGbGFnO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5Jc0VuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJDb250YWN0LmVfZW5hYmxlZEZsYWcpID09IGIyQ29udGFjdC5lX2VuYWJsZWRGbGFnO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuR2V0TmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuR2V0Rml4dHVyZUEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZml4dHVyZUE7XHJcbiAgIH1cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5HZXRGaXh0dXJlQiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9maXh0dXJlQjtcclxuICAgfVxyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLkZsYWdGb3JGaWx0ZXJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9maWx0ZXJGbGFnO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuYjJDb250YWN0ID0gZnVuY3Rpb24gKCkge31cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5SZXNldCA9IGZ1bmN0aW9uIChmaXh0dXJlQSwgZml4dHVyZUIpIHtcclxuICAgICAgaWYgKGZpeHR1cmVBID09PSB1bmRlZmluZWQpIGZpeHR1cmVBID0gbnVsbDtcclxuICAgICAgaWYgKGZpeHR1cmVCID09PSB1bmRlZmluZWQpIGZpeHR1cmVCID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2ZsYWdzID0gYjJDb250YWN0LmVfZW5hYmxlZEZsYWc7XHJcbiAgICAgIGlmICghZml4dHVyZUEgfHwgIWZpeHR1cmVCKSB7XHJcbiAgICAgICAgIHRoaXMubV9maXh0dXJlQSA9IG51bGw7XHJcbiAgICAgICAgIHRoaXMubV9maXh0dXJlQiA9IG51bGw7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZml4dHVyZUEuSXNTZW5zb3IoKSB8fCBmaXh0dXJlQi5Jc1NlbnNvcigpKSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9zZW5zb3JGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLkdldEJvZHkoKTtcclxuICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIuR2V0Qm9keSgpO1xyXG4gICAgICBpZiAoYm9keUEuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9keW5hbWljQm9keSB8fCBib2R5QS5Jc0J1bGxldCgpIHx8IGJvZHlCLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkgfHwgYm9keUIuSXNCdWxsZXQoKSkge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfY29udGludW91c0ZsYWc7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2ZpeHR1cmVBID0gZml4dHVyZUE7XHJcbiAgICAgIHRoaXMubV9maXh0dXJlQiA9IGZpeHR1cmVCO1xyXG4gICAgICB0aGlzLm1fbWFuaWZvbGQubV9wb2ludENvdW50ID0gMDtcclxuICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ub2RlQS5jb250YWN0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX25vZGVBLnByZXYgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbm9kZUEubmV4dCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ub2RlQS5vdGhlciA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ub2RlQi5jb250YWN0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX25vZGVCLnByZXYgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbm9kZUIubmV4dCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ub2RlQi5vdGhlciA9IG51bGw7XHJcbiAgIH1cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5VcGRhdGUgPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcclxuICAgICAgdmFyIHRNYW5pZm9sZCA9IHRoaXMubV9vbGRNYW5pZm9sZDtcclxuICAgICAgdGhpcy5tX29sZE1hbmlmb2xkID0gdGhpcy5tX21hbmlmb2xkO1xyXG4gICAgICB0aGlzLm1fbWFuaWZvbGQgPSB0TWFuaWZvbGQ7XHJcbiAgICAgIHRoaXMubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9lbmFibGVkRmxhZztcclxuICAgICAgdmFyIHRvdWNoaW5nID0gZmFsc2U7XHJcbiAgICAgIHZhciB3YXNUb3VjaGluZyA9ICh0aGlzLm1fZmxhZ3MgJiBiMkNvbnRhY3QuZV90b3VjaGluZ0ZsYWcpID09IGIyQ29udGFjdC5lX3RvdWNoaW5nRmxhZztcclxuICAgICAgdmFyIGJvZHlBID0gdGhpcy5tX2ZpeHR1cmVBLm1fYm9keTtcclxuICAgICAgdmFyIGJvZHlCID0gdGhpcy5tX2ZpeHR1cmVCLm1fYm9keTtcclxuICAgICAgdmFyIGFhYmJPdmVybGFwID0gdGhpcy5tX2ZpeHR1cmVBLm1fYWFiYi5UZXN0T3ZlcmxhcCh0aGlzLm1fZml4dHVyZUIubV9hYWJiKTtcclxuICAgICAgaWYgKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX3NlbnNvckZsYWcpIHtcclxuICAgICAgICAgaWYgKGFhYmJPdmVybGFwKSB7XHJcbiAgICAgICAgICAgIHZhciBzaGFwZUEgPSB0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKTtcclxuICAgICAgICAgICAgdmFyIHNoYXBlQiA9IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpO1xyXG4gICAgICAgICAgICB2YXIgeGZBID0gYm9keUEuR2V0VHJhbnNmb3JtKCk7XHJcbiAgICAgICAgICAgIHZhciB4ZkIgPSBib2R5Qi5HZXRUcmFuc2Zvcm0oKTtcclxuICAgICAgICAgICAgdG91Y2hpbmcgPSBiMlNoYXBlLlRlc3RPdmVybGFwKHNoYXBlQSwgeGZBLCBzaGFwZUIsIHhmQik7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdGhpcy5tX21hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIGlmIChib2R5QS5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5IHx8IGJvZHlBLklzQnVsbGV0KCkgfHwgYm9keUIuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9keW5hbWljQm9keSB8fCBib2R5Qi5Jc0J1bGxldCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9jb250aW51b3VzRmxhZztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV9jb250aW51b3VzRmxhZztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAoYWFiYk92ZXJsYXApIHtcclxuICAgICAgICAgICAgdGhpcy5FdmFsdWF0ZSgpO1xyXG4gICAgICAgICAgICB0b3VjaGluZyA9IHRoaXMubV9tYW5pZm9sZC5tX3BvaW50Q291bnQgPiAwO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9tYW5pZm9sZC5tX3BvaW50Q291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICB2YXIgbXAyID0gdGhpcy5tX21hbmlmb2xkLm1fcG9pbnRzW2ldO1xyXG4gICAgICAgICAgICAgICBtcDIubV9ub3JtYWxJbXB1bHNlID0gMC4wO1xyXG4gICAgICAgICAgICAgICBtcDIubV90YW5nZW50SW1wdWxzZSA9IDAuMDtcclxuICAgICAgICAgICAgICAgdmFyIGlkMiA9IG1wMi5tX2lkO1xyXG4gICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubV9vbGRNYW5pZm9sZC5tX3BvaW50Q291bnQ7ICsraikge1xyXG4gICAgICAgICAgICAgICAgICB2YXIgbXAxID0gdGhpcy5tX29sZE1hbmlmb2xkLm1fcG9pbnRzW2pdO1xyXG4gICAgICAgICAgICAgICAgICBpZiAobXAxLm1faWQua2V5ID09IGlkMi5rZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgbXAyLm1fbm9ybWFsSW1wdWxzZSA9IG1wMS5tX25vcm1hbEltcHVsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgIG1wMi5tX3RhbmdlbnRJbXB1bHNlID0gbXAxLm1fdGFuZ2VudEltcHVsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1fbWFuaWZvbGQubV9wb2ludENvdW50ID0gMDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAodG91Y2hpbmcgIT0gd2FzVG91Y2hpbmcpIHtcclxuICAgICAgICAgICAgYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgICAgICAgIGJvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRvdWNoaW5nKSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkNvbnRhY3QuZV90b3VjaGluZ0ZsYWc7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyAmPSB+YjJDb250YWN0LmVfdG91Y2hpbmdGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh3YXNUb3VjaGluZyA9PSBmYWxzZSAmJiB0b3VjaGluZyA9PSB0cnVlKSB7XHJcbiAgICAgICAgIGxpc3RlbmVyLkJlZ2luQ29udGFjdCh0aGlzKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAod2FzVG91Y2hpbmcgPT0gdHJ1ZSAmJiB0b3VjaGluZyA9PSBmYWxzZSkge1xyXG4gICAgICAgICBsaXN0ZW5lci5FbmRDb250YWN0KHRoaXMpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICgodGhpcy5tX2ZsYWdzICYgYjJDb250YWN0LmVfc2Vuc29yRmxhZykgPT0gMCkge1xyXG4gICAgICAgICBsaXN0ZW5lci5QcmVTb2x2ZSh0aGlzLCB0aGlzLm1fb2xkTWFuaWZvbGQpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICgpIHt9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuQ29tcHV0ZVRPSSA9IGZ1bmN0aW9uIChzd2VlcEEsIHN3ZWVwQikge1xyXG4gICAgICBiMkNvbnRhY3Quc19pbnB1dC5wcm94eUEuU2V0KHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpKTtcclxuICAgICAgYjJDb250YWN0LnNfaW5wdXQucHJveHlCLlNldCh0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKSk7XHJcbiAgICAgIGIyQ29udGFjdC5zX2lucHV0LnN3ZWVwQSA9IHN3ZWVwQTtcclxuICAgICAgYjJDb250YWN0LnNfaW5wdXQuc3dlZXBCID0gc3dlZXBCO1xyXG4gICAgICBiMkNvbnRhY3Quc19pbnB1dC50b2xlcmFuY2UgPSBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3A7XHJcbiAgICAgIHJldHVybiBiMlRpbWVPZkltcGFjdC5UaW1lT2ZJbXBhY3QoYjJDb250YWN0LnNfaW5wdXQpO1xyXG4gICB9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuZV9zZW5zb3JGbGFnID0gMHgwMDAxO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuZV9jb250aW51b3VzRmxhZyA9IDB4MDAwMjtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfaXNsYW5kRmxhZyA9IDB4MDAwNDtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfdG9pRmxhZyA9IDB4MDAwODtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfdG91Y2hpbmdGbGFnID0gMHgwMDEwO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuZV9lbmFibGVkRmxhZyA9IDB4MDAyMDtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfZmlsdGVyRmxhZyA9IDB4MDA0MDtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LnNfaW5wdXQgPSBuZXcgYjJUT0lJbnB1dCgpO1xyXG4gICB9KTtcclxuICAgYjJDb250YWN0Q29uc3RyYWludC5iMkNvbnRhY3RDb25zdHJhaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmxvY2FsUGxhbmVOb3JtYWwgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubG9jYWxQb2ludCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5ub3JtYWwgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubm9ybWFsTWFzcyA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIHRoaXMuSyA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgIH07XHJcbiAgIGIyQ29udGFjdENvbnN0cmFpbnQucHJvdG90eXBlLmIyQ29udGFjdENvbnN0cmFpbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMucG9pbnRzID0gbmV3IFZlY3RvcihiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzKTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzOyBpKyspIHtcclxuICAgICAgICAgdGhpcy5wb2ludHNbaV0gPSBuZXcgYjJDb250YWN0Q29uc3RyYWludFBvaW50KCk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkNvbnRhY3RDb25zdHJhaW50UG9pbnQuYjJDb250YWN0Q29uc3RyYWludFBvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmxvY2FsUG9pbnQgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMuckEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMuckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyQ29udGFjdEVkZ2UuYjJDb250YWN0RWRnZSA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkNvbnRhY3RGYWN0b3J5LmIyQ29udGFjdEZhY3RvcnkgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJDb250YWN0RmFjdG9yeS5wcm90b3R5cGUuYjJDb250YWN0RmFjdG9yeSA9IGZ1bmN0aW9uIChhbGxvY2F0b3IpIHtcclxuICAgICAgdGhpcy5tX2FsbG9jYXRvciA9IGFsbG9jYXRvcjtcclxuICAgICAgdGhpcy5Jbml0aWFsaXplUmVnaXN0ZXJzKCk7XHJcbiAgIH1cclxuICAgYjJDb250YWN0RmFjdG9yeS5wcm90b3R5cGUuQWRkVHlwZSA9IGZ1bmN0aW9uIChjcmVhdGVGY24sIGRlc3Ryb3lGY24sIHR5cGUxLCB0eXBlMikge1xyXG4gICAgICBpZiAodHlwZTEgPT09IHVuZGVmaW5lZCkgdHlwZTEgPSAwO1xyXG4gICAgICBpZiAodHlwZTIgPT09IHVuZGVmaW5lZCkgdHlwZTIgPSAwO1xyXG4gICAgICB0aGlzLm1fcmVnaXN0ZXJzW3R5cGUxXVt0eXBlMl0uY3JlYXRlRmNuID0gY3JlYXRlRmNuO1xyXG4gICAgICB0aGlzLm1fcmVnaXN0ZXJzW3R5cGUxXVt0eXBlMl0uZGVzdHJveUZjbiA9IGRlc3Ryb3lGY247XHJcbiAgICAgIHRoaXMubV9yZWdpc3RlcnNbdHlwZTFdW3R5cGUyXS5wcmltYXJ5ID0gdHJ1ZTtcclxuICAgICAgaWYgKHR5cGUxICE9IHR5cGUyKSB7XHJcbiAgICAgICAgIHRoaXMubV9yZWdpc3RlcnNbdHlwZTJdW3R5cGUxXS5jcmVhdGVGY24gPSBjcmVhdGVGY247XHJcbiAgICAgICAgIHRoaXMubV9yZWdpc3RlcnNbdHlwZTJdW3R5cGUxXS5kZXN0cm95RmNuID0gZGVzdHJveUZjbjtcclxuICAgICAgICAgdGhpcy5tX3JlZ2lzdGVyc1t0eXBlMl1bdHlwZTFdLnByaW1hcnkgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQ29udGFjdEZhY3RvcnkucHJvdG90eXBlLkluaXRpYWxpemVSZWdpc3RlcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9yZWdpc3RlcnMgPSBuZXcgVmVjdG9yKGIyU2hhcGUuZV9zaGFwZVR5cGVDb3VudCk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjJTaGFwZS5lX3NoYXBlVHlwZUNvdW50OyBpKyspIHtcclxuICAgICAgICAgdGhpcy5tX3JlZ2lzdGVyc1tpXSA9IG5ldyBWZWN0b3IoYjJTaGFwZS5lX3NoYXBlVHlwZUNvdW50KTtcclxuICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiMlNoYXBlLmVfc2hhcGVUeXBlQ291bnQ7IGorKykge1xyXG4gICAgICAgICAgICB0aGlzLm1fcmVnaXN0ZXJzW2ldW2pdID0gbmV3IGIyQ29udGFjdFJlZ2lzdGVyKCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLkFkZFR5cGUoYjJDaXJjbGVDb250YWN0LkNyZWF0ZSwgYjJDaXJjbGVDb250YWN0LkRlc3Ryb3ksIGIyU2hhcGUuZV9jaXJjbGVTaGFwZSwgYjJTaGFwZS5lX2NpcmNsZVNoYXBlKTtcclxuICAgICAgdGhpcy5BZGRUeXBlKGIyUG9seUFuZENpcmNsZUNvbnRhY3QuQ3JlYXRlLCBiMlBvbHlBbmRDaXJjbGVDb250YWN0LkRlc3Ryb3ksIGIyU2hhcGUuZV9wb2x5Z29uU2hhcGUsIGIyU2hhcGUuZV9jaXJjbGVTaGFwZSk7XHJcbiAgICAgIHRoaXMuQWRkVHlwZShiMlBvbHlnb25Db250YWN0LkNyZWF0ZSwgYjJQb2x5Z29uQ29udGFjdC5EZXN0cm95LCBiMlNoYXBlLmVfcG9seWdvblNoYXBlLCBiMlNoYXBlLmVfcG9seWdvblNoYXBlKTtcclxuICAgICAgdGhpcy5BZGRUeXBlKGIyRWRnZUFuZENpcmNsZUNvbnRhY3QuQ3JlYXRlLCBiMkVkZ2VBbmRDaXJjbGVDb250YWN0LkRlc3Ryb3ksIGIyU2hhcGUuZV9lZGdlU2hhcGUsIGIyU2hhcGUuZV9jaXJjbGVTaGFwZSk7XHJcbiAgICAgIHRoaXMuQWRkVHlwZShiMlBvbHlBbmRFZGdlQ29udGFjdC5DcmVhdGUsIGIyUG9seUFuZEVkZ2VDb250YWN0LkRlc3Ryb3ksIGIyU2hhcGUuZV9wb2x5Z29uU2hhcGUsIGIyU2hhcGUuZV9lZGdlU2hhcGUpO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdEZhY3RvcnkucHJvdG90eXBlLkNyZWF0ZSA9IGZ1bmN0aW9uIChmaXh0dXJlQSwgZml4dHVyZUIpIHtcclxuICAgICAgdmFyIHR5cGUxID0gcGFyc2VJbnQoZml4dHVyZUEuR2V0VHlwZSgpKTtcclxuICAgICAgdmFyIHR5cGUyID0gcGFyc2VJbnQoZml4dHVyZUIuR2V0VHlwZSgpKTtcclxuICAgICAgdmFyIHJlZyA9IHRoaXMubV9yZWdpc3RlcnNbdHlwZTFdW3R5cGUyXTtcclxuICAgICAgdmFyIGM7XHJcbiAgICAgIGlmIChyZWcucG9vbCkge1xyXG4gICAgICAgICBjID0gcmVnLnBvb2w7XHJcbiAgICAgICAgIHJlZy5wb29sID0gYy5tX25leHQ7XHJcbiAgICAgICAgIHJlZy5wb29sQ291bnQtLTtcclxuICAgICAgICAgYy5SZXNldChmaXh0dXJlQSwgZml4dHVyZUIpO1xyXG4gICAgICAgICByZXR1cm4gYztcclxuICAgICAgfVxyXG4gICAgICB2YXIgY3JlYXRlRmNuID0gcmVnLmNyZWF0ZUZjbjtcclxuICAgICAgaWYgKGNyZWF0ZUZjbiAhPSBudWxsKSB7XHJcbiAgICAgICAgIGlmIChyZWcucHJpbWFyeSkge1xyXG4gICAgICAgICAgICBjID0gY3JlYXRlRmNuKHRoaXMubV9hbGxvY2F0b3IpO1xyXG4gICAgICAgICAgICBjLlJlc2V0KGZpeHR1cmVBLCBmaXh0dXJlQik7XHJcbiAgICAgICAgICAgIHJldHVybiBjO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjID0gY3JlYXRlRmNuKHRoaXMubV9hbGxvY2F0b3IpO1xyXG4gICAgICAgICAgICBjLlJlc2V0KGZpeHR1cmVCLCBmaXh0dXJlQSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJDb250YWN0RmFjdG9yeS5wcm90b3R5cGUuRGVzdHJveSA9IGZ1bmN0aW9uIChjb250YWN0KSB7XHJcbiAgICAgIGlmIChjb250YWN0Lm1fbWFuaWZvbGQubV9wb2ludENvdW50ID4gMCkge1xyXG4gICAgICAgICBjb250YWN0Lm1fZml4dHVyZUEubV9ib2R5LlNldEF3YWtlKHRydWUpO1xyXG4gICAgICAgICBjb250YWN0Lm1fZml4dHVyZUIubV9ib2R5LlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciB0eXBlMSA9IHBhcnNlSW50KGNvbnRhY3QubV9maXh0dXJlQS5HZXRUeXBlKCkpO1xyXG4gICAgICB2YXIgdHlwZTIgPSBwYXJzZUludChjb250YWN0Lm1fZml4dHVyZUIuR2V0VHlwZSgpKTtcclxuICAgICAgdmFyIHJlZyA9IHRoaXMubV9yZWdpc3RlcnNbdHlwZTFdW3R5cGUyXTtcclxuICAgICAgaWYgKHRydWUpIHtcclxuICAgICAgICAgcmVnLnBvb2xDb3VudCsrO1xyXG4gICAgICAgICBjb250YWN0Lm1fbmV4dCA9IHJlZy5wb29sO1xyXG4gICAgICAgICByZWcucG9vbCA9IGNvbnRhY3Q7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGRlc3Ryb3lGY24gPSByZWcuZGVzdHJveUZjbjtcclxuICAgICAgZGVzdHJveUZjbihjb250YWN0LCB0aGlzLm1fYWxsb2NhdG9yKTtcclxuICAgfVxyXG4gICBiMkNvbnRhY3RSZWdpc3Rlci5iMkNvbnRhY3RSZWdpc3RlciA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkNvbnRhY3RSZXN1bHQuYjJDb250YWN0UmVzdWx0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnBvc2l0aW9uID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm5vcm1hbCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5pZCA9IG5ldyBiMkNvbnRhY3RJRCgpO1xyXG4gICB9O1xyXG4gICBiMkNvbnRhY3RTb2x2ZXIuYjJDb250YWN0U29sdmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fc3RlcCA9IG5ldyBiMlRpbWVTdGVwKCk7XHJcbiAgICAgIHRoaXMubV9jb25zdHJhaW50cyA9IG5ldyBWZWN0b3IoKTtcclxuICAgfTtcclxuICAgYjJDb250YWN0U29sdmVyLnByb3RvdHlwZS5iMkNvbnRhY3RTb2x2ZXIgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkNvbnRhY3RTb2x2ZXIucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoc3RlcCwgY29udGFjdHMsIGNvbnRhY3RDb3VudCwgYWxsb2NhdG9yKSB7XHJcbiAgICAgIGlmIChjb250YWN0Q291bnQgPT09IHVuZGVmaW5lZCkgY29udGFjdENvdW50ID0gMDtcclxuICAgICAgdmFyIGNvbnRhY3Q7XHJcbiAgICAgIHRoaXMubV9zdGVwLlNldChzdGVwKTtcclxuICAgICAgdGhpcy5tX2FsbG9jYXRvciA9IGFsbG9jYXRvcjtcclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHRoaXMubV9jb25zdHJhaW50Q291bnQgPSBjb250YWN0Q291bnQ7XHJcbiAgICAgIHdoaWxlICh0aGlzLm1fY29uc3RyYWludHMubGVuZ3RoIDwgdGhpcy5tX2NvbnN0cmFpbnRDb3VudCkge1xyXG4gICAgICAgICB0aGlzLm1fY29uc3RyYWludHNbdGhpcy5tX2NvbnN0cmFpbnRzLmxlbmd0aF0gPSBuZXcgYjJDb250YWN0Q29uc3RyYWludCgpO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCBjb250YWN0Q291bnQ7ICsraSkge1xyXG4gICAgICAgICBjb250YWN0ID0gY29udGFjdHNbaV07XHJcbiAgICAgICAgIHZhciBmaXh0dXJlQSA9IGNvbnRhY3QubV9maXh0dXJlQTtcclxuICAgICAgICAgdmFyIGZpeHR1cmVCID0gY29udGFjdC5tX2ZpeHR1cmVCO1xyXG4gICAgICAgICB2YXIgc2hhcGVBID0gZml4dHVyZUEubV9zaGFwZTtcclxuICAgICAgICAgdmFyIHNoYXBlQiA9IGZpeHR1cmVCLm1fc2hhcGU7XHJcbiAgICAgICAgIHZhciByYWRpdXNBID0gc2hhcGVBLm1fcmFkaXVzO1xyXG4gICAgICAgICB2YXIgcmFkaXVzQiA9IHNoYXBlQi5tX3JhZGl1cztcclxuICAgICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEubV9ib2R5O1xyXG4gICAgICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5tX2JvZHk7XHJcbiAgICAgICAgIHZhciBtYW5pZm9sZCA9IGNvbnRhY3QuR2V0TWFuaWZvbGQoKTtcclxuICAgICAgICAgdmFyIGZyaWN0aW9uID0gYjJTZXR0aW5ncy5iMk1peEZyaWN0aW9uKGZpeHR1cmVBLkdldEZyaWN0aW9uKCksIGZpeHR1cmVCLkdldEZyaWN0aW9uKCkpO1xyXG4gICAgICAgICB2YXIgcmVzdGl0dXRpb24gPSBiMlNldHRpbmdzLmIyTWl4UmVzdGl0dXRpb24oZml4dHVyZUEuR2V0UmVzdGl0dXRpb24oKSwgZml4dHVyZUIuR2V0UmVzdGl0dXRpb24oKSk7XHJcbiAgICAgICAgIHZhciB2QVggPSBib2R5QS5tX2xpbmVhclZlbG9jaXR5Lng7XHJcbiAgICAgICAgIHZhciB2QVkgPSBib2R5QS5tX2xpbmVhclZlbG9jaXR5Lnk7XHJcbiAgICAgICAgIHZhciB2QlggPSBib2R5Qi5tX2xpbmVhclZlbG9jaXR5Lng7XHJcbiAgICAgICAgIHZhciB2QlkgPSBib2R5Qi5tX2xpbmVhclZlbG9jaXR5Lnk7XHJcbiAgICAgICAgIHZhciB3QSA9IGJvZHlBLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICAgICB2YXIgd0IgPSBib2R5Qi5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChtYW5pZm9sZC5tX3BvaW50Q291bnQgPiAwKTtcclxuICAgICAgICAgYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZC5Jbml0aWFsaXplKG1hbmlmb2xkLCBib2R5QS5tX3hmLCByYWRpdXNBLCBib2R5Qi5tX3hmLCByYWRpdXNCKTtcclxuICAgICAgICAgdmFyIG5vcm1hbFggPSBiMkNvbnRhY3RTb2x2ZXIuc193b3JsZE1hbmlmb2xkLm1fbm9ybWFsLng7XHJcbiAgICAgICAgIHZhciBub3JtYWxZID0gYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZC5tX25vcm1hbC55O1xyXG4gICAgICAgICB2YXIgY2MgPSB0aGlzLm1fY29uc3RyYWludHNbaV07XHJcbiAgICAgICAgIGNjLmJvZHlBID0gYm9keUE7XHJcbiAgICAgICAgIGNjLmJvZHlCID0gYm9keUI7XHJcbiAgICAgICAgIGNjLm1hbmlmb2xkID0gbWFuaWZvbGQ7XHJcbiAgICAgICAgIGNjLm5vcm1hbC54ID0gbm9ybWFsWDtcclxuICAgICAgICAgY2Mubm9ybWFsLnkgPSBub3JtYWxZO1xyXG4gICAgICAgICBjYy5wb2ludENvdW50ID0gbWFuaWZvbGQubV9wb2ludENvdW50O1xyXG4gICAgICAgICBjYy5mcmljdGlvbiA9IGZyaWN0aW9uO1xyXG4gICAgICAgICBjYy5yZXN0aXR1dGlvbiA9IHJlc3RpdHV0aW9uO1xyXG4gICAgICAgICBjYy5sb2NhbFBsYW5lTm9ybWFsLnggPSBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueDtcclxuICAgICAgICAgY2MubG9jYWxQbGFuZU5vcm1hbC55ID0gbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLnk7XHJcbiAgICAgICAgIGNjLmxvY2FsUG9pbnQueCA9IG1hbmlmb2xkLm1fbG9jYWxQb2ludC54O1xyXG4gICAgICAgICBjYy5sb2NhbFBvaW50LnkgPSBtYW5pZm9sZC5tX2xvY2FsUG9pbnQueTtcclxuICAgICAgICAgY2MucmFkaXVzID0gcmFkaXVzQSArIHJhZGl1c0I7XHJcbiAgICAgICAgIGNjLnR5cGUgPSBtYW5pZm9sZC5tX3R5cGU7XHJcbiAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2MucG9pbnRDb3VudDsgKytrKSB7XHJcbiAgICAgICAgICAgIHZhciBjcCA9IG1hbmlmb2xkLm1fcG9pbnRzW2tdO1xyXG4gICAgICAgICAgICB2YXIgY2NwID0gY2MucG9pbnRzW2tdO1xyXG4gICAgICAgICAgICBjY3Aubm9ybWFsSW1wdWxzZSA9IGNwLm1fbm9ybWFsSW1wdWxzZTtcclxuICAgICAgICAgICAgY2NwLnRhbmdlbnRJbXB1bHNlID0gY3AubV90YW5nZW50SW1wdWxzZTtcclxuICAgICAgICAgICAgY2NwLmxvY2FsUG9pbnQuU2V0VihjcC5tX2xvY2FsUG9pbnQpO1xyXG4gICAgICAgICAgICB2YXIgckFYID0gY2NwLnJBLnggPSBiMkNvbnRhY3RTb2x2ZXIuc193b3JsZE1hbmlmb2xkLm1fcG9pbnRzW2tdLnggLSBib2R5QS5tX3N3ZWVwLmMueDtcclxuICAgICAgICAgICAgdmFyIHJBWSA9IGNjcC5yQS55ID0gYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZC5tX3BvaW50c1trXS55IC0gYm9keUEubV9zd2VlcC5jLnk7XHJcbiAgICAgICAgICAgIHZhciByQlggPSBjY3AuckIueCA9IGIyQ29udGFjdFNvbHZlci5zX3dvcmxkTWFuaWZvbGQubV9wb2ludHNba10ueCAtIGJvZHlCLm1fc3dlZXAuYy54O1xyXG4gICAgICAgICAgICB2YXIgckJZID0gY2NwLnJCLnkgPSBiMkNvbnRhY3RTb2x2ZXIuc193b3JsZE1hbmlmb2xkLm1fcG9pbnRzW2tdLnkgLSBib2R5Qi5tX3N3ZWVwLmMueTtcclxuICAgICAgICAgICAgdmFyIHJuQSA9IHJBWCAqIG5vcm1hbFkgLSByQVkgKiBub3JtYWxYO1xyXG4gICAgICAgICAgICB2YXIgcm5CID0gckJYICogbm9ybWFsWSAtIHJCWSAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgIHJuQSAqPSBybkE7XHJcbiAgICAgICAgICAgIHJuQiAqPSBybkI7XHJcbiAgICAgICAgICAgIHZhciBrTm9ybWFsID0gYm9keUEubV9pbnZNYXNzICsgYm9keUIubV9pbnZNYXNzICsgYm9keUEubV9pbnZJICogcm5BICsgYm9keUIubV9pbnZJICogcm5CO1xyXG4gICAgICAgICAgICBjY3Aubm9ybWFsTWFzcyA9IDEuMCAvIGtOb3JtYWw7XHJcbiAgICAgICAgICAgIHZhciBrRXF1YWxpemVkID0gYm9keUEubV9tYXNzICogYm9keUEubV9pbnZNYXNzICsgYm9keUIubV9tYXNzICogYm9keUIubV9pbnZNYXNzO1xyXG4gICAgICAgICAgICBrRXF1YWxpemVkICs9IGJvZHlBLm1fbWFzcyAqIGJvZHlBLm1faW52SSAqIHJuQSArIGJvZHlCLm1fbWFzcyAqIGJvZHlCLm1faW52SSAqIHJuQjtcclxuICAgICAgICAgICAgY2NwLmVxdWFsaXplZE1hc3MgPSAxLjAgLyBrRXF1YWxpemVkO1xyXG4gICAgICAgICAgICB2YXIgdGFuZ2VudFggPSBub3JtYWxZO1xyXG4gICAgICAgICAgICB2YXIgdGFuZ2VudFkgPSAoLW5vcm1hbFgpO1xyXG4gICAgICAgICAgICB2YXIgcnRBID0gckFYICogdGFuZ2VudFkgLSByQVkgKiB0YW5nZW50WDtcclxuICAgICAgICAgICAgdmFyIHJ0QiA9IHJCWCAqIHRhbmdlbnRZIC0gckJZICogdGFuZ2VudFg7XHJcbiAgICAgICAgICAgIHJ0QSAqPSBydEE7XHJcbiAgICAgICAgICAgIHJ0QiAqPSBydEI7XHJcbiAgICAgICAgICAgIHZhciBrVGFuZ2VudCA9IGJvZHlBLm1faW52TWFzcyArIGJvZHlCLm1faW52TWFzcyArIGJvZHlBLm1faW52SSAqIHJ0QSArIGJvZHlCLm1faW52SSAqIHJ0QjtcclxuICAgICAgICAgICAgY2NwLnRhbmdlbnRNYXNzID0gMS4wIC8ga1RhbmdlbnQ7XHJcbiAgICAgICAgICAgIGNjcC52ZWxvY2l0eUJpYXMgPSAwLjA7XHJcbiAgICAgICAgICAgIHZhciB0WCA9IHZCWCArICgoLXdCICogckJZKSkgLSB2QVggLSAoKC13QSAqIHJBWSkpO1xyXG4gICAgICAgICAgICB2YXIgdFkgPSB2QlkgKyAod0IgKiByQlgpIC0gdkFZIC0gKHdBICogckFYKTtcclxuICAgICAgICAgICAgdmFyIHZSZWwgPSBjYy5ub3JtYWwueCAqIHRYICsgY2Mubm9ybWFsLnkgKiB0WTtcclxuICAgICAgICAgICAgaWYgKHZSZWwgPCAoLWIyU2V0dGluZ3MuYjJfdmVsb2NpdHlUaHJlc2hvbGQpKSB7XHJcbiAgICAgICAgICAgICAgIGNjcC52ZWxvY2l0eUJpYXMgKz0gKC1jYy5yZXN0aXR1dGlvbiAqIHZSZWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKGNjLnBvaW50Q291bnQgPT0gMikge1xyXG4gICAgICAgICAgICB2YXIgY2NwMSA9IGNjLnBvaW50c1swXTtcclxuICAgICAgICAgICAgdmFyIGNjcDIgPSBjYy5wb2ludHNbMV07XHJcbiAgICAgICAgICAgIHZhciBpbnZNYXNzQSA9IGJvZHlBLm1faW52TWFzcztcclxuICAgICAgICAgICAgdmFyIGludklBID0gYm9keUEubV9pbnZJO1xyXG4gICAgICAgICAgICB2YXIgaW52TWFzc0IgPSBib2R5Qi5tX2ludk1hc3M7XHJcbiAgICAgICAgICAgIHZhciBpbnZJQiA9IGJvZHlCLm1faW52STtcclxuICAgICAgICAgICAgdmFyIHJuMUEgPSBjY3AxLnJBLnggKiBub3JtYWxZIC0gY2NwMS5yQS55ICogbm9ybWFsWDtcclxuICAgICAgICAgICAgdmFyIHJuMUIgPSBjY3AxLnJCLnggKiBub3JtYWxZIC0gY2NwMS5yQi55ICogbm9ybWFsWDtcclxuICAgICAgICAgICAgdmFyIHJuMkEgPSBjY3AyLnJBLnggKiBub3JtYWxZIC0gY2NwMi5yQS55ICogbm9ybWFsWDtcclxuICAgICAgICAgICAgdmFyIHJuMkIgPSBjY3AyLnJCLnggKiBub3JtYWxZIC0gY2NwMi5yQi55ICogbm9ybWFsWDtcclxuICAgICAgICAgICAgdmFyIGsxMSA9IGludk1hc3NBICsgaW52TWFzc0IgKyBpbnZJQSAqIHJuMUEgKiBybjFBICsgaW52SUIgKiBybjFCICogcm4xQjtcclxuICAgICAgICAgICAgdmFyIGsyMiA9IGludk1hc3NBICsgaW52TWFzc0IgKyBpbnZJQSAqIHJuMkEgKiBybjJBICsgaW52SUIgKiBybjJCICogcm4yQjtcclxuICAgICAgICAgICAgdmFyIGsxMiA9IGludk1hc3NBICsgaW52TWFzc0IgKyBpbnZJQSAqIHJuMUEgKiBybjJBICsgaW52SUIgKiBybjFCICogcm4yQjtcclxuICAgICAgICAgICAgdmFyIGtfbWF4Q29uZGl0aW9uTnVtYmVyID0gMTAwLjA7XHJcbiAgICAgICAgICAgIGlmIChrMTEgKiBrMTEgPCBrX21heENvbmRpdGlvbk51bWJlciAqIChrMTEgKiBrMjIgLSBrMTIgKiBrMTIpKSB7XHJcbiAgICAgICAgICAgICAgIGNjLksuY29sMS5TZXQoazExLCBrMTIpO1xyXG4gICAgICAgICAgICAgICBjYy5LLmNvbDIuU2V0KGsxMiwgazIyKTtcclxuICAgICAgICAgICAgICAgY2MuSy5HZXRJbnZlcnNlKGNjLm5vcm1hbE1hc3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICBjYy5wb2ludENvdW50ID0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkNvbnRhY3RTb2x2ZXIucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIHRWZWM7XHJcbiAgICAgIHZhciB0VmVjMjtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnN0cmFpbnRDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIHZhciBjID0gdGhpcy5tX2NvbnN0cmFpbnRzW2ldO1xyXG4gICAgICAgICB2YXIgYm9keUEgPSBjLmJvZHlBO1xyXG4gICAgICAgICB2YXIgYm9keUIgPSBjLmJvZHlCO1xyXG4gICAgICAgICB2YXIgaW52TWFzc0EgPSBib2R5QS5tX2ludk1hc3M7XHJcbiAgICAgICAgIHZhciBpbnZJQSA9IGJvZHlBLm1faW52STtcclxuICAgICAgICAgdmFyIGludk1hc3NCID0gYm9keUIubV9pbnZNYXNzO1xyXG4gICAgICAgICB2YXIgaW52SUIgPSBib2R5Qi5tX2ludkk7XHJcbiAgICAgICAgIHZhciBub3JtYWxYID0gYy5ub3JtYWwueDtcclxuICAgICAgICAgdmFyIG5vcm1hbFkgPSBjLm5vcm1hbC55O1xyXG4gICAgICAgICB2YXIgdGFuZ2VudFggPSBub3JtYWxZO1xyXG4gICAgICAgICB2YXIgdGFuZ2VudFkgPSAoLW5vcm1hbFgpO1xyXG4gICAgICAgICB2YXIgdFggPSAwO1xyXG4gICAgICAgICB2YXIgaiA9IDA7XHJcbiAgICAgICAgIHZhciB0Q291bnQgPSAwO1xyXG4gICAgICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcclxuICAgICAgICAgICAgdENvdW50ID0gYy5wb2ludENvdW50O1xyXG4gICAgICAgICAgICBmb3IgKGogPSAwO1xyXG4gICAgICAgICAgICBqIDwgdENvdW50OyArK2opIHtcclxuICAgICAgICAgICAgICAgdmFyIGNjcCA9IGMucG9pbnRzW2pdO1xyXG4gICAgICAgICAgICAgICBjY3Aubm9ybWFsSW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgICAgICAgIGNjcC50YW5nZW50SW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgICAgICAgIHZhciBQWCA9IGNjcC5ub3JtYWxJbXB1bHNlICogbm9ybWFsWCArIGNjcC50YW5nZW50SW1wdWxzZSAqIHRhbmdlbnRYO1xyXG4gICAgICAgICAgICAgICB2YXIgUFkgPSBjY3Aubm9ybWFsSW1wdWxzZSAqIG5vcm1hbFkgKyBjY3AudGFuZ2VudEltcHVsc2UgKiB0YW5nZW50WTtcclxuICAgICAgICAgICAgICAgYm9keUEubV9hbmd1bGFyVmVsb2NpdHkgLT0gaW52SUEgKiAoY2NwLnJBLnggKiBQWSAtIGNjcC5yQS55ICogUFgpO1xyXG4gICAgICAgICAgICAgICBib2R5QS5tX2xpbmVhclZlbG9jaXR5LnggLT0gaW52TWFzc0EgKiBQWDtcclxuICAgICAgICAgICAgICAgYm9keUEubV9saW5lYXJWZWxvY2l0eS55IC09IGludk1hc3NBICogUFk7XHJcbiAgICAgICAgICAgICAgIGJvZHlCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGludklCICogKGNjcC5yQi54ICogUFkgLSBjY3AuckIueSAqIFBYKTtcclxuICAgICAgICAgICAgICAgYm9keUIubV9saW5lYXJWZWxvY2l0eS54ICs9IGludk1hc3NCICogUFg7XHJcbiAgICAgICAgICAgICAgIGJvZHlCLm1fbGluZWFyVmVsb2NpdHkueSArPSBpbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRDb3VudCA9IGMucG9pbnRDb3VudDtcclxuICAgICAgICAgICAgZm9yIChqID0gMDtcclxuICAgICAgICAgICAgaiA8IHRDb3VudDsgKytqKSB7XHJcbiAgICAgICAgICAgICAgIHZhciBjY3AyID0gYy5wb2ludHNbal07XHJcbiAgICAgICAgICAgICAgIGNjcDIubm9ybWFsSW1wdWxzZSA9IDAuMDtcclxuICAgICAgICAgICAgICAgY2NwMi50YW5nZW50SW1wdWxzZSA9IDAuMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkNvbnRhY3RTb2x2ZXIucHJvdG90eXBlLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGogPSAwO1xyXG4gICAgICB2YXIgY2NwO1xyXG4gICAgICB2YXIgckFYID0gMDtcclxuICAgICAgdmFyIHJBWSA9IDA7XHJcbiAgICAgIHZhciByQlggPSAwO1xyXG4gICAgICB2YXIgckJZID0gMDtcclxuICAgICAgdmFyIGR2WCA9IDA7XHJcbiAgICAgIHZhciBkdlkgPSAwO1xyXG4gICAgICB2YXIgdm4gPSAwO1xyXG4gICAgICB2YXIgdnQgPSAwO1xyXG4gICAgICB2YXIgbGFtYmRhID0gMDtcclxuICAgICAgdmFyIG1heEZyaWN0aW9uID0gMDtcclxuICAgICAgdmFyIG5ld0ltcHVsc2UgPSAwO1xyXG4gICAgICB2YXIgUFggPSAwO1xyXG4gICAgICB2YXIgUFkgPSAwO1xyXG4gICAgICB2YXIgZFggPSAwO1xyXG4gICAgICB2YXIgZFkgPSAwO1xyXG4gICAgICB2YXIgUDFYID0gMDtcclxuICAgICAgdmFyIFAxWSA9IDA7XHJcbiAgICAgIHZhciBQMlggPSAwO1xyXG4gICAgICB2YXIgUDJZID0gMDtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb25zdHJhaW50Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgYyA9IHRoaXMubV9jb25zdHJhaW50c1tpXTtcclxuICAgICAgICAgdmFyIGJvZHlBID0gYy5ib2R5QTtcclxuICAgICAgICAgdmFyIGJvZHlCID0gYy5ib2R5QjtcclxuICAgICAgICAgdmFyIHdBID0gYm9keUEubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgICAgIHZhciB3QiA9IGJvZHlCLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICAgICB2YXIgdkEgPSBib2R5QS5tX2xpbmVhclZlbG9jaXR5O1xyXG4gICAgICAgICB2YXIgdkIgPSBib2R5Qi5tX2xpbmVhclZlbG9jaXR5O1xyXG4gICAgICAgICB2YXIgaW52TWFzc0EgPSBib2R5QS5tX2ludk1hc3M7XHJcbiAgICAgICAgIHZhciBpbnZJQSA9IGJvZHlBLm1faW52STtcclxuICAgICAgICAgdmFyIGludk1hc3NCID0gYm9keUIubV9pbnZNYXNzO1xyXG4gICAgICAgICB2YXIgaW52SUIgPSBib2R5Qi5tX2ludkk7XHJcbiAgICAgICAgIHZhciBub3JtYWxYID0gYy5ub3JtYWwueDtcclxuICAgICAgICAgdmFyIG5vcm1hbFkgPSBjLm5vcm1hbC55O1xyXG4gICAgICAgICB2YXIgdGFuZ2VudFggPSBub3JtYWxZO1xyXG4gICAgICAgICB2YXIgdGFuZ2VudFkgPSAoLW5vcm1hbFgpO1xyXG4gICAgICAgICB2YXIgZnJpY3Rpb24gPSBjLmZyaWN0aW9uO1xyXG4gICAgICAgICB2YXIgdFggPSAwO1xyXG4gICAgICAgICBmb3IgKGogPSAwO1xyXG4gICAgICAgICBqIDwgYy5wb2ludENvdW50OyBqKyspIHtcclxuICAgICAgICAgICAgY2NwID0gYy5wb2ludHNbal07XHJcbiAgICAgICAgICAgIGR2WCA9IHZCLnggLSB3QiAqIGNjcC5yQi55IC0gdkEueCArIHdBICogY2NwLnJBLnk7XHJcbiAgICAgICAgICAgIGR2WSA9IHZCLnkgKyB3QiAqIGNjcC5yQi54IC0gdkEueSAtIHdBICogY2NwLnJBLng7XHJcbiAgICAgICAgICAgIHZ0ID0gZHZYICogdGFuZ2VudFggKyBkdlkgKiB0YW5nZW50WTtcclxuICAgICAgICAgICAgbGFtYmRhID0gY2NwLnRhbmdlbnRNYXNzICogKC12dCk7XHJcbiAgICAgICAgICAgIG1heEZyaWN0aW9uID0gZnJpY3Rpb24gKiBjY3Aubm9ybWFsSW1wdWxzZTtcclxuICAgICAgICAgICAgbmV3SW1wdWxzZSA9IGIyTWF0aC5DbGFtcChjY3AudGFuZ2VudEltcHVsc2UgKyBsYW1iZGEsICgtbWF4RnJpY3Rpb24pLCBtYXhGcmljdGlvbik7XHJcbiAgICAgICAgICAgIGxhbWJkYSA9IG5ld0ltcHVsc2UgLSBjY3AudGFuZ2VudEltcHVsc2U7XHJcbiAgICAgICAgICAgIFBYID0gbGFtYmRhICogdGFuZ2VudFg7XHJcbiAgICAgICAgICAgIFBZID0gbGFtYmRhICogdGFuZ2VudFk7XHJcbiAgICAgICAgICAgIHZBLnggLT0gaW52TWFzc0EgKiBQWDtcclxuICAgICAgICAgICAgdkEueSAtPSBpbnZNYXNzQSAqIFBZO1xyXG4gICAgICAgICAgICB3QSAtPSBpbnZJQSAqIChjY3AuckEueCAqIFBZIC0gY2NwLnJBLnkgKiBQWCk7XHJcbiAgICAgICAgICAgIHZCLnggKz0gaW52TWFzc0IgKiBQWDtcclxuICAgICAgICAgICAgdkIueSArPSBpbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICAgICB3QiArPSBpbnZJQiAqIChjY3AuckIueCAqIFBZIC0gY2NwLnJCLnkgKiBQWCk7XHJcbiAgICAgICAgICAgIGNjcC50YW5nZW50SW1wdWxzZSA9IG5ld0ltcHVsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIHRDb3VudCA9IHBhcnNlSW50KGMucG9pbnRDb3VudCk7XHJcbiAgICAgICAgIGlmIChjLnBvaW50Q291bnQgPT0gMSkge1xyXG4gICAgICAgICAgICBjY3AgPSBjLnBvaW50c1swXTtcclxuICAgICAgICAgICAgZHZYID0gdkIueCArICgoLXdCICogY2NwLnJCLnkpKSAtIHZBLnggLSAoKC13QSAqIGNjcC5yQS55KSk7XHJcbiAgICAgICAgICAgIGR2WSA9IHZCLnkgKyAod0IgKiBjY3AuckIueCkgLSB2QS55IC0gKHdBICogY2NwLnJBLngpO1xyXG4gICAgICAgICAgICB2biA9IGR2WCAqIG5vcm1hbFggKyBkdlkgKiBub3JtYWxZO1xyXG4gICAgICAgICAgICBsYW1iZGEgPSAoLWNjcC5ub3JtYWxNYXNzICogKHZuIC0gY2NwLnZlbG9jaXR5QmlhcykpO1xyXG4gICAgICAgICAgICBuZXdJbXB1bHNlID0gY2NwLm5vcm1hbEltcHVsc2UgKyBsYW1iZGE7XHJcbiAgICAgICAgICAgIG5ld0ltcHVsc2UgPSBuZXdJbXB1bHNlID4gMCA/IG5ld0ltcHVsc2UgOiAwLjA7XHJcbiAgICAgICAgICAgIGxhbWJkYSA9IG5ld0ltcHVsc2UgLSBjY3Aubm9ybWFsSW1wdWxzZTtcclxuICAgICAgICAgICAgUFggPSBsYW1iZGEgKiBub3JtYWxYO1xyXG4gICAgICAgICAgICBQWSA9IGxhbWJkYSAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgIHZBLnggLT0gaW52TWFzc0EgKiBQWDtcclxuICAgICAgICAgICAgdkEueSAtPSBpbnZNYXNzQSAqIFBZO1xyXG4gICAgICAgICAgICB3QSAtPSBpbnZJQSAqIChjY3AuckEueCAqIFBZIC0gY2NwLnJBLnkgKiBQWCk7XHJcbiAgICAgICAgICAgIHZCLnggKz0gaW52TWFzc0IgKiBQWDtcclxuICAgICAgICAgICAgdkIueSArPSBpbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICAgICB3QiArPSBpbnZJQiAqIChjY3AuckIueCAqIFBZIC0gY2NwLnJCLnkgKiBQWCk7XHJcbiAgICAgICAgICAgIGNjcC5ub3JtYWxJbXB1bHNlID0gbmV3SW1wdWxzZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGNwMSA9IGMucG9pbnRzWzBdO1xyXG4gICAgICAgICAgICB2YXIgY3AyID0gYy5wb2ludHNbMV07XHJcbiAgICAgICAgICAgIHZhciBhWCA9IGNwMS5ub3JtYWxJbXB1bHNlO1xyXG4gICAgICAgICAgICB2YXIgYVkgPSBjcDIubm9ybWFsSW1wdWxzZTtcclxuICAgICAgICAgICAgdmFyIGR2MVggPSB2Qi54IC0gd0IgKiBjcDEuckIueSAtIHZBLnggKyB3QSAqIGNwMS5yQS55O1xyXG4gICAgICAgICAgICB2YXIgZHYxWSA9IHZCLnkgKyB3QiAqIGNwMS5yQi54IC0gdkEueSAtIHdBICogY3AxLnJBLng7XHJcbiAgICAgICAgICAgIHZhciBkdjJYID0gdkIueCAtIHdCICogY3AyLnJCLnkgLSB2QS54ICsgd0EgKiBjcDIuckEueTtcclxuICAgICAgICAgICAgdmFyIGR2MlkgPSB2Qi55ICsgd0IgKiBjcDIuckIueCAtIHZBLnkgLSB3QSAqIGNwMi5yQS54O1xyXG4gICAgICAgICAgICB2YXIgdm4xID0gZHYxWCAqIG5vcm1hbFggKyBkdjFZICogbm9ybWFsWTtcclxuICAgICAgICAgICAgdmFyIHZuMiA9IGR2MlggKiBub3JtYWxYICsgZHYyWSAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgIHZhciBiWCA9IHZuMSAtIGNwMS52ZWxvY2l0eUJpYXM7XHJcbiAgICAgICAgICAgIHZhciBiWSA9IHZuMiAtIGNwMi52ZWxvY2l0eUJpYXM7XHJcbiAgICAgICAgICAgIHRNYXQgPSBjLks7XHJcbiAgICAgICAgICAgIGJYIC09IHRNYXQuY29sMS54ICogYVggKyB0TWF0LmNvbDIueCAqIGFZO1xyXG4gICAgICAgICAgICBiWSAtPSB0TWF0LmNvbDEueSAqIGFYICsgdE1hdC5jb2wyLnkgKiBhWTtcclxuICAgICAgICAgICAgdmFyIGtfZXJyb3JUb2wgPSAwLjAwMTtcclxuICAgICAgICAgICAgZm9yICg7Oykge1xyXG4gICAgICAgICAgICAgICB0TWF0ID0gYy5ub3JtYWxNYXNzO1xyXG4gICAgICAgICAgICAgICB2YXIgeFggPSAoLSh0TWF0LmNvbDEueCAqIGJYICsgdE1hdC5jb2wyLnggKiBiWSkpO1xyXG4gICAgICAgICAgICAgICB2YXIgeFkgPSAoLSh0TWF0LmNvbDEueSAqIGJYICsgdE1hdC5jb2wyLnkgKiBiWSkpO1xyXG4gICAgICAgICAgICAgICBpZiAoeFggPj0gMC4wICYmIHhZID49IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICBkWCA9IHhYIC0gYVg7XHJcbiAgICAgICAgICAgICAgICAgIGRZID0geFkgLSBhWTtcclxuICAgICAgICAgICAgICAgICAgUDFYID0gZFggKiBub3JtYWxYO1xyXG4gICAgICAgICAgICAgICAgICBQMVkgPSBkWCAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgICAgICAgIFAyWCA9IGRZICogbm9ybWFsWDtcclxuICAgICAgICAgICAgICAgICAgUDJZID0gZFkgKiBub3JtYWxZO1xyXG4gICAgICAgICAgICAgICAgICB2QS54IC09IGludk1hc3NBICogKFAxWCArIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIHZBLnkgLT0gaW52TWFzc0EgKiAoUDFZICsgUDJZKTtcclxuICAgICAgICAgICAgICAgICAgd0EgLT0gaW52SUEgKiAoY3AxLnJBLnggKiBQMVkgLSBjcDEuckEueSAqIFAxWCArIGNwMi5yQS54ICogUDJZIC0gY3AyLnJBLnkgKiBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICB2Qi54ICs9IGludk1hc3NCICogKFAxWCArIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIHZCLnkgKz0gaW52TWFzc0IgKiAoUDFZICsgUDJZKTtcclxuICAgICAgICAgICAgICAgICAgd0IgKz0gaW52SUIgKiAoY3AxLnJCLnggKiBQMVkgLSBjcDEuckIueSAqIFAxWCArIGNwMi5yQi54ICogUDJZIC0gY3AyLnJCLnkgKiBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICBjcDEubm9ybWFsSW1wdWxzZSA9IHhYO1xyXG4gICAgICAgICAgICAgICAgICBjcDIubm9ybWFsSW1wdWxzZSA9IHhZO1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICB4WCA9ICgtY3AxLm5vcm1hbE1hc3MgKiBiWCk7XHJcbiAgICAgICAgICAgICAgIHhZID0gMC4wO1xyXG4gICAgICAgICAgICAgICB2bjEgPSAwLjA7XHJcbiAgICAgICAgICAgICAgIHZuMiA9IGMuSy5jb2wxLnkgKiB4WCArIGJZO1xyXG4gICAgICAgICAgICAgICBpZiAoeFggPj0gMC4wICYmIHZuMiA+PSAwLjApIHtcclxuICAgICAgICAgICAgICAgICAgZFggPSB4WCAtIGFYO1xyXG4gICAgICAgICAgICAgICAgICBkWSA9IHhZIC0gYVk7XHJcbiAgICAgICAgICAgICAgICAgIFAxWCA9IGRYICogbm9ybWFsWDtcclxuICAgICAgICAgICAgICAgICAgUDFZID0gZFggKiBub3JtYWxZO1xyXG4gICAgICAgICAgICAgICAgICBQMlggPSBkWSAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgICAgICAgIFAyWSA9IGRZICogbm9ybWFsWTtcclxuICAgICAgICAgICAgICAgICAgdkEueCAtPSBpbnZNYXNzQSAqIChQMVggKyBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICB2QS55IC09IGludk1hc3NBICogKFAxWSArIFAyWSk7XHJcbiAgICAgICAgICAgICAgICAgIHdBIC09IGludklBICogKGNwMS5yQS54ICogUDFZIC0gY3AxLnJBLnkgKiBQMVggKyBjcDIuckEueCAqIFAyWSAtIGNwMi5yQS55ICogUDJYKTtcclxuICAgICAgICAgICAgICAgICAgdkIueCArPSBpbnZNYXNzQiAqIChQMVggKyBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICB2Qi55ICs9IGludk1hc3NCICogKFAxWSArIFAyWSk7XHJcbiAgICAgICAgICAgICAgICAgIHdCICs9IGludklCICogKGNwMS5yQi54ICogUDFZIC0gY3AxLnJCLnkgKiBQMVggKyBjcDIuckIueCAqIFAyWSAtIGNwMi5yQi55ICogUDJYKTtcclxuICAgICAgICAgICAgICAgICAgY3AxLm5vcm1hbEltcHVsc2UgPSB4WDtcclxuICAgICAgICAgICAgICAgICAgY3AyLm5vcm1hbEltcHVsc2UgPSB4WTtcclxuICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgeFggPSAwLjA7XHJcbiAgICAgICAgICAgICAgIHhZID0gKC1jcDIubm9ybWFsTWFzcyAqIGJZKTtcclxuICAgICAgICAgICAgICAgdm4xID0gYy5LLmNvbDIueCAqIHhZICsgYlg7XHJcbiAgICAgICAgICAgICAgIHZuMiA9IDAuMDtcclxuICAgICAgICAgICAgICAgaWYgKHhZID49IDAuMCAmJiB2bjEgPj0gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICAgIGRYID0geFggLSBhWDtcclxuICAgICAgICAgICAgICAgICAgZFkgPSB4WSAtIGFZO1xyXG4gICAgICAgICAgICAgICAgICBQMVggPSBkWCAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgICAgICAgIFAxWSA9IGRYICogbm9ybWFsWTtcclxuICAgICAgICAgICAgICAgICAgUDJYID0gZFkgKiBub3JtYWxYO1xyXG4gICAgICAgICAgICAgICAgICBQMlkgPSBkWSAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgICAgICAgIHZBLnggLT0gaW52TWFzc0EgKiAoUDFYICsgUDJYKTtcclxuICAgICAgICAgICAgICAgICAgdkEueSAtPSBpbnZNYXNzQSAqIChQMVkgKyBQMlkpO1xyXG4gICAgICAgICAgICAgICAgICB3QSAtPSBpbnZJQSAqIChjcDEuckEueCAqIFAxWSAtIGNwMS5yQS55ICogUDFYICsgY3AyLnJBLnggKiBQMlkgLSBjcDIuckEueSAqIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIHZCLnggKz0gaW52TWFzc0IgKiAoUDFYICsgUDJYKTtcclxuICAgICAgICAgICAgICAgICAgdkIueSArPSBpbnZNYXNzQiAqIChQMVkgKyBQMlkpO1xyXG4gICAgICAgICAgICAgICAgICB3QiArPSBpbnZJQiAqIChjcDEuckIueCAqIFAxWSAtIGNwMS5yQi55ICogUDFYICsgY3AyLnJCLnggKiBQMlkgLSBjcDIuckIueSAqIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIGNwMS5ub3JtYWxJbXB1bHNlID0geFg7XHJcbiAgICAgICAgICAgICAgICAgIGNwMi5ub3JtYWxJbXB1bHNlID0geFk7XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIHhYID0gMC4wO1xyXG4gICAgICAgICAgICAgICB4WSA9IDAuMDtcclxuICAgICAgICAgICAgICAgdm4xID0gYlg7XHJcbiAgICAgICAgICAgICAgIHZuMiA9IGJZO1xyXG4gICAgICAgICAgICAgICBpZiAodm4xID49IDAuMCAmJiB2bjIgPj0gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICAgIGRYID0geFggLSBhWDtcclxuICAgICAgICAgICAgICAgICAgZFkgPSB4WSAtIGFZO1xyXG4gICAgICAgICAgICAgICAgICBQMVggPSBkWCAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgICAgICAgIFAxWSA9IGRYICogbm9ybWFsWTtcclxuICAgICAgICAgICAgICAgICAgUDJYID0gZFkgKiBub3JtYWxYO1xyXG4gICAgICAgICAgICAgICAgICBQMlkgPSBkWSAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgICAgICAgIHZBLnggLT0gaW52TWFzc0EgKiAoUDFYICsgUDJYKTtcclxuICAgICAgICAgICAgICAgICAgdkEueSAtPSBpbnZNYXNzQSAqIChQMVkgKyBQMlkpO1xyXG4gICAgICAgICAgICAgICAgICB3QSAtPSBpbnZJQSAqIChjcDEuckEueCAqIFAxWSAtIGNwMS5yQS55ICogUDFYICsgY3AyLnJBLnggKiBQMlkgLSBjcDIuckEueSAqIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIHZCLnggKz0gaW52TWFzc0IgKiAoUDFYICsgUDJYKTtcclxuICAgICAgICAgICAgICAgICAgdkIueSArPSBpbnZNYXNzQiAqIChQMVkgKyBQMlkpO1xyXG4gICAgICAgICAgICAgICAgICB3QiArPSBpbnZJQiAqIChjcDEuckIueCAqIFAxWSAtIGNwMS5yQi55ICogUDFYICsgY3AyLnJCLnggKiBQMlkgLSBjcDIuckIueSAqIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIGNwMS5ub3JtYWxJbXB1bHNlID0geFg7XHJcbiAgICAgICAgICAgICAgICAgIGNwMi5ub3JtYWxJbXB1bHNlID0geFk7XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYm9keUEubV9hbmd1bGFyVmVsb2NpdHkgPSB3QTtcclxuICAgICAgICAgYm9keUIubV9hbmd1bGFyVmVsb2NpdHkgPSB3QjtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQ29udGFjdFNvbHZlci5wcm90b3R5cGUuRmluYWxpemVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb25zdHJhaW50Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgYyA9IHRoaXMubV9jb25zdHJhaW50c1tpXTtcclxuICAgICAgICAgdmFyIG0gPSBjLm1hbmlmb2xkO1xyXG4gICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGMucG9pbnRDb3VudDsgKytqKSB7XHJcbiAgICAgICAgICAgIHZhciBwb2ludDEgPSBtLm1fcG9pbnRzW2pdO1xyXG4gICAgICAgICAgICB2YXIgcG9pbnQyID0gYy5wb2ludHNbal07XHJcbiAgICAgICAgICAgIHBvaW50MS5tX25vcm1hbEltcHVsc2UgPSBwb2ludDIubm9ybWFsSW1wdWxzZTtcclxuICAgICAgICAgICAgcG9pbnQxLm1fdGFuZ2VudEltcHVsc2UgPSBwb2ludDIudGFuZ2VudEltcHVsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQ29udGFjdFNvbHZlci5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xyXG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XHJcbiAgICAgIHZhciBtaW5TZXBhcmF0aW9uID0gMC4wO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb25zdHJhaW50Q291bnQ7IGkrKykge1xyXG4gICAgICAgICB2YXIgYyA9IHRoaXMubV9jb25zdHJhaW50c1tpXTtcclxuICAgICAgICAgdmFyIGJvZHlBID0gYy5ib2R5QTtcclxuICAgICAgICAgdmFyIGJvZHlCID0gYy5ib2R5QjtcclxuICAgICAgICAgdmFyIGludk1hc3NBID0gYm9keUEubV9tYXNzICogYm9keUEubV9pbnZNYXNzO1xyXG4gICAgICAgICB2YXIgaW52SUEgPSBib2R5QS5tX21hc3MgKiBib2R5QS5tX2ludkk7XHJcbiAgICAgICAgIHZhciBpbnZNYXNzQiA9IGJvZHlCLm1fbWFzcyAqIGJvZHlCLm1faW52TWFzcztcclxuICAgICAgICAgdmFyIGludklCID0gYm9keUIubV9tYXNzICogYm9keUIubV9pbnZJO1xyXG4gICAgICAgICBiMkNvbnRhY3RTb2x2ZXIuc19wc20uSW5pdGlhbGl6ZShjKTtcclxuICAgICAgICAgdmFyIG5vcm1hbCA9IGIyQ29udGFjdFNvbHZlci5zX3BzbS5tX25vcm1hbDtcclxuICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjLnBvaW50Q291bnQ7IGorKykge1xyXG4gICAgICAgICAgICB2YXIgY2NwID0gYy5wb2ludHNbal07XHJcbiAgICAgICAgICAgIHZhciBwb2ludCA9IGIyQ29udGFjdFNvbHZlci5zX3BzbS5tX3BvaW50c1tqXTtcclxuICAgICAgICAgICAgdmFyIHNlcGFyYXRpb24gPSBiMkNvbnRhY3RTb2x2ZXIuc19wc20ubV9zZXBhcmF0aW9uc1tqXTtcclxuICAgICAgICAgICAgdmFyIHJBWCA9IHBvaW50LnggLSBib2R5QS5tX3N3ZWVwLmMueDtcclxuICAgICAgICAgICAgdmFyIHJBWSA9IHBvaW50LnkgLSBib2R5QS5tX3N3ZWVwLmMueTtcclxuICAgICAgICAgICAgdmFyIHJCWCA9IHBvaW50LnggLSBib2R5Qi5tX3N3ZWVwLmMueDtcclxuICAgICAgICAgICAgdmFyIHJCWSA9IHBvaW50LnkgLSBib2R5Qi5tX3N3ZWVwLmMueTtcclxuICAgICAgICAgICAgbWluU2VwYXJhdGlvbiA9IG1pblNlcGFyYXRpb24gPCBzZXBhcmF0aW9uID8gbWluU2VwYXJhdGlvbiA6IHNlcGFyYXRpb247XHJcbiAgICAgICAgICAgIHZhciBDID0gYjJNYXRoLkNsYW1wKGJhdW1nYXJ0ZSAqIChzZXBhcmF0aW9uICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSwgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCAwLjApO1xyXG4gICAgICAgICAgICB2YXIgaW1wdWxzZSA9ICgtY2NwLmVxdWFsaXplZE1hc3MgKiBDKTtcclxuICAgICAgICAgICAgdmFyIFBYID0gaW1wdWxzZSAqIG5vcm1hbC54O1xyXG4gICAgICAgICAgICB2YXIgUFkgPSBpbXB1bHNlICogbm9ybWFsLnk7Ym9keUEubV9zd2VlcC5jLnggLT0gaW52TWFzc0EgKiBQWDtcclxuICAgICAgICAgICAgYm9keUEubV9zd2VlcC5jLnkgLT0gaW52TWFzc0EgKiBQWTtcclxuICAgICAgICAgICAgYm9keUEubV9zd2VlcC5hIC09IGludklBICogKHJBWCAqIFBZIC0gckFZICogUFgpO1xyXG4gICAgICAgICAgICBib2R5QS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICAgICAgICBib2R5Qi5tX3N3ZWVwLmMueCArPSBpbnZNYXNzQiAqIFBYO1xyXG4gICAgICAgICAgICBib2R5Qi5tX3N3ZWVwLmMueSArPSBpbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICAgICBib2R5Qi5tX3N3ZWVwLmEgKz0gaW52SUIgKiAockJYICogUFkgLSByQlkgKiBQWCk7XHJcbiAgICAgICAgICAgIGJvZHlCLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbWluU2VwYXJhdGlvbiA+ICgtMS41ICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKTtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZCA9IG5ldyBiMldvcmxkTWFuaWZvbGQoKTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0U29sdmVyLnNfcHNtID0gbmV3IGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCgpO1xyXG4gICB9KTtcclxuICAgQm94MkQuaW5oZXJpdChiMkVkZ2VBbmRDaXJjbGVDb250YWN0LCBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QpO1xyXG4gICBiMkVkZ2VBbmRDaXJjbGVDb250YWN0LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LnByb3RvdHlwZTtcclxuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5iMkVkZ2VBbmRDaXJjbGVDb250YWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuYjJDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QuQ3JlYXRlID0gZnVuY3Rpb24gKGFsbG9jYXRvcikge1xyXG4gICAgICByZXR1cm4gbmV3IGIyRWRnZUFuZENpcmNsZUNvbnRhY3QoKTtcclxuICAgfVxyXG4gICBiMkVkZ2VBbmRDaXJjbGVDb250YWN0LkRlc3Ryb3kgPSBmdW5jdGlvbiAoY29udGFjdCwgYWxsb2NhdG9yKSB7fVxyXG4gICBiMkVkZ2VBbmRDaXJjbGVDb250YWN0LnByb3RvdHlwZS5SZXNldCA9IGZ1bmN0aW9uIChmaXh0dXJlQSwgZml4dHVyZUIpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLlJlc2V0LmNhbGwodGhpcywgZml4dHVyZUEsIGZpeHR1cmVCKTtcclxuICAgfVxyXG4gICBiMkVkZ2VBbmRDaXJjbGVDb250YWN0LnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2ZpeHR1cmVBLkdldEJvZHkoKTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2ZpeHR1cmVCLkdldEJvZHkoKTtcclxuICAgICAgdGhpcy5iMkNvbGxpZGVFZGdlQW5kQ2lyY2xlKHRoaXMubV9tYW5pZm9sZCwgKHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJFZGdlU2hhcGUgPyB0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSA6IG51bGwpLCBiQS5tX3hmLCAodGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkgaW5zdGFuY2VvZiBiMkNpcmNsZVNoYXBlID8gdGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkgOiBudWxsKSwgYkIubV94Zik7XHJcbiAgIH1cclxuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuYjJDb2xsaWRlRWRnZUFuZENpcmNsZSA9IGZ1bmN0aW9uIChtYW5pZm9sZCwgZWRnZSwgeGYxLCBjaXJjbGUsIHhmMikge31cclxuICAgQm94MkQuaW5oZXJpdChiMk51bGxDb250YWN0LCBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QpO1xyXG4gICBiMk51bGxDb250YWN0LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LnByb3RvdHlwZTtcclxuICAgYjJOdWxsQ29udGFjdC5iMk51bGxDb250YWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuYjJDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIGIyTnVsbENvbnRhY3QucHJvdG90eXBlLmIyTnVsbENvbnRhY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkNvbnRhY3QuY2FsbCh0aGlzKTtcclxuICAgfVxyXG4gICBiMk51bGxDb250YWN0LnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICgpIHt9XHJcbiAgIEJveDJELmluaGVyaXQoYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCwgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0KTtcclxuICAgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5wcm90b3R5cGU7XHJcbiAgIGIyUG9seUFuZENpcmNsZUNvbnRhY3QuYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmIyQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBiMlBvbHlBbmRDaXJjbGVDb250YWN0LkNyZWF0ZSA9IGZ1bmN0aW9uIChhbGxvY2F0b3IpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMlBvbHlBbmRDaXJjbGVDb250YWN0KCk7XHJcbiAgIH1cclxuICAgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdC5EZXN0cm95ID0gZnVuY3Rpb24gKGNvbnRhY3QsIGFsbG9jYXRvcikge31cclxuICAgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuUmVzZXQgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5SZXNldC5jYWxsKHRoaXMsIGZpeHR1cmVBLCBmaXh0dXJlQik7XHJcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZml4dHVyZUEuR2V0VHlwZSgpID09IGIyU2hhcGUuZV9wb2x5Z29uU2hhcGUpO1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZpeHR1cmVCLkdldFR5cGUoKSA9PSBiMlNoYXBlLmVfY2lyY2xlU2hhcGUpO1xyXG4gICB9XHJcbiAgIGIyUG9seUFuZENpcmNsZUNvbnRhY3QucHJvdG90eXBlLkV2YWx1YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fZml4dHVyZUEubV9ib2R5O1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fZml4dHVyZUIubV9ib2R5O1xyXG4gICAgICBiMkNvbGxpc2lvbi5Db2xsaWRlUG9seWdvbkFuZENpcmNsZSh0aGlzLm1fbWFuaWZvbGQsICh0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyUG9seWdvblNoYXBlID8gdGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgOiBudWxsKSwgYkEubV94ZiwgKHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJDaXJjbGVTaGFwZSA/IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIDogbnVsbCksIGJCLm1feGYpO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJQb2x5QW5kRWRnZUNvbnRhY3QsIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdCk7XHJcbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LnByb3RvdHlwZTtcclxuICAgYjJQb2x5QW5kRWRnZUNvbnRhY3QuYjJQb2x5QW5kRWRnZUNvbnRhY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5iMkNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgYjJQb2x5QW5kRWRnZUNvbnRhY3QuQ3JlYXRlID0gZnVuY3Rpb24gKGFsbG9jYXRvcikge1xyXG4gICAgICByZXR1cm4gbmV3IGIyUG9seUFuZEVkZ2VDb250YWN0KCk7XHJcbiAgIH1cclxuICAgYjJQb2x5QW5kRWRnZUNvbnRhY3QuRGVzdHJveSA9IGZ1bmN0aW9uIChjb250YWN0LCBhbGxvY2F0b3IpIHt9XHJcbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LnByb3RvdHlwZS5SZXNldCA9IGZ1bmN0aW9uIChmaXh0dXJlQSwgZml4dHVyZUIpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLlJlc2V0LmNhbGwodGhpcywgZml4dHVyZUEsIGZpeHR1cmVCKTtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmaXh0dXJlQS5HZXRUeXBlKCkgPT0gYjJTaGFwZS5lX3BvbHlnb25TaGFwZSk7XHJcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZml4dHVyZUIuR2V0VHlwZSgpID09IGIyU2hhcGUuZV9lZGdlU2hhcGUpO1xyXG4gICB9XHJcbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2ZpeHR1cmVBLkdldEJvZHkoKTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2ZpeHR1cmVCLkdldEJvZHkoKTtcclxuICAgICAgdGhpcy5iMkNvbGxpZGVQb2x5QW5kRWRnZSh0aGlzLm1fbWFuaWZvbGQsICh0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyUG9seWdvblNoYXBlID8gdGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgOiBudWxsKSwgYkEubV94ZiwgKHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJFZGdlU2hhcGUgPyB0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKSA6IG51bGwpLCBiQi5tX3hmKTtcclxuICAgfVxyXG4gICBiMlBvbHlBbmRFZGdlQ29udGFjdC5wcm90b3R5cGUuYjJDb2xsaWRlUG9seUFuZEVkZ2UgPSBmdW5jdGlvbiAobWFuaWZvbGQsIHBvbHlnb24sIHhmMSwgZWRnZSwgeGYyKSB7fVxyXG4gICBCb3gyRC5pbmhlcml0KGIyUG9seWdvbkNvbnRhY3QsIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdCk7XHJcbiAgIGIyUG9seWdvbkNvbnRhY3QucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QucHJvdG90eXBlO1xyXG4gICBiMlBvbHlnb25Db250YWN0LmIyUG9seWdvbkNvbnRhY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5iMkNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgYjJQb2x5Z29uQ29udGFjdC5DcmVhdGUgPSBmdW5jdGlvbiAoYWxsb2NhdG9yKSB7XHJcbiAgICAgIHJldHVybiBuZXcgYjJQb2x5Z29uQ29udGFjdCgpO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvbkNvbnRhY3QuRGVzdHJveSA9IGZ1bmN0aW9uIChjb250YWN0LCBhbGxvY2F0b3IpIHt9XHJcbiAgIGIyUG9seWdvbkNvbnRhY3QucHJvdG90eXBlLlJlc2V0ID0gZnVuY3Rpb24gKGZpeHR1cmVBLCBmaXh0dXJlQikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuUmVzZXQuY2FsbCh0aGlzLCBmaXh0dXJlQSwgZml4dHVyZUIpO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvbkNvbnRhY3QucHJvdG90eXBlLkV2YWx1YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fZml4dHVyZUEuR2V0Qm9keSgpO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fZml4dHVyZUIuR2V0Qm9keSgpO1xyXG4gICAgICBiMkNvbGxpc2lvbi5Db2xsaWRlUG9seWdvbnModGhpcy5tX21hbmlmb2xkLCAodGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgaW5zdGFuY2VvZiBiMlBvbHlnb25TaGFwZSA/IHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpIDogbnVsbCksIGJBLm1feGYsICh0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyUG9seWdvblNoYXBlID8gdGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkgOiBudWxsKSwgYkIubV94Zik7XHJcbiAgIH1cclxuICAgYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQucHJvdG90eXBlLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX25vcm1hbCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX3NlcGFyYXRpb25zID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHMpO1xyXG4gICAgICB0aGlzLm1fcG9pbnRzID0gbmV3IFZlY3RvcihiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzKTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzOyBpKyspIHtcclxuICAgICAgICAgdGhpcy5tX3BvaW50c1tpXSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZC5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChjYykge1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGNjLnBvaW50Q291bnQgPiAwKTtcclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICB2YXIgY2xpcFBvaW50WCA9IDA7XHJcbiAgICAgIHZhciBjbGlwUG9pbnRZID0gMDtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICB2YXIgcGxhbmVQb2ludFggPSAwO1xyXG4gICAgICB2YXIgcGxhbmVQb2ludFkgPSAwO1xyXG4gICAgICBzd2l0Y2ggKGNjLnR5cGUpIHtcclxuICAgICAgY2FzZSBiMk1hbmlmb2xkLmVfY2lyY2xlczpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUEubV94Zi5SO1xyXG4gICAgICAgICAgICB0VmVjID0gY2MubG9jYWxQb2ludDtcclxuICAgICAgICAgICAgdmFyIHBvaW50QVggPSBjYy5ib2R5QS5tX3hmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHZhciBwb2ludEFZID0gY2MuYm9keUEubV94Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUIubV94Zi5SO1xyXG4gICAgICAgICAgICB0VmVjID0gY2MucG9pbnRzWzBdLmxvY2FsUG9pbnQ7XHJcbiAgICAgICAgICAgIHZhciBwb2ludEJYID0gY2MuYm9keUIubV94Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRCWSA9IGNjLmJvZHlCLm1feGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgICAgdmFyIGRYID0gcG9pbnRCWCAtIHBvaW50QVg7XHJcbiAgICAgICAgICAgIHZhciBkWSA9IHBvaW50QlkgLSBwb2ludEFZO1xyXG4gICAgICAgICAgICB2YXIgZDIgPSBkWCAqIGRYICsgZFkgKiBkWTtcclxuICAgICAgICAgICAgaWYgKGQyID4gTnVtYmVyLk1JTl9WQUxVRSAqIE51bWJlci5NSU5fVkFMVUUpIHtcclxuICAgICAgICAgICAgICAgdmFyIGQgPSBNYXRoLnNxcnQoZDIpO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnggPSBkWCAvIGQ7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueSA9IGRZIC8gZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ID0gMS4wO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSAwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tX3BvaW50c1swXS54ID0gMC41ICogKHBvaW50QVggKyBwb2ludEJYKTtcclxuICAgICAgICAgICAgdGhpcy5tX3BvaW50c1swXS55ID0gMC41ICogKHBvaW50QVkgKyBwb2ludEJZKTtcclxuICAgICAgICAgICAgdGhpcy5tX3NlcGFyYXRpb25zWzBdID0gZFggKiB0aGlzLm1fbm9ybWFsLnggKyBkWSAqIHRoaXMubV9ub3JtYWwueSAtIGNjLnJhZGl1cztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMk1hbmlmb2xkLmVfZmFjZUE6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgdE1hdCA9IGNjLmJvZHlBLm1feGYuUjtcclxuICAgICAgICAgICAgdFZlYyA9IGNjLmxvY2FsUGxhbmVOb3JtYWw7XHJcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueCA9IHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueSA9IHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHRNYXQgPSBjYy5ib2R5QS5tX3hmLlI7XHJcbiAgICAgICAgICAgIHRWZWMgPSBjYy5sb2NhbFBvaW50O1xyXG4gICAgICAgICAgICBwbGFuZVBvaW50WCA9IGNjLmJvZHlBLm1feGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgICAgcGxhbmVQb2ludFkgPSBjYy5ib2R5QS5tX3hmLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHRNYXQgPSBjYy5ib2R5Qi5tX3hmLlI7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgICAgICAgIGkgPCBjYy5wb2ludENvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgICAgdFZlYyA9IGNjLnBvaW50c1tpXS5sb2NhbFBvaW50O1xyXG4gICAgICAgICAgICAgICBjbGlwUG9pbnRYID0gY2MuYm9keUIubV94Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICAgICBjbGlwUG9pbnRZID0gY2MuYm9keUIubV94Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fc2VwYXJhdGlvbnNbaV0gPSAoY2xpcFBvaW50WCAtIHBsYW5lUG9pbnRYKSAqIHRoaXMubV9ub3JtYWwueCArIChjbGlwUG9pbnRZIC0gcGxhbmVQb2ludFkpICogdGhpcy5tX25vcm1hbC55IC0gY2MucmFkaXVzO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fcG9pbnRzW2ldLnggPSBjbGlwUG9pbnRYO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fcG9pbnRzW2ldLnkgPSBjbGlwUG9pbnRZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJNYW5pZm9sZC5lX2ZhY2VCOlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIHRNYXQgPSBjYy5ib2R5Qi5tX3hmLlI7XHJcbiAgICAgICAgICAgIHRWZWMgPSBjYy5sb2NhbFBsYW5lTm9ybWFsO1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUIubV94Zi5SO1xyXG4gICAgICAgICAgICB0VmVjID0gY2MubG9jYWxQb2ludDtcclxuICAgICAgICAgICAgcGxhbmVQb2ludFggPSBjYy5ib2R5Qi5tX3hmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHBsYW5lUG9pbnRZID0gY2MuYm9keUIubV94Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUEubV94Zi5SO1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICAgICBpIDwgY2MucG9pbnRDb3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgIHRWZWMgPSBjYy5wb2ludHNbaV0ubG9jYWxQb2ludDtcclxuICAgICAgICAgICAgICAgY2xpcFBvaW50WCA9IGNjLmJvZHlBLm1feGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgICAgICAgY2xpcFBvaW50WSA9IGNjLmJvZHlBLm1feGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgICAgICAgdGhpcy5tX3NlcGFyYXRpb25zW2ldID0gKGNsaXBQb2ludFggLSBwbGFuZVBvaW50WCkgKiB0aGlzLm1fbm9ybWFsLnggKyAoY2xpcFBvaW50WSAtIHBsYW5lUG9pbnRZKSAqIHRoaXMubV9ub3JtYWwueSAtIGNjLnJhZGl1cztcclxuICAgICAgICAgICAgICAgdGhpcy5tX3BvaW50c1tpXS5TZXQoY2xpcFBvaW50WCwgY2xpcFBvaW50WSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ICo9ICgtMSk7XHJcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueSAqPSAoLTEpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZC5jaXJjbGVQb2ludEEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZC5jaXJjbGVQb2ludEIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH0pO1xyXG59KSgpO1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5LFxyXG4gICAgICBiMkJvZHlEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkJvZHlEZWYsXHJcbiAgICAgIGIyQ29udGFjdEZpbHRlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEZpbHRlcixcclxuICAgICAgYjJDb250YWN0SW1wdWxzZSA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEltcHVsc2UsXHJcbiAgICAgIGIyQ29udGFjdExpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0TGlzdGVuZXIsXHJcbiAgICAgIGIyQ29udGFjdE1hbmFnZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RNYW5hZ2VyLFxyXG4gICAgICBiMkRlYnVnRHJhdyA9IEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LFxyXG4gICAgICBiMkRlc3RydWN0aW9uTGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkRlc3RydWN0aW9uTGlzdGVuZXIsXHJcbiAgICAgIGIyRmlsdGVyRGF0YSA9IEJveDJELkR5bmFtaWNzLmIyRmlsdGVyRGF0YSxcclxuICAgICAgYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlLFxyXG4gICAgICBiMkZpeHR1cmVEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkZpeHR1cmVEZWYsXHJcbiAgICAgIGIySXNsYW5kID0gQm94MkQuRHluYW1pY3MuYjJJc2xhbmQsXHJcbiAgICAgIGIyVGltZVN0ZXAgPSBCb3gyRC5EeW5hbWljcy5iMlRpbWVTdGVwLFxyXG4gICAgICBiMldvcmxkID0gQm94MkQuRHluYW1pY3MuYjJXb3JsZCxcclxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXHJcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxyXG4gICAgICBiMk1hdGggPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGgsXHJcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxyXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxyXG4gICAgICBiMlZlYzIgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIsXHJcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyxcclxuICAgICAgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxyXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXHJcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcclxuICAgICAgYjJDaXJjbGVTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZSxcclxuICAgICAgYjJFZGdlQ2hhaW5EZWYgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZUNoYWluRGVmLFxyXG4gICAgICBiMkVkZ2VTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlU2hhcGUsXHJcbiAgICAgIGIyTWFzc0RhdGEgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyTWFzc0RhdGEsXHJcbiAgICAgIGIyUG9seWdvblNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlBvbHlnb25TaGFwZSxcclxuICAgICAgYjJTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSxcclxuICAgICAgYjJCdW95YW5jeUNvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkJ1b3lhbmN5Q29udHJvbGxlcixcclxuICAgICAgYjJDb25zdGFudEFjY2VsQ29udHJvbGxlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIsXHJcbiAgICAgIGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyLFxyXG4gICAgICBiMkNvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIsXHJcbiAgICAgIGIyQ29udHJvbGxlckVkZ2UgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXJFZGdlLFxyXG4gICAgICBiMkdyYXZpdHlDb250cm9sbGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJHcmF2aXR5Q29udHJvbGxlcixcclxuICAgICAgYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXI7XHJcblxyXG4gICBCb3gyRC5pbmhlcml0KGIyQnVveWFuY3lDb250cm9sbGVyLCBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIpO1xyXG4gICBiMkJ1b3lhbmN5Q29udHJvbGxlci5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5wcm90b3R5cGU7XHJcbiAgIGIyQnVveWFuY3lDb250cm9sbGVyLmIyQnVveWFuY3lDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIuYjJDb250cm9sbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubm9ybWFsID0gbmV3IGIyVmVjMigwLCAoLTEpKTtcclxuICAgICAgdGhpcy5vZmZzZXQgPSAwO1xyXG4gICAgICB0aGlzLmRlbnNpdHkgPSAwO1xyXG4gICAgICB0aGlzLnZlbG9jaXR5ID0gbmV3IGIyVmVjMigwLCAwKTtcclxuICAgICAgdGhpcy5saW5lYXJEcmFnID0gMjtcclxuICAgICAgdGhpcy5hbmd1bGFyRHJhZyA9IDE7XHJcbiAgICAgIHRoaXMudXNlRGVuc2l0eSA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnVzZVdvcmxkR3Jhdml0eSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZ3Jhdml0eSA9IG51bGw7XHJcbiAgIH07XHJcbiAgIGIyQnVveWFuY3lDb250cm9sbGVyLnByb3RvdHlwZS5TdGVwID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgaWYgKCF0aGlzLm1fYm9keUxpc3QpIHJldHVybjtcclxuICAgICAgaWYgKHRoaXMudXNlV29ybGRHcmF2aXR5KSB7XHJcbiAgICAgICAgIHRoaXMuZ3Jhdml0eSA9IHRoaXMuR2V0V29ybGQoKS5HZXRHcmF2aXR5KCkuQ29weSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLm1fYm9keUxpc3Q7IGk7IGkgPSBpLm5leHRCb2R5KSB7XHJcbiAgICAgICAgIHZhciBib2R5ID0gaS5ib2R5O1xyXG4gICAgICAgICBpZiAoYm9keS5Jc0F3YWtlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIGFyZWFjID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICAgICB2YXIgbWFzc2MgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgICAgIHZhciBhcmVhID0gMC4wO1xyXG4gICAgICAgICB2YXIgbWFzcyA9IDAuMDtcclxuICAgICAgICAgZm9yICh2YXIgZml4dHVyZSA9IGJvZHkuR2V0Rml4dHVyZUxpc3QoKTsgZml4dHVyZTsgZml4dHVyZSA9IGZpeHR1cmUuR2V0TmV4dCgpKSB7XHJcbiAgICAgICAgICAgIHZhciBzYyA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgICAgICAgdmFyIHNhcmVhID0gZml4dHVyZS5HZXRTaGFwZSgpLkNvbXB1dGVTdWJtZXJnZWRBcmVhKHRoaXMubm9ybWFsLCB0aGlzLm9mZnNldCwgYm9keS5HZXRUcmFuc2Zvcm0oKSwgc2MpO1xyXG4gICAgICAgICAgICBhcmVhICs9IHNhcmVhO1xyXG4gICAgICAgICAgICBhcmVhYy54ICs9IHNhcmVhICogc2MueDtcclxuICAgICAgICAgICAgYXJlYWMueSArPSBzYXJlYSAqIHNjLnk7XHJcbiAgICAgICAgICAgIHZhciBzaGFwZURlbnNpdHkgPSAwO1xyXG4gICAgICAgICAgICBpZiAodGhpcy51c2VEZW5zaXR5KSB7XHJcbiAgICAgICAgICAgICAgIHNoYXBlRGVuc2l0eSA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIHNoYXBlRGVuc2l0eSA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbWFzcyArPSBzYXJlYSAqIHNoYXBlRGVuc2l0eTtcclxuICAgICAgICAgICAgbWFzc2MueCArPSBzYXJlYSAqIHNjLnggKiBzaGFwZURlbnNpdHk7XHJcbiAgICAgICAgICAgIG1hc3NjLnkgKz0gc2FyZWEgKiBzYy55ICogc2hhcGVEZW5zaXR5O1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGFyZWFjLnggLz0gYXJlYTtcclxuICAgICAgICAgYXJlYWMueSAvPSBhcmVhO1xyXG4gICAgICAgICBtYXNzYy54IC89IG1hc3M7XHJcbiAgICAgICAgIG1hc3NjLnkgLz0gbWFzcztcclxuICAgICAgICAgaWYgKGFyZWEgPCBOdW1iZXIuTUlOX1ZBTFVFKSBjb250aW51ZTtcclxuICAgICAgICAgdmFyIGJ1b3lhbmN5Rm9yY2UgPSB0aGlzLmdyYXZpdHkuR2V0TmVnYXRpdmUoKTtcclxuICAgICAgICAgYnVveWFuY3lGb3JjZS5NdWx0aXBseSh0aGlzLmRlbnNpdHkgKiBhcmVhKTtcclxuICAgICAgICAgYm9keS5BcHBseUZvcmNlKGJ1b3lhbmN5Rm9yY2UsIG1hc3NjKTtcclxuICAgICAgICAgdmFyIGRyYWdGb3JjZSA9IGJvZHkuR2V0TGluZWFyVmVsb2NpdHlGcm9tV29ybGRQb2ludChhcmVhYyk7XHJcbiAgICAgICAgIGRyYWdGb3JjZS5TdWJ0cmFjdCh0aGlzLnZlbG9jaXR5KTtcclxuICAgICAgICAgZHJhZ0ZvcmNlLk11bHRpcGx5KCgtdGhpcy5saW5lYXJEcmFnICogYXJlYSkpO1xyXG4gICAgICAgICBib2R5LkFwcGx5Rm9yY2UoZHJhZ0ZvcmNlLCBhcmVhYyk7XHJcbiAgICAgICAgIGJvZHkuQXBwbHlUb3JxdWUoKC1ib2R5LkdldEluZXJ0aWEoKSAvIGJvZHkuR2V0TWFzcygpICogYXJlYSAqIGJvZHkuR2V0QW5ndWxhclZlbG9jaXR5KCkgKiB0aGlzLmFuZ3VsYXJEcmFnKSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkJ1b3lhbmN5Q29udHJvbGxlci5wcm90b3R5cGUuRHJhdyA9IGZ1bmN0aW9uIChkZWJ1Z0RyYXcpIHtcclxuICAgICAgdmFyIHIgPSAxMDAwO1xyXG4gICAgICB2YXIgcDEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHZhciBwMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgcDEueCA9IHRoaXMubm9ybWFsLnggKiB0aGlzLm9mZnNldCArIHRoaXMubm9ybWFsLnkgKiByO1xyXG4gICAgICBwMS55ID0gdGhpcy5ub3JtYWwueSAqIHRoaXMub2Zmc2V0IC0gdGhpcy5ub3JtYWwueCAqIHI7XHJcbiAgICAgIHAyLnggPSB0aGlzLm5vcm1hbC54ICogdGhpcy5vZmZzZXQgLSB0aGlzLm5vcm1hbC55ICogcjtcclxuICAgICAgcDIueSA9IHRoaXMubm9ybWFsLnkgKiB0aGlzLm9mZnNldCArIHRoaXMubm9ybWFsLnggKiByO1xyXG4gICAgICB2YXIgY29sb3IgPSBuZXcgYjJDb2xvcigwLCAwLCAxKTtcclxuICAgICAgZGVidWdEcmF3LkRyYXdTZWdtZW50KHAxLCBwMiwgY29sb3IpO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJDb25zdGFudEFjY2VsQ29udHJvbGxlciwgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyKTtcclxuICAgYjJDb25zdGFudEFjY2VsQ29udHJvbGxlci5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5wcm90b3R5cGU7XHJcbiAgIGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIuYjJDb25zdGFudEFjY2VsQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLmIyQ29udHJvbGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLkEgPSBuZXcgYjJWZWMyKDAsIDApO1xyXG4gICB9O1xyXG4gICBiMkNvbnN0YW50QWNjZWxDb250cm9sbGVyLnByb3RvdHlwZS5TdGVwID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIHNtYWxsQSA9IG5ldyBiMlZlYzIodGhpcy5BLnggKiBzdGVwLmR0LCB0aGlzLkEueSAqIHN0ZXAuZHQpO1xyXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy5tX2JvZHlMaXN0OyBpOyBpID0gaS5uZXh0Qm9keSkge1xyXG4gICAgICAgICB2YXIgYm9keSA9IGkuYm9keTtcclxuICAgICAgICAgaWYgKCFib2R5LklzQXdha2UoKSkgY29udGludWU7XHJcbiAgICAgICAgIGJvZHkuU2V0TGluZWFyVmVsb2NpdHkobmV3IGIyVmVjMihib2R5LkdldExpbmVhclZlbG9jaXR5KCkueCArIHNtYWxsQS54LCBib2R5LkdldExpbmVhclZlbG9jaXR5KCkueSArIHNtYWxsQS55KSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIsIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcik7XHJcbiAgIGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIucHJvdG90eXBlO1xyXG4gICBiMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyLmIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5GID0gbmV3IGIyVmVjMigwLCAwKTtcclxuICAgfTtcclxuICAgYjJDb25zdGFudEZvcmNlQ29udHJvbGxlci5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLm1fYm9keUxpc3Q7IGk7IGkgPSBpLm5leHRCb2R5KSB7XHJcbiAgICAgICAgIHZhciBib2R5ID0gaS5ib2R5O1xyXG4gICAgICAgICBpZiAoIWJvZHkuSXNBd2FrZSgpKSBjb250aW51ZTtcclxuICAgICAgICAgYm9keS5BcHBseUZvcmNlKHRoaXMuRiwgYm9keS5HZXRXb3JsZENlbnRlcigpKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJDb250cm9sbGVyLnByb3RvdHlwZS5TdGVwID0gZnVuY3Rpb24gKHN0ZXApIHt9XHJcbiAgIGIyQ29udHJvbGxlci5wcm90b3R5cGUuRHJhdyA9IGZ1bmN0aW9uIChkZWJ1Z0RyYXcpIHt9XHJcbiAgIGIyQ29udHJvbGxlci5wcm90b3R5cGUuQWRkQm9keSA9IGZ1bmN0aW9uIChib2R5KSB7XHJcbiAgICAgIHZhciBlZGdlID0gbmV3IGIyQ29udHJvbGxlckVkZ2UoKTtcclxuICAgICAgZWRnZS5jb250cm9sbGVyID0gdGhpcztcclxuICAgICAgZWRnZS5ib2R5ID0gYm9keTtcclxuICAgICAgZWRnZS5uZXh0Qm9keSA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgZWRnZS5wcmV2Qm9keSA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ib2R5TGlzdCA9IGVkZ2U7XHJcbiAgICAgIGlmIChlZGdlLm5leHRCb2R5KSBlZGdlLm5leHRCb2R5LnByZXZCb2R5ID0gZWRnZTtcclxuICAgICAgdGhpcy5tX2JvZHlDb3VudCsrO1xyXG4gICAgICBlZGdlLm5leHRDb250cm9sbGVyID0gYm9keS5tX2NvbnRyb2xsZXJMaXN0O1xyXG4gICAgICBlZGdlLnByZXZDb250cm9sbGVyID0gbnVsbDtcclxuICAgICAgYm9keS5tX2NvbnRyb2xsZXJMaXN0ID0gZWRnZTtcclxuICAgICAgaWYgKGVkZ2UubmV4dENvbnRyb2xsZXIpIGVkZ2UubmV4dENvbnRyb2xsZXIucHJldkNvbnRyb2xsZXIgPSBlZGdlO1xyXG4gICAgICBib2R5Lm1fY29udHJvbGxlckNvdW50Kys7XHJcbiAgIH1cclxuICAgYjJDb250cm9sbGVyLnByb3RvdHlwZS5SZW1vdmVCb2R5ID0gZnVuY3Rpb24gKGJvZHkpIHtcclxuICAgICAgdmFyIGVkZ2UgPSBib2R5Lm1fY29udHJvbGxlckxpc3Q7XHJcbiAgICAgIHdoaWxlIChlZGdlICYmIGVkZ2UuY29udHJvbGxlciAhPSB0aGlzKVxyXG4gICAgICBlZGdlID0gZWRnZS5uZXh0Q29udHJvbGxlcjtcclxuICAgICAgaWYgKGVkZ2UucHJldkJvZHkpIGVkZ2UucHJldkJvZHkubmV4dEJvZHkgPSBlZGdlLm5leHRCb2R5O1xyXG4gICAgICBpZiAoZWRnZS5uZXh0Qm9keSkgZWRnZS5uZXh0Qm9keS5wcmV2Qm9keSA9IGVkZ2UucHJldkJvZHk7XHJcbiAgICAgIGlmIChlZGdlLm5leHRDb250cm9sbGVyKSBlZGdlLm5leHRDb250cm9sbGVyLnByZXZDb250cm9sbGVyID0gZWRnZS5wcmV2Q29udHJvbGxlcjtcclxuICAgICAgaWYgKGVkZ2UucHJldkNvbnRyb2xsZXIpIGVkZ2UucHJldkNvbnRyb2xsZXIubmV4dENvbnRyb2xsZXIgPSBlZGdlLm5leHRDb250cm9sbGVyO1xyXG4gICAgICBpZiAodGhpcy5tX2JvZHlMaXN0ID09IGVkZ2UpIHRoaXMubV9ib2R5TGlzdCA9IGVkZ2UubmV4dEJvZHk7XHJcbiAgICAgIGlmIChib2R5Lm1fY29udHJvbGxlckxpc3QgPT0gZWRnZSkgYm9keS5tX2NvbnRyb2xsZXJMaXN0ID0gZWRnZS5uZXh0Q29udHJvbGxlcjtcclxuICAgICAgYm9keS5tX2NvbnRyb2xsZXJDb3VudC0tO1xyXG4gICAgICB0aGlzLm1fYm9keUNvdW50LS07XHJcbiAgIH1cclxuICAgYjJDb250cm9sbGVyLnByb3RvdHlwZS5DbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgd2hpbGUgKHRoaXMubV9ib2R5TGlzdClcclxuICAgICAgdGhpcy5SZW1vdmVCb2R5KHRoaXMubV9ib2R5TGlzdC5ib2R5KTtcclxuICAgfVxyXG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLkdldE5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcclxuICAgfVxyXG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLkdldFdvcmxkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3dvcmxkO1xyXG4gICB9XHJcbiAgIGIyQ29udHJvbGxlci5wcm90b3R5cGUuR2V0Qm9keUxpc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUxpc3Q7XHJcbiAgIH1cclxuICAgYjJDb250cm9sbGVyRWRnZS5iMkNvbnRyb2xsZXJFZGdlID0gZnVuY3Rpb24gKCkge307XHJcbiAgIEJveDJELmluaGVyaXQoYjJHcmF2aXR5Q29udHJvbGxlciwgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyKTtcclxuICAgYjJHcmF2aXR5Q29udHJvbGxlci5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5wcm90b3R5cGU7XHJcbiAgIGIyR3Jhdml0eUNvbnRyb2xsZXIuYjJHcmF2aXR5Q29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLmIyQ29udHJvbGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLkcgPSAxO1xyXG4gICAgICB0aGlzLmludlNxciA9IHRydWU7XHJcbiAgIH07XHJcbiAgIGIyR3Jhdml0eUNvbnRyb2xsZXIucHJvdG90eXBlLlN0ZXAgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgaSA9IG51bGw7XHJcbiAgICAgIHZhciBib2R5MSA9IG51bGw7XHJcbiAgICAgIHZhciBwMSA9IG51bGw7XHJcbiAgICAgIHZhciBtYXNzMSA9IDA7XHJcbiAgICAgIHZhciBqID0gbnVsbDtcclxuICAgICAgdmFyIGJvZHkyID0gbnVsbDtcclxuICAgICAgdmFyIHAyID0gbnVsbDtcclxuICAgICAgdmFyIGR4ID0gMDtcclxuICAgICAgdmFyIGR5ID0gMDtcclxuICAgICAgdmFyIHIyID0gMDtcclxuICAgICAgdmFyIGYgPSBudWxsO1xyXG4gICAgICBpZiAodGhpcy5pbnZTcXIpIHtcclxuICAgICAgICAgZm9yIChpID0gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICAgICAgICBpOyBpID0gaS5uZXh0Qm9keSkge1xyXG4gICAgICAgICAgICBib2R5MSA9IGkuYm9keTtcclxuICAgICAgICAgICAgcDEgPSBib2R5MS5HZXRXb3JsZENlbnRlcigpO1xyXG4gICAgICAgICAgICBtYXNzMSA9IGJvZHkxLkdldE1hc3MoKTtcclxuICAgICAgICAgICAgZm9yIChqID0gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICAgICAgICAgICBqICE9IGk7IGogPSBqLm5leHRCb2R5KSB7XHJcbiAgICAgICAgICAgICAgIGJvZHkyID0gai5ib2R5O1xyXG4gICAgICAgICAgICAgICBwMiA9IGJvZHkyLkdldFdvcmxkQ2VudGVyKCk7XHJcbiAgICAgICAgICAgICAgIGR4ID0gcDIueCAtIHAxLng7XHJcbiAgICAgICAgICAgICAgIGR5ID0gcDIueSAtIHAxLnk7XHJcbiAgICAgICAgICAgICAgIHIyID0gZHggKiBkeCArIGR5ICogZHk7XHJcbiAgICAgICAgICAgICAgIGlmIChyMiA8IE51bWJlci5NSU5fVkFMVUUpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICBmID0gbmV3IGIyVmVjMihkeCwgZHkpO1xyXG4gICAgICAgICAgICAgICBmLk11bHRpcGx5KHRoaXMuRyAvIHIyIC8gTWF0aC5zcXJ0KHIyKSAqIG1hc3MxICogYm9keTIuR2V0TWFzcygpKTtcclxuICAgICAgICAgICAgICAgaWYgKGJvZHkxLklzQXdha2UoKSkgYm9keTEuQXBwbHlGb3JjZShmLCBwMSk7XHJcbiAgICAgICAgICAgICAgIGYuTXVsdGlwbHkoKC0xKSk7XHJcbiAgICAgICAgICAgICAgIGlmIChib2R5Mi5Jc0F3YWtlKCkpIGJvZHkyLkFwcGx5Rm9yY2UoZiwgcDIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgZm9yIChpID0gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICAgICAgICBpOyBpID0gaS5uZXh0Qm9keSkge1xyXG4gICAgICAgICAgICBib2R5MSA9IGkuYm9keTtcclxuICAgICAgICAgICAgcDEgPSBib2R5MS5HZXRXb3JsZENlbnRlcigpO1xyXG4gICAgICAgICAgICBtYXNzMSA9IGJvZHkxLkdldE1hc3MoKTtcclxuICAgICAgICAgICAgZm9yIChqID0gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICAgICAgICAgICBqICE9IGk7IGogPSBqLm5leHRCb2R5KSB7XHJcbiAgICAgICAgICAgICAgIGJvZHkyID0gai5ib2R5O1xyXG4gICAgICAgICAgICAgICBwMiA9IGJvZHkyLkdldFdvcmxkQ2VudGVyKCk7XHJcbiAgICAgICAgICAgICAgIGR4ID0gcDIueCAtIHAxLng7XHJcbiAgICAgICAgICAgICAgIGR5ID0gcDIueSAtIHAxLnk7XHJcbiAgICAgICAgICAgICAgIHIyID0gZHggKiBkeCArIGR5ICogZHk7XHJcbiAgICAgICAgICAgICAgIGlmIChyMiA8IE51bWJlci5NSU5fVkFMVUUpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICBmID0gbmV3IGIyVmVjMihkeCwgZHkpO1xyXG4gICAgICAgICAgICAgICBmLk11bHRpcGx5KHRoaXMuRyAvIHIyICogbWFzczEgKiBib2R5Mi5HZXRNYXNzKCkpO1xyXG4gICAgICAgICAgICAgICBpZiAoYm9keTEuSXNBd2FrZSgpKSBib2R5MS5BcHBseUZvcmNlKGYsIHAxKTtcclxuICAgICAgICAgICAgICAgZi5NdWx0aXBseSgoLTEpKTtcclxuICAgICAgICAgICAgICAgaWYgKGJvZHkyLklzQXdha2UoKSkgYm9keTIuQXBwbHlGb3JjZShmLCBwMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQm94MkQuaW5oZXJpdChiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyLCBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIpO1xyXG4gICBiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLnByb3RvdHlwZTtcclxuICAgYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlci5iMlRlbnNvckRhbXBpbmdDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIuYjJDb250cm9sbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMuVCA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIHRoaXMubWF4VGltZXN0ZXAgPSAwO1xyXG4gICB9O1xyXG4gICBiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyLnByb3RvdHlwZS5TZXRBeGlzQWxpZ25lZCA9IGZ1bmN0aW9uICh4RGFtcGluZywgeURhbXBpbmcpIHtcclxuICAgICAgaWYgKHhEYW1waW5nID09PSB1bmRlZmluZWQpIHhEYW1waW5nID0gMDtcclxuICAgICAgaWYgKHlEYW1waW5nID09PSB1bmRlZmluZWQpIHlEYW1waW5nID0gMDtcclxuICAgICAgdGhpcy5ULmNvbDEueCA9ICgteERhbXBpbmcpO1xyXG4gICAgICB0aGlzLlQuY29sMS55ID0gMDtcclxuICAgICAgdGhpcy5ULmNvbDIueCA9IDA7XHJcbiAgICAgIHRoaXMuVC5jb2wyLnkgPSAoLXlEYW1waW5nKTtcclxuICAgICAgaWYgKHhEYW1waW5nID4gMCB8fCB5RGFtcGluZyA+IDApIHtcclxuICAgICAgICAgdGhpcy5tYXhUaW1lc3RlcCA9IDEgLyBNYXRoLm1heCh4RGFtcGluZywgeURhbXBpbmcpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1heFRpbWVzdGVwID0gMDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXIucHJvdG90eXBlLlN0ZXAgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgdGltZXN0ZXAgPSBzdGVwLmR0O1xyXG4gICAgICBpZiAodGltZXN0ZXAgPD0gTnVtYmVyLk1JTl9WQUxVRSkgcmV0dXJuO1xyXG4gICAgICBpZiAodGltZXN0ZXAgPiB0aGlzLm1heFRpbWVzdGVwICYmIHRoaXMubWF4VGltZXN0ZXAgPiAwKSB0aW1lc3RlcCA9IHRoaXMubWF4VGltZXN0ZXA7XHJcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLm1fYm9keUxpc3Q7IGk7IGkgPSBpLm5leHRCb2R5KSB7XHJcbiAgICAgICAgIHZhciBib2R5ID0gaS5ib2R5O1xyXG4gICAgICAgICBpZiAoIWJvZHkuSXNBd2FrZSgpKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciBkYW1waW5nID0gYm9keS5HZXRXb3JsZFZlY3RvcihiMk1hdGguTXVsTVYodGhpcy5ULCBib2R5LkdldExvY2FsVmVjdG9yKGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKSkpKTtcclxuICAgICAgICAgYm9keS5TZXRMaW5lYXJWZWxvY2l0eShuZXcgYjJWZWMyKGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKS54ICsgZGFtcGluZy54ICogdGltZXN0ZXAsIGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKS55ICsgZGFtcGluZy55ICogdGltZXN0ZXApKTtcclxuICAgICAgfVxyXG4gICB9XHJcbn0pKCk7XHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgIHZhciBiMkNvbG9yID0gQm94MkQuQ29tbW9uLmIyQ29sb3IsXHJcbiAgICAgIGIyaW50ZXJuYWwgPSBCb3gyRC5Db21tb24uYjJpbnRlcm5hbCxcclxuICAgICAgYjJTZXR0aW5ncyA9IEJveDJELkNvbW1vbi5iMlNldHRpbmdzLFxyXG4gICAgICBiMk1hdDIyID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQyMixcclxuICAgICAgYjJNYXQzMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MzMsXHJcbiAgICAgIGIyTWF0aCA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aCxcclxuICAgICAgYjJTd2VlcCA9IEJveDJELkNvbW1vbi5NYXRoLmIyU3dlZXAsXHJcbiAgICAgIGIyVHJhbnNmb3JtID0gQm94MkQuQ29tbW9uLk1hdGguYjJUcmFuc2Zvcm0sXHJcbiAgICAgIGIyVmVjMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMixcclxuICAgICAgYjJWZWMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMzLFxyXG4gICAgICBiMkRpc3RhbmNlSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJEaXN0YW5jZUpvaW50LFxyXG4gICAgICBiMkRpc3RhbmNlSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJEaXN0YW5jZUpvaW50RGVmLFxyXG4gICAgICBiMkZyaWN0aW9uSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJGcmljdGlvbkpvaW50LFxyXG4gICAgICBiMkZyaWN0aW9uSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJGcmljdGlvbkpvaW50RGVmLFxyXG4gICAgICBiMkdlYXJKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkdlYXJKb2ludCxcclxuICAgICAgYjJHZWFySm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJHZWFySm9pbnREZWYsXHJcbiAgICAgIGIySmFjb2JpYW4gPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKYWNvYmlhbixcclxuICAgICAgYjJKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LFxyXG4gICAgICBiMkpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYsXHJcbiAgICAgIGIySm9pbnRFZGdlID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnRFZGdlLFxyXG4gICAgICBiMkxpbmVKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkxpbmVKb2ludCxcclxuICAgICAgYjJMaW5lSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJMaW5lSm9pbnREZWYsXHJcbiAgICAgIGIyTW91c2VKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMk1vdXNlSm9pbnQsXHJcbiAgICAgIGIyTW91c2VKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMk1vdXNlSm9pbnREZWYsXHJcbiAgICAgIGIyUHJpc21hdGljSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQcmlzbWF0aWNKb2ludCxcclxuICAgICAgYjJQcmlzbWF0aWNKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlByaXNtYXRpY0pvaW50RGVmLFxyXG4gICAgICBiMlB1bGxleUpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHVsbGV5Sm9pbnQsXHJcbiAgICAgIGIyUHVsbGV5Sm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQdWxsZXlKb2ludERlZixcclxuICAgICAgYjJSZXZvbHV0ZUpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUmV2b2x1dGVKb2ludCxcclxuICAgICAgYjJSZXZvbHV0ZUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUmV2b2x1dGVKb2ludERlZixcclxuICAgICAgYjJXZWxkSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJXZWxkSm9pbnQsXHJcbiAgICAgIGIyV2VsZEpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyV2VsZEpvaW50RGVmLFxyXG4gICAgICBiMkJvZHkgPSBCb3gyRC5EeW5hbWljcy5iMkJvZHksXHJcbiAgICAgIGIyQm9keURlZiA9IEJveDJELkR5bmFtaWNzLmIyQm9keURlZixcclxuICAgICAgYjJDb250YWN0RmlsdGVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0RmlsdGVyLFxyXG4gICAgICBiMkNvbnRhY3RJbXB1bHNlID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0SW1wdWxzZSxcclxuICAgICAgYjJDb250YWN0TGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lcixcclxuICAgICAgYjJDb250YWN0TWFuYWdlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdE1hbmFnZXIsXHJcbiAgICAgIGIyRGVidWdEcmF3ID0gQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXcsXHJcbiAgICAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyRGVzdHJ1Y3Rpb25MaXN0ZW5lcixcclxuICAgICAgYjJGaWx0ZXJEYXRhID0gQm94MkQuRHluYW1pY3MuYjJGaWx0ZXJEYXRhLFxyXG4gICAgICBiMkZpeHR1cmUgPSBCb3gyRC5EeW5hbWljcy5iMkZpeHR1cmUsXHJcbiAgICAgIGIyRml4dHVyZURlZiA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZURlZixcclxuICAgICAgYjJJc2xhbmQgPSBCb3gyRC5EeW5hbWljcy5iMklzbGFuZCxcclxuICAgICAgYjJUaW1lU3RlcCA9IEJveDJELkR5bmFtaWNzLmIyVGltZVN0ZXAsXHJcbiAgICAgIGIyV29ybGQgPSBCb3gyRC5EeW5hbWljcy5iMldvcmxkO1xyXG5cclxuICAgQm94MkQuaW5oZXJpdChiMkRpc3RhbmNlSm9pbnQsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50KTtcclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xyXG4gICBiMkRpc3RhbmNlSm9pbnQuYjJEaXN0YW5jZUpvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV91ID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IyKTtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoaW52X2R0ICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fdS54LCBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV91LnkpO1xyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIDAuMDtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldExlbmd0aCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9sZW5ndGg7XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5TZXRMZW5ndGggPSBmdW5jdGlvbiAobGVuZ3RoKSB7XHJcbiAgICAgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkgbGVuZ3RoID0gMDtcclxuICAgICAgdGhpcy5tX2xlbmd0aCA9IGxlbmd0aDtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9mcmVxdWVuY3lIejtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLlNldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uIChoeikge1xyXG4gICAgICBpZiAoaHogPT09IHVuZGVmaW5lZCkgaHogPSAwO1xyXG4gICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBoejtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9kYW1waW5nUmF0aW87XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5TZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbiAocmF0aW8pIHtcclxuICAgICAgaWYgKHJhdGlvID09PSB1bmRlZmluZWQpIHJhdGlvID0gMDtcclxuICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IHJhdGlvO1xyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuYjJEaXN0YW5jZUpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgdFkgPSAwO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxLlNldFYoZGVmLmxvY2FsQW5jaG9yQSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIuU2V0VihkZWYubG9jYWxBbmNob3JCKTtcclxuICAgICAgdGhpcy5tX2xlbmd0aCA9IGRlZi5sZW5ndGg7XHJcbiAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcclxuICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlID0gMC4wO1xyXG4gICAgICB0aGlzLm1fZ2FtbWEgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9iaWFzID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgIHIxWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICByMlggPSB0WDtcclxuICAgICAgdGhpcy5tX3UueCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYIC0gYkEubV9zd2VlcC5jLnggLSByMVg7XHJcbiAgICAgIHRoaXMubV91LnkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWSAtIGJBLm1fc3dlZXAuYy55IC0gcjFZO1xyXG4gICAgICB2YXIgbGVuZ3RoID0gTWF0aC5zcXJ0KHRoaXMubV91LnggKiB0aGlzLm1fdS54ICsgdGhpcy5tX3UueSAqIHRoaXMubV91LnkpO1xyXG4gICAgICBpZiAobGVuZ3RoID4gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XHJcbiAgICAgICAgIHRoaXMubV91Lk11bHRpcGx5KDEuMCAvIGxlbmd0aCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV91LlNldFplcm8oKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgY3IxdSA9IChyMVggKiB0aGlzLm1fdS55IC0gcjFZICogdGhpcy5tX3UueCk7XHJcbiAgICAgIHZhciBjcjJ1ID0gKHIyWCAqIHRoaXMubV91LnkgLSByMlkgKiB0aGlzLm1fdS54KTtcclxuICAgICAgdmFyIGludk1hc3MgPSBiQS5tX2ludk1hc3MgKyBiQS5tX2ludkkgKiBjcjF1ICogY3IxdSArIGJCLm1faW52TWFzcyArIGJCLm1faW52SSAqIGNyMnUgKiBjcjJ1O1xyXG4gICAgICB0aGlzLm1fbWFzcyA9IGludk1hc3MgIT0gMC4wID8gMS4wIC8gaW52TWFzcyA6IDAuMDtcclxuICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDAuMCkge1xyXG4gICAgICAgICB2YXIgQyA9IGxlbmd0aCAtIHRoaXMubV9sZW5ndGg7XHJcbiAgICAgICAgIHZhciBvbWVnYSA9IDIuMCAqIE1hdGguUEkgKiB0aGlzLm1fZnJlcXVlbmN5SHo7XHJcbiAgICAgICAgIHZhciBkID0gMi4wICogdGhpcy5tX21hc3MgKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XHJcbiAgICAgICAgIHZhciBrID0gdGhpcy5tX21hc3MgKiBvbWVnYSAqIG9tZWdhO1xyXG4gICAgICAgICB0aGlzLm1fZ2FtbWEgPSBzdGVwLmR0ICogKGQgKyBzdGVwLmR0ICogayk7XHJcbiAgICAgICAgIHRoaXMubV9nYW1tYSA9IHRoaXMubV9nYW1tYSAhPSAwLjAgPyAxIC8gdGhpcy5tX2dhbW1hIDogMC4wO1xyXG4gICAgICAgICB0aGlzLm1fYmlhcyA9IEMgKiBzdGVwLmR0ICogayAqIHRoaXMubV9nYW1tYTtcclxuICAgICAgICAgdGhpcy5tX21hc3MgPSBpbnZNYXNzICsgdGhpcy5tX2dhbW1hO1xyXG4gICAgICAgICB0aGlzLm1fbWFzcyA9IHRoaXMubV9tYXNzICE9IDAuMCA/IDEuMCAvIHRoaXMubV9tYXNzIDogMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHZhciBQWCA9IHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3UueDtcclxuICAgICAgICAgdmFyIFBZID0gdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fdS55O1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggLT0gYkEubV9pbnZNYXNzICogUFg7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSAtPSBiQS5tX2ludk1hc3MgKiBQWTtcclxuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgLT0gYkEubV9pbnZJICogKHIxWCAqIFBZIC0gcjFZICogUFgpO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkIubV9pbnZNYXNzICogUFg7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQi5tX2ludk1hc3MgKiBQWTtcclxuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkIubV9pbnZJICogKHIyWCAqIFBZIC0gcjJZICogUFgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB2YXIgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgcjFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgIHIyWCA9IHRYO1xyXG4gICAgICB2YXIgdjFYID0gYkEubV9saW5lYXJWZWxvY2l0eS54ICsgKCgtYkEubV9hbmd1bGFyVmVsb2NpdHkgKiByMVkpKTtcclxuICAgICAgdmFyIHYxWSA9IGJBLm1fbGluZWFyVmVsb2NpdHkueSArIChiQS5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIxWCk7XHJcbiAgICAgIHZhciB2MlggPSBiQi5tX2xpbmVhclZlbG9jaXR5LnggKyAoKC1iQi5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIyWSkpO1xyXG4gICAgICB2YXIgdjJZID0gYkIubV9saW5lYXJWZWxvY2l0eS55ICsgKGJCLm1fYW5ndWxhclZlbG9jaXR5ICogcjJYKTtcclxuICAgICAgdmFyIENkb3QgPSAodGhpcy5tX3UueCAqICh2MlggLSB2MVgpICsgdGhpcy5tX3UueSAqICh2MlkgLSB2MVkpKTtcclxuICAgICAgdmFyIGltcHVsc2UgPSAoLXRoaXMubV9tYXNzICogKENkb3QgKyB0aGlzLm1fYmlhcyArIHRoaXMubV9nYW1tYSAqIHRoaXMubV9pbXB1bHNlKSk7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlICs9IGltcHVsc2U7XHJcbiAgICAgIHZhciBQWCA9IGltcHVsc2UgKiB0aGlzLm1fdS54O1xyXG4gICAgICB2YXIgUFkgPSBpbXB1bHNlICogdGhpcy5tX3UueTtcclxuICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54IC09IGJBLm1faW52TWFzcyAqIFBYO1xyXG4gICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgLT0gYkEubV9pbnZNYXNzICogUFk7XHJcbiAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5IC09IGJBLm1faW52SSAqIChyMVggKiBQWSAtIHIxWSAqIFBYKTtcclxuICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IGJCLm1faW52TWFzcyAqIFBYO1xyXG4gICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkIubV9pbnZNYXNzICogUFk7XHJcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJCLm1faW52SSAqIChyMlggKiBQWSAtIHIyWSAqIFBYKTtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcclxuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgaWYgKHRoaXMubV9mcmVxdWVuY3lIeiA+IDAuMCkge1xyXG4gICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdmFyIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgIHIxWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICByMlggPSB0WDtcclxuICAgICAgdmFyIGRYID0gYkIubV9zd2VlcC5jLnggKyByMlggLSBiQS5tX3N3ZWVwLmMueCAtIHIxWDtcclxuICAgICAgdmFyIGRZID0gYkIubV9zd2VlcC5jLnkgKyByMlkgLSBiQS5tX3N3ZWVwLmMueSAtIHIxWTtcclxuICAgICAgdmFyIGxlbmd0aCA9IE1hdGguc3FydChkWCAqIGRYICsgZFkgKiBkWSk7XHJcbiAgICAgIGRYIC89IGxlbmd0aDtcclxuICAgICAgZFkgLz0gbGVuZ3RoO1xyXG4gICAgICB2YXIgQyA9IGxlbmd0aCAtIHRoaXMubV9sZW5ndGg7XHJcbiAgICAgIEMgPSBiMk1hdGguQ2xhbXAoQywgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCBiMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pO1xyXG4gICAgICB2YXIgaW1wdWxzZSA9ICgtdGhpcy5tX21hc3MgKiBDKTtcclxuICAgICAgdGhpcy5tX3UuU2V0KGRYLCBkWSk7XHJcbiAgICAgIHZhciBQWCA9IGltcHVsc2UgKiB0aGlzLm1fdS54O1xyXG4gICAgICB2YXIgUFkgPSBpbXB1bHNlICogdGhpcy5tX3UueTtcclxuICAgICAgYkEubV9zd2VlcC5jLnggLT0gYkEubV9pbnZNYXNzICogUFg7XHJcbiAgICAgIGJBLm1fc3dlZXAuYy55IC09IGJBLm1faW52TWFzcyAqIFBZO1xyXG4gICAgICBiQS5tX3N3ZWVwLmEgLT0gYkEubV9pbnZJICogKHIxWCAqIFBZIC0gcjFZICogUFgpO1xyXG4gICAgICBiQi5tX3N3ZWVwLmMueCArPSBiQi5tX2ludk1hc3MgKiBQWDtcclxuICAgICAgYkIubV9zd2VlcC5jLnkgKz0gYkIubV9pbnZNYXNzICogUFk7XHJcbiAgICAgIGJCLm1fc3dlZXAuYSArPSBiQi5tX2ludkkgKiAocjJYICogUFkgLSByMlkgKiBQWCk7XHJcbiAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIGJCLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIHJldHVybiBiMk1hdGguQWJzKEMpIDwgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJEaXN0YW5jZUpvaW50RGVmLCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZik7XHJcbiAgIGIyRGlzdGFuY2VKb2ludERlZi5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLnByb3RvdHlwZTtcclxuICAgYjJEaXN0YW5jZUpvaW50RGVmLmIyRGlzdGFuY2VKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyRGlzdGFuY2VKb2ludERlZi5wcm90b3R5cGUuYjJEaXN0YW5jZUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludERlZi5jYWxsKHRoaXMpO1xyXG4gICAgICB0aGlzLnR5cGUgPSBiMkpvaW50LmVfZGlzdGFuY2VKb2ludDtcclxuICAgICAgdGhpcy5sZW5ndGggPSAxLjA7XHJcbiAgICAgIHRoaXMuZnJlcXVlbmN5SHogPSAwLjA7XHJcbiAgICAgIHRoaXMuZGFtcGluZ1JhdGlvID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VKb2ludERlZi5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChiQSwgYkIsIGFuY2hvckEsIGFuY2hvckIpIHtcclxuICAgICAgdGhpcy5ib2R5QSA9IGJBO1xyXG4gICAgICB0aGlzLmJvZHlCID0gYkI7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBLlNldFYodGhpcy5ib2R5QS5HZXRMb2NhbFBvaW50KGFuY2hvckEpKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIuU2V0Vih0aGlzLmJvZHlCLkdldExvY2FsUG9pbnQoYW5jaG9yQikpO1xyXG4gICAgICB2YXIgZFggPSBhbmNob3JCLnggLSBhbmNob3JBLng7XHJcbiAgICAgIHZhciBkWSA9IGFuY2hvckIueSAtIGFuY2hvckEueTtcclxuICAgICAgdGhpcy5sZW5ndGggPSBNYXRoLnNxcnQoZFggKiBkWCArIGRZICogZFkpO1xyXG4gICAgICB0aGlzLmZyZXF1ZW5jeUh6ID0gMC4wO1xyXG4gICAgICB0aGlzLmRhbXBpbmdSYXRpbyA9IDAuMDtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyRnJpY3Rpb25Kb2ludCwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQpO1xyXG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XHJcbiAgIGIyRnJpY3Rpb25Kb2ludC5iMkZyaWN0aW9uSm9pbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmIySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xpbmVhck1hc3MgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICB0aGlzLm1fbGluZWFySW1wdWxzZSA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JBID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XHJcbiAgIH1cclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQik7XHJcbiAgIH1cclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqIHRoaXMubV9saW5lYXJJbXB1bHNlLngsIGludl9kdCAqIHRoaXMubV9saW5lYXJJbXB1bHNlLnkpO1xyXG4gICB9XHJcbiAgIGIyRnJpY3Rpb25Kb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9hbmd1bGFySW1wdWxzZTtcclxuICAgfVxyXG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLlNldE1heEZvcmNlID0gZnVuY3Rpb24gKGZvcmNlKSB7XHJcbiAgICAgIGlmIChmb3JjZSA9PT0gdW5kZWZpbmVkKSBmb3JjZSA9IDA7XHJcbiAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGZvcmNlO1xyXG4gICB9XHJcbiAgIGIyRnJpY3Rpb25Kb2ludC5wcm90b3R5cGUuR2V0TWF4Rm9yY2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbWF4Rm9yY2U7XHJcbiAgIH1cclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5TZXRNYXhUb3JxdWUgPSBmdW5jdGlvbiAodG9ycXVlKSB7XHJcbiAgICAgIGlmICh0b3JxdWUgPT09IHVuZGVmaW5lZCkgdG9ycXVlID0gMDtcclxuICAgICAgdGhpcy5tX21heFRvcnF1ZSA9IHRvcnF1ZTtcclxuICAgfVxyXG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLkdldE1heFRvcnF1ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9tYXhUb3JxdWU7XHJcbiAgIH1cclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5iMkZyaWN0aW9uSm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5TZXRWKGRlZi5sb2NhbEFuY2hvckEpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLlNldFYoZGVmLmxvY2FsQW5jaG9yQik7XHJcbiAgICAgIHRoaXMubV9saW5lYXJNYXNzLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX2FuZ3VsYXJNYXNzID0gMC4wO1xyXG4gICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5TZXRaZXJvKCk7XHJcbiAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSA9IDAuMDtcclxuICAgICAgdGhpcy5tX21heEZvcmNlID0gZGVmLm1heEZvcmNlO1xyXG4gICAgICB0aGlzLm1fbWF4VG9ycXVlID0gZGVmLm1heFRvcnF1ZTtcclxuICAgfVxyXG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgckFYID0gdGhpcy5tX2xvY2FsQW5jaG9yQS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgckFZID0gdGhpcy5tX2xvY2FsQW5jaG9yQS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHJBWCArIHRNYXQuY29sMi54ICogckFZKTtcclxuICAgICAgckFZID0gKHRNYXQuY29sMS55ICogckFYICsgdE1hdC5jb2wyLnkgKiByQVkpO1xyXG4gICAgICByQVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHJCWCA9IHRoaXMubV9sb2NhbEFuY2hvckIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJCWSA9IHRoaXMubV9sb2NhbEFuY2hvckIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQlggKyB0TWF0LmNvbDIueCAqIHJCWSk7XHJcbiAgICAgIHJCWSA9ICh0TWF0LmNvbDEueSAqIHJCWCArIHRNYXQuY29sMi55ICogckJZKTtcclxuICAgICAgckJYID0gdFg7XHJcbiAgICAgIHZhciBtQSA9IGJBLm1faW52TWFzcztcclxuICAgICAgdmFyIG1CID0gYkIubV9pbnZNYXNzO1xyXG4gICAgICB2YXIgaUEgPSBiQS5tX2ludkk7XHJcbiAgICAgIHZhciBpQiA9IGJCLm1faW52STtcclxuICAgICAgdmFyIEsgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICBLLmNvbDEueCA9IG1BICsgbUI7XHJcbiAgICAgIEsuY29sMi54ID0gMC4wO1xyXG4gICAgICBLLmNvbDEueSA9IDAuMDtcclxuICAgICAgSy5jb2wyLnkgPSBtQSArIG1CO1xyXG4gICAgICBLLmNvbDEueCArPSBpQSAqIHJBWSAqIHJBWTtcclxuICAgICAgSy5jb2wyLnggKz0gKC1pQSAqIHJBWCAqIHJBWSk7XHJcbiAgICAgIEsuY29sMS55ICs9ICgtaUEgKiByQVggKiByQVkpO1xyXG4gICAgICBLLmNvbDIueSArPSBpQSAqIHJBWCAqIHJBWDtcclxuICAgICAgSy5jb2wxLnggKz0gaUIgKiByQlkgKiByQlk7XHJcbiAgICAgIEsuY29sMi54ICs9ICgtaUIgKiByQlggKiByQlkpO1xyXG4gICAgICBLLmNvbDEueSArPSAoLWlCICogckJYICogckJZKTtcclxuICAgICAgSy5jb2wyLnkgKz0gaUIgKiByQlggKiByQlg7XHJcbiAgICAgIEsuR2V0SW52ZXJzZSh0aGlzLm1fbGluZWFyTWFzcyk7XHJcbiAgICAgIHRoaXMubV9hbmd1bGFyTWFzcyA9IGlBICsgaUI7XHJcbiAgICAgIGlmICh0aGlzLm1fYW5ndWxhck1hc3MgPiAwLjApIHtcclxuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJNYXNzID0gMS4wIC8gdGhpcy5tX2FuZ3VsYXJNYXNzO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xyXG4gICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS54ICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UueSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHRoaXMubV9hbmd1bGFySW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHZhciBQID0gdGhpcy5tX2xpbmVhckltcHVsc2U7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCAtPSBtQSAqIFAueDtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55IC09IG1BICogUC55O1xyXG4gICAgICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSAtPSBpQSAqIChyQVggKiBQLnkgLSByQVkgKiBQLnggKyB0aGlzLm1fYW5ndWxhckltcHVsc2UpO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gbUIgKiBQLng7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSBtQiAqIFAueTtcclxuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gaUIgKiAockJYICogUC55IC0gckJZICogUC54ICsgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuU2V0WmVybygpO1xyXG4gICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHZBID0gYkEubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHdBID0gYkEubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB2QiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3QiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgbUEgPSBiQS5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBtQiA9IGJCLm1faW52TWFzcztcclxuICAgICAgdmFyIGlBID0gYkEubV9pbnZJO1xyXG4gICAgICB2YXIgaUIgPSBiQi5tX2ludkk7XHJcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgIHZhciByQVggPSB0aGlzLm1fbG9jYWxBbmNob3JBLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByQVkgPSB0aGlzLm1fbG9jYWxBbmNob3JBLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogckFYICsgdE1hdC5jb2wyLnggKiByQVkpO1xyXG4gICAgICByQVkgPSAodE1hdC5jb2wxLnkgKiByQVggKyB0TWF0LmNvbDIueSAqIHJBWSk7XHJcbiAgICAgIHJBWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgckJYID0gdGhpcy5tX2xvY2FsQW5jaG9yQi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgckJZID0gdGhpcy5tX2xvY2FsQW5jaG9yQi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHJCWCArIHRNYXQuY29sMi54ICogckJZKTtcclxuICAgICAgckJZID0gKHRNYXQuY29sMS55ICogckJYICsgdE1hdC5jb2wyLnkgKiByQlkpO1xyXG4gICAgICByQlggPSB0WDtcclxuICAgICAgdmFyIG1heEltcHVsc2UgPSAwOyB7XHJcbiAgICAgICAgIHZhciBDZG90ID0gd0IgLSB3QTtcclxuICAgICAgICAgdmFyIGltcHVsc2UgPSAoLXRoaXMubV9hbmd1bGFyTWFzcyAqIENkb3QpO1xyXG4gICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9hbmd1bGFySW1wdWxzZTtcclxuICAgICAgICAgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4VG9ycXVlO1xyXG4gICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSBiMk1hdGguQ2xhbXAodGhpcy5tX2FuZ3VsYXJJbXB1bHNlICsgaW1wdWxzZSwgKC1tYXhJbXB1bHNlKSwgbWF4SW1wdWxzZSk7XHJcbiAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fYW5ndWxhckltcHVsc2UgLSBvbGRJbXB1bHNlO1xyXG4gICAgICAgICB3QSAtPSBpQSAqIGltcHVsc2U7XHJcbiAgICAgICAgIHdCICs9IGlCICogaW1wdWxzZTtcclxuICAgICAgfSB7XHJcbiAgICAgICAgIHZhciBDZG90WCA9IHZCLnggLSB3QiAqIHJCWSAtIHZBLnggKyB3QSAqIHJBWTtcclxuICAgICAgICAgdmFyIENkb3RZID0gdkIueSArIHdCICogckJYIC0gdkEueSAtIHdBICogckFYO1xyXG4gICAgICAgICB2YXIgaW1wdWxzZVYgPSBiMk1hdGguTXVsTVYodGhpcy5tX2xpbmVhck1hc3MsIG5ldyBiMlZlYzIoKC1DZG90WCksICgtQ2RvdFkpKSk7XHJcbiAgICAgICAgIHZhciBvbGRJbXB1bHNlViA9IHRoaXMubV9saW5lYXJJbXB1bHNlLkNvcHkoKTtcclxuICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuQWRkKGltcHVsc2VWKTtcclxuICAgICAgICAgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4Rm9yY2U7XHJcbiAgICAgICAgIGlmICh0aGlzLm1fbGluZWFySW1wdWxzZS5MZW5ndGhTcXVhcmVkKCkgPiBtYXhJbXB1bHNlICogbWF4SW1wdWxzZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1fbGluZWFySW1wdWxzZS5Ob3JtYWxpemUoKTtcclxuICAgICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuTXVsdGlwbHkobWF4SW1wdWxzZSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaW1wdWxzZVYgPSBiMk1hdGguU3VidHJhY3RWVih0aGlzLm1fbGluZWFySW1wdWxzZSwgb2xkSW1wdWxzZVYpO1xyXG4gICAgICAgICB2QS54IC09IG1BICogaW1wdWxzZVYueDtcclxuICAgICAgICAgdkEueSAtPSBtQSAqIGltcHVsc2VWLnk7XHJcbiAgICAgICAgIHdBIC09IGlBICogKHJBWCAqIGltcHVsc2VWLnkgLSByQVkgKiBpbXB1bHNlVi54KTtcclxuICAgICAgICAgdkIueCArPSBtQiAqIGltcHVsc2VWLng7XHJcbiAgICAgICAgIHZCLnkgKz0gbUIgKiBpbXB1bHNlVi55O1xyXG4gICAgICAgICB3QiArPSBpQiAqIChyQlggKiBpbXB1bHNlVi55IC0gckJZICogaW1wdWxzZVYueCk7XHJcbiAgICAgIH1cclxuICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgPSB3QTtcclxuICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgPSB3QjtcclxuICAgfVxyXG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcclxuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyRnJpY3Rpb25Kb2ludERlZiwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYpO1xyXG4gICBiMkZyaWN0aW9uSm9pbnREZWYucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5wcm90b3R5cGU7XHJcbiAgIGIyRnJpY3Rpb25Kb2ludERlZi5iMkZyaWN0aW9uSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLmIySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkZyaWN0aW9uSm9pbnREZWYucHJvdG90eXBlLmIyRnJpY3Rpb25Kb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnREZWYuY2FsbCh0aGlzKTtcclxuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX2ZyaWN0aW9uSm9pbnQ7XHJcbiAgICAgIHRoaXMubWF4Rm9yY2UgPSAwLjA7XHJcbiAgICAgIHRoaXMubWF4VG9ycXVlID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyRnJpY3Rpb25Kb2ludERlZi5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChiQSwgYkIsIGFuY2hvcikge1xyXG4gICAgICB0aGlzLmJvZHlBID0gYkE7XHJcbiAgICAgIHRoaXMuYm9keUIgPSBiQjtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckEuU2V0Vih0aGlzLmJvZHlBLkdldExvY2FsUG9pbnQoYW5jaG9yKSk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCLlNldFYodGhpcy5ib2R5Qi5HZXRMb2NhbFBvaW50KGFuY2hvcikpO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJHZWFySm9pbnQsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50KTtcclxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XHJcbiAgIGIyR2VhckpvaW50LmIyR2VhckpvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubV9ncm91bmRBbmNob3IxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX0ogPSBuZXcgYjJKYWNvYmlhbigpO1xyXG4gICB9O1xyXG4gICBiMkdlYXJKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjEpO1xyXG4gICB9XHJcbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XHJcbiAgIH1cclxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoaW52X2R0ICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLngsIGludl9kdCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0oubGluZWFyQi55KTtcclxuICAgfVxyXG4gICBiMkdlYXJKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgdmFyIHRNYXQgPSB0aGlzLm1fYm9keUIubV94Zi5SO1xyXG4gICAgICB2YXIgclggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgclkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSB0aGlzLm1fYm9keUIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB2YXIgdFggPSB0TWF0LmNvbDEueCAqIHJYICsgdE1hdC5jb2wyLnggKiByWTtcclxuICAgICAgclkgPSB0TWF0LmNvbDEueSAqIHJYICsgdE1hdC5jb2wyLnkgKiByWTtcclxuICAgICAgclggPSB0WDtcclxuICAgICAgdmFyIFBYID0gdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLng7XHJcbiAgICAgIHZhciBQWSA9IHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0oubGluZWFyQi55O1xyXG4gICAgICByZXR1cm4gaW52X2R0ICogKHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0ouYW5ndWxhckIgLSByWCAqIFBZICsgclkgKiBQWCk7XHJcbiAgIH1cclxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLkdldFJhdGlvID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3JhdGlvO1xyXG4gICB9XHJcbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5TZXRSYXRpbyA9IGZ1bmN0aW9uIChyYXRpbykge1xyXG4gICAgICBpZiAocmF0aW8gPT09IHVuZGVmaW5lZCkgcmF0aW8gPSAwO1xyXG4gICAgICB0aGlzLm1fcmF0aW8gPSByYXRpbztcclxuICAgfVxyXG4gICBiMkdlYXJKb2ludC5wcm90b3R5cGUuYjJHZWFySm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcclxuICAgICAgdmFyIHR5cGUxID0gcGFyc2VJbnQoZGVmLmpvaW50MS5tX3R5cGUpO1xyXG4gICAgICB2YXIgdHlwZTIgPSBwYXJzZUludChkZWYuam9pbnQyLm1fdHlwZSk7XHJcbiAgICAgIHRoaXMubV9yZXZvbHV0ZTEgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fcHJpc21hdGljMSA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9yZXZvbHV0ZTIgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fcHJpc21hdGljMiA9IG51bGw7XHJcbiAgICAgIHZhciBjb29yZGluYXRlMSA9IDA7XHJcbiAgICAgIHZhciBjb29yZGluYXRlMiA9IDA7XHJcbiAgICAgIHRoaXMubV9ncm91bmQxID0gZGVmLmpvaW50MS5HZXRCb2R5QSgpO1xyXG4gICAgICB0aGlzLm1fYm9keUEgPSBkZWYuam9pbnQxLkdldEJvZHlCKCk7XHJcbiAgICAgIGlmICh0eXBlMSA9PSBiMkpvaW50LmVfcmV2b2x1dGVKb2ludCkge1xyXG4gICAgICAgICB0aGlzLm1fcmV2b2x1dGUxID0gKGRlZi5qb2ludDEgaW5zdGFuY2VvZiBiMlJldm9sdXRlSm9pbnQgPyBkZWYuam9pbnQxIDogbnVsbCk7XHJcbiAgICAgICAgIHRoaXMubV9ncm91bmRBbmNob3IxLlNldFYodGhpcy5tX3Jldm9sdXRlMS5tX2xvY2FsQW5jaG9yMSk7XHJcbiAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEuU2V0Vih0aGlzLm1fcmV2b2x1dGUxLm1fbG9jYWxBbmNob3IyKTtcclxuICAgICAgICAgY29vcmRpbmF0ZTEgPSB0aGlzLm1fcmV2b2x1dGUxLkdldEpvaW50QW5nbGUoKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX3ByaXNtYXRpYzEgPSAoZGVmLmpvaW50MSBpbnN0YW5jZW9mIGIyUHJpc21hdGljSm9pbnQgPyBkZWYuam9pbnQxIDogbnVsbCk7XHJcbiAgICAgICAgIHRoaXMubV9ncm91bmRBbmNob3IxLlNldFYodGhpcy5tX3ByaXNtYXRpYzEubV9sb2NhbEFuY2hvcjEpO1xyXG4gICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3IxLlNldFYodGhpcy5tX3ByaXNtYXRpYzEubV9sb2NhbEFuY2hvcjIpO1xyXG4gICAgICAgICBjb29yZGluYXRlMSA9IHRoaXMubV9wcmlzbWF0aWMxLkdldEpvaW50VHJhbnNsYXRpb24oKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fZ3JvdW5kMiA9IGRlZi5qb2ludDIuR2V0Qm9keUEoKTtcclxuICAgICAgdGhpcy5tX2JvZHlCID0gZGVmLmpvaW50Mi5HZXRCb2R5QigpO1xyXG4gICAgICBpZiAodHlwZTIgPT0gYjJKb2ludC5lX3Jldm9sdXRlSm9pbnQpIHtcclxuICAgICAgICAgdGhpcy5tX3Jldm9sdXRlMiA9IChkZWYuam9pbnQyIGluc3RhbmNlb2YgYjJSZXZvbHV0ZUpvaW50ID8gZGVmLmpvaW50MiA6IG51bGwpO1xyXG4gICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMi5TZXRWKHRoaXMubV9yZXZvbHV0ZTIubV9sb2NhbEFuY2hvcjEpO1xyXG4gICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3IyLlNldFYodGhpcy5tX3Jldm9sdXRlMi5tX2xvY2FsQW5jaG9yMik7XHJcbiAgICAgICAgIGNvb3JkaW5hdGUyID0gdGhpcy5tX3Jldm9sdXRlMi5HZXRKb2ludEFuZ2xlKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9wcmlzbWF0aWMyID0gKGRlZi5qb2ludDIgaW5zdGFuY2VvZiBiMlByaXNtYXRpY0pvaW50ID8gZGVmLmpvaW50MiA6IG51bGwpO1xyXG4gICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMi5TZXRWKHRoaXMubV9wcmlzbWF0aWMyLm1fbG9jYWxBbmNob3IxKTtcclxuICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMi5TZXRWKHRoaXMubV9wcmlzbWF0aWMyLm1fbG9jYWxBbmNob3IyKTtcclxuICAgICAgICAgY29vcmRpbmF0ZTIgPSB0aGlzLm1fcHJpc21hdGljMi5HZXRKb2ludFRyYW5zbGF0aW9uKCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX3JhdGlvID0gZGVmLnJhdGlvO1xyXG4gICAgICB0aGlzLm1fY29uc3RhbnQgPSBjb29yZGluYXRlMSArIHRoaXMubV9yYXRpbyAqIGNvb3JkaW5hdGUyO1xyXG4gICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcclxuICAgfVxyXG4gICBiMkdlYXJKb2ludC5wcm90b3R5cGUuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgZzEgPSB0aGlzLm1fZ3JvdW5kMTtcclxuICAgICAgdmFyIGcyID0gdGhpcy5tX2dyb3VuZDI7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgdWdYID0gMDtcclxuICAgICAgdmFyIHVnWSA9IDA7XHJcbiAgICAgIHZhciByWCA9IDA7XHJcbiAgICAgIHZhciByWSA9IDA7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgdmFyIGNydWcgPSAwO1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgSyA9IDAuMDtcclxuICAgICAgdGhpcy5tX0ouU2V0WmVybygpO1xyXG4gICAgICBpZiAodGhpcy5tX3Jldm9sdXRlMSkge1xyXG4gICAgICAgICB0aGlzLm1fSi5hbmd1bGFyQSA9ICgtMS4wKTtcclxuICAgICAgICAgSyArPSBiQS5tX2ludkk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRNYXQgPSBnMS5tX3hmLlI7XHJcbiAgICAgICAgIHRWZWMgPSB0aGlzLm1fcHJpc21hdGljMS5tX2xvY2FsWEF4aXMxO1xyXG4gICAgICAgICB1Z1ggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICB1Z1kgPSB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICAgICByWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgICAgclkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gdE1hdC5jb2wxLnggKiByWCArIHRNYXQuY29sMi54ICogclk7XHJcbiAgICAgICAgIHJZID0gdE1hdC5jb2wxLnkgKiByWCArIHRNYXQuY29sMi55ICogclk7XHJcbiAgICAgICAgIHJYID0gdFg7XHJcbiAgICAgICAgIGNydWcgPSByWCAqIHVnWSAtIHJZICogdWdYO1xyXG4gICAgICAgICB0aGlzLm1fSi5saW5lYXJBLlNldCgoLXVnWCksICgtdWdZKSk7XHJcbiAgICAgICAgIHRoaXMubV9KLmFuZ3VsYXJBID0gKC1jcnVnKTtcclxuICAgICAgICAgSyArPSBiQS5tX2ludk1hc3MgKyBiQS5tX2ludkkgKiBjcnVnICogY3J1ZztcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX3Jldm9sdXRlMikge1xyXG4gICAgICAgICB0aGlzLm1fSi5hbmd1bGFyQiA9ICgtdGhpcy5tX3JhdGlvKTtcclxuICAgICAgICAgSyArPSB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiBiQi5tX2ludkk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRNYXQgPSBnMi5tX3hmLlI7XHJcbiAgICAgICAgIHRWZWMgPSB0aGlzLm1fcHJpc21hdGljMi5tX2xvY2FsWEF4aXMxO1xyXG4gICAgICAgICB1Z1ggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICB1Z1kgPSB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICAgICByWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgICAgclkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gdE1hdC5jb2wxLnggKiByWCArIHRNYXQuY29sMi54ICogclk7XHJcbiAgICAgICAgIHJZID0gdE1hdC5jb2wxLnkgKiByWCArIHRNYXQuY29sMi55ICogclk7XHJcbiAgICAgICAgIHJYID0gdFg7XHJcbiAgICAgICAgIGNydWcgPSByWCAqIHVnWSAtIHJZICogdWdYO1xyXG4gICAgICAgICB0aGlzLm1fSi5saW5lYXJCLlNldCgoLXRoaXMubV9yYXRpbyAqIHVnWCksICgtdGhpcy5tX3JhdGlvICogdWdZKSk7XHJcbiAgICAgICAgIHRoaXMubV9KLmFuZ3VsYXJCID0gKC10aGlzLm1fcmF0aW8gKiBjcnVnKTtcclxuICAgICAgICAgSyArPSB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiAoYkIubV9pbnZNYXNzICsgYkIubV9pbnZJICogY3J1ZyAqIGNydWcpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9tYXNzID0gSyA+IDAuMCA/IDEuMCAvIEsgOiAwLjA7XHJcbiAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkEubV9pbnZNYXNzICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJBLng7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQS5tX2ludk1hc3MgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckEueTtcclxuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkEubV9pbnZJICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5hbmd1bGFyQTtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IGJCLm1faW52TWFzcyAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0oubGluZWFyQi54O1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkIubV9pbnZNYXNzICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLnk7XHJcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJCLm1faW52SSAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0ouYW5ndWxhckI7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gMC4wO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgQ2RvdCA9IHRoaXMubV9KLkNvbXB1dGUoYkEubV9saW5lYXJWZWxvY2l0eSwgYkEubV9hbmd1bGFyVmVsb2NpdHksIGJCLm1fbGluZWFyVmVsb2NpdHksIGJCLm1fYW5ndWxhclZlbG9jaXR5KTtcclxuICAgICAgdmFyIGltcHVsc2UgPSAoLXRoaXMubV9tYXNzICogQ2RvdCk7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlICs9IGltcHVsc2U7XHJcbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQS5tX2ludk1hc3MgKiBpbXB1bHNlICogdGhpcy5tX0oubGluZWFyQS54O1xyXG4gICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkEubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckEueTtcclxuICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkEubV9pbnZJICogaW1wdWxzZSAqIHRoaXMubV9KLmFuZ3VsYXJBO1xyXG4gICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkIubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueDtcclxuICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IGJCLm1faW52TWFzcyAqIGltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLnk7XHJcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJCLm1faW52SSAqIGltcHVsc2UgKiB0aGlzLm1fSi5hbmd1bGFyQjtcclxuICAgfVxyXG4gICBiMkdlYXJKb2ludC5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xyXG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XHJcbiAgICAgIHZhciBsaW5lYXJFcnJvciA9IDAuMDtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciBjb29yZGluYXRlMSA9IDA7XHJcbiAgICAgIHZhciBjb29yZGluYXRlMiA9IDA7XHJcbiAgICAgIGlmICh0aGlzLm1fcmV2b2x1dGUxKSB7XHJcbiAgICAgICAgIGNvb3JkaW5hdGUxID0gdGhpcy5tX3Jldm9sdXRlMS5HZXRKb2ludEFuZ2xlKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIGNvb3JkaW5hdGUxID0gdGhpcy5tX3ByaXNtYXRpYzEuR2V0Sm9pbnRUcmFuc2xhdGlvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fcmV2b2x1dGUyKSB7XHJcbiAgICAgICAgIGNvb3JkaW5hdGUyID0gdGhpcy5tX3Jldm9sdXRlMi5HZXRKb2ludEFuZ2xlKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIGNvb3JkaW5hdGUyID0gdGhpcy5tX3ByaXNtYXRpYzIuR2V0Sm9pbnRUcmFuc2xhdGlvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBDID0gdGhpcy5tX2NvbnN0YW50IC0gKGNvb3JkaW5hdGUxICsgdGhpcy5tX3JhdGlvICogY29vcmRpbmF0ZTIpO1xyXG4gICAgICB2YXIgaW1wdWxzZSA9ICgtdGhpcy5tX21hc3MgKiBDKTtcclxuICAgICAgYkEubV9zd2VlcC5jLnggKz0gYkEubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckEueDtcclxuICAgICAgYkEubV9zd2VlcC5jLnkgKz0gYkEubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckEueTtcclxuICAgICAgYkEubV9zd2VlcC5hICs9IGJBLm1faW52SSAqIGltcHVsc2UgKiB0aGlzLm1fSi5hbmd1bGFyQTtcclxuICAgICAgYkIubV9zd2VlcC5jLnggKz0gYkIubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueDtcclxuICAgICAgYkIubV9zd2VlcC5jLnkgKz0gYkIubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueTtcclxuICAgICAgYkIubV9zd2VlcC5hICs9IGJCLm1faW52SSAqIGltcHVsc2UgKiB0aGlzLm1fSi5hbmd1bGFyQjtcclxuICAgICAgYkEuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgcmV0dXJuIGxpbmVhckVycm9yIDwgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJHZWFySm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcclxuICAgYjJHZWFySm9pbnREZWYucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5wcm90b3R5cGU7XHJcbiAgIGIyR2VhckpvaW50RGVmLmIyR2VhckpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIGIyR2VhckpvaW50RGVmLnByb3RvdHlwZS5iMkdlYXJKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnREZWYuY2FsbCh0aGlzKTtcclxuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX2dlYXJKb2ludDtcclxuICAgICAgdGhpcy5qb2ludDEgPSBudWxsO1xyXG4gICAgICB0aGlzLmpvaW50MiA9IG51bGw7XHJcbiAgICAgIHRoaXMucmF0aW8gPSAxLjA7XHJcbiAgIH1cclxuICAgYjJKYWNvYmlhbi5iMkphY29iaWFuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmxpbmVhckEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubGluZWFyQiA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJKYWNvYmlhbi5wcm90b3R5cGUuU2V0WmVybyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5saW5lYXJBLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5hbmd1bGFyQSA9IDAuMDtcclxuICAgICAgdGhpcy5saW5lYXJCLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5hbmd1bGFyQiA9IDAuMDtcclxuICAgfVxyXG4gICBiMkphY29iaWFuLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAoeDEsIGExLCB4MiwgYTIpIHtcclxuICAgICAgaWYgKGExID09PSB1bmRlZmluZWQpIGExID0gMDtcclxuICAgICAgaWYgKGEyID09PSB1bmRlZmluZWQpIGEyID0gMDtcclxuICAgICAgdGhpcy5saW5lYXJBLlNldFYoeDEpO1xyXG4gICAgICB0aGlzLmFuZ3VsYXJBID0gYTE7XHJcbiAgICAgIHRoaXMubGluZWFyQi5TZXRWKHgyKTtcclxuICAgICAgdGhpcy5hbmd1bGFyQiA9IGEyO1xyXG4gICB9XHJcbiAgIGIySmFjb2JpYW4ucHJvdG90eXBlLkNvbXB1dGUgPSBmdW5jdGlvbiAoeDEsIGExLCB4MiwgYTIpIHtcclxuICAgICAgaWYgKGExID09PSB1bmRlZmluZWQpIGExID0gMDtcclxuICAgICAgaWYgKGEyID09PSB1bmRlZmluZWQpIGEyID0gMDtcclxuICAgICAgcmV0dXJuICh0aGlzLmxpbmVhckEueCAqIHgxLnggKyB0aGlzLmxpbmVhckEueSAqIHgxLnkpICsgdGhpcy5hbmd1bGFyQSAqIGExICsgKHRoaXMubGluZWFyQi54ICogeDIueCArIHRoaXMubGluZWFyQi55ICogeDIueSkgKyB0aGlzLmFuZ3VsYXJCICogYTI7XHJcbiAgIH1cclxuICAgYjJKb2ludC5iMkpvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fZWRnZUEgPSBuZXcgYjJKb2ludEVkZ2UoKTtcclxuICAgICAgdGhpcy5tX2VkZ2VCID0gbmV3IGIySm9pbnRFZGdlKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbENlbnRlckEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbENlbnRlckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIySm9pbnQucHJvdG90eXBlLkdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcclxuICAgfVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JBID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgfVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgfVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICB9XHJcbiAgIGIySm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiAwLjA7XHJcbiAgIH1cclxuICAgYjJKb2ludC5wcm90b3R5cGUuR2V0Qm9keUEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUE7XHJcbiAgIH1cclxuICAgYjJKb2ludC5wcm90b3R5cGUuR2V0Qm9keUIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUI7XHJcbiAgIH1cclxuICAgYjJKb2ludC5wcm90b3R5cGUuR2V0TmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9uZXh0O1xyXG4gICB9XHJcbiAgIGIySm9pbnQucHJvdG90eXBlLkdldFVzZXJEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3VzZXJEYXRhO1xyXG4gICB9XHJcbiAgIGIySm9pbnQucHJvdG90eXBlLlNldFVzZXJEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGF0YTtcclxuICAgfVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5Jc0FjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5Jc0FjdGl2ZSgpICYmIHRoaXMubV9ib2R5Qi5Jc0FjdGl2ZSgpO1xyXG4gICB9XHJcbiAgIGIySm9pbnQuQ3JlYXRlID0gZnVuY3Rpb24gKGRlZiwgYWxsb2NhdG9yKSB7XHJcbiAgICAgIHZhciBqb2ludCA9IG51bGw7XHJcbiAgICAgIHN3aXRjaCAoZGVmLnR5cGUpIHtcclxuICAgICAgY2FzZSBiMkpvaW50LmVfZGlzdGFuY2VKb2ludDpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMkRpc3RhbmNlSm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyRGlzdGFuY2VKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMkpvaW50LmVfbW91c2VKb2ludDpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMk1vdXNlSm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyTW91c2VKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMkpvaW50LmVfcHJpc21hdGljSm9pbnQ6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgam9pbnQgPSBuZXcgYjJQcmlzbWF0aWNKb2ludCgoZGVmIGluc3RhbmNlb2YgYjJQcmlzbWF0aWNKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMkpvaW50LmVfcmV2b2x1dGVKb2ludDpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMlJldm9sdXRlSm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyUmV2b2x1dGVKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMkpvaW50LmVfcHVsbGV5Sm9pbnQ6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgam9pbnQgPSBuZXcgYjJQdWxsZXlKb2ludCgoZGVmIGluc3RhbmNlb2YgYjJQdWxsZXlKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMkpvaW50LmVfZ2VhckpvaW50OlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIGpvaW50ID0gbmV3IGIyR2VhckpvaW50KChkZWYgaW5zdGFuY2VvZiBiMkdlYXJKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMkpvaW50LmVfbGluZUpvaW50OlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIGpvaW50ID0gbmV3IGIyTGluZUpvaW50KChkZWYgaW5zdGFuY2VvZiBiMkxpbmVKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMkpvaW50LmVfd2VsZEpvaW50OlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIGpvaW50ID0gbmV3IGIyV2VsZEpvaW50KChkZWYgaW5zdGFuY2VvZiBiMldlbGRKb2ludERlZiA/IGRlZiA6IG51bGwpKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMkpvaW50LmVfZnJpY3Rpb25Kb2ludDpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMkZyaWN0aW9uSm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyRnJpY3Rpb25Kb2ludERlZiA/IGRlZiA6IG51bGwpKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGpvaW50O1xyXG4gICB9XHJcbiAgIGIySm9pbnQuRGVzdHJveSA9IGZ1bmN0aW9uIChqb2ludCwgYWxsb2NhdG9yKSB7fVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5iMkpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGRlZi5ib2R5QSAhPSBkZWYuYm9keUIpO1xyXG4gICAgICB0aGlzLm1fdHlwZSA9IGRlZi50eXBlO1xyXG4gICAgICB0aGlzLm1fcHJldiA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2JvZHlBID0gZGVmLmJvZHlBO1xyXG4gICAgICB0aGlzLm1fYm9keUIgPSBkZWYuYm9keUI7XHJcbiAgICAgIHRoaXMubV9jb2xsaWRlQ29ubmVjdGVkID0gZGVmLmNvbGxpZGVDb25uZWN0ZWQ7XHJcbiAgICAgIHRoaXMubV9pc2xhbmRGbGFnID0gZmFsc2U7XHJcbiAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRlZi51c2VyRGF0YTtcclxuICAgfVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7fVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge31cclxuICAgYjJKb2ludC5wcm90b3R5cGUuRmluYWxpemVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKCkge31cclxuICAgYjJKb2ludC5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xyXG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV91bmtub3duSm9pbnQgPSAwO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX3Jldm9sdXRlSm9pbnQgPSAxO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX3ByaXNtYXRpY0pvaW50ID0gMjtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9kaXN0YW5jZUpvaW50ID0gMztcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9wdWxsZXlKb2ludCA9IDQ7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfbW91c2VKb2ludCA9IDU7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfZ2VhckpvaW50ID0gNjtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9saW5lSm9pbnQgPSA3O1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX3dlbGRKb2ludCA9IDg7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfZnJpY3Rpb25Kb2ludCA9IDk7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfaW5hY3RpdmVMaW1pdCA9IDA7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfYXRMb3dlckxpbWl0ID0gMTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9hdFVwcGVyTGltaXQgPSAyO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX2VxdWFsTGltaXRzID0gMztcclxuICAgfSk7XHJcbiAgIGIySm9pbnREZWYuYjJKb2ludERlZiA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkpvaW50RGVmLnByb3RvdHlwZS5iMkpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnR5cGUgPSBiMkpvaW50LmVfdW5rbm93bkpvaW50O1xyXG4gICAgICB0aGlzLnVzZXJEYXRhID0gbnVsbDtcclxuICAgICAgdGhpcy5ib2R5QSA9IG51bGw7XHJcbiAgICAgIHRoaXMuYm9keUIgPSBudWxsO1xyXG4gICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSBmYWxzZTtcclxuICAgfVxyXG4gICBiMkpvaW50RWRnZS5iMkpvaW50RWRnZSA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBCb3gyRC5pbmhlcml0KGIyTGluZUpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xyXG4gICBiMkxpbmVKb2ludC5iMkxpbmVKb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxYQXhpczEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbFlBeGlzMSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2F4aXMgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9wZXJwID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fSyA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjEpO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoaW52X2R0ICogKHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC54ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS55KSAqIHRoaXMubV9heGlzLngpLCBpbnZfZHQgKiAodGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnkgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnkpICogdGhpcy5tX2F4aXMueSkpO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueTtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0Sm9pbnRUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgcDEgPSBiQS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjEpO1xyXG4gICAgICB2YXIgcDIgPSBiQi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xyXG4gICAgICB2YXIgZFggPSBwMi54IC0gcDEueDtcclxuICAgICAgdmFyIGRZID0gcDIueSAtIHAxLnk7XHJcbiAgICAgIHZhciBheGlzID0gYkEuR2V0V29ybGRWZWN0b3IodGhpcy5tX2xvY2FsWEF4aXMxKTtcclxuICAgICAgdmFyIHRyYW5zbGF0aW9uID0gYXhpcy54ICogZFggKyBheGlzLnkgKiBkWTtcclxuICAgICAgcmV0dXJuIHRyYW5zbGF0aW9uO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRKb2ludFNwZWVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHZhciB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICByMVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgcjJYID0gdFg7XHJcbiAgICAgIHZhciBwMVggPSBiQS5tX3N3ZWVwLmMueCArIHIxWDtcclxuICAgICAgdmFyIHAxWSA9IGJBLm1fc3dlZXAuYy55ICsgcjFZO1xyXG4gICAgICB2YXIgcDJYID0gYkIubV9zd2VlcC5jLnggKyByMlg7XHJcbiAgICAgIHZhciBwMlkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWTtcclxuICAgICAgdmFyIGRYID0gcDJYIC0gcDFYO1xyXG4gICAgICB2YXIgZFkgPSBwMlkgLSBwMVk7XHJcbiAgICAgIHZhciBheGlzID0gYkEuR2V0V29ybGRWZWN0b3IodGhpcy5tX2xvY2FsWEF4aXMxKTtcclxuICAgICAgdmFyIHYxID0gYkEubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHYyID0gYkIubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHcxID0gYkEubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3MiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgc3BlZWQgPSAoZFggKiAoKC13MSAqIGF4aXMueSkpICsgZFkgKiAodzEgKiBheGlzLngpKSArIChheGlzLnggKiAoKCh2Mi54ICsgKCgtdzIgKiByMlkpKSkgLSB2MS54KSAtICgoLXcxICogcjFZKSkpICsgYXhpcy55ICogKCgodjIueSArICh3MiAqIHIyWCkpIC0gdjEueSkgLSAodzEgKiByMVgpKSk7XHJcbiAgICAgIHJldHVybiBzcGVlZDtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuSXNMaW1pdEVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTGltaXQ7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkVuYWJsZUxpbWl0ID0gZnVuY3Rpb24gKGZsYWcpIHtcclxuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGZsYWc7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldExvd2VyTGltaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbjtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0VXBwZXJMaW1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV91cHBlclRyYW5zbGF0aW9uO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5TZXRMaW1pdHMgPSBmdW5jdGlvbiAobG93ZXIsIHVwcGVyKSB7XHJcbiAgICAgIGlmIChsb3dlciA9PT0gdW5kZWZpbmVkKSBsb3dlciA9IDA7XHJcbiAgICAgIGlmICh1cHBlciA9PT0gdW5kZWZpbmVkKSB1cHBlciA9IDA7XHJcbiAgICAgIHRoaXMubV9ib2R5QS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGxvd2VyO1xyXG4gICAgICB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiA9IHVwcGVyO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5Jc01vdG9yRW5hYmxlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9lbmFibGVNb3RvcjtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuRW5hYmxlTW90b3IgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZmxhZztcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuU2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uIChzcGVlZCkge1xyXG4gICAgICBpZiAoc3BlZWQgPT09IHVuZGVmaW5lZCkgc3BlZWQgPSAwO1xyXG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBzcGVlZDtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9tb3RvclNwZWVkO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5TZXRNYXhNb3RvckZvcmNlID0gZnVuY3Rpb24gKGZvcmNlKSB7XHJcbiAgICAgIGlmIChmb3JjZSA9PT0gdW5kZWZpbmVkKSBmb3JjZSA9IDA7XHJcbiAgICAgIHRoaXMubV9ib2R5QS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGZvcmNlO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRNYXhNb3RvckZvcmNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX21heE1vdG9yRm9yY2U7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldE1vdG9yRm9yY2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbW90b3JJbXB1bHNlO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5iMkxpbmVKb2ludCA9IGZ1bmN0aW9uIChkZWYpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnQuY2FsbCh0aGlzLCBkZWYpO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIHRZID0gMDtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMS5TZXRWKGRlZi5sb2NhbEFuY2hvckEpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyLlNldFYoZGVmLmxvY2FsQW5jaG9yQik7XHJcbiAgICAgIHRoaXMubV9sb2NhbFhBeGlzMS5TZXRWKGRlZi5sb2NhbEF4aXNBKTtcclxuICAgICAgdGhpcy5tX2xvY2FsWUF4aXMxLnggPSAoLXRoaXMubV9sb2NhbFhBeGlzMS55KTtcclxuICAgICAgdGhpcy5tX2xvY2FsWUF4aXMxLnkgPSB0aGlzLm1fbG9jYWxYQXhpczEueDtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fbW90b3JNYXNzID0gMC4wO1xyXG4gICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMC4wO1xyXG4gICAgICB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGRlZi5sb3dlclRyYW5zbGF0aW9uO1xyXG4gICAgICB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiA9IGRlZi51cHBlclRyYW5zbGF0aW9uO1xyXG4gICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGRlZi5tYXhNb3RvckZvcmNlO1xyXG4gICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xyXG4gICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBkZWYuZW5hYmxlTGltaXQ7XHJcbiAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcclxuICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgdGhpcy5tX2F4aXMuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fcGVycC5TZXRaZXJvKCk7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBLlNldFYoYkEuR2V0TG9jYWxDZW50ZXIoKSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbENlbnRlckIuU2V0VihiQi5HZXRMb2NhbENlbnRlcigpKTtcclxuICAgICAgdmFyIHhmMSA9IGJBLkdldFRyYW5zZm9ybSgpO1xyXG4gICAgICB2YXIgeGYyID0gYkIuR2V0VHJhbnNmb3JtKCk7XHJcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSB0aGlzLm1fbG9jYWxDZW50ZXJBLng7XHJcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSB0aGlzLm1fbG9jYWxDZW50ZXJBLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgIHIxWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gdGhpcy5tX2xvY2FsQ2VudGVyQi54O1xyXG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gdGhpcy5tX2xvY2FsQ2VudGVyQi55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICByMlggPSB0WDtcclxuICAgICAgdmFyIGRYID0gYkIubV9zd2VlcC5jLnggKyByMlggLSBiQS5tX3N3ZWVwLmMueCAtIHIxWDtcclxuICAgICAgdmFyIGRZID0gYkIubV9zd2VlcC5jLnkgKyByMlkgLSBiQS5tX3N3ZWVwLmMueSAtIHIxWTtcclxuICAgICAgdGhpcy5tX2ludk1hc3NBID0gYkEubV9pbnZNYXNzO1xyXG4gICAgICB0aGlzLm1faW52TWFzc0IgPSBiQi5tX2ludk1hc3M7XHJcbiAgICAgIHRoaXMubV9pbnZJQSA9IGJBLm1faW52STtcclxuICAgICAgdGhpcy5tX2ludklCID0gYkIubV9pbnZJOyB7XHJcbiAgICAgICAgIHRoaXMubV9heGlzLlNldFYoYjJNYXRoLk11bE1WKHhmMS5SLCB0aGlzLm1fbG9jYWxYQXhpczEpKTtcclxuICAgICAgICAgdGhpcy5tX2ExID0gKGRYICsgcjFYKSAqIHRoaXMubV9heGlzLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgdGhpcy5tX2EyID0gcjJYICogdGhpcy5tX2F4aXMueSAtIHIyWSAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSB0aGlzLm1faW52TWFzc0EgKyB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUEgKiB0aGlzLm1fYTEgKiB0aGlzLm1fYTEgKyB0aGlzLm1faW52SUIgKiB0aGlzLm1fYTIgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSB0aGlzLm1fbW90b3JNYXNzID4gTnVtYmVyLk1JTl9WQUxVRSA/IDEuMCAvIHRoaXMubV9tb3Rvck1hc3MgOiAwLjA7XHJcbiAgICAgIH0ge1xyXG4gICAgICAgICB0aGlzLm1fcGVycC5TZXRWKGIyTWF0aC5NdWxNVih4ZjEuUiwgdGhpcy5tX2xvY2FsWUF4aXMxKSk7XHJcbiAgICAgICAgIHRoaXMubV9zMSA9IChkWCArIHIxWCkgKiB0aGlzLm1fcGVycC55IC0gKGRZICsgcjFZKSAqIHRoaXMubV9wZXJwLng7XHJcbiAgICAgICAgIHRoaXMubV9zMiA9IHIyWCAqIHRoaXMubV9wZXJwLnkgLSByMlkgKiB0aGlzLm1fcGVycC54O1xyXG4gICAgICAgICB2YXIgbTEgPSB0aGlzLm1faW52TWFzc0E7XHJcbiAgICAgICAgIHZhciBtMiA9IHRoaXMubV9pbnZNYXNzQjtcclxuICAgICAgICAgdmFyIGkxID0gdGhpcy5tX2ludklBO1xyXG4gICAgICAgICB2YXIgaTIgPSB0aGlzLm1faW52SUI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueCA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX3MyO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wxLnkgPSBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX2EyO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wyLnggPSB0aGlzLm1fSy5jb2wxLnk7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueSA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9hMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQpIHtcclxuICAgICAgICAgdmFyIGpvaW50VHJhbnNpdGlvbiA9IHRoaXMubV9heGlzLnggKiBkWCArIHRoaXMubV9heGlzLnkgKiBkWTtcclxuICAgICAgICAgaWYgKGIyTWF0aC5BYnModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfZXF1YWxMaW1pdHM7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAoam9pbnRUcmFuc2l0aW9uIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfYXRMb3dlckxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdDtcclxuICAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSA9IDAuMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYgKGpvaW50VHJhbnNpdGlvbiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQ7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSAwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSA9IDAuMDtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgPT0gZmFsc2UpIHtcclxuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdmFyIFBYID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnggKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnkpICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgdmFyIFBZID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnkgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnkpICogdGhpcy5tX2F4aXMueTtcclxuICAgICAgICAgdmFyIEwxID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9zMSArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueSkgKiB0aGlzLm1fYTE7XHJcbiAgICAgICAgIHZhciBMMiA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fczIgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnkpICogdGhpcy5tX2EyO1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcclxuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgLT0gdGhpcy5tX2ludklBICogTDE7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSB0aGlzLm1faW52SUIgKiBMMjtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMC4wO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgdjEgPSBiQS5tX2xpbmVhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdzEgPSBiQS5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHYyID0gYkIubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHcyID0gYkIubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciBQWCA9IDA7XHJcbiAgICAgIHZhciBQWSA9IDA7XHJcbiAgICAgIHZhciBMMSA9IDA7XHJcbiAgICAgIHZhciBMMiA9IDA7XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2VxdWFsTGltaXRzKSB7XHJcbiAgICAgICAgIHZhciBDZG90ID0gdGhpcy5tX2F4aXMueCAqICh2Mi54IC0gdjEueCkgKyB0aGlzLm1fYXhpcy55ICogKHYyLnkgLSB2MS55KSArIHRoaXMubV9hMiAqIHcyIC0gdGhpcy5tX2ExICogdzE7XHJcbiAgICAgICAgIHZhciBpbXB1bHNlID0gdGhpcy5tX21vdG9yTWFzcyAqICh0aGlzLm1fbW90b3JTcGVlZCAtIENkb3QpO1xyXG4gICAgICAgICB2YXIgb2xkSW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2U7XHJcbiAgICAgICAgIHZhciBtYXhJbXB1bHNlID0gc3RlcC5kdCAqIHRoaXMubV9tYXhNb3RvckZvcmNlO1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gYjJNYXRoLkNsYW1wKHRoaXMubV9tb3RvckltcHVsc2UgKyBpbXB1bHNlLCAoLW1heEltcHVsc2UpLCBtYXhJbXB1bHNlKTtcclxuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2UgLSBvbGRJbXB1bHNlO1xyXG4gICAgICAgICBQWCA9IGltcHVsc2UgKiB0aGlzLm1fYXhpcy54O1xyXG4gICAgICAgICBQWSA9IGltcHVsc2UgKiB0aGlzLm1fYXhpcy55O1xyXG4gICAgICAgICBMMSA9IGltcHVsc2UgKiB0aGlzLm1fYTE7XHJcbiAgICAgICAgIEwyID0gaW1wdWxzZSAqIHRoaXMubV9hMjtcclxuICAgICAgICAgdjEueCAtPSB0aGlzLm1faW52TWFzc0EgKiBQWDtcclxuICAgICAgICAgdjEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcclxuICAgICAgICAgdzEgLT0gdGhpcy5tX2ludklBICogTDE7XHJcbiAgICAgICAgIHYyLnggKz0gdGhpcy5tX2ludk1hc3NCICogUFg7XHJcbiAgICAgICAgIHYyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XHJcbiAgICAgICAgIHcyICs9IHRoaXMubV9pbnZJQiAqIEwyO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBDZG90MSA9IHRoaXMubV9wZXJwLnggKiAodjIueCAtIHYxLngpICsgdGhpcy5tX3BlcnAueSAqICh2Mi55IC0gdjEueSkgKyB0aGlzLm1fczIgKiB3MiAtIHRoaXMubV9zMSAqIHcxO1xyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0ICYmIHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0KSB7XHJcbiAgICAgICAgIHZhciBDZG90MiA9IHRoaXMubV9heGlzLnggKiAodjIueCAtIHYxLngpICsgdGhpcy5tX2F4aXMueSAqICh2Mi55IC0gdjEueSkgKyB0aGlzLm1fYTIgKiB3MiAtIHRoaXMubV9hMSAqIHcxO1xyXG4gICAgICAgICB2YXIgZjEgPSB0aGlzLm1faW1wdWxzZS5Db3B5KCk7XHJcbiAgICAgICAgIHZhciBkZiA9IHRoaXMubV9LLlNvbHZlKG5ldyBiMlZlYzIoKSwgKC1DZG90MSksICgtQ2RvdDIpKTtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UuQWRkKGRmKTtcclxuICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IGIySm9pbnQuZV9hdExvd2VyTGltaXQpIHtcclxuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSA9IGIyTWF0aC5NYXgodGhpcy5tX2ltcHVsc2UueSwgMC4wKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSBiMk1hdGguTWluKHRoaXMubV9pbXB1bHNlLnksIDAuMCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIGIgPSAoLUNkb3QxKSAtICh0aGlzLm1faW1wdWxzZS55IC0gZjEueSkgKiB0aGlzLm1fSy5jb2wyLng7XHJcbiAgICAgICAgIHZhciBmMnIgPSAwO1xyXG4gICAgICAgICBpZiAodGhpcy5tX0suY29sMS54ICE9IDAuMCkge1xyXG4gICAgICAgICAgICBmMnIgPSBiIC8gdGhpcy5tX0suY29sMS54ICsgZjEueDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZjJyID0gZjEueDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ID0gZjJyO1xyXG4gICAgICAgICBkZi54ID0gdGhpcy5tX2ltcHVsc2UueCAtIGYxLng7XHJcbiAgICAgICAgIGRmLnkgPSB0aGlzLm1faW1wdWxzZS55IC0gZjEueTtcclxuICAgICAgICAgUFggPSBkZi54ICogdGhpcy5tX3BlcnAueCArIGRmLnkgKiB0aGlzLm1fYXhpcy54O1xyXG4gICAgICAgICBQWSA9IGRmLnggKiB0aGlzLm1fcGVycC55ICsgZGYueSAqIHRoaXMubV9heGlzLnk7XHJcbiAgICAgICAgIEwxID0gZGYueCAqIHRoaXMubV9zMSArIGRmLnkgKiB0aGlzLm1fYTE7XHJcbiAgICAgICAgIEwyID0gZGYueCAqIHRoaXMubV9zMiArIGRmLnkgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHYxLnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XHJcbiAgICAgICAgIHYxLnkgLT0gdGhpcy5tX2ludk1hc3NBICogUFk7XHJcbiAgICAgICAgIHcxIC09IHRoaXMubV9pbnZJQSAqIEwxO1xyXG4gICAgICAgICB2Mi54ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBYO1xyXG4gICAgICAgICB2Mi55ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICB3MiArPSB0aGlzLm1faW52SUIgKiBMMjtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdmFyIGRmMiA9IDA7XHJcbiAgICAgICAgIGlmICh0aGlzLm1fSy5jb2wxLnggIT0gMC4wKSB7XHJcbiAgICAgICAgICAgIGRmMiA9ICgoLUNkb3QxKSkgLyB0aGlzLm1fSy5jb2wxLng7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGRmMiA9IDAuMDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IGRmMjtcclxuICAgICAgICAgUFggPSBkZjIgKiB0aGlzLm1fcGVycC54O1xyXG4gICAgICAgICBQWSA9IGRmMiAqIHRoaXMubV9wZXJwLnk7XHJcbiAgICAgICAgIEwxID0gZGYyICogdGhpcy5tX3MxO1xyXG4gICAgICAgICBMMiA9IGRmMiAqIHRoaXMubV9zMjtcclxuICAgICAgICAgdjEueCAtPSB0aGlzLm1faW52TWFzc0EgKiBQWDtcclxuICAgICAgICAgdjEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcclxuICAgICAgICAgdzEgLT0gdGhpcy5tX2ludklBICogTDE7XHJcbiAgICAgICAgIHYyLnggKz0gdGhpcy5tX2ludk1hc3NCICogUFg7XHJcbiAgICAgICAgIHYyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XHJcbiAgICAgICAgIHcyICs9IHRoaXMubV9pbnZJQiAqIEwyO1xyXG4gICAgICB9XHJcbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkuU2V0Vih2MSk7XHJcbiAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ID0gdzE7XHJcbiAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkuU2V0Vih2Mik7XHJcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ID0gdzI7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcclxuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xyXG4gICAgICB2YXIgbGltaXRDID0gMDtcclxuICAgICAgdmFyIG9sZExpbWl0SW1wdWxzZSA9IDA7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgYzEgPSBiQS5tX3N3ZWVwLmM7XHJcbiAgICAgIHZhciBhMSA9IGJBLm1fc3dlZXAuYTtcclxuICAgICAgdmFyIGMyID0gYkIubV9zd2VlcC5jO1xyXG4gICAgICB2YXIgYTIgPSBiQi5tX3N3ZWVwLmE7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgbTEgPSAwO1xyXG4gICAgICB2YXIgbTIgPSAwO1xyXG4gICAgICB2YXIgaTEgPSAwO1xyXG4gICAgICB2YXIgaTIgPSAwO1xyXG4gICAgICB2YXIgbGluZWFyRXJyb3IgPSAwLjA7XHJcbiAgICAgIHZhciBhbmd1bGFyRXJyb3IgPSAwLjA7XHJcbiAgICAgIHZhciBhY3RpdmUgPSBmYWxzZTtcclxuICAgICAgdmFyIEMyID0gMC4wO1xyXG4gICAgICB2YXIgUjEgPSBiMk1hdDIyLkZyb21BbmdsZShhMSk7XHJcbiAgICAgIHZhciBSMiA9IGIyTWF0MjIuRnJvbUFuZ2xlKGEyKTtcclxuICAgICAgdE1hdCA9IFIxO1xyXG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gdGhpcy5tX2xvY2FsQ2VudGVyQS54O1xyXG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gdGhpcy5tX2xvY2FsQ2VudGVyQS55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICByMVggPSB0WDtcclxuICAgICAgdE1hdCA9IFIyO1xyXG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gdGhpcy5tX2xvY2FsQ2VudGVyQi54O1xyXG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gdGhpcy5tX2xvY2FsQ2VudGVyQi55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICByMlggPSB0WDtcclxuICAgICAgdmFyIGRYID0gYzIueCArIHIyWCAtIGMxLnggLSByMVg7XHJcbiAgICAgIHZhciBkWSA9IGMyLnkgKyByMlkgLSBjMS55IC0gcjFZO1xyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0KSB7XHJcbiAgICAgICAgIHRoaXMubV9heGlzID0gYjJNYXRoLk11bE1WKFIxLCB0aGlzLm1fbG9jYWxYQXhpczEpO1xyXG4gICAgICAgICB0aGlzLm1fYTEgPSAoZFggKyByMVgpICogdGhpcy5tX2F4aXMueSAtIChkWSArIHIxWSkgKiB0aGlzLm1fYXhpcy54O1xyXG4gICAgICAgICB0aGlzLm1fYTIgPSByMlggKiB0aGlzLm1fYXhpcy55IC0gcjJZICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgdmFyIHRyYW5zbGF0aW9uID0gdGhpcy5tX2F4aXMueCAqIGRYICsgdGhpcy5tX2F4aXMueSAqIGRZO1xyXG4gICAgICAgICBpZiAoYjJNYXRoLkFicyh0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiAtIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSA8IDIuMCAqIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xyXG4gICAgICAgICAgICBDMiA9IGIyTWF0aC5DbGFtcCh0cmFuc2xhdGlvbiwgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCBiMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pO1xyXG4gICAgICAgICAgICBsaW5lYXJFcnJvciA9IGIyTWF0aC5BYnModHJhbnNsYXRpb24pO1xyXG4gICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYgKHRyYW5zbGF0aW9uIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XHJcbiAgICAgICAgICAgIEMyID0gYjJNYXRoLkNsYW1wKHRyYW5zbGF0aW9uIC0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gKyBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AsICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgMC4wKTtcclxuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiAtIHRyYW5zbGF0aW9uO1xyXG4gICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYgKHRyYW5zbGF0aW9uID49IHRoaXMubV91cHBlclRyYW5zbGF0aW9uKSB7XHJcbiAgICAgICAgICAgIEMyID0gYjJNYXRoLkNsYW1wKHRyYW5zbGF0aW9uIC0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gKyBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AsIDAuMCwgYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKTtcclxuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSB0cmFuc2xhdGlvbiAtIHRoaXMubV91cHBlclRyYW5zbGF0aW9uO1xyXG4gICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX3BlcnAgPSBiMk1hdGguTXVsTVYoUjEsIHRoaXMubV9sb2NhbFlBeGlzMSk7XHJcbiAgICAgIHRoaXMubV9zMSA9IChkWCArIHIxWCkgKiB0aGlzLm1fcGVycC55IC0gKGRZICsgcjFZKSAqIHRoaXMubV9wZXJwLng7XHJcbiAgICAgIHRoaXMubV9zMiA9IHIyWCAqIHRoaXMubV9wZXJwLnkgLSByMlkgKiB0aGlzLm1fcGVycC54O1xyXG4gICAgICB2YXIgaW1wdWxzZSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdmFyIEMxID0gdGhpcy5tX3BlcnAueCAqIGRYICsgdGhpcy5tX3BlcnAueSAqIGRZO1xyXG4gICAgICBsaW5lYXJFcnJvciA9IGIyTWF0aC5NYXgobGluZWFyRXJyb3IsIGIyTWF0aC5BYnMoQzEpKTtcclxuICAgICAgYW5ndWxhckVycm9yID0gMC4wO1xyXG4gICAgICBpZiAoYWN0aXZlKSB7XHJcbiAgICAgICAgIG0xID0gdGhpcy5tX2ludk1hc3NBO1xyXG4gICAgICAgICBtMiA9IHRoaXMubV9pbnZNYXNzQjtcclxuICAgICAgICAgaTEgPSB0aGlzLm1faW52SUE7XHJcbiAgICAgICAgIGkyID0gdGhpcy5tX2ludklCO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wxLnggPSBtMSArIG0yICsgaTEgKiB0aGlzLm1fczEgKiB0aGlzLm1fczEgKyBpMiAqIHRoaXMubV9zMiAqIHRoaXMubV9zMjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMS55ID0gaTEgKiB0aGlzLm1fczEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9zMiAqIHRoaXMubV9hMjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMi54ID0gdGhpcy5tX0suY29sMS55O1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wyLnkgPSBtMSArIG0yICsgaTEgKiB0aGlzLm1fYTEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9hMiAqIHRoaXMubV9hMjtcclxuICAgICAgICAgdGhpcy5tX0suU29sdmUoaW1wdWxzZSwgKC1DMSksICgtQzIpKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgbTEgPSB0aGlzLm1faW52TWFzc0E7XHJcbiAgICAgICAgIG0yID0gdGhpcy5tX2ludk1hc3NCO1xyXG4gICAgICAgICBpMSA9IHRoaXMubV9pbnZJQTtcclxuICAgICAgICAgaTIgPSB0aGlzLm1faW52SUI7XHJcbiAgICAgICAgIHZhciBrMTEgPSBtMSArIG0yICsgaTEgKiB0aGlzLm1fczEgKiB0aGlzLm1fczEgKyBpMiAqIHRoaXMubV9zMiAqIHRoaXMubV9zMjtcclxuICAgICAgICAgdmFyIGltcHVsc2UxID0gMDtcclxuICAgICAgICAgaWYgKGsxMSAhPSAwLjApIHtcclxuICAgICAgICAgICAgaW1wdWxzZTEgPSAoKC1DMSkpIC8gazExO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpbXB1bHNlMSA9IDAuMDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpbXB1bHNlLnggPSBpbXB1bHNlMTtcclxuICAgICAgICAgaW1wdWxzZS55ID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBQWCA9IGltcHVsc2UueCAqIHRoaXMubV9wZXJwLnggKyBpbXB1bHNlLnkgKiB0aGlzLm1fYXhpcy54O1xyXG4gICAgICB2YXIgUFkgPSBpbXB1bHNlLnggKiB0aGlzLm1fcGVycC55ICsgaW1wdWxzZS55ICogdGhpcy5tX2F4aXMueTtcclxuICAgICAgdmFyIEwxID0gaW1wdWxzZS54ICogdGhpcy5tX3MxICsgaW1wdWxzZS55ICogdGhpcy5tX2ExO1xyXG4gICAgICB2YXIgTDIgPSBpbXB1bHNlLnggKiB0aGlzLm1fczIgKyBpbXB1bHNlLnkgKiB0aGlzLm1fYTI7XHJcbiAgICAgIGMxLnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XHJcbiAgICAgIGMxLnkgLT0gdGhpcy5tX2ludk1hc3NBICogUFk7XHJcbiAgICAgIGExIC09IHRoaXMubV9pbnZJQSAqIEwxO1xyXG4gICAgICBjMi54ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBYO1xyXG4gICAgICBjMi55ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBZO1xyXG4gICAgICBhMiArPSB0aGlzLm1faW52SUIgKiBMMjtcclxuICAgICAgYkEubV9zd2VlcC5hID0gYTE7XHJcbiAgICAgIGJCLm1fc3dlZXAuYSA9IGEyO1xyXG4gICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICByZXR1cm4gbGluZWFyRXJyb3IgPD0gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wICYmIGFuZ3VsYXJFcnJvciA8PSBiMlNldHRpbmdzLmIyX2FuZ3VsYXJTbG9wO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJMaW5lSm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcclxuICAgYjJMaW5lSm9pbnREZWYucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5wcm90b3R5cGU7XHJcbiAgIGIyTGluZUpvaW50RGVmLmIyTGluZUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5sb2NhbEF4aXNBID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkxpbmVKb2ludERlZi5wcm90b3R5cGUuYjJMaW5lSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9saW5lSm9pbnQ7XHJcbiAgICAgIHRoaXMubG9jYWxBeGlzQS5TZXQoMS4wLCAwLjApO1xyXG4gICAgICB0aGlzLmVuYWJsZUxpbWl0ID0gZmFsc2U7XHJcbiAgICAgIHRoaXMubG93ZXJUcmFuc2xhdGlvbiA9IDAuMDtcclxuICAgICAgdGhpcy51cHBlclRyYW5zbGF0aW9uID0gMC4wO1xyXG4gICAgICB0aGlzLmVuYWJsZU1vdG9yID0gZmFsc2U7XHJcbiAgICAgIHRoaXMubWF4TW90b3JGb3JjZSA9IDAuMDtcclxuICAgICAgdGhpcy5tb3RvclNwZWVkID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50RGVmLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKGJBLCBiQiwgYW5jaG9yLCBheGlzKSB7XHJcbiAgICAgIHRoaXMuYm9keUEgPSBiQTtcclxuICAgICAgdGhpcy5ib2R5QiA9IGJCO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3IpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IHRoaXMuYm9keUIuR2V0TG9jYWxQb2ludChhbmNob3IpO1xyXG4gICAgICB0aGlzLmxvY2FsQXhpc0EgPSB0aGlzLmJvZHlBLkdldExvY2FsVmVjdG9yKGF4aXMpO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJNb3VzZUpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LnByb3RvdHlwZTtcclxuICAgYjJNb3VzZUpvaW50LmIyTW91c2VKb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLksgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICB0aGlzLksxID0gbmV3IGIyTWF0MjIoKTtcclxuICAgICAgdGhpcy5LMiA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvciA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX3RhcmdldCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9tYXNzID0gbmV3IGIyTWF0MjIoKTtcclxuICAgICAgdGhpcy5tX0MgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV90YXJnZXQ7XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yKTtcclxuICAgfVxyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uRm9yY2UgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueCwgaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueSk7XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gMC4wO1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuR2V0VGFyZ2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3RhcmdldDtcclxuICAgfVxyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLlNldFRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgaWYgKHRoaXMubV9ib2R5Qi5Jc0F3YWtlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV90YXJnZXQgPSB0YXJnZXQ7XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5HZXRNYXhGb3JjZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9tYXhGb3JjZTtcclxuICAgfVxyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLlNldE1heEZvcmNlID0gZnVuY3Rpb24gKG1heEZvcmNlKSB7XHJcbiAgICAgIGlmIChtYXhGb3JjZSA9PT0gdW5kZWZpbmVkKSBtYXhGb3JjZSA9IDA7XHJcbiAgICAgIHRoaXMubV9tYXhGb3JjZSA9IG1heEZvcmNlO1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuR2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2ZyZXF1ZW5jeUh6O1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuU2V0RnJlcXVlbmN5ID0gZnVuY3Rpb24gKGh6KSB7XHJcbiAgICAgIGlmIChoeiA9PT0gdW5kZWZpbmVkKSBoeiA9IDA7XHJcbiAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGh6O1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuR2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2RhbXBpbmdSYXRpbztcclxuICAgfVxyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLlNldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uIChyYXRpbykge1xyXG4gICAgICBpZiAocmF0aW8gPT09IHVuZGVmaW5lZCkgcmF0aW8gPSAwO1xyXG4gICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gcmF0aW87XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5iMk1vdXNlSm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcclxuICAgICAgdGhpcy5tX3RhcmdldC5TZXRWKGRlZi50YXJnZXQpO1xyXG4gICAgICB2YXIgdFggPSB0aGlzLm1fdGFyZ2V0LnggLSB0aGlzLm1fYm9keUIubV94Zi5wb3NpdGlvbi54O1xyXG4gICAgICB2YXIgdFkgPSB0aGlzLm1fdGFyZ2V0LnkgLSB0aGlzLm1fYm9keUIubV94Zi5wb3NpdGlvbi55O1xyXG4gICAgICB2YXIgdE1hdCA9IHRoaXMubV9ib2R5Qi5tX3hmLlI7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvci54ID0gKHRYICogdE1hdC5jb2wxLnggKyB0WSAqIHRNYXQuY29sMS55KTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yLnkgPSAodFggKiB0TWF0LmNvbDIueCArIHRZICogdE1hdC5jb2wyLnkpO1xyXG4gICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBkZWYubWF4Rm9yY2U7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gZGVmLmZyZXF1ZW5jeUh6O1xyXG4gICAgICB0aGlzLm1fZGFtcGluZ1JhdGlvID0gZGVmLmRhbXBpbmdSYXRpbztcclxuICAgICAgdGhpcy5tX2JldGEgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9nYW1tYSA9IDAuMDtcclxuICAgfVxyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciBtYXNzID0gYi5HZXRNYXNzKCk7XHJcbiAgICAgIHZhciBvbWVnYSA9IDIuMCAqIE1hdGguUEkgKiB0aGlzLm1fZnJlcXVlbmN5SHo7XHJcbiAgICAgIHZhciBkID0gMi4wICogbWFzcyAqIHRoaXMubV9kYW1waW5nUmF0aW8gKiBvbWVnYTtcclxuICAgICAgdmFyIGsgPSBtYXNzICogb21lZ2EgKiBvbWVnYTtcclxuICAgICAgdGhpcy5tX2dhbW1hID0gc3RlcC5kdCAqIChkICsgc3RlcC5kdCAqIGspO1xyXG4gICAgICB0aGlzLm1fZ2FtbWEgPSB0aGlzLm1fZ2FtbWEgIT0gMCA/IDEgLyB0aGlzLm1fZ2FtbWEgOiAwLjA7XHJcbiAgICAgIHRoaXMubV9iZXRhID0gc3RlcC5kdCAqIGsgKiB0aGlzLm1fZ2FtbWE7XHJcbiAgICAgIHZhciB0TWF0O3RNYXQgPSBiLm1feGYuUjtcclxuICAgICAgdmFyIHJYID0gdGhpcy5tX2xvY2FsQW5jaG9yLnggLSBiLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJZID0gdGhpcy5tX2xvY2FsQW5jaG9yLnkgLSBiLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdmFyIHRYID0gKHRNYXQuY29sMS54ICogclggKyB0TWF0LmNvbDIueCAqIHJZKTtyWSA9ICh0TWF0LmNvbDEueSAqIHJYICsgdE1hdC5jb2wyLnkgKiByWSk7XHJcbiAgICAgIHJYID0gdFg7XHJcbiAgICAgIHZhciBpbnZNYXNzID0gYi5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBpbnZJID0gYi5tX2ludkk7dGhpcy5LMS5jb2wxLnggPSBpbnZNYXNzO1xyXG4gICAgICB0aGlzLksxLmNvbDIueCA9IDAuMDtcclxuICAgICAgdGhpcy5LMS5jb2wxLnkgPSAwLjA7XHJcbiAgICAgIHRoaXMuSzEuY29sMi55ID0gaW52TWFzcztcclxuICAgICAgdGhpcy5LMi5jb2wxLnggPSBpbnZJICogclkgKiByWTtcclxuICAgICAgdGhpcy5LMi5jb2wyLnggPSAoLWludkkgKiByWCAqIHJZKTtcclxuICAgICAgdGhpcy5LMi5jb2wxLnkgPSAoLWludkkgKiByWCAqIHJZKTtcclxuICAgICAgdGhpcy5LMi5jb2wyLnkgPSBpbnZJICogclggKiByWDtcclxuICAgICAgdGhpcy5LLlNldE0odGhpcy5LMSk7XHJcbiAgICAgIHRoaXMuSy5BZGRNKHRoaXMuSzIpO1xyXG4gICAgICB0aGlzLksuY29sMS54ICs9IHRoaXMubV9nYW1tYTtcclxuICAgICAgdGhpcy5LLmNvbDIueSArPSB0aGlzLm1fZ2FtbWE7XHJcbiAgICAgIHRoaXMuSy5HZXRJbnZlcnNlKHRoaXMubV9tYXNzKTtcclxuICAgICAgdGhpcy5tX0MueCA9IGIubV9zd2VlcC5jLnggKyByWCAtIHRoaXMubV90YXJnZXQueDtcclxuICAgICAgdGhpcy5tX0MueSA9IGIubV9zd2VlcC5jLnkgKyByWSAtIHRoaXMubV90YXJnZXQueTtcclxuICAgICAgYi5tX2FuZ3VsYXJWZWxvY2l0eSAqPSAwLjk4O1xyXG4gICAgICB0aGlzLm1faW1wdWxzZS54ICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgdGhpcy5tX2ltcHVsc2UueSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgIGIubV9saW5lYXJWZWxvY2l0eS54ICs9IGludk1hc3MgKiB0aGlzLm1faW1wdWxzZS54O1xyXG4gICAgICBiLm1fbGluZWFyVmVsb2NpdHkueSArPSBpbnZNYXNzICogdGhpcy5tX2ltcHVsc2UueTtcclxuICAgICAgYi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBpbnZJICogKHJYICogdGhpcy5tX2ltcHVsc2UueSAtIHJZICogdGhpcy5tX2ltcHVsc2UueCk7XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgYiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciB0WSA9IDA7XHJcbiAgICAgIHRNYXQgPSBiLm1feGYuUjtcclxuICAgICAgdmFyIHJYID0gdGhpcy5tX2xvY2FsQW5jaG9yLnggLSBiLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJZID0gdGhpcy5tX2xvY2FsQW5jaG9yLnkgLSBiLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByWCArIHRNYXQuY29sMi54ICogclkpO1xyXG4gICAgICByWSA9ICh0TWF0LmNvbDEueSAqIHJYICsgdE1hdC5jb2wyLnkgKiByWSk7XHJcbiAgICAgIHJYID0gdFg7XHJcbiAgICAgIHZhciBDZG90WCA9IGIubV9saW5lYXJWZWxvY2l0eS54ICsgKCgtYi5tX2FuZ3VsYXJWZWxvY2l0eSAqIHJZKSk7XHJcbiAgICAgIHZhciBDZG90WSA9IGIubV9saW5lYXJWZWxvY2l0eS55ICsgKGIubV9hbmd1bGFyVmVsb2NpdHkgKiByWCk7XHJcbiAgICAgIHRNYXQgPSB0aGlzLm1fbWFzcztcclxuICAgICAgdFggPSBDZG90WCArIHRoaXMubV9iZXRhICogdGhpcy5tX0MueCArIHRoaXMubV9nYW1tYSAqIHRoaXMubV9pbXB1bHNlLng7XHJcbiAgICAgIHRZID0gQ2RvdFkgKyB0aGlzLm1fYmV0YSAqIHRoaXMubV9DLnkgKyB0aGlzLm1fZ2FtbWEgKiB0aGlzLm1faW1wdWxzZS55O1xyXG4gICAgICB2YXIgaW1wdWxzZVggPSAoLSh0TWF0LmNvbDEueCAqIHRYICsgdE1hdC5jb2wyLnggKiB0WSkpO1xyXG4gICAgICB2YXIgaW1wdWxzZVkgPSAoLSh0TWF0LmNvbDEueSAqIHRYICsgdE1hdC5jb2wyLnkgKiB0WSkpO1xyXG4gICAgICB2YXIgb2xkSW1wdWxzZVggPSB0aGlzLm1faW1wdWxzZS54O1xyXG4gICAgICB2YXIgb2xkSW1wdWxzZVkgPSB0aGlzLm1faW1wdWxzZS55O1xyXG4gICAgICB0aGlzLm1faW1wdWxzZS54ICs9IGltcHVsc2VYO1xyXG4gICAgICB0aGlzLm1faW1wdWxzZS55ICs9IGltcHVsc2VZO1xyXG4gICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4Rm9yY2U7XHJcbiAgICAgIGlmICh0aGlzLm1faW1wdWxzZS5MZW5ndGhTcXVhcmVkKCkgPiBtYXhJbXB1bHNlICogbWF4SW1wdWxzZSkge1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS5NdWx0aXBseShtYXhJbXB1bHNlIC8gdGhpcy5tX2ltcHVsc2UuTGVuZ3RoKCkpO1xyXG4gICAgICB9XHJcbiAgICAgIGltcHVsc2VYID0gdGhpcy5tX2ltcHVsc2UueCAtIG9sZEltcHVsc2VYO1xyXG4gICAgICBpbXB1bHNlWSA9IHRoaXMubV9pbXB1bHNlLnkgLSBvbGRJbXB1bHNlWTtcclxuICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnggKz0gYi5tX2ludk1hc3MgKiBpbXB1bHNlWDtcclxuICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYi5tX2ludk1hc3MgKiBpbXB1bHNlWTtcclxuICAgICAgYi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiLm1faW52SSAqIChyWCAqIGltcHVsc2VZIC0gclkgKiBpbXB1bHNlWCk7XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XHJcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgQm94MkQuaW5oZXJpdChiMk1vdXNlSm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcclxuICAgYjJNb3VzZUpvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xyXG4gICBiMk1vdXNlSm9pbnREZWYuYjJNb3VzZUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMudGFyZ2V0ID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMk1vdXNlSm9pbnREZWYucHJvdG90eXBlLmIyTW91c2VKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnREZWYuY2FsbCh0aGlzKTtcclxuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX21vdXNlSm9pbnQ7XHJcbiAgICAgIHRoaXMubWF4Rm9yY2UgPSAwLjA7XHJcbiAgICAgIHRoaXMuZnJlcXVlbmN5SHogPSA1LjA7XHJcbiAgICAgIHRoaXMuZGFtcGluZ1JhdGlvID0gMC43O1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJQcmlzbWF0aWNKb2ludCwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQpO1xyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xyXG4gICBiMlByaXNtYXRpY0pvaW50LmIyUHJpc21hdGljSm9pbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmIySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsWEF4aXMxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxZQXhpczEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9heGlzID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fcGVycCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX0sgPSBuZXcgYjJNYXQzMygpO1xyXG4gICAgICB0aGlzLm1faW1wdWxzZSA9IG5ldyBiMlZlYzMoKTtcclxuICAgfTtcclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjEpO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IyKTtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqICh0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3BlcnAueCArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueikgKiB0aGlzLm1fYXhpcy54KSwgaW52X2R0ICogKHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KSAqIHRoaXMubV9heGlzLnkpKTtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UueTtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5HZXRKb2ludFRyYW5zbGF0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciBwMSA9IGJBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMSk7XHJcbiAgICAgIHZhciBwMiA9IGJCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XHJcbiAgICAgIHZhciBkWCA9IHAyLnggLSBwMS54O1xyXG4gICAgICB2YXIgZFkgPSBwMi55IC0gcDEueTtcclxuICAgICAgdmFyIGF4aXMgPSBiQS5HZXRXb3JsZFZlY3Rvcih0aGlzLm1fbG9jYWxYQXhpczEpO1xyXG4gICAgICB2YXIgdHJhbnNsYXRpb24gPSBheGlzLnggKiBkWCArIGF4aXMueSAqIGRZO1xyXG4gICAgICByZXR1cm4gdHJhbnNsYXRpb247XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0Sm9pbnRTcGVlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB2YXIgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgcjFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgIHIyWCA9IHRYO1xyXG4gICAgICB2YXIgcDFYID0gYkEubV9zd2VlcC5jLnggKyByMVg7XHJcbiAgICAgIHZhciBwMVkgPSBiQS5tX3N3ZWVwLmMueSArIHIxWTtcclxuICAgICAgdmFyIHAyWCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYO1xyXG4gICAgICB2YXIgcDJZID0gYkIubV9zd2VlcC5jLnkgKyByMlk7XHJcbiAgICAgIHZhciBkWCA9IHAyWCAtIHAxWDtcclxuICAgICAgdmFyIGRZID0gcDJZIC0gcDFZO1xyXG4gICAgICB2YXIgYXhpcyA9IGJBLkdldFdvcmxkVmVjdG9yKHRoaXMubV9sb2NhbFhBeGlzMSk7XHJcbiAgICAgIHZhciB2MSA9IGJBLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB2MiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3MSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdzIgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHNwZWVkID0gKGRYICogKCgtdzEgKiBheGlzLnkpKSArIGRZICogKHcxICogYXhpcy54KSkgKyAoYXhpcy54ICogKCgodjIueCArICgoLXcyICogcjJZKSkpIC0gdjEueCkgLSAoKC13MSAqIHIxWSkpKSArIGF4aXMueSAqICgoKHYyLnkgKyAodzIgKiByMlgpKSAtIHYxLnkpIC0gKHcxICogcjFYKSkpO1xyXG4gICAgICByZXR1cm4gc3BlZWQ7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuSXNMaW1pdEVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTGltaXQ7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuRW5hYmxlTGltaXQgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZmxhZztcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5HZXRMb3dlckxpbWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb247XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0VXBwZXJMaW1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV91cHBlclRyYW5zbGF0aW9uO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLlNldExpbWl0cyA9IGZ1bmN0aW9uIChsb3dlciwgdXBwZXIpIHtcclxuICAgICAgaWYgKGxvd2VyID09PSB1bmRlZmluZWQpIGxvd2VyID0gMDtcclxuICAgICAgaWYgKHVwcGVyID09PSB1bmRlZmluZWQpIHVwcGVyID0gMDtcclxuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uID0gbG93ZXI7XHJcbiAgICAgIHRoaXMubV91cHBlclRyYW5zbGF0aW9uID0gdXBwZXI7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuSXNNb3RvckVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTW90b3I7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuRW5hYmxlTW90b3IgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZmxhZztcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5TZXRNb3RvclNwZWVkID0gZnVuY3Rpb24gKHNwZWVkKSB7XHJcbiAgICAgIGlmIChzcGVlZCA9PT0gdW5kZWZpbmVkKSBzcGVlZCA9IDA7XHJcbiAgICAgIHRoaXMubV9ib2R5QS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IHNwZWVkO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkdldE1vdG9yU3BlZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5TZXRNYXhNb3RvckZvcmNlID0gZnVuY3Rpb24gKGZvcmNlKSB7XHJcbiAgICAgIGlmIChmb3JjZSA9PT0gdW5kZWZpbmVkKSBmb3JjZSA9IDA7XHJcbiAgICAgIHRoaXMubV9ib2R5QS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGZvcmNlO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkdldE1vdG9yRm9yY2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbW90b3JJbXB1bHNlO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLmIyUHJpc21hdGljSm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciB0WSA9IDA7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEuU2V0VihkZWYubG9jYWxBbmNob3JBKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMi5TZXRWKGRlZi5sb2NhbEFuY2hvckIpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxYQXhpczEuU2V0VihkZWYubG9jYWxBeGlzQSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbFlBeGlzMS54ID0gKC10aGlzLm1fbG9jYWxYQXhpczEueSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbFlBeGlzMS55ID0gdGhpcy5tX2xvY2FsWEF4aXMxLng7XHJcbiAgICAgIHRoaXMubV9yZWZBbmdsZSA9IGRlZi5yZWZlcmVuY2VBbmdsZTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fbW90b3JNYXNzID0gMC4wO1xyXG4gICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMC4wO1xyXG4gICAgICB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGRlZi5sb3dlclRyYW5zbGF0aW9uO1xyXG4gICAgICB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiA9IGRlZi51cHBlclRyYW5zbGF0aW9uO1xyXG4gICAgICB0aGlzLm1fbWF4TW90b3JGb3JjZSA9IGRlZi5tYXhNb3RvckZvcmNlO1xyXG4gICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xyXG4gICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBkZWYuZW5hYmxlTGltaXQ7XHJcbiAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcclxuICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgdGhpcy5tX2F4aXMuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fcGVycC5TZXRaZXJvKCk7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHRoaXMubV9sb2NhbENlbnRlckEuU2V0VihiQS5HZXRMb2NhbENlbnRlcigpKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQi5TZXRWKGJCLkdldExvY2FsQ2VudGVyKCkpO1xyXG4gICAgICB2YXIgeGYxID0gYkEuR2V0VHJhbnNmb3JtKCk7XHJcbiAgICAgIHZhciB4ZjIgPSBiQi5HZXRUcmFuc2Zvcm0oKTtcclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIHRoaXMubV9sb2NhbENlbnRlckEueDtcclxuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIHRoaXMubV9sb2NhbENlbnRlckEueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgcjFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSB0aGlzLm1fbG9jYWxDZW50ZXJCLng7XHJcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSB0aGlzLm1fbG9jYWxDZW50ZXJCLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgIHIyWCA9IHRYO1xyXG4gICAgICB2YXIgZFggPSBiQi5tX3N3ZWVwLmMueCArIHIyWCAtIGJBLm1fc3dlZXAuYy54IC0gcjFYO1xyXG4gICAgICB2YXIgZFkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWSAtIGJBLm1fc3dlZXAuYy55IC0gcjFZO1xyXG4gICAgICB0aGlzLm1faW52TWFzc0EgPSBiQS5tX2ludk1hc3M7XHJcbiAgICAgIHRoaXMubV9pbnZNYXNzQiA9IGJCLm1faW52TWFzcztcclxuICAgICAgdGhpcy5tX2ludklBID0gYkEubV9pbnZJO1xyXG4gICAgICB0aGlzLm1faW52SUIgPSBiQi5tX2ludkk7IHtcclxuICAgICAgICAgdGhpcy5tX2F4aXMuU2V0VihiMk1hdGguTXVsTVYoeGYxLlIsIHRoaXMubV9sb2NhbFhBeGlzMSkpO1xyXG4gICAgICAgICB0aGlzLm1fYTEgPSAoZFggKyByMVgpICogdGhpcy5tX2F4aXMueSAtIChkWSArIHIxWSkgKiB0aGlzLm1fYXhpcy54O1xyXG4gICAgICAgICB0aGlzLm1fYTIgPSByMlggKiB0aGlzLm1fYXhpcy55IC0gcjJZICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IHRoaXMubV9pbnZNYXNzQSArIHRoaXMubV9pbnZNYXNzQiArIHRoaXMubV9pbnZJQSAqIHRoaXMubV9hMSAqIHRoaXMubV9hMSArIHRoaXMubV9pbnZJQiAqIHRoaXMubV9hMiAqIHRoaXMubV9hMjtcclxuICAgICAgICAgaWYgKHRoaXMubV9tb3Rvck1hc3MgPiBOdW1iZXIuTUlOX1ZBTFVFKSB0aGlzLm1fbW90b3JNYXNzID0gMS4wIC8gdGhpcy5tX21vdG9yTWFzcztcclxuICAgICAgfSB7XHJcbiAgICAgICAgIHRoaXMubV9wZXJwLlNldFYoYjJNYXRoLk11bE1WKHhmMS5SLCB0aGlzLm1fbG9jYWxZQXhpczEpKTtcclxuICAgICAgICAgdGhpcy5tX3MxID0gKGRYICsgcjFYKSAqIHRoaXMubV9wZXJwLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX3BlcnAueDtcclxuICAgICAgICAgdGhpcy5tX3MyID0gcjJYICogdGhpcy5tX3BlcnAueSAtIHIyWSAqIHRoaXMubV9wZXJwLng7XHJcbiAgICAgICAgIHZhciBtMSA9IHRoaXMubV9pbnZNYXNzQTtcclxuICAgICAgICAgdmFyIG0yID0gdGhpcy5tX2ludk1hc3NCO1xyXG4gICAgICAgICB2YXIgaTEgPSB0aGlzLm1faW52SUE7XHJcbiAgICAgICAgIHZhciBpMiA9IHRoaXMubV9pbnZJQjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMS54ID0gbTEgKyBtMiArIGkxICogdGhpcy5tX3MxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fczI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueSA9IGkxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueiA9IGkxICogdGhpcy5tX3MxICogdGhpcy5tX2ExICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueCA9IHRoaXMubV9LLmNvbDEueTtcclxuICAgICAgICAgdGhpcy5tX0suY29sMi55ID0gaTEgKyBpMjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMi56ID0gaTEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9hMjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMy54ID0gdGhpcy5tX0suY29sMS56O1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wzLnkgPSB0aGlzLm1fSy5jb2wyLno7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDMueiA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9hMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQpIHtcclxuICAgICAgICAgdmFyIGpvaW50VHJhbnNpdGlvbiA9IHRoaXMubV9heGlzLnggKiBkWCArIHRoaXMubV9heGlzLnkgKiBkWTtcclxuICAgICAgICAgaWYgKGIyTWF0aC5BYnModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfZXF1YWxMaW1pdHM7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAoam9pbnRUcmFuc2l0aW9uIDw9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfYXRMb3dlckxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdDtcclxuICAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDAuMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYgKGpvaW50VHJhbnNpdGlvbiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQ7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDAuMDtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgPT0gZmFsc2UpIHtcclxuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdmFyIFBYID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnggKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgdmFyIFBZID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnkgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2F4aXMueTtcclxuICAgICAgICAgdmFyIEwxID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9zMSArIHRoaXMubV9pbXB1bHNlLnkgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2ExO1xyXG4gICAgICAgICB2YXIgTDIgPSB0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3MyICsgdGhpcy5tX2ltcHVsc2UueSArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueikgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCAtPSB0aGlzLm1faW52TWFzc0EgKiBQWDtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55IC09IHRoaXMubV9pbnZNYXNzQSAqIFBZO1xyXG4gICAgICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSAtPSB0aGlzLm1faW52SUEgKiBMMTtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBYO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XHJcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IHRoaXMubV9pbnZJQiAqIEwyO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS5TZXRaZXJvKCk7XHJcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHYxID0gYkEubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHcxID0gYkEubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB2MiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3MiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgUFggPSAwO1xyXG4gICAgICB2YXIgUFkgPSAwO1xyXG4gICAgICB2YXIgTDEgPSAwO1xyXG4gICAgICB2YXIgTDIgPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yICYmIHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9lcXVhbExpbWl0cykge1xyXG4gICAgICAgICB2YXIgQ2RvdCA9IHRoaXMubV9heGlzLnggKiAodjIueCAtIHYxLngpICsgdGhpcy5tX2F4aXMueSAqICh2Mi55IC0gdjEueSkgKyB0aGlzLm1fYTIgKiB3MiAtIHRoaXMubV9hMSAqIHcxO1xyXG4gICAgICAgICB2YXIgaW1wdWxzZSA9IHRoaXMubV9tb3Rvck1hc3MgKiAodGhpcy5tX21vdG9yU3BlZWQgLSBDZG90KTtcclxuICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlO1xyXG4gICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4TW90b3JGb3JjZTtcclxuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IGIyTWF0aC5DbGFtcCh0aGlzLm1fbW90b3JJbXB1bHNlICsgaW1wdWxzZSwgKC1tYXhJbXB1bHNlKSwgbWF4SW1wdWxzZSk7XHJcbiAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlIC0gb2xkSW1wdWxzZTtcclxuICAgICAgICAgUFggPSBpbXB1bHNlICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgUFkgPSBpbXB1bHNlICogdGhpcy5tX2F4aXMueTtcclxuICAgICAgICAgTDEgPSBpbXB1bHNlICogdGhpcy5tX2ExO1xyXG4gICAgICAgICBMMiA9IGltcHVsc2UgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHYxLnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XHJcbiAgICAgICAgIHYxLnkgLT0gdGhpcy5tX2ludk1hc3NBICogUFk7XHJcbiAgICAgICAgIHcxIC09IHRoaXMubV9pbnZJQSAqIEwxO1xyXG4gICAgICAgICB2Mi54ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBYO1xyXG4gICAgICAgICB2Mi55ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICB3MiArPSB0aGlzLm1faW52SUIgKiBMMjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgQ2RvdDFYID0gdGhpcy5tX3BlcnAueCAqICh2Mi54IC0gdjEueCkgKyB0aGlzLm1fcGVycC55ICogKHYyLnkgLSB2MS55KSArIHRoaXMubV9zMiAqIHcyIC0gdGhpcy5tX3MxICogdzE7XHJcbiAgICAgIHZhciBDZG90MVkgPSB3MiAtIHcxO1xyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0ICYmIHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0KSB7XHJcbiAgICAgICAgIHZhciBDZG90MiA9IHRoaXMubV9heGlzLnggKiAodjIueCAtIHYxLngpICsgdGhpcy5tX2F4aXMueSAqICh2Mi55IC0gdjEueSkgKyB0aGlzLm1fYTIgKiB3MiAtIHRoaXMubV9hMSAqIHcxO1xyXG4gICAgICAgICB2YXIgZjEgPSB0aGlzLm1faW1wdWxzZS5Db3B5KCk7XHJcbiAgICAgICAgIHZhciBkZiA9IHRoaXMubV9LLlNvbHZlMzMobmV3IGIyVmVjMygpLCAoLUNkb3QxWCksICgtQ2RvdDFZKSwgKC1DZG90MikpO1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS5BZGQoZGYpO1xyXG4gICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdCkge1xyXG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gYjJNYXRoLk1heCh0aGlzLm1faW1wdWxzZS56LCAwLjApO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcclxuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IGIyTWF0aC5NaW4odGhpcy5tX2ltcHVsc2UueiwgMC4wKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgYlggPSAoLUNkb3QxWCkgLSAodGhpcy5tX2ltcHVsc2UueiAtIGYxLnopICogdGhpcy5tX0suY29sMy54O1xyXG4gICAgICAgICB2YXIgYlkgPSAoLUNkb3QxWSkgLSAodGhpcy5tX2ltcHVsc2UueiAtIGYxLnopICogdGhpcy5tX0suY29sMy55O1xyXG4gICAgICAgICB2YXIgZjJyID0gdGhpcy5tX0suU29sdmUyMihuZXcgYjJWZWMyKCksIGJYLCBiWSk7XHJcbiAgICAgICAgIGYyci54ICs9IGYxLng7XHJcbiAgICAgICAgIGYyci55ICs9IGYxLnk7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggPSBmMnIueDtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSA9IGYyci55O1xyXG4gICAgICAgICBkZi54ID0gdGhpcy5tX2ltcHVsc2UueCAtIGYxLng7XHJcbiAgICAgICAgIGRmLnkgPSB0aGlzLm1faW1wdWxzZS55IC0gZjEueTtcclxuICAgICAgICAgZGYueiA9IHRoaXMubV9pbXB1bHNlLnogLSBmMS56O1xyXG4gICAgICAgICBQWCA9IGRmLnggKiB0aGlzLm1fcGVycC54ICsgZGYueiAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIFBZID0gZGYueCAqIHRoaXMubV9wZXJwLnkgKyBkZi56ICogdGhpcy5tX2F4aXMueTtcclxuICAgICAgICAgTDEgPSBkZi54ICogdGhpcy5tX3MxICsgZGYueSArIGRmLnogKiB0aGlzLm1fYTE7XHJcbiAgICAgICAgIEwyID0gZGYueCAqIHRoaXMubV9zMiArIGRmLnkgKyBkZi56ICogdGhpcy5tX2EyO1xyXG4gICAgICAgICB2MS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xyXG4gICAgICAgICB2MS55IC09IHRoaXMubV9pbnZNYXNzQSAqIFBZO1xyXG4gICAgICAgICB3MSAtPSB0aGlzLm1faW52SUEgKiBMMTtcclxuICAgICAgICAgdjIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcclxuICAgICAgICAgdjIueSArPSB0aGlzLm1faW52TWFzc0IgKiBQWTtcclxuICAgICAgICAgdzIgKz0gdGhpcy5tX2ludklCICogTDI7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHZhciBkZjIgPSB0aGlzLm1fSy5Tb2x2ZTIyKG5ldyBiMlZlYzIoKSwgKC1DZG90MVgpLCAoLUNkb3QxWSkpO1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IGRmMi54O1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS55ICs9IGRmMi55O1xyXG4gICAgICAgICBQWCA9IGRmMi54ICogdGhpcy5tX3BlcnAueDtcclxuICAgICAgICAgUFkgPSBkZjIueCAqIHRoaXMubV9wZXJwLnk7XHJcbiAgICAgICAgIEwxID0gZGYyLnggKiB0aGlzLm1fczEgKyBkZjIueTtcclxuICAgICAgICAgTDIgPSBkZjIueCAqIHRoaXMubV9zMiArIGRmMi55O1xyXG4gICAgICAgICB2MS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xyXG4gICAgICAgICB2MS55IC09IHRoaXMubV9pbnZNYXNzQSAqIFBZO1xyXG4gICAgICAgICB3MSAtPSB0aGlzLm1faW52SUEgKiBMMTtcclxuICAgICAgICAgdjIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcclxuICAgICAgICAgdjIueSArPSB0aGlzLm1faW52TWFzc0IgKiBQWTtcclxuICAgICAgICAgdzIgKz0gdGhpcy5tX2ludklCICogTDI7XHJcbiAgICAgIH1cclxuICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS5TZXRWKHYxKTtcclxuICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgPSB3MTtcclxuICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS5TZXRWKHYyKTtcclxuICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgPSB3MjtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XHJcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcclxuICAgICAgdmFyIGxpbWl0QyA9IDA7XHJcbiAgICAgIHZhciBvbGRMaW1pdEltcHVsc2UgPSAwO1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIGMxID0gYkEubV9zd2VlcC5jO1xyXG4gICAgICB2YXIgYTEgPSBiQS5tX3N3ZWVwLmE7XHJcbiAgICAgIHZhciBjMiA9IGJCLm1fc3dlZXAuYztcclxuICAgICAgdmFyIGEyID0gYkIubV9zd2VlcC5hO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIG0xID0gMDtcclxuICAgICAgdmFyIG0yID0gMDtcclxuICAgICAgdmFyIGkxID0gMDtcclxuICAgICAgdmFyIGkyID0gMDtcclxuICAgICAgdmFyIGxpbmVhckVycm9yID0gMC4wO1xyXG4gICAgICB2YXIgYW5ndWxhckVycm9yID0gMC4wO1xyXG4gICAgICB2YXIgYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHZhciBDMiA9IDAuMDtcclxuICAgICAgdmFyIFIxID0gYjJNYXQyMi5Gcm9tQW5nbGUoYTEpO1xyXG4gICAgICB2YXIgUjIgPSBiMk1hdDIyLkZyb21BbmdsZShhMik7XHJcbiAgICAgIHRNYXQgPSBSMTtcclxuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIHRoaXMubV9sb2NhbENlbnRlckEueDtcclxuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIHRoaXMubV9sb2NhbENlbnRlckEueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgcjFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBSMjtcclxuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIHRoaXMubV9sb2NhbENlbnRlckIueDtcclxuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIHRoaXMubV9sb2NhbENlbnRlckIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgcjJYID0gdFg7XHJcbiAgICAgIHZhciBkWCA9IGMyLnggKyByMlggLSBjMS54IC0gcjFYO1xyXG4gICAgICB2YXIgZFkgPSBjMi55ICsgcjJZIC0gYzEueSAtIHIxWTtcclxuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCkge1xyXG4gICAgICAgICB0aGlzLm1fYXhpcyA9IGIyTWF0aC5NdWxNVihSMSwgdGhpcy5tX2xvY2FsWEF4aXMxKTtcclxuICAgICAgICAgdGhpcy5tX2ExID0gKGRYICsgcjFYKSAqIHRoaXMubV9heGlzLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgdGhpcy5tX2EyID0gcjJYICogdGhpcy5tX2F4aXMueSAtIHIyWSAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIHZhciB0cmFuc2xhdGlvbiA9IHRoaXMubV9heGlzLnggKiBkWCArIHRoaXMubV9heGlzLnkgKiBkWTtcclxuICAgICAgICAgaWYgKGIyTWF0aC5BYnModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgICAgICAgQzIgPSBiMk1hdGguQ2xhbXAodHJhbnNsYXRpb24sICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKTtcclxuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSBiMk1hdGguQWJzKHRyYW5zbGF0aW9uKTtcclxuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0cmFuc2xhdGlvbiA8PSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikge1xyXG4gICAgICAgICAgICBDMiA9IGIyTWF0aC5DbGFtcCh0cmFuc2xhdGlvbiAtIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wLCAoLWIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbiksIDAuMCk7XHJcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gLSB0cmFuc2xhdGlvbjtcclxuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0cmFuc2xhdGlvbiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xyXG4gICAgICAgICAgICBDMiA9IGIyTWF0aC5DbGFtcCh0cmFuc2xhdGlvbiAtIHRoaXMubV91cHBlclRyYW5zbGF0aW9uICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wLCAwLjAsIGIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbik7XHJcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gdHJhbnNsYXRpb24gLSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbjtcclxuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9wZXJwID0gYjJNYXRoLk11bE1WKFIxLCB0aGlzLm1fbG9jYWxZQXhpczEpO1xyXG4gICAgICB0aGlzLm1fczEgPSAoZFggKyByMVgpICogdGhpcy5tX3BlcnAueSAtIChkWSArIHIxWSkgKiB0aGlzLm1fcGVycC54O1xyXG4gICAgICB0aGlzLm1fczIgPSByMlggKiB0aGlzLm1fcGVycC55IC0gcjJZICogdGhpcy5tX3BlcnAueDtcclxuICAgICAgdmFyIGltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XHJcbiAgICAgIHZhciBDMVggPSB0aGlzLm1fcGVycC54ICogZFggKyB0aGlzLm1fcGVycC55ICogZFk7XHJcbiAgICAgIHZhciBDMVkgPSBhMiAtIGExIC0gdGhpcy5tX3JlZkFuZ2xlO1xyXG4gICAgICBsaW5lYXJFcnJvciA9IGIyTWF0aC5NYXgobGluZWFyRXJyb3IsIGIyTWF0aC5BYnMoQzFYKSk7XHJcbiAgICAgIGFuZ3VsYXJFcnJvciA9IGIyTWF0aC5BYnMoQzFZKTtcclxuICAgICAgaWYgKGFjdGl2ZSkge1xyXG4gICAgICAgICBtMSA9IHRoaXMubV9pbnZNYXNzQTtcclxuICAgICAgICAgbTIgPSB0aGlzLm1faW52TWFzc0I7XHJcbiAgICAgICAgIGkxID0gdGhpcy5tX2ludklBO1xyXG4gICAgICAgICBpMiA9IHRoaXMubV9pbnZJQjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMS54ID0gbTEgKyBtMiArIGkxICogdGhpcy5tX3MxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fczI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueSA9IGkxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueiA9IGkxICogdGhpcy5tX3MxICogdGhpcy5tX2ExICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueCA9IHRoaXMubV9LLmNvbDEueTtcclxuICAgICAgICAgdGhpcy5tX0suY29sMi55ID0gaTEgKyBpMjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMi56ID0gaTEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9hMjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMy54ID0gdGhpcy5tX0suY29sMS56O1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wzLnkgPSB0aGlzLm1fSy5jb2wyLno7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDMueiA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9hMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xyXG4gICAgICAgICB0aGlzLm1fSy5Tb2x2ZTMzKGltcHVsc2UsICgtQzFYKSwgKC1DMVkpLCAoLUMyKSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIG0xID0gdGhpcy5tX2ludk1hc3NBO1xyXG4gICAgICAgICBtMiA9IHRoaXMubV9pbnZNYXNzQjtcclxuICAgICAgICAgaTEgPSB0aGlzLm1faW52SUE7XHJcbiAgICAgICAgIGkyID0gdGhpcy5tX2ludklCO1xyXG4gICAgICAgICB2YXIgazExID0gbTEgKyBtMiArIGkxICogdGhpcy5tX3MxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fczI7XHJcbiAgICAgICAgIHZhciBrMTIgPSBpMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyO1xyXG4gICAgICAgICB2YXIgazIyID0gaTEgKyBpMjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMS5TZXQoazExLCBrMTIsIDAuMCk7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDIuU2V0KGsxMiwgazIyLCAwLjApO1xyXG4gICAgICAgICB2YXIgaW1wdWxzZTEgPSB0aGlzLm1fSy5Tb2x2ZTIyKG5ldyBiMlZlYzIoKSwgKC1DMVgpLCAoLUMxWSkpO1xyXG4gICAgICAgICBpbXB1bHNlLnggPSBpbXB1bHNlMS54O1xyXG4gICAgICAgICBpbXB1bHNlLnkgPSBpbXB1bHNlMS55O1xyXG4gICAgICAgICBpbXB1bHNlLnogPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIFBYID0gaW1wdWxzZS54ICogdGhpcy5tX3BlcnAueCArIGltcHVsc2UueiAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgIHZhciBQWSA9IGltcHVsc2UueCAqIHRoaXMubV9wZXJwLnkgKyBpbXB1bHNlLnogKiB0aGlzLm1fYXhpcy55O1xyXG4gICAgICB2YXIgTDEgPSBpbXB1bHNlLnggKiB0aGlzLm1fczEgKyBpbXB1bHNlLnkgKyBpbXB1bHNlLnogKiB0aGlzLm1fYTE7XHJcbiAgICAgIHZhciBMMiA9IGltcHVsc2UueCAqIHRoaXMubV9zMiArIGltcHVsc2UueSArIGltcHVsc2UueiAqIHRoaXMubV9hMjtcclxuICAgICAgYzEueCAtPSB0aGlzLm1faW52TWFzc0EgKiBQWDtcclxuICAgICAgYzEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcclxuICAgICAgYTEgLT0gdGhpcy5tX2ludklBICogTDE7XHJcbiAgICAgIGMyLnggKz0gdGhpcy5tX2ludk1hc3NCICogUFg7XHJcbiAgICAgIGMyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XHJcbiAgICAgIGEyICs9IHRoaXMubV9pbnZJQiAqIEwyO1xyXG4gICAgICBiQS5tX3N3ZWVwLmEgPSBhMTtcclxuICAgICAgYkIubV9zd2VlcC5hID0gYTI7XHJcbiAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIGJCLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8PSBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AgJiYgYW5ndWxhckVycm9yIDw9IGIyU2V0dGluZ3MuYjJfYW5ndWxhclNsb3A7XHJcbiAgIH1cclxuICAgQm94MkQuaW5oZXJpdChiMlByaXNtYXRpY0pvaW50RGVmLCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZik7XHJcbiAgIGIyUHJpc21hdGljSm9pbnREZWYucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5wcm90b3R5cGU7XHJcbiAgIGIyUHJpc21hdGljSm9pbnREZWYuYjJQcmlzbWF0aWNKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubG9jYWxBeGlzQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJQcmlzbWF0aWNKb2ludERlZi5wcm90b3R5cGUuYjJQcmlzbWF0aWNKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnREZWYuY2FsbCh0aGlzKTtcclxuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX3ByaXNtYXRpY0pvaW50O1xyXG4gICAgICB0aGlzLmxvY2FsQXhpc0EuU2V0KDEuMCwgMC4wKTtcclxuICAgICAgdGhpcy5yZWZlcmVuY2VBbmdsZSA9IDAuMDtcclxuICAgICAgdGhpcy5lbmFibGVMaW1pdCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmxvd2VyVHJhbnNsYXRpb24gPSAwLjA7XHJcbiAgICAgIHRoaXMudXBwZXJUcmFuc2xhdGlvbiA9IDAuMDtcclxuICAgICAgdGhpcy5lbmFibGVNb3RvciA9IGZhbHNlO1xyXG4gICAgICB0aGlzLm1heE1vdG9yRm9yY2UgPSAwLjA7XHJcbiAgICAgIHRoaXMubW90b3JTcGVlZCA9IDAuMDtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50RGVmLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKGJBLCBiQiwgYW5jaG9yLCBheGlzKSB7XHJcbiAgICAgIHRoaXMuYm9keUEgPSBiQTtcclxuICAgICAgdGhpcy5ib2R5QiA9IGJCO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3IpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IHRoaXMuYm9keUIuR2V0TG9jYWxQb2ludChhbmNob3IpO1xyXG4gICAgICB0aGlzLmxvY2FsQXhpc0EgPSB0aGlzLmJvZHlBLkdldExvY2FsVmVjdG9yKGF4aXMpO1xyXG4gICAgICB0aGlzLnJlZmVyZW5jZUFuZ2xlID0gdGhpcy5ib2R5Qi5HZXRBbmdsZSgpIC0gdGhpcy5ib2R5QS5HZXRBbmdsZSgpO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJQdWxsZXlKb2ludCwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQpO1xyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xyXG4gICBiMlB1bGxleUpvaW50LmIyUHVsbGV5Sm9pbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmIySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9ncm91bmRBbmNob3IyID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fdTEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV91MiA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjEpO1xyXG4gICB9XHJcbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLkdldEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IyKTtcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3UyLngsIGludl9kdCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3UyLnkpO1xyXG4gICB9XHJcbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiAwLjA7XHJcbiAgIH1cclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0R3JvdW5kQW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGEgPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24uQ29weSgpO1xyXG4gICAgICBhLkFkZCh0aGlzLm1fZ3JvdW5kQW5jaG9yMSk7XHJcbiAgICAgIHJldHVybiBhO1xyXG4gICB9XHJcbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLkdldEdyb3VuZEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBhID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLkNvcHkoKTtcclxuICAgICAgYS5BZGQodGhpcy5tX2dyb3VuZEFuY2hvcjIpO1xyXG4gICAgICByZXR1cm4gYTtcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5HZXRMZW5ndGgxID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgcCA9IHRoaXMubV9ib2R5QS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjEpO1xyXG4gICAgICB2YXIgc1ggPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueCArIHRoaXMubV9ncm91bmRBbmNob3IxLng7XHJcbiAgICAgIHZhciBzWSA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi55ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjEueTtcclxuICAgICAgdmFyIGRYID0gcC54IC0gc1g7XHJcbiAgICAgIHZhciBkWSA9IHAueSAtIHNZO1xyXG4gICAgICByZXR1cm4gTWF0aC5zcXJ0KGRYICogZFggKyBkWSAqIGRZKTtcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5HZXRMZW5ndGgyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgcCA9IHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xyXG4gICAgICB2YXIgc1ggPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueCArIHRoaXMubV9ncm91bmRBbmNob3IyLng7XHJcbiAgICAgIHZhciBzWSA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi55ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjIueTtcclxuICAgICAgdmFyIGRYID0gcC54IC0gc1g7XHJcbiAgICAgIHZhciBkWSA9IHAueSAtIHNZO1xyXG4gICAgICByZXR1cm4gTWF0aC5zcXJ0KGRYICogZFggKyBkWSAqIGRZKTtcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5HZXRSYXRpbyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9yYXRpbztcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5iMlB1bGxleUpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgdFkgPSAwO1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kID0gdGhpcy5tX2JvZHlBLm1fd29ybGQubV9ncm91bmRCb2R5O1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMS54ID0gZGVmLmdyb3VuZEFuY2hvckEueCAtIHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi54O1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMS55ID0gZGVmLmdyb3VuZEFuY2hvckEueSAtIHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi55O1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMi54ID0gZGVmLmdyb3VuZEFuY2hvckIueCAtIHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi54O1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMi55ID0gZGVmLmdyb3VuZEFuY2hvckIueSAtIHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi55O1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxLlNldFYoZGVmLmxvY2FsQW5jaG9yQSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIuU2V0VihkZWYubG9jYWxBbmNob3JCKTtcclxuICAgICAgdGhpcy5tX3JhdGlvID0gZGVmLnJhdGlvO1xyXG4gICAgICB0aGlzLm1fY29uc3RhbnQgPSBkZWYubGVuZ3RoQSArIHRoaXMubV9yYXRpbyAqIGRlZi5sZW5ndGhCO1xyXG4gICAgICB0aGlzLm1fbWF4TGVuZ3RoMSA9IGIyTWF0aC5NaW4oZGVmLm1heExlbmd0aEEsIHRoaXMubV9jb25zdGFudCAtIHRoaXMubV9yYXRpbyAqIGIyUHVsbGV5Sm9pbnQuYjJfbWluUHVsbGV5TGVuZ3RoKTtcclxuICAgICAgdGhpcy5tX21heExlbmd0aDIgPSBiMk1hdGguTWluKGRlZi5tYXhMZW5ndGhCLCAodGhpcy5tX2NvbnN0YW50IC0gYjJQdWxsZXlKb2ludC5iMl9taW5QdWxsZXlMZW5ndGgpIC8gdGhpcy5tX3JhdGlvKTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9saW1pdEltcHVsc2UxID0gMC4wO1xyXG4gICAgICB0aGlzLm1fbGltaXRJbXB1bHNlMiA9IDAuMDtcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdmFyIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgIHIxWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICByMlggPSB0WDtcclxuICAgICAgdmFyIHAxWCA9IGJBLm1fc3dlZXAuYy54ICsgcjFYO1xyXG4gICAgICB2YXIgcDFZID0gYkEubV9zd2VlcC5jLnkgKyByMVk7XHJcbiAgICAgIHZhciBwMlggPSBiQi5tX3N3ZWVwLmMueCArIHIyWDtcclxuICAgICAgdmFyIHAyWSA9IGJCLm1fc3dlZXAuYy55ICsgcjJZO1xyXG4gICAgICB2YXIgczFYID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnggKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMS54O1xyXG4gICAgICB2YXIgczFZID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnkgKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMS55O1xyXG4gICAgICB2YXIgczJYID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnggKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMi54O1xyXG4gICAgICB2YXIgczJZID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnkgKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMi55O1xyXG4gICAgICB0aGlzLm1fdTEuU2V0KHAxWCAtIHMxWCwgcDFZIC0gczFZKTtcclxuICAgICAgdGhpcy5tX3UyLlNldChwMlggLSBzMlgsIHAyWSAtIHMyWSk7XHJcbiAgICAgIHZhciBsZW5ndGgxID0gdGhpcy5tX3UxLkxlbmd0aCgpO1xyXG4gICAgICB2YXIgbGVuZ3RoMiA9IHRoaXMubV91Mi5MZW5ndGgoKTtcclxuICAgICAgaWYgKGxlbmd0aDEgPiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgICAgdGhpcy5tX3UxLk11bHRpcGx5KDEuMCAvIGxlbmd0aDEpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fdTEuU2V0WmVybygpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChsZW5ndGgyID4gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XHJcbiAgICAgICAgIHRoaXMubV91Mi5NdWx0aXBseSgxLjAgLyBsZW5ndGgyKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX3UyLlNldFplcm8oKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgQyA9IHRoaXMubV9jb25zdGFudCAtIGxlbmd0aDEgLSB0aGlzLm1fcmF0aW8gKiBsZW5ndGgyO1xyXG4gICAgICBpZiAoQyA+IDAuMCkge1xyXG4gICAgICAgICB0aGlzLm1fc3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9zdGF0ZSA9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGxlbmd0aDEgPCB0aGlzLm1fbWF4TGVuZ3RoMSkge1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZTEgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgICAgdGhpcy5tX2xpbWl0SW1wdWxzZTEgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlMSA9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGxlbmd0aDIgPCB0aGlzLm1fbWF4TGVuZ3RoMikge1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZTIgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgICAgdGhpcy5tX2xpbWl0SW1wdWxzZTIgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlMiA9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQ7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGNyMXUxID0gcjFYICogdGhpcy5tX3UxLnkgLSByMVkgKiB0aGlzLm1fdTEueDtcclxuICAgICAgdmFyIGNyMnUyID0gcjJYICogdGhpcy5tX3UyLnkgLSByMlkgKiB0aGlzLm1fdTIueDtcclxuICAgICAgdGhpcy5tX2xpbWl0TWFzczEgPSBiQS5tX2ludk1hc3MgKyBiQS5tX2ludkkgKiBjcjF1MSAqIGNyMXUxO1xyXG4gICAgICB0aGlzLm1fbGltaXRNYXNzMiA9IGJCLm1faW52TWFzcyArIGJCLm1faW52SSAqIGNyMnUyICogY3IydTI7XHJcbiAgICAgIHRoaXMubV9wdWxsZXlNYXNzID0gdGhpcy5tX2xpbWl0TWFzczEgKyB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fcmF0aW8gKiB0aGlzLm1fbGltaXRNYXNzMjtcclxuICAgICAgdGhpcy5tX2xpbWl0TWFzczEgPSAxLjAgLyB0aGlzLm1fbGltaXRNYXNzMTtcclxuICAgICAgdGhpcy5tX2xpbWl0TWFzczIgPSAxLjAgLyB0aGlzLm1fbGltaXRNYXNzMjtcclxuICAgICAgdGhpcy5tX3B1bGxleU1hc3MgPSAxLjAgLyB0aGlzLm1fcHVsbGV5TWFzcztcclxuICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdGhpcy5tX2xpbWl0SW1wdWxzZTEgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRJbXB1bHNlMiAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHZhciBQMVggPSAoKC10aGlzLm1faW1wdWxzZSkgLSB0aGlzLm1fbGltaXRJbXB1bHNlMSkgKiB0aGlzLm1fdTEueDtcclxuICAgICAgICAgdmFyIFAxWSA9ICgoLXRoaXMubV9pbXB1bHNlKSAtIHRoaXMubV9saW1pdEltcHVsc2UxKSAqIHRoaXMubV91MS55O1xyXG4gICAgICAgICB2YXIgUDJYID0gKCgtdGhpcy5tX3JhdGlvICogdGhpcy5tX2ltcHVsc2UpIC0gdGhpcy5tX2xpbWl0SW1wdWxzZTIpICogdGhpcy5tX3UyLng7XHJcbiAgICAgICAgIHZhciBQMlkgPSAoKC10aGlzLm1fcmF0aW8gKiB0aGlzLm1faW1wdWxzZSkgLSB0aGlzLm1fbGltaXRJbXB1bHNlMikgKiB0aGlzLm1fdTIueTtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54ICs9IGJBLm1faW52TWFzcyAqIFAxWDtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55ICs9IGJBLm1faW52TWFzcyAqIFAxWTtcclxuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkEubV9pbnZJICogKHIxWCAqIFAxWSAtIHIxWSAqIFAxWCk7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQi5tX2ludk1hc3MgKiBQMlg7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQi5tX2ludk1hc3MgKiBQMlk7XHJcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJCLm1faW52SSAqIChyMlggKiBQMlkgLSByMlkgKiBQMlgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcclxuICAgICAgICAgdGhpcy5tX2xpbWl0SW1wdWxzZTEgPSAwLjA7XHJcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UyID0gMC4wO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB2YXIgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgcjFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgIHIyWCA9IHRYO1xyXG4gICAgICB2YXIgdjFYID0gMDtcclxuICAgICAgdmFyIHYxWSA9IDA7XHJcbiAgICAgIHZhciB2MlggPSAwO1xyXG4gICAgICB2YXIgdjJZID0gMDtcclxuICAgICAgdmFyIFAxWCA9IDA7XHJcbiAgICAgIHZhciBQMVkgPSAwO1xyXG4gICAgICB2YXIgUDJYID0gMDtcclxuICAgICAgdmFyIFAyWSA9IDA7XHJcbiAgICAgIHZhciBDZG90ID0gMDtcclxuICAgICAgdmFyIGltcHVsc2UgPSAwO1xyXG4gICAgICB2YXIgb2xkSW1wdWxzZSA9IDA7XHJcbiAgICAgIGlmICh0aGlzLm1fc3RhdGUgPT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICB2MVggPSBiQS5tX2xpbmVhclZlbG9jaXR5LnggKyAoKC1iQS5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIxWSkpO1xyXG4gICAgICAgICB2MVkgPSBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKyAoYkEubV9hbmd1bGFyVmVsb2NpdHkgKiByMVgpO1xyXG4gICAgICAgICB2MlggPSBiQi5tX2xpbmVhclZlbG9jaXR5LnggKyAoKC1iQi5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIyWSkpO1xyXG4gICAgICAgICB2MlkgPSBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKyAoYkIubV9hbmd1bGFyVmVsb2NpdHkgKiByMlgpO1xyXG4gICAgICAgICBDZG90ID0gKC0odGhpcy5tX3UxLnggKiB2MVggKyB0aGlzLm1fdTEueSAqIHYxWSkpIC0gdGhpcy5tX3JhdGlvICogKHRoaXMubV91Mi54ICogdjJYICsgdGhpcy5tX3UyLnkgKiB2MlkpO1xyXG4gICAgICAgICBpbXB1bHNlID0gdGhpcy5tX3B1bGxleU1hc3MgKiAoKC1DZG90KSk7XHJcbiAgICAgICAgIG9sZEltcHVsc2UgPSB0aGlzLm1faW1wdWxzZTtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSBiMk1hdGguTWF4KDAuMCwgdGhpcy5tX2ltcHVsc2UgKyBpbXB1bHNlKTtcclxuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9pbXB1bHNlIC0gb2xkSW1wdWxzZTtcclxuICAgICAgICAgUDFYID0gKC1pbXB1bHNlICogdGhpcy5tX3UxLngpO1xyXG4gICAgICAgICBQMVkgPSAoLWltcHVsc2UgKiB0aGlzLm1fdTEueSk7XHJcbiAgICAgICAgIFAyWCA9ICgtdGhpcy5tX3JhdGlvICogaW1wdWxzZSAqIHRoaXMubV91Mi54KTtcclxuICAgICAgICAgUDJZID0gKC10aGlzLm1fcmF0aW8gKiBpbXB1bHNlICogdGhpcy5tX3UyLnkpO1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkEubV9pbnZNYXNzICogUDFYO1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkEubV9pbnZNYXNzICogUDFZO1xyXG4gICAgICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiQS5tX2ludkkgKiAocjFYICogUDFZIC0gcjFZICogUDFYKTtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IGJCLm1faW52TWFzcyAqIFAyWDtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IGJCLm1faW52TWFzcyAqIFAyWTtcclxuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkIubV9pbnZJICogKHIyWCAqIFAyWSAtIHIyWSAqIFAyWCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlMSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XHJcbiAgICAgICAgIHYxWCA9IGJBLm1fbGluZWFyVmVsb2NpdHkueCArICgoLWJBLm1fYW5ndWxhclZlbG9jaXR5ICogcjFZKSk7XHJcbiAgICAgICAgIHYxWSA9IGJBLm1fbGluZWFyVmVsb2NpdHkueSArIChiQS5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIxWCk7XHJcbiAgICAgICAgIENkb3QgPSAoLSh0aGlzLm1fdTEueCAqIHYxWCArIHRoaXMubV91MS55ICogdjFZKSk7XHJcbiAgICAgICAgIGltcHVsc2UgPSAoLXRoaXMubV9saW1pdE1hc3MxICogQ2RvdCk7XHJcbiAgICAgICAgIG9sZEltcHVsc2UgPSB0aGlzLm1fbGltaXRJbXB1bHNlMTtcclxuICAgICAgICAgdGhpcy5tX2xpbWl0SW1wdWxzZTEgPSBiMk1hdGguTWF4KDAuMCwgdGhpcy5tX2xpbWl0SW1wdWxzZTEgKyBpbXB1bHNlKTtcclxuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9saW1pdEltcHVsc2UxIC0gb2xkSW1wdWxzZTtcclxuICAgICAgICAgUDFYID0gKC1pbXB1bHNlICogdGhpcy5tX3UxLngpO1xyXG4gICAgICAgICBQMVkgPSAoLWltcHVsc2UgKiB0aGlzLm1fdTEueSk7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQS5tX2ludk1hc3MgKiBQMVg7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQS5tX2ludk1hc3MgKiBQMVk7XHJcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJBLm1faW52SSAqIChyMVggKiBQMVkgLSByMVkgKiBQMVgpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZTIgPT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICB2MlggPSBiQi5tX2xpbmVhclZlbG9jaXR5LnggKyAoKC1iQi5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIyWSkpO1xyXG4gICAgICAgICB2MlkgPSBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKyAoYkIubV9hbmd1bGFyVmVsb2NpdHkgKiByMlgpO1xyXG4gICAgICAgICBDZG90ID0gKC0odGhpcy5tX3UyLnggKiB2MlggKyB0aGlzLm1fdTIueSAqIHYyWSkpO1xyXG4gICAgICAgICBpbXB1bHNlID0gKC10aGlzLm1fbGltaXRNYXNzMiAqIENkb3QpO1xyXG4gICAgICAgICBvbGRJbXB1bHNlID0gdGhpcy5tX2xpbWl0SW1wdWxzZTI7XHJcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UyID0gYjJNYXRoLk1heCgwLjAsIHRoaXMubV9saW1pdEltcHVsc2UyICsgaW1wdWxzZSk7XHJcbiAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbGltaXRJbXB1bHNlMiAtIG9sZEltcHVsc2U7XHJcbiAgICAgICAgIFAyWCA9ICgtaW1wdWxzZSAqIHRoaXMubV91Mi54KTtcclxuICAgICAgICAgUDJZID0gKC1pbXB1bHNlICogdGhpcy5tX3UyLnkpO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkIubV9pbnZNYXNzICogUDJYO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkIubV9pbnZNYXNzICogUDJZO1xyXG4gICAgICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiQi5tX2ludkkgKiAocjJYICogUDJZIC0gcjJZICogUDJYKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcclxuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciBzMVggPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueCArIHRoaXMubV9ncm91bmRBbmNob3IxLng7XHJcbiAgICAgIHZhciBzMVkgPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueSArIHRoaXMubV9ncm91bmRBbmNob3IxLnk7XHJcbiAgICAgIHZhciBzMlggPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueCArIHRoaXMubV9ncm91bmRBbmNob3IyLng7XHJcbiAgICAgIHZhciBzMlkgPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueSArIHRoaXMubV9ncm91bmRBbmNob3IyLnk7XHJcbiAgICAgIHZhciByMVggPSAwO1xyXG4gICAgICB2YXIgcjFZID0gMDtcclxuICAgICAgdmFyIHIyWCA9IDA7XHJcbiAgICAgIHZhciByMlkgPSAwO1xyXG4gICAgICB2YXIgcDFYID0gMDtcclxuICAgICAgdmFyIHAxWSA9IDA7XHJcbiAgICAgIHZhciBwMlggPSAwO1xyXG4gICAgICB2YXIgcDJZID0gMDtcclxuICAgICAgdmFyIGxlbmd0aDEgPSAwO1xyXG4gICAgICB2YXIgbGVuZ3RoMiA9IDA7XHJcbiAgICAgIHZhciBDID0gMDtcclxuICAgICAgdmFyIGltcHVsc2UgPSAwO1xyXG4gICAgICB2YXIgb2xkSW1wdWxzZSA9IDA7XHJcbiAgICAgIHZhciBvbGRMaW1pdFBvc2l0aW9uSW1wdWxzZSA9IDA7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciBsaW5lYXJFcnJvciA9IDAuMDtcclxuICAgICAgaWYgKHRoaXMubV9zdGF0ZSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XHJcbiAgICAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgICAgIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgICAgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICAgICByMVggPSB0WDtcclxuICAgICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgICAgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICAgICByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgICAgIHIyWCA9IHRYO1xyXG4gICAgICAgICBwMVggPSBiQS5tX3N3ZWVwLmMueCArIHIxWDtcclxuICAgICAgICAgcDFZID0gYkEubV9zd2VlcC5jLnkgKyByMVk7XHJcbiAgICAgICAgIHAyWCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYO1xyXG4gICAgICAgICBwMlkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWTtcclxuICAgICAgICAgdGhpcy5tX3UxLlNldChwMVggLSBzMVgsIHAxWSAtIHMxWSk7XHJcbiAgICAgICAgIHRoaXMubV91Mi5TZXQocDJYIC0gczJYLCBwMlkgLSBzMlkpO1xyXG4gICAgICAgICBsZW5ndGgxID0gdGhpcy5tX3UxLkxlbmd0aCgpO1xyXG4gICAgICAgICBsZW5ndGgyID0gdGhpcy5tX3UyLkxlbmd0aCgpO1xyXG4gICAgICAgICBpZiAobGVuZ3RoMSA+IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xyXG4gICAgICAgICAgICB0aGlzLm1fdTEuTXVsdGlwbHkoMS4wIC8gbGVuZ3RoMSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubV91MS5TZXRaZXJvKCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKGxlbmd0aDIgPiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgICAgICAgdGhpcy5tX3UyLk11bHRpcGx5KDEuMCAvIGxlbmd0aDIpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1fdTIuU2V0WmVybygpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIEMgPSB0aGlzLm1fY29uc3RhbnQgLSBsZW5ndGgxIC0gdGhpcy5tX3JhdGlvICogbGVuZ3RoMjtcclxuICAgICAgICAgbGluZWFyRXJyb3IgPSBiMk1hdGguTWF4KGxpbmVhckVycm9yLCAoLUMpKTtcclxuICAgICAgICAgQyA9IGIyTWF0aC5DbGFtcChDICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wLCAoLWIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbiksIDAuMCk7XHJcbiAgICAgICAgIGltcHVsc2UgPSAoLXRoaXMubV9wdWxsZXlNYXNzICogQyk7XHJcbiAgICAgICAgIHAxWCA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS54KTtcclxuICAgICAgICAgcDFZID0gKC1pbXB1bHNlICogdGhpcy5tX3UxLnkpO1xyXG4gICAgICAgICBwMlggPSAoLXRoaXMubV9yYXRpbyAqIGltcHVsc2UgKiB0aGlzLm1fdTIueCk7XHJcbiAgICAgICAgIHAyWSA9ICgtdGhpcy5tX3JhdGlvICogaW1wdWxzZSAqIHRoaXMubV91Mi55KTtcclxuICAgICAgICAgYkEubV9zd2VlcC5jLnggKz0gYkEubV9pbnZNYXNzICogcDFYO1xyXG4gICAgICAgICBiQS5tX3N3ZWVwLmMueSArPSBiQS5tX2ludk1hc3MgKiBwMVk7XHJcbiAgICAgICAgIGJBLm1fc3dlZXAuYSArPSBiQS5tX2ludkkgKiAocjFYICogcDFZIC0gcjFZICogcDFYKTtcclxuICAgICAgICAgYkIubV9zd2VlcC5jLnggKz0gYkIubV9pbnZNYXNzICogcDJYO1xyXG4gICAgICAgICBiQi5tX3N3ZWVwLmMueSArPSBiQi5tX2ludk1hc3MgKiBwMlk7XHJcbiAgICAgICAgIGJCLm1fc3dlZXAuYSArPSBiQi5tX2ludkkgKiAocjJYICogcDJZIC0gcjJZICogcDJYKTtcclxuICAgICAgICAgYkEuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUxID09IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcclxuICAgICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgICAgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICAgICByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgICAgIHIxWCA9IHRYO1xyXG4gICAgICAgICBwMVggPSBiQS5tX3N3ZWVwLmMueCArIHIxWDtcclxuICAgICAgICAgcDFZID0gYkEubV9zd2VlcC5jLnkgKyByMVk7XHJcbiAgICAgICAgIHRoaXMubV91MS5TZXQocDFYIC0gczFYLCBwMVkgLSBzMVkpO1xyXG4gICAgICAgICBsZW5ndGgxID0gdGhpcy5tX3UxLkxlbmd0aCgpO1xyXG4gICAgICAgICBpZiAobGVuZ3RoMSA+IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xyXG4gICAgICAgICAgICB0aGlzLm1fdTEueCAqPSAxLjAgLyBsZW5ndGgxO1xyXG4gICAgICAgICAgICB0aGlzLm1fdTEueSAqPSAxLjAgLyBsZW5ndGgxO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1fdTEuU2V0WmVybygpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIEMgPSB0aGlzLm1fbWF4TGVuZ3RoMSAtIGxlbmd0aDE7XHJcbiAgICAgICAgIGxpbmVhckVycm9yID0gYjJNYXRoLk1heChsaW5lYXJFcnJvciwgKC1DKSk7XHJcbiAgICAgICAgIEMgPSBiMk1hdGguQ2xhbXAoQyArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCAwLjApO1xyXG4gICAgICAgICBpbXB1bHNlID0gKC10aGlzLm1fbGltaXRNYXNzMSAqIEMpO1xyXG4gICAgICAgICBwMVggPSAoLWltcHVsc2UgKiB0aGlzLm1fdTEueCk7XHJcbiAgICAgICAgIHAxWSA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS55KTtcclxuICAgICAgICAgYkEubV9zd2VlcC5jLnggKz0gYkEubV9pbnZNYXNzICogcDFYO1xyXG4gICAgICAgICBiQS5tX3N3ZWVwLmMueSArPSBiQS5tX2ludk1hc3MgKiBwMVk7XHJcbiAgICAgICAgIGJBLm1fc3dlZXAuYSArPSBiQS5tX2ludkkgKiAocjFYICogcDFZIC0gcjFZICogcDFYKTtcclxuICAgICAgICAgYkEuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUyID09IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcclxuICAgICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgICAgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICAgICByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgICAgIHIyWCA9IHRYO1xyXG4gICAgICAgICBwMlggPSBiQi5tX3N3ZWVwLmMueCArIHIyWDtcclxuICAgICAgICAgcDJZID0gYkIubV9zd2VlcC5jLnkgKyByMlk7XHJcbiAgICAgICAgIHRoaXMubV91Mi5TZXQocDJYIC0gczJYLCBwMlkgLSBzMlkpO1xyXG4gICAgICAgICBsZW5ndGgyID0gdGhpcy5tX3UyLkxlbmd0aCgpO1xyXG4gICAgICAgICBpZiAobGVuZ3RoMiA+IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xyXG4gICAgICAgICAgICB0aGlzLm1fdTIueCAqPSAxLjAgLyBsZW5ndGgyO1xyXG4gICAgICAgICAgICB0aGlzLm1fdTIueSAqPSAxLjAgLyBsZW5ndGgyO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1fdTIuU2V0WmVybygpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIEMgPSB0aGlzLm1fbWF4TGVuZ3RoMiAtIGxlbmd0aDI7XHJcbiAgICAgICAgIGxpbmVhckVycm9yID0gYjJNYXRoLk1heChsaW5lYXJFcnJvciwgKC1DKSk7XHJcbiAgICAgICAgIEMgPSBiMk1hdGguQ2xhbXAoQyArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCAwLjApO1xyXG4gICAgICAgICBpbXB1bHNlID0gKC10aGlzLm1fbGltaXRNYXNzMiAqIEMpO1xyXG4gICAgICAgICBwMlggPSAoLWltcHVsc2UgKiB0aGlzLm1fdTIueCk7XHJcbiAgICAgICAgIHAyWSA9ICgtaW1wdWxzZSAqIHRoaXMubV91Mi55KTtcclxuICAgICAgICAgYkIubV9zd2VlcC5jLnggKz0gYkIubV9pbnZNYXNzICogcDJYO1xyXG4gICAgICAgICBiQi5tX3N3ZWVwLmMueSArPSBiQi5tX2ludk1hc3MgKiBwMlk7XHJcbiAgICAgICAgIGJCLm1fc3dlZXAuYSArPSBiQi5tX2ludkkgKiAocjJYICogcDJZIC0gcjJZICogcDJYKTtcclxuICAgICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbGluZWFyRXJyb3IgPCBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3A7XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlB1bGxleUpvaW50LmIyX21pblB1bGxleUxlbmd0aCA9IDIuMDtcclxuICAgfSk7XHJcbiAgIEJveDJELmluaGVyaXQoYjJQdWxsZXlKb2ludERlZiwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYpO1xyXG4gICBiMlB1bGxleUpvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xyXG4gICBiMlB1bGxleUpvaW50RGVmLmIyUHVsbGV5Sm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLmIySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5ncm91bmRBbmNob3JBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmdyb3VuZEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJQdWxsZXlKb2ludERlZi5wcm90b3R5cGUuYjJQdWxsZXlKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnREZWYuY2FsbCh0aGlzKTtcclxuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX3B1bGxleUpvaW50O1xyXG4gICAgICB0aGlzLmdyb3VuZEFuY2hvckEuU2V0KCgtMS4wKSwgMS4wKTtcclxuICAgICAgdGhpcy5ncm91bmRBbmNob3JCLlNldCgxLjAsIDEuMCk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBLlNldCgoLTEuMCksIDAuMCk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCLlNldCgxLjAsIDAuMCk7XHJcbiAgICAgIHRoaXMubGVuZ3RoQSA9IDAuMDtcclxuICAgICAgdGhpcy5tYXhMZW5ndGhBID0gMC4wO1xyXG4gICAgICB0aGlzLmxlbmd0aEIgPSAwLjA7XHJcbiAgICAgIHRoaXMubWF4TGVuZ3RoQiA9IDAuMDtcclxuICAgICAgdGhpcy5yYXRpbyA9IDEuMDtcclxuICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gdHJ1ZTtcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50RGVmLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKGJBLCBiQiwgZ2FBLCBnYUIsIGFuY2hvckEsIGFuY2hvckIsIHIpIHtcclxuICAgICAgaWYgKHIgPT09IHVuZGVmaW5lZCkgciA9IDA7XHJcbiAgICAgIHRoaXMuYm9keUEgPSBiQTtcclxuICAgICAgdGhpcy5ib2R5QiA9IGJCO1xyXG4gICAgICB0aGlzLmdyb3VuZEFuY2hvckEuU2V0VihnYUEpO1xyXG4gICAgICB0aGlzLmdyb3VuZEFuY2hvckIuU2V0VihnYUIpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3JBKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSB0aGlzLmJvZHlCLkdldExvY2FsUG9pbnQoYW5jaG9yQik7XHJcbiAgICAgIHZhciBkMVggPSBhbmNob3JBLnggLSBnYUEueDtcclxuICAgICAgdmFyIGQxWSA9IGFuY2hvckEueSAtIGdhQS55O1xyXG4gICAgICB0aGlzLmxlbmd0aEEgPSBNYXRoLnNxcnQoZDFYICogZDFYICsgZDFZICogZDFZKTtcclxuICAgICAgdmFyIGQyWCA9IGFuY2hvckIueCAtIGdhQi54O1xyXG4gICAgICB2YXIgZDJZID0gYW5jaG9yQi55IC0gZ2FCLnk7XHJcbiAgICAgIHRoaXMubGVuZ3RoQiA9IE1hdGguc3FydChkMlggKiBkMlggKyBkMlkgKiBkMlkpO1xyXG4gICAgICB0aGlzLnJhdGlvID0gcjtcclxuICAgICAgdmFyIEMgPSB0aGlzLmxlbmd0aEEgKyB0aGlzLnJhdGlvICogdGhpcy5sZW5ndGhCO1xyXG4gICAgICB0aGlzLm1heExlbmd0aEEgPSBDIC0gdGhpcy5yYXRpbyAqIGIyUHVsbGV5Sm9pbnQuYjJfbWluUHVsbGV5TGVuZ3RoO1xyXG4gICAgICB0aGlzLm1heExlbmd0aEIgPSAoQyAtIGIyUHVsbGV5Sm9pbnQuYjJfbWluUHVsbGV5TGVuZ3RoKSAvIHRoaXMucmF0aW87XHJcbiAgIH1cclxuICAgQm94MkQuaW5oZXJpdChiMlJldm9sdXRlSm9pbnQsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50KTtcclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xyXG4gICBiMlJldm9sdXRlSm9pbnQuYjJSZXZvbHV0ZUpvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMuSyA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIHRoaXMuSzEgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICB0aGlzLksyID0gbmV3IGIyTWF0MjIoKTtcclxuICAgICAgdGhpcy5LMyA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIHRoaXMuaW1wdWxzZTMgPSBuZXcgYjJWZWMzKCk7XHJcbiAgICAgIHRoaXMuaW1wdWxzZTIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMucmVkdWNlZCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XHJcbiAgICAgIHRoaXMubV9tYXNzID0gbmV3IGIyTWF0MzMoKTtcclxuICAgfTtcclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JBID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMSk7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqIHRoaXMubV9pbXB1bHNlLngsIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLnkpO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLno7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5HZXRKb2ludEFuZ2xlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLm1fc3dlZXAuYSAtIHRoaXMubV9ib2R5QS5tX3N3ZWVwLmEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5HZXRKb2ludFNwZWVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLm1fYW5ndWxhclZlbG9jaXR5IC0gdGhpcy5tX2JvZHlBLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuSXNMaW1pdEVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTGltaXQ7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5FbmFibGVMaW1pdCA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGZsYWc7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5HZXRMb3dlckxpbWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2xvd2VyQW5nbGU7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5HZXRVcHBlckxpbWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3VwcGVyQW5nbGU7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5TZXRMaW1pdHMgPSBmdW5jdGlvbiAobG93ZXIsIHVwcGVyKSB7XHJcbiAgICAgIGlmIChsb3dlciA9PT0gdW5kZWZpbmVkKSBsb3dlciA9IDA7XHJcbiAgICAgIGlmICh1cHBlciA9PT0gdW5kZWZpbmVkKSB1cHBlciA9IDA7XHJcbiAgICAgIHRoaXMubV9sb3dlckFuZ2xlID0gbG93ZXI7XHJcbiAgICAgIHRoaXMubV91cHBlckFuZ2xlID0gdXBwZXI7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5Jc01vdG9yRW5hYmxlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTW90b3I7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5FbmFibGVNb3RvciA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGZsYWc7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5TZXRNb3RvclNwZWVkID0gZnVuY3Rpb24gKHNwZWVkKSB7XHJcbiAgICAgIGlmIChzcGVlZCA9PT0gdW5kZWZpbmVkKSBzcGVlZCA9IDA7XHJcbiAgICAgIHRoaXMubV9ib2R5QS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IHNwZWVkO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9tb3RvclNwZWVkO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuU2V0TWF4TW90b3JUb3JxdWUgPSBmdW5jdGlvbiAodG9ycXVlKSB7XHJcbiAgICAgIGlmICh0b3JxdWUgPT09IHVuZGVmaW5lZCkgdG9ycXVlID0gMDtcclxuICAgICAgdGhpcy5tX21heE1vdG9yVG9ycXVlID0gdG9ycXVlO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0TW90b3JUb3JxdWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbWF4TW90b3JUb3JxdWU7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5iMlJldm9sdXRlSm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMS5TZXRWKGRlZi5sb2NhbEFuY2hvckEpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyLlNldFYoZGVmLmxvY2FsQW5jaG9yQik7XHJcbiAgICAgIHRoaXMubV9yZWZlcmVuY2VBbmdsZSA9IGRlZi5yZWZlcmVuY2VBbmdsZTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMC4wO1xyXG4gICAgICB0aGlzLm1fbG93ZXJBbmdsZSA9IGRlZi5sb3dlckFuZ2xlO1xyXG4gICAgICB0aGlzLm1fdXBwZXJBbmdsZSA9IGRlZi51cHBlckFuZ2xlO1xyXG4gICAgICB0aGlzLm1fbWF4TW90b3JUb3JxdWUgPSBkZWYubWF4TW90b3JUb3JxdWU7XHJcbiAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gZGVmLm1vdG9yU3BlZWQ7XHJcbiAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGRlZi5lbmFibGVMaW1pdDtcclxuICAgICAgdGhpcy5tX2VuYWJsZU1vdG9yID0gZGVmLmVuYWJsZU1vdG9yO1xyXG4gICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0O1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgfHwgdGhpcy5tX2VuYWJsZUxpbWl0KSB7fVxyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICByMVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgcjJYID0gdFg7XHJcbiAgICAgIHZhciBtMSA9IGJBLm1faW52TWFzcztcclxuICAgICAgdmFyIG0yID0gYkIubV9pbnZNYXNzO1xyXG4gICAgICB2YXIgaTEgPSBiQS5tX2ludkk7XHJcbiAgICAgIHZhciBpMiA9IGJCLm1faW52STtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMS54ID0gbTEgKyBtMiArIHIxWSAqIHIxWSAqIGkxICsgcjJZICogcjJZICogaTI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueCA9ICgtcjFZICogcjFYICogaTEpIC0gcjJZICogcjJYICogaTI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueCA9ICgtcjFZICogaTEpIC0gcjJZICogaTI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueSA9IHRoaXMubV9tYXNzLmNvbDIueDtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMi55ID0gbTEgKyBtMiArIHIxWCAqIHIxWCAqIGkxICsgcjJYICogcjJYICogaTI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueSA9IHIxWCAqIGkxICsgcjJYICogaTI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueiA9IHRoaXMubV9tYXNzLmNvbDMueDtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMi56ID0gdGhpcy5tX21hc3MuY29sMy55O1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnogPSBpMSArIGkyO1xyXG4gICAgICB0aGlzLm1fbW90b3JNYXNzID0gMS4wIC8gKGkxICsgaTIpO1xyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCkge1xyXG4gICAgICAgICB2YXIgam9pbnRBbmdsZSA9IGJCLm1fc3dlZXAuYSAtIGJBLm1fc3dlZXAuYSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcclxuICAgICAgICAgaWYgKGIyTWF0aC5BYnModGhpcy5tX3VwcGVyQW5nbGUgLSB0aGlzLm1fbG93ZXJBbmdsZSkgPCAyLjAgKiBiMlNldHRpbmdzLmIyX2FuZ3VsYXJTbG9wKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2VxdWFsTGltaXRzO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYgKGpvaW50QW5nbGUgPD0gdGhpcy5tX2xvd2VyQW5nbGUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9hdExvd2VyTGltaXQpIHtcclxuICAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDAuMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9hdExvd2VyTGltaXQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAoam9pbnRBbmdsZSA+PSB0aGlzLm1fdXBwZXJBbmdsZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMC4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDAuMDtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB2YXIgUFggPSB0aGlzLm1faW1wdWxzZS54O1xyXG4gICAgICAgICB2YXIgUFkgPSB0aGlzLm1faW1wdWxzZS55O1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggLT0gbTEgKiBQWDtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55IC09IG0xICogUFk7XHJcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5IC09IGkxICogKChyMVggKiBQWSAtIHIxWSAqIFBYKSArIHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KTtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IG0yICogUFg7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSBtMiAqIFBZO1xyXG4gICAgICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBpMiAqICgocjJYICogUFkgLSByMlkgKiBQWCkgKyB0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2Uueik7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcclxuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgbmV3SW1wdWxzZSA9IDA7XHJcbiAgICAgIHZhciByMVggPSAwO1xyXG4gICAgICB2YXIgcjFZID0gMDtcclxuICAgICAgdmFyIHIyWCA9IDA7XHJcbiAgICAgIHZhciByMlkgPSAwO1xyXG4gICAgICB2YXIgdjEgPSBiQS5tX2xpbmVhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdzEgPSBiQS5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHYyID0gYkIubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHcyID0gYkIubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciBtMSA9IGJBLm1faW52TWFzcztcclxuICAgICAgdmFyIG0yID0gYkIubV9pbnZNYXNzO1xyXG4gICAgICB2YXIgaTEgPSBiQS5tX2ludkk7XHJcbiAgICAgIHZhciBpMiA9IGJCLm1faW52STtcclxuICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3RvciAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfZXF1YWxMaW1pdHMpIHtcclxuICAgICAgICAgdmFyIENkb3QgPSB3MiAtIHcxIC0gdGhpcy5tX21vdG9yU3BlZWQ7XHJcbiAgICAgICAgIHZhciBpbXB1bHNlID0gdGhpcy5tX21vdG9yTWFzcyAqICgoLUNkb3QpKTtcclxuICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlO1xyXG4gICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4TW90b3JUb3JxdWU7XHJcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSBiMk1hdGguQ2xhbXAodGhpcy5tX21vdG9ySW1wdWxzZSArIGltcHVsc2UsICgtbWF4SW1wdWxzZSksIG1heEltcHVsc2UpO1xyXG4gICAgICAgICBpbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZSAtIG9sZEltcHVsc2U7XHJcbiAgICAgICAgIHcxIC09IGkxICogaW1wdWxzZTtcclxuICAgICAgICAgdzIgKz0gaTIgKiBpbXB1bHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQpIHtcclxuICAgICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgICAgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICAgICByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgICAgIHIxWCA9IHRYO1xyXG4gICAgICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICAgICByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgICAgIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgICAgcjJYID0gdFg7XHJcbiAgICAgICAgIHZhciBDZG90MVggPSB2Mi54ICsgKCgtdzIgKiByMlkpKSAtIHYxLnggLSAoKC13MSAqIHIxWSkpO1xyXG4gICAgICAgICB2YXIgQ2RvdDFZID0gdjIueSArICh3MiAqIHIyWCkgLSB2MS55IC0gKHcxICogcjFYKTtcclxuICAgICAgICAgdmFyIENkb3QyID0gdzIgLSB3MTtcclxuICAgICAgICAgdGhpcy5tX21hc3MuU29sdmUzMyh0aGlzLmltcHVsc2UzLCAoLUNkb3QxWCksICgtQ2RvdDFZKSwgKC1DZG90MikpO1xyXG4gICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2VxdWFsTGltaXRzKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLkFkZCh0aGlzLmltcHVsc2UzKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfYXRMb3dlckxpbWl0KSB7XHJcbiAgICAgICAgICAgIG5ld0ltcHVsc2UgPSB0aGlzLm1faW1wdWxzZS56ICsgdGhpcy5pbXB1bHNlMy56O1xyXG4gICAgICAgICAgICBpZiAobmV3SW1wdWxzZSA8IDAuMCkge1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbWFzcy5Tb2x2ZTIyKHRoaXMucmVkdWNlZCwgKC1DZG90MVgpLCAoLUNkb3QxWSkpO1xyXG4gICAgICAgICAgICAgICB0aGlzLmltcHVsc2UzLnggPSB0aGlzLnJlZHVjZWQueDtcclxuICAgICAgICAgICAgICAgdGhpcy5pbXB1bHNlMy55ID0gdGhpcy5yZWR1Y2VkLnk7XHJcbiAgICAgICAgICAgICAgIHRoaXMuaW1wdWxzZTMueiA9ICgtdGhpcy5tX2ltcHVsc2Uueik7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKz0gdGhpcy5yZWR1Y2VkLng7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gdGhpcy5yZWR1Y2VkLnk7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XHJcbiAgICAgICAgICAgIG5ld0ltcHVsc2UgPSB0aGlzLm1faW1wdWxzZS56ICsgdGhpcy5pbXB1bHNlMy56O1xyXG4gICAgICAgICAgICBpZiAobmV3SW1wdWxzZSA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbWFzcy5Tb2x2ZTIyKHRoaXMucmVkdWNlZCwgKC1DZG90MVgpLCAoLUNkb3QxWSkpO1xyXG4gICAgICAgICAgICAgICB0aGlzLmltcHVsc2UzLnggPSB0aGlzLnJlZHVjZWQueDtcclxuICAgICAgICAgICAgICAgdGhpcy5pbXB1bHNlMy55ID0gdGhpcy5yZWR1Y2VkLnk7XHJcbiAgICAgICAgICAgICAgIHRoaXMuaW1wdWxzZTMueiA9ICgtdGhpcy5tX2ltcHVsc2Uueik7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKz0gdGhpcy5yZWR1Y2VkLng7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gdGhpcy5yZWR1Y2VkLnk7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICB2MS54IC09IG0xICogdGhpcy5pbXB1bHNlMy54O1xyXG4gICAgICAgICB2MS55IC09IG0xICogdGhpcy5pbXB1bHNlMy55O1xyXG4gICAgICAgICB3MSAtPSBpMSAqIChyMVggKiB0aGlzLmltcHVsc2UzLnkgLSByMVkgKiB0aGlzLmltcHVsc2UzLnggKyB0aGlzLmltcHVsc2UzLnopO1xyXG4gICAgICAgICB2Mi54ICs9IG0yICogdGhpcy5pbXB1bHNlMy54O1xyXG4gICAgICAgICB2Mi55ICs9IG0yICogdGhpcy5pbXB1bHNlMy55O1xyXG4gICAgICAgICB3MiArPSBpMiAqIChyMlggKiB0aGlzLmltcHVsc2UzLnkgLSByMlkgKiB0aGlzLmltcHVsc2UzLnggKyB0aGlzLmltcHVsc2UzLnopO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICAgICByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgICAgIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgICAgcjFYID0gdFg7XHJcbiAgICAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgICAgIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgICAgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICAgICByMlggPSB0WDtcclxuICAgICAgICAgdmFyIENkb3RYID0gdjIueCArICgoLXcyICogcjJZKSkgLSB2MS54IC0gKCgtdzEgKiByMVkpKTtcclxuICAgICAgICAgdmFyIENkb3RZID0gdjIueSArICh3MiAqIHIyWCkgLSB2MS55IC0gKHcxICogcjFYKTtcclxuICAgICAgICAgdGhpcy5tX21hc3MuU29sdmUyMih0aGlzLmltcHVsc2UyLCAoLUNkb3RYKSwgKC1DZG90WSkpO1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IHRoaXMuaW1wdWxzZTIueDtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSB0aGlzLmltcHVsc2UyLnk7XHJcbiAgICAgICAgIHYxLnggLT0gbTEgKiB0aGlzLmltcHVsc2UyLng7XHJcbiAgICAgICAgIHYxLnkgLT0gbTEgKiB0aGlzLmltcHVsc2UyLnk7XHJcbiAgICAgICAgIHcxIC09IGkxICogKHIxWCAqIHRoaXMuaW1wdWxzZTIueSAtIHIxWSAqIHRoaXMuaW1wdWxzZTIueCk7XHJcbiAgICAgICAgIHYyLnggKz0gbTIgKiB0aGlzLmltcHVsc2UyLng7XHJcbiAgICAgICAgIHYyLnkgKz0gbTIgKiB0aGlzLmltcHVsc2UyLnk7XHJcbiAgICAgICAgIHcyICs9IGkyICogKHIyWCAqIHRoaXMuaW1wdWxzZTIueSAtIHIyWSAqIHRoaXMuaW1wdWxzZTIueCk7XHJcbiAgICAgIH1cclxuICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS5TZXRWKHYxKTtcclxuICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgPSB3MTtcclxuICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS5TZXRWKHYyKTtcclxuICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgPSB3MjtcclxuICAgfVxyXG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcclxuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xyXG4gICAgICB2YXIgb2xkTGltaXRJbXB1bHNlID0gMDtcclxuICAgICAgdmFyIEMgPSAwO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciBhbmd1bGFyRXJyb3IgPSAwLjA7XHJcbiAgICAgIHZhciBwb3NpdGlvbkVycm9yID0gMC4wO1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgaW1wdWxzZVggPSAwO1xyXG4gICAgICB2YXIgaW1wdWxzZVkgPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0ICYmIHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0KSB7XHJcbiAgICAgICAgIHZhciBhbmdsZSA9IGJCLm1fc3dlZXAuYSAtIGJBLm1fc3dlZXAuYSAtIHRoaXMubV9yZWZlcmVuY2VBbmdsZTtcclxuICAgICAgICAgdmFyIGxpbWl0SW1wdWxzZSA9IDAuMDtcclxuICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IGIySm9pbnQuZV9lcXVhbExpbWl0cykge1xyXG4gICAgICAgICAgICBDID0gYjJNYXRoLkNsYW1wKGFuZ2xlIC0gdGhpcy5tX2xvd2VyQW5nbGUsICgtYjJTZXR0aW5ncy5iMl9tYXhBbmd1bGFyQ29ycmVjdGlvbiksIGIyU2V0dGluZ3MuYjJfbWF4QW5ndWxhckNvcnJlY3Rpb24pO1xyXG4gICAgICAgICAgICBsaW1pdEltcHVsc2UgPSAoLXRoaXMubV9tb3Rvck1hc3MgKiBDKTtcclxuICAgICAgICAgICAgYW5ndWxhckVycm9yID0gYjJNYXRoLkFicyhDKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfYXRMb3dlckxpbWl0KSB7XHJcbiAgICAgICAgICAgIEMgPSBhbmdsZSAtIHRoaXMubV9sb3dlckFuZ2xlO1xyXG4gICAgICAgICAgICBhbmd1bGFyRXJyb3IgPSAoLUMpO1xyXG4gICAgICAgICAgICBDID0gYjJNYXRoLkNsYW1wKEMgKyBiMlNldHRpbmdzLmIyX2FuZ3VsYXJTbG9wLCAoLWIyU2V0dGluZ3MuYjJfbWF4QW5ndWxhckNvcnJlY3Rpb24pLCAwLjApO1xyXG4gICAgICAgICAgICBsaW1pdEltcHVsc2UgPSAoLXRoaXMubV9tb3Rvck1hc3MgKiBDKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XHJcbiAgICAgICAgICAgIEMgPSBhbmdsZSAtIHRoaXMubV91cHBlckFuZ2xlO1xyXG4gICAgICAgICAgICBhbmd1bGFyRXJyb3IgPSBDO1xyXG4gICAgICAgICAgICBDID0gYjJNYXRoLkNsYW1wKEMgLSBiMlNldHRpbmdzLmIyX2FuZ3VsYXJTbG9wLCAwLjAsIGIyU2V0dGluZ3MuYjJfbWF4QW5ndWxhckNvcnJlY3Rpb24pO1xyXG4gICAgICAgICAgICBsaW1pdEltcHVsc2UgPSAoLXRoaXMubV9tb3Rvck1hc3MgKiBDKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBiQS5tX3N3ZWVwLmEgLT0gYkEubV9pbnZJICogbGltaXRJbXB1bHNlO1xyXG4gICAgICAgICBiQi5tX3N3ZWVwLmEgKz0gYkIubV9pbnZJICogbGltaXRJbXB1bHNlO1xyXG4gICAgICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICB9IHtcclxuICAgICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgICAgcjFYID0gdFg7XHJcbiAgICAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgICAgIHIyWCA9IHRYO1xyXG4gICAgICAgICB2YXIgQ1ggPSBiQi5tX3N3ZWVwLmMueCArIHIyWCAtIGJBLm1fc3dlZXAuYy54IC0gcjFYO1xyXG4gICAgICAgICB2YXIgQ1kgPSBiQi5tX3N3ZWVwLmMueSArIHIyWSAtIGJBLm1fc3dlZXAuYy55IC0gcjFZO1xyXG4gICAgICAgICB2YXIgQ0xlbmd0aFNxdWFyZWQgPSBDWCAqIENYICsgQ1kgKiBDWTtcclxuICAgICAgICAgdmFyIENMZW5ndGggPSBNYXRoLnNxcnQoQ0xlbmd0aFNxdWFyZWQpO1xyXG4gICAgICAgICBwb3NpdGlvbkVycm9yID0gQ0xlbmd0aDtcclxuICAgICAgICAgdmFyIGludk1hc3MxID0gYkEubV9pbnZNYXNzO1xyXG4gICAgICAgICB2YXIgaW52TWFzczIgPSBiQi5tX2ludk1hc3M7XHJcbiAgICAgICAgIHZhciBpbnZJMSA9IGJBLm1faW52STtcclxuICAgICAgICAgdmFyIGludkkyID0gYkIubV9pbnZJO1xyXG4gICAgICAgICB2YXIga19hbGxvd2VkU3RyZXRjaCA9IDEwLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3A7XHJcbiAgICAgICAgIGlmIChDTGVuZ3RoU3F1YXJlZCA+IGtfYWxsb3dlZFN0cmV0Y2ggKiBrX2FsbG93ZWRTdHJldGNoKSB7XHJcbiAgICAgICAgICAgIHZhciB1WCA9IENYIC8gQ0xlbmd0aDtcclxuICAgICAgICAgICAgdmFyIHVZID0gQ1kgLyBDTGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgayA9IGludk1hc3MxICsgaW52TWFzczI7XHJcbiAgICAgICAgICAgIHZhciBtID0gMS4wIC8gaztcclxuICAgICAgICAgICAgaW1wdWxzZVggPSBtICogKCgtQ1gpKTtcclxuICAgICAgICAgICAgaW1wdWxzZVkgPSBtICogKCgtQ1kpKTtcclxuICAgICAgICAgICAgdmFyIGtfYmV0YSA9IDAuNTtcclxuICAgICAgICAgICAgYkEubV9zd2VlcC5jLnggLT0ga19iZXRhICogaW52TWFzczEgKiBpbXB1bHNlWDtcclxuICAgICAgICAgICAgYkEubV9zd2VlcC5jLnkgLT0ga19iZXRhICogaW52TWFzczEgKiBpbXB1bHNlWTtcclxuICAgICAgICAgICAgYkIubV9zd2VlcC5jLnggKz0ga19iZXRhICogaW52TWFzczIgKiBpbXB1bHNlWDtcclxuICAgICAgICAgICAgYkIubV9zd2VlcC5jLnkgKz0ga19iZXRhICogaW52TWFzczIgKiBpbXB1bHNlWTtcclxuICAgICAgICAgICAgQ1ggPSBiQi5tX3N3ZWVwLmMueCArIHIyWCAtIGJBLm1fc3dlZXAuYy54IC0gcjFYO1xyXG4gICAgICAgICAgICBDWSA9IGJCLm1fc3dlZXAuYy55ICsgcjJZIC0gYkEubV9zd2VlcC5jLnkgLSByMVk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdGhpcy5LMS5jb2wxLnggPSBpbnZNYXNzMSArIGludk1hc3MyO1xyXG4gICAgICAgICB0aGlzLksxLmNvbDIueCA9IDAuMDtcclxuICAgICAgICAgdGhpcy5LMS5jb2wxLnkgPSAwLjA7XHJcbiAgICAgICAgIHRoaXMuSzEuY29sMi55ID0gaW52TWFzczEgKyBpbnZNYXNzMjtcclxuICAgICAgICAgdGhpcy5LMi5jb2wxLnggPSBpbnZJMSAqIHIxWSAqIHIxWTtcclxuICAgICAgICAgdGhpcy5LMi5jb2wyLnggPSAoLWludkkxICogcjFYICogcjFZKTtcclxuICAgICAgICAgdGhpcy5LMi5jb2wxLnkgPSAoLWludkkxICogcjFYICogcjFZKTtcclxuICAgICAgICAgdGhpcy5LMi5jb2wyLnkgPSBpbnZJMSAqIHIxWCAqIHIxWDtcclxuICAgICAgICAgdGhpcy5LMy5jb2wxLnggPSBpbnZJMiAqIHIyWSAqIHIyWTtcclxuICAgICAgICAgdGhpcy5LMy5jb2wyLnggPSAoLWludkkyICogcjJYICogcjJZKTtcclxuICAgICAgICAgdGhpcy5LMy5jb2wxLnkgPSAoLWludkkyICogcjJYICogcjJZKTtcclxuICAgICAgICAgdGhpcy5LMy5jb2wyLnkgPSBpbnZJMiAqIHIyWCAqIHIyWDtcclxuICAgICAgICAgdGhpcy5LLlNldE0odGhpcy5LMSk7XHJcbiAgICAgICAgIHRoaXMuSy5BZGRNKHRoaXMuSzIpO1xyXG4gICAgICAgICB0aGlzLksuQWRkTSh0aGlzLkszKTtcclxuICAgICAgICAgdGhpcy5LLlNvbHZlKGIyUmV2b2x1dGVKb2ludC50SW1wdWxzZSwgKC1DWCksICgtQ1kpKTtcclxuICAgICAgICAgaW1wdWxzZVggPSBiMlJldm9sdXRlSm9pbnQudEltcHVsc2UueDtcclxuICAgICAgICAgaW1wdWxzZVkgPSBiMlJldm9sdXRlSm9pbnQudEltcHVsc2UueTtcclxuICAgICAgICAgYkEubV9zd2VlcC5jLnggLT0gYkEubV9pbnZNYXNzICogaW1wdWxzZVg7XHJcbiAgICAgICAgIGJBLm1fc3dlZXAuYy55IC09IGJBLm1faW52TWFzcyAqIGltcHVsc2VZO1xyXG4gICAgICAgICBiQS5tX3N3ZWVwLmEgLT0gYkEubV9pbnZJICogKHIxWCAqIGltcHVsc2VZIC0gcjFZICogaW1wdWxzZVgpO1xyXG4gICAgICAgICBiQi5tX3N3ZWVwLmMueCArPSBiQi5tX2ludk1hc3MgKiBpbXB1bHNlWDtcclxuICAgICAgICAgYkIubV9zd2VlcC5jLnkgKz0gYkIubV9pbnZNYXNzICogaW1wdWxzZVk7XHJcbiAgICAgICAgIGJCLm1fc3dlZXAuYSArPSBiQi5tX2ludkkgKiAocjJYICogaW1wdWxzZVkgLSByMlkgKiBpbXB1bHNlWCk7XHJcbiAgICAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgICAgIGJCLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHBvc2l0aW9uRXJyb3IgPD0gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wICYmIGFuZ3VsYXJFcnJvciA8PSBiMlNldHRpbmdzLmIyX2FuZ3VsYXJTbG9wO1xyXG4gICB9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJSZXZvbHV0ZUpvaW50LnRJbXB1bHNlID0gbmV3IGIyVmVjMigpO1xyXG4gICB9KTtcclxuICAgQm94MkQuaW5oZXJpdChiMlJldm9sdXRlSm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcclxuICAgYjJSZXZvbHV0ZUpvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xyXG4gICBiMlJldm9sdXRlSm9pbnREZWYuYjJSZXZvbHV0ZUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJSZXZvbHV0ZUpvaW50RGVmLnByb3RvdHlwZS5iMlJldm9sdXRlSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9yZXZvbHV0ZUpvaW50O1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQS5TZXQoMC4wLCAwLjApO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQi5TZXQoMC4wLCAwLjApO1xyXG4gICAgICB0aGlzLnJlZmVyZW5jZUFuZ2xlID0gMC4wO1xyXG4gICAgICB0aGlzLmxvd2VyQW5nbGUgPSAwLjA7XHJcbiAgICAgIHRoaXMudXBwZXJBbmdsZSA9IDAuMDtcclxuICAgICAgdGhpcy5tYXhNb3RvclRvcnF1ZSA9IDAuMDtcclxuICAgICAgdGhpcy5tb3RvclNwZWVkID0gMC4wO1xyXG4gICAgICB0aGlzLmVuYWJsZUxpbWl0ID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuZW5hYmxlTW90b3IgPSBmYWxzZTtcclxuICAgfVxyXG4gICBiMlJldm9sdXRlSm9pbnREZWYucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoYkEsIGJCLCBhbmNob3IpIHtcclxuICAgICAgdGhpcy5ib2R5QSA9IGJBO1xyXG4gICAgICB0aGlzLmJvZHlCID0gYkI7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gdGhpcy5ib2R5QS5HZXRMb2NhbFBvaW50KGFuY2hvcik7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gdGhpcy5ib2R5Qi5HZXRMb2NhbFBvaW50KGFuY2hvcik7XHJcbiAgICAgIHRoaXMucmVmZXJlbmNlQW5nbGUgPSB0aGlzLmJvZHlCLkdldEFuZ2xlKCkgLSB0aGlzLmJvZHlBLkdldEFuZ2xlKCk7XHJcbiAgIH1cclxuICAgQm94MkQuaW5oZXJpdChiMldlbGRKb2ludCwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQpO1xyXG4gICBiMldlbGRKb2ludC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LnByb3RvdHlwZTtcclxuICAgYjJXZWxkSm9pbnQuYjJXZWxkSm9pbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmIySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XHJcbiAgICAgIHRoaXMubV9tYXNzID0gbmV3IGIyTWF0MzMoKTtcclxuICAgfTtcclxuICAgYjJXZWxkSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JBKTtcclxuICAgfVxyXG4gICBiMldlbGRKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xyXG4gICB9XHJcbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqIHRoaXMubV9pbXB1bHNlLngsIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLnkpO1xyXG4gICB9XHJcbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gaW52X2R0ICogdGhpcy5tX2ltcHVsc2UuejtcclxuICAgfVxyXG4gICBiMldlbGRKb2ludC5wcm90b3R5cGUuYjJXZWxkSm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQS5TZXRWKGRlZi5sb2NhbEFuY2hvckEpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3JCLlNldFYoZGVmLmxvY2FsQW5jaG9yQik7XHJcbiAgICAgIHRoaXMubV9yZWZlcmVuY2VBbmdsZSA9IGRlZi5yZWZlcmVuY2VBbmdsZTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fbWFzcyA9IG5ldyBiMk1hdDMzKCk7XHJcbiAgIH1cclxuICAgYjJXZWxkSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgckFYID0gdGhpcy5tX2xvY2FsQW5jaG9yQS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgckFZID0gdGhpcy5tX2xvY2FsQW5jaG9yQS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHJBWCArIHRNYXQuY29sMi54ICogckFZKTtcclxuICAgICAgckFZID0gKHRNYXQuY29sMS55ICogckFYICsgdE1hdC5jb2wyLnkgKiByQVkpO1xyXG4gICAgICByQVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHJCWCA9IHRoaXMubV9sb2NhbEFuY2hvckIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJCWSA9IHRoaXMubV9sb2NhbEFuY2hvckIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQlggKyB0TWF0LmNvbDIueCAqIHJCWSk7XHJcbiAgICAgIHJCWSA9ICh0TWF0LmNvbDEueSAqIHJCWCArIHRNYXQuY29sMi55ICogckJZKTtcclxuICAgICAgckJYID0gdFg7XHJcbiAgICAgIHZhciBtQSA9IGJBLm1faW52TWFzcztcclxuICAgICAgdmFyIG1CID0gYkIubV9pbnZNYXNzO1xyXG4gICAgICB2YXIgaUEgPSBiQS5tX2ludkk7XHJcbiAgICAgIHZhciBpQiA9IGJCLm1faW52STtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMS54ID0gbUEgKyBtQiArIHJBWSAqIHJBWSAqIGlBICsgckJZICogckJZICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueCA9ICgtckFZICogckFYICogaUEpIC0gckJZICogckJYICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueCA9ICgtckFZICogaUEpIC0gckJZICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueSA9IHRoaXMubV9tYXNzLmNvbDIueDtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMi55ID0gbUEgKyBtQiArIHJBWCAqIHJBWCAqIGlBICsgckJYICogckJYICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueSA9IHJBWCAqIGlBICsgckJYICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueiA9IHRoaXMubV9tYXNzLmNvbDMueDtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMi56ID0gdGhpcy5tX21hc3MuY29sMy55O1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnogPSBpQSArIGlCO1xyXG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS56ICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54IC09IG1BICogdGhpcy5tX2ltcHVsc2UueDtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55IC09IG1BICogdGhpcy5tX2ltcHVsc2UueTtcclxuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgLT0gaUEgKiAockFYICogdGhpcy5tX2ltcHVsc2UueSAtIHJBWSAqIHRoaXMubV9pbXB1bHNlLnggKyB0aGlzLm1faW1wdWxzZS56KTtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IG1CICogdGhpcy5tX2ltcHVsc2UueDtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IG1CICogdGhpcy5tX2ltcHVsc2UueTtcclxuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gaUIgKiAockJYICogdGhpcy5tX2ltcHVsc2UueSAtIHJCWSAqIHRoaXMubV9pbXB1bHNlLnggKyB0aGlzLm1faW1wdWxzZS56KTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJXZWxkSm9pbnQucHJvdG90eXBlLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHZBID0gYkEubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHdBID0gYkEubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB2QiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3QiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgbUEgPSBiQS5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBtQiA9IGJCLm1faW52TWFzcztcclxuICAgICAgdmFyIGlBID0gYkEubV9pbnZJO1xyXG4gICAgICB2YXIgaUIgPSBiQi5tX2ludkk7XHJcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgIHZhciByQVggPSB0aGlzLm1fbG9jYWxBbmNob3JBLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByQVkgPSB0aGlzLm1fbG9jYWxBbmNob3JBLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogckFYICsgdE1hdC5jb2wyLnggKiByQVkpO1xyXG4gICAgICByQVkgPSAodE1hdC5jb2wxLnkgKiByQVggKyB0TWF0LmNvbDIueSAqIHJBWSk7XHJcbiAgICAgIHJBWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgckJYID0gdGhpcy5tX2xvY2FsQW5jaG9yQi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgckJZID0gdGhpcy5tX2xvY2FsQW5jaG9yQi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHJCWCArIHRNYXQuY29sMi54ICogckJZKTtcclxuICAgICAgckJZID0gKHRNYXQuY29sMS55ICogckJYICsgdE1hdC5jb2wyLnkgKiByQlkpO1xyXG4gICAgICByQlggPSB0WDtcclxuICAgICAgdmFyIENkb3QxWCA9IHZCLnggLSB3QiAqIHJCWSAtIHZBLnggKyB3QSAqIHJBWTtcclxuICAgICAgdmFyIENkb3QxWSA9IHZCLnkgKyB3QiAqIHJCWCAtIHZBLnkgLSB3QSAqIHJBWDtcclxuICAgICAgdmFyIENkb3QyID0gd0IgLSB3QTtcclxuICAgICAgdmFyIGltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XHJcbiAgICAgIHRoaXMubV9tYXNzLlNvbHZlMzMoaW1wdWxzZSwgKC1DZG90MVgpLCAoLUNkb3QxWSksICgtQ2RvdDIpKTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UuQWRkKGltcHVsc2UpO1xyXG4gICAgICB2QS54IC09IG1BICogaW1wdWxzZS54O1xyXG4gICAgICB2QS55IC09IG1BICogaW1wdWxzZS55O1xyXG4gICAgICB3QSAtPSBpQSAqIChyQVggKiBpbXB1bHNlLnkgLSByQVkgKiBpbXB1bHNlLnggKyBpbXB1bHNlLnopO1xyXG4gICAgICB2Qi54ICs9IG1CICogaW1wdWxzZS54O1xyXG4gICAgICB2Qi55ICs9IG1CICogaW1wdWxzZS55O1xyXG4gICAgICB3QiArPSBpQiAqIChyQlggKiBpbXB1bHNlLnkgLSByQlkgKiBpbXB1bHNlLnggKyBpbXB1bHNlLnopO1xyXG4gICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSA9IHdBO1xyXG4gICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSA9IHdCO1xyXG4gICB9XHJcbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XHJcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgckFYID0gdGhpcy5tX2xvY2FsQW5jaG9yQS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgckFZID0gdGhpcy5tX2xvY2FsQW5jaG9yQS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHJBWCArIHRNYXQuY29sMi54ICogckFZKTtcclxuICAgICAgckFZID0gKHRNYXQuY29sMS55ICogckFYICsgdE1hdC5jb2wyLnkgKiByQVkpO1xyXG4gICAgICByQVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHJCWCA9IHRoaXMubV9sb2NhbEFuY2hvckIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJCWSA9IHRoaXMubV9sb2NhbEFuY2hvckIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQlggKyB0TWF0LmNvbDIueCAqIHJCWSk7XHJcbiAgICAgIHJCWSA9ICh0TWF0LmNvbDEueSAqIHJCWCArIHRNYXQuY29sMi55ICogckJZKTtcclxuICAgICAgckJYID0gdFg7XHJcbiAgICAgIHZhciBtQSA9IGJBLm1faW52TWFzcztcclxuICAgICAgdmFyIG1CID0gYkIubV9pbnZNYXNzO1xyXG4gICAgICB2YXIgaUEgPSBiQS5tX2ludkk7XHJcbiAgICAgIHZhciBpQiA9IGJCLm1faW52STtcclxuICAgICAgdmFyIEMxWCA9IGJCLm1fc3dlZXAuYy54ICsgckJYIC0gYkEubV9zd2VlcC5jLnggLSByQVg7XHJcbiAgICAgIHZhciBDMVkgPSBiQi5tX3N3ZWVwLmMueSArIHJCWSAtIGJBLm1fc3dlZXAuYy55IC0gckFZO1xyXG4gICAgICB2YXIgQzIgPSBiQi5tX3N3ZWVwLmEgLSBiQS5tX3N3ZWVwLmEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XHJcbiAgICAgIHZhciBrX2FsbG93ZWRTdHJldGNoID0gMTAuMCAqIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcclxuICAgICAgdmFyIHBvc2l0aW9uRXJyb3IgPSBNYXRoLnNxcnQoQzFYICogQzFYICsgQzFZICogQzFZKTtcclxuICAgICAgdmFyIGFuZ3VsYXJFcnJvciA9IGIyTWF0aC5BYnMoQzIpO1xyXG4gICAgICBpZiAocG9zaXRpb25FcnJvciA+IGtfYWxsb3dlZFN0cmV0Y2gpIHtcclxuICAgICAgICAgaUEgKj0gMS4wO1xyXG4gICAgICAgICBpQiAqPSAxLjA7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX21hc3MuY29sMS54ID0gbUEgKyBtQiArIHJBWSAqIHJBWSAqIGlBICsgckJZICogckJZICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueCA9ICgtckFZICogckFYICogaUEpIC0gckJZICogckJYICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueCA9ICgtckFZICogaUEpIC0gckJZICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueSA9IHRoaXMubV9tYXNzLmNvbDIueDtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMi55ID0gbUEgKyBtQiArIHJBWCAqIHJBWCAqIGlBICsgckJYICogckJYICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDMueSA9IHJBWCAqIGlBICsgckJYICogaUI7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueiA9IHRoaXMubV9tYXNzLmNvbDMueDtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMi56ID0gdGhpcy5tX21hc3MuY29sMy55O1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnogPSBpQSArIGlCO1xyXG4gICAgICB2YXIgaW1wdWxzZSA9IG5ldyBiMlZlYzMoKTtcclxuICAgICAgdGhpcy5tX21hc3MuU29sdmUzMyhpbXB1bHNlLCAoLUMxWCksICgtQzFZKSwgKC1DMikpO1xyXG4gICAgICBiQS5tX3N3ZWVwLmMueCAtPSBtQSAqIGltcHVsc2UueDtcclxuICAgICAgYkEubV9zd2VlcC5jLnkgLT0gbUEgKiBpbXB1bHNlLnk7XHJcbiAgICAgIGJBLm1fc3dlZXAuYSAtPSBpQSAqIChyQVggKiBpbXB1bHNlLnkgLSByQVkgKiBpbXB1bHNlLnggKyBpbXB1bHNlLnopO1xyXG4gICAgICBiQi5tX3N3ZWVwLmMueCArPSBtQiAqIGltcHVsc2UueDtcclxuICAgICAgYkIubV9zd2VlcC5jLnkgKz0gbUIgKiBpbXB1bHNlLnk7XHJcbiAgICAgIGJCLm1fc3dlZXAuYSArPSBpQiAqIChyQlggKiBpbXB1bHNlLnkgLSByQlkgKiBpbXB1bHNlLnggKyBpbXB1bHNlLnopO1xyXG4gICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICByZXR1cm4gcG9zaXRpb25FcnJvciA8PSBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AgJiYgYW5ndWxhckVycm9yIDw9IGIyU2V0dGluZ3MuYjJfYW5ndWxhclNsb3A7XHJcbiAgIH1cclxuICAgQm94MkQuaW5oZXJpdChiMldlbGRKb2ludERlZiwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYpO1xyXG4gICBiMldlbGRKb2ludERlZi5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLnByb3RvdHlwZTtcclxuICAgYjJXZWxkSm9pbnREZWYuYjJXZWxkSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLmIySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMldlbGRKb2ludERlZi5wcm90b3R5cGUuYjJXZWxkSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV93ZWxkSm9pbnQ7XHJcbiAgICAgIHRoaXMucmVmZXJlbmNlQW5nbGUgPSAwLjA7XHJcbiAgIH1cclxuICAgYjJXZWxkSm9pbnREZWYucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoYkEsIGJCLCBhbmNob3IpIHtcclxuICAgICAgdGhpcy5ib2R5QSA9IGJBO1xyXG4gICAgICB0aGlzLmJvZHlCID0gYkI7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBLlNldFYodGhpcy5ib2R5QS5HZXRMb2NhbFBvaW50KGFuY2hvcikpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQi5TZXRWKHRoaXMuYm9keUIuR2V0TG9jYWxQb2ludChhbmNob3IpKTtcclxuICAgICAgdGhpcy5yZWZlcmVuY2VBbmdsZSA9IHRoaXMuYm9keUIuR2V0QW5nbGUoKSAtIHRoaXMuYm9keUEuR2V0QW5nbGUoKTtcclxuICAgfVxyXG59KSgpO1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYjJEZWJ1Z0RyYXcgPSBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdztcclxuICAgYjJEZWJ1Z0RyYXcuYjJEZWJ1Z0RyYXcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9kcmF3U2NhbGUgPSAxLjA7XHJcbiAgICAgIHRoaXMubV9saW5lVGhpY2tuZXNzID0gMS4wO1xyXG4gICAgICB0aGlzLm1fYWxwaGEgPSAxLjA7XHJcbiAgICAgIHRoaXMubV9maWxsQWxwaGEgPSAxLjA7XHJcbiAgICAgIHRoaXMubV94Zm9ybVNjYWxlID0gMS4wO1xyXG4gICAgICB2YXIgX190aGlzID0gdGhpcztcclxuICAgICAgLy8jV09SS0FST1VORFxyXG4gICAgICB0aGlzLm1fc3ByaXRlID0ge1xyXG4gICAgICAgICBncmFwaGljczoge1xyXG4gICAgICAgICAgICBjbGVhcjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICBfX3RoaXMubV9jdHguY2xlYXJSZWN0KDAsIDAsIF9fdGhpcy5tX2N0eC5jYW52YXMud2lkdGgsIF9fdGhpcy5tX2N0eC5jYW52YXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLl9jb2xvciA9IGZ1bmN0aW9uIChjb2xvciwgYWxwaGEpIHtcclxuICAgICAgcmV0dXJuIFwicmdiYShcIiArICgoY29sb3IgJiAweEZGMDAwMCkgPj4gMTYpICsgXCIsXCIgKyAoKGNvbG9yICYgMHhGRjAwKSA+PiA4KSArIFwiLFwiICsgKGNvbG9yICYgMHhGRikgKyBcIixcIiArIGFscGhhICsgXCIpXCI7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5iMkRlYnVnRHJhdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX2RyYXdGbGFncyA9IDA7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRGbGFncyA9IGZ1bmN0aW9uIChmbGFncykge1xyXG4gICAgICBpZiAoZmxhZ3MgPT09IHVuZGVmaW5lZCkgZmxhZ3MgPSAwO1xyXG4gICAgICB0aGlzLm1fZHJhd0ZsYWdzID0gZmxhZ3M7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRGbGFncyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9kcmF3RmxhZ3M7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5BcHBlbmRGbGFncyA9IGZ1bmN0aW9uIChmbGFncykge1xyXG4gICAgICBpZiAoZmxhZ3MgPT09IHVuZGVmaW5lZCkgZmxhZ3MgPSAwO1xyXG4gICAgICB0aGlzLm1fZHJhd0ZsYWdzIHw9IGZsYWdzO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuQ2xlYXJGbGFncyA9IGZ1bmN0aW9uIChmbGFncykge1xyXG4gICAgICBpZiAoZmxhZ3MgPT09IHVuZGVmaW5lZCkgZmxhZ3MgPSAwO1xyXG4gICAgICB0aGlzLm1fZHJhd0ZsYWdzICY9IH5mbGFncztcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldFNwcml0ZSA9IGZ1bmN0aW9uIChzcHJpdGUpIHtcclxuICAgICAgdGhpcy5tX2N0eCA9IHNwcml0ZTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldFNwcml0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jdHg7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXREcmF3U2NhbGUgPSBmdW5jdGlvbiAoZHJhd1NjYWxlKSB7XHJcbiAgICAgIGlmIChkcmF3U2NhbGUgPT09IHVuZGVmaW5lZCkgZHJhd1NjYWxlID0gMDtcclxuICAgICAgdGhpcy5tX2RyYXdTY2FsZSA9IGRyYXdTY2FsZTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldERyYXdTY2FsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9kcmF3U2NhbGU7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRMaW5lVGhpY2tuZXNzID0gZnVuY3Rpb24gKGxpbmVUaGlja25lc3MpIHtcclxuICAgICAgaWYgKGxpbmVUaGlja25lc3MgPT09IHVuZGVmaW5lZCkgbGluZVRoaWNrbmVzcyA9IDA7XHJcbiAgICAgIHRoaXMubV9saW5lVGhpY2tuZXNzID0gbGluZVRoaWNrbmVzcztcclxuICAgICAgdGhpcy5tX2N0eC5zdHJva2VXaWR0aCA9IGxpbmVUaGlja25lc3M7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRMaW5lVGhpY2tuZXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2xpbmVUaGlja25lc3M7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRBbHBoYSA9IGZ1bmN0aW9uIChhbHBoYSkge1xyXG4gICAgICBpZiAoYWxwaGEgPT09IHVuZGVmaW5lZCkgYWxwaGEgPSAwO1xyXG4gICAgICB0aGlzLm1fYWxwaGEgPSBhbHBoYTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldEFscGhhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2FscGhhO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0RmlsbEFscGhhID0gZnVuY3Rpb24gKGFscGhhKSB7XHJcbiAgICAgIGlmIChhbHBoYSA9PT0gdW5kZWZpbmVkKSBhbHBoYSA9IDA7XHJcbiAgICAgIHRoaXMubV9maWxsQWxwaGEgPSBhbHBoYTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldEZpbGxBbHBoYSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9maWxsQWxwaGE7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRYRm9ybVNjYWxlID0gZnVuY3Rpb24gKHhmb3JtU2NhbGUpIHtcclxuICAgICAgaWYgKHhmb3JtU2NhbGUgPT09IHVuZGVmaW5lZCkgeGZvcm1TY2FsZSA9IDA7XHJcbiAgICAgIHRoaXMubV94Zm9ybVNjYWxlID0geGZvcm1TY2FsZTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldFhGb3JtU2NhbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1feGZvcm1TY2FsZTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdQb2x5Z29uID0gZnVuY3Rpb24gKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCwgY29sb3IpIHtcclxuICAgICAgaWYgKCF2ZXJ0ZXhDb3VudCkgcmV0dXJuO1xyXG4gICAgICB2YXIgcyA9IHRoaXMubV9jdHg7XHJcbiAgICAgIHZhciBkcmF3U2NhbGUgPSB0aGlzLm1fZHJhd1NjYWxlO1xyXG4gICAgICBzLmJlZ2luUGF0aCgpO1xyXG4gICAgICBzLnN0cm9rZVN0eWxlID0gdGhpcy5fY29sb3IoY29sb3IuY29sb3IsIHRoaXMubV9hbHBoYSk7XHJcbiAgICAgIHMubW92ZVRvKHZlcnRpY2VzWzBdLnggKiBkcmF3U2NhbGUsIHZlcnRpY2VzWzBdLnkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHZlcnRleENvdW50OyBpKyspIHtcclxuICAgICAgICAgcy5saW5lVG8odmVydGljZXNbaV0ueCAqIGRyYXdTY2FsZSwgdmVydGljZXNbaV0ueSAqIGRyYXdTY2FsZSk7XHJcbiAgICAgIH1cclxuICAgICAgcy5saW5lVG8odmVydGljZXNbMF0ueCAqIGRyYXdTY2FsZSwgdmVydGljZXNbMF0ueSAqIGRyYXdTY2FsZSk7XHJcbiAgICAgIHMuY2xvc2VQYXRoKCk7XHJcbiAgICAgIHMuc3Ryb2tlKCk7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3U29saWRQb2x5Z29uID0gZnVuY3Rpb24gKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCwgY29sb3IpIHtcclxuICAgICAgaWYgKCF2ZXJ0ZXhDb3VudCkgcmV0dXJuO1xyXG4gICAgICB2YXIgcyA9IHRoaXMubV9jdHg7XHJcbiAgICAgIHZhciBkcmF3U2NhbGUgPSB0aGlzLm1fZHJhd1NjYWxlO1xyXG4gICAgICBzLmJlZ2luUGF0aCgpO1xyXG4gICAgICBzLnN0cm9rZVN0eWxlID0gdGhpcy5fY29sb3IoY29sb3IuY29sb3IsIHRoaXMubV9hbHBoYSk7XHJcbiAgICAgIHMuZmlsbFN0eWxlID0gdGhpcy5fY29sb3IoY29sb3IuY29sb3IsIHRoaXMubV9maWxsQWxwaGEpO1xyXG4gICAgICBzLm1vdmVUbyh2ZXJ0aWNlc1swXS54ICogZHJhd1NjYWxlLCB2ZXJ0aWNlc1swXS55ICogZHJhd1NjYWxlKTtcclxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB2ZXJ0ZXhDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgIHMubGluZVRvKHZlcnRpY2VzW2ldLnggKiBkcmF3U2NhbGUsIHZlcnRpY2VzW2ldLnkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICB9XHJcbiAgICAgIHMubGluZVRvKHZlcnRpY2VzWzBdLnggKiBkcmF3U2NhbGUsIHZlcnRpY2VzWzBdLnkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICBzLmNsb3NlUGF0aCgpO1xyXG4gICAgICBzLmZpbGwoKTtcclxuICAgICAgcy5zdHJva2UoKTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdDaXJjbGUgPSBmdW5jdGlvbiAoY2VudGVyLCByYWRpdXMsIGNvbG9yKSB7XHJcbiAgICAgIGlmICghcmFkaXVzKSByZXR1cm47XHJcbiAgICAgIHZhciBzID0gdGhpcy5tX2N0eDtcclxuICAgICAgdmFyIGRyYXdTY2FsZSA9IHRoaXMubV9kcmF3U2NhbGU7XHJcbiAgICAgIHMuYmVnaW5QYXRoKCk7XHJcbiAgICAgIHMuc3Ryb2tlU3R5bGUgPSB0aGlzLl9jb2xvcihjb2xvci5jb2xvciwgdGhpcy5tX2FscGhhKTtcclxuICAgICAgcy5hcmMoY2VudGVyLnggKiBkcmF3U2NhbGUsIGNlbnRlci55ICogZHJhd1NjYWxlLCByYWRpdXMgKiBkcmF3U2NhbGUsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcclxuICAgICAgcy5jbG9zZVBhdGgoKTtcclxuICAgICAgcy5zdHJva2UoKTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdTb2xpZENpcmNsZSA9IGZ1bmN0aW9uIChjZW50ZXIsIHJhZGl1cywgYXhpcywgY29sb3IpIHtcclxuICAgICAgaWYgKCFyYWRpdXMpIHJldHVybjtcclxuICAgICAgdmFyIHMgPSB0aGlzLm1fY3R4LFxyXG4gICAgICAgICBkcmF3U2NhbGUgPSB0aGlzLm1fZHJhd1NjYWxlLFxyXG4gICAgICAgICBjeCA9IGNlbnRlci54ICogZHJhd1NjYWxlLFxyXG4gICAgICAgICBjeSA9IGNlbnRlci55ICogZHJhd1NjYWxlO1xyXG4gICAgICBzLm1vdmVUbygwLCAwKTtcclxuICAgICAgcy5iZWdpblBhdGgoKTtcclxuICAgICAgcy5zdHJva2VTdHlsZSA9IHRoaXMuX2NvbG9yKGNvbG9yLmNvbG9yLCB0aGlzLm1fYWxwaGEpO1xyXG4gICAgICBzLmZpbGxTdHlsZSA9IHRoaXMuX2NvbG9yKGNvbG9yLmNvbG9yLCB0aGlzLm1fZmlsbEFscGhhKTtcclxuICAgICAgcy5hcmMoY3gsIGN5LCByYWRpdXMgKiBkcmF3U2NhbGUsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcclxuICAgICAgcy5tb3ZlVG8oY3gsIGN5KTtcclxuICAgICAgcy5saW5lVG8oKGNlbnRlci54ICsgYXhpcy54ICogcmFkaXVzKSAqIGRyYXdTY2FsZSwgKGNlbnRlci55ICsgYXhpcy55ICogcmFkaXVzKSAqIGRyYXdTY2FsZSk7XHJcbiAgICAgIHMuY2xvc2VQYXRoKCk7XHJcbiAgICAgIHMuZmlsbCgpO1xyXG4gICAgICBzLnN0cm9rZSgpO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1NlZ21lbnQgPSBmdW5jdGlvbiAocDEsIHAyLCBjb2xvcikge1xyXG4gICAgICB2YXIgcyA9IHRoaXMubV9jdHgsXHJcbiAgICAgICAgIGRyYXdTY2FsZSA9IHRoaXMubV9kcmF3U2NhbGU7XHJcbiAgICAgIHMuc3Ryb2tlU3R5bGUgPSB0aGlzLl9jb2xvcihjb2xvci5jb2xvciwgdGhpcy5tX2FscGhhKTtcclxuICAgICAgcy5iZWdpblBhdGgoKTtcclxuICAgICAgcy5tb3ZlVG8ocDEueCAqIGRyYXdTY2FsZSwgcDEueSAqIGRyYXdTY2FsZSk7XHJcbiAgICAgIHMubGluZVRvKHAyLnggKiBkcmF3U2NhbGUsIHAyLnkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICBzLmNsb3NlUGF0aCgpO1xyXG4gICAgICBzLnN0cm9rZSgpO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1RyYW5zZm9ybSA9IGZ1bmN0aW9uICh4Zikge1xyXG4gICAgICB2YXIgcyA9IHRoaXMubV9jdHgsXHJcbiAgICAgICAgIGRyYXdTY2FsZSA9IHRoaXMubV9kcmF3U2NhbGU7XHJcbiAgICAgIHMuYmVnaW5QYXRoKCk7XHJcbiAgICAgIHMuc3Ryb2tlU3R5bGUgPSB0aGlzLl9jb2xvcigweGZmMDAwMCwgdGhpcy5tX2FscGhhKTtcclxuICAgICAgcy5tb3ZlVG8oeGYucG9zaXRpb24ueCAqIGRyYXdTY2FsZSwgeGYucG9zaXRpb24ueSAqIGRyYXdTY2FsZSk7XHJcbiAgICAgIHMubGluZVRvKCh4Zi5wb3NpdGlvbi54ICsgdGhpcy5tX3hmb3JtU2NhbGUgKiB4Zi5SLmNvbDEueCkgKiBkcmF3U2NhbGUsICh4Zi5wb3NpdGlvbi55ICsgdGhpcy5tX3hmb3JtU2NhbGUgKiB4Zi5SLmNvbDEueSkgKiBkcmF3U2NhbGUpO1xyXG5cclxuICAgICAgcy5zdHJva2VTdHlsZSA9IHRoaXMuX2NvbG9yKDB4ZmYwMCwgdGhpcy5tX2FscGhhKTtcclxuICAgICAgcy5tb3ZlVG8oeGYucG9zaXRpb24ueCAqIGRyYXdTY2FsZSwgeGYucG9zaXRpb24ueSAqIGRyYXdTY2FsZSk7XHJcbiAgICAgIHMubGluZVRvKCh4Zi5wb3NpdGlvbi54ICsgdGhpcy5tX3hmb3JtU2NhbGUgKiB4Zi5SLmNvbDIueCkgKiBkcmF3U2NhbGUsICh4Zi5wb3NpdGlvbi55ICsgdGhpcy5tX3hmb3JtU2NhbGUgKiB4Zi5SLmNvbDIueSkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICBzLmNsb3NlUGF0aCgpO1xyXG4gICAgICBzLnN0cm9rZSgpO1xyXG4gICB9O1xyXG59KSgpO1xyXG52YXIgaTtcclxuZm9yIChpID0gMDsgaSA8IEJveDJELnBvc3REZWZzLmxlbmd0aDsgKytpKSBCb3gyRC5wb3N0RGVmc1tpXSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBCb3gyRCJdfQ==
