(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// This file contains shortcuts for the methods of the Box2D library that are used
// too often to type their long names

var B2d = function(){

};

B2d.prototype.init = function(){
	include();

	this.b2Vec2 = Box2D.Common.Math.b2Vec2;
	this.b2BodyDef = Box2D.Dynamics.b2BodyDef;
	this.b2Body = Box2D.Dynamics.b2Body;
	this.b2FixtureDef = Box2D.Dynamics.b2FixtureDef;
	this.b2Fixture = Box2D.Dynamics.b2Fixture;
	this.b2World = Box2D.Dynamics.b2World;
	this.b2MassData = Box2D.Collision.Shapes.b2MassData;
	this.b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape;
	this.b2CircleShape = Box2D.Collision.Shapes.b2CircleShape;
	this.b2DebugDraw = Box2D.Dynamics.b2DebugDraw; 
	this.b2ContactListener = Box2D.Dynamics.b2ContactListener;

};

module.exports = new B2d;

var Includes = require("./Includes.js"); var include_data = Includes.get_include_data({
	current_module: "B2d", 
	include_options: Includes.choices.OTHER_STUFF
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"./Includes.js":18}],2:[function(require,module,exports){
var Config = function(){
	this.SCREEN_W = 0; // set up when the page is loaded (to 95% of width of containing element) 
	this.SCREEN_H = 600;

	this.MAIN_CANVAS_NAME = "display_canvas";
	this.DEBUG_CANVAS_NAME = "debug_canvas";

	// Frames Per Second. Essentially, frequency of createjs.Ticker 
	// Warning! Frequency of the Box2D physics updates may be different
	// (Currently not implemented)
	this.FPS = 30; 
	
	//the movement edge, controls terrain generation
	this.movement_edge = 0;

	// Box2D stuff >>>
	this.B2D = {
		SCALE: 30,
		SPS: 60, 			// Steps Per Second
		VELOCITY_ITR: 8,	// velocity iterations
		POSITION_ITR: 3,	// position iterations
		debug_draw: false
	};

	this.TerrainSlice = {
		grid_rows: 20,
		grid_columns: 20,
		cell_w: 1, // in meters

		// is automatically incremented each time new TerrainSliceModel is instantiated:
		next_slice_id: 0 
	};

	this.World = {
		maxy: 22,

	};
	// <<<
};

module.exports = new Config;

},{}],3:[function(require,module,exports){

var AssetController = (function(){
	/*
	   AssetController is in charge of setting up all bitmaps/animations/other resources
	   for everyone else.
   */

	// use AssetModel.loader.getResult("id_of_the_asset");

	var init = function(asset_path){
		include();	

		/* TODO make model with the easily managed tables of resources which will be
		   added to the loader automatically
		*/

		//loader = new createjs.LoadQueue(false); // loading resourses using preload.js
		//loader.addEventListener("complete", handleComplete);
		var manifest = AssetModel.manifest;	
		AssetModel.loader.loadManifest(manifest, true, asset_path);
		
	};

	var post_init = function(){
		/* this function will be done differently at some point
		 * it'll have something to do with refactoring InitController
		 */

		//AssetModel.animations["ant"] = new createjs.SpriteSheet({
			//"framerate": 0.2,
			//"images": [get_asset("Ant1"), get_asset("Ant2"), get_asset("Ant3")],
			//"frames": { "regX": 3, "regY": 6, "height": 25, "width": 50, "count": 6},
			//"animations": {
				//"walk": [0, 1, "walk"],
				//"upside_down": [2, 3, "upside_down"],
				//"death": [4, 5, "death"]
			//}
		//})

	};
	

	var get_asset = function(id){

		var result = AssetModel.loader.getResult(id);

		if(!result){
			throw "Error: asset with id " + id + " could not be loaded." +
				" Check that id is valid and that assets were properly loaded";
		}
		
		return result;
	};
		


	
	return {
		init: init,
		get_asset: get_asset,
	};

})();

module.exports = AssetController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "AssetController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],4:[function(require,module,exports){
var EntityController = (function () {
    /* Description
    */

    var type_logic_table;

    var Count = 0;

    var init = function () {
        /* is ran from the InitController once when the game is loaded */

        include(); // satisfy requirements

        type_logic_table = {
            "ant": AntLogic,
            "hero": HeroLogic,
            "Griffin": GriffinLogic,
            "Hyena": HyenaLogic,
        };

        for (type in type_logic_table) {
            var logic = type_logic_table[type];
            logic.init();

            if (logic.begin_contact) {
                PhysicsController.listen_for_contact_with(type, "BeginContact", logic.begin_contact);
            }

            if (logic.end_contact) {
                PhysicsController.listen_for_contact_with(type, "EndContact", logic.end_contact);
            }

            if (logic.pre_solve) {
                PhysicsController.listen_for_contact_with(type, "PreSolve", logic.pre_solve);
            }

            if (logic.post_solve) {
                PhysicsController.listen_for_contact_with(type, "PostSolve", logic.post_solve);
            }

        }

        spawn(10, 10, "hero");
    };

    var spawn = function (x, y, type) {
        /**
        * spawn entity of the given type at the given coordinates
        * also registeres thing as awaiting graphics initialization
        */
        var logic = type_logic_table[type];

        if (logic) {
            var new_entity = logic.spawn(x, y);
            RegisterAsController.register_as("awaiting_graphics_initialization", new_entity)

            if (!EntityModel.for_logic_update[type]) {
                EntityModel.for_logic_update[type] = {};
            }
            var logic_upd_table = EntityModel.for_logic_update[type];
            logic_upd_table[new_entity.id] = new_entity;
        } else {
            throw "Logic for the type " + type + " is not defined";
        }


    };



    var despawn = function (entity) {
        /**
         * this function will despawn given entity
         * in one of two ways:
         * if entity has despawn function, it will be called
         * if not, entity will be deleted directly
        */

        var type = entity.type;
        var id = entity.id;
        var logic = type_logic_table[type];

        if (logic.despawn) {
            // if custom despawn function is provided, call it
            logic.despawn(entity);
            console.log("despawn called for the type", type);
        } else {
            // or delete directly
            delete_entity(entity);
        }

    };



    var delete_entity = function (entity) {
        /**
        * This function will remove this entity along with some other info about this entity
        * from the world, it'll also free the id of this entity. The physical body will be deleted
        * too; 
        * This function is supposed to be called by the individual logic modules, when the are finished
        * animating deat/destruction of something and want to get rid of it
        */

        // TODO: finish this function and then update it regularly;
        // This one is very sensitive, as even one reference left may prevent 
        // object from being deleted and cause memory leaks. Testing is required
        if (entity.body != null) {
            var body = entity.body;
        } else {
            // body is required. if place where body is stored changed, you should update this function
            throw "Body of the instance is undefined"
        }

        if (entity.id != null) {
            var id = entity.id;
        } else {
            // id is needed, if id system changed, and you are here, update this function
            throw "There is no id associated with this instance"
        }

        if (entity.type != null) {
            var type = entity.type;
        } else {
            // id is needed, if id system changed, and you are here, update this function
            throw "There is no type associated with this instance"
        }

        // remove graphics
        //GraphicsController.destroy_graphics_for(id);
        RegisterAsController.register_as("removed_entity", entity);
        // remove physics
        PhysicsController.remove_body(body);
        // remove stored references within EntityController/Model
        delete EntityModel.for_logic_update[type][id];
        // free the id
        IdentificationController.remove_id(id);
    };

    var update = function (delta) {
        /* is ran each tick from the GameController.update_all */
        var debug_commands = KeyboardController.debug_commands();

        // demonstration purposes for ant
        if (debug_commands("spawn_ant")) {
            var new_ant = spawn(WorldController.get_movement_edge() + Math.random() * 50, 10, "ant");
        }

        // demonstration purposes for griffin

        if (debug_commands("spawn_griffin") && Count > 5) {
            var new_griffin = spawn(Math.random() * 50 + WorldController.get_movement_edge(), -20, "Griffin");
            Count = 0;
        }
        Count++;

        if (debug_commands("spawn_griffin")) {
            var new_griffin = spawn(Math.random() * 50 + WorldController.get_movement_edge(), 10, "Griffin");
        }


        // demonstration purposes for hyena
        if (debug_commands("spawn_hyena")) {
            var new_hyena = spawn(Math.random() * 50 + WorldController.get_movement_edge(), 10, "Hyena");
        }

        for (var type in EntityModel.for_logic_update) {
            var table = EntityModel.for_logic_update[type];

            var logic = type_logic_table[type];
            for (var id in table) {
                var entity = table[id];

                if (beyond_world_boundary(entity)) {
                    // if outside boundaries of the world, despawn
                    despawn(entity);
                    if (entity.type == "hero") {
                        entity.hp = 0;
                    }
                    console.log("entity of type", type, "deleted due to the world boundary");
                } else {
                    // else tick its AI
                    logic.tick_AI(entity);
                }
            }

        } // end for in 

    };

    var beyond_world_boundary = function (entity) {
        /**
        * checks if the entity is beyond one of the world boundaries,
        */
        var body = entity.body;
        return (body.GetWorldCenter().x < WorldController.get_movement_edge() ||
            body.GetWorldCenter().y > Config.World.maxy);

    };
		
		
		var create_abstract_entity = function(){
			return new AbstractEntity();
		};
		
		
	var get_all_heroes = function(){
		return {0:EntityModel.hero};
	};
	
	var get_my_hero = function(){
		return EntityModel.hero;
	};
	
	var load_hero = function(id){
		EntityModel.hero = IdentificationController.get_by_id(id);
	}
	
	var handle_hero_sync = function(){};
	
	var handle_delete = function(){};
	
	var handle_spawn = function(){};
	
	var reg_for_logic_update = function(){};
	
	/**
	Documentation will be here, someday
	*/
	this.AbstractEntity = function(){
		this.hp = 2;
		this.speed = 7;
		this.jump_force = 125;
		this.damage = 5;
		this.point_value = 200;
		this.sight_range = 16; //distance at which entity detects heroes
		this.attack_range = 8; //distance at which entity leaps at the hero
		
		this.hit_taken = false; //whether a hit has been taken since the last tick
		this.damage_taken = 0; //the amount of damage inflicted by hits since the last tick
		
		this.direction = false;	//false=left, true=right;
		this.direction_previous = false;//store direction from end of previous tick
		this.x_previous = 0;		//store x value from end of previous tick
		
		this.is_idle = true; //determines whether entity is aggressive or idle
		this.idle_duration = 40; // time buffer between changing idle states
		this.idle_timer = this.idle_duration;
		this.idle_counter = 0; //used to manage the number of times the entity has changed state while idle
		this.is_alive = true; //disables attacking and plays death animation while false
		this.death_duration = 30;//time between death and deletion
		this.decay_duration = 20;//time between decay animation and deletion
		this.death_timer = -1;
		this.running_away = false; //whether the entity is running away
		this.run_away_duration = 30; //set cowardice level
		this.run_away_timer = -1;
		this.can_attack = true;	//whether attacking is enabled
		this.attack_cooldown = 10; //attack cooldown
		this.attack_cooldown_timer = -1;
		this.can_leap = true;		//leaping enabled
		this.leap_cooldown = 40;//minimum time between leaps
		this.leap_cooldown_timer = -1; 
		this.charge_duration = 80;//maximum length of a charge
		this.charge_timer = this.charge_duration;
		this.charge_cooldown = 20;//minimum time between charges
		this.charge_cooldown_timer = -1;
		this.blinking = false;	//whether entity is blinking
		this.blink_duration = 20;//how long the entity blinks after taking damage
		this.blink_timer = -1;
		this.maintenance_frequency = 20;//ticks between routine maintenance checks
		this.maintenance_timer = this.maintenance_frequency;
		
		this.path_blocked = false;//is this deprecated? set during collision
		this.obstruction_tolerance = 4;//how many times the entity can be blocked before he takes action
		this.blocked_count = 0;//tracks number of times blocked between maintenance checks
		
		this.needs_graphics_update = false; //accessed by renderer for animation purposes
		this.animation = "stand"; //accessed by renderer for animation purposes
		
		this.jump = function(entity){
			ApplyImpulse(new B2d.b2Vec2((2*entity.jump_force*entity.direction) - entity.jump_force, -1*entity.jump_force/2), body.GetWorldCenter());
		};
		
		this.move = function(){
			var dir = (this.direction*2-1);
			var velocity = this.body.GetLinearVelocity();
			velocity.x = this.speed*dir; //move speed in current direction
			this.body.SetLinearVelocity(velocity);
		};
			
		//check for enemies in range (vision or jump)
		this.enemy_in_range = function(range){
			var output = false;
			/*
			//multiplayer implementation
			var hero_list = [];
			
			for (i=0;i<hero_list.length;i++){
				if(in range){
				output = true;
				break;
				}
			}
			return output;
			*/
			var hero_x = EntityController.get_my_hero().body.GetWorldCenter().x;
			output = (Math.abs(hero_x - this.body.GetWorldCenter().x) < range);
			return output;
		};
		
		//returns the direction of nearest enemy
		this.direction_nearest_enemy = function(){
			/*//in multiplayer, first find nearest enemy
			var nearest = hero[0];
			for(i < 8){
				if(typeof hero[i] !== 'undefined'){
					if(distance_formula(hero[i],this) < distance_formula(nearest,this)){
						nearest = hero[i];
					}
				}
			}*/
			var nearest;
			var hero_x = EntityController.get_my_hero().body.GetWorldCenter().x;
			var distance = (hero_x - this.body.GetWorldCenter().x);
			return (distance > 0);//return true/right of distance is positive, return false/left if distance is negative
		};
		
		//decrease health
		this.take_damage = function(){
			this.hp -= this.damage_taken;
			this.damage_taken = 0;
			this.hit_taken = false;
			this.blinking = true;
			this.blink_timer = this.blink_duration;
			//knockback here
		};
		
		//die
		this.die = function(){
			if (this.is_alive){//if alive, kill it
				this.death_timer = this.death_duration;
				this.is_alive = false;
				WorldController.increase_score(this.point_value);
				this.hit_taken = false;
				this.can_attack = false;
				this.change_animation(this,"death");
				return ;
			}else{//else decay
				this.death_timer--;
				if (this.death_timer <= this.death_duration && this.death_timer > this.decay_duration && this.death_timer > 0){
					this.change_animation("death");
				} else if (this.death_timer <= this.decay_duration && this.death_timer > 0){
					this.change_animation("decay");
				} else {
					EntityController.delete_entity(this);//remove instance from memory
				}
				return;
			}
		}
		
		//takes a string as parameters. returns the fixture with fixture_name == name, or null if it does not exist
		this.get_fixture = function(name){
			var current_fixture = this.body.GetFixtureList();
			while (current_fixture != null){
				if (current_fixture.GetUserData() != null){
					if (current_fixture.GetUserData().name == name){
						break;
					}
				}
				current_fixture = current_fixture.GetNext();
			}
			if (current_fixture.GetUserData() == null){
				current_fixture = null;
			}else if (current_fixture.GetUserData().name != name){
				current_fixture = null;
			}
			return current_fixture;
		};
		
		//checks if movement is voluntary or forced
		this.movement_voluntary = function(){
			//if direction being faced is different from the direction moving, return false
			var output = true;
			var velocity = this.body.GetLinearVelocity().x;
			if(velocity != 0){
				output = (velocity/Math.abs(velocity) == (this.direction)*2-1);
			}
			return output;
		};

		//checks if in the air
		this.in_air = function(){
			var body = this.body;
			var objects_beneath;
			if (body.GetFixtureList() != null){//prevent bugs on destruction
				var AABB = body.GetFixtureList().GetNext().GetNext().GetAABB();
				objects_beneath = PhysicsController.query_aabb(AABB);
			}else{
				objects_beneath = 0;
			}
			return (objects_beneath < 5);//for some mysterious reason, it counts 4 collisions even in mid air
		};

		//checks if there is a collision in current direction
		this.path_free = function(){
			var body = this.body;
			var objects_before;
			var AABB;
			if (body.GetFixtureList() != null){//prevent bugs on destruction
				if (this.direction){
					AABB = body.GetFixtureList().GetAABB();
					objects_before = PhysicsController.query_aabb(AABB);
				}else{
					AABB = body.GetFixtureList().GetNext().GetAABB();
					objects_before = PhysicsController.query_aabb(AABB);
				}
			}else{
				objects_before = 0;
			}
			return (objects_before < 4);//assumes contact with bottom sensor, top sensor, and main shape 
		};

		//setter for animation variable, ensures the animation is only reset on actual change
		this.change_animation = function(new_animation){
			if(this.animation != new_animation){
				this.animation = new_animation;
				this.needs_graphics_update = true;
			}else{ 
				this.needs_graphics_update = false;
			}
		};
	};

	return {
		// declare public
		init: init, 
		update: update,
		//get_operation: get_operation,
		reg_for_logic_update: reg_for_logic_update,
		spawn: spawn,
		delete_entity: delete_entity,
		//fulfill_delete_request: fulfill_delete_request,
		handle_spawn: handle_spawn,
		handle_delete: handle_delete,
		handle_hero_sync: handle_hero_sync,
		get_all_heroes: get_all_heroes,
		get_my_hero: get_my_hero,
		create_abstract_entity: create_abstract_entity,
		load_hero: load_hero,
    };
})();

module.exports = EntityController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
    current_module: "EntityController",
    include_options: Includes.choices.DEFAULT | Includes.choices.LOGIC
}); eval(include_data.name_statements); var include = function () { eval(include_data.module_statements); }
},{"../Includes.js":18}],5:[function(require,module,exports){


var GameController = (function(){

	var init = function(){
		include();
	};
		

	var update_all = function(event){
		/*
		 * main function pretty much
		 * everyghing else is called from here every tick
		 */
	    var cmds = KeyboardController.pause_commands();
	    if (cmds("pause") && GameModel.pauseCounter > 10 && GraphicsController.get_health() > 0) {
	        createjs.Ticker.paused = !createjs.Ticker.paused;
	        GameModel.pauseCounter = 0;
	        console.log("pause");
	    }
	    GameModel.pauseCounter += 1;
		
		if (!createjs.Ticker.paused){
			var delta = event.delta;

			// !!!! world simulation step goes somewhere right here
			// as per current design, will take delta as an argument
		
			//TerrainController.generate_terrain(); 
			//PlayerController.update();
		
			WorldController.update(delta);

			TerrainController.update();
			EntityController.update();

			// Should be called after all movement of objects is done:
			HUDController.update();
			//BackgroundController.update();
			GraphicsController.update();
		}
	};


	return {
		init: init,
		update_all: update_all,
	};

})();

module.exports = GameController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "GameController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],6:[function(require,module,exports){
/*
GraphicsController
	Public Functions:
	-init()
		sets up the GraphicsController for the rest of the game, called once during initialization
	-update(int delta)
		common function, called each tick. performs routine graphics maintenance
		registers all instances that were marked for registration since the last tick
		renders all registered instances
	-get_stage()
		returns the stage object, an easeljs object that stores information about the game
	-get_camera()
		returns the camera object, which controls the view offset
	-get_asset(string id)
		retrieves the asset with id; an alias for the same function in AssetController
	-reg_for_render(Easeljs_obj sprite, Object entity_instance)
		links an entity with a sprite and registers it to be rendered each tick
	-set_reg_position(easeljs_obj,int offset_x,int offset_y)
		adjusts a sprites x and y offsets to conform to the box2d system
	-request_bitmap(string? id)
		retrieves a previously loaded asset as a sprite
	-request_animated(string id, string||int start_animation/start_frame)
		returns a new sprite object generated from the image id and the start frame
	-destroy_graphics_for(int id)
		destroys the graphics objects associated with the instance of the passed id
	-follow(int id)
		sets the camera to follow the object of the passed id
	-get_movement_edge()
		returns left camera bound, a.k.a, the movement edge. used for lots of things
		
*/
var GraphicsController = (function(){
	/* 
	Controls all graphics and provides an interface for common easel.js functions
	*/
	
	var get_asset; 
	var type_renderer_table;
	var PrivateGraphics; 
	var reRender = false;

	var init = function(){
		/* is ran from the InitController once when the game is loaded */
		include(); // satisfy requirements

		//All renderers must be registered here
		//Links each renderer with its object id
		type_renderer_table = {
		// type:	renderer:
			"ant": AntRenderer,
			"hero": HeroRenderer,
			"Griffin":GriffinRenderer,
			"Hyena": HyenaRenderer,
			"terrain_cell": TerrainCellRenderer,
			"terrain_slice": TerrainSliceRenderer,
		};

		get_asset = AssetController.get_asset; // for quicker access

		GraphicsModel.stage = new createjs.Stage(Config.MAIN_CANVAS_NAME);
		GraphicsModel.stage.canvas.width = Config.SCREEN_W;
		GraphicsModel.stage.canvas.height = Config.SCREEN_H;
		
		GraphicsModel.camera.offset_from_followed.x -= (1614 - GraphicsModel.stage.canvas.width) / 3;

		// init all renderers
		for(type in type_renderer_table){
			type_renderer_table[type].init();
		}

		// this object is passed to all renderers to give them access to functions
		// that no one else is supposed to be able to access
		PrivateGraphics = {
			stage: GraphicsModel.stage,
			request_bitmap: request_bitmap,
			request_animated: request_animated,
			get_asset: get_asset,
			trans_xy: trans_xy,
			reg_for_render: reg_for_render,
		};

		BackgroundRenderer.init();

	};

    
	var update = function(delta){
		/* is ran each tick from the GameController.update_all */
		
		update_camera(); // needs to be updated first

		destroy_unneeded(); // goes second, do not update any stuff before unneeded stuff is removed

		register_new_stuff();

		render_things();
		
		synchronize_to_physical_bodies();

		BackgroundRenderer.render();
		
		GraphicsModel.stage.update();
	};

	var destroy_unneeded = function(){
		/**
		* destroy graphics for everything that was marked
		* for destruction
		*/

		var slices = RegisterAsController.retrieve_registered_as("removed_slice");

		var entities = RegisterAsController.retrieve_registered_as("removed_entity");

		while(slices.length > 0){
			var slice = slices.pop();
			var grid = slice.grid;

			for(var i = 0; i < grid.length; i++){
				var row = grid[i]; // or is it a column?

				for(var j = 0; j < row.length; j++){
					var cell = row[j];
					if(cell.kind != 0){
						destroy_graphics_for(cell.id);
					}
				}
			}
			
		}
		
		while(entities.length > 0){
			var entity = entities.pop();
			destroy_graphics_for(entity.id);
		}
	};
	
	

	var follow = function(id){
		//order camera to follow the graphical representation
		//of an object with the given id, if it exists
		GraphicsModel.camera.following = GraphicsModel.all_physical[id];
	};
	
	
	var register_new_stuff = function(){
		//search through all instances in the queue 
		//and register them for graphics updates.

		// retrieve instances of physical things that do not have graphics yet
		var new_stuff = RegisterAsController.retrieve_registered_as("awaiting_graphics_initialization");

		var length = new_stuff.length
		for(var i = 0; i < length; i++){
			var new_obj = new_stuff.pop();
			if(type_renderer_table[new_obj.type]){
				// if renderer exists for this type, register through it
				type_renderer_table[new_obj.type].register(new_obj, PrivateGraphics);	
			}else{
				throw "No renderer found for the type " + String(new_obj.type) +
					" confirm that renderer exists and is added to the GraphicsController.type_renderer_table"
			}
		}
	};
	
	var render_things = function(){
		/**
		* call renderers for everything
		*/
		
		var to_render = GraphicsModel.special_render;

		for(var type in to_render){
			var table = to_render[type];
			var renderer = type_renderer_table[type];

			for(var id in table){
				renderer.render(table[id], PrivateGraphics);
			}
		}
		
	};

	//called from update(), maintains camera position
	var update_camera = function(){
		var camera = GraphicsModel.camera;
		var center = camera.center;
		
		center.x = Config.SCREEN_W/2 - camera.offset_from_followed.x;
		//CAMERA SHOULD NOT MOVE VERTICALLY
		//center.y = Config.SCREEN_H/2 - camera.offset_from_followed.y;
		
		if(camera.following != null){
		    camera.offset.x = center.x - camera.following.physical_instance.body.GetWorldCenter().x * Config.B2D.SCALE;
			camera.offset.y = center.y - camera.following.physical_instance.body.GetWorldCenter().y * Config.B2D.SCALE;
			// now, we do not want the camera to display what is behind the movement edge. but the camera is a relative thing
			// so we can't just limit some sort of x position or such.
			// I'll use the following technique: 
			//   1. calculate were the physical movement edge would be if drawn right now to the canvas
			//   2. if it would be displayed on-screen, offset camera so that it wouldn't be anymore

			var mov_edge_graphics_x = (WorldController.get_movement_edge() * Config.B2D.SCALE) + camera.offset.x;

			// recall that left display edge is 0 for graphics, as (0, 0) is the top-left corner
			if(mov_edge_graphics_x > 0){
				// if movement edge would be displayed
				camera.offset.x -= mov_edge_graphics_x;
			}
		}
		if (camera.offset.y < 0) {
		    camera.offset.y = 0;
		}

		adjust_debug_draw(); // goes last
	};

	


	//*************************************
	var adjust_debug_draw = function(){
		var camera = GraphicsModel.camera;
		TestController.set_debug_offset(camera.offset.x, camera.offset.y);
	};

	var request_bitmap = function(id){
		// if id is invalid, throw meaningful exception?
		var bitmap = new createjs.Bitmap(get_asset(id));
		// more complicated setting for registration position may be needed, depending on the body attached
		if (!(bitmap.image)){
			throw "Error: image wasn't correctly loaded for this bitmap";
		}
		
		bitmap.regX = bitmap.image.width/2;
		bitmap.regY = bitmap.image.height/2;

		return bitmap;
		// TODO research DisplayObject's caching. and maybe incorporate
	};
	
	
	var request_animated = function(id, start_frame){
		// this implementation is temporary
		// until I setup efficient facility for defining spritesheets
		// within GraphicsController

		if(!id || !start_frame){
			if(!id){
				throw "wrong id";
			}else{
				throw "wrong start_frame";
			}
		};

		var sprite = new createjs.Sprite(id, start_frame);

		return sprite;
	};

	
	//converts easeljs origins to box2d origins
	var synchronize_to_physical_bodies = function(){

		var tiles = GraphicsModel.all_physical;

		for(var id in tiles){
			var tile = tiles[id];
			var body = tile.physical_instance.body;
			var tile_pos = trans_xy(body.GetWorldCenter());

			tile.x = tile_pos.x;
			tile.y = tile_pos.y;
		}
	};
	

	var trans_xy = function(position_vector_unscaled){
		// takes position vector with values in meters, translates
		// it to pixel position taking the camera position into account
		var camera = GraphicsModel.camera;

		var x = (position_vector_unscaled.x * Config.B2D.SCALE) + camera.offset.x;
		var y = (position_vector_unscaled.y * Config.B2D.SCALE) + camera.offset.y;

		return {x: x, y: y};	
	};

	var set_reg_position = function(easeljs_obj, offset_x, offset_y){
		// sets registration position of the easeljs object
		// regisration position is the relative point of the object
		// that you move when you set object's x and y coordinats
		// i.e. if reg. position of the player is head, and you set their
		// position to (0, 0), their head will be at (0, 0)
		// currently the registration position is set to the middle of the body
		// to match what box2d does
		// last two arguments are optional and set PIXEL offset from the normal registration
		// position
		
		// this if statement should be temporary
		if(easeljs_obj.image){
			var w = easeljs_obj.image.width;	
			var h = easeljs_obj.image.height;	
		}else{
			var w = easeljs_obj.spriteSheet._frameWidth;
			var h = easeljs_obj.spriteSheet._frameHeight;
		};

		var offset_x = offset_x || 0;
		var offset_y = offset_y || 0;

		easeljs_obj.regX = w/2 + offset_x;
		easeljs_obj.regY = h/2 + offset_y;

	};

	var reg_for_render = function(easeljs_obj, physical_instance){
		// registeres object for rendering within graphics controller
		// if (OPTIONAL!) physical_instance is given, graphics controller will automatically
		// set the easeljs_obj's position to position of that body, each tick.
		// if the type of the physical instance is associated with some renderer
			
		
		if(physical_instance){

			if(physical_instance.body == null){
				// are you trying to do something terrible? such as registering
				// some object that doesn't need graphical representation?
				throw "Physical instance is provided, but it has no body";
			}
			var id = physical_instance.id;
			var type = physical_instance.type;

			if(id == null || type == null){
				throw "Id or type is undefined for this physical instance";
			}

			easeljs_obj.physical_instance = physical_instance;
			GraphicsModel.all_physical[id] = easeljs_obj;

			if(!GraphicsModel.special_render[type]){
				GraphicsModel.special_render[type] = {};
			}

			GraphicsModel.special_render[type][id] = easeljs_obj;
		}


		AddToStage(easeljs_obj);
	};

	var AddToStage = function(element){
		// can be updated later to manage z-index or whatever
		GraphicsModel.stage.addChild(element);
	};
	

	var get_stage = function(){
		return GraphicsModel.stage;
	};
	
	var get_camera = function(){
		return GraphicsModel.camera;
	};
	
	var destroy_graphics_for = function(id){
		/**
		* remove from the stage and destroy graphics instances for the object with the given id
		* this includes removing all references to it.
		* TODO: IMPORTANT!!! if GraphicsController was updated to store more
		* references to some graphics instances, UPDATE this function to reflect changes
		* even a single reference to the object may cause it to stay in memory
		*/
		

		if(GraphicsModel.all_physical[id] != null){
			var graphics_instance = GraphicsModel.all_physical[id];
		}else{
			// if you encounter this exception, maybe implementation changed. 
			// If that's the case, some things need rewriting. This function in
			// prticular. Or maybe there is a bug.
			throw "The graphics object with id " + String(id) + " isn't registered as having physical body";
		}

		if(graphics_instance.physical_instance.type != null){
			var type = graphics_instance.physical_instance.type;

		}else{
			// if you encounter this exception it may mean a bug, or alternatively
			// it may mean that implementation changed and this function needs an update
			throw "Physical instance with id " + String(id) + " doesn't seem to have a type";
		}
		
		// remove from the stage 
		
			/* graphics_instance.removeAllEventListeners(); 
			   could be necessary to remove attached event listeners, but it seems, at least
			   so far, that this stuff is done automatically be easeljs */

			GraphicsModel.stage.removeChild(graphics_instance);

		// remove from all_physical (responsible tracking for body position)
			delete GraphicsModel.all_physical[id];
		// remove from special_render
			delete GraphicsModel.special_render[type][id];
		// TODO: remove camera reference if following this object
			
	};

	return {
		// declare public
		init: init, 
		update: update,
		get_stage: get_stage,
		get_camera: get_camera,
		get_asset: get_asset,
		reg_for_render: reg_for_render,
		set_reg_position: set_reg_position,
		request_bitmap: request_bitmap,
		request_animated: request_animated,
		destroy_graphics_for: destroy_graphics_for,
		follow: follow,
	};
})();

module.exports = GraphicsController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "GraphicsController", 
	include_options: Includes.choices.DEFAULT | Includes.choices.RENDERERS
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],7:[function(require,module,exports){
var HUDController = (function(){

	var init = function(){
		
		include();
		
		HUDModel.score = new createjs.Text();
		GraphicsController.reg_for_render(HUDModel.score);
		HUDModel.health = new createjs.Text();
		GraphicsController.reg_for_render(HUDModel.health);
		HUDModel.score_title = new createjs.Text();
		GraphicsController.reg_for_render(HUDModel.score_title);
		HUDModel.health_title = new createjs.Text();
		GraphicsController.reg_for_render(HUDModel.health_title);

		HUDModel.health_title.text = "Health: ";
		HUDModel.health_title.x = 10;
		HUDModel.health_title.y = 30;
		HUDModel.health.text = "100";
		HUDModel.health.x = 80;
		HUDModel.health.y = 30;
		HUDModel.health.font = "20px Arial";
		HUDModel.health_title.font = "20px Arial";
		HUDModel.health.color = "#ff0000";
		HUDModel.health_title.color = "#ff0000";
		HUDModel.score_title.text = "Score: ";
		HUDModel.score_title.x = 10;
		HUDModel.score_title.y = 10;
		HUDModel.score.text = "0";
		HUDModel.score.x = 80;
		HUDModel.score.y = 10;
		HUDModel.score.font = "20px Arial";
		HUDModel.score_title.font = "20px Arial";
	};
	
	var update = function(){
		var camera = GraphicsController.get_camera();
		var hero = EntityController.get_my_hero();
		
		update_score(WorldController.get_score());
		update_health(hero.hp);
		
	};
	
	var update_score = function(score){
		HUDModel.score.text = parseInt(score);
	};
	
	var update_health = function(health){
		HUDModel.health.text = parseInt(health);
	};
	
	return {
		// declare public
		init: init, 
		update: update,
	};
})();

module.exports = HUDController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "HUDController", 
	include_options: Includes.choices.DEFAULT | Includes.choices.RENDERERS
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":18}],8:[function(require,module,exports){

var IdentificationController = (function(){
	/* Is in charge of giving unique ID's to everything
	 * that wants them
	*/

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

		// create 100 id's
		for(var i = 0; i < 100; i++){
			var id = IdentificationModel.next_id ++;
			IdentificationModel.free_ids.push(id);
			IdentificationModel.id_matching[id] = null;
		}

	};

	var update = function(delta){
		/* is ran each tick from the GameController.update_all */
		// cleanup ids, if too many free ids (like if non-free id's < free id's/10
		
		//TODO: make function to actually be called from the GameController.update_all
		// TODO: loop through all non-free id's, and if any of them reference null,
		// remove (unregister) them;

	};

	var assign_id = function(obj, set_id){
		/**
		* assigns id to the object
		* sets property id on the object given. you can give OPTIONAL parameter
		* set_id which should be a function that takes object and id and assigns
		* id to the object. this can be useful if you want to store id in some unusual
		* place, or perform some extra operations before id is assigned
		*
		* return id assigned
		* IdentificationController will remember that this id has been assigned
		* this object
		*/
		var free = IdentificationModel.free_ids;
		var id;

		// get free id
		if(free.length > 0){
			id = free.pop();
		}else{
			id = IdentificationModel.next_id++;
		}

		// set id on the object. through function if provided
		if(set_id){
			set_id(obj, id);
		}else{
			obj.id = id;
		}

		// associate id with the object obj
		IdentificationModel.id_matching[id] = obj;

		return id
	};

	var get_by_id = function(id){
		/**
		* get object associated with the given id
		*/
		return IdentificationModel.id_matching[id];
	};

	var remove_id = function(id){
		/**
		* mark id as free and no longer assiciate it with any object
		* notice that you yourself is responsible for making sure
		* that object that was associated with this id doesn't think
		* that he is still assigned this is
		*/

		// TODO: make sure that all known places that use ids (PhysicsControllers'
		// contact listener for example) are notified that id had been unregistered
		delete IdentificationModel.id_matching[id];
		IdentificationModel.free_ids.push(id);
	};
	
	var assign_type = function(obj, type){
		/**
		* assigns wanted type (string) to the given
		* model definition
		* if you try to assign same type twice, throws exception;
		* Id...Controller allows you to retrieve model
		*/

		var types = IdentificationModel.types;
		if(types[type]){
			throw "Error: type " + type + " is already registered. " +
				"You can't register the same type twice";
		}else{
			types[type] = obj;
			obj.prototype.type = type;
		}
		
	};
	
	var get_by_type = function(type){
		/**
		* gets object by it's type
		*/
		var types = IdentificationModel.types;
		if(types[type]){
			return types[type];
		}else{
			throw "Error: type " + type + " wasn't defined yet";
		}
	};
	
	
	
	
	return {
		// declare public
		init: init, 
		update: update,
		assign_id: assign_id,
		get_by_id: get_by_id,
		remove_id: remove_id,
		assign_type: assign_type,
		get_by_type: get_by_type,
	};
})();

module.exports = IdentificationController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "IdentificationController", 
	include_options: Includes.choices.OWN_MODEL
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],9:[function(require,module,exports){
var InitController = (function(){
	// why do you want to put initialization of everything into the InitController?
	// Because if initialization of smth depends on initialization of smth else,
	// it's easier to control here
	//
	// e.g. if you try to do var foo = $('#foo'); somewhere in other module,
	// you can get foo = null; as code of that module can execute before the html document
	// was fully loaded, but >InitController.init< is called after document was loaded, so
	// -1 potential problem. Btw, at this moment in time the the stuff is set to work that way
	// using html (<body onload=...); maybe using JS would be better? Idk;
		

	var init = function(mode){
		include();

		enable_arrowkey_scroll(false);
		setup_screen();
		setup_events();

		init_all_modules(mode); // call .init function of everyone. e.g. PlayerController.init(); etc.

		
		// Notice that asset dependent stuff doesn't (and mustn't) start until
		// all assets are completely loaded. That includes ticker, i.e. no ticks are processed
		// until everything is loaded. If you want something different, e.g. display some sort of loading
		// animation - let me know.
		// Look into the setup_asset_dependent function
			AssetModel.loader = new createjs.LoadQueue(false); // loading resourses using preload.js
			AssetModel.loader.addEventListener("complete", setup_asset_dependant);

		// if more stuff needs to be done for the test mode, 
		// or more types of it needs to be added
		// you can safely make the following a separate function
			var asset_path = (mode == "test") ? "./assets/art/" : "../GameCode/assets/art/";

		AssetController.init(asset_path);

	};

	var init_all_modules = function(mode){
		// TODO: better way to do stuff like that (call certain function
		// of every module in the order. 
		// Also, init and update functions of each module should probably
		// accept some argument. I think to make this argument an object,
		// this way we can add more things to be passed w/o any problem and
		// we won't need to change anything
		
		B2d.init(); // goes first
		IdentificationController.init();
		RegisterAsController.init();

		//AssetController.init(); // called from the InitController.init// stuff has to change
		GameController.init();
		KeyboardController.init();
		PhysicsController.init();

		TestController.init(mode);
		

		//PlayerController.init();
		TerrainController.init();
		TerrainSliceController.init();
		WorldController.init();

		// WARNING!!! GraphicsController.init is called from the
		// setup_asset_dependent function as it, well, depends on assets being loaded

	};


	var enable_arrowkey_scroll = function(enable_scroll){
		if(enable_scroll == false){                                                          
			document.addEventListener('keydown', function(e){ // .getElementById("display_canvas")
				arrows = [37, 38, 39, 40];                                          
				if(arrows.indexOf(e.keyCode) > -1){                                 
					e.preventDefault();                                             
					return false;                                                   
				}else{                                                              
					return true                                                     
				}                                                                   
			})                                                                      
		}		
	};
	
	var setup_screen = function(){

		// Setting up other stuff:
		// e.g setup canvas size
		
		// TODO: allow resizes?

		Config.SCREEN_W = $('#canvas_container').width(); // is dynamically set to pixel width of the containing element

		// possible resizing technique: 
		// http://www.fabiobiondi.com/blog/2012/08/createjs-and-html5-canvas-resize-fullscreen-and-liquid-layouts/

		
		//$('#debug_canvas').width(String(SCREEN_W) + "px");
		//$('#display_canvas').width(String(SCREEN_W) + "px");

		//$('#debug_canvas').height(String(SCREEN_H) + "px");
		//$('#display_canvas').height(String(SCREEN_H) + "px");
		
	};

	var setup_ticker = function(){

		createjs.Ticker.setFPS(Config.FPS);

		// ticker: on each tick call GameController.update_all();
		createjs.Ticker.addEventListener("tick", GameController.update_all);

	
	};

	var setup_events = function(){


		// keyboard input event: on each keyboard event call appropriate KeyboardController function
		document.onkeydown = KeyboardController.keydown;
		document.onkeyup = KeyboardController.keyup;

			// on interrupt event: stop/pause ticker ?

	};

	var setup_asset_dependant = function(){
		// this may need to move to either load_game or some sort of resizing function
		
		EntityController.init();
		GraphicsController.init();
		HUDController.init();
		//BackgroundController.init();


		setup_ticker();

		//TerrainController.generate_terrain(); // Initial terrain generation // deprecated, generation will be called from update each tick
	};


	return {
		init: init,
	};
})();

module.exports = InitController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "InitController", 
	include_options: Includes.choices.ALL
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],10:[function(require,module,exports){
var KeyboardController = (function()
{

	var init = function(){
		
		include();
	};
	
	var get_active_commands_function = function(table){
		// get all commands associated with keys that are defined in the >table<,
		// and are currently pressed
		//
		// returns: array of commands
		//
		// TODO: REFACTOR this function to work better and so people do not
		// need to call it each tick. instead they should get reference to function one time
		// and stay updated on the active commands
		
		var commands = [];
		
		$.each(KeyboardModel.translation_tables.code_to_name, function(key, cmd){
			if(KeyboardModel.keys[key] && table[cmd]){
				commands.push(table[cmd]);
			}
		});

		var get_key = function(key){
			if(commands.indexOf(key) > -1){
				return true;
			}else{
				return false
			};
		};

		return get_key;
	};

	// public:
	
	var keydown = function(event){
		KeyboardModel.keys[event.keyCode] = true;
	};

	var keyup = function(event){
		delete KeyboardModel.keys[event.keyCode];
	};


	var movement_commands = function(){
		return get_active_commands_function(KeyboardModel.translation_tables.movement);
	};

	var pause_commands = function () {
	    return get_active_commands_function(KeyboardModel.translation_tables.pause);
	};

	var debug_commands = function(){
		/**
		* commands active in debug mode
		*/
		return get_active_commands_function(KeyboardModel.translation_tables.debug);
	};
	

	return {
		keydown: keydown,
		keyup: keyup,
        pause_commands: pause_commands,
		movement_commands: movement_commands,
		debug_commands: debug_commands,
		init: init,
	};

})();

module.exports = KeyboardController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "KeyboardController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],11:[function(require,module,exports){
// Notes:
// notice that you can reuse body definitions multiple times, it makes sense to have
// collection of body definitions that are commonly use and maybe allow some sort of 
// inheritance (i.e. you can make some definition on top of the another definition)
// // bodies are allowed to have userData on them that is just reference to some object.
// may be useful in some situations
//
// Question:
// does it make sense to allow users to pass any properties as part of object definition
// and just apply those properties automatically to the userData property of body?

var B2dConfig;

var PhysicsController = (function(){

	var init = function(){
		include();

		B2dConfig = Config.B2D;

		PhysicsModel.scale = B2dConfig.SCALE;
		PhysicsModel.step_amount = 1/(B2dConfig.SPS);

		PhysicsModel.gravity = new B2d.b2Vec2(0,30); // earth gravity
		PhysicsModel.world = new B2d.b2World(PhysicsModel.gravity, true);

		init_collision_listener();

	};
	
	var step = function (delta_ms) {
		// !? should I set upper limit on delta to prevent world from
		// fast forwarding if the ticker was paused? or that is not a problem in our case?
		// investigation is needed

		var delta = delta_ms/1000;

		PhysicsModel.timeToCover += delta;

		while (PhysicsModel.timeToCover > PhysicsModel.step_amount) {
			PhysicsModel.timeToCover -= PhysicsModel.step_amount;
			PhysicsModel.world.Step(
				PhysicsModel.step_amount,
				B2dConfig.POSITION_ITR, // velocity iterations
				B2dConfig.VELOCITY_ITR // position iterations
			);
		}
	};  // end step 

	var draw_debug = function(){
		if (B2dConfig.debug_draw) {
			PhysicsModel.world.DrawDebugData();
		}
	};

	var get_parent_chain = function(template, default_def){
		var next = template;
		var ancestors = [];

		while(next != null){
			ancestors.push(next);
			next = next["parent"];
		}

		if(default_def){
			ancestors.push(default_def);
		}

		return ancestors;
		
	};

	var apply_parents = function(template_name, template_collection){
		// TODO: refactor the code so this thing is done only once
		// at the load tim
		// that could probably be done even for other things.
		// idea: store compiled body/fixture etc. together with the
		// template. this way you'll have easy access to the all defined
		// options for debugging;
		
		var default_tmplate = template_collection["default"];

		var chain = get_parent_chain(template_collection[template_name], default_tmplate);

		var final_definition = {};

		for(var i = chain.length - 1; i >= 0 ; i--){
			// may be needed to be made more efficient by moving the other way
			// and not considering options that were already encountered in children
			var current = chain[i];


			for(var prop in current){
				final_definition[prop] = current[prop];
			}
		}

		return final_definition;
	}; // end apply_parents
		
	var target_props = {
		body_def: [
			"active",
			"allowSleep",
			"angle",
			"angularDamping",
			"angularVelocity",
			"awake",
			"bullet",
			"fixedRotation",
			"inertiaScale",
			"linearDamping",
			"linearVelocity",
			"position",
			"type",
			//"userData" // doesn't seem to properly work, doing it differently
		],
		fixture_def: [
			"density",
			//"filter", implement later if needed
			"friction",
			"isSensor",
			"restitution",
			"shape",
			"userData"
		]
	};

	var apply_property_list = function(source, destination, list){
		/**
		 * takes two objects and the list of strings
		 * copies all properties with names found in the list
		 * from source to destination
		 * scips properties which are null/undefined
		 */

		for(var i = 0; i < list.length; i++){
			var prop = list[i];
			if(source[prop] != null){
				destination[prop] = source[prop];
			}
		}

		return destination;
	};

	var PropertyUndefined = function PropertyUndefined(property_name){
		this.name = "PropertyUndefined";
		this.message = "Error: " + property_name + " is not defined";
	};
	PropertyUndefined.prototype = Object.create(Error.prototype);
	PropertyUndefined.prototype.constructor = PropertyUndefined;

	var get_formal_body_def = function(non_formal_def){
		/**
		 * turn non formal definition into the formal one
		 * non-formal definition is an object that contains
		 * properties SOME of which are box2d properties or are 
		 * intended to be transformed into such. E.g. the non-formal
		 * definition may contain properties vx and vy which will be transformed
		 * into the linearVelocity vector in the formal definition
		 */

		var nfdef = non_formal_def;

		var definition = new B2d.b2BodyDef();

		if(nfdef.vx != null && nfdef.vy != null){
			// check for informal parameter specification first
			nfdef.linearVelocity = new B2d.b2Vec2(nfdef.vx, nfdef.vy);
		}else{
			// maybe the linearVelocity was specified directly as vector,
			// and not through informal parameters; checking that, and if not,
			// exception
			if(!(nfdef.linearVelocity)){
				throw new PropertyUndefined("linearVelocity");
			}
		}

		if(nfdef.x != null && nfdef.y != null){
			// same procedure as for the linear velocity
			// checking for informal specification here
			// and if present, turning into the formal
			nfdef.position = new B2d.b2Vec2(nfdef.x, nfdef.y);
		}else{
			// checking if formal was specified directly
			if(!(nfdef.position)){
				// if not, throw custom exception
				throw new PropertyUndefined("position");
			}
		}

		if(nfdef.type){
			nfdef.type = {
				"static": B2d.b2Body.b2_staticBody, 
				"dynamic": B2d.b2Body.b2_dynamicBody,
				"kinematic": B2d.b2Body.b2_kinematicBody
			}[nfdef.type]; // turn string-type into b2d type
		}else{
			throw new PropertyUndefined("type");
		}

		apply_property_list(nfdef, definition, target_props.body_def);

		return definition;

	};

	var get_formal_fixture_def = function(non_formal_def){
		/**
		 * turns non-formal definition into the formal one
		 * see get_fromal_body_def for explanation
		 */

		var nfdef = non_formal_def;
		var shape = nfdef.shape;
		var fixture_def = new B2d.b2FixtureDef();

		apply_property_list(non_formal_def, fixture_def, target_props.fixture_def);

		switch (shape) {
			case "rectangle":

				if(nfdef.width != null && nfdef.height != null){
					fixture_def.shape = new B2d.b2PolygonShape();
					if (nfdef.offset != null){
						var offset = new B2d.b2Vec2(nfdef.offset.x ,nfdef.offset.y);
						fixture_def.shape.SetAsOrientedBox(nfdef.width/2, nfdef.height/2, offset, 0);
					}else{
						fixture_def.shape.SetAsBox(nfdef.width/2, nfdef.height/2);
					}
				}else{
					throw new PropertyUndefined("width or height");
				}
				break;
			case "polygon":

				if(nfdef.points != null){
					fixture_def.shape = new B2d.b2PolygonShape();
					fixture_def.shape.SetAsArray(nfdef.points, nfdef.points.length);
				}else{
					throw new PropertyUndefined("points");
				}
				break;
			case "circle":

				if(nfdef.radius != null){
					fixture_def.shape = new B2d.b2CircleShape(nfdef.radius);
				}else{
					throw new PropertyUndefined("radius");
				}
				break;
			default:
				throw "Error: shape must be one of the following: " + 
					'"polygon", "rectangle", "circle". You specified: ' +
					String(shape);
		}

		return fixture_def;

	};
	

	var get_body = function(non_formal_def, entity_instance){
		/**
		 * takes non-formal definition
		 * returns body based on this definition
		 *
		 */
		if (entity_instance == null){
		throw new PropertyUndefined("entity_instance");
		}
		var definition = get_formal_body_def(non_formal_def);

		var body = PhysicsModel.world.CreateBody(definition);

		//if(body.userData == null){
			//body.userData = {};
		//}

		// append passed definition to the user data of the body
		// for debugging purposes, and also to allow easy specification of 
		// custom parameters during definition. If this will cause confusion,
		// I'll remove that
		//body.userData.def = non_formal_def;
		body.SetUserData({def: non_formal_def, entity_instance: entity_instance});
		
		return body;
	
	};

	var attach_fixture = function(body, non_formal_def, fixture_name){
		/**
		 * given b2d body, (non-formal) fixture definition and (OPTIONAL) fixture_name
		 * this function attaches fixture to the body
		 */

		var fixture_def = get_formal_fixture_def(non_formal_def);

		if(fixture_def.userData == null){
			fixture_def.userData = {};
		}

		fixture_def.userData.def = non_formal_def;
		fixture_def.userData.name = fixture_name;
		
		body.CreateFixture(fixture_def);
		
	};

	var attach_sensors = function(body){
		var SENSOR_THICKNESS = 0.1;
		
		// get the width and height of the body's main fixture
		// and create 4 sensor fixtures based on those parameters
		// calculate offset of sensors so that they match the main fixture
		var x = body.GetPosition().x;
		var y = body.GetPosition().y;

		// TODO: change to getting dimentions of main fixture
		var h = body.GetFixtureList().GetAABB().GetExtents().y;
		var w = body.GetFixtureList().GetAABB().GetExtents().x;
		
		//attach top fixture
		var top_sensor = {};
		top_sensor.shape = "rectangle";
		top_sensor.density = 0;
		top_sensor.isSensor = true;
		top_sensor.height = SENSOR_THICKNESS;
		top_sensor.width = (w*2 - SENSOR_THICKNESS*2) - 0.3;
		top_sensor.offset = {x:0, y: (-1*h) + SENSOR_THICKNESS/2};
		attach_fixture(body,top_sensor,"top");
		
		//attach bottom fixture
		var bottom_sensor = top_sensor;
		//bottom_sensor.width += 0.4;
		bottom_sensor.offset = {x:0, y: h - SENSOR_THICKNESS/2};
		attach_fixture(body,bottom_sensor,"bottom");
		
		//attach left fixture
		var left_sensor = top_sensor;
		left_sensor.height = (h*2 - SENSOR_THICKNESS*2) - 0.3;
		left_sensor.width = SENSOR_THICKNESS;
		left_sensor.offset = {x:(-1*w) + SENSOR_THICKNESS/2,y:0};
		attach_fixture(body,left_sensor,"left");
		
		//attach right fixture
		var right_sensor = left_sensor;
		right_sensor.offset = {x:w - SENSOR_THICKNESS/2, y:0};
		attach_fixture(body,right_sensor,"right");
	};
	
	
	

	var get_rectangular = function(def, entity_instance){
		// get appropriate template collection to draw from
		var template_name = entity_instance.type;
		var template_collection = PhysicsModel.r_templates;
		var compiled_template = apply_parents(template_name, template_collection);

		// apply custom override
		var final_def = compiled_template;
		for(var prop in def){
			final_def[prop] = def[prop];
		}

		final_def.shape = "rectangle";

		// final_def contains all final data, about body we are about to create
		// it takes into account template given and all it's parents
		// and also manually specified parameters. However, this definition is raw,
		// i.e. some data in it may not be in its final form, e.g. linear velocity is specified
		// as two parameters, vx and vy, while it whould be converted into the vector
		// for box2d. so final_def is a final description, but not in final form


		var body = get_body(final_def, entity_instance);
		 
		attach_fixture(body, final_def, "main");
		
		//If the object has directional sensors, attach sensors here
		if(final_def.border_sensors){
			attach_sensors(body);
		}

		return body;
	};

	var get_circular = function(def, template){
		var type = "circular";
		// dont' forget about refactoring some stuff into the
		// set_common function
		
		var definition = new B2d.b2BodyDef();
		
	};
		
	var get_polygonal = function(def, template){
		var type = "polygonal";
		
		var definition = new B2d.b2BodyDef();
		
	};

	var set_debug_draw = function(debug_draw){
		PhysicsModel.world.SetDebugDraw(debug_draw);
	};


	
	var listen_for_contact_with = function(what, collision_event_name, custom_function){
		/**
		 * setups custom_function to be called each time the collision event 
		 * occurs and involves >what<
		 * TAKES:
		 * 	>what<
		 * 		string 
		 * 		id of an object ("383") or it's type ("player")
		 * 	>collision_event_name<
		 * 		string. one of:
		 * 		BeginContact, EndContact, PreSolve, PostSolve
		 * 	>custom_function< 
		 * 		function
		 * 		function to be called on one of those events
		 * 		notice that function will be wrapped, so it should
		 * 		accept extra parameter >info< that will contain
		 * 		unpacked information about the collision
		 */


		if(what == null){
			throw new PropertyUndefined("what");
		}

		if(
			collision_event_name != "BeginContact" && collision_event_name != "EndContact" &&
			collision_event_name != "PreSolve" && collision_event_name != "PostSolve" 
		){
			throw "collision_event_name should be one of: PreSolve, PostSolve, EndContact, BeginContact";
		}

		if(custom_function == null || typeof(custom_function) != "function"){
			throw "Property custom_function is not defined or isn't a function"
		}

		var target_function_table = PhysicsModel.awaiting_contact[collision_event_name]; 

		if(target_function_table[what] == null){
			target_function_table[what] = [custom_function];
		}else{
			target_function_table[what].push(custom_function);
		}
		
		
	};
	
	
		
	var init_collision_listener = function(){
		
		/**
		 */
		
		var call_all = function(list, args){
			/**
			 * call all functions in list providing arguments
			 * from the array args
			 * if list give is null/undefined, do nothing
			 */

			if(list != null){
				for(var i = 0; i < list.length; i++){
					list[i].apply(this, args);
				}
			}
		};

		var get_id = function(obj){
			userData = obj.GetUserData();
			if(userData != null && userData.id != null){
				return userData.id;
			}else{
				return "[NO_ID]"
			}
			
		};

		var get_type = function(obj){
			var userData = obj.GetUserData();
			if(userData != null && userData.entity_instance.type != null){
				return userData.entity_instance.type;
			}else{
				return null;
			}
			
		};

		var unpack_contact_info = function(contact, my_type){
			/**
			 * unpacks info about the collision and 
			 * returns it
			 * >my_type< is an type of an object that will
			 * go under the >Me< parameeter inside of info
			 * (As opposed to Them, which is the other object)
			 */
			if(my_type == null){
				// >my_type< isn't supposed to be null/undefined
				throw new PropertyUndefined("my_type");
			}

			var A = {};
			var B = {};

			A.fixture = contact.m_fixtureA;
			B.fixture = contact.m_fixtureB;
			A.body = A.fixture.GetBody();
			B.body = B.fixture.GetBody();

			A.id = get_id(A.body);
			B.id = get_id(B.body);

			//A.entity = IdentificationController.get_by_id(A.id);
			//B.entity = IdentificationController.get_by_id(B.id);
			A.entity = A.body.GetUserData().entity_instance;
			B.entity = B.body.GetUserData().entity_instance;

			A.type = get_type(A.body);
			B.type = get_type(B.body);

			A.fixture_name = get_custom_property(A.fixture, "name");
			B.fixture_name = get_custom_property(B.fixture, "name");

			// TODO: unpack more info if necessary

			var info = {};

			if(A.type == my_type){
				info.Me = A;
				info.Them = B;
			}else{
				info.Me = B;
				info.Them = A;
			}

			return info;
			
		};
		
		var common_contact = function(contact, args, lists){
			// create info, call respective functions for each id. use provided arguments >args<
			// lookup ids in the provided table of lists >lists<
			
			/* next available index in the args array 
			 * it's used to determine at what index the info object should be inserted as*/
			var next_arg_index = args.length; 

			var type1 = get_type(contact.m_fixtureA.GetBody());
			var type2 = get_type(contact.m_fixtureB.GetBody());

			if(type1 != null){
				
				args[next_arg_index] = unpack_contact_info(contact, type1);
				call_all(lists[type1], args);
			}

			if(type2 != null){
				args[next_arg_index] = unpack_contact_info(contact, type2);
				call_all(lists[type2], args);
			}

		};
		
		var PreSolve = function(contact, impulse){
			
			var lists = PhysicsModel.awaiting_contact.PreSolve;

			var args = [contact, impulse];

			common_contact(contact, args, lists);
	
		};
		
		var PostSolve = function(contact, oldManifold){
			var lists = PhysicsModel.awaiting_contact.PostSolve;

			var args = [contact, oldManifold];

			common_contact(contact, args, lists);
		};

		var BeginContact = function(contact){
			var lists = PhysicsModel.awaiting_contact.BeginContact;

			var args = [contact];

			common_contact(contact, args, lists);
		};

		var EndContact = function(contact){
			var lists = PhysicsModel.awaiting_contact.EndContact;

			var args = [contact];

			common_contact(contact, args, lists);
		};
		
		
		
		var listener = new B2d.b2ContactListener;
		listener.PreSolve = PreSolve;
		listener.PostSolve = PostSolve;
		listener.BeginContact = BeginContact;
		listener.EndContact = EndContact;
		
		PhysicsModel.world.SetContactListener(listener);
	
	};

	var get_custom_property = function(b2d_obj, property_name){
		
		/**
		 * given any box2d object that has GetUserData method
		 * this function will return custom property with given
		 * property_name if this property is set on userData of the object
		 * if not, the function returns null
		 */
		var user_data = b2d_obj.GetUserData();
		if(user_data && user_data[property_name]){
			return user_data[property_name];
		}else{
			return null;
		}
	};
	
	var remove_body = function(body){
		/**
		* destroy given body (remove it from world and remove all references Physics has to it)
		*/
		
		// TODO: IMPORTANT!!! update this function if you store extra references
		// to the body within PhysicsModel/Controller.
		// Even a single reference to the body may keep it from being deleted
		// from the memory 
		PhysicsModel.world.DestroyBody(body);
	};
	
	//a very important function that I need for the hyena
	//returns the number of shapes in contact with a given bounding box
	var query_aabb = function(aabb){
		var count = 0;
		PhysicsModel.world.QueryAABB(
		function(max){
			count++;
			return true;
		},
		aabb);
		return count;
	};
	
	
	return {
		get_body: get_body,
		get_rectangular: get_rectangular,
		step: step,
		init: init,
		set_debug_draw: set_debug_draw,
		draw_debug: draw_debug,
		listen_for_contact_with: listen_for_contact_with,
		remove_body: remove_body,
		query_aabb: query_aabb,
	};
})();


module.exports = PhysicsController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "PhysicsController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],12:[function(require,module,exports){

var RegisterAsController = (function(){
	/* Allows you to register object as something,
	 * for other modules to access
	 * One use could be registering newly generated terrain slice from the slice controller,
	 * for the GraphicsController to notice and generate graphics for it
	*/

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements

	};

	var update = function(delta){
		/* is ran each tick from the GameController.update_all */

		// TODO: automatically delete stuff depending on timeout stuff
		// calculate timeout of 
	};

	var register_as = function(what, obj){
		/**
		* simple one time lookup registering of object
		* >what< - string. e.g. "new_terrain_slice"
		* >obj< - object to register
		*/
		
		var table = RegisterAsModel.simple_one_time_lookup;

		if(table[what]){
			table[what].push(obj);
		}else{
			table[what] = [obj];
		}
	};

	var retrieve_registered_as = function(what){
		/**
		* returns reference to the object contatining
		* things currently registered as >what<
		* you are responsible for popping (or not popping) them
		* from the array to no longer consieder (or continue to consider)
		* them as registered as >what<
		*/
		var list = RegisterAsModel.simple_one_time_lookup[what];
		if(list){
			return list;
		}else{
			return [];
		}
		
	};
	
	
	return {
		// declare public
		init: init, 
		update: update,
		register_as: register_as,
		retrieve_registered_as: retrieve_registered_as
	};
})();

module.exports = RegisterAsController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "RegisterAsController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],13:[function(require,module,exports){
config = require ("../Config.js");

var TerrainController = (function(){
	/* this will be the physical representation of the terrain
	 * currently it contains graphical bits, but that will change
	 */

	var init = function(){
	    include();
	    TerrainModel.seed = Math.floor(Math.random()*2000) + 1000;//placeholder for seed

	};
	
	
	var update = function(){
		// check for any chunks to be unloaded/deleted will go here, for now
		// maybe it'll check for all players to be sufficiently far to the right
		// of it, maybe one chunk in advance, or smth like that
		//if (config.movement_edge.x > x)
		while(TerrainModel.terrain_slices_queue.length < 4){
			var slice = NewTerrainSlice();
			TerrainModel.terrain_slices_queue.push(slice);
		}

		var cmds = KeyboardController.debug_commands();

		if(cmds("new_slice")){
			
			var slice = NewTerrainSlice();
			TerrainModel.terrain_slices_queue.push(slice);
		}

		if(WorldController.get_movement_edge() > (TerrainModel.terrain_slices_queue.length-3)*(20)){
			var slice = NewTerrainSlice(TerrainModel.seed);
			TerrainModel.terrain_slices_queue.push(slice);
			TerrainModel.seed = (((TerrainModel.seed) * (TerrainModel.seed) - TerrainModel.seed / 2)) % 2000 + 1001;
			WorldController.set_spawn();
		};

		check_for_old_slices();
	};


	var NewTerrainSlice = function(seed){
		/* this takes care of appending new terrain slice to the generated terrain
		 * it calculates it's origin x and y positions and whatever other stuff,
		 * generates slice; sets up everything
		 */
		var x_offset = TerrainModel.slice_counter * Config.TerrainSlice.grid_columns;

		TerrainModel.slice_counter++; // TODO: change how it works when truly infinite

		if(TerrainModel.initial_generated < 3){
			TerrainModel.initial_generated++;
			var slice = new TerrainSliceController.generate_initial(x_offset);
		}else{
			var slice = new TerrainSliceController.generate_random(x_offset, seed);
		}

		IdentificationController.assign_id(slice);

		MarkAsNewTerrainSlice(slice); 

		return slice;

	};

	var check_for_old_slices = function(){
		/**
		* check for slices that are too far behind and should be removed
		*/

		var tqueue = TerrainModel.terrain_slices_queue;
		var cut_off_index = 0; // what amnt of slices should go off the queue

		// find the old slices and handle their deletion
		for(var i = 0; i < tqueue.length; i++){
			var slice = tqueue[i];
			var slice_end_x = slice.origin.x + slice.grid_columns * slice.cell_w;

			if(slice_end_x < WorldController.get_movement_edge){
				// if slice is unreachable, delete it 
				cut_off_index++;
				delete_slice(slice);
			}
		}

		// now remove all found old slices from the queue
		if(cut_off_index > 0){
			TerrainModel.terrain_slices_queue = tqueue.slice(cut_off_index);
		}
	};
	
	

	var delete_slice = function(slice){
		/**
		* assumes that slice will be popped from the terrain slice queue elsewhere
		* (or was already)
		* otherwise the slice won't be properly deleted
		*/
			
		console.log("deleting slice with origin", slice.origin);
		
		var grid = slice.grid;
		
		for(var i = 0; i < grid.length; i++){
			var row = grid[i];
			for(var j = 0; j < row.length; j++){
				var cell = row[j];
				if(cell.kind != 0){
					PhysicsController.remove_body(cell.body);
					IdentificationController.remove_id(cell.id);
				}
			}
		}

		
		// For graphics to pick up and delete unneeded graphics
		RegisterAsController.register_as("removed_slice", slice);

		// free the id (yes, terrain slice has id id
		IdentificationController.remove_id(slice.id);
	};
	
	

	
	var for_each_tile = function(f){
		// takes function >f< that takes three parameters: tile (easeljs object),
		// terrain_lvl (int), and tile_index (int)
		// calls this function for every tile of the terrain
		
		var queues = TerrainModel.terrain_queues;

		$.each(queues, function(terrain_lvl){
			$.each(queues[terrain_lvl], function(tile_index){
				f(queues[terrain_lvl][tile_index], terrain_lvl, tile_index);
			});
		});

	};

	
	var MarkAsNewTerrainSlice = function(slice){
		//TerrainModel.new_slices.push(slice);
		RegisterAsController.register_as("awaiting_graphics_initialization", slice);
	};

	//var NewSlicesAvailable = function(){
		//return (TerrainModel.new_slices.length > 0);
	//};

	//var GetNewTerrainSlices = function(){
		//return TerrainModel.new_slices;
	//};

	return {
		update: update,
		init: init,
		NewTerrainSlice: NewTerrainSlice,
		MarkAsNewTerrainSlice: MarkAsNewTerrainSlice,
		//NewSlicesAvailable: NewSlicesAvailable,
		//GetNewTerrainSlices: GetNewTerrainSlices,
	}
})();

module.exports = TerrainController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TerrainController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Config.js":2,"../Includes.js":18}],14:[function(require,module,exports){

var TerrainSliceController = (function () {

	var init = function(){
		/* is ran from the InitController once when the game is loaded */
		include(); // satisfy requirements
		IdentificationController.assign_type(TerrainSliceModel.Cell, "terrain_cell");
		IdentificationController.assign_type(TerrainSliceModel.Slice, "terrain_slice");

	};

	var update = function(slice){
		

	};

	var get_next_origin = function(){
	};
	

	
	var spawnBlock = function(x, y, kind){
		//spawn instance of this entity at the given coordinates
		var block = new TerrainSliceModel.Cell(kind%3); //kind is an int, 1 = block, 2 = platform
		IdentificationController.assign_id(block); //eventually we may want to remove this for the sake of efficiency
		block.body = PhysicsController.get_rectangular({x: x, y: y}, block);
		return block;
	};
	
	var spawnSpike = function(x, y){
		//spawn instance of this entity at the given coordinates
		var spike = new TerrainSliceModel.Cell(3); //kind = 3 means spikes
		spike.can_attack = true;
		spike.damage = 4;
		IdentificationController.assign_id(spike); //eventually we may want to remove this for the sake of efficiency
		spike.body = PhysicsController.get_rectangular({x: x, y: y}, spike);
		return spike;
	};
	
	var spawnGap = function(x,y){
		// 0 will be the id for the "air" i.e. nothing
		var gap;
		gap = new TerrainSliceModel.Cell(0);
		//IdentificationController.assign_id(gap); // DO NOT ASSIGN IDS TO EMPTY SPACES
		return gap;
	};
	
	var getRandomNumber = function (seed) {
		return (seed*seed)%2000 + 1000;
	};
	
	var buildTerrainSlice_00 = function(slice,seed){
	
	    //set variables
	    //console.log(seed);
	    var seed = seed;
		var rows = slice.grid_rows;
		var columns = slice.grid_columns;
		var i,j;
		var ground_lvl = rows - 3; //the row that is considered ground level.
		var vgap_min = 7;
		var vgap_len = 0;
		var hgap_min = 10;				//minimum size of gaps between platforms
		var hgap_len = 0; 		//current number of consecutive horizontal gaps
		var pit_max = 8;				//maximum len of pits in blocks
		var pit_len = 0; 		//current number of consecutive pits
		var has_pit = [];
		var pit_frequency = 6; 		//base percentage chance of a pit being dug
		var platform_len_max = 7;	//maximum len of a platform
		var platform_len_min = 3; //minimum len of a platform
		var platform_len = 0; 		//len of currently generated platform
		var platform_count_max = 2; //maximum number of platforms per column
		var platform_count = []; 		//keeps track of platforms per column
		var platform_frequency = 10;//base percentage chance of a platform to be generated
		var spike_frequency = 5;//base percentage chance of a platform to have spikes
		/*
		var spike frequency
		var column frequency
		etc.
		*/
		for(i=0; i<=columns;i++){
			platform_count[i] = 0;
			has_pit[i] = false;
		}

		//build the stage from the bottom up
		/*
		Build Stage from bottom up, left to right
		load blocks and gaps into slice.grid[i][j]
		
		*/
		for(i=rows - 1;i>=0;i--){ //outer loop: generate rows bottom to top
			slice.grid[i] = [];
			if (vgap_len < vgap_min){
				vgap_len++;
			}
			if (seed % 10 == 0) {
			    seed += i;
			}
			for(j=0;j<columns;j++){ //inner loop: generate from left to right within current row
				var x = slice.origin.x + j * slice.cell_w + slice.cell_w/2;
				var y = slice.origin.y + i * slice.cell_w + slice.cell_w/2;
				
				if (i >= ground_lvl){	//If on or below ground level, Generate Ground
				    if (pit_len < pit_max && (getRandomNumber(seed) % i < pit_frequency || pit_len != 0) || has_pit[j]) {
						slice.grid[i][j] = spawnGap(x,y); //create gap
						has_pit[j] = true;
						pit_len++; //the pit gets wider
						seed = getRandomNumber(seed) + 71;
					}
					else{
						slice.grid[i][j] = spawnBlock(x,y,1);//create a ground block (1 means ground)
						pit_len = 0; //any pits being spawned have been interrupted
						if (i == ground_lvl)
							slice.grid[i][j].position = "surface";
						else{
						slice.grid[i][j].position = "underground";
						}
					}
				}else{ //ElSE Generate Platforms
					if((hgap_len >= hgap_min || platform_len > 0) //if there is a large gap or a platform being built
					&& (platform_len < platform_len_max) // and any platform being built is less than max len
					&& (platform_count[j] < platform_count_max) // and the current column's platform limit has not been met
					&& (vgap_len >= vgap_min) //if the vertical gap minimum has been met
					&& (platform_len > 0 || (j<columns-1 && platform_count[j+1] < platform_count_max))){ //and the platform is not going to be a singleton
						if (getRandomNumber(seed)%100 < platform_frequency || (platform_len > 0 && platform_len <= platform_len_min)){
						
							slice.grid[i][j] = spawnBlock(x,y,2);//create platform (2 means platform)
							
							if(getRandomNumber(seed)%200 < spike_frequency){
							    slice.grid[i + 1][j] = spawnSpike(x, y - slice.cell_w);
							    seed = getRandomNumber(seed) + 21;
							}
							
							//check aesthetic stuff, like platform edges
							if (platform_len == 0){
								slice.grid[i][j].position = "left";
							}
							else{
								slice.grid[i][j].position = "right";
							}
							if (j>0){if (slice.grid[i][j-1].kind != 0){
								if (slice.grid[i][j-1].position != "left"){
									slice.grid[i][j-1].position = "middle";
								}
							}}
							
							seed = getRandomNumber(seed);
							platform_len++;	//platform gets longer, and 
							platform_count[j]++;//the number of platforms in the current column increases
							hgap_len = 0; 		//reset the gap counter to 0
						}else{
							if (slice.grid[i][j] == null){
								slice.grid[i][j] = spawnGap(x,y); //create a gap
								platform_len = 0; //if there was a platform, it has been interrupted
								hgap_len++; //the gap gets wider
							}
						}
					}else{
						if (slice.grid[i][j] == null){
							slice.grid[i][j] = spawnGap(x,y); //create a gap
							platform_len = 0; //if there was a platform, it has been interrupted
							hgap_len++; //the gap gets wider
						}
					}

					seed = getRandomNumber(seed);
				}
			}
			vgap_len = vgap_len%vgap_min;
		}
		return slice;
	};
	
	//pregenerated slice
	var buildTerrainSlice_01 = function(slice,seed){
		//set variables
		var rows = slice.grid_rows;
		var columns = slice.grid_columns;
		var i,j;
		var ground_lvl = rows - 3; //the row that is considered ground level.
		var vgap_min = 7;
		var vgap_len = 0;
		var hgap_min = 10;				//minimum size of gaps between platforms
		var hgap_len = 0; 		//current number of consecutive horizontal gaps
		var pit_max = 20;				//maximum len of pits in blocks
		var pit_len = 0; 		//current number of consecutive pits
		var has_pit = [];
		var pit_frequency = 0; 		//base percentage chance of a pit being dug
		var platform_len_max = 7;	//maximum len of a platform
		var platform_len_min = 3; //minimum len of a platform
		var platform_len = 0; 		//len of currently generated platform
		var platform_count_max = 2; //maximum number of platforms per column
		var platform_count = []; 		//keeps track of platforms per column
		var platform_frequency = 5;//base percentage chance of a platform to be generated
		for(i=0; i<=columns;i++){
			platform_count[i] = 0;
			has_pit[i] = false;
		}
		for(i=rows - 1;i>=0;i--){ //outer loop: generate rows bottom to top
			slice.grid[i] = [];
			for(j=0;j<columns;j++){ //inner loop: generate from left to right within current row
				var x = slice.origin.x + j * slice.cell_w + slice.cell_w/2;
				var y = slice.origin.y + i * slice.cell_w + slice.cell_w/2;
				if (i >= ground_lvl){	//If on or below ground level, Generate Ground
					slice.grid[i][j] = spawnBlock(x,y,1);//create a ground block (1 means ground)
					if (i == ground_lvl)
						slice.grid[i][j].position = "surface";
					else{
					slice.grid[i][j].position = "underground";
					}
				}else{
					slice.grid[i][j] = spawnGap(x,y);
				}
			}
		}
		return slice;
	};
	
	var generate_initial = function(x_offset){
		var slice = new TerrainSliceModel.Slice();
		slice.origin.x = x_offset;
		slice.origin.y = 0;
		slice = buildTerrainSlice_01(slice);
		
		return slice;
	}
	
	var generate_random = function(x_offset, seed){
		var slice = new TerrainSliceModel.Slice();
		slice.origin.x = x_offset;
		slice.origin.y = 0;
		//get a random kind of slice
		if (getRandomNumber(seed)%100 < 95){
			slice = buildTerrainSlice_00(slice,seed);
		}else{
			slice = buildTerrainSlice_01(slice,seed);
		}
		
		return slice;
	};
	




	return {
		// declare public
		init: init, 
		update: update,
		generate_initial: generate_initial,
		generate_random: generate_random,
	};
})();

module.exports = TerrainSliceController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TerrainSliceController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],15:[function(require,module,exports){
var TestController = (function(){
	// placeholder for implementing testing
	// may be changed/removed/upgraded depending on how we will handle our tests
	
	
	var preinit_tests = function(){
	//For tests requiring run before init is called
	
	
	};
	
	
	var test = function(){
		// if you need some sort of tests launched, this is one of the places to do it
		QUnit.test( "hello test", function( assert ) {
			assert.ok( 1 == "1", "Passed!" );
		});
		Includes.automated_tests();
	};

	var post_loading_tests = function(){
		// TODO: call when loading assets is completed if there are some tests that need
		// to be done at that moment. (Refer to InitController.init and 
		// InitController.setup_asset_dependent methods
	};

	var testMode;

	var init = function(mode){
		include();
		// Sets up the debug canvas during testing
		TestModel.d_canvas = document.getElementById(Config.DEBUG_CANVAS_NAME);
		testMode = mode;

		if(mode == "test"){
			TestModel.context = TestModel.d_canvas.getContext("2d");
			
			TestModel.debugDraw = new B2d.b2DebugDraw();
			TestModel.debugDraw.SetSprite(TestModel.context);
			TestModel.debugDraw.SetDrawScale(Config.B2D.SCALE);
			TestModel.debugDraw.SetFillAlpha(0.3);
			TestModel.debugDraw.SetLineThickness(1.0);
			TestModel.debugDraw.SetFlags(B2d.b2DebugDraw.e_shapeBit | B2d.b2DebugDraw.e_jointBit);

			PhysicsController.set_debug_draw(TestModel.debugDraw);

			Config.B2D.debug_draw = true;
			// Screen_W was setup only after this was called

			TestModel.d_canvas.width = Config.SCREEN_W;
			TestModel.d_canvas.height = Config.SCREEN_H;

			//$('#'+Config.DEBUG_CANVAS_NAME).show();

		}else{
			//d_canvas.hide();
		}
	};
	
	//this function sets the x and y offsets of the debug canvas
	var set_debug_offset = function(x_offset, y_offset){
	    if (testMode == "test"){
	        context = TestModel.context;
	        context.save();
	        context.clearRect(0, 0, Config.SCREEN_W, Config.SCREEN_H);
	        context.translate(x_offset, y_offset);
	        PhysicsController.draw_debug();
	        context.restore();
	    }
	};

	return {
		init: init, 
		test: test,
		post_loading_tests: post_loading_tests,
		preinit_tests: preinit_tests,
		set_debug_offset: set_debug_offset
	}
})();

module.exports = TestController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TestController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],16:[function(require,module,exports){
	
var WorldController = (function(){
	/* all the physics control of the whole world
	*/
    var movement_edge;
    var spawn_enemy;
    var difficulty;
		var season;
		var movement_edge_buffer;
		var body_test;
		var score;
		var progress;
	//var temp = 0;

	var init = function(){
		/* is ran from the InitController once when the game is loaded */

		include(); // satisfy requirements
		movement_edge_buffer = 20;
		movement_edge = 0;
		season = 0;
		score = 0;
		progress = 20;
		//body_test = new platform();
		//var id = IdentificationController.assign_id(body_test);
		//var body_test = PhysicsController.get_rectangular({}, body_test);

	};

	var update = function(delta){
		/* is ran each tick from the GameController.update_all */
		PhysicsController.step(delta);
		update_progress();
		movement_edge = (progress - movement_edge_buffer);
		get_spawn();
		//if(temp++ == 0){
			//TerrainController.NewTerrainSlice();
		//}

	};
	
	var update_progress = function(){
		var heroes = EntityController.get_all_heroes();
		var min_x = Infinity;
		for(var net_id in heroes){
			// iterate through all connected heroes
			// and choose minimum of their x positions
			var hero_x = heroes[net_id].body.GetWorldCenter().x;
			if(hero_x < min_x){
				min_x = hero_x;
			}
		}

		if(progress < hero_x ){
			progress = hero_x;
		}
	};
	
	var get_movement_edge = function(){
		return movement_edge;
	}

	var get_spawn = function () {
	    difficulty = Math.floor(get_movement_edge() / 100);

	    var spawn_num;
	    if (spawn_enemy) {
	        for (i = 0; i < Math.floor(Math.random() * 4) ; i++) {
	            spawn_num = Math.floor(Math.random() * 1000);
	            // demonstration purposes for hyena
	            if (spawn_num <= 5 * difficulty) {
	                var new_hyena = EntityController.spawn(60 + get_movement_edge(), 10, "Hyena");
	            }
	            /*    // demonstration purposes for griffin
	            else if (spawn_num <= 15 * EntityModel.difficulty && Count > 5) {
	                var new_griffin = spawn(60 + WorldController.get_movement_edge() + i, -20, "Griffin");
	                Count = 0;
	            }*/
	            else if (spawn_num <= 15 * difficulty) {
	                var new_griffin = EntityController.spawn(60 + get_movement_edge(), 10, "Griffin");
	            }
	                // demonstration purposes for ant
	            else {
	                var new_ant = EntityController.spawn(get_movement_edge() + 60, 10, "ant");
	            }
	        }
	        spawn_enemy = false;
	    }
	    return spawn_num;
	}

	var set_spawn = function () {
	    spawn_enemy = true;
	}
	
	var get_season = function(){
		return season;
	}
	
	var set_season = function(index){
		season = index;
	}
	
	var MarkAsNewTerrainSlice = function(slice){
		
	};
	
	var get_progress = function(){
		return progress;
	};
	
	var increase_progress = function(amount){
		progress += amount;
	};
	
	var get_score = function(){
		return score;
	};
	
	var increase_score = function(amount){
		score += amount;
	};

	return {
		// declare public
		init: init, 
		update: update,
		get_movement_edge: get_movement_edge,
		get_season: get_season,
		set_season: set_season,
		get_spawn: get_spawn,
		set_spawn: set_spawn,
		increase_score: increase_score,
		increase_progress: increase_progress,
		get_score: get_score,
		get_progress: get_progress,
	};
})();

module.exports = WorldController;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "WorldController", 
	include_options: Includes.choices.DEFAULT
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],17:[function(require,module,exports){
var GameUtility = (function()
{
  function arrow_key_scrolling(flag) {
    // Configures arrow key scrolling for canvas
    if (flag == false) {
      document.addEventListener('keydown', function (e) { // .getElementById("display_canvas")
        arrows = [37, 38, 39, 40];
        if (arrows.indexOf(e.keyCode) > -1) {
          e.preventDefault();
          return false;
        } else {
          return true
        }
      })
    }
  }

	var lg = function()
	{
		/*
		 * shortcut to console.log()
		 * prints all arguments to console
		 * first argument is used as a label for the rest
		 *
		 * each labeled group is enclosed into the colored delimiters
		 * >>> and <<< so it's easily distinguished. I found it helpful,
		 * if you don't let me know, or use something else
		 */
		console.log("%s %c %s", arguments[0], "background: #DAF2B1", ">>>");
		
		for(var i = 1; i < arguments.length; i++)
		{
			console.log("\t", arguments[i]);
		}
		console.log("%c<<<", "background: #DAF2B1");

	};

	var random_choice = function(probabilities, choices){
		/*
		   takes 2 arrays with elements at corresponding indexes
		   being choice and it's probability. picks random one.
		   choices are anything, probability is integer a, such that
		   probability of a choice is a/10. with a < 10, of course
		   and probabilities adding up to 10. 
		   Yes, it's not very good implementation (read: terrible), 
		   and since you noticed, now it's your job to improve it.

		*/

		// array with choices duplicated a proper amount of times based on
		// their probability
		var blah = []; 

		for(var i = 0; i < choices.length; i++){
			for(var j = 0; j < probabilities[i]; j++){
				blah.push(choices[i]);
			}
		}

		var rand_index = Math.floor(Math.random() * blah.length);

		return blah[rand_index];
	};

	

	return {
		lg: lg,
		random_choice: random_choice
	};

})();

module.exports = GameUtility;

},{}],18:[function(require,module,exports){
var Include = function(){

	var modules;

	// simple enumerator // option codes MUST be power of 2 or sum of other options (with 0 being the only exception), and unique
	var choices = (function(){
		// simple options: numberic value must be 0 or some power of 2, name should be all caps and unique
		var result = {NONE: 0, ALL_CONTROLLERS: 1, ALL_MODELS: 2, OWN_MODEL: 4, OTHER_STUFF: 8, RENDERERS: 16, LOGIC: 32};

		// complex options: should consist of simple options, bitwise(!) OR'ed or AND'ed together in any fashion
		result.DEFAULT = (result.ALL_CONTROLLERS | result.OWN_MODEL | result.OTHER_STUFF);
		result.ALL =  (result.ALL_CONTROLLERS | result.ALL_MODELS | result.OTHER_STUFF); 
		result.RENDERER_SPECIFIC = (result.ALL_CONTROLLERS | result.OTHER_STUFF);
		result.LOGIC_SPECIFIC = (result.ALL_CONTROLLERS | result.OTHER_STUFF);

		// object is immutable
		return Object.freeze(result);
	})();

	var module_names = {
		Controllers: [
			"AssetController",
			"EntityController",
			"GameController",
			"GraphicsController",
			"InitController",
			"KeyboardController",
			"PhysicsController",
			"TerrainController",
			"TerrainSliceController",
			"TestController",
			"WorldController",
			"IdentificationController",
			"RegisterAsController",
			"HUDController",
		],

		Models: [
		
			"AssetModel",
			"GameModel",
			"GraphicsModel",
			"KeyboardModel",
			"PhysicsModel",
			"TerrainModel",
			"TerrainSliceModel",
			"TestModel",
			"WorldModel",
			"EntityModel",
			"RegisterAsModel",
			"HUDModel",
		],

		Other: [
		
			"B2d",
			"Box2D",
			"Config",
			"GameUtility",
		],

		Renderers: [
			"AntRenderer",
			"HeroRenderer",
			"TerrainCellRenderer",
			"GriffinRenderer",
			"HyenaRenderer",
			"TerrainSliceRenderer",
			"BackgroundRenderer",

		],

		Logic: [
			"AntLogic",
			"HeroLogic",
			"GriffinLogic",
			"HyenaLogic",
		],

	};//end module_names


	var init = function(){

		modules = {
			AssetController: require("./Controllers/AssetController.js"),
			GraphicsController: require("./Controllers/GraphicsController.js"),
			KeyboardController: require("./Controllers/KeyboardController.js"),
			PhysicsController: require("./Controllers/PhysicsController.js"),
			TerrainController: require("./Controllers/TerrainController.js"),
			TerrainSliceController: require("./Controllers/TerrainSliceController.js"),
			WorldController: require("./Controllers/WorldController.js"),
			InitController: require("./Controllers/InitController.js"),
			TestController: require("./Controllers/TestController.js"),
			GameController: require("./Controllers/GameController.js"),
			EntityController: require("./Controllers/EntityController.js"),
			IdentificationController: require("./Controllers/IdentificationController.js"),
			RegisterAsController: require("./Controllers/RegisterAsController.js"),
			HUDController: require("./Controllers/HUDController.js"),
			
			
			// Models

			GameModel: require("./Models/GameModel.js"),
			TerrainSliceModel: require("./Models/TerrainSliceModel.js"),
			AssetModel: require("./Models/AssetModel.js"),
			PhysicsModel: require("./Models/PhysicsModel.js"),
			GraphicsModel: require("./Models/GraphicsModel.js"),
			TerrainModel: require("./Models/TerrainModel.js"),
			WorldModel: require("./Models/WorldModel.js"),
			KeyboardModel: require("./Models/KeyboardModel.js"),
			TestModel: require("./Models/TestModel.js"),
			IdentificationModel: require("./Models/IdentificationModel.js"),
			EntityModel: require("./Models/EntityModel.js"),
			RegisterAsModel: require("./Models/RegisterAsModel.js"),
			HUDModel: require("./Models/HUDModel.js"),
			
				
			// Other stuff
			
			Config: require("./Config.js"),
			GameUtility: require("./GameUtility.js"),
			B2d: require("./B2d.js"),
			Box2D: require("box2dweb"),
			
			// Renderers
			
			AntRenderer: require("./Renderers/AntRenderer.js"),
			GriffinRenderer: require("./Renderers/GriffinRenderer.js"),
			HyenaRenderer: require("./Renderers/HyenaRenderer.js"),
			HeroRenderer: require("./Renderers/HeroRenderer.js"),
			TerrainCellRenderer: require("./Renderers/TerrainCellRenderer.js"),
			TerrainSliceRenderer: require("./Renderers/TerrainSliceRenderer.js"),
			BackgroundRenderer: require("./Renderers/BackgroundRenderer.js"),
			
			
			
			
			
			// Logic
			AntLogic: require("./Logic/AntLogic.js"),
			GriffinLogic: require("./Logic/GriffinLogic.js"),
			HyenaLogic: require("./Logic/HyenaLogic.js"),
			HeroLogic: require("./Logic/HeroLogic.js"),
			
			

		};

	}; // end init

	var option_is_set = function(what_mods_selected, options){
		if(what_mods_selected == 0 && options == 0){
			return true;
		}
		// be mindful of bitwise operator ahead
		return (what_mods_selected & options);
	};//end option_is_set

	var get_module = function(name){
		// can be modified to throw object error instead of simple one
		// in that case it may contain list of defined modules
		// may also be modified to check whether module is missing from 
		// module_names, modules, or both, and give more accurate description
		var message = "Module " + name + 
			" is undefined. Note that you must hardcode all new modules" + 
			" into the Includes.module_names AND Includes.modules."
		
		if(modules){
			if(modules[name]){
				return modules[name];
			}else if(console.warn){ // check if console.warn is available
				console.warn(message);
			}else{
				throw message;
			}
		}else{
			throw "Error: You must run the Includes.init() before you can use any modules";
		}
	};//end get_module
	

	var get_names = function(current_module_name, options_code){
		var result = {Models: [], Controllers: [], Other: [], Renderers: [], Logic: [],};

		if(option_is_set(choices.NONE, options_code)){
			return result;
		}

		if (option_is_set(choices.ALL_CONTROLLERS, options_code)){

			var controller_names = module_names.Controllers;

			for(var i = 0; i < controller_names.length; i++){

				var ctl_name = controller_names[i];

				if(ctl_name != current_module_name){
					result.Controllers.push(ctl_name);
				}
			}
			
		}

		if (option_is_set(choices.ALL_MODELS, options_code)){
			result.Models = module_names.Models;
		}else if(option_is_set(choices.OWN_MODEL, options_code)){
			var own_model = current_module_name.replace("Controller", "Model");
			result.Models.push(own_model);
		}

		if(option_is_set(choices.OTHER_STUFF, options_code)){
			result.Other = module_names.Other;
		}

		if(option_is_set(choices.RENDERERS, options_code)){
			result.Renderers = module_names.Renderers;
		}

		if(option_is_set(choices.LOGIC, options_code)){
			result.Logic = module_names.Logic;
		}

		return result;
	};//end get_names

	var sections = ["Models", "Controllers", "Other", "Renderers", "Logic"];
	var get_name_statements = function(names){
		var result = "";
		for(var section_index = 0; section_index < sections.length; section_index++){
			var section = sections[section_index];
			for(var i = 0; i < names[section].length; i++){
				result += ("var " + names[section][i] + "; ");
			}
		}

		return result;
		
	};//end get_name_statements

	var get_module_statements = function(names){
		var result = "";
		for(var section_index = 0; section_index < sections.length; section_index++){
			var section = sections[section_index];
			for(var i = 0; i < names[section].length; i++){
				result += (names[section][i] + " = Includes.get_module(\"" + names[section][i] + "\"); ");
			}
		}

		return result;
	};//end get_module_statements

	var get_include_data = function(params){
		var current_module = params.current_module;
		var include_options = params.include_options;
		var names = get_names(current_module, include_options);

		var name_statements = get_name_statements(names);
		var module_statements = get_module_statements(names);

		return {
			imported_modules: names,
			name_statements: name_statements,
			module_statements: module_statements,
		};

	};//end get_include_data

	var automated_tests = function(){
		
		QUnit.test("option matching function", function( assert) {

			//If both are none
			assert.equal(option_is_set(choices.NONE, choices.NONE), true);

			assert.throws(option_is_set(choices.NONE, -1));

			//If both match, it returns the value of choices
			//If they don't match, it returns 0
			
			//MATCH
			assert.equal(option_is_set(choices.ALL_CONTROLLERS, choices.ALL_CONTROLLERS), 1);
			assert.equal(option_is_set(choices.ALL_MODELS, choices.ALL_MODELS), 2);
			assert.equal(option_is_set(choices.OTHER_STUFF, choices.OTHER_STUFF), 8);

			//Mismatch
			assert.equal(option_is_set(choices.NONE, choices.ALL_CONTROLLERS), 0);
			assert.equal(option_is_set(choices.OTHER_STUFF, choices.NONE), 0);
			assert.equal(option_is_set(choices.ALL_MODELS, choices.ALL_CONTROLLERS), 0);
			assert.equal(option_is_set(choices.OWN_MODEL, choices.ALL_MODELS), 0);
		});//end option matching test
		
	};//end automated_tests


	return {
		init: init,
		module_names: module_names,
		get_module: get_module,
		get_include_data: get_include_data,
		choices: choices,
		automated_tests: automated_tests
	};

};

module.exports = new Include;


},{"./B2d.js":1,"./Config.js":2,"./Controllers/AssetController.js":3,"./Controllers/EntityController.js":4,"./Controllers/GameController.js":5,"./Controllers/GraphicsController.js":6,"./Controllers/HUDController.js":7,"./Controllers/IdentificationController.js":8,"./Controllers/InitController.js":9,"./Controllers/KeyboardController.js":10,"./Controllers/PhysicsController.js":11,"./Controllers/RegisterAsController.js":12,"./Controllers/TerrainController.js":13,"./Controllers/TerrainSliceController.js":14,"./Controllers/TestController.js":15,"./Controllers/WorldController.js":16,"./GameUtility.js":17,"./Logic/AntLogic.js":19,"./Logic/GriffinLogic.js":20,"./Logic/HeroLogic.js":21,"./Logic/HyenaLogic.js":22,"./Models/AssetModel.js":23,"./Models/EntityModel.js":24,"./Models/GameModel.js":25,"./Models/GraphicsModel.js":26,"./Models/HUDModel.js":27,"./Models/IdentificationModel.js":28,"./Models/KeyboardModel.js":29,"./Models/PhysicsModel.js":30,"./Models/RegisterAsModel.js":31,"./Models/TerrainModel.js":32,"./Models/TerrainSliceModel.js":33,"./Models/TestModel.js":34,"./Models/WorldModel.js":35,"./Renderers/AntRenderer.js":36,"./Renderers/BackgroundRenderer.js":37,"./Renderers/GriffinRenderer.js":38,"./Renderers/HeroRenderer.js":39,"./Renderers/HyenaRenderer.js":40,"./Renderers/TerrainCellRenderer.js":41,"./Renderers/TerrainSliceRenderer.js":42,"box2dweb":44}],19:[function(require,module,exports){
var AntLogic = (function(){

	var Ant = function(){
		/* Will be instantiated for every created entity to hold all the information 
			about the physical (not graphical) state of the entity in question. 
			declare the properties like this:
			this.some_state_variable_initial_value = 0;
			instantiate (most likely in the spawn function) like that:
			var new_entity_instance = new Ant();
		*/
	

		var entity = EntityController.create_abstract_entity();
		
		entity.hero_hurt_me = false;
		entity.me_hurt_hero = false;
		entity.death_tick = 0;
		entity.hp = 3;
		entity.speed = 3;
		entity.damage = 1;
		entity.point_value = 50;
		entity.can_attack = true;
		entity.aliveflag = true;
		entity.unhurtflag = true;
		entity.start_walking = true;
		entity.pop = 40;
		entity.popup = 0;
		entity.animation = "walk";
		entity.decay_duration = 0;
		
		return entity;
		
		/*
		this.hero_hurt_me = false;
		this.me_hurt_hero = false;
		this.death_tick = 0;

		//set your game logic parameters here
		//this.object_id = 1; //hardcode a unique identifier for each new enemy class
		this.hp = 3;
		this.speed = 3;
		this.damage = 1;
		this.point_value = 50;
		//this.attack_cooldown = 4; //use this for enemies who need
		this.can_attack = true;//use this for enemies who alternate between 
		//this.cooldown_timer=-1;
		this.AI_state = "walk";//use this to keep track of the enemy's AI state
		this.aliveflag = true;
		this.unhurtflag = true;
		this.start_walking = true;
		this.pop = 40;
		this.popup = 0;
		*/
	};

	var init = function(){
		/* Is ran from the EntityController.init once during game loading 
		 	you should assign type to your model here using the identification controller
		 */
		include(); // satisfy requirements, GOES FIRST
		IdentificationController.assign_type(Ant, "ant");
	};

	var spawn = function(x, y){
		/* spawn instance of this entity at the given coordinates
			you will have to create new entity instance, assign it id
			using the IdentificationController.assign_id(entity_instance),
			assign it a body which you can get through PhysicsController
			do any other stuff you want to do during spawning,
			and finally you HAVE TO(!!!) return the instance you just created from this function
		*/

		var new_ant = new Ant();
		new_ant.type = "ant";
		var id = IdentificationController.assign_id(new_ant);

		new_ant.body = PhysicsController.get_rectangular({x: x, y: y, border_sensors: true}, new_ant);	

		return new_ant;

	};

	var tick_AI = function(ant){
		/* Is ran each tick from the EntityController.update for every registered
			entity of this type. I given entity_instance
		*/

	    //if enemy is dead, die
		//if (ant.body.GetWorldCenter().y > 22 || ant.body.GetWorldCenter().x < Config.Player.movement_edge - 1) {
			//EntityController.delete_entity();
			//console.log("drop of death");
		//}
		if (ant.hp == 1) {
			if (ant.hero_hurt_me){
				ant.take_damage();
				ant.die();
			}else{
				ant.popup++;
				if(ant.pop == ant.popup && ant.animation == "upside_down")
				{
					//var Antbody = ant.body;
					//Antbody.ApplyImpulse(new B2d.b2Vec2(10, -20), Antbody.GetWorldCenter());
					ant.jump();
					ant.popup = 0;
					ant.can_attack = true;
					ant.unhurtflag = true;
					ant.start_walking = true;
					ant.change_animation(ant, "walk");
					ant.hp++;
				}
			}
			
		}else if (ant.hp <= 0) {
			ant.die();
		}else { // ant.hp >= 1
			//do maintenance
			ant.direction_previous = ant.direction;				//remember what hyena's direction was at start of tick
			ant.x_previous = ant.body.GetWorldCenter().x
			if (ant.animation == "walk") {
				//var Antbody = ant.body;
				//Antbody.ApplyImpulse(new B2d.b2Vec2(-5,0), Antbody.GetWorldCenter());
				
				if(!ant.path_free() || ant.xprevious == ant.body.GetWorldCenter().x){
					ant.direction = !ant.direction;
				}
				ant.move();
				//var velocity = Antbody.GetLinearVelocity();
				//velocity.x = -ant.speed;
				//Antbody.SetLinearVelocity(velocity); // body.SetLinearVelocity(new b2Vec2(5, 0)); would work too
				//Antbody.SetAwake(true);
				ant.start_walking = false;
				ant.popup = 0;
			}
			
			
			if (ant.can_attack && ant.me_hurt_hero && ant.animation == "walk"){
				// pass
			}
			if (ant.hero_hurt_me)
			{
				ant.take_damage();
				ant.hero_hurt_me = false;
				ant.can_attack = false;
				ant.change_animation(ant, "upside_down");
				
			}
		}
	};


	/*
	var ant.change_animation = function(ant, progress_state) {
		ant.animation = progress_state;

	};
	*/
	// // //Set up Collision handler
	
	
	var begin_contact = function(contact, info){
		//handle collisions here
		
		//console.log(info.Me.id, ":", "My fixture", "'" + info.Me.fixture_name + "'", "came into contact with fixture", 
			//"'" + info.Them.fixture_name + "'", "of", info.Them.id);
		
		var type = info.Me.type;

		if(type !== "ant")
			console.log("Error", type, "instead of ant with other being", info.Them.type);
		
		
		if(info.Them.type == "hero")
		{
			
			if(info.Them.fixture_name != "bottom" && info.Me.entity.can_attack)
			{
				info.Me.entity.me_hurt_hero = true;
				
			}	
			else
			{
				info.Me.entity.hit_taken = true;//take damage if enemy collides from above and distance < vulnerability radius
				info.Me.entity.damage_taken = info.Them.entity.damage;
				info.Me.entity.hero_hurt_me = true;
			}
		}

	};

	var end_contact = function(contact, info) {
	
	};

	
	return {
		// declare public
		init: init, 
		spawn: spawn,
		tick_AI: tick_AI,
		begin_contact: begin_contact,
		end_contact: end_contact,
	};
})();

module.exports = AntLogic;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "AntLogic", 
	include_options: Includes.choices.LOGIC_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":18}],20:[function(require,module,exports){
var GriffinLogic = (function(){
   
	var Griffin = function(){
		/* Will be instantiated for every created entity to hold all the information 
			about the physical (not graphical) state of the entity in question. 
			declare the properties like this:
			this.some_state_variable_initial_value = 0;
			instantiate (most likely in the spawn function) like that:
			var new_entity_instance = new Griffin();
		*/
		this.hero_hurt_me = false;
		this.me_hurt_hero = false;
		this.death_tick = 0;

		//set your game logic parameters here
		//this.object_id = 1; //hardcode a unique identifier for each new enemy class
		this.hp = 3;
		this.speed = 6;
		this.damage = 10;
		this.point_value = 100;
		//this.attack_cooldown = 4; //use this for enemies who need
		this.can_attack = true;//use this for enemies who alternate between 
		//this.cooldown_timer=-1;
		this.AI_state = "fly";//use this to keep track of the enemy's AI state
		this.aliveflag = true;
		this.unhurtflag = true;
		this.needs_graphics_update = false;

		this.direction = false;
		this.fly_force = 100;
	};

	var init = function(){
		/* Is ran from the EntityController.init once during game loading 
		 	you should assign type to your model here using the identification controller
		 */
		include(); // satisfy requirements, GOES FIRST
		IdentificationController.assign_type(Griffin, "Griffin");
	};

	var spawn = function(x, y){
		/* spawn instance of this entity at the given coordinates
			you will have to create new entity instance, assign it id
			using the IdentificationController.assign_id(entity_instance),
			assign it a body which you can get through PhysicsController
			do any other stuff you want to do during spawning,
			and finally you HAVE TO(!!!) return the instance you just created from this function
		*/

		var new_Griffin = new Griffin();
		var id = IdentificationController.assign_id(new_Griffin);

		new_Griffin.body = PhysicsController.get_rectangular({x: x, y: y, border_sensors: true}, new_Griffin);	

		return new_Griffin;

	};

	var tick_AI = function(Griffin){
		/* Is ran each tick from the EntityController.update for every registered
			entity of this type. I given entity_instance
		*/


		if (Griffin.hp == 1) {
			
			if (Griffin.hero_hurt_me){
				wound_Griffin(Griffin, 1);
				WorldController.increase_score();
				Griffin.hero_hurt_me = false;
				Griffin.can_attack = false;
				
			}

		}else if (Griffin.hp <= 0) {
			change_state(Griffin, "death");
			Griffin.can_attack = false;
			Griffin.death_tick++;
			Griffin.is_alive = false;
			Griffin.hit_taken = false;

			
			if(Griffin.death_tick == 15){
				EntityController.delete_entity(Griffin);
				return 
			}else if(Griffin.death_tick > 15){
			}

		}else { // Griffin.hp >= 1

			if (Griffin.AI_state == "walk") {
				var Griffinbody = Griffin.body;
				var velocity = Griffinbody.GetLinearVelocity();
				velocity.x = -Griffin.speed;
				Griffinbody.SetLinearVelocity(velocity); // body.SetLinearVelocity(new b2Vec2(5, 0)); would work too
				Griffinbody.SetAwake(true);
			}

			if (Griffin.AI_state == "fly") {
			    var body = Griffin.body;
			    body.ApplyImpulse(new B2d.b2Vec2((2 * Griffin.fly_force * Griffin.direction) - Griffin.fly_force, 1 * Griffin.fly_force / 2), body.GetWorldCenter());
			}

			if (Griffin.can_attack && Griffin.me_hurt_hero && Griffin.AI_state == "walk"){
				// pass
			}
			if (Griffin.hero_hurt_me)
			{
				wound_Griffin(Griffin, 1);
				Griffin.hero_hurt_me = false;
				Griffin.can_attack = false;
				change_animation(Griffin, "injury");
                				
			}
		}
		
		
	};


	var wound_Griffin = function(Griffin, wound){
		Griffin.hp -= wound;
		Griffin.hero_hurt_me = false;
	};

	var change_state = function(Griffin, progress_state) {
		Griffin.AI_state = progress_state;

	};

	// // //Set up Collision handler
	
	
	var begin_contact = function(contact, info){
		//handle collisions here
		
		//console.log(info.Me.id, ":", "My fixture", "'" + info.Me.fixture_name + "'", "came into contact with fixture", 
			//"'" + info.Them.fixture_name + "'", "of", info.Them.id);
		
		var type = info.Me.type;

		if(type !== "Griffin")
			console.log("Error", type, "instead of Griffin with other being", info.Them.type);
		
		
		if(info.Them.type == "hero")
		{
			
			if(info.Them.fixture_name != "bottom" && info.Me.entity.can_attack)
			{
				info.Me.entity.me_hurt_hero = true;
				
			}	
			else
			{

				info.Me.entity.hero_hurt_me = true;
			}
		}

	};
	
	var change_animation = function (Griffin, new_animation) {
			if (Griffin.animation != new_animation) {
				Griffin.animation = new_animation;
				Griffin.needs_graphics_update = true;
		} else {
			Griffin.needs_graphics_update = false;
		}
	};

	var end_contact = function(contact, info) {
	
	};

	
	return {
		// declare public
		init: init, 
		spawn: spawn,
		tick_AI: tick_AI,
		begin_contact: begin_contact,
		end_contact: end_contact,
	};
})();

module.exports = GriffinLogic;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "GriffinLogic", 
	include_options: Includes.choices.LOGIC_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":18}],21:[function(require,module,exports){
var HeroLogic = (function(){

	var Hero = function(){
		/* Will be instantiated for every created entity to hold all the information 
			about the physical (not graphical) state of the entity in question. 
			declare the properties like this:
			this.some_state_variable_initial_value = 0;
			instantiate (most likely in the spawn function) like that:
			var new_entity_instance = new Hero();
		*/
		this.hp = 100;
		this.wound = false;
		this.damage_taken = 1;
		this.damage = 1;
		this.jumps = 0;
		
		this.score = 0;
		this.state = "walk";
		this.an_frame =0;
		this.death_tick=0;
		this.jump_tick=0;
		this.walk_tick=0;
		this.is_walk = false;
		this.is_jump = false;
		this.death = false;
		/*
			whenever the up,right,left buttons are pressed the 
			corosponding value is set to 0 and the other are increased by1
			the value of the boolean corospoding to the button pressed is set to true
		*/
		this.up =false;
		this.right=false;
		this.left=false;
		this.facing = "right"; //or will be left
	};

	var init = function(){
		/* Is ran from the EntityController.init once during game loading 
			you should assign type to your model here using the identification controller
		*/
		include(); // satisfy requirements, GOES FIRST
		IdentificationController.assign_type(Hero, "hero");
	};

	var spawn = function(x, y){
		/* spawn instance of this entity at the given coordinates
			you will have to create new entity instance, assign it id
			using the IdentificationController.assign_id(entity_instance),
			assign it a body which you can get through PhysicsController
			do any other stuff you want to do during spawning,
			and finally you HAVE TO(!!!) return the instance you just created from this function
		*/

		var hero = new Hero();

		hero.body = PhysicsController.get_rectangular({x: x, y: y, border_sensors: true}, hero);

		var id = IdentificationController.assign_id(hero);
		EntityController.load_hero(hero.id);
		
		hero.hp = 100;
		hero.wound = false;
		hero.jumps = 0;
		hero.score = 0;

		return hero;
	
	};

	var tick_AI = function(hero){
		/* Is ran each tick from the EntityController.update for every registered
			entity of this type. I given entity_instance
		*/

		var cmds = KeyboardController.movement_commands();

       
        //End Score Tracking

		if(hero.hp <= 0)
		{
			hero.hp=0;
			if(hero.death == false){
				change_state(hero,"death");
				hero.death = true;
			}
			hero.death_tick++;
			if (hero.death_tick == 70) {
				despawn(hero);	
			}
			
		}
		else{
			if(cmds("right")){
				 if(hero.jumps==0&&hero.is_walk == false){
					change_state(hero,"walk");
					hero.is_walk = true;
				}
				if(hero.right == false){
					hero.right = true;
					hero.left = false;
				}
				
				move_right(hero);
			}
			if(cmds("left")){
				if(hero.jumps==0&&hero.is_walk == false){
					change_state(hero,"walk");
					hero.is_walk = true;
				}
				
				if(hero.left == false){
					hero.left = true;
					hero.right = false;
				}
				move_left(hero);
			}
			if(cmds("down")){
			    slam(hero);
			    stop_hero(hero);
			}
			if(cmds("up")){
				hero.is_walk=false;
				jump(hero);
				
			}
		}
		if(hero.wound)
		{
			hero.hp -= hero.damage_taken;
			console.log("Taking damage");
		}
		
		if (hero.body.GetWorldCenter().x < WorldController.get_movement_edge() + hero.body.GetUserData().def.width/2) {
			stop_hero(hero);
			console.log("working");
		}
		//if (hero.body.GetWorldCenter().y > 22) {
			//hero.hp = 0;
			//console.log("drop of death");
		//}
	};

	var despawn = function(hero){
		/**
		* called when hero should despawn (die);
		*/

		EntityController.delete_entity(hero);
		console.log("Player Is Dead");
	};
	
	
	var change_state = function(hero, new_state){
		hero.state = new_state;
		hero.walk_tick = 0;
		hero.death_tick = 0;
		hero.jump_tick = 0;
	};
	var begin_contact = function(contact, info){
		if (info.Me.fixture_name == "bottom"){
			if(info.Them.fixture_name == "top" || info.Them.entity.kind == 1 || info.Them.entity.kind == 2){
				info.Me.entity.jumps = 0;
			}
			if(info.Them.entity.kind == 3){
			    if (info.Me.entity.hp > 0) {
			        info.Me.entity.wound = true;
			    }
				info.Me.entity.damage_taken = info.Them.entity.damage;
			}
		}
		if(info.Me.fixture_name != "bottom" && info.Them.entity.can_attack){
			if(typeof info.Them.entity.kind === 'undefined'){
				//stupid chain of box2d functions returns {x:half_height,y:half_width}
				var my_extents = info.Me.entity.body.GetFixtureList().GetNext().GetNext().GetNext().GetNext().GetAABB().GetExtents();
				var my_coordinates = info.Me.entity.body.GetWorldCenter();
				var other_extents = info.Them.entity.body.GetFixtureList().GetNext().GetNext().GetNext().GetNext().GetAABB().GetExtents();
				var other_coordinates = info.Them.entity.body.GetWorldCenter();
				//prevents taking damage while on top of enemies
				if (!(my_coordinates.y <= other_coordinates.y - (my_extents.y + other_extents.y - 0.5))) {
				    if (info.Me.entity.hp > 0) {
				        info.Me.entity.wound = true;
				    }
					info.Me.entity.damage_taken = info.Them.entity.damage;
				}
			}else{
				info.Me.entity.wound = true;
				info.Me.entity.damage_taken = info.Them.entity.damage;
			}
		}
				
	};

	var take_hit = function(hero, amount){
	    hero.hp -= amount;
	}

	var end_contact = function(contact, info){
			
		info.Me.entity.wound = false;
	};

	var stop_hero = function (hero) {
		//var body = hero.body;
		//var velocity = body.GetLinearVelocity();
		//velocity.x = 0;
		//body.SetLinearVelocity(velocity); // body.SetLinearVelocity(new b2Vec2(5, 0)); would work too
		//body.SetAwake(true);

		var body = hero.body;
		var w = hero.body.GetUserData().def.width/2;
		var pos = new B2d.b2Vec2(WorldController.get_movement_edge() + w, body.GetWorldCenter().y)
		var vel = body.GetLinearVelocity();
		if(vel.x < 0 || body.GetWorldCenter().x > pos.x){
			var vel = new B2d.b2Vec2(0, vel.y);
			body.SetLinearVelocity(vel);
		}

	    body.SetAwake(true);
	}

	var slam = function(hero){
	    var body = hero.body;
	    body.ApplyImpulse(new B2d.b2Vec2(0, 20), body.GetWorldCenter());
	};
	var jump = function(hero){
	    var body = hero.body;
	    var w = hero.body.GetUserData().def.width / 2;
	    var pos = new B2d.b2Vec2(WorldController.get_movement_edge() + w, body.GetWorldCenter().y)
	    var vel = body.GetLinearVelocity();
	    console.log(hero.jumps);
		if (hero.jumps == 0){
		    change_state(hero, "jump");
			var vel = new B2d.b2Vec2(vel.x, -18);
			body.SetLinearVelocity(vel);
			hero.body.SetAwake(true);
		    hero.jumps += 1;
		}
		else if (hero.jumps == 1 && body.GetLinearVelocity().y > -1) {
		    change_state(hero, "jump");
		    var min_check = vel.y - 18;
		    if (min_check > -9) {
		        min_check = -9;
		    }
		    var vel = new B2d.b2Vec2(vel.x, min_check);
		    body.SetLinearVelocity(vel);
		    hero.body.SetAwake(true);
		    hero.jumps += 1;
		}

		//hero.y = body.GetPosition().y * 30;
	
	};

	var set_coordinates = function(position_vector, hero){
		// TODO: remove;
		// temporary/testing
		hero.x = (position_vector.x - 1.5/2) * 30 ;
		hero.y = (position_vector.y + 2.5/2) * 30 ;

	};

	var b2b_get_coordinates = function(hero){
		return hero.body.GetWorldCenter();
	};

	var move_left = function(hero){
		var velocity = hero.body.GetLinearVelocity();
		velocity.x = -8;
		hero.body.SetLinearVelocity(velocity); // hero.SetLinearVelocity(new b2Vec2(5, 0)); would work too
		hero.body.SetAwake(true);
	};

	var move_right = function(hero){
		var velocity = hero.body.GetLinearVelocity();
		velocity.x = +8;
		hero.body.SetLinearVelocity(velocity); // hero.SetLinearVelocity(new b2Vec2(5, 0)); would work too
		hero.body.SetAwake(true);
	};

	var move = function(offset_x, offset_y, hero){
		// unimplemented
		// should it hard-set position (not safe!)
		// or just allow to set any velocity/impulse vector?
	};
	var get_hero_x = function(){
			return hero.body.GetWorldCenter().x;
	
	};

	return {
		// declare public
		init: init, 
		spawn: spawn,
		despawn: despawn,
		tick_AI: tick_AI,
		begin_contact: begin_contact,
		end_contact: end_contact,
		get_hero_x: get_hero_x,
	};
})();

module.exports = HeroLogic;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "HeroLogic", 
	include_options: Includes.choices.LOGIC_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":18}],22:[function(require,module,exports){
/* 
	Enemy: Hyena 
	class and functions for the Hyena type enemy
	public functions:
		-init()
			initializes default class data for all instances of class Hyena
		-spawn(int x, int y)
			returns a new instance of class Hyena with unique instance ID at global coordinates(x,y)
		-tick_AI()
			runs hyena AI script, to be called for each instance on game tick
		-begin_contact()
			handles collisions, called on collision with any object
		-end_contact()
			callback function for box2d
*/

var HyenaLogic = (function(){
	//Instantiated for each instance of hyena at creation
	//call constructor through wrapper function spawn()
	var Hyena = function(){

		var entity = EntityController.create_abstract_entity();

		//Declare initial variables for the Hyena
	
		entity.hp = 2;
		entity.speed = 7;
		entity.jump_force = 125;
		entity.damage = 5;
		entity.point_value = 200;
		entity.sight_range = 16; //distance at which hyena detects heroes
		entity.attack_range = 8; //distance at which hyena leaps at the hero
		
		entity.hit_taken = false; //whether a hit has been taken since the last tick
		entity.damage_taken = 0; //the amount of damage inflicted by hits since the last tick
		
		entity.direction = false;	//false=left, true=right;
		entity.direction_previous = false;//store direction from end of previous tick
		entity.x_previous = 0;		//store x value from end of previous tick
		
		entity.is_idle = true; //determines whether hyena is aggressive or idle
		entity.idle_duration = 40; // time buffer between changing idle states
		entity.idle_timer = entity.idle_duration;
		entity.idle_counter = 0; //used to manage the number of times the hyena has changed state while idle
		entity.is_alive = true; //disables attacking and plays death animation while false
		entity.death_duration = 30;//time between death and deletion
		entity.decay_duration = 20;//time between decay animation and deletion
		entity.death_timer = -1;
		entity.running_away = false; //whether the hyena is running away
		entity.run_away_duration = 30; //set cowardice level
		entity.run_away_timer = -1;
		entity.can_attack = true;	//whether attacking is enabled
		entity.attack_cooldown = 10; //attack cooldown
		entity.attack_cooldown_timer = -1;
		entity.can_leap = true;		//leaping enabled
		entity.leap_cooldown = 40;//minimum time between leaps
		entity.leap_cooldown_timer = -1; 
		entity.charge_duration = 80;//maximum length of a charge
		entity.charge_timer = entity.charge_duration;
		entity.charge_cooldown = 20;//minimum time between charges
		entity.charge_cooldown_timer = -1;
		entity.blinking = false;	//whether hyena is blinking
		entity.blink_duration = 20;//how long the hyena blinks after taking damage
		entity.blink_timer = -1;
		entity.maintenance_frequency = 20;//ticks between routine maintenance checks
		entity.maintenance_timer = entity.maintenance_frequency;
		
		entity.barely_obstructed = false;
		entity.collision_buffer = 0.2	//the region of overlap accounted for during collision checking
		entity.path_blocked = false;	//is entity deprecated? set during collision
		entity.obstruction_tolerance = 4;//how many times the hyena can be blocked before he takes action
		entity.blocked_count = 0;			//tracks number of times blocked between maintenance checks
		
		entity.needs_graphics_update = false; //accessed by renderer for animation purposes
		entity.animation = "stand"; //accessed by renderer for animation purposes
		
		return entity;
	};

	//Initialize class variables, called once in EntityController.init() during game load
	var init = function(){
		include(); // satisfy requirements, GOES FIRST
		IdentificationController.assign_type(Hyena, "Hyena"); //assign class id
	};

	//Instantiates class Hyena
	//Wrapper for constructor, assigns unique ID
	var spawn = function(x, y){
		var new_hyena = new Hyena();
		new_hyena.type = "Hyena";
		var id = IdentificationController.assign_id(new_hyena);

		new_hyena.body = PhysicsController.get_rectangular({x: x, y: y, border_sensors: true}, new_hyena);	
		new_hyena.PhysicsController = PhysicsController;
		
		return new_hyena;
	};
	
//........................COMMENCE.........................\\
//.......................ARTIFICIAL........................\\
//.........................HYENA...........................\\
//......................INTELLIGENCE.......................\\
	
	// Is run each tick from the EntityController.update for every registered instance
	var tick_AI = function(Hyena){
		//Check if Dead........
		//If Hyena is off the screen, delete
		if (Hyena.body.GetWorldCenter().x <= WorldController.get_movement_edge() + 1.125){
			Hyena.body.ApplyImpulse(new B2d.b2Vec2(Hyena.jump_force, 0), Hyena.body.GetWorldCenter());
		}
		if (Hyena.hp <= 0){//if mortally wounded
			Hyena.die(Hyena); //die
		}else{ // Do Live Hyena Stuff
			//Maintenance....
			Hyena.direction_previous = Hyena.direction;				//remember what hyena's direction was at start of tick
			Hyena.x_previous = Hyena.body.GetWorldCenter().x; //remember what hyena's x was at start of tick
			Hyena.leap_cooldown_timer--;			//ensure the hyena is not eternally jumping
			//maintain blinking
			if(Hyena.blinking){
				Hyena.blink_timer--;
				if(Hyena.blink_timer == 0){
					Hyena.blinking = false;
				}
			}
			//maintain attack cooldown
			if(Hyena.attack_cooldown_timer > 0){ 
				Hyena.attack_cooldown_timer--;
				Hyena.can_attack = (Hyena.attack_cooldown_timer == 0);
			}
			//maintain the hyena's alternating phases of running and stopping
			if(Hyena.charge_timer <= 0){
				Hyena.charge_cooldown_timer--;
				if (Hyena.charge_cooldown_timer <= 0){
					Hyena.charge_timer = Hyena.charge_duration;
				}
			}
			//maintain the hyena's cowardly tactics
			if (Hyena.running_away){	//if hyena is deliberately running away
				Hyena.run_away_timer--;	//tickdown run_away timer
				if (Hyena.run_away_timer == 0){ //maybe stop running away
					Hyena.run_away_timer = -1;
					Hyena.direction = Hyena.direction_nearest_enemy(Hyena);
					Hyena.running_away = false;
				}
			}
			//check periodically to ensure the hyena is not stuck in a corner and other routine maintenance
			Hyena.maintenance_timer--;
			if (Hyena.maintenance_timer == 0){
				if (Hyena.path_free(Hyena)){
					Hyena.path_blocked = false;
				}
				if (Hyena.blocked_count > Hyena.obstruction_tolerance){	//you know he's stuck now
					if (Hyena.can_leap){
						Hyena.path_blocked = true;
						leap(Hyena);	//time to jump for it
						Hyena.path_blocked = false;
					}
				}
				Hyena.blocked_count = 0;
				Hyena.maintenance_timer = Hyena.maintenance_frequency; //reset check timer
			}
			//Run Main AI Script.....
			if(!Hyena.in_air(Hyena) || Hyena.body.GetLinearVelocity().y == 0){ //if on ground OR if we suspect he's stuck on a corner
				if (Hyena.enemy_in_range(Hyena,Hyena.sight_range)){ //if enemy nearby
					Hyena.idle = false;
					if (Hyena.hit_taken){	//if hyena was attacked,
						Hyena.running_away = true;	//back off
						Hyena.run_away_timer = Hyena.run_away_duration;
						Hyena.direction = !(Hyena.direction);
					}else if ((Hyena.enemy_in_range(Hyena,Hyena.attack_range) || Hyena.path_blocked) && Hyena.can_leap && Hyena.leap_cooldown_timer <= 0){ //if enemy in range or path is blocked, and leaping is enabled, leap
						Hyena.direction = Hyena.direction_nearest_enemy(Hyena);
						leap(Hyena);
						Hyena.can_leap = false;
						Hyena.leap_cooldown_timer = Hyena.leap_cooldown;
						Hyena.change_animation(Hyena,"leap");
					}else{
						if(!Hyena.running_away && !Hyena.in_air(Hyena)){ //if hyena isn't cowering or in the air, face the enemy
							Hyena.direction = Hyena.direction_nearest_enemy(Hyena);
						}
						if (Hyena.charge_timer > 0){ //if charge duration > 0
							run(Hyena);
							Hyena.change_animation(Hyena,"run"); //charge the enemy
							Hyena.charge_timer--;
							if(Hyena.charge_timer == 0){
								Hyena.charge_cooldown_timer = Hyena.charge_cooldown;
							}
							if(Hyena.x_previous == Hyena.body.GetWorldCenter().x){ //check if hyena has moved successfully
								Hyena.blocked_count++;
							}
						}else{//else stand aggressively
							Hyena.change_animation(Hyena,"stand");
						}
					}
				}else{
					Hyena.idle = true; //idle mode
					Hyena.idle_timer--;
					if (Hyena.idle_timer == 0){
						Hyena.idle_timer = Hyena.idle_duration;
						Hyena.idle_counter = (Hyena.idle_counter+1)%27;
						if (Hyena.idle_counter%4 == 0 && Hyena.idle_counter%5 != 0){
							Hyena.direction = !(Hyena.direction);//use weird modulos to get random looking idle behavior
						}
					}
					if (Hyena.idle_counter%2 == 0 || Hyena.idle_counter%3 == 0){ //use weird modulos to get random looking idle behavior
						walk(Hyena);
						Hyena.change_animation(Hyena,"walk");//pace
						if(Hyena.x_previous == Hyena.body.GetWorldCenter().x){ //check if hyena has wandered successfully
							Hyena.blocked_count++; //else check for being stuck
						}
					}else{
						Hyena.change_animation(Hyena,"stand");//loiter
					}
				}
			}else{//if in the air
				if(Hyena.movement_voluntary(Hyena)){
					Hyena.change_animation(Hyena,"leap");//if voluntary, leap
				}else{
					Hyena.change_animation(Hyena,"fall");//else, fall
				}
			}
			if (Hyena.hit_taken){
				Hyena.take_damage(Hyena); //if hit, take damage
			}
		}
	};
//...........................END............................\\
//........................ARTIFICIAL........................\\
//.......................INTELLIGENCE.......................\\


//.....................HELPER FUNCTIONS......................
	
	
	//run
	var run = function(hyena){
		var body = hyena.body;
		var velocity = body.GetLinearVelocity();
		velocity.x = hyena.speed*(2*hyena.direction-1); //move speed in current direction
		body.SetLinearVelocity(velocity);
		body.SetAwake(true);
	};
	
	//walk
	var walk = function(hyena){
		var body = hyena.body;
		var velocity = body.GetLinearVelocity();
		velocity.x = hyena.speed*(2*hyena.direction-1)/3;
		body.SetLinearVelocity(velocity);
		body.SetAwake(true);
	};
	
	//leap
	var leap = function(hyena){
		var body = hyena.body;
		if (hyena.path_blocked){//jump out of a hole or over a wall
			body.ApplyImpulse(new B2d.b2Vec2(-10+(20*hyena.direction), -1*hyena.jump_force), body.GetWorldCenter());
			//var a = (100 - (hyena.direction*20))*Math.PI/180;
		}else{ //leap viciously at hero
			body.ApplyImpulse(new B2d.b2Vec2((2*hyena.jump_force*hyena.direction) - hyena.jump_force, -1*hyena.jump_force/2), body.GetWorldCenter());
			//var a = Math.atan(body.GetWorldCenter().y - pconf.hero_y, body.GetWorldCenter().x - pconf.hero_x);
		}
		//body.ApplyImpulse(new B2d.b2Vec2(hyena.jump_force*Math.sin(a), hyena.jump_force*Math.cos(a)), body.GetWorldCenter());
		hyena.can_leap = false;
	};
	

//......................COLLISION HANDLERS...........................
	//called at the beginning of the collision
	var begin_contact = function(contact, info){
		var type = info.Me.type;
		var hyena = info.Me.entity;
		var hyena_x = hyena.body.GetWorldCenter().x;
		var hyena_y = hyena.body.GetWorldCenter().x;
		var hyena_w = 1.125; //half width of hyena
		var hyena_h = 0.875; //half the height of hyena
		var other_x = info.Them.entity.body.GetWorldCenter().x;
		var other_y = info.Them.entity.body.GetWorldCenter().y;
		var other_w = hyena.get_fixture(info.Them.entity,"main").GetAABB().GetExtents().x;
		var other_h = hyena.get_fixture(info.Them.entity,"main").GetAABB().GetExtents().y;
		
		/**
		(hyena_w + other_w + buffer) = minimum horizontal distance for non-vertically stacked entities
		abs(them.x - me.x) = absolute horizontal distance
		(abs_hdistance < min_hdistance) implies vertical stacking
		
		(hyena_h + other_h + buffer) = minimum vertical distance for non-adjacent entities
		(abs_vdistance < min_vdistance) implies adjacency
		
		(hyena.x - other.x) < 0 if (hyena.x < other.x)
		(hyena.x - other.x) = 0 if (hyena.x = other.x)
		(hyena.x - other.x) > 0 if (hyena.x > other.x)
		smaller x is to the left of bigger x
		smaller y is above bigger y
		0 = left;
		1 = right;
		((hyena.x - other.x) > 0) returns true if hyena is to the right of the enemy, else false
		((hyena.x - other.x) < 0) returns true if other is to the right of hyena, else false
		
		((hyena.y - other.y) > 0) returns true if hyena is below the enemy (hyena_y > other_y), else false
		((hyena.y - other.y) < 0) returns true if other is above hyena(hyena_y < other_y), else false
		*/
		
		//ultimate collision detector
		if (info.Me.fixture_name == "main"){
			//if adjacent
			if (Math.abs(hyena_y - other_y) < (hyena_h + other_h - hyena.collision_buffer)){ //if adjacent
				if ((hyena_h+other_h) - (other_y-hyena_y) < hyena.collision_buffer){//if the hyena is close enough to the top that he could almost walk over it...
					hyena.barely_obstructed = true;//call for a tiny bump
				}else{
					hyena.blocked_count++; //else call for a real jump
					hyena.path_blocked = true;
				}
				if (info.Them.type == "hero"){//if other = hero, deal damage
					if(hyena.can_attack){
						hyena.attack_cooldown_timer = hyena.attack_cooldown;//set cooldown timer
					}
				}
			}else{
				//if other is below
				if(true){}
					//reset jump
					//if hero, deal damage
				
				//if other is above:
					//if hero, take damage
			}
		}
		
		var vulnerability_radius = (1.125 + 0.45 - 0.3);// hyena_width/2 + hero_width/2 - buffer, in meters
		//if bottom colliding with the ground or top of another object, enable leap
		if (info.Me.fixture_name == "bottom" && (info.Them.fixture_name == "top" || info.Them.entity.kind == 1 || info.Them.entity.kind == 2)){
			hyena.can_leap = true;
		}
		
		//if colliding with a wall, detect blocked path
		if ((info.Me.fixture_name == "left" && !hyena.direction)||(info.Me.fixture_name == "right" && hyena.direction)){
			hyena.path_blocked = true;
			hyena.blocked_count++;
		}
		
		//if colliding with a player, check for damage
		if(info.Them.type == "hero"){
			if(info.Them.fixture_name != "bottom"){ //if can_attack and colliding with a fixture other than "bottom"
				if(hyena.can_attack){
					hyena.attack_cooldown_timer = hyena.attack_cooldown;//set cooldown timer
				}
			}else if(Math.abs(info.Them.entity.body.GetWorldCenter().x - hyena.body.GetWorldCenter().x) < vulnerability_radius && !hyena.blinking){
				hyena.hit_taken = true;//take damage if enemy collides from above and distance < vulnerability radius
				hyena.damage_taken = info.Them.entity.damage;
			}
		}
	};

	//called upon end of collision
	var end_contact = function(contact, info){
		
	};


//.................DECLARE PUBLIC FUNCTIONS.....................
	return {
		init: init, 
		spawn: spawn,
		tick_AI: tick_AI,
		begin_contact: begin_contact,
		end_contact: end_contact,
	};
})();

module.exports = HyenaLogic;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "HyenaLogic", 
	include_options: Includes.choices.LOGIC_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":18}],23:[function(require,module,exports){
var AssetModel = new function(){
	// As always, almost anything is initialized in the InitController
	
	this.loader;

	this.manifest = [ // defining resources to be loaded in bulk with preload.js
			{src: "greek_warrior.png", id: "greek_warrior"},
			//{src:, id:},
			{src: "middle_terrain.png", id:"middle_terrain"},
			{src: "bottom_terrain.png", id: "bottom_terrain"},
			{src: "grass_summer.png", id: "grass_summer" },
			{src: "grass_winter.png", id: "grass_winter" },
			{src: "grass_fall.png", id: "grass_fall" },
			{src: "grass_spring.png", id: "grass_spring" },
			{src: "AntChompers.png", id: "Ant1"},
			{src: "AntChompers2.png", id: "Ant2"},
			{src: "AntChompersDeath.png", id: "Ant3"},
			{src: "Greek Landscape fall.png", id: "Fall"},
			{src: "Greek Landscape spring.png", id: "Spring"},
			{src: "Greek Landscape winter.png", id: "Winter"},
			{src: "Greek Landscape summer.png", id: "Summer"},
			{src: "griffinPhase1Small.png", id: "Griffin1" },
			{src: "griffinPhase2Small.png", id: "Griffin2" },
			{src: "griffinPhase3Small.png", id: "Griffin3" },
			{ src: "griffinDeathSmall.png", id: "GriffinDeath" },
            { src: "griffinDeathSmall2.png", id: "GriffinDeath2" },
            { src: "griffinDeathSmall3.png", id: "GriffinDeath3" },
			{src: "platform_left.png", id: "left_platform" },
			{src: "platform_middle.png", id: "middle_platform" },
			{src: "platform_right.png", id: "right_platform" },
			{src: "HyenaPhase4.png", id: "HyenaSprite" },
			{src: "platform_spikes.png", id: "platform_spikes" },
			{src: "Hero.png", id: "Hero"},
			{src: "HeroHitRed.png", id: "HeroR"},
			{src: "HeroHitWhite.png", id: "HeroW"},


			
		]; 
		// TODO make adding resources easier? Automatic loading 
		// of everything from assets, automatic names etc.?

	this.shapes = {}; // maybe this aren't needed

	this.bitmaps = {};

	this.animations = {};

};

module.exports = AssetModel;

},{}],24:[function(require,module,exports){
var EntityModel = function(){	
	// associates type with the AI
	this.type_to_AI = {};

	this.for_logic_update = {}; // key: type, value: table of objects with id for key, object for value
	
	
};

module.exports = new EntityModel;


},{}],25:[function(require,module,exports){
var GameModel = new function(){ // main model
    this.pauseCounter = 0;
};

module.exports = GameModel;

},{}],26:[function(require,module,exports){
var GraphicsModel = function(){
	this.stage; // main stage to where everything will be drawn
	// note that every graphics object must be augmented with
	// the reference to the corresponding physics object, if any
	this.other_players = []; // array of players other then hero for multiplayer

	// all object registered for continious update to match their physical body
	// position 
	this.all_physical = {}; 
	this.special_render = {}; // matches type with array of all objects of that type to be rendered

	// all spritesheet definitions (added at the initialization stage
	// because they need assets to be loaded)
	this.spritesheets = {}; 

	this.camera = {
		// should be easeljs object or null
		following: null,

		// internal camera implementation thing to know how far to offset from the
		// initial position
		offset: {x: 0, y: 0},

		// the offset of the camera from the followed object
		// e.g. offset of {x: 100, y: 100} will center camera
		// 100 pixels to the right and 100 pixels below the followed object
		offset_from_followed: { x: 400, y: -100 },
		//offset_from_followed: {x: 330, y: -205}, //FOR GAME PAGE
		// this is center of the screen in pixels. gets dynamically recalculated 
		// during the camera update so if it's ever changed, camera still works as expected
		center: {x: 0, y: 0}

	};

};

module.exports = new GraphicsModel;


},{}],27:[function(require,module,exports){
var HUDModel = function(){
	
};

module.exports = new HUDModel;


},{}],28:[function(require,module,exports){

var IdentificationModel = function(){
	
	// next unique id to be given if not free id's remain
	this.next_id = 0;

	// array of free id's. push when freed, pop when free id is needed
	// if array is empty, get next id using >next_id<
	this.free_ids = [];

	// array matches ids to their corresponding objects
	this.id_matching = [];

	// registry of types to make sure that no type is registerd twice
	// and enable people to get the model by type name
	this.types = {}
	
	//list of heroes and companions spawned
	this.hero;
	this.companions = [];
};

module.exports = new IdentificationModel;



},{}],29:[function(require,module,exports){
var KeyboardModel = function(){
	this.keys = {};

	this.translation_tables = {
		code_to_name: {
			8:   "backspace", //  backspace
			9:   "tab", //  tab
			13:  "enter", //  enter
			16:  "shift", //  shift
			17:  "ctrl", //  ctrl
			18:  "alt", //  alt
			19:  "pause/break", //  pause/break
			20:  "caps lock", //  caps lock
			27:  "escape", //  escape
			33:  "page up", // page up, to avoid displaying alternate character and confusing people
			34:  "page down", // page down
			35:  "end", // end
			36:  "home", // home
			37:  "left arrow", // left arrow
			38:  "up arrow", // up arrow
			39:  "right arrow", // right arrow
			40:  "down arrow", // down arrow
			45:  "insert", // insert
			46:  "delete", // delete
			48:  "0",
			49:  "1",
			50:  "2",
			51:  "3",
			52:  "4",
			53:  "5",
			54:  "6",
			55:  "7",
			56:  "8",
			57:  "9",
			65:  "a",
			66:  "b",
			67:  "c",
			68:  "d",
			69:  "e",
			70:  "f",
			71:  "g",
			72:  "h",
			73:  "i",
			74:  "j",
			75:  "k",
			76:  "l",
			77:  "m",
			78:  "n",
			79:  "o",
			80:  "p",
			81:  "q",
			82:  "r",
			83:  "s",
			84:  "t",
			85:  "u",
			86:  "v",
			87:  "w",
			88:  "x",
			89:  "y",
			90:  "z",
			91:  "left window", // left window
			92:  "right window", // right window
			93:  "select key", // select key
			96:  "numpad 0", // numpad 0
			97:  "numpad 1", // numpad 1
			98:  "numpad 2", // numpad 2
			99:  "numpad 3", // numpad 3
			100: "numpad 4", // numpad 4
			101: "numpad 5", // numpad 5
			102: "numpad 6", // numpad 6
			103: "numpad 7", // numpad 7
			104: "numpad 8", // numpad 8
			105: "numpad 9", // numpad 9
			106: "multiply", // multiply
			107: "add", // add
			109: "subtract", // subtract
			110: "decimal point", // decimal point
			111: "divide", // divide
			112: "F1", // F1
			113: "F2", // F2
			114: "F3", // F3
			115: "F4", // F4
			116: "F5", // F5
			117: "F6", // F6
			118: "F7", // F7
			119: "F8", // F8
			120: "F9", // F9
			121: "F10", // F10
			122: "F11", // F11
			123: "F12", // F12
			144: "num lock", // num lock
			145: "scroll lock", // scroll lock
			186: ";", // semi-colon
			187: "=", // equal-sign
			188: ",", // comma
			189: "-", // dash
			190: ".", // period
			191: "/", // forward slash
			192: "`", // grave accent
			219: "[", // open bracket
			220: "\\", // back slash
			221: "]", // close bracket
			222: "'", // single quote
		},

		movement: {
			"left arrow": "left",
			"up arrow": "up",
			"down arrow": "down",
			"right arrow": "right",
		},

		pause: {
		    "p": "pause",
		},
		
		debug: {
			"a": "spawn_ant",
			"z": "season",
			"g": "spawn_griffin",
			"s": "new_slice",
			"h": "spawn_hyena",
		},

	}


};

module.exports = new KeyboardModel;


},{}],30:[function(require,module,exports){

var PhysicsModel = function() {
	
	this.gravity;
	this.world;
 
	// getting context of the debug canvas, for box2d to draw debuggin boxes

	// timeToCover is the time that simulation must cover to catch up to the real world time;
	// since createjs ticker is what we use for timing, and box2d ticks
	// must be of constant length and independent from the graphics framerate,
	// we keep track of time that passed since last box2d step by adding time deltas
	// to the timeToCover. Then, when timeToCover exceeds desired box2d step length,
	// we perform the step and subtract the corresponding time from the timeToCover;
	// If anything is still unclear, ask me (AK);
		this.timeToCover = 0; 

	this.step_amount;

	this.awaiting_contact = {
		PreSolve: {},
		PostSolve: {},
		BeginContact: {},
		EndContact: {},
	};

}; 

/*
 * Parameters for b2d body definition
	active: true
	allowSleep: true
	angle: 0
	angularDamping: 0
	angularVelocity: 0
	awake: true
	bullet: false
	fixedRotation: false
	inertiaScale: 1
	linearDamping: 0
	linearVelocity: b2Vec2
	position: b2Vec2
	type: 0
	userData: null
*/

/*
 * Fixture definition parameters:
	density: 0
	filter: b2FilterData
	friction: 0.2
	isSensor: false
	restitution: 0
	shape: null
	userData: null
 */

// rectangular
PhysicsModel.prototype.r_templates = r_templates = {};
// circular
PhysicsModel.prototype.c_templates = c_templates = {};
// polygonal
PhysicsModel.prototype.p_templates = p_templates = {};



r_templates["default"] = {

	//shape: "rectangle", // implied from the template type
	x: 3,
	y: 3,
	vx: 0,
	vy: 0,

	width: 5,
	height: 5,
	density: 2,
	friction: 1,
	restitution: 0.2,
	isSensor: false,


	active: true,
	allowSleep: true,
	angle: 0,
	angularVelocity: 0,
	awake: true,
	bullet: false,
	fixedRotation: false,
	type: "dynamic",

};

r_templates.living = {
	fixedRotation: true,
	awake: true,
	isSensor: false,
	//mobexp++
};

r_templates.terrain_cell = {
	type: "static",
	width: 1,
	height: 1,
	friction: 2,
	//mobexp++
};

r_templates.hero = {
	parent: r_templates.living,
	width: 0.9,
	height: 1.7,
	density: 4.5,
	type: "dynamic",
	//mobexp++
};

r_templates.ant = {
	parent: r_templates.living,
	width: 1,
	height: 0.5,
	type: "dynamic",
	x: 40,
	y: 10,
	//mobexp++
};

r_templates.Griffin = {
	parent: r_templates.living,
	width: 4,
	height: 2.5,
	type: "dynamic",
	x: 65,
	y: 10,
	//mobexp++
};

r_templates.Hyena = {
	parent: r_templates.living,
	width: 2.25,
	height: 1.75,
	type: "dynamic",
	x: 65,
	y: 10,
	//mobexp++
};

r_templates.test = {
	width: 1,
	height: 2,
	fixedRotation: false,
	//mobexp++
}

r_templates.platform = {
    x: 10,
    y: 11,
    width: 10,
    height: .5,
    type: "static",
}

module.exports = new PhysicsModel;

},{}],31:[function(require,module,exports){
var RegisterAsModel = function(){
	
	// register stuff for one time lookup
	// the one requesting stuff is supposed to pop the each examined element
	// there is no timeouts or automatic cleanup
	this.simple_one_time_lookup = {};
};

module.exports = new RegisterAsModel;


},{}],32:[function(require,module,exports){
var TerrainModel = function(){
	//This is physics, for graphics look into the GraphicsController/Model
	this.terrain_slices_queue = [];
	//this.new_slices = [];
	this.seed;

	// how many initial (non-random) terrain slices
	// were generated already?
	this.initial_generated = 0;


	// used to determine x offset of the next slice
	// TODO: update this when truly infinite terrain will be implemented
	this.slice_counter = 0;

};

module.exports = new TerrainModel;

},{}],33:[function(require,module,exports){
TerrainSliceConfig = require ("../Config.js").TerrainSlice;

var TerrainSliceModel = function(){

	this.Slice = function(){
		/**
		* slice "model" to be instantiated
		*/
		
		
		this.num = TerrainSliceConfig.next_slice_id++; // automaticall assign id and increment 

		this.grid_columns = TerrainSliceConfig.grid_columns;
		this.grid_rows = TerrainSliceConfig.grid_rows;
		this.cell_w = TerrainSliceConfig.cell_w;
		this.cell_h = this.cell_w;;
		
		// grid[i][j] is the element in the i's column and j's row
		// the grid is maid to match the screen coordinates and the current box2d coordinates
		// i.e. grid[0][0] is the one in the top left corner of the terrain slice
		// do we want to change it? would it be easier to generate terrain if we start at the bottom?
		// if yes, then what makes more sense, changing coordinate systems or just switching generation
		// loops around? discuss
		//
		// notice that the grid is a terrain generation device only. once terrain slice is loaded,
		// box2d physics simulation may (and will) go nuts on it, changing whatever it wants,
		// and changes won't anyhow be reflected in the grid. to keep track of all the bodies
		// in the terrain slice, if that will be needed, other mechanisms should be used.
		// idea: have a collections of bodies by type, and setup sensor collision beams
		// at the terrain slices' boundaries to keep track of bodies flying over from one
		// terrain slice to another. Btw, Ali, I hate you for making me to type "terrain slice"
		// instead of the "chunk" 
		this.grid = [];
		
		this.origin = {x: null, y: null};

	};

	this.Cell = function(kind){
		this.kind = kind;
		this.body;
	}

	
};

TerrainSliceModel.prototype.lvl_prob = [
	[7, 2, 1],
	[0, 7, 3],
	[0, 1, 9]
]

module.exports = new TerrainSliceModel;

},{"../Config.js":2}],34:[function(require,module,exports){
var TestModel = function(){

};

module.exports = new TestModel;


},{}],35:[function(require,module,exports){
var WorldModel = function(){
	
};

module.exports = new WorldModel;


},{}],36:[function(require,module,exports){
var AntRenderer = (function(){

	var spritesheets = {};
	var ant_animation;

	var init = function(){
		/* is ran from GraphicsController.init once during game loading
		 	use this function to create spritesheets and such
			like spritesheets.first = new createjs.Spritesheet(...);
		*/

		include(); // satisfy requirements, GOES FIRST
		var get_asset = AssetController.get_asset;

		spritesheets["ant"] = new createjs.SpriteSheet({
			"framerate": 1,
			"images": [get_asset("Ant1"), get_asset("Ant2"), get_asset("Ant3")],
			"frames": { "regX": 3, "regY": 6, "height": 25, "width": 50, "count": 6},
			"animations": {
				"walk": [0, 1, "walk"],
				"upside_down": [2, 3, "upside_down"],
				"death": [4, 5, "death"]
			}
		})

	};

	var register = function(entity_ant){
		/* is ran for every entity of this type that was just created and should
		get graphics representation. You are given the entity instance and is supposed
		to crete graphics instance, and GraphicsController.reg_for_render(graphics_instance, entity_instance); it 
		*/

		ant_animation = GraphicsController.request_animated(spritesheets["ant"], "walk");
		GraphicsController.set_reg_position(ant_animation, 0, 0); // change that to adjust sprite position relative to the body
		GraphicsController.reg_for_render(ant_animation, entity_ant); // sets ant_animation's position to track the ant's position (updates each tick)

		
	};

	var render = function(ant){
		/* 	is ran each tick from GraphicsController, for every registered object of this type
			is given >graphics_instance< parameter, which is also supposed to contain
			physical_instance property containing entity_instance, if it was attched correctly
		*/

		ant_animate(ant); 
	};
	var ant_animate = function(ant){
		//set graphical representation based on the animation variable determined by the AI
		//set animation
		if(ant.physical_instance.needs_graphics_update){
			var animation = ant.physical_instance.animation;
			ant.gotoAndPlay(animation)
		}
		
		//set direction
		if (ant.physical_instance.direction){ //if direction == right, flip right
			ant.scaleX = -1;
		}else{ //else flip left
			ant.scaleX = 1;
		}

		//set alpha if blinking
		if(ant.physical_instance.blinking && ant.physical_instance.blink_timer%2 == 1){
			ant.alpha = 0;
		}else{
			ant.alpha = 1;
		}
	};
	/*
	var ant_special_render_temp = function(ant){
		

		
		if(ant.physical_instance.AI_state == "death"&& ant.physical_instance.aliveflag){
			ant.gotoAndPlay("death");
			ant.physical_instance.aliveflag = false;
			
			
		}

		if(ant.physical_instance.AI_state == "upside_down" && ant.physical_instance.unhurtflag)
		{
			ant.gotoAndPlay("upside_down");
			ant.physical_instance.unhurtflag = false;
			
			
		}
		if(ant.physical_instance.AI_state == "walk" && ant.physical_instance.start_walking)
		{
			ant.gotoAndPlay("walk");
			//ant.physical_instance.hp += 1;
			ant.physical_instance.start_walking = false;
			
			
		}

	};
	*/

	return {
		// declare public
		init: init, 
		register: register,
		render: render,
	};
})();

module.exports = AntRenderer;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "AntRenderer", 
	include_options: Includes.choices.RENDERER_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":18}],37:[function(require,module,exports){
var BackgroundRenderer = (function(){

	var season_array;
	var season_image;
	var season_threshold;
	
	var season_progress;
	var season_progress_to_level;
	var hero_current_level;
		
	var init = function(){
		include(); //sets up dependencies MUST GO FIRST
		
		season_array = [];//stores season sprites
		season_image = ["Winter", "Spring", "Summer", "Fall"];
		season_threshold = 2; //So seasons only update once
		
		season_progress = 0;
		season_progress_to_level = 199;//season_image[cycle].width*2 + Config.SCREEN_W/2;
		hero_current_level = season_progress_to_level;
		
		generate_season("Winter", GraphicsController.get_stage().canvas.width, 0);
	};
	
	var render = function(){

		if(Math.round(WorldController.get_progress()) > hero_current_level){
			season_progress++;
			hero_current_level += season_progress_to_level;
			WorldController.increase_score(season_progress*500);
		}
		
		//Potentially change seasons based on hero progress
		change_seasons(season_progress);
		
		//perform parallax effect with background
		background_loop(WorldController.get_progress(),season_progress);
	};
	
	//Generates tiled background for season
	var generate_season = function(season_image, canvas_width, start){
		for(i=0; i<3; i++){//create tiles 3 at a time
			var season = GraphicsController.request_bitmap(season_image);
			season.regY -= season.image.height/2;
			//create a new tile with offset
			season.x = start + i*season.image.width;
			GraphicsController.get_stage().addChildAt(season, 0);
			season_array.push(season);
		}
	};
	
	//checks for and handles potential season change
	var change_seasons = function(progress){
		var flag = false;
		if(progress == season_threshold){ //seasons will change every even progress number
			season_threshold += 2;
			flag = true;
		}
		if(flag){
			console.log("generating season");
			delete_all_season();
			WorldController.set_season((WorldController.get_season()+1)%4);
			generate_season(season_image[WorldController.get_season()], GraphicsController.get_stage().canvas.width, WorldController.get_movement_edge() / 30);
		}
	};
	
	//scrolls the background along with the player
	var background_loop = function(hero_x, progress){
		for(i=0; i<season_array.length; i++){
			//season_array[i].x = (i * 799) + GraphicsModel.camera.offset.x;
			//season_array[i].y = GraphicsModel.camera.offset.y;
			season_array[i].x = ((i + progress) * 799) - (hero_x * 4);
			season_array[i].y = GraphicsController.get_camera().offset.y;
		}
	};

	//deletes all background objects
	var delete_all_season = function(){
		for(var i = 0; i < season_array.length; i++){
			GraphicsController.get_stage().removeChild(season_array[i]);
		}
		season_array = [];
	};
	
	var register = function(background){
		/* is ran for every entity of this type that was just created and should
		get graphics representation. You are given the entity instance and is supposed
		to crete graphics instance, and GraphicsController.reg_for_render(graphics_instance, entity_instance); it 
		*/

		
	};

	return {
		// declare public
		init: init, 
		register: register,
		render: render,
	};
})();

module.exports = BackgroundRenderer;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "BackgroundRenderer", 
	include_options: Includes.choices.RENDERER_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}



},{"../Includes.js":18}],38:[function(require,module,exports){
var GriffinRenderer = (function(){

	var spritesheets = {};
	var Griffin_animation;

	var init = function(){
		/* is ran from GraphicsController.init once during game loading
		 	use this function to create spritesheets and such
			like spritesheets.first = new createjs.Spritesheet(...);
		*/

		include(); // satisfy requirements, GOES FIRST
		var get_asset = AssetController.get_asset;

		spritesheets["Griffin"] = new createjs.SpriteSheet({
			"framerate": 1,
			"images": [get_asset("Griffin1"), get_asset("Griffin2"), get_asset("Griffin3"), get_asset("GriffinDeath")], //, get_asset("GriffinDeath2"), get_asset("GriffinDeath3")
				"frames": { "regX": 5, "regY": 14, "height": 207, "width": 210, "count": 6},
				"animations": {
				"walk": [0, 2, "walk", 0.2],
				"injury": {
				    frames: [2, 4, .25]
				},
				"death": [3, 4, "death", 0.6],
                "fly": [1, 2, "fly", .4],
			}
		})

	};

	var register = function(entity_Griffin){
		/* is ran for every entity of this type that was just created and should
		get graphics representation. You are given the entity instance and is supposed
		to crete graphics instance, and GraphicsController.reg_for_render(graphics_instance, entity_instance); it 
		*/

		Griffin_animation = GraphicsController.request_animated(spritesheets["Griffin"], "walk");
		GraphicsController.set_reg_position(Griffin_animation, 0, 0); // change that to adjust sprite position relative to the body
		GraphicsController.reg_for_render(Griffin_animation, entity_Griffin); // sets griffin_animation's position to track the griffin's position (updates each tick)

		
	};

	var render = function(Griffin){
		/* 	is ran each tick from GraphicsController, for every registered object of this type
			is given >graphics_instance< parameter, which is also supposed to contain
			physical_instance property containing entity_instance, if it was attched correctly
		*/

		Griffin_special_render_temp(Griffin); 
	};

	var Griffin_special_render_temp = function(Griffin){
		/* how to handle special render? TEMPORARY */

		
		if(Griffin.physical_instance.AI_state == "death"&& Griffin.physical_instance.aliveflag){
 			Griffin.gotoAndPlay("death");
			console.log("I've been squashed!");
 			Griffin.physical_instance.aliveflag = false;
		}

		//if(Griffin.physical_instance.AI_state == "upside_down" && Griffin.physical_instance.unhurtflag)
		//{
		//	Griffin.gotoAndPlay("upside_down");
		//	Griffin.physical_instance.unhurtflag = false;
			
			
		//}

	};

	return {
		// declare public
		init: init, 
		register: register,
		render: render,
	};
})();

module.exports = GriffinRenderer;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "GriffinRenderer", 
	include_options: Includes.choices.RENDERER_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":18}],39:[function(require,module,exports){
var HeroRenderer = (function(){

	var spritesheets = {}; // to store spritesheets used by this entity

	var init = function(){
		/* is ran from GraphicsController.init once during game loading
			use this function to create spritesheets and such
			like spritesheets.first = new createjs.Spritesheet(...);
		*/
		include(); // satisfy requirements, GOES FIRST
		var get_asset = AssetController.get_asset;
		spritesheets["hero"] = new createjs.SpriteSheet({
			"framerate": 1,
			"images": [get_asset("Hero")], //get_asset("HeroR"), get_asset("HeroW")
			"frames": { "regX": 25, "regY": 25, "height": 50, "width": 50, "count": 16},
			"animations": {
				stand: {
				frames: [0]
				},
				finish: {
					frames: [8]
				},				
				walk: {
					 frames: [0,1, 2],
					 speed: 0.4
				 },
                jump: {
					frames: [3, 4, 5, 6, 7, 8],
					speed: 0.3
				},
                death: {
					frames: [9, 10, 11, 12, 13, 14, 15],
					speed: 0.3
				},
				deathFinal: {
					frames: [15]
				},
			}
		})
		//SpriteSheetUtils.addFlippedFrames(spriteSheets["Hero"], true, false, false);
	};

	var register = function(entity_hero){
		/* is ran for every entity of this type that was just created and should
		get graphics representation. You are given the entity instance and is supposed
		to crete graphics instance, and GraphicsController.reg_for_render(graphics_instance, entity_instance); it 
		*/

		hero_animation = GraphicsController.request_animated(spritesheets["hero"], "stand");
		hero_animation.graphics_id = "hero";
		GraphicsController.set_reg_position(hero_animation, -25, -25);
		GraphicsController.reg_for_render(hero_animation, entity_hero);
		GraphicsController.follow(entity_hero.id);

	};

	var render = function(hero){
		/* 	is ran each tick from GraphicsController, for every registered object of this type
			is given >graphics_instance< parameter, which is also supposed to contain
			physical_instance property containing entity_instance, if it was attched correctly
		*/
		if(hero.physical_instance.state=="walk"&&hero.physical_instance.is_walk == true){
			if(hero.physical_instance.walk_tick ==1){
				hero.gotoAndPlay("walk");
			}
			hero.physical_instance.walk_tick++;
			if(hero.physical_instance.walk_tick ==10){
				hero.physical_instance.state= "stand";
				hero.physical_instance.is_walk = false;
			}
		}
		
		if(hero.physical_instance.state=="jump"){
			if(hero.physical_instance.jump_tick ==1){
				hero.gotoAndPlay("jump");
			}
			hero.physical_instance.jump_tick++;
			if(hero.physical_instance.jump_tick >= 20){
				hero.gotoAndPlay("finish");
				if(hero.physical_instance.jumps==0){
					hero.physical_instance.state="finish";
				}
				
			}
		}
		
		if(hero.physical_instance.state=="finish"){
			hero.gotoAndPlay("finish");
		}
		if(hero.physical_instance.state=="deathFinal"){
			hero.gotoAndPlay("deathFinal");
		}
		if(hero.physical_instance.state=="stand"){
			hero.gotoAndPlay("stand");
		}
		console.log(hero.physical_instance.state);
		if (hero.physical_instance.state == "death") {
		    console.log(hero.physical_instance.death_tick);
			if(hero.physical_instance.death_tick ==1){
			    hero.gotoAndPlay("death");
			}
			else if(hero.physical_instance.death_tick >=20){
				hero.physical_instance.state="deathFinal";
			}
		}
		
		//set direction
		if (hero.physical_instance.left){ //if direction == right, flip right
			hero.scaleX = -1;
		}else{ //else flip left
			hero.scaleX = 1;
		}
	};

	return {
		// declare public
		init: init, 
		register: register,
		render: render,
	};
})();

module.exports = HeroRenderer;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "HeroRenderer", 
	include_options: Includes.choices.RENDERER_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":18}],40:[function(require,module,exports){
var HyenaRenderer = (function(){

	var spritesheets = {};
	var Hyena_animation;

	var init = function(){
		/* is ran from GraphicsController.init once during game loading
		 	use this function to create spritesheets and such
			like spritesheets.first = new createjs.Spritesheet(...);
		*/

		include(); // satisfy requirements, GOES FIRST
		var get_asset = AssetController.get_asset;

		spritesheets["Hyena"] = new createjs.SpriteSheet({
			"framerate": 1,
			"images": [get_asset("HyenaSprite")],
			"frames": { "regX": 0, "regY": 8, "height": 64, "width": 64, "count": 17},
			"animations": {
				"run": [0,3, "run", 0.5],
				"stand": [4,5, "stand", 0.25],
				"walk": [8,11, "walk", 0.2],
				"leap": [6],
				"fall": [7],
				"death": [12,14, "decay", 0.25],
				"decay": [15,16, "decay", 0.25],
			}
		})

	};

	var register = function(entity_hyena){
		/* is run for every entity of this type that was just created and should
		get graphics representation. You are given the entity instance and is supposed
		to create graphics instance, and GraphicsController.reg_for_render(graphics_instance, entity_instance); it 
		*/

		hyena_animation = GraphicsController.request_animated(spritesheets["Hyena"], "walk");
		GraphicsController.set_reg_position(hyena_animation, 0, 0); // change that to adjust sprite position relative to the body
		GraphicsController.reg_for_render(hyena_animation, entity_hyena); // sets hyena_animation's position to track the hyena's position (updates each tick)
		/*
		hyena_animation is the easeljs_obj passed through graphicsController
		entity_hyena is the physical object spawned in HyenaLogic
		request_animated returns an easeljs object of type Sprite
		this Sprite is the object passed to render
		*/
		
	};

	var render = function(hyena){
		/* 	is run each tick from GraphicsController, for every registered object of this type
			is given >graphics_instance< parameter, which is also supposed to contain
			physical_instance property containing entity_instance, if it was attached correctly
		*/

		hyena_animate(hyena); 
	};

	var hyena_animate = function(hyena){
		//set graphical representation based on the animation variable determined by the AI
		//set animation
		if(hyena.physical_instance.needs_graphics_update){
			var animation = hyena.physical_instance.animation;
			hyena.gotoAndPlay(animation)
		}
		
		//set direction
		if (hyena.physical_instance.direction){ //if direction == right, flip right
			hyena.scaleX = -1;
		}else{ //else flip left
			hyena.scaleX = 1;
		}

		//set alpha if blinking
		if(hyena.physical_instance.blinking && hyena.physical_instance.blink_timer%2 == 1){
			hyena.alpha = 0;
		}else{
			hyena.alpha = 1;
		}
	};
	
	return {
		// declare public
		init: init, 
		register: register,
		render: render,
	};
})();

module.exports = HyenaRenderer;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "HyenaRenderer", 
	include_options: Includes.choices.RENDERER_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

},{"../Includes.js":18}],41:[function(require,module,exports){
var TerrainCellRenderer = (function(){

	var spritesheets = {}; // to store spritesheets used by this entity

	var init = function(){
		/* is ran from GraphicsController.init once during game loading
			use this function to create spritesheets and such
			like spritesheets.first = new createjs.Spritesheet(...);
		*/
		include(); // satisfy requirements, GOES FIRST

	};

	var register = function(entity_cell){
		/* is ran for every entity of this type that was just created and should
		get graphics representation. You are given the entity instance and is supposed
		to crete graphics instance, and GraphicsController.reg_for_render(graphics_instance, entity_instance); it 
		*/

		
	};

	var render = function(cell){
		/* 	is ran each tick from GraphicsController, for every registered object of this type
			is given >graphics_instance< parameter, which is also supposed to contain
			physical_instance property containing entity_instance, if it was attched correctly
		*/

	};

	return {
		// declare public
		init: init, 
		register: register,
		render: render,
	};
})();

module.exports = TerrainCellRenderer;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TerrainCellRenderer", 
	include_options: Includes.choices.RENDERER_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],42:[function(require,module,exports){
var TerrainSliceRenderer = (function(){

	var spritesheets = {}; // to store spritesheets used by this entity

	var init = function(){
		/* is ran from GraphicsController.init once during game loading
			use this function to create spritesheets and such
			like spritesheets.first = new createjs.Spritesheet(...);
		*/
		include(); // satisfy requirements, GOES FIRST

	};

	var register = function(slice, PrivateGraphics){
		/* is ran for every entity of this type that was just created and should
		get graphics representation. You are given the entity instance and is supposed
		to crete graphics instance, and GraphicsController.reg_for_render(graphics_instance, entity_instance); it 
		*/

		// TODO: change that private crap to smth more useful
		// like make graphics controller special case in includes,
		// so that only interested people can get it
		var request_animated = PrivateGraphics.request_animated;
		var request_bitmap = PrivateGraphics.request_bitmap;
		var trans_xy = PrivateGraphics.trans_xy;
		var reg_for_render = PrivateGraphics.reg_for_render;

		for(var i = 0; i < slice.grid_rows; i++){
				for(var j = 0; j < slice.grid_columns; j++){
					var kind = slice.grid[i][j].kind;
					if(kind != 0){
						// TODO: should make proper terrain collection thing to pull from
						/*
						var tile_texture = ["grass", "middle_terrain", "bottom_terrain"][kind-1];
						var tile = request_bitmap(tile_texture);
						*/
						var surface_textures = ["grass_winter","grass_spring","grass_summer","grass_fall"];
						var position = slice.grid[i][j].position;
						if (kind == 1){ //if tile is part of the ground
							switch (position){
									case "surface":
										console.log(WorldController.get_season());
										var tile_texture = surface_textures[WorldController.get_season()];
									break;
								case "underground":
									var tile_texture = "bottom_terrain";
									break;
							}
						}
						if (kind == 2){ //if tile is part of a platform
							switch (position){
								case "left":
									var tile_texture = "left_platform";;
									break;
								case "middle":
									var tile_texture = "middle_platform";
									break;
								case "right":
									var tile_texture = "right_platform";
									break;
							}
						}
						if (kind == 3){//if tile is actually just spikes
							var tile_texture = "platform_spikes";
						}
						var tile = request_bitmap(tile_texture);
						var physical_instance = slice.grid[i][j];
						var body_position = physical_instance.body.GetWorldCenter();
						var trans_pos = trans_xy(body_position);
						tile.x = trans_pos.x;
						tile.y = trans_pos.y;
						reg_for_render(tile, physical_instance);
					} // end tile_texture assignment
				} // end for
			}//end for
		
	};

	var render = function(slice){
		/* 	is ran each tick from GraphicsController, for every registered object of this type
			is given >graphics_instance< parameter, which is also supposed to contain
			physical_instance property containing entity_instance, if it was attched correctly
		*/

	};

	return {
		// declare public
		init: init, 
		register: register,
		render: render,
	};
})();

module.exports = TerrainSliceRenderer;

var Includes = require("../Includes.js"); var include_data = Includes.get_include_data({
	current_module: "TerrainSliceRenderer", 
	include_options: Includes.choices.RENDERER_SPECIFIC
}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}


},{"../Includes.js":18}],43:[function(require,module,exports){

/*
 * Rules for working on the (client-side) game code:
 *
 * 1. If you think that one of these rules is stupid or useless, tell me, along with some better suggestions.
 *
 * 2. Model [name]Model can only be accessed through [name]Controller. If you need to do something to 
 * 		change [name]Model from [other_name]Controller, write function in the [name]Controller that does
 * 		what you need, and call it from the [other_name]Controller
 *
 * 3. Controllers are allowed to have private methods/fields. Models aren't. 
 *
 * 4. Controllers aren't allowed to have public data fields. 
 * 		Those data fields that are present must not reflect state of the game, they must be related to
 * 		some internal functionality of the controller
 *
 * 5. If you write some function that doesn't logically belong to one of the controllers,
 * 		put it in the Utility
 *
 * 6. Variables are named like that: variable_name
 * 		Except (singleton)class names, that are written like that: ClassName
 *
 * 7. And all the obvious stuff that everyone knows:
 * 		function must do one thing; don't make function public unless it needs to be that; 
 * 		comment ambigious code, for larger functions indicate their purpose (through commenting);
 */


// main namespace that is exposed to global scope (window object)
window.sidescroller_game = (function namespace(){

		var Includes = require("./Includes.js"); var include_data = Includes.get_include_data({
		current_module: "None", 
		include_options: Includes.choices.ALL_CONTROLLERS
	}); eval(include_data.name_statements); var include = function(){eval(include_data.module_statements);}

	// Game initiation section: >>>
		
	var load_game = function(mode)
	{

		Includes.init(); // first
		include(); // second

		InitController.init(mode); // init all the stuff

		if(mode == "test"){
			TestController.test();
		}
	};


	var run = function(mode)
	{
		// done this way to ensure that load_game's internals aren't accessible to the world:
		load_game(mode);
	}; 
	
	return {
		run: run
	}; // expose function run to the world

})(); 


},{"./Includes.js":18}],44:[function(require,module,exports){
/*
* Copyright (c) 2006-2007 Erin Catto http://www.gphysics.com
*
* This software is provided 'as-is', without any express or implied
* warranty.  In no event will the authors be held liable for any damages
* arising from the use of this software.
* Permission is granted to anyone to use this software for any purpose,
* including commercial applications, and to alter it and redistribute it
* freely, subject to the following restrictions:
* 1. The origin of this software must not be misrepresented; you must not
* claim that you wrote the original software. If you use this software
* in a product, an acknowledgment in the product documentation would be
* appreciated but is not required.
* 2. Altered source versions must be plainly marked as such, and must not be
* misrepresented as being the original software.
* 3. This notice may not be removed or altered from any source distribution.
*/
"use strict"

var Box2D = {};

(function (a2j, undefined) {
   
   function emptyFn() {};
   a2j.inherit = function(cls, base) {
      var tmpCtr = cls;
      emptyFn.prototype = base.prototype;
      cls.prototype = new emptyFn;
      cls.prototype.constructor = tmpCtr;
   };
   
   a2j.generateCallback = function generateCallback(context, cb) {
      return function () {
         cb.apply(context, arguments);
      };
   };
   
   a2j.NVector = function NVector(length) {
      if (length === undefined) length = 0;
      var tmp = new Array(length || 0);
      for (var i = 0; i < length; ++i)
      tmp[i] = 0;
      return tmp;
   };
   
   a2j.is = function is(o1, o2) {
      if (o1 === null) return false;
      if ((o2 instanceof Function) && (o1 instanceof o2)) return true;
      if ((o1.constructor.__implements != undefined) && (o1.constructor.__implements[o2])) return true;
      return false;
   };
   
   a2j.parseUInt = function(v) {
      return Math.abs(parseInt(v));
   }
   
})(Box2D);

//#TODO remove assignments from global namespace
var Vector = Array;
var Vector_a2j_Number = Box2D.NVector;
//package structure
if (typeof(Box2D) === "undefined") Box2D = {};
if (typeof(Box2D.Collision) === "undefined") Box2D.Collision = {};
if (typeof(Box2D.Collision.Shapes) === "undefined") Box2D.Collision.Shapes = {};
if (typeof(Box2D.Common) === "undefined") Box2D.Common = {};
if (typeof(Box2D.Common.Math) === "undefined") Box2D.Common.Math = {};
if (typeof(Box2D.Dynamics) === "undefined") Box2D.Dynamics = {};
if (typeof(Box2D.Dynamics.Contacts) === "undefined") Box2D.Dynamics.Contacts = {};
if (typeof(Box2D.Dynamics.Controllers) === "undefined") Box2D.Dynamics.Controllers = {};
if (typeof(Box2D.Dynamics.Joints) === "undefined") Box2D.Dynamics.Joints = {};
//pre-definitions
(function () {
   Box2D.Collision.IBroadPhase = 'Box2D.Collision.IBroadPhase';

   function b2AABB() {
      b2AABB.b2AABB.apply(this, arguments);
   };
   Box2D.Collision.b2AABB = b2AABB;

   function b2Bound() {
      b2Bound.b2Bound.apply(this, arguments);
   };
   Box2D.Collision.b2Bound = b2Bound;

   function b2BoundValues() {
      b2BoundValues.b2BoundValues.apply(this, arguments);
      if (this.constructor === b2BoundValues) this.b2BoundValues.apply(this, arguments);
   };
   Box2D.Collision.b2BoundValues = b2BoundValues;

   function b2Collision() {
      b2Collision.b2Collision.apply(this, arguments);
   };
   Box2D.Collision.b2Collision = b2Collision;

   function b2ContactID() {
      b2ContactID.b2ContactID.apply(this, arguments);
      if (this.constructor === b2ContactID) this.b2ContactID.apply(this, arguments);
   };
   Box2D.Collision.b2ContactID = b2ContactID;

   function b2ContactPoint() {
      b2ContactPoint.b2ContactPoint.apply(this, arguments);
   };
   Box2D.Collision.b2ContactPoint = b2ContactPoint;

   function b2Distance() {
      b2Distance.b2Distance.apply(this, arguments);
   };
   Box2D.Collision.b2Distance = b2Distance;

   function b2DistanceInput() {
      b2DistanceInput.b2DistanceInput.apply(this, arguments);
   };
   Box2D.Collision.b2DistanceInput = b2DistanceInput;

   function b2DistanceOutput() {
      b2DistanceOutput.b2DistanceOutput.apply(this, arguments);
   };
   Box2D.Collision.b2DistanceOutput = b2DistanceOutput;

   function b2DistanceProxy() {
      b2DistanceProxy.b2DistanceProxy.apply(this, arguments);
   };
   Box2D.Collision.b2DistanceProxy = b2DistanceProxy;

   function b2DynamicTree() {
      b2DynamicTree.b2DynamicTree.apply(this, arguments);
      if (this.constructor === b2DynamicTree) this.b2DynamicTree.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTree = b2DynamicTree;

   function b2DynamicTreeBroadPhase() {
      b2DynamicTreeBroadPhase.b2DynamicTreeBroadPhase.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTreeBroadPhase = b2DynamicTreeBroadPhase;

   function b2DynamicTreeNode() {
      b2DynamicTreeNode.b2DynamicTreeNode.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTreeNode = b2DynamicTreeNode;

   function b2DynamicTreePair() {
      b2DynamicTreePair.b2DynamicTreePair.apply(this, arguments);
   };
   Box2D.Collision.b2DynamicTreePair = b2DynamicTreePair;

   function b2Manifold() {
      b2Manifold.b2Manifold.apply(this, arguments);
      if (this.constructor === b2Manifold) this.b2Manifold.apply(this, arguments);
   };
   Box2D.Collision.b2Manifold = b2Manifold;

   function b2ManifoldPoint() {
      b2ManifoldPoint.b2ManifoldPoint.apply(this, arguments);
      if (this.constructor === b2ManifoldPoint) this.b2ManifoldPoint.apply(this, arguments);
   };
   Box2D.Collision.b2ManifoldPoint = b2ManifoldPoint;

   function b2Point() {
      b2Point.b2Point.apply(this, arguments);
   };
   Box2D.Collision.b2Point = b2Point;

   function b2RayCastInput() {
      b2RayCastInput.b2RayCastInput.apply(this, arguments);
      if (this.constructor === b2RayCastInput) this.b2RayCastInput.apply(this, arguments);
   };
   Box2D.Collision.b2RayCastInput = b2RayCastInput;

   function b2RayCastOutput() {
      b2RayCastOutput.b2RayCastOutput.apply(this, arguments);
   };
   Box2D.Collision.b2RayCastOutput = b2RayCastOutput;

   function b2Segment() {
      b2Segment.b2Segment.apply(this, arguments);
   };
   Box2D.Collision.b2Segment = b2Segment;

   function b2SeparationFunction() {
      b2SeparationFunction.b2SeparationFunction.apply(this, arguments);
   };
   Box2D.Collision.b2SeparationFunction = b2SeparationFunction;

   function b2Simplex() {
      b2Simplex.b2Simplex.apply(this, arguments);
      if (this.constructor === b2Simplex) this.b2Simplex.apply(this, arguments);
   };
   Box2D.Collision.b2Simplex = b2Simplex;

   function b2SimplexCache() {
      b2SimplexCache.b2SimplexCache.apply(this, arguments);
   };
   Box2D.Collision.b2SimplexCache = b2SimplexCache;

   function b2SimplexVertex() {
      b2SimplexVertex.b2SimplexVertex.apply(this, arguments);
   };
   Box2D.Collision.b2SimplexVertex = b2SimplexVertex;

   function b2TimeOfImpact() {
      b2TimeOfImpact.b2TimeOfImpact.apply(this, arguments);
   };
   Box2D.Collision.b2TimeOfImpact = b2TimeOfImpact;

   function b2TOIInput() {
      b2TOIInput.b2TOIInput.apply(this, arguments);
   };
   Box2D.Collision.b2TOIInput = b2TOIInput;

   function b2WorldManifold() {
      b2WorldManifold.b2WorldManifold.apply(this, arguments);
      if (this.constructor === b2WorldManifold) this.b2WorldManifold.apply(this, arguments);
   };
   Box2D.Collision.b2WorldManifold = b2WorldManifold;

   function ClipVertex() {
      ClipVertex.ClipVertex.apply(this, arguments);
   };
   Box2D.Collision.ClipVertex = ClipVertex;

   function Features() {
      Features.Features.apply(this, arguments);
   };
   Box2D.Collision.Features = Features;

   function b2CircleShape() {
      b2CircleShape.b2CircleShape.apply(this, arguments);
      if (this.constructor === b2CircleShape) this.b2CircleShape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2CircleShape = b2CircleShape;

   function b2EdgeChainDef() {
      b2EdgeChainDef.b2EdgeChainDef.apply(this, arguments);
      if (this.constructor === b2EdgeChainDef) this.b2EdgeChainDef.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2EdgeChainDef = b2EdgeChainDef;

   function b2EdgeShape() {
      b2EdgeShape.b2EdgeShape.apply(this, arguments);
      if (this.constructor === b2EdgeShape) this.b2EdgeShape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2EdgeShape = b2EdgeShape;

   function b2MassData() {
      b2MassData.b2MassData.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2MassData = b2MassData;

   function b2PolygonShape() {
      b2PolygonShape.b2PolygonShape.apply(this, arguments);
      if (this.constructor === b2PolygonShape) this.b2PolygonShape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2PolygonShape = b2PolygonShape;

   function b2Shape() {
      b2Shape.b2Shape.apply(this, arguments);
      if (this.constructor === b2Shape) this.b2Shape.apply(this, arguments);
   };
   Box2D.Collision.Shapes.b2Shape = b2Shape;
   Box2D.Common.b2internal = 'Box2D.Common.b2internal';

   function b2Color() {
      b2Color.b2Color.apply(this, arguments);
      if (this.constructor === b2Color) this.b2Color.apply(this, arguments);
   };
   Box2D.Common.b2Color = b2Color;

   function b2Settings() {
      b2Settings.b2Settings.apply(this, arguments);
   };
   Box2D.Common.b2Settings = b2Settings;

   function b2Mat22() {
      b2Mat22.b2Mat22.apply(this, arguments);
      if (this.constructor === b2Mat22) this.b2Mat22.apply(this, arguments);
   };
   Box2D.Common.Math.b2Mat22 = b2Mat22;

   function b2Mat33() {
      b2Mat33.b2Mat33.apply(this, arguments);
      if (this.constructor === b2Mat33) this.b2Mat33.apply(this, arguments);
   };
   Box2D.Common.Math.b2Mat33 = b2Mat33;

   function b2Math() {
      b2Math.b2Math.apply(this, arguments);
   };
   Box2D.Common.Math.b2Math = b2Math;

   function b2Sweep() {
      b2Sweep.b2Sweep.apply(this, arguments);
   };
   Box2D.Common.Math.b2Sweep = b2Sweep;

   function b2Transform() {
      b2Transform.b2Transform.apply(this, arguments);
      if (this.constructor === b2Transform) this.b2Transform.apply(this, arguments);
   };
   Box2D.Common.Math.b2Transform = b2Transform;

   function b2Vec2() {
      b2Vec2.b2Vec2.apply(this, arguments);
      if (this.constructor === b2Vec2) this.b2Vec2.apply(this, arguments);
   };
   Box2D.Common.Math.b2Vec2 = b2Vec2;

   function b2Vec3() {
      b2Vec3.b2Vec3.apply(this, arguments);
      if (this.constructor === b2Vec3) this.b2Vec3.apply(this, arguments);
   };
   Box2D.Common.Math.b2Vec3 = b2Vec3;

   function b2Body() {
      b2Body.b2Body.apply(this, arguments);
      if (this.constructor === b2Body) this.b2Body.apply(this, arguments);
   };
   Box2D.Dynamics.b2Body = b2Body;

   function b2BodyDef() {
      b2BodyDef.b2BodyDef.apply(this, arguments);
      if (this.constructor === b2BodyDef) this.b2BodyDef.apply(this, arguments);
   };
   Box2D.Dynamics.b2BodyDef = b2BodyDef;

   function b2ContactFilter() {
      b2ContactFilter.b2ContactFilter.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactFilter = b2ContactFilter;

   function b2ContactImpulse() {
      b2ContactImpulse.b2ContactImpulse.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactImpulse = b2ContactImpulse;

   function b2ContactListener() {
      b2ContactListener.b2ContactListener.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactListener = b2ContactListener;

   function b2ContactManager() {
      b2ContactManager.b2ContactManager.apply(this, arguments);
      if (this.constructor === b2ContactManager) this.b2ContactManager.apply(this, arguments);
   };
   Box2D.Dynamics.b2ContactManager = b2ContactManager;

   function b2DebugDraw() {
      b2DebugDraw.b2DebugDraw.apply(this, arguments);
      if (this.constructor === b2DebugDraw) this.b2DebugDraw.apply(this, arguments);
   };
   Box2D.Dynamics.b2DebugDraw = b2DebugDraw;

   function b2DestructionListener() {
      b2DestructionListener.b2DestructionListener.apply(this, arguments);
   };
   Box2D.Dynamics.b2DestructionListener = b2DestructionListener;

   function b2FilterData() {
      b2FilterData.b2FilterData.apply(this, arguments);
   };
   Box2D.Dynamics.b2FilterData = b2FilterData;

   function b2Fixture() {
      b2Fixture.b2Fixture.apply(this, arguments);
      if (this.constructor === b2Fixture) this.b2Fixture.apply(this, arguments);
   };
   Box2D.Dynamics.b2Fixture = b2Fixture;

   function b2FixtureDef() {
      b2FixtureDef.b2FixtureDef.apply(this, arguments);
      if (this.constructor === b2FixtureDef) this.b2FixtureDef.apply(this, arguments);
   };
   Box2D.Dynamics.b2FixtureDef = b2FixtureDef;

   function b2Island() {
      b2Island.b2Island.apply(this, arguments);
      if (this.constructor === b2Island) this.b2Island.apply(this, arguments);
   };
   Box2D.Dynamics.b2Island = b2Island;

   function b2TimeStep() {
      b2TimeStep.b2TimeStep.apply(this, arguments);
   };
   Box2D.Dynamics.b2TimeStep = b2TimeStep;

   function b2World() {
      b2World.b2World.apply(this, arguments);
      if (this.constructor === b2World) this.b2World.apply(this, arguments);
   };
   Box2D.Dynamics.b2World = b2World;

   function b2CircleContact() {
      b2CircleContact.b2CircleContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2CircleContact = b2CircleContact;

   function b2Contact() {
      b2Contact.b2Contact.apply(this, arguments);
      if (this.constructor === b2Contact) this.b2Contact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2Contact = b2Contact;

   function b2ContactConstraint() {
      b2ContactConstraint.b2ContactConstraint.apply(this, arguments);
      if (this.constructor === b2ContactConstraint) this.b2ContactConstraint.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactConstraint = b2ContactConstraint;

   function b2ContactConstraintPoint() {
      b2ContactConstraintPoint.b2ContactConstraintPoint.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactConstraintPoint = b2ContactConstraintPoint;

   function b2ContactEdge() {
      b2ContactEdge.b2ContactEdge.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactEdge = b2ContactEdge;

   function b2ContactFactory() {
      b2ContactFactory.b2ContactFactory.apply(this, arguments);
      if (this.constructor === b2ContactFactory) this.b2ContactFactory.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactFactory = b2ContactFactory;

   function b2ContactRegister() {
      b2ContactRegister.b2ContactRegister.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactRegister = b2ContactRegister;

   function b2ContactResult() {
      b2ContactResult.b2ContactResult.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactResult = b2ContactResult;

   function b2ContactSolver() {
      b2ContactSolver.b2ContactSolver.apply(this, arguments);
      if (this.constructor === b2ContactSolver) this.b2ContactSolver.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2ContactSolver = b2ContactSolver;

   function b2EdgeAndCircleContact() {
      b2EdgeAndCircleContact.b2EdgeAndCircleContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2EdgeAndCircleContact = b2EdgeAndCircleContact;

   function b2NullContact() {
      b2NullContact.b2NullContact.apply(this, arguments);
      if (this.constructor === b2NullContact) this.b2NullContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2NullContact = b2NullContact;

   function b2PolyAndCircleContact() {
      b2PolyAndCircleContact.b2PolyAndCircleContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PolyAndCircleContact = b2PolyAndCircleContact;

   function b2PolyAndEdgeContact() {
      b2PolyAndEdgeContact.b2PolyAndEdgeContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PolyAndEdgeContact = b2PolyAndEdgeContact;

   function b2PolygonContact() {
      b2PolygonContact.b2PolygonContact.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PolygonContact = b2PolygonContact;

   function b2PositionSolverManifold() {
      b2PositionSolverManifold.b2PositionSolverManifold.apply(this, arguments);
      if (this.constructor === b2PositionSolverManifold) this.b2PositionSolverManifold.apply(this, arguments);
   };
   Box2D.Dynamics.Contacts.b2PositionSolverManifold = b2PositionSolverManifold;

   function b2BuoyancyController() {
      b2BuoyancyController.b2BuoyancyController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2BuoyancyController = b2BuoyancyController;

   function b2ConstantAccelController() {
      b2ConstantAccelController.b2ConstantAccelController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2ConstantAccelController = b2ConstantAccelController;

   function b2ConstantForceController() {
      b2ConstantForceController.b2ConstantForceController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2ConstantForceController = b2ConstantForceController;

   function b2Controller() {
      b2Controller.b2Controller.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2Controller = b2Controller;

   function b2ControllerEdge() {
      b2ControllerEdge.b2ControllerEdge.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2ControllerEdge = b2ControllerEdge;

   function b2GravityController() {
      b2GravityController.b2GravityController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2GravityController = b2GravityController;

   function b2TensorDampingController() {
      b2TensorDampingController.b2TensorDampingController.apply(this, arguments);
   };
   Box2D.Dynamics.Controllers.b2TensorDampingController = b2TensorDampingController;

   function b2DistanceJoint() {
      b2DistanceJoint.b2DistanceJoint.apply(this, arguments);
      if (this.constructor === b2DistanceJoint) this.b2DistanceJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2DistanceJoint = b2DistanceJoint;

   function b2DistanceJointDef() {
      b2DistanceJointDef.b2DistanceJointDef.apply(this, arguments);
      if (this.constructor === b2DistanceJointDef) this.b2DistanceJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2DistanceJointDef = b2DistanceJointDef;

   function b2FrictionJoint() {
      b2FrictionJoint.b2FrictionJoint.apply(this, arguments);
      if (this.constructor === b2FrictionJoint) this.b2FrictionJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2FrictionJoint = b2FrictionJoint;

   function b2FrictionJointDef() {
      b2FrictionJointDef.b2FrictionJointDef.apply(this, arguments);
      if (this.constructor === b2FrictionJointDef) this.b2FrictionJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2FrictionJointDef = b2FrictionJointDef;

   function b2GearJoint() {
      b2GearJoint.b2GearJoint.apply(this, arguments);
      if (this.constructor === b2GearJoint) this.b2GearJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2GearJoint = b2GearJoint;

   function b2GearJointDef() {
      b2GearJointDef.b2GearJointDef.apply(this, arguments);
      if (this.constructor === b2GearJointDef) this.b2GearJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2GearJointDef = b2GearJointDef;

   function b2Jacobian() {
      b2Jacobian.b2Jacobian.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2Jacobian = b2Jacobian;

   function b2Joint() {
      b2Joint.b2Joint.apply(this, arguments);
      if (this.constructor === b2Joint) this.b2Joint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2Joint = b2Joint;

   function b2JointDef() {
      b2JointDef.b2JointDef.apply(this, arguments);
      if (this.constructor === b2JointDef) this.b2JointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2JointDef = b2JointDef;

   function b2JointEdge() {
      b2JointEdge.b2JointEdge.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2JointEdge = b2JointEdge;

   function b2LineJoint() {
      b2LineJoint.b2LineJoint.apply(this, arguments);
      if (this.constructor === b2LineJoint) this.b2LineJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2LineJoint = b2LineJoint;

   function b2LineJointDef() {
      b2LineJointDef.b2LineJointDef.apply(this, arguments);
      if (this.constructor === b2LineJointDef) this.b2LineJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2LineJointDef = b2LineJointDef;

   function b2MouseJoint() {
      b2MouseJoint.b2MouseJoint.apply(this, arguments);
      if (this.constructor === b2MouseJoint) this.b2MouseJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2MouseJoint = b2MouseJoint;

   function b2MouseJointDef() {
      b2MouseJointDef.b2MouseJointDef.apply(this, arguments);
      if (this.constructor === b2MouseJointDef) this.b2MouseJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2MouseJointDef = b2MouseJointDef;

   function b2PrismaticJoint() {
      b2PrismaticJoint.b2PrismaticJoint.apply(this, arguments);
      if (this.constructor === b2PrismaticJoint) this.b2PrismaticJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PrismaticJoint = b2PrismaticJoint;

   function b2PrismaticJointDef() {
      b2PrismaticJointDef.b2PrismaticJointDef.apply(this, arguments);
      if (this.constructor === b2PrismaticJointDef) this.b2PrismaticJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PrismaticJointDef = b2PrismaticJointDef;

   function b2PulleyJoint() {
      b2PulleyJoint.b2PulleyJoint.apply(this, arguments);
      if (this.constructor === b2PulleyJoint) this.b2PulleyJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PulleyJoint = b2PulleyJoint;

   function b2PulleyJointDef() {
      b2PulleyJointDef.b2PulleyJointDef.apply(this, arguments);
      if (this.constructor === b2PulleyJointDef) this.b2PulleyJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2PulleyJointDef = b2PulleyJointDef;

   function b2RevoluteJoint() {
      b2RevoluteJoint.b2RevoluteJoint.apply(this, arguments);
      if (this.constructor === b2RevoluteJoint) this.b2RevoluteJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2RevoluteJoint = b2RevoluteJoint;

   function b2RevoluteJointDef() {
      b2RevoluteJointDef.b2RevoluteJointDef.apply(this, arguments);
      if (this.constructor === b2RevoluteJointDef) this.b2RevoluteJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2RevoluteJointDef = b2RevoluteJointDef;

   function b2WeldJoint() {
      b2WeldJoint.b2WeldJoint.apply(this, arguments);
      if (this.constructor === b2WeldJoint) this.b2WeldJoint.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2WeldJoint = b2WeldJoint;

   function b2WeldJointDef() {
      b2WeldJointDef.b2WeldJointDef.apply(this, arguments);
      if (this.constructor === b2WeldJointDef) this.b2WeldJointDef.apply(this, arguments);
   };
   Box2D.Dynamics.Joints.b2WeldJointDef = b2WeldJointDef;
})(); //definitions
Box2D.postDefs = [];
(function () {
   var b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase;

   b2AABB.b2AABB = function () {
      this.lowerBound = new b2Vec2();
      this.upperBound = new b2Vec2();
   };
   b2AABB.prototype.IsValid = function () {
      var dX = this.upperBound.x - this.lowerBound.x;
      var dY = this.upperBound.y - this.lowerBound.y;
      var valid = dX >= 0.0 && dY >= 0.0;
      valid = valid && this.lowerBound.IsValid() && this.upperBound.IsValid();
      return valid;
   }
   b2AABB.prototype.GetCenter = function () {
      return new b2Vec2((this.lowerBound.x + this.upperBound.x) / 2, (this.lowerBound.y + this.upperBound.y) / 2);
   }
   b2AABB.prototype.GetExtents = function () {
      return new b2Vec2((this.upperBound.x - this.lowerBound.x) / 2, (this.upperBound.y - this.lowerBound.y) / 2);
   }
   b2AABB.prototype.Contains = function (aabb) {
      var result = true;
      result = result && this.lowerBound.x <= aabb.lowerBound.x;
      result = result && this.lowerBound.y <= aabb.lowerBound.y;
      result = result && aabb.upperBound.x <= this.upperBound.x;
      result = result && aabb.upperBound.y <= this.upperBound.y;
      return result;
   }
   b2AABB.prototype.RayCast = function (output, input) {
      var tmin = (-Number.MAX_VALUE);
      var tmax = Number.MAX_VALUE;
      var pX = input.p1.x;
      var pY = input.p1.y;
      var dX = input.p2.x - input.p1.x;
      var dY = input.p2.y - input.p1.y;
      var absDX = Math.abs(dX);
      var absDY = Math.abs(dY);
      var normal = output.normal;
      var inv_d = 0;
      var t1 = 0;
      var t2 = 0;
      var t3 = 0;
      var s = 0; {
         if (absDX < Number.MIN_VALUE) {
            if (pX < this.lowerBound.x || this.upperBound.x < pX) return false;
         }
         else {
            inv_d = 1.0 / dX;
            t1 = (this.lowerBound.x - pX) * inv_d;
            t2 = (this.upperBound.x - pX) * inv_d;
            s = (-1.0);
            if (t1 > t2) {
               t3 = t1;
               t1 = t2;
               t2 = t3;
               s = 1.0;
            }
            if (t1 > tmin) {
               normal.x = s;
               normal.y = 0;
               tmin = t1;
            }
            tmax = Math.min(tmax, t2);
            if (tmin > tmax) return false;
         }
      } {
         if (absDY < Number.MIN_VALUE) {
            if (pY < this.lowerBound.y || this.upperBound.y < pY) return false;
         }
         else {
            inv_d = 1.0 / dY;
            t1 = (this.lowerBound.y - pY) * inv_d;
            t2 = (this.upperBound.y - pY) * inv_d;
            s = (-1.0);
            if (t1 > t2) {
               t3 = t1;
               t1 = t2;
               t2 = t3;
               s = 1.0;
            }
            if (t1 > tmin) {
               normal.y = s;
               normal.x = 0;
               tmin = t1;
            }
            tmax = Math.min(tmax, t2);
            if (tmin > tmax) return false;
         }
      }
      output.fraction = tmin;
      return true;
   }
   b2AABB.prototype.TestOverlap = function (other) {
      var d1X = other.lowerBound.x - this.upperBound.x;
      var d1Y = other.lowerBound.y - this.upperBound.y;
      var d2X = this.lowerBound.x - other.upperBound.x;
      var d2Y = this.lowerBound.y - other.upperBound.y;
      if (d1X > 0.0 || d1Y > 0.0) return false;
      if (d2X > 0.0 || d2Y > 0.0) return false;
      return true;
   }
   b2AABB.Combine = function (aabb1, aabb2) {
      var aabb = new b2AABB();
      aabb.Combine(aabb1, aabb2);
      return aabb;
   }
   b2AABB.prototype.Combine = function (aabb1, aabb2) {
      this.lowerBound.x = Math.min(aabb1.lowerBound.x, aabb2.lowerBound.x);
      this.lowerBound.y = Math.min(aabb1.lowerBound.y, aabb2.lowerBound.y);
      this.upperBound.x = Math.max(aabb1.upperBound.x, aabb2.upperBound.x);
      this.upperBound.y = Math.max(aabb1.upperBound.y, aabb2.upperBound.y);
   }
   b2Bound.b2Bound = function () {};
   b2Bound.prototype.IsLower = function () {
      return (this.value & 1) == 0;
   }
   b2Bound.prototype.IsUpper = function () {
      return (this.value & 1) == 1;
   }
   b2Bound.prototype.Swap = function (b) {
      var tempValue = this.value;
      var tempProxy = this.proxy;
      var tempStabbingCount = this.stabbingCount;
      this.value = b.value;
      this.proxy = b.proxy;
      this.stabbingCount = b.stabbingCount;
      b.value = tempValue;
      b.proxy = tempProxy;
      b.stabbingCount = tempStabbingCount;
   }
   b2BoundValues.b2BoundValues = function () {};
   b2BoundValues.prototype.b2BoundValues = function () {
      this.lowerValues = new Vector_a2j_Number();
      this.lowerValues[0] = 0.0;
      this.lowerValues[1] = 0.0;
      this.upperValues = new Vector_a2j_Number();
      this.upperValues[0] = 0.0;
      this.upperValues[1] = 0.0;
   }
   b2Collision.b2Collision = function () {};
   b2Collision.ClipSegmentToLine = function (vOut, vIn, normal, offset) {
      if (offset === undefined) offset = 0;
      var cv;
      var numOut = 0;
      cv = vIn[0];
      var vIn0 = cv.v;
      cv = vIn[1];
      var vIn1 = cv.v;
      var distance0 = normal.x * vIn0.x + normal.y * vIn0.y - offset;
      var distance1 = normal.x * vIn1.x + normal.y * vIn1.y - offset;
      if (distance0 <= 0.0) vOut[numOut++].Set(vIn[0]);
      if (distance1 <= 0.0) vOut[numOut++].Set(vIn[1]);
      if (distance0 * distance1 < 0.0) {
         var interp = distance0 / (distance0 - distance1);
         cv = vOut[numOut];
         var tVec = cv.v;
         tVec.x = vIn0.x + interp * (vIn1.x - vIn0.x);
         tVec.y = vIn0.y + interp * (vIn1.y - vIn0.y);
         cv = vOut[numOut];
         var cv2;
         if (distance0 > 0.0) {
            cv2 = vIn[0];
            cv.id = cv2.id;
         }
         else {
            cv2 = vIn[1];
            cv.id = cv2.id;
         }++numOut;
      }
      return numOut;
   }
   b2Collision.EdgeSeparation = function (poly1, xf1, edge1, poly2, xf2) {
      if (edge1 === undefined) edge1 = 0;
      var count1 = parseInt(poly1.m_vertexCount);
      var vertices1 = poly1.m_vertices;
      var normals1 = poly1.m_normals;
      var count2 = parseInt(poly2.m_vertexCount);
      var vertices2 = poly2.m_vertices;
      var tMat;
      var tVec;
      tMat = xf1.R;
      tVec = normals1[edge1];
      var normal1WorldX = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var normal1WorldY = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf2.R;
      var normal1X = (tMat.col1.x * normal1WorldX + tMat.col1.y * normal1WorldY);
      var normal1Y = (tMat.col2.x * normal1WorldX + tMat.col2.y * normal1WorldY);
      var index = 0;
      var minDot = Number.MAX_VALUE;
      for (var i = 0; i < count2; ++i) {
         tVec = vertices2[i];
         var dot = tVec.x * normal1X + tVec.y * normal1Y;
         if (dot < minDot) {
            minDot = dot;
            index = i;
         }
      }
      tVec = vertices1[edge1];
      tMat = xf1.R;
      var v1X = xf1.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var v1Y = xf1.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tVec = vertices2[index];
      tMat = xf2.R;
      var v2X = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var v2Y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      v2X -= v1X;
      v2Y -= v1Y;
      var separation = v2X * normal1WorldX + v2Y * normal1WorldY;
      return separation;
   }
   b2Collision.FindMaxSeparation = function (edgeIndex, poly1, xf1, poly2, xf2) {
      var count1 = parseInt(poly1.m_vertexCount);
      var normals1 = poly1.m_normals;
      var tVec;
      var tMat;
      tMat = xf2.R;
      tVec = poly2.m_centroid;
      var dX = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var dY = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf1.R;
      tVec = poly1.m_centroid;
      dX -= xf1.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      dY -= xf1.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var dLocal1X = (dX * xf1.R.col1.x + dY * xf1.R.col1.y);
      var dLocal1Y = (dX * xf1.R.col2.x + dY * xf1.R.col2.y);
      var edge = 0;
      var maxDot = (-Number.MAX_VALUE);
      for (var i = 0; i < count1; ++i) {
         tVec = normals1[i];
         var dot = (tVec.x * dLocal1X + tVec.y * dLocal1Y);
         if (dot > maxDot) {
            maxDot = dot;
            edge = i;
         }
      }
      var s = b2Collision.EdgeSeparation(poly1, xf1, edge, poly2, xf2);
      var prevEdge = parseInt(edge - 1 >= 0 ? edge - 1 : count1 - 1);
      var sPrev = b2Collision.EdgeSeparation(poly1, xf1, prevEdge, poly2, xf2);
      var nextEdge = parseInt(edge + 1 < count1 ? edge + 1 : 0);
      var sNext = b2Collision.EdgeSeparation(poly1, xf1, nextEdge, poly2, xf2);
      var bestEdge = 0;
      var bestSeparation = 0;
      var increment = 0;
      if (sPrev > s && sPrev > sNext) {
         increment = (-1);
         bestEdge = prevEdge;
         bestSeparation = sPrev;
      }
      else if (sNext > s) {
         increment = 1;
         bestEdge = nextEdge;
         bestSeparation = sNext;
      }
      else {
         edgeIndex[0] = edge;
         return s;
      }
      while (true) {
         if (increment == (-1)) edge = bestEdge - 1 >= 0 ? bestEdge - 1 : count1 - 1;
         else edge = bestEdge + 1 < count1 ? bestEdge + 1 : 0;s = b2Collision.EdgeSeparation(poly1, xf1, edge, poly2, xf2);
         if (s > bestSeparation) {
            bestEdge = edge;
            bestSeparation = s;
         }
         else {
            break;
         }
      }
      edgeIndex[0] = bestEdge;
      return bestSeparation;
   }
   b2Collision.FindIncidentEdge = function (c, poly1, xf1, edge1, poly2, xf2) {
      if (edge1 === undefined) edge1 = 0;
      var count1 = parseInt(poly1.m_vertexCount);
      var normals1 = poly1.m_normals;
      var count2 = parseInt(poly2.m_vertexCount);
      var vertices2 = poly2.m_vertices;
      var normals2 = poly2.m_normals;
      var tMat;
      var tVec;
      tMat = xf1.R;
      tVec = normals1[edge1];
      var normal1X = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var normal1Y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf2.R;
      var tX = (tMat.col1.x * normal1X + tMat.col1.y * normal1Y);
      normal1Y = (tMat.col2.x * normal1X + tMat.col2.y * normal1Y);
      normal1X = tX;
      var index = 0;
      var minDot = Number.MAX_VALUE;
      for (var i = 0; i < count2; ++i) {
         tVec = normals2[i];
         var dot = (normal1X * tVec.x + normal1Y * tVec.y);
         if (dot < minDot) {
            minDot = dot;
            index = i;
         }
      }
      var tClip;
      var i1 = parseInt(index);
      var i2 = parseInt(i1 + 1 < count2 ? i1 + 1 : 0);
      tClip = c[0];
      tVec = vertices2[i1];
      tMat = xf2.R;
      tClip.v.x = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      tClip.v.y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tClip.id.features.referenceEdge = edge1;
      tClip.id.features.incidentEdge = i1;
      tClip.id.features.incidentVertex = 0;
      tClip = c[1];
      tVec = vertices2[i2];
      tMat = xf2.R;
      tClip.v.x = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      tClip.v.y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tClip.id.features.referenceEdge = edge1;
      tClip.id.features.incidentEdge = i2;
      tClip.id.features.incidentVertex = 1;
   }
   b2Collision.MakeClipPointVector = function () {
      var r = new Vector(2);
      r[0] = new ClipVertex();
      r[1] = new ClipVertex();
      return r;
   }
   b2Collision.CollidePolygons = function (manifold, polyA, xfA, polyB, xfB) {
      var cv;
      manifold.m_pointCount = 0;
      var totalRadius = polyA.m_radius + polyB.m_radius;
      var edgeA = 0;
      b2Collision.s_edgeAO[0] = edgeA;
      var separationA = b2Collision.FindMaxSeparation(b2Collision.s_edgeAO, polyA, xfA, polyB, xfB);
      edgeA = b2Collision.s_edgeAO[0];
      if (separationA > totalRadius) return;
      var edgeB = 0;
      b2Collision.s_edgeBO[0] = edgeB;
      var separationB = b2Collision.FindMaxSeparation(b2Collision.s_edgeBO, polyB, xfB, polyA, xfA);
      edgeB = b2Collision.s_edgeBO[0];
      if (separationB > totalRadius) return;
      var poly1;
      var poly2;
      var xf1;
      var xf2;
      var edge1 = 0;
      var flip = 0;
      var k_relativeTol = 0.98;
      var k_absoluteTol = 0.001;
      var tMat;
      if (separationB > k_relativeTol * separationA + k_absoluteTol) {
         poly1 = polyB;
         poly2 = polyA;
         xf1 = xfB;
         xf2 = xfA;
         edge1 = edgeB;
         manifold.m_type = b2Manifold.e_faceB;
         flip = 1;
      }
      else {
         poly1 = polyA;
         poly2 = polyB;
         xf1 = xfA;
         xf2 = xfB;
         edge1 = edgeA;
         manifold.m_type = b2Manifold.e_faceA;
         flip = 0;
      }
      var incidentEdge = b2Collision.s_incidentEdge;
      b2Collision.FindIncidentEdge(incidentEdge, poly1, xf1, edge1, poly2, xf2);
      var count1 = parseInt(poly1.m_vertexCount);
      var vertices1 = poly1.m_vertices;
      var local_v11 = vertices1[edge1];
      var local_v12;
      if (edge1 + 1 < count1) {
         local_v12 = vertices1[parseInt(edge1 + 1)];
      }
      else {
         local_v12 = vertices1[0];
      }
      var localTangent = b2Collision.s_localTangent;
      localTangent.Set(local_v12.x - local_v11.x, local_v12.y - local_v11.y);
      localTangent.Normalize();
      var localNormal = b2Collision.s_localNormal;
      localNormal.x = localTangent.y;
      localNormal.y = (-localTangent.x);
      var planePoint = b2Collision.s_planePoint;
      planePoint.Set(0.5 * (local_v11.x + local_v12.x), 0.5 * (local_v11.y + local_v12.y));
      var tangent = b2Collision.s_tangent;
      tMat = xf1.R;
      tangent.x = (tMat.col1.x * localTangent.x + tMat.col2.x * localTangent.y);
      tangent.y = (tMat.col1.y * localTangent.x + tMat.col2.y * localTangent.y);
      var tangent2 = b2Collision.s_tangent2;
      tangent2.x = (-tangent.x);
      tangent2.y = (-tangent.y);
      var normal = b2Collision.s_normal;
      normal.x = tangent.y;
      normal.y = (-tangent.x);
      var v11 = b2Collision.s_v11;
      var v12 = b2Collision.s_v12;
      v11.x = xf1.position.x + (tMat.col1.x * local_v11.x + tMat.col2.x * local_v11.y);
      v11.y = xf1.position.y + (tMat.col1.y * local_v11.x + tMat.col2.y * local_v11.y);
      v12.x = xf1.position.x + (tMat.col1.x * local_v12.x + tMat.col2.x * local_v12.y);
      v12.y = xf1.position.y + (tMat.col1.y * local_v12.x + tMat.col2.y * local_v12.y);
      var frontOffset = normal.x * v11.x + normal.y * v11.y;
      var sideOffset1 = (-tangent.x * v11.x) - tangent.y * v11.y + totalRadius;
      var sideOffset2 = tangent.x * v12.x + tangent.y * v12.y + totalRadius;
      var clipPoints1 = b2Collision.s_clipPoints1;
      var clipPoints2 = b2Collision.s_clipPoints2;
      var np = 0;
      np = b2Collision.ClipSegmentToLine(clipPoints1, incidentEdge, tangent2, sideOffset1);
      if (np < 2) return;
      np = b2Collision.ClipSegmentToLine(clipPoints2, clipPoints1, tangent, sideOffset2);
      if (np < 2) return;
      manifold.m_localPlaneNormal.SetV(localNormal);
      manifold.m_localPoint.SetV(planePoint);
      var pointCount = 0;
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; ++i) {
         cv = clipPoints2[i];
         var separation = normal.x * cv.v.x + normal.y * cv.v.y - frontOffset;
         if (separation <= totalRadius) {
            var cp = manifold.m_points[pointCount];
            tMat = xf2.R;
            var tX = cv.v.x - xf2.position.x;
            var tY = cv.v.y - xf2.position.y;
            cp.m_localPoint.x = (tX * tMat.col1.x + tY * tMat.col1.y);
            cp.m_localPoint.y = (tX * tMat.col2.x + tY * tMat.col2.y);
            cp.m_id.Set(cv.id);
            cp.m_id.features.flip = flip;
            ++pointCount;
         }
      }
      manifold.m_pointCount = pointCount;
   }
   b2Collision.CollideCircles = function (manifold, circle1, xf1, circle2, xf2) {
      manifold.m_pointCount = 0;
      var tMat;
      var tVec;
      tMat = xf1.R;
      tVec = circle1.m_p;
      var p1X = xf1.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var p1Y = xf1.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      tMat = xf2.R;
      tVec = circle2.m_p;
      var p2X = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var p2Y = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var distSqr = dX * dX + dY * dY;
      var radius = circle1.m_radius + circle2.m_radius;
      if (distSqr > radius * radius) {
         return;
      }
      manifold.m_type = b2Manifold.e_circles;
      manifold.m_localPoint.SetV(circle1.m_p);
      manifold.m_localPlaneNormal.SetZero();
      manifold.m_pointCount = 1;
      manifold.m_points[0].m_localPoint.SetV(circle2.m_p);
      manifold.m_points[0].m_id.key = 0;
   }
   b2Collision.CollidePolygonAndCircle = function (manifold, polygon, xf1, circle, xf2) {
      manifold.m_pointCount = 0;
      var tPoint;
      var dX = 0;
      var dY = 0;
      var positionX = 0;
      var positionY = 0;
      var tVec;
      var tMat;
      tMat = xf2.R;
      tVec = circle.m_p;
      var cX = xf2.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var cY = xf2.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      dX = cX - xf1.position.x;
      dY = cY - xf1.position.y;
      tMat = xf1.R;
      var cLocalX = (dX * tMat.col1.x + dY * tMat.col1.y);
      var cLocalY = (dX * tMat.col2.x + dY * tMat.col2.y);
      var dist = 0;
      var normalIndex = 0;
      var separation = (-Number.MAX_VALUE);
      var radius = polygon.m_radius + circle.m_radius;
      var vertexCount = parseInt(polygon.m_vertexCount);
      var vertices = polygon.m_vertices;
      var normals = polygon.m_normals;
      for (var i = 0; i < vertexCount; ++i) {
         tVec = vertices[i];
         dX = cLocalX - tVec.x;
         dY = cLocalY - tVec.y;
         tVec = normals[i];
         var s = tVec.x * dX + tVec.y * dY;
         if (s > radius) {
            return;
         }
         if (s > separation) {
            separation = s;
            normalIndex = i;
         }
      }
      var vertIndex1 = parseInt(normalIndex);
      var vertIndex2 = parseInt(vertIndex1 + 1 < vertexCount ? vertIndex1 + 1 : 0);
      var v1 = vertices[vertIndex1];
      var v2 = vertices[vertIndex2];
      if (separation < Number.MIN_VALUE) {
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.SetV(normals[normalIndex]);
         manifold.m_localPoint.x = 0.5 * (v1.x + v2.x);
         manifold.m_localPoint.y = 0.5 * (v1.y + v2.y);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
         return;
      }
      var u1 = (cLocalX - v1.x) * (v2.x - v1.x) + (cLocalY - v1.y) * (v2.y - v1.y);
      var u2 = (cLocalX - v2.x) * (v1.x - v2.x) + (cLocalY - v2.y) * (v1.y - v2.y);
      if (u1 <= 0.0) {
         if ((cLocalX - v1.x) * (cLocalX - v1.x) + (cLocalY - v1.y) * (cLocalY - v1.y) > radius * radius) return;
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.x = cLocalX - v1.x;
         manifold.m_localPlaneNormal.y = cLocalY - v1.y;
         manifold.m_localPlaneNormal.Normalize();
         manifold.m_localPoint.SetV(v1);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
      }
      else if (u2 <= 0) {
         if ((cLocalX - v2.x) * (cLocalX - v2.x) + (cLocalY - v2.y) * (cLocalY - v2.y) > radius * radius) return;
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.x = cLocalX - v2.x;
         manifold.m_localPlaneNormal.y = cLocalY - v2.y;
         manifold.m_localPlaneNormal.Normalize();
         manifold.m_localPoint.SetV(v2);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
      }
      else {
         var faceCenterX = 0.5 * (v1.x + v2.x);
         var faceCenterY = 0.5 * (v1.y + v2.y);
         separation = (cLocalX - faceCenterX) * normals[vertIndex1].x + (cLocalY - faceCenterY) * normals[vertIndex1].y;
         if (separation > radius) return;
         manifold.m_pointCount = 1;
         manifold.m_type = b2Manifold.e_faceA;
         manifold.m_localPlaneNormal.x = normals[vertIndex1].x;
         manifold.m_localPlaneNormal.y = normals[vertIndex1].y;
         manifold.m_localPlaneNormal.Normalize();
         manifold.m_localPoint.Set(faceCenterX, faceCenterY);
         manifold.m_points[0].m_localPoint.SetV(circle.m_p);
         manifold.m_points[0].m_id.key = 0;
      }
   }
   b2Collision.TestOverlap = function (a, b) {
      var t1 = b.lowerBound;
      var t2 = a.upperBound;
      var d1X = t1.x - t2.x;
      var d1Y = t1.y - t2.y;
      t1 = a.lowerBound;
      t2 = b.upperBound;
      var d2X = t1.x - t2.x;
      var d2Y = t1.y - t2.y;
      if (d1X > 0.0 || d1Y > 0.0) return false;
      if (d2X > 0.0 || d2Y > 0.0) return false;
      return true;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2Collision.s_incidentEdge = b2Collision.MakeClipPointVector();
      Box2D.Collision.b2Collision.s_clipPoints1 = b2Collision.MakeClipPointVector();
      Box2D.Collision.b2Collision.s_clipPoints2 = b2Collision.MakeClipPointVector();
      Box2D.Collision.b2Collision.s_edgeAO = new Vector_a2j_Number(1);
      Box2D.Collision.b2Collision.s_edgeBO = new Vector_a2j_Number(1);
      Box2D.Collision.b2Collision.s_localTangent = new b2Vec2();
      Box2D.Collision.b2Collision.s_localNormal = new b2Vec2();
      Box2D.Collision.b2Collision.s_planePoint = new b2Vec2();
      Box2D.Collision.b2Collision.s_normal = new b2Vec2();
      Box2D.Collision.b2Collision.s_tangent = new b2Vec2();
      Box2D.Collision.b2Collision.s_tangent2 = new b2Vec2();
      Box2D.Collision.b2Collision.s_v11 = new b2Vec2();
      Box2D.Collision.b2Collision.s_v12 = new b2Vec2();
      Box2D.Collision.b2Collision.b2CollidePolyTempVec = new b2Vec2();
      Box2D.Collision.b2Collision.b2_nullFeature = 0x000000ff;
   });
   b2ContactID.b2ContactID = function () {
      this.features = new Features();
   };
   b2ContactID.prototype.b2ContactID = function () {
      this.features._m_id = this;
   }
   b2ContactID.prototype.Set = function (id) {
      this.key = id._key;
   }
   b2ContactID.prototype.Copy = function () {
      var id = new b2ContactID();
      id.key = this.key;
      return id;
   }
   Object.defineProperty(b2ContactID.prototype, 'key', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._key;
      }
   });
   Object.defineProperty(b2ContactID.prototype, 'key', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._key = value;
         this.features._referenceEdge = this._key & 0x000000ff;
         this.features._incidentEdge = ((this._key & 0x0000ff00) >> 8) & 0x000000ff;
         this.features._incidentVertex = ((this._key & 0x00ff0000) >> 16) & 0x000000ff;
         this.features._flip = ((this._key & 0xff000000) >> 24) & 0x000000ff;
      }
   });
   b2ContactPoint.b2ContactPoint = function () {
      this.position = new b2Vec2();
      this.velocity = new b2Vec2();
      this.normal = new b2Vec2();
      this.id = new b2ContactID();
   };
   b2Distance.b2Distance = function () {};
   b2Distance.Distance = function (output, cache, input) {
      ++b2Distance.b2_gjkCalls;
      var proxyA = input.proxyA;
      var proxyB = input.proxyB;
      var transformA = input.transformA;
      var transformB = input.transformB;
      var simplex = b2Distance.s_simplex;
      simplex.ReadCache(cache, proxyA, transformA, proxyB, transformB);
      var vertices = simplex.m_vertices;
      var k_maxIters = 20;
      var saveA = b2Distance.s_saveA;
      var saveB = b2Distance.s_saveB;
      var saveCount = 0;
      var closestPoint = simplex.GetClosestPoint();
      var distanceSqr1 = closestPoint.LengthSquared();
      var distanceSqr2 = distanceSqr1;
      var i = 0;
      var p;
      var iter = 0;
      while (iter < k_maxIters) {
         saveCount = simplex.m_count;
         for (i = 0;
         i < saveCount; i++) {
            saveA[i] = vertices[i].indexA;
            saveB[i] = vertices[i].indexB;
         }
         switch (simplex.m_count) {
         case 1:
            break;
         case 2:
            simplex.Solve2();
            break;
         case 3:
            simplex.Solve3();
            break;
         default:
            b2Settings.b2Assert(false);
         }
         if (simplex.m_count == 3) {
            break;
         }
         p = simplex.GetClosestPoint();
         distanceSqr2 = p.LengthSquared();
         if (distanceSqr2 > distanceSqr1) {}
         distanceSqr1 = distanceSqr2;
         var d = simplex.GetSearchDirection();
         if (d.LengthSquared() < Number.MIN_VALUE * Number.MIN_VALUE) {
            break;
         }
         var vertex = vertices[simplex.m_count];
         vertex.indexA = proxyA.GetSupport(b2Math.MulTMV(transformA.R, d.GetNegative()));
         vertex.wA = b2Math.MulX(transformA, proxyA.GetVertex(vertex.indexA));
         vertex.indexB = proxyB.GetSupport(b2Math.MulTMV(transformB.R, d));
         vertex.wB = b2Math.MulX(transformB, proxyB.GetVertex(vertex.indexB));
         vertex.w = b2Math.SubtractVV(vertex.wB, vertex.wA);
         ++iter;
         ++b2Distance.b2_gjkIters;
         var duplicate = false;
         for (i = 0;
         i < saveCount; i++) {
            if (vertex.indexA == saveA[i] && vertex.indexB == saveB[i]) {
               duplicate = true;
               break;
            }
         }
         if (duplicate) {
            break;
         }++simplex.m_count;
      }
      b2Distance.b2_gjkMaxIters = b2Math.Max(b2Distance.b2_gjkMaxIters, iter);
      simplex.GetWitnessPoints(output.pointA, output.pointB);
      output.distance = b2Math.SubtractVV(output.pointA, output.pointB).Length();
      output.iterations = iter;
      simplex.WriteCache(cache);
      if (input.useRadii) {
         var rA = proxyA.m_radius;
         var rB = proxyB.m_radius;
         if (output.distance > rA + rB && output.distance > Number.MIN_VALUE) {
            output.distance -= rA + rB;
            var normal = b2Math.SubtractVV(output.pointB, output.pointA);
            normal.Normalize();
            output.pointA.x += rA * normal.x;
            output.pointA.y += rA * normal.y;
            output.pointB.x -= rB * normal.x;
            output.pointB.y -= rB * normal.y;
         }
         else {
            p = new b2Vec2();
            p.x = .5 * (output.pointA.x + output.pointB.x);
            p.y = .5 * (output.pointA.y + output.pointB.y);
            output.pointA.x = output.pointB.x = p.x;
            output.pointA.y = output.pointB.y = p.y;
            output.distance = 0.0;
         }
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2Distance.s_simplex = new b2Simplex();
      Box2D.Collision.b2Distance.s_saveA = new Vector_a2j_Number(3);
      Box2D.Collision.b2Distance.s_saveB = new Vector_a2j_Number(3);
   });
   b2DistanceInput.b2DistanceInput = function () {};
   b2DistanceOutput.b2DistanceOutput = function () {
      this.pointA = new b2Vec2();
      this.pointB = new b2Vec2();
   };
   b2DistanceProxy.b2DistanceProxy = function () {};
   b2DistanceProxy.prototype.Set = function (shape) {
      switch (shape.GetType()) {
      case b2Shape.e_circleShape:
         {
            var circle = (shape instanceof b2CircleShape ? shape : null);
            this.m_vertices = new Vector(1, true);
            this.m_vertices[0] = circle.m_p;
            this.m_count = 1;
            this.m_radius = circle.m_radius;
         }
         break;
      case b2Shape.e_polygonShape:
         {
            var polygon = (shape instanceof b2PolygonShape ? shape : null);
            this.m_vertices = polygon.m_vertices;
            this.m_count = polygon.m_vertexCount;
            this.m_radius = polygon.m_radius;
         }
         break;
      default:
         b2Settings.b2Assert(false);
      }
   }
   b2DistanceProxy.prototype.GetSupport = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_count; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return bestIndex;
   }
   b2DistanceProxy.prototype.GetSupportVertex = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_count; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return this.m_vertices[bestIndex];
   }
   b2DistanceProxy.prototype.GetVertexCount = function () {
      return this.m_count;
   }
   b2DistanceProxy.prototype.GetVertex = function (index) {
      if (index === undefined) index = 0;
      b2Settings.b2Assert(0 <= index && index < this.m_count);
      return this.m_vertices[index];
   }
   b2DynamicTree.b2DynamicTree = function () {};
   b2DynamicTree.prototype.b2DynamicTree = function () {
      this.m_root = null;
      this.m_freeList = null;
      this.m_path = 0;
      this.m_insertionCount = 0;
   }
   b2DynamicTree.prototype.CreateProxy = function (aabb, userData) {
      var node = this.AllocateNode();
      var extendX = b2Settings.b2_aabbExtension;
      var extendY = b2Settings.b2_aabbExtension;
      node.aabb.lowerBound.x = aabb.lowerBound.x - extendX;
      node.aabb.lowerBound.y = aabb.lowerBound.y - extendY;
      node.aabb.upperBound.x = aabb.upperBound.x + extendX;
      node.aabb.upperBound.y = aabb.upperBound.y + extendY;
      node.userData = userData;
      this.InsertLeaf(node);
      return node;
   }
   b2DynamicTree.prototype.DestroyProxy = function (proxy) {
      this.RemoveLeaf(proxy);
      this.FreeNode(proxy);
   }
   b2DynamicTree.prototype.MoveProxy = function (proxy, aabb, displacement) {
      b2Settings.b2Assert(proxy.IsLeaf());
      if (proxy.aabb.Contains(aabb)) {
         return false;
      }
      this.RemoveLeaf(proxy);
      var extendX = b2Settings.b2_aabbExtension + b2Settings.b2_aabbMultiplier * (displacement.x > 0 ? displacement.x : (-displacement.x));
      var extendY = b2Settings.b2_aabbExtension + b2Settings.b2_aabbMultiplier * (displacement.y > 0 ? displacement.y : (-displacement.y));
      proxy.aabb.lowerBound.x = aabb.lowerBound.x - extendX;
      proxy.aabb.lowerBound.y = aabb.lowerBound.y - extendY;
      proxy.aabb.upperBound.x = aabb.upperBound.x + extendX;
      proxy.aabb.upperBound.y = aabb.upperBound.y + extendY;
      this.InsertLeaf(proxy);
      return true;
   }
   b2DynamicTree.prototype.Rebalance = function (iterations) {
      if (iterations === undefined) iterations = 0;
      if (this.m_root == null) return;
      for (var i = 0; i < iterations; i++) {
         var node = this.m_root;
         var bit = 0;
         while (node.IsLeaf() == false) {
            node = (this.m_path >> bit) & 1 ? node.child2 : node.child1;
            bit = (bit + 1) & 31;
         }++this.m_path;
         this.RemoveLeaf(node);
         this.InsertLeaf(node);
      }
   }
   b2DynamicTree.prototype.GetFatAABB = function (proxy) {
      return proxy.aabb;
   }
   b2DynamicTree.prototype.GetUserData = function (proxy) {
      return proxy.userData;
   }
   b2DynamicTree.prototype.Query = function (callback, aabb) {
      if (this.m_root == null) return;
      var stack = new Vector();
      var count = 0;
      stack[count++] = this.m_root;
      while (count > 0) {
         var node = stack[--count];
         if (node.aabb.TestOverlap(aabb)) {
            if (node.IsLeaf()) {
               var proceed = callback(node);
               if (!proceed) return;
            }
            else {
               stack[count++] = node.child1;
               stack[count++] = node.child2;
            }
         }
      }
   }
   b2DynamicTree.prototype.RayCast = function (callback, input) {
      if (this.m_root == null) return;
      var p1 = input.p1;
      var p2 = input.p2;
      var r = b2Math.SubtractVV(p1, p2);
      r.Normalize();
      var v = b2Math.CrossFV(1.0, r);
      var abs_v = b2Math.AbsV(v);
      var maxFraction = input.maxFraction;
      var segmentAABB = new b2AABB();
      var tX = 0;
      var tY = 0; {
         tX = p1.x + maxFraction * (p2.x - p1.x);
         tY = p1.y + maxFraction * (p2.y - p1.y);
         segmentAABB.lowerBound.x = Math.min(p1.x, tX);
         segmentAABB.lowerBound.y = Math.min(p1.y, tY);
         segmentAABB.upperBound.x = Math.max(p1.x, tX);
         segmentAABB.upperBound.y = Math.max(p1.y, tY);
      }
      var stack = new Vector();
      var count = 0;
      stack[count++] = this.m_root;
      while (count > 0) {
         var node = stack[--count];
         if (node.aabb.TestOverlap(segmentAABB) == false) {
            continue;
         }
         var c = node.aabb.GetCenter();
         var h = node.aabb.GetExtents();
         var separation = Math.abs(v.x * (p1.x - c.x) + v.y * (p1.y - c.y)) - abs_v.x * h.x - abs_v.y * h.y;
         if (separation > 0.0) continue;
         if (node.IsLeaf()) {
            var subInput = new b2RayCastInput();
            subInput.p1 = input.p1;
            subInput.p2 = input.p2;
            subInput.maxFraction = input.maxFraction;
            maxFraction = callback(subInput, node);
            if (maxFraction == 0.0) return;
            if (maxFraction > 0.0) {
               tX = p1.x + maxFraction * (p2.x - p1.x);
               tY = p1.y + maxFraction * (p2.y - p1.y);
               segmentAABB.lowerBound.x = Math.min(p1.x, tX);
               segmentAABB.lowerBound.y = Math.min(p1.y, tY);
               segmentAABB.upperBound.x = Math.max(p1.x, tX);
               segmentAABB.upperBound.y = Math.max(p1.y, tY);
            }
         }
         else {
            stack[count++] = node.child1;
            stack[count++] = node.child2;
         }
      }
   }
   b2DynamicTree.prototype.AllocateNode = function () {
      if (this.m_freeList) {
         var node = this.m_freeList;
         this.m_freeList = node.parent;
         node.parent = null;
         node.child1 = null;
         node.child2 = null;
         return node;
      }
      return new b2DynamicTreeNode();
   }
   b2DynamicTree.prototype.FreeNode = function (node) {
      node.parent = this.m_freeList;
      this.m_freeList = node;
   }
   b2DynamicTree.prototype.InsertLeaf = function (leaf) {
      ++this.m_insertionCount;
      if (this.m_root == null) {
         this.m_root = leaf;
         this.m_root.parent = null;
         return;
      }
      var center = leaf.aabb.GetCenter();
      var sibling = this.m_root;
      if (sibling.IsLeaf() == false) {
         do {
            var child1 = sibling.child1;
            var child2 = sibling.child2;
            var norm1 = Math.abs((child1.aabb.lowerBound.x + child1.aabb.upperBound.x) / 2 - center.x) + Math.abs((child1.aabb.lowerBound.y + child1.aabb.upperBound.y) / 2 - center.y);
            var norm2 = Math.abs((child2.aabb.lowerBound.x + child2.aabb.upperBound.x) / 2 - center.x) + Math.abs((child2.aabb.lowerBound.y + child2.aabb.upperBound.y) / 2 - center.y);
            if (norm1 < norm2) {
               sibling = child1;
            }
            else {
               sibling = child2;
            }
         }
         while (sibling.IsLeaf() == false)
      }
      var node1 = sibling.parent;
      var node2 = this.AllocateNode();
      node2.parent = node1;
      node2.userData = null;
      node2.aabb.Combine(leaf.aabb, sibling.aabb);
      if (node1) {
         if (sibling.parent.child1 == sibling) {
            node1.child1 = node2;
         }
         else {
            node1.child2 = node2;
         }
         node2.child1 = sibling;
         node2.child2 = leaf;
         sibling.parent = node2;
         leaf.parent = node2;
         do {
            if (node1.aabb.Contains(node2.aabb)) break;
            node1.aabb.Combine(node1.child1.aabb, node1.child2.aabb);
            node2 = node1;
            node1 = node1.parent;
         }
         while (node1)
      }
      else {
         node2.child1 = sibling;
         node2.child2 = leaf;
         sibling.parent = node2;
         leaf.parent = node2;
         this.m_root = node2;
      }
   }
   b2DynamicTree.prototype.RemoveLeaf = function (leaf) {
      if (leaf == this.m_root) {
         this.m_root = null;
         return;
      }
      var node2 = leaf.parent;
      var node1 = node2.parent;
      var sibling;
      if (node2.child1 == leaf) {
         sibling = node2.child2;
      }
      else {
         sibling = node2.child1;
      }
      if (node1) {
         if (node1.child1 == node2) {
            node1.child1 = sibling;
         }
         else {
            node1.child2 = sibling;
         }
         sibling.parent = node1;
         this.FreeNode(node2);
         while (node1) {
            var oldAABB = node1.aabb;
            node1.aabb = b2AABB.Combine(node1.child1.aabb, node1.child2.aabb);
            if (oldAABB.Contains(node1.aabb)) break;
            node1 = node1.parent;
         }
      }
      else {
         this.m_root = sibling;
         sibling.parent = null;
         this.FreeNode(node2);
      }
   }
   b2DynamicTreeBroadPhase.b2DynamicTreeBroadPhase = function () {
      this.m_tree = new b2DynamicTree();
      this.m_moveBuffer = new Vector();
      this.m_pairBuffer = new Vector();
      this.m_pairCount = 0;
   };
   b2DynamicTreeBroadPhase.prototype.CreateProxy = function (aabb, userData) {
      var proxy = this.m_tree.CreateProxy(aabb, userData);
      ++this.m_proxyCount;
      this.BufferMove(proxy);
      return proxy;
   }
   b2DynamicTreeBroadPhase.prototype.DestroyProxy = function (proxy) {
      this.UnBufferMove(proxy);
      --this.m_proxyCount;
      this.m_tree.DestroyProxy(proxy);
   }
   b2DynamicTreeBroadPhase.prototype.MoveProxy = function (proxy, aabb, displacement) {
      var buffer = this.m_tree.MoveProxy(proxy, aabb, displacement);
      if (buffer) {
         this.BufferMove(proxy);
      }
   }
   b2DynamicTreeBroadPhase.prototype.TestOverlap = function (proxyA, proxyB) {
      var aabbA = this.m_tree.GetFatAABB(proxyA);
      var aabbB = this.m_tree.GetFatAABB(proxyB);
      return aabbA.TestOverlap(aabbB);
   }
   b2DynamicTreeBroadPhase.prototype.GetUserData = function (proxy) {
      return this.m_tree.GetUserData(proxy);
   }
   b2DynamicTreeBroadPhase.prototype.GetFatAABB = function (proxy) {
      return this.m_tree.GetFatAABB(proxy);
   }
   b2DynamicTreeBroadPhase.prototype.GetProxyCount = function () {
      return this.m_proxyCount;
   }
   b2DynamicTreeBroadPhase.prototype.UpdatePairs = function (callback) {
      var __this = this;
      __this.m_pairCount = 0;
      var i = 0,
         queryProxy;
       function QueryCallback(proxy) {
          if (proxy == queryProxy) return true;
          if (__this.m_pairCount == __this.m_pairBuffer.length) {
             __this.m_pairBuffer[__this.m_pairCount] = new b2DynamicTreePair();
          }
          var pair = __this.m_pairBuffer[__this.m_pairCount];
          pair.proxyA = proxy < queryProxy ? proxy : queryProxy;
          pair.proxyB = proxy >= queryProxy ? proxy : queryProxy;++__this.m_pairCount;
          return true;
       };
      for (i = 0;
      i < __this.m_moveBuffer.length; ++i) {
         queryProxy = __this.m_moveBuffer[i];
         var fatAABB = __this.m_tree.GetFatAABB(queryProxy);
         __this.m_tree.Query(QueryCallback, fatAABB);
      }
      __this.m_moveBuffer.length = 0;
      for (var i = 0; i < __this.m_pairCount;) {
         var primaryPair = __this.m_pairBuffer[i];
         var userDataA = __this.m_tree.GetUserData(primaryPair.proxyA);
         var userDataB = __this.m_tree.GetUserData(primaryPair.proxyB);
         callback(userDataA, userDataB);
         ++i;
         while (i < __this.m_pairCount) {
            var pair = __this.m_pairBuffer[i];
            if (pair.proxyA != primaryPair.proxyA || pair.proxyB != primaryPair.proxyB) {
               break;
            }++i;
         }
      }
   }
   b2DynamicTreeBroadPhase.prototype.Query = function (callback, aabb) {
      this.m_tree.Query(callback, aabb);
   }
   b2DynamicTreeBroadPhase.prototype.RayCast = function (callback, input) {
      this.m_tree.RayCast(callback, input);
   }
   b2DynamicTreeBroadPhase.prototype.Validate = function () {}
   b2DynamicTreeBroadPhase.prototype.Rebalance = function (iterations) {
      if (iterations === undefined) iterations = 0;
      this.m_tree.Rebalance(iterations);
   }
   b2DynamicTreeBroadPhase.prototype.BufferMove = function (proxy) {
      this.m_moveBuffer[this.m_moveBuffer.length] = proxy;
   }
   b2DynamicTreeBroadPhase.prototype.UnBufferMove = function (proxy) {
      var i = parseInt(this.m_moveBuffer.indexOf(proxy));
      this.m_moveBuffer.splice(i, 1);
   }
   b2DynamicTreeBroadPhase.prototype.ComparePairs = function (pair1, pair2) {
      return 0;
   }
   b2DynamicTreeBroadPhase.__implements = {};
   b2DynamicTreeBroadPhase.__implements[IBroadPhase] = true;
   b2DynamicTreeNode.b2DynamicTreeNode = function () {
      this.aabb = new b2AABB();
   };
   b2DynamicTreeNode.prototype.IsLeaf = function () {
      return this.child1 == null;
   }
   b2DynamicTreePair.b2DynamicTreePair = function () {};
   b2Manifold.b2Manifold = function () {
      this.m_pointCount = 0;
   };
   b2Manifold.prototype.b2Manifold = function () {
      this.m_points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.m_points[i] = new b2ManifoldPoint();
      }
      this.m_localPlaneNormal = new b2Vec2();
      this.m_localPoint = new b2Vec2();
   }
   b2Manifold.prototype.Reset = function () {
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         ((this.m_points[i] instanceof b2ManifoldPoint ? this.m_points[i] : null)).Reset();
      }
      this.m_localPlaneNormal.SetZero();
      this.m_localPoint.SetZero();
      this.m_type = 0;
      this.m_pointCount = 0;
   }
   b2Manifold.prototype.Set = function (m) {
      this.m_pointCount = m.m_pointCount;
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         ((this.m_points[i] instanceof b2ManifoldPoint ? this.m_points[i] : null)).Set(m.m_points[i]);
      }
      this.m_localPlaneNormal.SetV(m.m_localPlaneNormal);
      this.m_localPoint.SetV(m.m_localPoint);
      this.m_type = m.m_type;
   }
   b2Manifold.prototype.Copy = function () {
      var copy = new b2Manifold();
      copy.Set(this);
      return copy;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2Manifold.e_circles = 0x0001;
      Box2D.Collision.b2Manifold.e_faceA = 0x0002;
      Box2D.Collision.b2Manifold.e_faceB = 0x0004;
   });
   b2ManifoldPoint.b2ManifoldPoint = function () {
      this.m_localPoint = new b2Vec2();
      this.m_id = new b2ContactID();
   };
   b2ManifoldPoint.prototype.b2ManifoldPoint = function () {
      this.Reset();
   }
   b2ManifoldPoint.prototype.Reset = function () {
      this.m_localPoint.SetZero();
      this.m_normalImpulse = 0.0;
      this.m_tangentImpulse = 0.0;
      this.m_id.key = 0;
   }
   b2ManifoldPoint.prototype.Set = function (m) {
      this.m_localPoint.SetV(m.m_localPoint);
      this.m_normalImpulse = m.m_normalImpulse;
      this.m_tangentImpulse = m.m_tangentImpulse;
      this.m_id.Set(m.m_id);
   }
   b2Point.b2Point = function () {
      this.p = new b2Vec2();
   };
   b2Point.prototype.Support = function (xf, vX, vY) {
      if (vX === undefined) vX = 0;
      if (vY === undefined) vY = 0;
      return this.p;
   }
   b2Point.prototype.GetFirstVertex = function (xf) {
      return this.p;
   }
   b2RayCastInput.b2RayCastInput = function () {
      this.p1 = new b2Vec2();
      this.p2 = new b2Vec2();
   };
   b2RayCastInput.prototype.b2RayCastInput = function (p1, p2, maxFraction) {
      if (p1 === undefined) p1 = null;
      if (p2 === undefined) p2 = null;
      if (maxFraction === undefined) maxFraction = 1;
      if (p1) this.p1.SetV(p1);
      if (p2) this.p2.SetV(p2);
      this.maxFraction = maxFraction;
   }
   b2RayCastOutput.b2RayCastOutput = function () {
      this.normal = new b2Vec2();
   };
   b2Segment.b2Segment = function () {
      this.p1 = new b2Vec2();
      this.p2 = new b2Vec2();
   };
   b2Segment.prototype.TestSegment = function (lambda, normal, segment, maxLambda) {
      if (maxLambda === undefined) maxLambda = 0;
      var s = segment.p1;
      var rX = segment.p2.x - s.x;
      var rY = segment.p2.y - s.y;
      var dX = this.p2.x - this.p1.x;
      var dY = this.p2.y - this.p1.y;
      var nX = dY;
      var nY = (-dX);
      var k_slop = 100.0 * Number.MIN_VALUE;
      var denom = (-(rX * nX + rY * nY));
      if (denom > k_slop) {
         var bX = s.x - this.p1.x;
         var bY = s.y - this.p1.y;
         var a = (bX * nX + bY * nY);
         if (0.0 <= a && a <= maxLambda * denom) {
            var mu2 = (-rX * bY) + rY * bX;
            if ((-k_slop * denom) <= mu2 && mu2 <= denom * (1.0 + k_slop)) {
               a /= denom;
               var nLen = Math.sqrt(nX * nX + nY * nY);
               nX /= nLen;
               nY /= nLen;
               lambda[0] = a;
               normal.Set(nX, nY);
               return true;
            }
         }
      }
      return false;
   }
   b2Segment.prototype.Extend = function (aabb) {
      this.ExtendForward(aabb);
      this.ExtendBackward(aabb);
   }
   b2Segment.prototype.ExtendForward = function (aabb) {
      var dX = this.p2.x - this.p1.x;
      var dY = this.p2.y - this.p1.y;
      var lambda = Math.min(dX > 0 ? (aabb.upperBound.x - this.p1.x) / dX : dX < 0 ? (aabb.lowerBound.x - this.p1.x) / dX : Number.POSITIVE_INFINITY,
      dY > 0 ? (aabb.upperBound.y - this.p1.y) / dY : dY < 0 ? (aabb.lowerBound.y - this.p1.y) / dY : Number.POSITIVE_INFINITY);
      this.p2.x = this.p1.x + dX * lambda;
      this.p2.y = this.p1.y + dY * lambda;
   }
   b2Segment.prototype.ExtendBackward = function (aabb) {
      var dX = (-this.p2.x) + this.p1.x;
      var dY = (-this.p2.y) + this.p1.y;
      var lambda = Math.min(dX > 0 ? (aabb.upperBound.x - this.p2.x) / dX : dX < 0 ? (aabb.lowerBound.x - this.p2.x) / dX : Number.POSITIVE_INFINITY,
      dY > 0 ? (aabb.upperBound.y - this.p2.y) / dY : dY < 0 ? (aabb.lowerBound.y - this.p2.y) / dY : Number.POSITIVE_INFINITY);
      this.p1.x = this.p2.x + dX * lambda;
      this.p1.y = this.p2.y + dY * lambda;
   }
   b2SeparationFunction.b2SeparationFunction = function () {
      this.m_localPoint = new b2Vec2();
      this.m_axis = new b2Vec2();
   };
   b2SeparationFunction.prototype.Initialize = function (cache, proxyA, transformA, proxyB, transformB) {
      this.m_proxyA = proxyA;
      this.m_proxyB = proxyB;
      var count = parseInt(cache.count);
      b2Settings.b2Assert(0 < count && count < 3);
      var localPointA;
      var localPointA1;
      var localPointA2;
      var localPointB;
      var localPointB1;
      var localPointB2;
      var pointAX = 0;
      var pointAY = 0;
      var pointBX = 0;
      var pointBY = 0;
      var normalX = 0;
      var normalY = 0;
      var tMat;
      var tVec;
      var s = 0;
      var sgn = 0;
      if (count == 1) {
         this.m_type = b2SeparationFunction.e_points;
         localPointA = this.m_proxyA.GetVertex(cache.indexA[0]);
         localPointB = this.m_proxyB.GetVertex(cache.indexB[0]);
         tVec = localPointA;
         tMat = transformA.R;
         pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         tVec = localPointB;
         tMat = transformB.R;
         pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         this.m_axis.x = pointBX - pointAX;
         this.m_axis.y = pointBY - pointAY;
         this.m_axis.Normalize();
      }
      else if (cache.indexB[0] == cache.indexB[1]) {
         this.m_type = b2SeparationFunction.e_faceA;
         localPointA1 = this.m_proxyA.GetVertex(cache.indexA[0]);
         localPointA2 = this.m_proxyA.GetVertex(cache.indexA[1]);
         localPointB = this.m_proxyB.GetVertex(cache.indexB[0]);
         this.m_localPoint.x = 0.5 * (localPointA1.x + localPointA2.x);
         this.m_localPoint.y = 0.5 * (localPointA1.y + localPointA2.y);
         this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointA2, localPointA1), 1.0);
         this.m_axis.Normalize();
         tVec = this.m_axis;
         tMat = transformA.R;
         normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tVec = this.m_localPoint;
         tMat = transformA.R;
         pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         tVec = localPointB;
         tMat = transformB.R;
         pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         s = (pointBX - pointAX) * normalX + (pointBY - pointAY) * normalY;
         if (s < 0.0) {
            this.m_axis.NegativeSelf();
         }
      }
      else if (cache.indexA[0] == cache.indexA[0]) {
         this.m_type = b2SeparationFunction.e_faceB;
         localPointB1 = this.m_proxyB.GetVertex(cache.indexB[0]);
         localPointB2 = this.m_proxyB.GetVertex(cache.indexB[1]);
         localPointA = this.m_proxyA.GetVertex(cache.indexA[0]);
         this.m_localPoint.x = 0.5 * (localPointB1.x + localPointB2.x);
         this.m_localPoint.y = 0.5 * (localPointB1.y + localPointB2.y);
         this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointB2, localPointB1), 1.0);
         this.m_axis.Normalize();
         tVec = this.m_axis;
         tMat = transformB.R;
         normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tVec = this.m_localPoint;
         tMat = transformB.R;
         pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         tVec = localPointA;
         tMat = transformA.R;
         pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         s = (pointAX - pointBX) * normalX + (pointAY - pointBY) * normalY;
         if (s < 0.0) {
            this.m_axis.NegativeSelf();
         }
      }
      else {
         localPointA1 = this.m_proxyA.GetVertex(cache.indexA[0]);
         localPointA2 = this.m_proxyA.GetVertex(cache.indexA[1]);
         localPointB1 = this.m_proxyB.GetVertex(cache.indexB[0]);
         localPointB2 = this.m_proxyB.GetVertex(cache.indexB[1]);
         var pA = b2Math.MulX(transformA, localPointA);
         var dA = b2Math.MulMV(transformA.R, b2Math.SubtractVV(localPointA2, localPointA1));
         var pB = b2Math.MulX(transformB, localPointB);
         var dB = b2Math.MulMV(transformB.R, b2Math.SubtractVV(localPointB2, localPointB1));
         var a = dA.x * dA.x + dA.y * dA.y;
         var e = dB.x * dB.x + dB.y * dB.y;
         var r = b2Math.SubtractVV(dB, dA);
         var c = dA.x * r.x + dA.y * r.y;
         var f = dB.x * r.x + dB.y * r.y;
         var b = dA.x * dB.x + dA.y * dB.y;
         var denom = a * e - b * b;
         s = 0.0;
         if (denom != 0.0) {
            s = b2Math.Clamp((b * f - c * e) / denom, 0.0, 1.0);
         }
         var t = (b * s + f) / e;
         if (t < 0.0) {
            t = 0.0;
            s = b2Math.Clamp((b - c) / a, 0.0, 1.0);
         }
         localPointA = new b2Vec2();
         localPointA.x = localPointA1.x + s * (localPointA2.x - localPointA1.x);
         localPointA.y = localPointA1.y + s * (localPointA2.y - localPointA1.y);
         localPointB = new b2Vec2();
         localPointB.x = localPointB1.x + s * (localPointB2.x - localPointB1.x);
         localPointB.y = localPointB1.y + s * (localPointB2.y - localPointB1.y);
         if (s == 0.0 || s == 1.0) {
            this.m_type = b2SeparationFunction.e_faceB;
            this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointB2, localPointB1), 1.0);
            this.m_axis.Normalize();
            this.m_localPoint = localPointB;
            tVec = this.m_axis;
            tMat = transformB.R;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tVec = this.m_localPoint;
            tMat = transformB.R;
            pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tVec = localPointA;
            tMat = transformA.R;
            pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            sgn = (pointAX - pointBX) * normalX + (pointAY - pointBY) * normalY;
            if (s < 0.0) {
               this.m_axis.NegativeSelf();
            }
         }
         else {
            this.m_type = b2SeparationFunction.e_faceA;
            this.m_axis = b2Math.CrossVF(b2Math.SubtractVV(localPointA2, localPointA1), 1.0);
            this.m_localPoint = localPointA;
            tVec = this.m_axis;
            tMat = transformA.R;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tVec = this.m_localPoint;
            tMat = transformA.R;
            pointAX = transformA.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointAY = transformA.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tVec = localPointB;
            tMat = transformB.R;
            pointBX = transformB.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            pointBY = transformB.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            sgn = (pointBX - pointAX) * normalX + (pointBY - pointAY) * normalY;
            if (s < 0.0) {
               this.m_axis.NegativeSelf();
            }
         }
      }
   }
   b2SeparationFunction.prototype.Evaluate = function (transformA, transformB) {
      var axisA;
      var axisB;
      var localPointA;
      var localPointB;
      var pointA;
      var pointB;
      var seperation = 0;
      var normal;
      switch (this.m_type) {
      case b2SeparationFunction.e_points:
         {
            axisA = b2Math.MulTMV(transformA.R, this.m_axis);
            axisB = b2Math.MulTMV(transformB.R, this.m_axis.GetNegative());
            localPointA = this.m_proxyA.GetSupportVertex(axisA);
            localPointB = this.m_proxyB.GetSupportVertex(axisB);
            pointA = b2Math.MulX(transformA, localPointA);
            pointB = b2Math.MulX(transformB, localPointB);
            seperation = (pointB.x - pointA.x) * this.m_axis.x + (pointB.y - pointA.y) * this.m_axis.y;
            return seperation;
         }
      case b2SeparationFunction.e_faceA:
         {
            normal = b2Math.MulMV(transformA.R, this.m_axis);
            pointA = b2Math.MulX(transformA, this.m_localPoint);
            axisB = b2Math.MulTMV(transformB.R, normal.GetNegative());
            localPointB = this.m_proxyB.GetSupportVertex(axisB);
            pointB = b2Math.MulX(transformB, localPointB);
            seperation = (pointB.x - pointA.x) * normal.x + (pointB.y - pointA.y) * normal.y;
            return seperation;
         }
      case b2SeparationFunction.e_faceB:
         {
            normal = b2Math.MulMV(transformB.R, this.m_axis);
            pointB = b2Math.MulX(transformB, this.m_localPoint);
            axisA = b2Math.MulTMV(transformA.R, normal.GetNegative());
            localPointA = this.m_proxyA.GetSupportVertex(axisA);
            pointA = b2Math.MulX(transformA, localPointA);
            seperation = (pointA.x - pointB.x) * normal.x + (pointA.y - pointB.y) * normal.y;
            return seperation;
         }
      default:
         b2Settings.b2Assert(false);
         return 0.0;
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2SeparationFunction.e_points = 0x01;
      Box2D.Collision.b2SeparationFunction.e_faceA = 0x02;
      Box2D.Collision.b2SeparationFunction.e_faceB = 0x04;
   });
   b2Simplex.b2Simplex = function () {
      this.m_v1 = new b2SimplexVertex();
      this.m_v2 = new b2SimplexVertex();
      this.m_v3 = new b2SimplexVertex();
      this.m_vertices = new Vector(3);
   };
   b2Simplex.prototype.b2Simplex = function () {
      this.m_vertices[0] = this.m_v1;
      this.m_vertices[1] = this.m_v2;
      this.m_vertices[2] = this.m_v3;
   }
   b2Simplex.prototype.ReadCache = function (cache, proxyA, transformA, proxyB, transformB) {
      b2Settings.b2Assert(0 <= cache.count && cache.count <= 3);
      var wALocal;
      var wBLocal;
      this.m_count = cache.count;
      var vertices = this.m_vertices;
      for (var i = 0; i < this.m_count; i++) {
         var v = vertices[i];
         v.indexA = cache.indexA[i];
         v.indexB = cache.indexB[i];
         wALocal = proxyA.GetVertex(v.indexA);
         wBLocal = proxyB.GetVertex(v.indexB);
         v.wA = b2Math.MulX(transformA, wALocal);
         v.wB = b2Math.MulX(transformB, wBLocal);
         v.w = b2Math.SubtractVV(v.wB, v.wA);
         v.a = 0;
      }
      if (this.m_count > 1) {
         var metric1 = cache.metric;
         var metric2 = this.GetMetric();
         if (metric2 < .5 * metric1 || 2.0 * metric1 < metric2 || metric2 < Number.MIN_VALUE) {
            this.m_count = 0;
         }
      }
      if (this.m_count == 0) {
         v = vertices[0];
         v.indexA = 0;
         v.indexB = 0;
         wALocal = proxyA.GetVertex(0);
         wBLocal = proxyB.GetVertex(0);
         v.wA = b2Math.MulX(transformA, wALocal);
         v.wB = b2Math.MulX(transformB, wBLocal);
         v.w = b2Math.SubtractVV(v.wB, v.wA);
         this.m_count = 1;
      }
   }
   b2Simplex.prototype.WriteCache = function (cache) {
      cache.metric = this.GetMetric();
      cache.count = Box2D.parseUInt(this.m_count);
      var vertices = this.m_vertices;
      for (var i = 0; i < this.m_count; i++) {
         cache.indexA[i] = Box2D.parseUInt(vertices[i].indexA);
         cache.indexB[i] = Box2D.parseUInt(vertices[i].indexB);
      }
   }
   b2Simplex.prototype.GetSearchDirection = function () {
      switch (this.m_count) {
      case 1:
         return this.m_v1.w.GetNegative();
      case 2:
         {
            var e12 = b2Math.SubtractVV(this.m_v2.w, this.m_v1.w);
            var sgn = b2Math.CrossVV(e12, this.m_v1.w.GetNegative());
            if (sgn > 0.0) {
               return b2Math.CrossFV(1.0, e12);
            }
            else {
               return b2Math.CrossVF(e12, 1.0);
            }
         }
      default:
         b2Settings.b2Assert(false);
         return new b2Vec2();
      }
   }
   b2Simplex.prototype.GetClosestPoint = function () {
      switch (this.m_count) {
      case 0:
         b2Settings.b2Assert(false);
         return new b2Vec2();
      case 1:
         return this.m_v1.w;
      case 2:
         return new b2Vec2(this.m_v1.a * this.m_v1.w.x + this.m_v2.a * this.m_v2.w.x, this.m_v1.a * this.m_v1.w.y + this.m_v2.a * this.m_v2.w.y);
      default:
         b2Settings.b2Assert(false);
         return new b2Vec2();
      }
   }
   b2Simplex.prototype.GetWitnessPoints = function (pA, pB) {
      switch (this.m_count) {
      case 0:
         b2Settings.b2Assert(false);
         break;
      case 1:
         pA.SetV(this.m_v1.wA);
         pB.SetV(this.m_v1.wB);
         break;
      case 2:
         pA.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x;
         pA.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y;
         pB.x = this.m_v1.a * this.m_v1.wB.x + this.m_v2.a * this.m_v2.wB.x;
         pB.y = this.m_v1.a * this.m_v1.wB.y + this.m_v2.a * this.m_v2.wB.y;
         break;
      case 3:
         pB.x = pA.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x + this.m_v3.a * this.m_v3.wA.x;
         pB.y = pA.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y + this.m_v3.a * this.m_v3.wA.y;
         break;
      default:
         b2Settings.b2Assert(false);
         break;
      }
   }
   b2Simplex.prototype.GetMetric = function () {
      switch (this.m_count) {
      case 0:
         b2Settings.b2Assert(false);
         return 0.0;
      case 1:
         return 0.0;
      case 2:
         return b2Math.SubtractVV(this.m_v1.w, this.m_v2.w).Length();
      case 3:
         return b2Math.CrossVV(b2Math.SubtractVV(this.m_v2.w, this.m_v1.w), b2Math.SubtractVV(this.m_v3.w, this.m_v1.w));
      default:
         b2Settings.b2Assert(false);
         return 0.0;
      }
   }
   b2Simplex.prototype.Solve2 = function () {
      var w1 = this.m_v1.w;
      var w2 = this.m_v2.w;
      var e12 = b2Math.SubtractVV(w2, w1);
      var d12_2 = (-(w1.x * e12.x + w1.y * e12.y));
      if (d12_2 <= 0.0) {
         this.m_v1.a = 1.0;
         this.m_count = 1;
         return;
      }
      var d12_1 = (w2.x * e12.x + w2.y * e12.y);
      if (d12_1 <= 0.0) {
         this.m_v2.a = 1.0;
         this.m_count = 1;
         this.m_v1.Set(this.m_v2);
         return;
      }
      var inv_d12 = 1.0 / (d12_1 + d12_2);
      this.m_v1.a = d12_1 * inv_d12;
      this.m_v2.a = d12_2 * inv_d12;
      this.m_count = 2;
   }
   b2Simplex.prototype.Solve3 = function () {
      var w1 = this.m_v1.w;
      var w2 = this.m_v2.w;
      var w3 = this.m_v3.w;
      var e12 = b2Math.SubtractVV(w2, w1);
      var w1e12 = b2Math.Dot(w1, e12);
      var w2e12 = b2Math.Dot(w2, e12);
      var d12_1 = w2e12;
      var d12_2 = (-w1e12);
      var e13 = b2Math.SubtractVV(w3, w1);
      var w1e13 = b2Math.Dot(w1, e13);
      var w3e13 = b2Math.Dot(w3, e13);
      var d13_1 = w3e13;
      var d13_2 = (-w1e13);
      var e23 = b2Math.SubtractVV(w3, w2);
      var w2e23 = b2Math.Dot(w2, e23);
      var w3e23 = b2Math.Dot(w3, e23);
      var d23_1 = w3e23;
      var d23_2 = (-w2e23);
      var n123 = b2Math.CrossVV(e12, e13);
      var d123_1 = n123 * b2Math.CrossVV(w2, w3);
      var d123_2 = n123 * b2Math.CrossVV(w3, w1);
      var d123_3 = n123 * b2Math.CrossVV(w1, w2);
      if (d12_2 <= 0.0 && d13_2 <= 0.0) {
         this.m_v1.a = 1.0;
         this.m_count = 1;
         return;
      }
      if (d12_1 > 0.0 && d12_2 > 0.0 && d123_3 <= 0.0) {
         var inv_d12 = 1.0 / (d12_1 + d12_2);
         this.m_v1.a = d12_1 * inv_d12;
         this.m_v2.a = d12_2 * inv_d12;
         this.m_count = 2;
         return;
      }
      if (d13_1 > 0.0 && d13_2 > 0.0 && d123_2 <= 0.0) {
         var inv_d13 = 1.0 / (d13_1 + d13_2);
         this.m_v1.a = d13_1 * inv_d13;
         this.m_v3.a = d13_2 * inv_d13;
         this.m_count = 2;
         this.m_v2.Set(this.m_v3);
         return;
      }
      if (d12_1 <= 0.0 && d23_2 <= 0.0) {
         this.m_v2.a = 1.0;
         this.m_count = 1;
         this.m_v1.Set(this.m_v2);
         return;
      }
      if (d13_1 <= 0.0 && d23_1 <= 0.0) {
         this.m_v3.a = 1.0;
         this.m_count = 1;
         this.m_v1.Set(this.m_v3);
         return;
      }
      if (d23_1 > 0.0 && d23_2 > 0.0 && d123_1 <= 0.0) {
         var inv_d23 = 1.0 / (d23_1 + d23_2);
         this.m_v2.a = d23_1 * inv_d23;
         this.m_v3.a = d23_2 * inv_d23;
         this.m_count = 2;
         this.m_v1.Set(this.m_v3);
         return;
      }
      var inv_d123 = 1.0 / (d123_1 + d123_2 + d123_3);
      this.m_v1.a = d123_1 * inv_d123;
      this.m_v2.a = d123_2 * inv_d123;
      this.m_v3.a = d123_3 * inv_d123;
      this.m_count = 3;
   }
   b2SimplexCache.b2SimplexCache = function () {
      this.indexA = new Vector_a2j_Number(3);
      this.indexB = new Vector_a2j_Number(3);
   };
   b2SimplexVertex.b2SimplexVertex = function () {};
   b2SimplexVertex.prototype.Set = function (other) {
      this.wA.SetV(other.wA);
      this.wB.SetV(other.wB);
      this.w.SetV(other.w);
      this.a = other.a;
      this.indexA = other.indexA;
      this.indexB = other.indexB;
   }
   b2TimeOfImpact.b2TimeOfImpact = function () {};
   b2TimeOfImpact.TimeOfImpact = function (input) {
      ++b2TimeOfImpact.b2_toiCalls;
      var proxyA = input.proxyA;
      var proxyB = input.proxyB;
      var sweepA = input.sweepA;
      var sweepB = input.sweepB;
      b2Settings.b2Assert(sweepA.t0 == sweepB.t0);
      b2Settings.b2Assert(1.0 - sweepA.t0 > Number.MIN_VALUE);
      var radius = proxyA.m_radius + proxyB.m_radius;
      var tolerance = input.tolerance;
      var alpha = 0.0;
      var k_maxIterations = 1000;
      var iter = 0;
      var target = 0.0;
      b2TimeOfImpact.s_cache.count = 0;
      b2TimeOfImpact.s_distanceInput.useRadii = false;
      for (;;) {
         sweepA.GetTransform(b2TimeOfImpact.s_xfA, alpha);
         sweepB.GetTransform(b2TimeOfImpact.s_xfB, alpha);
         b2TimeOfImpact.s_distanceInput.proxyA = proxyA;
         b2TimeOfImpact.s_distanceInput.proxyB = proxyB;
         b2TimeOfImpact.s_distanceInput.transformA = b2TimeOfImpact.s_xfA;
         b2TimeOfImpact.s_distanceInput.transformB = b2TimeOfImpact.s_xfB;
         b2Distance.Distance(b2TimeOfImpact.s_distanceOutput, b2TimeOfImpact.s_cache, b2TimeOfImpact.s_distanceInput);
         if (b2TimeOfImpact.s_distanceOutput.distance <= 0.0) {
            alpha = 1.0;
            break;
         }
         b2TimeOfImpact.s_fcn.Initialize(b2TimeOfImpact.s_cache, proxyA, b2TimeOfImpact.s_xfA, proxyB, b2TimeOfImpact.s_xfB);
         var separation = b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA, b2TimeOfImpact.s_xfB);
         if (separation <= 0.0) {
            alpha = 1.0;
            break;
         }
         if (iter == 0) {
            if (separation > radius) {
               target = b2Math.Max(radius - tolerance, 0.75 * radius);
            }
            else {
               target = b2Math.Max(separation - tolerance, 0.02 * radius);
            }
         }
         if (separation - target < 0.5 * tolerance) {
            if (iter == 0) {
               alpha = 1.0;
               break;
            }
            break;
         }
         var newAlpha = alpha; {
            var x1 = alpha;
            var x2 = 1.0;
            var f1 = separation;
            sweepA.GetTransform(b2TimeOfImpact.s_xfA, x2);
            sweepB.GetTransform(b2TimeOfImpact.s_xfB, x2);
            var f2 = b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA, b2TimeOfImpact.s_xfB);
            if (f2 >= target) {
               alpha = 1.0;
               break;
            }
            var rootIterCount = 0;
            for (;;) {
               var x = 0;
               if (rootIterCount & 1) {
                  x = x1 + (target - f1) * (x2 - x1) / (f2 - f1);
               }
               else {
                  x = 0.5 * (x1 + x2);
               }
               sweepA.GetTransform(b2TimeOfImpact.s_xfA, x);
               sweepB.GetTransform(b2TimeOfImpact.s_xfB, x);
               var f = b2TimeOfImpact.s_fcn.Evaluate(b2TimeOfImpact.s_xfA, b2TimeOfImpact.s_xfB);
               if (b2Math.Abs(f - target) < 0.025 * tolerance) {
                  newAlpha = x;
                  break;
               }
               if (f > target) {
                  x1 = x;
                  f1 = f;
               }
               else {
                  x2 = x;
                  f2 = f;
               }++rootIterCount;
               ++b2TimeOfImpact.b2_toiRootIters;
               if (rootIterCount == 50) {
                  break;
               }
            }
            b2TimeOfImpact.b2_toiMaxRootIters = b2Math.Max(b2TimeOfImpact.b2_toiMaxRootIters, rootIterCount);
         }
         if (newAlpha < (1.0 + 100.0 * Number.MIN_VALUE) * alpha) {
            break;
         }
         alpha = newAlpha;
         iter++;
         ++b2TimeOfImpact.b2_toiIters;
         if (iter == k_maxIterations) {
            break;
         }
      }
      b2TimeOfImpact.b2_toiMaxIters = b2Math.Max(b2TimeOfImpact.b2_toiMaxIters, iter);
      return alpha;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.b2TimeOfImpact.b2_toiCalls = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiIters = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiRootIters = 0;
      Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters = 0;
      Box2D.Collision.b2TimeOfImpact.s_cache = new b2SimplexCache();
      Box2D.Collision.b2TimeOfImpact.s_distanceInput = new b2DistanceInput();
      Box2D.Collision.b2TimeOfImpact.s_xfA = new b2Transform();
      Box2D.Collision.b2TimeOfImpact.s_xfB = new b2Transform();
      Box2D.Collision.b2TimeOfImpact.s_fcn = new b2SeparationFunction();
      Box2D.Collision.b2TimeOfImpact.s_distanceOutput = new b2DistanceOutput();
   });
   b2TOIInput.b2TOIInput = function () {
      this.proxyA = new b2DistanceProxy();
      this.proxyB = new b2DistanceProxy();
      this.sweepA = new b2Sweep();
      this.sweepB = new b2Sweep();
   };
   b2WorldManifold.b2WorldManifold = function () {
      this.m_normal = new b2Vec2();
   };
   b2WorldManifold.prototype.b2WorldManifold = function () {
      this.m_points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.m_points[i] = new b2Vec2();
      }
   }
   b2WorldManifold.prototype.Initialize = function (manifold, xfA, radiusA, xfB, radiusB) {
      if (radiusA === undefined) radiusA = 0;
      if (radiusB === undefined) radiusB = 0;
      if (manifold.m_pointCount == 0) {
         return;
      }
      var i = 0;
      var tVec;
      var tMat;
      var normalX = 0;
      var normalY = 0;
      var planePointX = 0;
      var planePointY = 0;
      var clipPointX = 0;
      var clipPointY = 0;
      switch (manifold.m_type) {
      case b2Manifold.e_circles:
         {
            tMat = xfA.R;
            tVec = manifold.m_localPoint;
            var pointAX = xfA.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            var pointAY = xfA.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = xfB.R;
            tVec = manifold.m_points[0].m_localPoint;
            var pointBX = xfB.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            var pointBY = xfB.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            var dX = pointBX - pointAX;
            var dY = pointBY - pointAY;
            var d2 = dX * dX + dY * dY;
            if (d2 > Number.MIN_VALUE * Number.MIN_VALUE) {
               var d = Math.sqrt(d2);
               this.m_normal.x = dX / d;
               this.m_normal.y = dY / d;
            }
            else {
               this.m_normal.x = 1;
               this.m_normal.y = 0;
            }
            var cAX = pointAX + radiusA * this.m_normal.x;
            var cAY = pointAY + radiusA * this.m_normal.y;
            var cBX = pointBX - radiusB * this.m_normal.x;
            var cBY = pointBY - radiusB * this.m_normal.y;
            this.m_points[0].x = 0.5 * (cAX + cBX);
            this.m_points[0].y = 0.5 * (cAY + cBY);
         }
         break;
      case b2Manifold.e_faceA:
         {
            tMat = xfA.R;
            tVec = manifold.m_localPlaneNormal;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = xfA.R;
            tVec = manifold.m_localPoint;
            planePointX = xfA.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            planePointY = xfA.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            this.m_normal.x = normalX;
            this.m_normal.y = normalY;
            for (i = 0;
            i < manifold.m_pointCount; i++) {
               tMat = xfB.R;
               tVec = manifold.m_points[i].m_localPoint;
               clipPointX = xfB.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
               clipPointY = xfB.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
               this.m_points[i].x = clipPointX + 0.5 * (radiusA - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusB) * normalX;
               this.m_points[i].y = clipPointY + 0.5 * (radiusA - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusB) * normalY;
            }
         }
         break;
      case b2Manifold.e_faceB:
         {
            tMat = xfB.R;
            tVec = manifold.m_localPlaneNormal;
            normalX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            normalY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = xfB.R;
            tVec = manifold.m_localPoint;
            planePointX = xfB.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            planePointY = xfB.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            this.m_normal.x = (-normalX);
            this.m_normal.y = (-normalY);
            for (i = 0;
            i < manifold.m_pointCount; i++) {
               tMat = xfA.R;
               tVec = manifold.m_points[i].m_localPoint;
               clipPointX = xfA.position.x + tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
               clipPointY = xfA.position.y + tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
               this.m_points[i].x = clipPointX + 0.5 * (radiusB - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusA) * normalX;
               this.m_points[i].y = clipPointY + 0.5 * (radiusB - (clipPointX - planePointX) * normalX - (clipPointY - planePointY) * normalY - radiusA) * normalY;
            }
         }
         break;
      }
   }
   ClipVertex.ClipVertex = function () {
      this.v = new b2Vec2();
      this.id = new b2ContactID();
   };
   ClipVertex.prototype.Set = function (other) {
      this.v.SetV(other.v);
      this.id.Set(other.id);
   }
   Features.Features = function () {};
   Object.defineProperty(Features.prototype, 'referenceEdge', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._referenceEdge;
      }
   });
   Object.defineProperty(Features.prototype, 'referenceEdge', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._referenceEdge = value;
         this._m_id._key = (this._m_id._key & 0xffffff00) | (this._referenceEdge & 0x000000ff);
      }
   });
   Object.defineProperty(Features.prototype, 'incidentEdge', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._incidentEdge;
      }
   });
   Object.defineProperty(Features.prototype, 'incidentEdge', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._incidentEdge = value;
         this._m_id._key = (this._m_id._key & 0xffff00ff) | ((this._incidentEdge << 8) & 0x0000ff00);
      }
   });
   Object.defineProperty(Features.prototype, 'incidentVertex', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._incidentVertex;
      }
   });
   Object.defineProperty(Features.prototype, 'incidentVertex', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._incidentVertex = value;
         this._m_id._key = (this._m_id._key & 0xff00ffff) | ((this._incidentVertex << 16) & 0x00ff0000);
      }
   });
   Object.defineProperty(Features.prototype, 'flip', {
      enumerable: false,
      configurable: true,
      get: function () {
         return this._flip;
      }
   });
   Object.defineProperty(Features.prototype, 'flip', {
      enumerable: false,
      configurable: true,
      set: function (value) {
         if (value === undefined) value = 0;
         this._flip = value;
         this._m_id._key = (this._m_id._key & 0x00ffffff) | ((this._flip << 24) & 0xff000000);
      }
   });
})();
(function () {
   var b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase;

   Box2D.inherit(b2CircleShape, Box2D.Collision.Shapes.b2Shape);
   b2CircleShape.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype;
   b2CircleShape.b2CircleShape = function () {
      Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments);
      this.m_p = new b2Vec2();
   };
   b2CircleShape.prototype.Copy = function () {
      var s = new b2CircleShape();
      s.Set(this);
      return s;
   }
   b2CircleShape.prototype.Set = function (other) {
      this.__super.Set.call(this, other);
      if (Box2D.is(other, b2CircleShape)) {
         var other2 = (other instanceof b2CircleShape ? other : null);
         this.m_p.SetV(other2.m_p);
      }
   }
   b2CircleShape.prototype.TestPoint = function (transform, p) {
      var tMat = transform.R;
      var dX = transform.position.x + (tMat.col1.x * this.m_p.x + tMat.col2.x * this.m_p.y);
      var dY = transform.position.y + (tMat.col1.y * this.m_p.x + tMat.col2.y * this.m_p.y);
      dX = p.x - dX;
      dY = p.y - dY;
      return (dX * dX + dY * dY) <= this.m_radius * this.m_radius;
   }
   b2CircleShape.prototype.RayCast = function (output, input, transform) {
      var tMat = transform.R;
      var positionX = transform.position.x + (tMat.col1.x * this.m_p.x + tMat.col2.x * this.m_p.y);
      var positionY = transform.position.y + (tMat.col1.y * this.m_p.x + tMat.col2.y * this.m_p.y);
      var sX = input.p1.x - positionX;
      var sY = input.p1.y - positionY;
      var b = (sX * sX + sY * sY) - this.m_radius * this.m_radius;
      var rX = input.p2.x - input.p1.x;
      var rY = input.p2.y - input.p1.y;
      var c = (sX * rX + sY * rY);
      var rr = (rX * rX + rY * rY);
      var sigma = c * c - rr * b;
      if (sigma < 0.0 || rr < Number.MIN_VALUE) {
         return false;
      }
      var a = (-(c + Math.sqrt(sigma)));
      if (0.0 <= a && a <= input.maxFraction * rr) {
         a /= rr;
         output.fraction = a;
         output.normal.x = sX + a * rX;
         output.normal.y = sY + a * rY;
         output.normal.Normalize();
         return true;
      }
      return false;
   }
   b2CircleShape.prototype.ComputeAABB = function (aabb, transform) {
      var tMat = transform.R;
      var pX = transform.position.x + (tMat.col1.x * this.m_p.x + tMat.col2.x * this.m_p.y);
      var pY = transform.position.y + (tMat.col1.y * this.m_p.x + tMat.col2.y * this.m_p.y);
      aabb.lowerBound.Set(pX - this.m_radius, pY - this.m_radius);
      aabb.upperBound.Set(pX + this.m_radius, pY + this.m_radius);
   }
   b2CircleShape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
      massData.mass = density * b2Settings.b2_pi * this.m_radius * this.m_radius;
      massData.center.SetV(this.m_p);
      massData.I = massData.mass * (0.5 * this.m_radius * this.m_radius + (this.m_p.x * this.m_p.x + this.m_p.y * this.m_p.y));
   }
   b2CircleShape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      var p = b2Math.MulX(xf, this.m_p);
      var l = (-(b2Math.Dot(normal, p) - offset));
      if (l < (-this.m_radius) + Number.MIN_VALUE) {
         return 0;
      }
      if (l > this.m_radius) {
         c.SetV(p);
         return Math.PI * this.m_radius * this.m_radius;
      }
      var r2 = this.m_radius * this.m_radius;
      var l2 = l * l;
      var area = r2 * (Math.asin(l / this.m_radius) + Math.PI / 2) + l * Math.sqrt(r2 - l2);
      var com = (-2 / 3 * Math.pow(r2 - l2, 1.5) / area);
      c.x = p.x + normal.x * com;
      c.y = p.y + normal.y * com;
      return area;
   }
   b2CircleShape.prototype.GetLocalPosition = function () {
      return this.m_p;
   }
   b2CircleShape.prototype.SetLocalPosition = function (position) {
      this.m_p.SetV(position);
   }
   b2CircleShape.prototype.GetRadius = function () {
      return this.m_radius;
   }
   b2CircleShape.prototype.SetRadius = function (radius) {
      if (radius === undefined) radius = 0;
      this.m_radius = radius;
   }
   b2CircleShape.prototype.b2CircleShape = function (radius) {
      if (radius === undefined) radius = 0;
      this.__super.b2Shape.call(this);
      this.m_type = b2Shape.e_circleShape;
      this.m_radius = radius;
   }
   b2EdgeChainDef.b2EdgeChainDef = function () {};
   b2EdgeChainDef.prototype.b2EdgeChainDef = function () {
      this.vertexCount = 0;
      this.isALoop = true;
      this.vertices = [];
   }
   Box2D.inherit(b2EdgeShape, Box2D.Collision.Shapes.b2Shape);
   b2EdgeShape.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype;
   b2EdgeShape.b2EdgeShape = function () {
      Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments);
      this.s_supportVec = new b2Vec2();
      this.m_v1 = new b2Vec2();
      this.m_v2 = new b2Vec2();
      this.m_coreV1 = new b2Vec2();
      this.m_coreV2 = new b2Vec2();
      this.m_normal = new b2Vec2();
      this.m_direction = new b2Vec2();
      this.m_cornerDir1 = new b2Vec2();
      this.m_cornerDir2 = new b2Vec2();
   };
   b2EdgeShape.prototype.TestPoint = function (transform, p) {
      return false;
   }
   b2EdgeShape.prototype.RayCast = function (output, input, transform) {
      var tMat;
      var rX = input.p2.x - input.p1.x;
      var rY = input.p2.y - input.p1.y;
      tMat = transform.R;
      var v1X = transform.position.x + (tMat.col1.x * this.m_v1.x + tMat.col2.x * this.m_v1.y);
      var v1Y = transform.position.y + (tMat.col1.y * this.m_v1.x + tMat.col2.y * this.m_v1.y);
      var nX = transform.position.y + (tMat.col1.y * this.m_v2.x + tMat.col2.y * this.m_v2.y) - v1Y;
      var nY = (-(transform.position.x + (tMat.col1.x * this.m_v2.x + tMat.col2.x * this.m_v2.y) - v1X));
      var k_slop = 100.0 * Number.MIN_VALUE;
      var denom = (-(rX * nX + rY * nY));
      if (denom > k_slop) {
         var bX = input.p1.x - v1X;
         var bY = input.p1.y - v1Y;
         var a = (bX * nX + bY * nY);
         if (0.0 <= a && a <= input.maxFraction * denom) {
            var mu2 = (-rX * bY) + rY * bX;
            if ((-k_slop * denom) <= mu2 && mu2 <= denom * (1.0 + k_slop)) {
               a /= denom;
               output.fraction = a;
               var nLen = Math.sqrt(nX * nX + nY * nY);
               output.normal.x = nX / nLen;
               output.normal.y = nY / nLen;
               return true;
            }
         }
      }
      return false;
   }
   b2EdgeShape.prototype.ComputeAABB = function (aabb, transform) {
      var tMat = transform.R;
      var v1X = transform.position.x + (tMat.col1.x * this.m_v1.x + tMat.col2.x * this.m_v1.y);
      var v1Y = transform.position.y + (tMat.col1.y * this.m_v1.x + tMat.col2.y * this.m_v1.y);
      var v2X = transform.position.x + (tMat.col1.x * this.m_v2.x + tMat.col2.x * this.m_v2.y);
      var v2Y = transform.position.y + (tMat.col1.y * this.m_v2.x + tMat.col2.y * this.m_v2.y);
      if (v1X < v2X) {
         aabb.lowerBound.x = v1X;
         aabb.upperBound.x = v2X;
      }
      else {
         aabb.lowerBound.x = v2X;
         aabb.upperBound.x = v1X;
      }
      if (v1Y < v2Y) {
         aabb.lowerBound.y = v1Y;
         aabb.upperBound.y = v2Y;
      }
      else {
         aabb.lowerBound.y = v2Y;
         aabb.upperBound.y = v1Y;
      }
   }
   b2EdgeShape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
      massData.mass = 0;
      massData.center.SetV(this.m_v1);
      massData.I = 0;
   }
   b2EdgeShape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      var v0 = new b2Vec2(normal.x * offset, normal.y * offset);
      var v1 = b2Math.MulX(xf, this.m_v1);
      var v2 = b2Math.MulX(xf, this.m_v2);
      var d1 = b2Math.Dot(normal, v1) - offset;
      var d2 = b2Math.Dot(normal, v2) - offset;
      if (d1 > 0) {
         if (d2 > 0) {
            return 0;
         }
         else {
            v1.x = (-d2 / (d1 - d2) * v1.x) + d1 / (d1 - d2) * v2.x;
            v1.y = (-d2 / (d1 - d2) * v1.y) + d1 / (d1 - d2) * v2.y;
         }
      }
      else {
         if (d2 > 0) {
            v2.x = (-d2 / (d1 - d2) * v1.x) + d1 / (d1 - d2) * v2.x;
            v2.y = (-d2 / (d1 - d2) * v1.y) + d1 / (d1 - d2) * v2.y;
         }
         else {}
      }
      c.x = (v0.x + v1.x + v2.x) / 3;
      c.y = (v0.y + v1.y + v2.y) / 3;
      return 0.5 * ((v1.x - v0.x) * (v2.y - v0.y) - (v1.y - v0.y) * (v2.x - v0.x));
   }
   b2EdgeShape.prototype.GetLength = function () {
      return this.m_length;
   }
   b2EdgeShape.prototype.GetVertex1 = function () {
      return this.m_v1;
   }
   b2EdgeShape.prototype.GetVertex2 = function () {
      return this.m_v2;
   }
   b2EdgeShape.prototype.GetCoreVertex1 = function () {
      return this.m_coreV1;
   }
   b2EdgeShape.prototype.GetCoreVertex2 = function () {
      return this.m_coreV2;
   }
   b2EdgeShape.prototype.GetNormalVector = function () {
      return this.m_normal;
   }
   b2EdgeShape.prototype.GetDirectionVector = function () {
      return this.m_direction;
   }
   b2EdgeShape.prototype.GetCorner1Vector = function () {
      return this.m_cornerDir1;
   }
   b2EdgeShape.prototype.GetCorner2Vector = function () {
      return this.m_cornerDir2;
   }
   b2EdgeShape.prototype.Corner1IsConvex = function () {
      return this.m_cornerConvex1;
   }
   b2EdgeShape.prototype.Corner2IsConvex = function () {
      return this.m_cornerConvex2;
   }
   b2EdgeShape.prototype.GetFirstVertex = function (xf) {
      var tMat = xf.R;
      return new b2Vec2(xf.position.x + (tMat.col1.x * this.m_coreV1.x + tMat.col2.x * this.m_coreV1.y), xf.position.y + (tMat.col1.y * this.m_coreV1.x + tMat.col2.y * this.m_coreV1.y));
   }
   b2EdgeShape.prototype.GetNextEdge = function () {
      return this.m_nextEdge;
   }
   b2EdgeShape.prototype.GetPrevEdge = function () {
      return this.m_prevEdge;
   }
   b2EdgeShape.prototype.Support = function (xf, dX, dY) {
      if (dX === undefined) dX = 0;
      if (dY === undefined) dY = 0;
      var tMat = xf.R;
      var v1X = xf.position.x + (tMat.col1.x * this.m_coreV1.x + tMat.col2.x * this.m_coreV1.y);
      var v1Y = xf.position.y + (tMat.col1.y * this.m_coreV1.x + tMat.col2.y * this.m_coreV1.y);
      var v2X = xf.position.x + (tMat.col1.x * this.m_coreV2.x + tMat.col2.x * this.m_coreV2.y);
      var v2Y = xf.position.y + (tMat.col1.y * this.m_coreV2.x + tMat.col2.y * this.m_coreV2.y);
      if ((v1X * dX + v1Y * dY) > (v2X * dX + v2Y * dY)) {
         this.s_supportVec.x = v1X;
         this.s_supportVec.y = v1Y;
      }
      else {
         this.s_supportVec.x = v2X;
         this.s_supportVec.y = v2Y;
      }
      return this.s_supportVec;
   }
   b2EdgeShape.prototype.b2EdgeShape = function (v1, v2) {
      this.__super.b2Shape.call(this);
      this.m_type = b2Shape.e_edgeShape;
      this.m_prevEdge = null;
      this.m_nextEdge = null;
      this.m_v1 = v1;
      this.m_v2 = v2;
      this.m_direction.Set(this.m_v2.x - this.m_v1.x, this.m_v2.y - this.m_v1.y);
      this.m_length = this.m_direction.Normalize();
      this.m_normal.Set(this.m_direction.y, (-this.m_direction.x));
      this.m_coreV1.Set((-b2Settings.b2_toiSlop * (this.m_normal.x - this.m_direction.x)) + this.m_v1.x, (-b2Settings.b2_toiSlop * (this.m_normal.y - this.m_direction.y)) + this.m_v1.y);
      this.m_coreV2.Set((-b2Settings.b2_toiSlop * (this.m_normal.x + this.m_direction.x)) + this.m_v2.x, (-b2Settings.b2_toiSlop * (this.m_normal.y + this.m_direction.y)) + this.m_v2.y);
      this.m_cornerDir1 = this.m_normal;
      this.m_cornerDir2.Set((-this.m_normal.x), (-this.m_normal.y));
   }
   b2EdgeShape.prototype.SetPrevEdge = function (edge, core, cornerDir, convex) {
      this.m_prevEdge = edge;
      this.m_coreV1 = core;
      this.m_cornerDir1 = cornerDir;
      this.m_cornerConvex1 = convex;
   }
   b2EdgeShape.prototype.SetNextEdge = function (edge, core, cornerDir, convex) {
      this.m_nextEdge = edge;
      this.m_coreV2 = core;
      this.m_cornerDir2 = cornerDir;
      this.m_cornerConvex2 = convex;
   }
   b2MassData.b2MassData = function () {
      this.mass = 0.0;
      this.center = new b2Vec2(0, 0);
      this.I = 0.0;
   };
   Box2D.inherit(b2PolygonShape, Box2D.Collision.Shapes.b2Shape);
   b2PolygonShape.prototype.__super = Box2D.Collision.Shapes.b2Shape.prototype;
   b2PolygonShape.b2PolygonShape = function () {
      Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this, arguments);
   };
   b2PolygonShape.prototype.Copy = function () {
      var s = new b2PolygonShape();
      s.Set(this);
      return s;
   }
   b2PolygonShape.prototype.Set = function (other) {
      this.__super.Set.call(this, other);
      if (Box2D.is(other, b2PolygonShape)) {
         var other2 = (other instanceof b2PolygonShape ? other : null);
         this.m_centroid.SetV(other2.m_centroid);
         this.m_vertexCount = other2.m_vertexCount;
         this.Reserve(this.m_vertexCount);
         for (var i = 0; i < this.m_vertexCount; i++) {
            this.m_vertices[i].SetV(other2.m_vertices[i]);
            this.m_normals[i].SetV(other2.m_normals[i]);
         }
      }
   }
   b2PolygonShape.prototype.SetAsArray = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      var v = new Vector();
      var i = 0,
         tVec;
      for (i = 0;
      i < vertices.length; ++i) {
         tVec = vertices[i];
         v.push(tVec);
      }
      this.SetAsVector(v, vertexCount);
   }
   b2PolygonShape.AsArray = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsArray(vertices, vertexCount);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsVector = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      if (vertexCount == 0) vertexCount = vertices.length;
      b2Settings.b2Assert(2 <= vertexCount);
      this.m_vertexCount = vertexCount;
      this.Reserve(vertexCount);
      var i = 0;
      for (i = 0;
      i < this.m_vertexCount; i++) {
         this.m_vertices[i].SetV(vertices[i]);
      }
      for (i = 0;
      i < this.m_vertexCount; ++i) {
         var i1 = parseInt(i);
         var i2 = parseInt(i + 1 < this.m_vertexCount ? i + 1 : 0);
         var edge = b2Math.SubtractVV(this.m_vertices[i2], this.m_vertices[i1]);
         b2Settings.b2Assert(edge.LengthSquared() > Number.MIN_VALUE);
         this.m_normals[i].SetV(b2Math.CrossVF(edge, 1.0));
         this.m_normals[i].Normalize();
      }
      this.m_centroid = b2PolygonShape.ComputeCentroid(this.m_vertices, this.m_vertexCount);
   }
   b2PolygonShape.AsVector = function (vertices, vertexCount) {
      if (vertexCount === undefined) vertexCount = 0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsVector(vertices, vertexCount);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsBox = function (hx, hy) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      this.m_vertexCount = 4;
      this.Reserve(4);
      this.m_vertices[0].Set((-hx), (-hy));
      this.m_vertices[1].Set(hx, (-hy));
      this.m_vertices[2].Set(hx, hy);
      this.m_vertices[3].Set((-hx), hy);
      this.m_normals[0].Set(0.0, (-1.0));
      this.m_normals[1].Set(1.0, 0.0);
      this.m_normals[2].Set(0.0, 1.0);
      this.m_normals[3].Set((-1.0), 0.0);
      this.m_centroid.SetZero();
   }
   b2PolygonShape.AsBox = function (hx, hy) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsBox(hx, hy);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsOrientedBox = function (hx, hy, center, angle) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      if (center === undefined) center = null;
      if (angle === undefined) angle = 0.0;
      this.m_vertexCount = 4;
      this.Reserve(4);
      this.m_vertices[0].Set((-hx), (-hy));
      this.m_vertices[1].Set(hx, (-hy));
      this.m_vertices[2].Set(hx, hy);
      this.m_vertices[3].Set((-hx), hy);
      this.m_normals[0].Set(0.0, (-1.0));
      this.m_normals[1].Set(1.0, 0.0);
      this.m_normals[2].Set(0.0, 1.0);
      this.m_normals[3].Set((-1.0), 0.0);
      this.m_centroid = center;
      var xf = new b2Transform();
      xf.position = center;
      xf.R.Set(angle);
      for (var i = 0; i < this.m_vertexCount; ++i) {
         this.m_vertices[i] = b2Math.MulX(xf, this.m_vertices[i]);
         this.m_normals[i] = b2Math.MulMV(xf.R, this.m_normals[i]);
      }
   }
   b2PolygonShape.AsOrientedBox = function (hx, hy, center, angle) {
      if (hx === undefined) hx = 0;
      if (hy === undefined) hy = 0;
      if (center === undefined) center = null;
      if (angle === undefined) angle = 0.0;
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsOrientedBox(hx, hy, center, angle);
      return polygonShape;
   }
   b2PolygonShape.prototype.SetAsEdge = function (v1, v2) {
      this.m_vertexCount = 2;
      this.Reserve(2);
      this.m_vertices[0].SetV(v1);
      this.m_vertices[1].SetV(v2);
      this.m_centroid.x = 0.5 * (v1.x + v2.x);
      this.m_centroid.y = 0.5 * (v1.y + v2.y);
      this.m_normals[0] = b2Math.CrossVF(b2Math.SubtractVV(v2, v1), 1.0);
      this.m_normals[0].Normalize();
      this.m_normals[1].x = (-this.m_normals[0].x);
      this.m_normals[1].y = (-this.m_normals[0].y);
   }
   b2PolygonShape.AsEdge = function (v1, v2) {
      var polygonShape = new b2PolygonShape();
      polygonShape.SetAsEdge(v1, v2);
      return polygonShape;
   }
   b2PolygonShape.prototype.TestPoint = function (xf, p) {
      var tVec;
      var tMat = xf.R;
      var tX = p.x - xf.position.x;
      var tY = p.y - xf.position.y;
      var pLocalX = (tX * tMat.col1.x + tY * tMat.col1.y);
      var pLocalY = (tX * tMat.col2.x + tY * tMat.col2.y);
      for (var i = 0; i < this.m_vertexCount; ++i) {
         tVec = this.m_vertices[i];
         tX = pLocalX - tVec.x;
         tY = pLocalY - tVec.y;
         tVec = this.m_normals[i];
         var dot = (tVec.x * tX + tVec.y * tY);
         if (dot > 0.0) {
            return false;
         }
      }
      return true;
   }
   b2PolygonShape.prototype.RayCast = function (output, input, transform) {
      var lower = 0.0;
      var upper = input.maxFraction;
      var tX = 0;
      var tY = 0;
      var tMat;
      var tVec;
      tX = input.p1.x - transform.position.x;
      tY = input.p1.y - transform.position.y;
      tMat = transform.R;
      var p1X = (tX * tMat.col1.x + tY * tMat.col1.y);
      var p1Y = (tX * tMat.col2.x + tY * tMat.col2.y);
      tX = input.p2.x - transform.position.x;
      tY = input.p2.y - transform.position.y;
      tMat = transform.R;
      var p2X = (tX * tMat.col1.x + tY * tMat.col1.y);
      var p2Y = (tX * tMat.col2.x + tY * tMat.col2.y);
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var index = parseInt((-1));
      for (var i = 0; i < this.m_vertexCount; ++i) {
         tVec = this.m_vertices[i];
         tX = tVec.x - p1X;
         tY = tVec.y - p1Y;
         tVec = this.m_normals[i];
         var numerator = (tVec.x * tX + tVec.y * tY);
         var denominator = (tVec.x * dX + tVec.y * dY);
         if (denominator == 0.0) {
            if (numerator < 0.0) {
               return false;
            }
         }
         else {
            if (denominator < 0.0 && numerator < lower * denominator) {
               lower = numerator / denominator;
               index = i;
            }
            else if (denominator > 0.0 && numerator < upper * denominator) {
               upper = numerator / denominator;
            }
         }
         if (upper < lower - Number.MIN_VALUE) {
            return false;
         }
      }
      if (index >= 0) {
         output.fraction = lower;
         tMat = transform.R;
         tVec = this.m_normals[index];
         output.normal.x = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         output.normal.y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         return true;
      }
      return false;
   }
   b2PolygonShape.prototype.ComputeAABB = function (aabb, xf) {
      var tMat = xf.R;
      var tVec = this.m_vertices[0];
      var lowerX = xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      var lowerY = xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var upperX = lowerX;
      var upperY = lowerY;
      for (var i = 1; i < this.m_vertexCount; ++i) {
         tVec = this.m_vertices[i];
         var vX = xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
         var vY = xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
         lowerX = lowerX < vX ? lowerX : vX;
         lowerY = lowerY < vY ? lowerY : vY;
         upperX = upperX > vX ? upperX : vX;
         upperY = upperY > vY ? upperY : vY;
      }
      aabb.lowerBound.x = lowerX - this.m_radius;
      aabb.lowerBound.y = lowerY - this.m_radius;
      aabb.upperBound.x = upperX + this.m_radius;
      aabb.upperBound.y = upperY + this.m_radius;
   }
   b2PolygonShape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
      if (this.m_vertexCount == 2) {
         massData.center.x = 0.5 * (this.m_vertices[0].x + this.m_vertices[1].x);
         massData.center.y = 0.5 * (this.m_vertices[0].y + this.m_vertices[1].y);
         massData.mass = 0.0;
         massData.I = 0.0;
         return;
      }
      var centerX = 0.0;
      var centerY = 0.0;
      var area = 0.0;
      var I = 0.0;
      var p1X = 0.0;
      var p1Y = 0.0;
      var k_inv3 = 1.0 / 3.0;
      for (var i = 0; i < this.m_vertexCount; ++i) {
         var p2 = this.m_vertices[i];
         var p3 = i + 1 < this.m_vertexCount ? this.m_vertices[parseInt(i + 1)] : this.m_vertices[0];
         var e1X = p2.x - p1X;
         var e1Y = p2.y - p1Y;
         var e2X = p3.x - p1X;
         var e2Y = p3.y - p1Y;
         var D = e1X * e2Y - e1Y * e2X;
         var triangleArea = 0.5 * D;area += triangleArea;
         centerX += triangleArea * k_inv3 * (p1X + p2.x + p3.x);
         centerY += triangleArea * k_inv3 * (p1Y + p2.y + p3.y);
         var px = p1X;
         var py = p1Y;
         var ex1 = e1X;
         var ey1 = e1Y;
         var ex2 = e2X;
         var ey2 = e2Y;
         var intx2 = k_inv3 * (0.25 * (ex1 * ex1 + ex2 * ex1 + ex2 * ex2) + (px * ex1 + px * ex2)) + 0.5 * px * px;
         var inty2 = k_inv3 * (0.25 * (ey1 * ey1 + ey2 * ey1 + ey2 * ey2) + (py * ey1 + py * ey2)) + 0.5 * py * py;I += D * (intx2 + inty2);
      }
      massData.mass = density * area;
      centerX *= 1.0 / area;
      centerY *= 1.0 / area;
      massData.center.Set(centerX, centerY);
      massData.I = density * I;
   }
   b2PolygonShape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      var normalL = b2Math.MulTMV(xf.R, normal);
      var offsetL = offset - b2Math.Dot(normal, xf.position);
      var depths = new Vector_a2j_Number();
      var diveCount = 0;
      var intoIndex = parseInt((-1));
      var outoIndex = parseInt((-1));
      var lastSubmerged = false;
      var i = 0;
      for (i = 0;
      i < this.m_vertexCount; ++i) {
         depths[i] = b2Math.Dot(normalL, this.m_vertices[i]) - offsetL;
         var isSubmerged = depths[i] < (-Number.MIN_VALUE);
         if (i > 0) {
            if (isSubmerged) {
               if (!lastSubmerged) {
                  intoIndex = i - 1;
                  diveCount++;
               }
            }
            else {
               if (lastSubmerged) {
                  outoIndex = i - 1;
                  diveCount++;
               }
            }
         }
         lastSubmerged = isSubmerged;
      }
      switch (diveCount) {
      case 0:
         if (lastSubmerged) {
            var md = new b2MassData();
            this.ComputeMass(md, 1);
            c.SetV(b2Math.MulX(xf, md.center));
            return md.mass;
         }
         else {
            return 0;
         }
         break;
      case 1:
         if (intoIndex == (-1)) {
            intoIndex = this.m_vertexCount - 1;
         }
         else {
            outoIndex = this.m_vertexCount - 1;
         }
         break;
      }
      var intoIndex2 = parseInt((intoIndex + 1) % this.m_vertexCount);
      var outoIndex2 = parseInt((outoIndex + 1) % this.m_vertexCount);
      var intoLamdda = (0 - depths[intoIndex]) / (depths[intoIndex2] - depths[intoIndex]);
      var outoLamdda = (0 - depths[outoIndex]) / (depths[outoIndex2] - depths[outoIndex]);
      var intoVec = new b2Vec2(this.m_vertices[intoIndex].x * (1 - intoLamdda) + this.m_vertices[intoIndex2].x * intoLamdda, this.m_vertices[intoIndex].y * (1 - intoLamdda) + this.m_vertices[intoIndex2].y * intoLamdda);
      var outoVec = new b2Vec2(this.m_vertices[outoIndex].x * (1 - outoLamdda) + this.m_vertices[outoIndex2].x * outoLamdda, this.m_vertices[outoIndex].y * (1 - outoLamdda) + this.m_vertices[outoIndex2].y * outoLamdda);
      var area = 0;
      var center = new b2Vec2();
      var p2 = this.m_vertices[intoIndex2];
      var p3;
      i = intoIndex2;
      while (i != outoIndex2) {
         i = (i + 1) % this.m_vertexCount;
         if (i == outoIndex2) p3 = outoVec;
         else p3 = this.m_vertices[i];
         var triangleArea = 0.5 * ((p2.x - intoVec.x) * (p3.y - intoVec.y) - (p2.y - intoVec.y) * (p3.x - intoVec.x));
         area += triangleArea;
         center.x += triangleArea * (intoVec.x + p2.x + p3.x) / 3;
         center.y += triangleArea * (intoVec.y + p2.y + p3.y) / 3;
         p2 = p3;
      }
      center.Multiply(1 / area);
      c.SetV(b2Math.MulX(xf, center));
      return area;
   }
   b2PolygonShape.prototype.GetVertexCount = function () {
      return this.m_vertexCount;
   }
   b2PolygonShape.prototype.GetVertices = function () {
      return this.m_vertices;
   }
   b2PolygonShape.prototype.GetNormals = function () {
      return this.m_normals;
   }
   b2PolygonShape.prototype.GetSupport = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_vertexCount; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return bestIndex;
   }
   b2PolygonShape.prototype.GetSupportVertex = function (d) {
      var bestIndex = 0;
      var bestValue = this.m_vertices[0].x * d.x + this.m_vertices[0].y * d.y;
      for (var i = 1; i < this.m_vertexCount; ++i) {
         var value = this.m_vertices[i].x * d.x + this.m_vertices[i].y * d.y;
         if (value > bestValue) {
            bestIndex = i;
            bestValue = value;
         }
      }
      return this.m_vertices[bestIndex];
   }
   b2PolygonShape.prototype.Validate = function () {
      return false;
   }
   b2PolygonShape.prototype.b2PolygonShape = function () {
      this.__super.b2Shape.call(this);
      this.m_type = b2Shape.e_polygonShape;
      this.m_centroid = new b2Vec2();
      this.m_vertices = new Vector();
      this.m_normals = new Vector();
   }
   b2PolygonShape.prototype.Reserve = function (count) {
      if (count === undefined) count = 0;
      for (var i = parseInt(this.m_vertices.length); i < count; i++) {
         this.m_vertices[i] = new b2Vec2();
         this.m_normals[i] = new b2Vec2();
      }
   }
   b2PolygonShape.ComputeCentroid = function (vs, count) {
      if (count === undefined) count = 0;
      var c = new b2Vec2();
      var area = 0.0;
      var p1X = 0.0;
      var p1Y = 0.0;
      var inv3 = 1.0 / 3.0;
      for (var i = 0; i < count; ++i) {
         var p2 = vs[i];
         var p3 = i + 1 < count ? vs[parseInt(i + 1)] : vs[0];
         var e1X = p2.x - p1X;
         var e1Y = p2.y - p1Y;
         var e2X = p3.x - p1X;
         var e2Y = p3.y - p1Y;
         var D = (e1X * e2Y - e1Y * e2X);
         var triangleArea = 0.5 * D;area += triangleArea;
         c.x += triangleArea * inv3 * (p1X + p2.x + p3.x);
         c.y += triangleArea * inv3 * (p1Y + p2.y + p3.y);
      }
      c.x *= 1.0 / area;
      c.y *= 1.0 / area;
      return c;
   }
   b2PolygonShape.ComputeOBB = function (obb, vs, count) {
      if (count === undefined) count = 0;
      var i = 0;
      var p = new Vector(count + 1);
      for (i = 0;
      i < count; ++i) {
         p[i] = vs[i];
      }
      p[count] = p[0];
      var minArea = Number.MAX_VALUE;
      for (i = 1;
      i <= count; ++i) {
         var root = p[parseInt(i - 1)];
         var uxX = p[i].x - root.x;
         var uxY = p[i].y - root.y;
         var length = Math.sqrt(uxX * uxX + uxY * uxY);
         uxX /= length;
         uxY /= length;
         var uyX = (-uxY);
         var uyY = uxX;
         var lowerX = Number.MAX_VALUE;
         var lowerY = Number.MAX_VALUE;
         var upperX = (-Number.MAX_VALUE);
         var upperY = (-Number.MAX_VALUE);
         for (var j = 0; j < count; ++j) {
            var dX = p[j].x - root.x;
            var dY = p[j].y - root.y;
            var rX = (uxX * dX + uxY * dY);
            var rY = (uyX * dX + uyY * dY);
            if (rX < lowerX) lowerX = rX;
            if (rY < lowerY) lowerY = rY;
            if (rX > upperX) upperX = rX;
            if (rY > upperY) upperY = rY;
         }
         var area = (upperX - lowerX) * (upperY - lowerY);
         if (area < 0.95 * minArea) {
            minArea = area;
            obb.R.col1.x = uxX;
            obb.R.col1.y = uxY;
            obb.R.col2.x = uyX;
            obb.R.col2.y = uyY;
            var centerX = 0.5 * (lowerX + upperX);
            var centerY = 0.5 * (lowerY + upperY);
            var tMat = obb.R;
            obb.center.x = root.x + (tMat.col1.x * centerX + tMat.col2.x * centerY);
            obb.center.y = root.y + (tMat.col1.y * centerX + tMat.col2.y * centerY);
            obb.extents.x = 0.5 * (upperX - lowerX);
            obb.extents.y = 0.5 * (upperY - lowerY);
         }
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.Shapes.b2PolygonShape.s_mat = new b2Mat22();
   });
   b2Shape.b2Shape = function () {};
   b2Shape.prototype.Copy = function () {
      return null;
   }
   b2Shape.prototype.Set = function (other) {
      this.m_radius = other.m_radius;
   }
   b2Shape.prototype.GetType = function () {
      return this.m_type;
   }
   b2Shape.prototype.TestPoint = function (xf, p) {
      return false;
   }
   b2Shape.prototype.RayCast = function (output, input, transform) {
      return false;
   }
   b2Shape.prototype.ComputeAABB = function (aabb, xf) {}
   b2Shape.prototype.ComputeMass = function (massData, density) {
      if (density === undefined) density = 0;
   }
   b2Shape.prototype.ComputeSubmergedArea = function (normal, offset, xf, c) {
      if (offset === undefined) offset = 0;
      return 0;
   }
   b2Shape.TestOverlap = function (shape1, transform1, shape2, transform2) {
      var input = new b2DistanceInput();
      input.proxyA = new b2DistanceProxy();
      input.proxyA.Set(shape1);
      input.proxyB = new b2DistanceProxy();
      input.proxyB.Set(shape2);
      input.transformA = transform1;
      input.transformB = transform2;
      input.useRadii = true;
      var simplexCache = new b2SimplexCache();
      simplexCache.count = 0;
      var output = new b2DistanceOutput();
      b2Distance.Distance(output, simplexCache, input);
      return output.distance < 10.0 * Number.MIN_VALUE;
   }
   b2Shape.prototype.b2Shape = function () {
      this.m_type = b2Shape.e_unknownShape;
      this.m_radius = b2Settings.b2_linearSlop;
   }
   Box2D.postDefs.push(function () {
      Box2D.Collision.Shapes.b2Shape.e_unknownShape = parseInt((-1));
      Box2D.Collision.Shapes.b2Shape.e_circleShape = 0;
      Box2D.Collision.Shapes.b2Shape.e_polygonShape = 1;
      Box2D.Collision.Shapes.b2Shape.e_edgeShape = 2;
      Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount = 3;
      Box2D.Collision.Shapes.b2Shape.e_hitCollide = 1;
      Box2D.Collision.Shapes.b2Shape.e_missCollide = 0;
      Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide = parseInt((-1));
   });
})();
(function () {
   var b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3;

   b2Color.b2Color = function () {
      this._r = 0;
      this._g = 0;
      this._b = 0;
   };
   b2Color.prototype.b2Color = function (rr, gg, bb) {
      if (rr === undefined) rr = 0;
      if (gg === undefined) gg = 0;
      if (bb === undefined) bb = 0;
      this._r = Box2D.parseUInt(255 * b2Math.Clamp(rr, 0.0, 1.0));
      this._g = Box2D.parseUInt(255 * b2Math.Clamp(gg, 0.0, 1.0));
      this._b = Box2D.parseUInt(255 * b2Math.Clamp(bb, 0.0, 1.0));
   }
   b2Color.prototype.Set = function (rr, gg, bb) {
      if (rr === undefined) rr = 0;
      if (gg === undefined) gg = 0;
      if (bb === undefined) bb = 0;
      this._r = Box2D.parseUInt(255 * b2Math.Clamp(rr, 0.0, 1.0));
      this._g = Box2D.parseUInt(255 * b2Math.Clamp(gg, 0.0, 1.0));
      this._b = Box2D.parseUInt(255 * b2Math.Clamp(bb, 0.0, 1.0));
   }
   Object.defineProperty(b2Color.prototype, 'r', {
      enumerable: false,
      configurable: true,
      set: function (rr) {
         if (rr === undefined) rr = 0;
         this._r = Box2D.parseUInt(255 * b2Math.Clamp(rr, 0.0, 1.0));
      }
   });
   Object.defineProperty(b2Color.prototype, 'g', {
      enumerable: false,
      configurable: true,
      set: function (gg) {
         if (gg === undefined) gg = 0;
         this._g = Box2D.parseUInt(255 * b2Math.Clamp(gg, 0.0, 1.0));
      }
   });
   Object.defineProperty(b2Color.prototype, 'b', {
      enumerable: false,
      configurable: true,
      set: function (bb) {
         if (bb === undefined) bb = 0;
         this._b = Box2D.parseUInt(255 * b2Math.Clamp(bb, 0.0, 1.0));
      }
   });
   Object.defineProperty(b2Color.prototype, 'color', {
      enumerable: false,
      configurable: true,
      get: function () {
         return (this._r << 16) | (this._g << 8) | (this._b);
      }
   });
   b2Settings.b2Settings = function () {};
   b2Settings.b2MixFriction = function (friction1, friction2) {
      if (friction1 === undefined) friction1 = 0;
      if (friction2 === undefined) friction2 = 0;
      return Math.sqrt(friction1 * friction2);
   }
   b2Settings.b2MixRestitution = function (restitution1, restitution2) {
      if (restitution1 === undefined) restitution1 = 0;
      if (restitution2 === undefined) restitution2 = 0;
      return restitution1 > restitution2 ? restitution1 : restitution2;
   }
   b2Settings.b2Assert = function (a) {
      if (!a) {
         throw "Assertion Failed";
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Common.b2Settings.VERSION = "2.1alpha";
      Box2D.Common.b2Settings.USHRT_MAX = 0x0000ffff;
      Box2D.Common.b2Settings.b2_pi = Math.PI;
      Box2D.Common.b2Settings.b2_maxManifoldPoints = 2;
      Box2D.Common.b2Settings.b2_aabbExtension = 0.1;
      Box2D.Common.b2Settings.b2_aabbMultiplier = 2.0;
      Box2D.Common.b2Settings.b2_polygonRadius = 2.0 * b2Settings.b2_linearSlop;
      Box2D.Common.b2Settings.b2_linearSlop = 0.005;
      Box2D.Common.b2Settings.b2_angularSlop = 2.0 / 180.0 * b2Settings.b2_pi;
      Box2D.Common.b2Settings.b2_toiSlop = 8.0 * b2Settings.b2_linearSlop;
      Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland = 32;
      Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland = 32;
      Box2D.Common.b2Settings.b2_velocityThreshold = 1.0;
      Box2D.Common.b2Settings.b2_maxLinearCorrection = 0.2;
      Box2D.Common.b2Settings.b2_maxAngularCorrection = 8.0 / 180.0 * b2Settings.b2_pi;
      Box2D.Common.b2Settings.b2_maxTranslation = 2.0;
      Box2D.Common.b2Settings.b2_maxTranslationSquared = b2Settings.b2_maxTranslation * b2Settings.b2_maxTranslation;
      Box2D.Common.b2Settings.b2_maxRotation = 0.5 * b2Settings.b2_pi;
      Box2D.Common.b2Settings.b2_maxRotationSquared = b2Settings.b2_maxRotation * b2Settings.b2_maxRotation;
      Box2D.Common.b2Settings.b2_contactBaumgarte = 0.2;
      Box2D.Common.b2Settings.b2_timeToSleep = 0.5;
      Box2D.Common.b2Settings.b2_linearSleepTolerance = 0.01;
      Box2D.Common.b2Settings.b2_angularSleepTolerance = 2.0 / 180.0 * b2Settings.b2_pi;
   });
})();
(function () {
   var b2AABB = Box2D.Collision.b2AABB,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3;

   b2Mat22.b2Mat22 = function () {
      this.col1 = new b2Vec2();
      this.col2 = new b2Vec2();
   };
   b2Mat22.prototype.b2Mat22 = function () {
      this.SetIdentity();
   }
   b2Mat22.FromAngle = function (angle) {
      if (angle === undefined) angle = 0;
      var mat = new b2Mat22();
      mat.Set(angle);
      return mat;
   }
   b2Mat22.FromVV = function (c1, c2) {
      var mat = new b2Mat22();
      mat.SetVV(c1, c2);
      return mat;
   }
   b2Mat22.prototype.Set = function (angle) {
      if (angle === undefined) angle = 0;
      var c = Math.cos(angle);
      var s = Math.sin(angle);
      this.col1.x = c;
      this.col2.x = (-s);
      this.col1.y = s;
      this.col2.y = c;
   }
   b2Mat22.prototype.SetVV = function (c1, c2) {
      this.col1.SetV(c1);
      this.col2.SetV(c2);
   }
   b2Mat22.prototype.Copy = function () {
      var mat = new b2Mat22();
      mat.SetM(this);
      return mat;
   }
   b2Mat22.prototype.SetM = function (m) {
      this.col1.SetV(m.col1);
      this.col2.SetV(m.col2);
   }
   b2Mat22.prototype.AddM = function (m) {
      this.col1.x += m.col1.x;
      this.col1.y += m.col1.y;
      this.col2.x += m.col2.x;
      this.col2.y += m.col2.y;
   }
   b2Mat22.prototype.SetIdentity = function () {
      this.col1.x = 1.0;
      this.col2.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 1.0;
   }
   b2Mat22.prototype.SetZero = function () {
      this.col1.x = 0.0;
      this.col2.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 0.0;
   }
   b2Mat22.prototype.GetAngle = function () {
      return Math.atan2(this.col1.y, this.col1.x);
   }
   b2Mat22.prototype.GetInverse = function (out) {
      var a = this.col1.x;
      var b = this.col2.x;
      var c = this.col1.y;
      var d = this.col2.y;
      var det = a * d - b * c;
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.col1.x = det * d;
      out.col2.x = (-det * b);
      out.col1.y = (-det * c);
      out.col2.y = det * a;
      return out;
   }
   b2Mat22.prototype.Solve = function (out, bX, bY) {
      if (bX === undefined) bX = 0;
      if (bY === undefined) bY = 0;
      var a11 = this.col1.x;
      var a12 = this.col2.x;
      var a21 = this.col1.y;
      var a22 = this.col2.y;
      var det = a11 * a22 - a12 * a21;
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.x = det * (a22 * bX - a12 * bY);
      out.y = det * (a11 * bY - a21 * bX);
      return out;
   }
   b2Mat22.prototype.Abs = function () {
      this.col1.Abs();
      this.col2.Abs();
   }
   b2Mat33.b2Mat33 = function () {
      this.col1 = new b2Vec3();
      this.col2 = new b2Vec3();
      this.col3 = new b2Vec3();
   };
   b2Mat33.prototype.b2Mat33 = function (c1, c2, c3) {
      if (c1 === undefined) c1 = null;
      if (c2 === undefined) c2 = null;
      if (c3 === undefined) c3 = null;
      if (!c1 && !c2 && !c3) {
         this.col1.SetZero();
         this.col2.SetZero();
         this.col3.SetZero();
      }
      else {
         this.col1.SetV(c1);
         this.col2.SetV(c2);
         this.col3.SetV(c3);
      }
   }
   b2Mat33.prototype.SetVVV = function (c1, c2, c3) {
      this.col1.SetV(c1);
      this.col2.SetV(c2);
      this.col3.SetV(c3);
   }
   b2Mat33.prototype.Copy = function () {
      return new b2Mat33(this.col1, this.col2, this.col3);
   }
   b2Mat33.prototype.SetM = function (m) {
      this.col1.SetV(m.col1);
      this.col2.SetV(m.col2);
      this.col3.SetV(m.col3);
   }
   b2Mat33.prototype.AddM = function (m) {
      this.col1.x += m.col1.x;
      this.col1.y += m.col1.y;
      this.col1.z += m.col1.z;
      this.col2.x += m.col2.x;
      this.col2.y += m.col2.y;
      this.col2.z += m.col2.z;
      this.col3.x += m.col3.x;
      this.col3.y += m.col3.y;
      this.col3.z += m.col3.z;
   }
   b2Mat33.prototype.SetIdentity = function () {
      this.col1.x = 1.0;
      this.col2.x = 0.0;
      this.col3.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 1.0;
      this.col3.y = 0.0;
      this.col1.z = 0.0;
      this.col2.z = 0.0;
      this.col3.z = 1.0;
   }
   b2Mat33.prototype.SetZero = function () {
      this.col1.x = 0.0;
      this.col2.x = 0.0;
      this.col3.x = 0.0;
      this.col1.y = 0.0;
      this.col2.y = 0.0;
      this.col3.y = 0.0;
      this.col1.z = 0.0;
      this.col2.z = 0.0;
      this.col3.z = 0.0;
   }
   b2Mat33.prototype.Solve22 = function (out, bX, bY) {
      if (bX === undefined) bX = 0;
      if (bY === undefined) bY = 0;
      var a11 = this.col1.x;
      var a12 = this.col2.x;
      var a21 = this.col1.y;
      var a22 = this.col2.y;
      var det = a11 * a22 - a12 * a21;
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.x = det * (a22 * bX - a12 * bY);
      out.y = det * (a11 * bY - a21 * bX);
      return out;
   }
   b2Mat33.prototype.Solve33 = function (out, bX, bY, bZ) {
      if (bX === undefined) bX = 0;
      if (bY === undefined) bY = 0;
      if (bZ === undefined) bZ = 0;
      var a11 = this.col1.x;
      var a21 = this.col1.y;
      var a31 = this.col1.z;
      var a12 = this.col2.x;
      var a22 = this.col2.y;
      var a32 = this.col2.z;
      var a13 = this.col3.x;
      var a23 = this.col3.y;
      var a33 = this.col3.z;
      var det = a11 * (a22 * a33 - a32 * a23) + a21 * (a32 * a13 - a12 * a33) + a31 * (a12 * a23 - a22 * a13);
      if (det != 0.0) {
         det = 1.0 / det;
      }
      out.x = det * (bX * (a22 * a33 - a32 * a23) + bY * (a32 * a13 - a12 * a33) + bZ * (a12 * a23 - a22 * a13));
      out.y = det * (a11 * (bY * a33 - bZ * a23) + a21 * (bZ * a13 - bX * a33) + a31 * (bX * a23 - bY * a13));
      out.z = det * (a11 * (a22 * bZ - a32 * bY) + a21 * (a32 * bX - a12 * bZ) + a31 * (a12 * bY - a22 * bX));
      return out;
   }
   b2Math.b2Math = function () {};
   b2Math.IsValid = function (x) {
      if (x === undefined) x = 0;
      return isFinite(x);
   }
   b2Math.Dot = function (a, b) {
      return a.x * b.x + a.y * b.y;
   }
   b2Math.CrossVV = function (a, b) {
      return a.x * b.y - a.y * b.x;
   }
   b2Math.CrossVF = function (a, s) {
      if (s === undefined) s = 0;
      var v = new b2Vec2(s * a.y, (-s * a.x));
      return v;
   }
   b2Math.CrossFV = function (s, a) {
      if (s === undefined) s = 0;
      var v = new b2Vec2((-s * a.y), s * a.x);
      return v;
   }
   b2Math.MulMV = function (A, v) {
      var u = new b2Vec2(A.col1.x * v.x + A.col2.x * v.y, A.col1.y * v.x + A.col2.y * v.y);
      return u;
   }
   b2Math.MulTMV = function (A, v) {
      var u = new b2Vec2(b2Math.Dot(v, A.col1), b2Math.Dot(v, A.col2));
      return u;
   }
   b2Math.MulX = function (T, v) {
      var a = b2Math.MulMV(T.R, v);
      a.x += T.position.x;
      a.y += T.position.y;
      return a;
   }
   b2Math.MulXT = function (T, v) {
      var a = b2Math.SubtractVV(v, T.position);
      var tX = (a.x * T.R.col1.x + a.y * T.R.col1.y);
      a.y = (a.x * T.R.col2.x + a.y * T.R.col2.y);
      a.x = tX;
      return a;
   }
   b2Math.AddVV = function (a, b) {
      var v = new b2Vec2(a.x + b.x, a.y + b.y);
      return v;
   }
   b2Math.SubtractVV = function (a, b) {
      var v = new b2Vec2(a.x - b.x, a.y - b.y);
      return v;
   }
   b2Math.Distance = function (a, b) {
      var cX = a.x - b.x;
      var cY = a.y - b.y;
      return Math.sqrt(cX * cX + cY * cY);
   }
   b2Math.DistanceSquared = function (a, b) {
      var cX = a.x - b.x;
      var cY = a.y - b.y;
      return (cX * cX + cY * cY);
   }
   b2Math.MulFV = function (s, a) {
      if (s === undefined) s = 0;
      var v = new b2Vec2(s * a.x, s * a.y);
      return v;
   }
   b2Math.AddMM = function (A, B) {
      var C = b2Mat22.FromVV(b2Math.AddVV(A.col1, B.col1), b2Math.AddVV(A.col2, B.col2));
      return C;
   }
   b2Math.MulMM = function (A, B) {
      var C = b2Mat22.FromVV(b2Math.MulMV(A, B.col1), b2Math.MulMV(A, B.col2));
      return C;
   }
   b2Math.MulTMM = function (A, B) {
      var c1 = new b2Vec2(b2Math.Dot(A.col1, B.col1), b2Math.Dot(A.col2, B.col1));
      var c2 = new b2Vec2(b2Math.Dot(A.col1, B.col2), b2Math.Dot(A.col2, B.col2));
      var C = b2Mat22.FromVV(c1, c2);
      return C;
   }
   b2Math.Abs = function (a) {
      if (a === undefined) a = 0;
      return a > 0.0 ? a : (-a);
   }
   b2Math.AbsV = function (a) {
      var b = new b2Vec2(b2Math.Abs(a.x), b2Math.Abs(a.y));
      return b;
   }
   b2Math.AbsM = function (A) {
      var B = b2Mat22.FromVV(b2Math.AbsV(A.col1), b2Math.AbsV(A.col2));
      return B;
   }
   b2Math.Min = function (a, b) {
      if (a === undefined) a = 0;
      if (b === undefined) b = 0;
      return a < b ? a : b;
   }
   b2Math.MinV = function (a, b) {
      var c = new b2Vec2(b2Math.Min(a.x, b.x), b2Math.Min(a.y, b.y));
      return c;
   }
   b2Math.Max = function (a, b) {
      if (a === undefined) a = 0;
      if (b === undefined) b = 0;
      return a > b ? a : b;
   }
   b2Math.MaxV = function (a, b) {
      var c = new b2Vec2(b2Math.Max(a.x, b.x), b2Math.Max(a.y, b.y));
      return c;
   }
   b2Math.Clamp = function (a, low, high) {
      if (a === undefined) a = 0;
      if (low === undefined) low = 0;
      if (high === undefined) high = 0;
      return a < low ? low : a > high ? high : a;
   }
   b2Math.ClampV = function (a, low, high) {
      return b2Math.MaxV(low, b2Math.MinV(a, high));
   }
   b2Math.Swap = function (a, b) {
      var tmp = a[0];
      a[0] = b[0];
      b[0] = tmp;
   }
   b2Math.Random = function () {
      return Math.random() * 2 - 1;
   }
   b2Math.RandomRange = function (lo, hi) {
      if (lo === undefined) lo = 0;
      if (hi === undefined) hi = 0;
      var r = Math.random();
      r = (hi - lo) * r + lo;
      return r;
   }
   b2Math.NextPowerOfTwo = function (x) {
      if (x === undefined) x = 0;
      x |= (x >> 1) & 0x7FFFFFFF;
      x |= (x >> 2) & 0x3FFFFFFF;
      x |= (x >> 4) & 0x0FFFFFFF;
      x |= (x >> 8) & 0x00FFFFFF;
      x |= (x >> 16) & 0x0000FFFF;
      return x + 1;
   }
   b2Math.IsPowerOfTwo = function (x) {
      if (x === undefined) x = 0;
      var result = x > 0 && (x & (x - 1)) == 0;
      return result;
   }
   Box2D.postDefs.push(function () {
      Box2D.Common.Math.b2Math.b2Vec2_zero = new b2Vec2(0.0, 0.0);
      Box2D.Common.Math.b2Math.b2Mat22_identity = b2Mat22.FromVV(new b2Vec2(1.0, 0.0), new b2Vec2(0.0, 1.0));
      Box2D.Common.Math.b2Math.b2Transform_identity = new b2Transform(b2Math.b2Vec2_zero, b2Math.b2Mat22_identity);
   });
   b2Sweep.b2Sweep = function () {
      this.localCenter = new b2Vec2();
      this.c0 = new b2Vec2;
      this.c = new b2Vec2();
   };
   b2Sweep.prototype.Set = function (other) {
      this.localCenter.SetV(other.localCenter);
      this.c0.SetV(other.c0);
      this.c.SetV(other.c);
      this.a0 = other.a0;
      this.a = other.a;
      this.t0 = other.t0;
   }
   b2Sweep.prototype.Copy = function () {
      var copy = new b2Sweep();
      copy.localCenter.SetV(this.localCenter);
      copy.c0.SetV(this.c0);
      copy.c.SetV(this.c);
      copy.a0 = this.a0;
      copy.a = this.a;
      copy.t0 = this.t0;
      return copy;
   }
   b2Sweep.prototype.GetTransform = function (xf, alpha) {
      if (alpha === undefined) alpha = 0;
      xf.position.x = (1.0 - alpha) * this.c0.x + alpha * this.c.x;
      xf.position.y = (1.0 - alpha) * this.c0.y + alpha * this.c.y;
      var angle = (1.0 - alpha) * this.a0 + alpha * this.a;
      xf.R.Set(angle);
      var tMat = xf.R;
      xf.position.x -= (tMat.col1.x * this.localCenter.x + tMat.col2.x * this.localCenter.y);
      xf.position.y -= (tMat.col1.y * this.localCenter.x + tMat.col2.y * this.localCenter.y);
   }
   b2Sweep.prototype.Advance = function (t) {
      if (t === undefined) t = 0;
      if (this.t0 < t && 1.0 - this.t0 > Number.MIN_VALUE) {
         var alpha = (t - this.t0) / (1.0 - this.t0);
         this.c0.x = (1.0 - alpha) * this.c0.x + alpha * this.c.x;
         this.c0.y = (1.0 - alpha) * this.c0.y + alpha * this.c.y;
         this.a0 = (1.0 - alpha) * this.a0 + alpha * this.a;
         this.t0 = t;
      }
   }
   b2Transform.b2Transform = function () {
      this.position = new b2Vec2;
      this.R = new b2Mat22();
   };
   b2Transform.prototype.b2Transform = function (pos, r) {
      if (pos === undefined) pos = null;
      if (r === undefined) r = null;
      if (pos) {
         this.position.SetV(pos);
         this.R.SetM(r);
      }
   }
   b2Transform.prototype.Initialize = function (pos, r) {
      this.position.SetV(pos);
      this.R.SetM(r);
   }
   b2Transform.prototype.SetIdentity = function () {
      this.position.SetZero();
      this.R.SetIdentity();
   }
   b2Transform.prototype.Set = function (x) {
      this.position.SetV(x.position);
      this.R.SetM(x.R);
   }
   b2Transform.prototype.GetAngle = function () {
      return Math.atan2(this.R.col1.y, this.R.col1.x);
   }
   b2Vec2.b2Vec2 = function () {};
   b2Vec2.prototype.b2Vec2 = function (x_, y_) {
      if (x_ === undefined) x_ = 0;
      if (y_ === undefined) y_ = 0;
      this.x = x_;
      this.y = y_;
   }
   b2Vec2.prototype.SetZero = function () {
      this.x = 0.0;
      this.y = 0.0;
   }
   b2Vec2.prototype.Set = function (x_, y_) {
      if (x_ === undefined) x_ = 0;
      if (y_ === undefined) y_ = 0;
      this.x = x_;
      this.y = y_;
   }
   b2Vec2.prototype.SetV = function (v) {
      this.x = v.x;
      this.y = v.y;
   }
   b2Vec2.prototype.GetNegative = function () {
      return new b2Vec2((-this.x), (-this.y));
   }
   b2Vec2.prototype.NegativeSelf = function () {
      this.x = (-this.x);
      this.y = (-this.y);
   }
   b2Vec2.Make = function (x_, y_) {
      if (x_ === undefined) x_ = 0;
      if (y_ === undefined) y_ = 0;
      return new b2Vec2(x_, y_);
   }
   b2Vec2.prototype.Copy = function () {
      return new b2Vec2(this.x, this.y);
   }
   b2Vec2.prototype.Add = function (v) {
      this.x += v.x;
      this.y += v.y;
   }
   b2Vec2.prototype.Subtract = function (v) {
      this.x -= v.x;
      this.y -= v.y;
   }
   b2Vec2.prototype.Multiply = function (a) {
      if (a === undefined) a = 0;
      this.x *= a;
      this.y *= a;
   }
   b2Vec2.prototype.MulM = function (A) {
      var tX = this.x;
      this.x = A.col1.x * tX + A.col2.x * this.y;
      this.y = A.col1.y * tX + A.col2.y * this.y;
   }
   b2Vec2.prototype.MulTM = function (A) {
      var tX = b2Math.Dot(this, A.col1);
      this.y = b2Math.Dot(this, A.col2);
      this.x = tX;
   }
   b2Vec2.prototype.CrossVF = function (s) {
      if (s === undefined) s = 0;
      var tX = this.x;
      this.x = s * this.y;
      this.y = (-s * tX);
   }
   b2Vec2.prototype.CrossFV = function (s) {
      if (s === undefined) s = 0;
      var tX = this.x;
      this.x = (-s * this.y);
      this.y = s * tX;
   }
   b2Vec2.prototype.MinV = function (b) {
      this.x = this.x < b.x ? this.x : b.x;
      this.y = this.y < b.y ? this.y : b.y;
   }
   b2Vec2.prototype.MaxV = function (b) {
      this.x = this.x > b.x ? this.x : b.x;
      this.y = this.y > b.y ? this.y : b.y;
   }
   b2Vec2.prototype.Abs = function () {
      if (this.x < 0) this.x = (-this.x);
      if (this.y < 0) this.y = (-this.y);
   }
   b2Vec2.prototype.Length = function () {
      return Math.sqrt(this.x * this.x + this.y * this.y);
   }
   b2Vec2.prototype.LengthSquared = function () {
      return (this.x * this.x + this.y * this.y);
   }
   b2Vec2.prototype.Normalize = function () {
      var length = Math.sqrt(this.x * this.x + this.y * this.y);
      if (length < Number.MIN_VALUE) {
         return 0.0;
      }
      var invLength = 1.0 / length;
      this.x *= invLength;
      this.y *= invLength;
      return length;
   }
   b2Vec2.prototype.IsValid = function () {
      return b2Math.IsValid(this.x) && b2Math.IsValid(this.y);
   }
   b2Vec3.b2Vec3 = function () {};
   b2Vec3.prototype.b2Vec3 = function (x, y, z) {
      if (x === undefined) x = 0;
      if (y === undefined) y = 0;
      if (z === undefined) z = 0;
      this.x = x;
      this.y = y;
      this.z = z;
   }
   b2Vec3.prototype.SetZero = function () {
      this.x = this.y = this.z = 0.0;
   }
   b2Vec3.prototype.Set = function (x, y, z) {
      if (x === undefined) x = 0;
      if (y === undefined) y = 0;
      if (z === undefined) z = 0;
      this.x = x;
      this.y = y;
      this.z = z;
   }
   b2Vec3.prototype.SetV = function (v) {
      this.x = v.x;
      this.y = v.y;
      this.z = v.z;
   }
   b2Vec3.prototype.GetNegative = function () {
      return new b2Vec3((-this.x), (-this.y), (-this.z));
   }
   b2Vec3.prototype.NegativeSelf = function () {
      this.x = (-this.x);
      this.y = (-this.y);
      this.z = (-this.z);
   }
   b2Vec3.prototype.Copy = function () {
      return new b2Vec3(this.x, this.y, this.z);
   }
   b2Vec3.prototype.Add = function (v) {
      this.x += v.x;
      this.y += v.y;
      this.z += v.z;
   }
   b2Vec3.prototype.Subtract = function (v) {
      this.x -= v.x;
      this.y -= v.y;
      this.z -= v.z;
   }
   b2Vec3.prototype.Multiply = function (a) {
      if (a === undefined) a = 0;
      this.x *= a;
      this.y *= a;
      this.z *= a;
   }
})();
(function () {
   var b2ControllerEdge = Box2D.Dynamics.Controllers.b2ControllerEdge,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase,
      b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2CircleContact = Box2D.Dynamics.Contacts.b2CircleContact,
      b2Contact = Box2D.Dynamics.Contacts.b2Contact,
      b2ContactConstraint = Box2D.Dynamics.Contacts.b2ContactConstraint,
      b2ContactConstraintPoint = Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
      b2ContactEdge = Box2D.Dynamics.Contacts.b2ContactEdge,
      b2ContactFactory = Box2D.Dynamics.Contacts.b2ContactFactory,
      b2ContactRegister = Box2D.Dynamics.Contacts.b2ContactRegister,
      b2ContactResult = Box2D.Dynamics.Contacts.b2ContactResult,
      b2ContactSolver = Box2D.Dynamics.Contacts.b2ContactSolver,
      b2EdgeAndCircleContact = Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
      b2NullContact = Box2D.Dynamics.Contacts.b2NullContact,
      b2PolyAndCircleContact = Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
      b2PolyAndEdgeContact = Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
      b2PolygonContact = Box2D.Dynamics.Contacts.b2PolygonContact,
      b2PositionSolverManifold = Box2D.Dynamics.Contacts.b2PositionSolverManifold,
      b2Controller = Box2D.Dynamics.Controllers.b2Controller,
      b2DistanceJoint = Box2D.Dynamics.Joints.b2DistanceJoint,
      b2DistanceJointDef = Box2D.Dynamics.Joints.b2DistanceJointDef,
      b2FrictionJoint = Box2D.Dynamics.Joints.b2FrictionJoint,
      b2FrictionJointDef = Box2D.Dynamics.Joints.b2FrictionJointDef,
      b2GearJoint = Box2D.Dynamics.Joints.b2GearJoint,
      b2GearJointDef = Box2D.Dynamics.Joints.b2GearJointDef,
      b2Jacobian = Box2D.Dynamics.Joints.b2Jacobian,
      b2Joint = Box2D.Dynamics.Joints.b2Joint,
      b2JointDef = Box2D.Dynamics.Joints.b2JointDef,
      b2JointEdge = Box2D.Dynamics.Joints.b2JointEdge,
      b2LineJoint = Box2D.Dynamics.Joints.b2LineJoint,
      b2LineJointDef = Box2D.Dynamics.Joints.b2LineJointDef,
      b2MouseJoint = Box2D.Dynamics.Joints.b2MouseJoint,
      b2MouseJointDef = Box2D.Dynamics.Joints.b2MouseJointDef,
      b2PrismaticJoint = Box2D.Dynamics.Joints.b2PrismaticJoint,
      b2PrismaticJointDef = Box2D.Dynamics.Joints.b2PrismaticJointDef,
      b2PulleyJoint = Box2D.Dynamics.Joints.b2PulleyJoint,
      b2PulleyJointDef = Box2D.Dynamics.Joints.b2PulleyJointDef,
      b2RevoluteJoint = Box2D.Dynamics.Joints.b2RevoluteJoint,
      b2RevoluteJointDef = Box2D.Dynamics.Joints.b2RevoluteJointDef,
      b2WeldJoint = Box2D.Dynamics.Joints.b2WeldJoint,
      b2WeldJointDef = Box2D.Dynamics.Joints.b2WeldJointDef;

   b2Body.b2Body = function () {
      this.m_xf = new b2Transform();
      this.m_sweep = new b2Sweep();
      this.m_linearVelocity = new b2Vec2();
      this.m_force = new b2Vec2();
   };
   b2Body.prototype.connectEdges = function (s1, s2, angle1) {
      if (angle1 === undefined) angle1 = 0;
      var angle2 = Math.atan2(s2.GetDirectionVector().y, s2.GetDirectionVector().x);
      var coreOffset = Math.tan((angle2 - angle1) * 0.5);
      var core = b2Math.MulFV(coreOffset, s2.GetDirectionVector());
      core = b2Math.SubtractVV(core, s2.GetNormalVector());
      core = b2Math.MulFV(b2Settings.b2_toiSlop, core);
      core = b2Math.AddVV(core, s2.GetVertex1());
      var cornerDir = b2Math.AddVV(s1.GetDirectionVector(), s2.GetDirectionVector());
      cornerDir.Normalize();
      var convex = b2Math.Dot(s1.GetDirectionVector(), s2.GetNormalVector()) > 0.0;
      s1.SetNextEdge(s2, core, cornerDir, convex);
      s2.SetPrevEdge(s1, core, cornerDir, convex);
      return angle2;
   }
   b2Body.prototype.CreateFixture = function (def) {
      if (this.m_world.IsLocked() == true) {
         return null;
      }
      var fixture = new b2Fixture();
      fixture.Create(this, this.m_xf, def);
      if (this.m_flags & b2Body.e_activeFlag) {
         var broadPhase = this.m_world.m_contactManager.m_broadPhase;
         fixture.CreateProxy(broadPhase, this.m_xf);
      }
      fixture.m_next = this.m_fixtureList;
      this.m_fixtureList = fixture;
      ++this.m_fixtureCount;
      fixture.m_body = this;
      if (fixture.m_density > 0.0) {
         this.ResetMassData();
      }
      this.m_world.m_flags |= b2World.e_newFixture;
      return fixture;
   }
   b2Body.prototype.CreateFixture2 = function (shape, density) {
      if (density === undefined) density = 0.0;
      var def = new b2FixtureDef();
      def.shape = shape;
      def.density = density;
      return this.CreateFixture(def);
   }
   b2Body.prototype.DestroyFixture = function (fixture) {
      if (this.m_world.IsLocked() == true) {
         return;
      }
      var node = this.m_fixtureList;
      var ppF = null;
      var found = false;
      while (node != null) {
         if (node == fixture) {
            if (ppF) ppF.m_next = fixture.m_next;
            else this.m_fixtureList = fixture.m_next;
            found = true;
            break;
         }
         ppF = node;
         node = node.m_next;
      }
      var edge = this.m_contactList;
      while (edge) {
         var c = edge.contact;
         edge = edge.next;
         var fixtureA = c.GetFixtureA();
         var fixtureB = c.GetFixtureB();
         if (fixture == fixtureA || fixture == fixtureB) {
            this.m_world.m_contactManager.Destroy(c);
         }
      }
      if (this.m_flags & b2Body.e_activeFlag) {
         var broadPhase = this.m_world.m_contactManager.m_broadPhase;
         fixture.DestroyProxy(broadPhase);
      }
      else {}
      fixture.Destroy();
      fixture.m_body = null;
      fixture.m_next = null;
      --this.m_fixtureCount;
      this.ResetMassData();
   }
   b2Body.prototype.SetPositionAndAngle = function (position, angle) {
      if (angle === undefined) angle = 0;
      var f;
      if (this.m_world.IsLocked() == true) {
         return;
      }
      this.m_xf.R.Set(angle);
      this.m_xf.position.SetV(position);
      var tMat = this.m_xf.R;
      var tVec = this.m_sweep.localCenter;
      this.m_sweep.c.x = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      this.m_sweep.c.y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      this.m_sweep.c.x += this.m_xf.position.x;
      this.m_sweep.c.y += this.m_xf.position.y;
      this.m_sweep.c0.SetV(this.m_sweep.c);
      this.m_sweep.a0 = this.m_sweep.a = angle;
      var broadPhase = this.m_world.m_contactManager.m_broadPhase;
      for (f = this.m_fixtureList;
      f; f = f.m_next) {
         f.Synchronize(broadPhase, this.m_xf, this.m_xf);
      }
      this.m_world.m_contactManager.FindNewContacts();
   }
   b2Body.prototype.SetTransform = function (xf) {
      this.SetPositionAndAngle(xf.position, xf.GetAngle());
   }
   b2Body.prototype.GetTransform = function () {
      return this.m_xf;
   }
   b2Body.prototype.GetPosition = function () {
      return this.m_xf.position;
   }
   b2Body.prototype.SetPosition = function (position) {
      this.SetPositionAndAngle(position, this.GetAngle());
   }
   b2Body.prototype.GetAngle = function () {
      return this.m_sweep.a;
   }
   b2Body.prototype.SetAngle = function (angle) {
      if (angle === undefined) angle = 0;
      this.SetPositionAndAngle(this.GetPosition(), angle);
   }
   b2Body.prototype.GetWorldCenter = function () {
      return this.m_sweep.c;
   }
   b2Body.prototype.GetLocalCenter = function () {
      return this.m_sweep.localCenter;
   }
   b2Body.prototype.SetLinearVelocity = function (v) {
      if (this.m_type == b2Body.b2_staticBody) {
         return;
      }
      this.m_linearVelocity.SetV(v);
   }
   b2Body.prototype.GetLinearVelocity = function () {
      return this.m_linearVelocity;
   }
   b2Body.prototype.SetAngularVelocity = function (omega) {
      if (omega === undefined) omega = 0;
      if (this.m_type == b2Body.b2_staticBody) {
         return;
      }
      this.m_angularVelocity = omega;
   }
   b2Body.prototype.GetAngularVelocity = function () {
      return this.m_angularVelocity;
   }
   b2Body.prototype.GetDefinition = function () {
      var bd = new b2BodyDef();
      bd.type = this.GetType();
      bd.allowSleep = (this.m_flags & b2Body.e_allowSleepFlag) == b2Body.e_allowSleepFlag;
      bd.angle = this.GetAngle();
      bd.angularDamping = this.m_angularDamping;
      bd.angularVelocity = this.m_angularVelocity;
      bd.fixedRotation = (this.m_flags & b2Body.e_fixedRotationFlag) == b2Body.e_fixedRotationFlag;
      bd.bullet = (this.m_flags & b2Body.e_bulletFlag) == b2Body.e_bulletFlag;
      bd.awake = (this.m_flags & b2Body.e_awakeFlag) == b2Body.e_awakeFlag;
      bd.linearDamping = this.m_linearDamping;
      bd.linearVelocity.SetV(this.GetLinearVelocity());
      bd.position = this.GetPosition();
      bd.userData = this.GetUserData();
      return bd;
   }
   b2Body.prototype.ApplyForce = function (force, point) {
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      if (this.IsAwake() == false) {
         this.SetAwake(true);
      }
      this.m_force.x += force.x;
      this.m_force.y += force.y;
      this.m_torque += ((point.x - this.m_sweep.c.x) * force.y - (point.y - this.m_sweep.c.y) * force.x);
   }
   b2Body.prototype.ApplyTorque = function (torque) {
      if (torque === undefined) torque = 0;
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      if (this.IsAwake() == false) {
         this.SetAwake(true);
      }
      this.m_torque += torque;
   }
   b2Body.prototype.ApplyImpulse = function (impulse, point) {
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      if (this.IsAwake() == false) {
         this.SetAwake(true);
      }
      this.m_linearVelocity.x += this.m_invMass * impulse.x;
      this.m_linearVelocity.y += this.m_invMass * impulse.y;
      this.m_angularVelocity += this.m_invI * ((point.x - this.m_sweep.c.x) * impulse.y - (point.y - this.m_sweep.c.y) * impulse.x);
   }
   b2Body.prototype.Split = function (callback) {
      var linearVelocity = this.GetLinearVelocity().Copy();
      var angularVelocity = this.GetAngularVelocity();
      var center = this.GetWorldCenter();
      var body1 = this;
      var body2 = this.m_world.CreateBody(this.GetDefinition());
      var prev;
      for (var f = body1.m_fixtureList; f;) {
         if (callback(f)) {
            var next = f.m_next;
            if (prev) {
               prev.m_next = next;
            }
            else {
               body1.m_fixtureList = next;
            }
            body1.m_fixtureCount--;
            f.m_next = body2.m_fixtureList;
            body2.m_fixtureList = f;
            body2.m_fixtureCount++;
            f.m_body = body2;
            f = next;
         }
         else {
            prev = f;
            f = f.m_next;
         }
      }
      body1.ResetMassData();
      body2.ResetMassData();
      var center1 = body1.GetWorldCenter();
      var center2 = body2.GetWorldCenter();
      var velocity1 = b2Math.AddVV(linearVelocity, b2Math.CrossFV(angularVelocity, b2Math.SubtractVV(center1, center)));
      var velocity2 = b2Math.AddVV(linearVelocity, b2Math.CrossFV(angularVelocity, b2Math.SubtractVV(center2, center)));
      body1.SetLinearVelocity(velocity1);
      body2.SetLinearVelocity(velocity2);
      body1.SetAngularVelocity(angularVelocity);
      body2.SetAngularVelocity(angularVelocity);
      body1.SynchronizeFixtures();
      body2.SynchronizeFixtures();
      return body2;
   }
   b2Body.prototype.Merge = function (other) {
      var f;
      for (f = other.m_fixtureList;
      f;) {
         var next = f.m_next;
         other.m_fixtureCount--;
         f.m_next = this.m_fixtureList;
         this.m_fixtureList = f;
         this.m_fixtureCount++;
         f.m_body = body2;
         f = next;
      }
      body1.m_fixtureCount = 0;
      var body1 = this;
      var body2 = other;
      var center1 = body1.GetWorldCenter();
      var center2 = body2.GetWorldCenter();
      var velocity1 = body1.GetLinearVelocity().Copy();
      var velocity2 = body2.GetLinearVelocity().Copy();
      var angular1 = body1.GetAngularVelocity();
      var angular = body2.GetAngularVelocity();
      body1.ResetMassData();
      this.SynchronizeFixtures();
   }
   b2Body.prototype.GetMass = function () {
      return this.m_mass;
   }
   b2Body.prototype.GetInertia = function () {
      return this.m_I;
   }
   b2Body.prototype.GetMassData = function (data) {
      data.mass = this.m_mass;
      data.I = this.m_I;
      data.center.SetV(this.m_sweep.localCenter);
   }
   b2Body.prototype.SetMassData = function (massData) {
      b2Settings.b2Assert(this.m_world.IsLocked() == false);
      if (this.m_world.IsLocked() == true) {
         return;
      }
      if (this.m_type != b2Body.b2_dynamicBody) {
         return;
      }
      this.m_invMass = 0.0;
      this.m_I = 0.0;
      this.m_invI = 0.0;
      this.m_mass = massData.mass;
      if (this.m_mass <= 0.0) {
         this.m_mass = 1.0;
      }
      this.m_invMass = 1.0 / this.m_mass;
      if (massData.I > 0.0 && (this.m_flags & b2Body.e_fixedRotationFlag) == 0) {
         this.m_I = massData.I - this.m_mass * (massData.center.x * massData.center.x + massData.center.y * massData.center.y);
         this.m_invI = 1.0 / this.m_I;
      }
      var oldCenter = this.m_sweep.c.Copy();
      this.m_sweep.localCenter.SetV(massData.center);
      this.m_sweep.c0.SetV(b2Math.MulX(this.m_xf, this.m_sweep.localCenter));
      this.m_sweep.c.SetV(this.m_sweep.c0);
      this.m_linearVelocity.x += this.m_angularVelocity * (-(this.m_sweep.c.y - oldCenter.y));
      this.m_linearVelocity.y += this.m_angularVelocity * (+(this.m_sweep.c.x - oldCenter.x));
   }
   b2Body.prototype.ResetMassData = function () {
      this.m_mass = 0.0;
      this.m_invMass = 0.0;
      this.m_I = 0.0;
      this.m_invI = 0.0;
      this.m_sweep.localCenter.SetZero();
      if (this.m_type == b2Body.b2_staticBody || this.m_type == b2Body.b2_kinematicBody) {
         return;
      }
      var center = b2Vec2.Make(0, 0);
      for (var f = this.m_fixtureList; f; f = f.m_next) {
         if (f.m_density == 0.0) {
            continue;
         }
         var massData = f.GetMassData();
         this.m_mass += massData.mass;
         center.x += massData.center.x * massData.mass;
         center.y += massData.center.y * massData.mass;
         this.m_I += massData.I;
      }
      if (this.m_mass > 0.0) {
         this.m_invMass = 1.0 / this.m_mass;
         center.x *= this.m_invMass;
         center.y *= this.m_invMass;
      }
      else {
         this.m_mass = 1.0;
         this.m_invMass = 1.0;
      }
      if (this.m_I > 0.0 && (this.m_flags & b2Body.e_fixedRotationFlag) == 0) {
         this.m_I -= this.m_mass * (center.x * center.x + center.y * center.y);
         this.m_I *= this.m_inertiaScale;
         b2Settings.b2Assert(this.m_I > 0);
         this.m_invI = 1.0 / this.m_I;
      }
      else {
         this.m_I = 0.0;
         this.m_invI = 0.0;
      }
      var oldCenter = this.m_sweep.c.Copy();
      this.m_sweep.localCenter.SetV(center);
      this.m_sweep.c0.SetV(b2Math.MulX(this.m_xf, this.m_sweep.localCenter));
      this.m_sweep.c.SetV(this.m_sweep.c0);
      this.m_linearVelocity.x += this.m_angularVelocity * (-(this.m_sweep.c.y - oldCenter.y));
      this.m_linearVelocity.y += this.m_angularVelocity * (+(this.m_sweep.c.x - oldCenter.x));
   }
   b2Body.prototype.GetWorldPoint = function (localPoint) {
      var A = this.m_xf.R;
      var u = new b2Vec2(A.col1.x * localPoint.x + A.col2.x * localPoint.y, A.col1.y * localPoint.x + A.col2.y * localPoint.y);
      u.x += this.m_xf.position.x;
      u.y += this.m_xf.position.y;
      return u;
   }
   b2Body.prototype.GetWorldVector = function (localVector) {
      return b2Math.MulMV(this.m_xf.R, localVector);
   }
   b2Body.prototype.GetLocalPoint = function (worldPoint) {
      return b2Math.MulXT(this.m_xf, worldPoint);
   }
   b2Body.prototype.GetLocalVector = function (worldVector) {
      return b2Math.MulTMV(this.m_xf.R, worldVector);
   }
   b2Body.prototype.GetLinearVelocityFromWorldPoint = function (worldPoint) {
      return new b2Vec2(this.m_linearVelocity.x - this.m_angularVelocity * (worldPoint.y - this.m_sweep.c.y), this.m_linearVelocity.y + this.m_angularVelocity * (worldPoint.x - this.m_sweep.c.x));
   }
   b2Body.prototype.GetLinearVelocityFromLocalPoint = function (localPoint) {
      var A = this.m_xf.R;
      var worldPoint = new b2Vec2(A.col1.x * localPoint.x + A.col2.x * localPoint.y, A.col1.y * localPoint.x + A.col2.y * localPoint.y);
      worldPoint.x += this.m_xf.position.x;
      worldPoint.y += this.m_xf.position.y;
      return new b2Vec2(this.m_linearVelocity.x - this.m_angularVelocity * (worldPoint.y - this.m_sweep.c.y), this.m_linearVelocity.y + this.m_angularVelocity * (worldPoint.x - this.m_sweep.c.x));
   }
   b2Body.prototype.GetLinearDamping = function () {
      return this.m_linearDamping;
   }
   b2Body.prototype.SetLinearDamping = function (linearDamping) {
      if (linearDamping === undefined) linearDamping = 0;
      this.m_linearDamping = linearDamping;
   }
   b2Body.prototype.GetAngularDamping = function () {
      return this.m_angularDamping;
   }
   b2Body.prototype.SetAngularDamping = function (angularDamping) {
      if (angularDamping === undefined) angularDamping = 0;
      this.m_angularDamping = angularDamping;
   }
   b2Body.prototype.SetType = function (type) {
      if (type === undefined) type = 0;
      if (this.m_type == type) {
         return;
      }
      this.m_type = type;
      this.ResetMassData();
      if (this.m_type == b2Body.b2_staticBody) {
         this.m_linearVelocity.SetZero();
         this.m_angularVelocity = 0.0;
      }
      this.SetAwake(true);
      this.m_force.SetZero();
      this.m_torque = 0.0;
      for (var ce = this.m_contactList; ce; ce = ce.next) {
         ce.contact.FlagForFiltering();
      }
   }
   b2Body.prototype.GetType = function () {
      return this.m_type;
   }
   b2Body.prototype.SetBullet = function (flag) {
      if (flag) {
         this.m_flags |= b2Body.e_bulletFlag;
      }
      else {
         this.m_flags &= ~b2Body.e_bulletFlag;
      }
   }
   b2Body.prototype.IsBullet = function () {
      return (this.m_flags & b2Body.e_bulletFlag) == b2Body.e_bulletFlag;
   }
   b2Body.prototype.SetSleepingAllowed = function (flag) {
      if (flag) {
         this.m_flags |= b2Body.e_allowSleepFlag;
      }
      else {
         this.m_flags &= ~b2Body.e_allowSleepFlag;
         this.SetAwake(true);
      }
   }
   b2Body.prototype.SetAwake = function (flag) {
      if (flag) {
         this.m_flags |= b2Body.e_awakeFlag;
         this.m_sleepTime = 0.0;
      }
      else {
         this.m_flags &= ~b2Body.e_awakeFlag;
         this.m_sleepTime = 0.0;
         this.m_linearVelocity.SetZero();
         this.m_angularVelocity = 0.0;
         this.m_force.SetZero();
         this.m_torque = 0.0;
      }
   }
   b2Body.prototype.IsAwake = function () {
      return (this.m_flags & b2Body.e_awakeFlag) == b2Body.e_awakeFlag;
   }
   b2Body.prototype.SetFixedRotation = function (fixed) {
      if (fixed) {
         this.m_flags |= b2Body.e_fixedRotationFlag;
      }
      else {
         this.m_flags &= ~b2Body.e_fixedRotationFlag;
      }
      this.ResetMassData();
   }
   b2Body.prototype.IsFixedRotation = function () {
      return (this.m_flags & b2Body.e_fixedRotationFlag) == b2Body.e_fixedRotationFlag;
   }
   b2Body.prototype.SetActive = function (flag) {
      if (flag == this.IsActive()) {
         return;
      }
      var broadPhase;
      var f;
      if (flag) {
         this.m_flags |= b2Body.e_activeFlag;
         broadPhase = this.m_world.m_contactManager.m_broadPhase;
         for (f = this.m_fixtureList;
         f; f = f.m_next) {
            f.CreateProxy(broadPhase, this.m_xf);
         }
      }
      else {
         this.m_flags &= ~b2Body.e_activeFlag;
         broadPhase = this.m_world.m_contactManager.m_broadPhase;
         for (f = this.m_fixtureList;
         f; f = f.m_next) {
            f.DestroyProxy(broadPhase);
         }
         var ce = this.m_contactList;
         while (ce) {
            var ce0 = ce;
            ce = ce.next;
            this.m_world.m_contactManager.Destroy(ce0.contact);
         }
         this.m_contactList = null;
      }
   }
   b2Body.prototype.IsActive = function () {
      return (this.m_flags & b2Body.e_activeFlag) == b2Body.e_activeFlag;
   }
   b2Body.prototype.IsSleepingAllowed = function () {
      return (this.m_flags & b2Body.e_allowSleepFlag) == b2Body.e_allowSleepFlag;
   }
   b2Body.prototype.GetFixtureList = function () {
      return this.m_fixtureList;
   }
   b2Body.prototype.GetJointList = function () {
      return this.m_jointList;
   }
   b2Body.prototype.GetControllerList = function () {
      return this.m_controllerList;
   }
   b2Body.prototype.GetContactList = function () {
      return this.m_contactList;
   }
   b2Body.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Body.prototype.GetUserData = function () {
      return this.m_userData;
   }
   b2Body.prototype.SetUserData = function (data) {
      this.m_userData = data;
   }
   b2Body.prototype.GetWorld = function () {
      return this.m_world;
   }
   b2Body.prototype.b2Body = function (bd, world) {
      this.m_flags = 0;
      if (bd.bullet) {
         this.m_flags |= b2Body.e_bulletFlag;
      }
      if (bd.fixedRotation) {
         this.m_flags |= b2Body.e_fixedRotationFlag;
      }
      if (bd.allowSleep) {
         this.m_flags |= b2Body.e_allowSleepFlag;
      }
      if (bd.awake) {
         this.m_flags |= b2Body.e_awakeFlag;
      }
      if (bd.active) {
         this.m_flags |= b2Body.e_activeFlag;
      }
      this.m_world = world;
      this.m_xf.position.SetV(bd.position);
      this.m_xf.R.Set(bd.angle);
      this.m_sweep.localCenter.SetZero();
      this.m_sweep.t0 = 1.0;
      this.m_sweep.a0 = this.m_sweep.a = bd.angle;
      var tMat = this.m_xf.R;
      var tVec = this.m_sweep.localCenter;
      this.m_sweep.c.x = (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      this.m_sweep.c.y = (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      this.m_sweep.c.x += this.m_xf.position.x;
      this.m_sweep.c.y += this.m_xf.position.y;
      this.m_sweep.c0.SetV(this.m_sweep.c);
      this.m_jointList = null;
      this.m_controllerList = null;
      this.m_contactList = null;
      this.m_controllerCount = 0;
      this.m_prev = null;
      this.m_next = null;
      this.m_linearVelocity.SetV(bd.linearVelocity);
      this.m_angularVelocity = bd.angularVelocity;
      this.m_linearDamping = bd.linearDamping;
      this.m_angularDamping = bd.angularDamping;
      this.m_force.Set(0.0, 0.0);
      this.m_torque = 0.0;
      this.m_sleepTime = 0.0;
      this.m_type = bd.type;
      if (this.m_type == b2Body.b2_dynamicBody) {
         this.m_mass = 1.0;
         this.m_invMass = 1.0;
      }
      else {
         this.m_mass = 0.0;
         this.m_invMass = 0.0;
      }
      this.m_I = 0.0;
      this.m_invI = 0.0;
      this.m_inertiaScale = bd.inertiaScale;
      this.m_userData = bd.userData;
      this.m_fixtureList = null;
      this.m_fixtureCount = 0;
   }
   b2Body.prototype.SynchronizeFixtures = function () {
      var xf1 = b2Body.s_xf1;
      xf1.R.Set(this.m_sweep.a0);
      var tMat = xf1.R;
      var tVec = this.m_sweep.localCenter;
      xf1.position.x = this.m_sweep.c0.x - (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      xf1.position.y = this.m_sweep.c0.y - (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
      var f;
      var broadPhase = this.m_world.m_contactManager.m_broadPhase;
      for (f = this.m_fixtureList;
      f; f = f.m_next) {
         f.Synchronize(broadPhase, xf1, this.m_xf);
      }
   }
   b2Body.prototype.SynchronizeTransform = function () {
      this.m_xf.R.Set(this.m_sweep.a);
      var tMat = this.m_xf.R;
      var tVec = this.m_sweep.localCenter;
      this.m_xf.position.x = this.m_sweep.c.x - (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
      this.m_xf.position.y = this.m_sweep.c.y - (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
   }
   b2Body.prototype.ShouldCollide = function (other) {
      if (this.m_type != b2Body.b2_dynamicBody && other.m_type != b2Body.b2_dynamicBody) {
         return false;
      }
      for (var jn = this.m_jointList; jn; jn = jn.next) {
         if (jn.other == other) if (jn.joint.m_collideConnected == false) {
            return false;
         }
      }
      return true;
   }
   b2Body.prototype.Advance = function (t) {
      if (t === undefined) t = 0;
      this.m_sweep.Advance(t);
      this.m_sweep.c.SetV(this.m_sweep.c0);
      this.m_sweep.a = this.m_sweep.a0;
      this.SynchronizeTransform();
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2Body.s_xf1 = new b2Transform();
      Box2D.Dynamics.b2Body.e_islandFlag = 0x0001;
      Box2D.Dynamics.b2Body.e_awakeFlag = 0x0002;
      Box2D.Dynamics.b2Body.e_allowSleepFlag = 0x0004;
      Box2D.Dynamics.b2Body.e_bulletFlag = 0x0008;
      Box2D.Dynamics.b2Body.e_fixedRotationFlag = 0x0010;
      Box2D.Dynamics.b2Body.e_activeFlag = 0x0020;
      Box2D.Dynamics.b2Body.b2_staticBody = 0;
      Box2D.Dynamics.b2Body.b2_kinematicBody = 1;
      Box2D.Dynamics.b2Body.b2_dynamicBody = 2;
   });
   b2BodyDef.b2BodyDef = function () {
      this.position = new b2Vec2();
      this.linearVelocity = new b2Vec2();
   };
   b2BodyDef.prototype.b2BodyDef = function () {
      this.userData = null;
      this.position.Set(0.0, 0.0);
      this.angle = 0.0;
      this.linearVelocity.Set(0, 0);
      this.angularVelocity = 0.0;
      this.linearDamping = 0.0;
      this.angularDamping = 0.0;
      this.allowSleep = true;
      this.awake = true;
      this.fixedRotation = false;
      this.bullet = false;
      this.type = b2Body.b2_staticBody;
      this.active = true;
      this.inertiaScale = 1.0;
   }
   b2ContactFilter.b2ContactFilter = function () {};
   b2ContactFilter.prototype.ShouldCollide = function (fixtureA, fixtureB) {
      var filter1 = fixtureA.GetFilterData();
      var filter2 = fixtureB.GetFilterData();
      if (filter1.groupIndex == filter2.groupIndex && filter1.groupIndex != 0) {
         return filter1.groupIndex > 0;
      }
      var collide = (filter1.maskBits & filter2.categoryBits) != 0 && (filter1.categoryBits & filter2.maskBits) != 0;
      return collide;
   }
   b2ContactFilter.prototype.RayCollide = function (userData, fixture) {
      if (!userData) return true;
      return this.ShouldCollide((userData instanceof b2Fixture ? userData : null), fixture);
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2ContactFilter.b2_defaultFilter = new b2ContactFilter();
   });
   b2ContactImpulse.b2ContactImpulse = function () {
      this.normalImpulses = new Vector_a2j_Number(b2Settings.b2_maxManifoldPoints);
      this.tangentImpulses = new Vector_a2j_Number(b2Settings.b2_maxManifoldPoints);
   };
   b2ContactListener.b2ContactListener = function () {};
   b2ContactListener.prototype.BeginContact = function (contact) {}
   b2ContactListener.prototype.EndContact = function (contact) {}
   b2ContactListener.prototype.PreSolve = function (contact, oldManifold) {}
   b2ContactListener.prototype.PostSolve = function (contact, impulse) {}
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2ContactListener.b2_defaultListener = new b2ContactListener();
   });
   b2ContactManager.b2ContactManager = function () {};
   b2ContactManager.prototype.b2ContactManager = function () {
      this.m_world = null;
      this.m_contactCount = 0;
      this.m_contactFilter = b2ContactFilter.b2_defaultFilter;
      this.m_contactListener = b2ContactListener.b2_defaultListener;
      this.m_contactFactory = new b2ContactFactory(this.m_allocator);
      this.m_broadPhase = new b2DynamicTreeBroadPhase();
   }
   b2ContactManager.prototype.AddPair = function (proxyUserDataA, proxyUserDataB) {
      var fixtureA = (proxyUserDataA instanceof b2Fixture ? proxyUserDataA : null);
      var fixtureB = (proxyUserDataB instanceof b2Fixture ? proxyUserDataB : null);
      var bodyA = fixtureA.GetBody();
      var bodyB = fixtureB.GetBody();
      if (bodyA == bodyB) return;
      var edge = bodyB.GetContactList();
      while (edge) {
         if (edge.other == bodyA) {
            var fA = edge.contact.GetFixtureA();
            var fB = edge.contact.GetFixtureB();
            if (fA == fixtureA && fB == fixtureB) return;
            if (fA == fixtureB && fB == fixtureA) return;
         }
         edge = edge.next;
      }
      if (bodyB.ShouldCollide(bodyA) == false) {
         return;
      }
      if (this.m_contactFilter.ShouldCollide(fixtureA, fixtureB) == false) {
         return;
      }
      var c = this.m_contactFactory.Create(fixtureA, fixtureB);
      fixtureA = c.GetFixtureA();
      fixtureB = c.GetFixtureB();
      bodyA = fixtureA.m_body;
      bodyB = fixtureB.m_body;
      c.m_prev = null;
      c.m_next = this.m_world.m_contactList;
      if (this.m_world.m_contactList != null) {
         this.m_world.m_contactList.m_prev = c;
      }
      this.m_world.m_contactList = c;
      c.m_nodeA.contact = c;
      c.m_nodeA.other = bodyB;
      c.m_nodeA.prev = null;
      c.m_nodeA.next = bodyA.m_contactList;
      if (bodyA.m_contactList != null) {
         bodyA.m_contactList.prev = c.m_nodeA;
      }
      bodyA.m_contactList = c.m_nodeA;
      c.m_nodeB.contact = c;
      c.m_nodeB.other = bodyA;
      c.m_nodeB.prev = null;
      c.m_nodeB.next = bodyB.m_contactList;
      if (bodyB.m_contactList != null) {
         bodyB.m_contactList.prev = c.m_nodeB;
      }
      bodyB.m_contactList = c.m_nodeB;
      ++this.m_world.m_contactCount;
      return;
   }
   b2ContactManager.prototype.FindNewContacts = function () {
      this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this, this.AddPair));
   }
   b2ContactManager.prototype.Destroy = function (c) {
      var fixtureA = c.GetFixtureA();
      var fixtureB = c.GetFixtureB();
      var bodyA = fixtureA.GetBody();
      var bodyB = fixtureB.GetBody();
      if (c.IsTouching()) {
         this.m_contactListener.EndContact(c);
      }
      if (c.m_prev) {
         c.m_prev.m_next = c.m_next;
      }
      if (c.m_next) {
         c.m_next.m_prev = c.m_prev;
      }
      if (c == this.m_world.m_contactList) {
         this.m_world.m_contactList = c.m_next;
      }
      if (c.m_nodeA.prev) {
         c.m_nodeA.prev.next = c.m_nodeA.next;
      }
      if (c.m_nodeA.next) {
         c.m_nodeA.next.prev = c.m_nodeA.prev;
      }
      if (c.m_nodeA == bodyA.m_contactList) {
         bodyA.m_contactList = c.m_nodeA.next;
      }
      if (c.m_nodeB.prev) {
         c.m_nodeB.prev.next = c.m_nodeB.next;
      }
      if (c.m_nodeB.next) {
         c.m_nodeB.next.prev = c.m_nodeB.prev;
      }
      if (c.m_nodeB == bodyB.m_contactList) {
         bodyB.m_contactList = c.m_nodeB.next;
      }
      this.m_contactFactory.Destroy(c);
      --this.m_contactCount;
   }
   b2ContactManager.prototype.Collide = function () {
      var c = this.m_world.m_contactList;
      while (c) {
         var fixtureA = c.GetFixtureA();
         var fixtureB = c.GetFixtureB();
         var bodyA = fixtureA.GetBody();
         var bodyB = fixtureB.GetBody();
         if (bodyA.IsAwake() == false && bodyB.IsAwake() == false) {
            c = c.GetNext();
            continue;
         }
         if (c.m_flags & b2Contact.e_filterFlag) {
            if (bodyB.ShouldCollide(bodyA) == false) {
               var cNuke = c;
               c = cNuke.GetNext();
               this.Destroy(cNuke);
               continue;
            }
            if (this.m_contactFilter.ShouldCollide(fixtureA, fixtureB) == false) {
               cNuke = c;
               c = cNuke.GetNext();
               this.Destroy(cNuke);
               continue;
            }
            c.m_flags &= ~b2Contact.e_filterFlag;
         }
         var proxyA = fixtureA.m_proxy;
         var proxyB = fixtureB.m_proxy;
         var overlap = this.m_broadPhase.TestOverlap(proxyA, proxyB);
         if (overlap == false) {
            cNuke = c;
            c = cNuke.GetNext();
            this.Destroy(cNuke);
            continue;
         }
         c.Update(this.m_contactListener);
         c = c.GetNext();
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2ContactManager.s_evalCP = new b2ContactPoint();
   });
   b2DebugDraw.b2DebugDraw = function () {};
   b2DebugDraw.prototype.b2DebugDraw = function () {}
   b2DebugDraw.prototype.SetFlags = function (flags) {
      if (flags === undefined) flags = 0;
   }
   b2DebugDraw.prototype.GetFlags = function () {}
   b2DebugDraw.prototype.AppendFlags = function (flags) {
      if (flags === undefined) flags = 0;
   }
   b2DebugDraw.prototype.ClearFlags = function (flags) {
      if (flags === undefined) flags = 0;
   }
   b2DebugDraw.prototype.SetSprite = function (sprite) {}
   b2DebugDraw.prototype.GetSprite = function () {}
   b2DebugDraw.prototype.SetDrawScale = function (drawScale) {
      if (drawScale === undefined) drawScale = 0;
   }
   b2DebugDraw.prototype.GetDrawScale = function () {}
   b2DebugDraw.prototype.SetLineThickness = function (lineThickness) {
      if (lineThickness === undefined) lineThickness = 0;
   }
   b2DebugDraw.prototype.GetLineThickness = function () {}
   b2DebugDraw.prototype.SetAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
   }
   b2DebugDraw.prototype.GetAlpha = function () {}
   b2DebugDraw.prototype.SetFillAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
   }
   b2DebugDraw.prototype.GetFillAlpha = function () {}
   b2DebugDraw.prototype.SetXFormScale = function (xformScale) {
      if (xformScale === undefined) xformScale = 0;
   }
   b2DebugDraw.prototype.GetXFormScale = function () {}
   b2DebugDraw.prototype.DrawPolygon = function (vertices, vertexCount, color) {
      if (vertexCount === undefined) vertexCount = 0;
   }
   b2DebugDraw.prototype.DrawSolidPolygon = function (vertices, vertexCount, color) {
      if (vertexCount === undefined) vertexCount = 0;
   }
   b2DebugDraw.prototype.DrawCircle = function (center, radius, color) {
      if (radius === undefined) radius = 0;
   }
   b2DebugDraw.prototype.DrawSolidCircle = function (center, radius, axis, color) {
      if (radius === undefined) radius = 0;
   }
   b2DebugDraw.prototype.DrawSegment = function (p1, p2, color) {}
   b2DebugDraw.prototype.DrawTransform = function (xf) {}
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2DebugDraw.e_shapeBit = 0x0001;
      Box2D.Dynamics.b2DebugDraw.e_jointBit = 0x0002;
      Box2D.Dynamics.b2DebugDraw.e_aabbBit = 0x0004;
      Box2D.Dynamics.b2DebugDraw.e_pairBit = 0x0008;
      Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit = 0x0010;
      Box2D.Dynamics.b2DebugDraw.e_controllerBit = 0x0020;
   });
   b2DestructionListener.b2DestructionListener = function () {};
   b2DestructionListener.prototype.SayGoodbyeJoint = function (joint) {}
   b2DestructionListener.prototype.SayGoodbyeFixture = function (fixture) {}
   b2FilterData.b2FilterData = function () {
      this.categoryBits = 0x0001;
      this.maskBits = 0xFFFF;
      this.groupIndex = 0;
   };
   b2FilterData.prototype.Copy = function () {
      var copy = new b2FilterData();
      copy.categoryBits = this.categoryBits;
      copy.maskBits = this.maskBits;
      copy.groupIndex = this.groupIndex;
      return copy;
   }
   b2Fixture.b2Fixture = function () {
      this.m_filter = new b2FilterData();
   };
   b2Fixture.prototype.GetType = function () {
      return this.m_shape.GetType();
   }
   b2Fixture.prototype.GetShape = function () {
      return this.m_shape;
   }
   b2Fixture.prototype.SetSensor = function (sensor) {
      if (this.m_isSensor == sensor) return;
      this.m_isSensor = sensor;
      if (this.m_body == null) return;
      var edge = this.m_body.GetContactList();
      while (edge) {
         var contact = edge.contact;
         var fixtureA = contact.GetFixtureA();
         var fixtureB = contact.GetFixtureB();
         if (fixtureA == this || fixtureB == this) contact.SetSensor(fixtureA.IsSensor() || fixtureB.IsSensor());
         edge = edge.next;
      }
   }
   b2Fixture.prototype.IsSensor = function () {
      return this.m_isSensor;
   }
   b2Fixture.prototype.SetFilterData = function (filter) {
      this.m_filter = filter.Copy();
      if (this.m_body) return;
      var edge = this.m_body.GetContactList();
      while (edge) {
         var contact = edge.contact;
         var fixtureA = contact.GetFixtureA();
         var fixtureB = contact.GetFixtureB();
         if (fixtureA == this || fixtureB == this) contact.FlagForFiltering();
         edge = edge.next;
      }
   }
   b2Fixture.prototype.GetFilterData = function () {
      return this.m_filter.Copy();
   }
   b2Fixture.prototype.GetBody = function () {
      return this.m_body;
   }
   b2Fixture.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Fixture.prototype.GetUserData = function () {
      return this.m_userData;
   }
   b2Fixture.prototype.SetUserData = function (data) {
      this.m_userData = data;
   }
   b2Fixture.prototype.TestPoint = function (p) {
      return this.m_shape.TestPoint(this.m_body.GetTransform(), p);
   }
   b2Fixture.prototype.RayCast = function (output, input) {
      return this.m_shape.RayCast(output, input, this.m_body.GetTransform());
   }
   b2Fixture.prototype.GetMassData = function (massData) {
      if (massData === undefined) massData = null;
      if (massData == null) {
         massData = new b2MassData();
      }
      this.m_shape.ComputeMass(massData, this.m_density);
      return massData;
   }
   b2Fixture.prototype.SetDensity = function (density) {
      if (density === undefined) density = 0;
      this.m_density = density;
   }
   b2Fixture.prototype.GetDensity = function () {
      return this.m_density;
   }
   b2Fixture.prototype.GetFriction = function () {
      return this.m_friction;
   }
   b2Fixture.prototype.SetFriction = function (friction) {
      if (friction === undefined) friction = 0;
      this.m_friction = friction;
   }
   b2Fixture.prototype.GetRestitution = function () {
      return this.m_restitution;
   }
   b2Fixture.prototype.SetRestitution = function (restitution) {
      if (restitution === undefined) restitution = 0;
      this.m_restitution = restitution;
   }
   b2Fixture.prototype.GetAABB = function () {
      return this.m_aabb;
   }
   b2Fixture.prototype.b2Fixture = function () {
      this.m_aabb = new b2AABB();
      this.m_userData = null;
      this.m_body = null;
      this.m_next = null;
      this.m_shape = null;
      this.m_density = 0.0;
      this.m_friction = 0.0;
      this.m_restitution = 0.0;
   }
   b2Fixture.prototype.Create = function (body, xf, def) {
      this.m_userData = def.userData;
      this.m_friction = def.friction;
      this.m_restitution = def.restitution;
      this.m_body = body;
      this.m_next = null;
      this.m_filter = def.filter.Copy();
      this.m_isSensor = def.isSensor;
      this.m_shape = def.shape.Copy();
      this.m_density = def.density;
   }
   b2Fixture.prototype.Destroy = function () {
      this.m_shape = null;
   }
   b2Fixture.prototype.CreateProxy = function (broadPhase, xf) {
      this.m_shape.ComputeAABB(this.m_aabb, xf);
      this.m_proxy = broadPhase.CreateProxy(this.m_aabb, this);
   }
   b2Fixture.prototype.DestroyProxy = function (broadPhase) {
      if (this.m_proxy == null) {
         return;
      }
      broadPhase.DestroyProxy(this.m_proxy);
      this.m_proxy = null;
   }
   b2Fixture.prototype.Synchronize = function (broadPhase, transform1, transform2) {
      if (!this.m_proxy) return;
      var aabb1 = new b2AABB();
      var aabb2 = new b2AABB();
      this.m_shape.ComputeAABB(aabb1, transform1);
      this.m_shape.ComputeAABB(aabb2, transform2);
      this.m_aabb.Combine(aabb1, aabb2);
      var displacement = b2Math.SubtractVV(transform2.position, transform1.position);
      broadPhase.MoveProxy(this.m_proxy, this.m_aabb, displacement);
   }
   b2FixtureDef.b2FixtureDef = function () {
      this.filter = new b2FilterData();
   };
   b2FixtureDef.prototype.b2FixtureDef = function () {
      this.shape = null;
      this.userData = null;
      this.friction = 0.2;
      this.restitution = 0.0;
      this.density = 0.0;
      this.filter.categoryBits = 0x0001;
      this.filter.maskBits = 0xFFFF;
      this.filter.groupIndex = 0;
      this.isSensor = false;
   }
   b2Island.b2Island = function () {};
   b2Island.prototype.b2Island = function () {
      this.m_bodies = new Vector();
      this.m_contacts = new Vector();
      this.m_joints = new Vector();
   }
   b2Island.prototype.Initialize = function (bodyCapacity, contactCapacity, jointCapacity, allocator, listener, contactSolver) {
      if (bodyCapacity === undefined) bodyCapacity = 0;
      if (contactCapacity === undefined) contactCapacity = 0;
      if (jointCapacity === undefined) jointCapacity = 0;
      var i = 0;
      this.m_bodyCapacity = bodyCapacity;
      this.m_contactCapacity = contactCapacity;
      this.m_jointCapacity = jointCapacity;
      this.m_bodyCount = 0;
      this.m_contactCount = 0;
      this.m_jointCount = 0;
      this.m_allocator = allocator;
      this.m_listener = listener;
      this.m_contactSolver = contactSolver;
      for (i = this.m_bodies.length;
      i < bodyCapacity; i++)
      this.m_bodies[i] = null;
      for (i = this.m_contacts.length;
      i < contactCapacity; i++)
      this.m_contacts[i] = null;
      for (i = this.m_joints.length;
      i < jointCapacity; i++)
      this.m_joints[i] = null;
   }
   b2Island.prototype.Clear = function () {
      this.m_bodyCount = 0;
      this.m_contactCount = 0;
      this.m_jointCount = 0;
   }
   b2Island.prototype.Solve = function (step, gravity, allowSleep) {
      var i = 0;
      var j = 0;
      var b;
      var joint;
      for (i = 0;
      i < this.m_bodyCount; ++i) {
         b = this.m_bodies[i];
         if (b.GetType() != b2Body.b2_dynamicBody) continue;
         b.m_linearVelocity.x += step.dt * (gravity.x + b.m_invMass * b.m_force.x);
         b.m_linearVelocity.y += step.dt * (gravity.y + b.m_invMass * b.m_force.y);
         b.m_angularVelocity += step.dt * b.m_invI * b.m_torque;
         b.m_linearVelocity.Multiply(b2Math.Clamp(1.0 - step.dt * b.m_linearDamping, 0.0, 1.0));
         b.m_angularVelocity *= b2Math.Clamp(1.0 - step.dt * b.m_angularDamping, 0.0, 1.0);
      }
      this.m_contactSolver.Initialize(step, this.m_contacts, this.m_contactCount, this.m_allocator);
      var contactSolver = this.m_contactSolver;
      contactSolver.InitVelocityConstraints(step);
      for (i = 0;
      i < this.m_jointCount; ++i) {
         joint = this.m_joints[i];
         joint.InitVelocityConstraints(step);
      }
      for (i = 0;
      i < step.velocityIterations; ++i) {
         for (j = 0;
         j < this.m_jointCount; ++j) {
            joint = this.m_joints[j];
            joint.SolveVelocityConstraints(step);
         }
         contactSolver.SolveVelocityConstraints();
      }
      for (i = 0;
      i < this.m_jointCount; ++i) {
         joint = this.m_joints[i];
         joint.FinalizeVelocityConstraints();
      }
      contactSolver.FinalizeVelocityConstraints();
      for (i = 0;
      i < this.m_bodyCount; ++i) {
         b = this.m_bodies[i];
         if (b.GetType() == b2Body.b2_staticBody) continue;
         var translationX = step.dt * b.m_linearVelocity.x;
         var translationY = step.dt * b.m_linearVelocity.y;
         if ((translationX * translationX + translationY * translationY) > b2Settings.b2_maxTranslationSquared) {
            b.m_linearVelocity.Normalize();
            b.m_linearVelocity.x *= b2Settings.b2_maxTranslation * step.inv_dt;
            b.m_linearVelocity.y *= b2Settings.b2_maxTranslation * step.inv_dt;
         }
         var rotation = step.dt * b.m_angularVelocity;
         if (rotation * rotation > b2Settings.b2_maxRotationSquared) {
            if (b.m_angularVelocity < 0.0) {
               b.m_angularVelocity = (-b2Settings.b2_maxRotation * step.inv_dt);
            }
            else {
               b.m_angularVelocity = b2Settings.b2_maxRotation * step.inv_dt;
            }
         }
         b.m_sweep.c0.SetV(b.m_sweep.c);
         b.m_sweep.a0 = b.m_sweep.a;
         b.m_sweep.c.x += step.dt * b.m_linearVelocity.x;
         b.m_sweep.c.y += step.dt * b.m_linearVelocity.y;
         b.m_sweep.a += step.dt * b.m_angularVelocity;
         b.SynchronizeTransform();
      }
      for (i = 0;
      i < step.positionIterations; ++i) {
         var contactsOkay = contactSolver.SolvePositionConstraints(b2Settings.b2_contactBaumgarte);
         var jointsOkay = true;
         for (j = 0;
         j < this.m_jointCount; ++j) {
            joint = this.m_joints[j];
            var jointOkay = joint.SolvePositionConstraints(b2Settings.b2_contactBaumgarte);
            jointsOkay = jointsOkay && jointOkay;
         }
         if (contactsOkay && jointsOkay) {
            break;
         }
      }
      this.Report(contactSolver.m_constraints);
      if (allowSleep) {
         var minSleepTime = Number.MAX_VALUE;
         var linTolSqr = b2Settings.b2_linearSleepTolerance * b2Settings.b2_linearSleepTolerance;
         var angTolSqr = b2Settings.b2_angularSleepTolerance * b2Settings.b2_angularSleepTolerance;
         for (i = 0;
         i < this.m_bodyCount; ++i) {
            b = this.m_bodies[i];
            if (b.GetType() == b2Body.b2_staticBody) {
               continue;
            }
            if ((b.m_flags & b2Body.e_allowSleepFlag) == 0) {
               b.m_sleepTime = 0.0;
               minSleepTime = 0.0;
            }
            if ((b.m_flags & b2Body.e_allowSleepFlag) == 0 || b.m_angularVelocity * b.m_angularVelocity > angTolSqr || b2Math.Dot(b.m_linearVelocity, b.m_linearVelocity) > linTolSqr) {
               b.m_sleepTime = 0.0;
               minSleepTime = 0.0;
            }
            else {
               b.m_sleepTime += step.dt;
               minSleepTime = b2Math.Min(minSleepTime, b.m_sleepTime);
            }
         }
         if (minSleepTime >= b2Settings.b2_timeToSleep) {
            for (i = 0;
            i < this.m_bodyCount; ++i) {
               b = this.m_bodies[i];
               b.SetAwake(false);
            }
         }
      }
   }
   b2Island.prototype.SolveTOI = function (subStep) {
      var i = 0;
      var j = 0;
      this.m_contactSolver.Initialize(subStep, this.m_contacts, this.m_contactCount, this.m_allocator);
      var contactSolver = this.m_contactSolver;
      for (i = 0;
      i < this.m_jointCount; ++i) {
         this.m_joints[i].InitVelocityConstraints(subStep);
      }
      for (i = 0;
      i < subStep.velocityIterations; ++i) {
         contactSolver.SolveVelocityConstraints();
         for (j = 0;
         j < this.m_jointCount; ++j) {
            this.m_joints[j].SolveVelocityConstraints(subStep);
         }
      }
      for (i = 0;
      i < this.m_bodyCount; ++i) {
         var b = this.m_bodies[i];
         if (b.GetType() == b2Body.b2_staticBody) continue;
         var translationX = subStep.dt * b.m_linearVelocity.x;
         var translationY = subStep.dt * b.m_linearVelocity.y;
         if ((translationX * translationX + translationY * translationY) > b2Settings.b2_maxTranslationSquared) {
            b.m_linearVelocity.Normalize();
            b.m_linearVelocity.x *= b2Settings.b2_maxTranslation * subStep.inv_dt;
            b.m_linearVelocity.y *= b2Settings.b2_maxTranslation * subStep.inv_dt;
         }
         var rotation = subStep.dt * b.m_angularVelocity;
         if (rotation * rotation > b2Settings.b2_maxRotationSquared) {
            if (b.m_angularVelocity < 0.0) {
               b.m_angularVelocity = (-b2Settings.b2_maxRotation * subStep.inv_dt);
            }
            else {
               b.m_angularVelocity = b2Settings.b2_maxRotation * subStep.inv_dt;
            }
         }
         b.m_sweep.c0.SetV(b.m_sweep.c);
         b.m_sweep.a0 = b.m_sweep.a;
         b.m_sweep.c.x += subStep.dt * b.m_linearVelocity.x;
         b.m_sweep.c.y += subStep.dt * b.m_linearVelocity.y;
         b.m_sweep.a += subStep.dt * b.m_angularVelocity;
         b.SynchronizeTransform();
      }
      var k_toiBaumgarte = 0.75;
      for (i = 0;
      i < subStep.positionIterations; ++i) {
         var contactsOkay = contactSolver.SolvePositionConstraints(k_toiBaumgarte);
         var jointsOkay = true;
         for (j = 0;
         j < this.m_jointCount; ++j) {
            var jointOkay = this.m_joints[j].SolvePositionConstraints(b2Settings.b2_contactBaumgarte);
            jointsOkay = jointsOkay && jointOkay;
         }
         if (contactsOkay && jointsOkay) {
            break;
         }
      }
      this.Report(contactSolver.m_constraints);
   }
   b2Island.prototype.Report = function (constraints) {
      if (this.m_listener == null) {
         return;
      }
      for (var i = 0; i < this.m_contactCount; ++i) {
         var c = this.m_contacts[i];
         var cc = constraints[i];
         for (var j = 0; j < cc.pointCount; ++j) {
            b2Island.s_impulse.normalImpulses[j] = cc.points[j].normalImpulse;
            b2Island.s_impulse.tangentImpulses[j] = cc.points[j].tangentImpulse;
         }
         this.m_listener.PostSolve(c, b2Island.s_impulse);
      }
   }
   b2Island.prototype.AddBody = function (body) {
      body.m_islandIndex = this.m_bodyCount;
      this.m_bodies[this.m_bodyCount++] = body;
   }
   b2Island.prototype.AddContact = function (contact) {
      this.m_contacts[this.m_contactCount++] = contact;
   }
   b2Island.prototype.AddJoint = function (joint) {
      this.m_joints[this.m_jointCount++] = joint;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2Island.s_impulse = new b2ContactImpulse();
   });
   b2TimeStep.b2TimeStep = function () {};
   b2TimeStep.prototype.Set = function (step) {
      this.dt = step.dt;
      this.inv_dt = step.inv_dt;
      this.positionIterations = step.positionIterations;
      this.velocityIterations = step.velocityIterations;
      this.warmStarting = step.warmStarting;
   }
   b2World.b2World = function () {
      this.s_stack = new Vector();
      this.m_contactManager = new b2ContactManager();
      this.m_contactSolver = new b2ContactSolver();
      this.m_island = new b2Island();
   };
   b2World.prototype.b2World = function (gravity, doSleep) {
      this.m_destructionListener = null;
      this.m_debugDraw = null;
      this.m_bodyList = null;
      this.m_contactList = null;
      this.m_jointList = null;
      this.m_controllerList = null;
      this.m_bodyCount = 0;
      this.m_contactCount = 0;
      this.m_jointCount = 0;
      this.m_controllerCount = 0;
      b2World.m_warmStarting = true;
      b2World.m_continuousPhysics = true;
      this.m_allowSleep = doSleep;
      this.m_gravity = gravity;
      this.m_inv_dt0 = 0.0;
      this.m_contactManager.m_world = this;
      var bd = new b2BodyDef();
      this.m_groundBody = this.CreateBody(bd);
   }
   b2World.prototype.SetDestructionListener = function (listener) {
      this.m_destructionListener = listener;
   }
   b2World.prototype.SetContactFilter = function (filter) {
      this.m_contactManager.m_contactFilter = filter;
   }
   b2World.prototype.SetContactListener = function (listener) {
      this.m_contactManager.m_contactListener = listener;
   }
   b2World.prototype.SetDebugDraw = function (debugDraw) {
      this.m_debugDraw = debugDraw;
   }
   b2World.prototype.SetBroadPhase = function (broadPhase) {
      var oldBroadPhase = this.m_contactManager.m_broadPhase;
      this.m_contactManager.m_broadPhase = broadPhase;
      for (var b = this.m_bodyList; b; b = b.m_next) {
         for (var f = b.m_fixtureList; f; f = f.m_next) {
            f.m_proxy = broadPhase.CreateProxy(oldBroadPhase.GetFatAABB(f.m_proxy), f);
         }
      }
   }
   b2World.prototype.Validate = function () {
      this.m_contactManager.m_broadPhase.Validate();
   }
   b2World.prototype.GetProxyCount = function () {
      return this.m_contactManager.m_broadPhase.GetProxyCount();
   }
   b2World.prototype.CreateBody = function (def) {
      if (this.IsLocked() == true) {
         return null;
      }
      var b = new b2Body(def, this);
      b.m_prev = null;
      b.m_next = this.m_bodyList;
      if (this.m_bodyList) {
         this.m_bodyList.m_prev = b;
      }
      this.m_bodyList = b;
      ++this.m_bodyCount;
      return b;
   }
   b2World.prototype.DestroyBody = function (b) {
      if (this.IsLocked() == true) {
         return;
      }
      var jn = b.m_jointList;
      while (jn) {
         var jn0 = jn;
         jn = jn.next;
         if (this.m_destructionListener) {
            this.m_destructionListener.SayGoodbyeJoint(jn0.joint);
         }
         this.DestroyJoint(jn0.joint);
      }
      var coe = b.m_controllerList;
      while (coe) {
         var coe0 = coe;
         coe = coe.nextController;
         coe0.controller.RemoveBody(b);
      }
      var ce = b.m_contactList;
      while (ce) {
         var ce0 = ce;
         ce = ce.next;
         this.m_contactManager.Destroy(ce0.contact);
      }
      b.m_contactList = null;
      var f = b.m_fixtureList;
      while (f) {
         var f0 = f;
         f = f.m_next;
         if (this.m_destructionListener) {
            this.m_destructionListener.SayGoodbyeFixture(f0);
         }
         f0.DestroyProxy(this.m_contactManager.m_broadPhase);
         f0.Destroy();
      }
      b.m_fixtureList = null;
      b.m_fixtureCount = 0;
      if (b.m_prev) {
         b.m_prev.m_next = b.m_next;
      }
      if (b.m_next) {
         b.m_next.m_prev = b.m_prev;
      }
      if (b == this.m_bodyList) {
         this.m_bodyList = b.m_next;
      }--this.m_bodyCount;
   }
   b2World.prototype.CreateJoint = function (def) {
      var j = b2Joint.Create(def, null);
      j.m_prev = null;
      j.m_next = this.m_jointList;
      if (this.m_jointList) {
         this.m_jointList.m_prev = j;
      }
      this.m_jointList = j;
      ++this.m_jointCount;
      j.m_edgeA.joint = j;
      j.m_edgeA.other = j.m_bodyB;
      j.m_edgeA.prev = null;
      j.m_edgeA.next = j.m_bodyA.m_jointList;
      if (j.m_bodyA.m_jointList) j.m_bodyA.m_jointList.prev = j.m_edgeA;
      j.m_bodyA.m_jointList = j.m_edgeA;
      j.m_edgeB.joint = j;
      j.m_edgeB.other = j.m_bodyA;
      j.m_edgeB.prev = null;
      j.m_edgeB.next = j.m_bodyB.m_jointList;
      if (j.m_bodyB.m_jointList) j.m_bodyB.m_jointList.prev = j.m_edgeB;
      j.m_bodyB.m_jointList = j.m_edgeB;
      var bodyA = def.bodyA;
      var bodyB = def.bodyB;
      if (def.collideConnected == false) {
         var edge = bodyB.GetContactList();
         while (edge) {
            if (edge.other == bodyA) {
               edge.contact.FlagForFiltering();
            }
            edge = edge.next;
         }
      }
      return j;
   }
   b2World.prototype.DestroyJoint = function (j) {
      var collideConnected = j.m_collideConnected;
      if (j.m_prev) {
         j.m_prev.m_next = j.m_next;
      }
      if (j.m_next) {
         j.m_next.m_prev = j.m_prev;
      }
      if (j == this.m_jointList) {
         this.m_jointList = j.m_next;
      }
      var bodyA = j.m_bodyA;
      var bodyB = j.m_bodyB;
      bodyA.SetAwake(true);
      bodyB.SetAwake(true);
      if (j.m_edgeA.prev) {
         j.m_edgeA.prev.next = j.m_edgeA.next;
      }
      if (j.m_edgeA.next) {
         j.m_edgeA.next.prev = j.m_edgeA.prev;
      }
      if (j.m_edgeA == bodyA.m_jointList) {
         bodyA.m_jointList = j.m_edgeA.next;
      }
      j.m_edgeA.prev = null;
      j.m_edgeA.next = null;
      if (j.m_edgeB.prev) {
         j.m_edgeB.prev.next = j.m_edgeB.next;
      }
      if (j.m_edgeB.next) {
         j.m_edgeB.next.prev = j.m_edgeB.prev;
      }
      if (j.m_edgeB == bodyB.m_jointList) {
         bodyB.m_jointList = j.m_edgeB.next;
      }
      j.m_edgeB.prev = null;
      j.m_edgeB.next = null;
      b2Joint.Destroy(j, null);
      --this.m_jointCount;
      if (collideConnected == false) {
         var edge = bodyB.GetContactList();
         while (edge) {
            if (edge.other == bodyA) {
               edge.contact.FlagForFiltering();
            }
            edge = edge.next;
         }
      }
   }
   b2World.prototype.AddController = function (c) {
      c.m_next = this.m_controllerList;
      c.m_prev = null;
      this.m_controllerList = c;
      c.m_world = this;
      this.m_controllerCount++;
      return c;
   }
   b2World.prototype.RemoveController = function (c) {
      if (c.m_prev) c.m_prev.m_next = c.m_next;
      if (c.m_next) c.m_next.m_prev = c.m_prev;
      if (this.m_controllerList == c) this.m_controllerList = c.m_next;
      this.m_controllerCount--;
   }
   b2World.prototype.CreateController = function (controller) {
      if (controller.m_world != this) throw new Error("Controller can only be a member of one world");
      controller.m_next = this.m_controllerList;
      controller.m_prev = null;
      if (this.m_controllerList) this.m_controllerList.m_prev = controller;
      this.m_controllerList = controller;
      ++this.m_controllerCount;
      controller.m_world = this;
      return controller;
   }
   b2World.prototype.DestroyController = function (controller) {
      controller.Clear();
      if (controller.m_next) controller.m_next.m_prev = controller.m_prev;
      if (controller.m_prev) controller.m_prev.m_next = controller.m_next;
      if (controller == this.m_controllerList) this.m_controllerList = controller.m_next;
      --this.m_controllerCount;
   }
   b2World.prototype.SetWarmStarting = function (flag) {
      b2World.m_warmStarting = flag;
   }
   b2World.prototype.SetContinuousPhysics = function (flag) {
      b2World.m_continuousPhysics = flag;
   }
   b2World.prototype.GetBodyCount = function () {
      return this.m_bodyCount;
   }
   b2World.prototype.GetJointCount = function () {
      return this.m_jointCount;
   }
   b2World.prototype.GetContactCount = function () {
      return this.m_contactCount;
   }
   b2World.prototype.SetGravity = function (gravity) {
      this.m_gravity = gravity;
   }
   b2World.prototype.GetGravity = function () {
      return this.m_gravity;
   }
   b2World.prototype.GetGroundBody = function () {
      return this.m_groundBody;
   }
   b2World.prototype.Step = function (dt, velocityIterations, positionIterations) {
      if (dt === undefined) dt = 0;
      if (velocityIterations === undefined) velocityIterations = 0;
      if (positionIterations === undefined) positionIterations = 0;
      if (this.m_flags & b2World.e_newFixture) {
         this.m_contactManager.FindNewContacts();
         this.m_flags &= ~b2World.e_newFixture;
      }
      this.m_flags |= b2World.e_locked;
      var step = b2World.s_timestep2;
      step.dt = dt;
      step.velocityIterations = velocityIterations;
      step.positionIterations = positionIterations;
      if (dt > 0.0) {
         step.inv_dt = 1.0 / dt;
      }
      else {
         step.inv_dt = 0.0;
      }
      step.dtRatio = this.m_inv_dt0 * dt;
      step.warmStarting = b2World.m_warmStarting;
      this.m_contactManager.Collide();
      if (step.dt > 0.0) {
         this.Solve(step);
      }
      if (b2World.m_continuousPhysics && step.dt > 0.0) {
         this.SolveTOI(step);
      }
      if (step.dt > 0.0) {
         this.m_inv_dt0 = step.inv_dt;
      }
      this.m_flags &= ~b2World.e_locked;
   }
   b2World.prototype.ClearForces = function () {
      for (var body = this.m_bodyList; body; body = body.m_next) {
         body.m_force.SetZero();
         body.m_torque = 0.0;
      }
   }
   b2World.prototype.DrawDebugData = function () {
      if (this.m_debugDraw == null) {
         return;
      }
      this.m_debugDraw.m_sprite.graphics.clear();
      var flags = this.m_debugDraw.GetFlags();
      var i = 0;
      var b;
      var f;
      var s;
      var j;
      var bp;
      var invQ = new b2Vec2;
      var x1 = new b2Vec2;
      var x2 = new b2Vec2;
      var xf;
      var b1 = new b2AABB();
      var b2 = new b2AABB();
      var vs = [new b2Vec2(), new b2Vec2(), new b2Vec2(), new b2Vec2()];
      var color = new b2Color(0, 0, 0);
      if (flags & b2DebugDraw.e_shapeBit) {
         for (b = this.m_bodyList;
         b; b = b.m_next) {
            xf = b.m_xf;
            for (f = b.GetFixtureList();
            f; f = f.m_next) {
               s = f.GetShape();
               if (b.IsActive() == false) {
                  color.Set(0.5, 0.5, 0.3);
                  this.DrawShape(s, xf, color);
               }
               else if (b.GetType() == b2Body.b2_staticBody) {
                  color.Set(0.5, 0.9, 0.5);
                  this.DrawShape(s, xf, color);
               }
               else if (b.GetType() == b2Body.b2_kinematicBody) {
                  color.Set(0.5, 0.5, 0.9);
                  this.DrawShape(s, xf, color);
               }
               else if (b.IsAwake() == false) {
                  color.Set(0.6, 0.6, 0.6);
                  this.DrawShape(s, xf, color);
               }
               else {
                  color.Set(0.9, 0.7, 0.7);
                  this.DrawShape(s, xf, color);
               }
            }
         }
      }
      if (flags & b2DebugDraw.e_jointBit) {
         for (j = this.m_jointList;
         j; j = j.m_next) {
            this.DrawJoint(j);
         }
      }
      if (flags & b2DebugDraw.e_controllerBit) {
         for (var c = this.m_controllerList; c; c = c.m_next) {
            c.Draw(this.m_debugDraw);
         }
      }
      if (flags & b2DebugDraw.e_pairBit) {
         color.Set(0.3, 0.9, 0.9);
         for (var contact = this.m_contactManager.m_contactList; contact; contact = contact.GetNext()) {
            var fixtureA = contact.GetFixtureA();
            var fixtureB = contact.GetFixtureB();
            var cA = fixtureA.GetAABB().GetCenter();
            var cB = fixtureB.GetAABB().GetCenter();
            this.m_debugDraw.DrawSegment(cA, cB, color);
         }
      }
      if (flags & b2DebugDraw.e_aabbBit) {
         bp = this.m_contactManager.m_broadPhase;
         vs = [new b2Vec2(), new b2Vec2(), new b2Vec2(), new b2Vec2()];
         for (b = this.m_bodyList;
         b; b = b.GetNext()) {
            if (b.IsActive() == false) {
               continue;
            }
            for (f = b.GetFixtureList();
            f; f = f.GetNext()) {
               var aabb = bp.GetFatAABB(f.m_proxy);
               vs[0].Set(aabb.lowerBound.x, aabb.lowerBound.y);
               vs[1].Set(aabb.upperBound.x, aabb.lowerBound.y);
               vs[2].Set(aabb.upperBound.x, aabb.upperBound.y);
               vs[3].Set(aabb.lowerBound.x, aabb.upperBound.y);
               this.m_debugDraw.DrawPolygon(vs, 4, color);
            }
         }
      }
      if (flags & b2DebugDraw.e_centerOfMassBit) {
         for (b = this.m_bodyList;
         b; b = b.m_next) {
            xf = b2World.s_xf;
            xf.R = b.m_xf.R;
            xf.position = b.GetWorldCenter();
            this.m_debugDraw.DrawTransform(xf);
         }
      }
   }
   b2World.prototype.QueryAABB = function (callback, aabb) {
      var __this = this;
      var broadPhase = __this.m_contactManager.m_broadPhase;

      function WorldQueryWrapper(proxy) {
         return callback(broadPhase.GetUserData(proxy));
      };
      broadPhase.Query(WorldQueryWrapper, aabb);
   }
   b2World.prototype.QueryShape = function (callback, shape, transform) {
      var __this = this;
      if (transform === undefined) transform = null;
      if (transform == null) {
         transform = new b2Transform();
         transform.SetIdentity();
      }
      var broadPhase = __this.m_contactManager.m_broadPhase;

      function WorldQueryWrapper(proxy) {
         var fixture = (broadPhase.GetUserData(proxy) instanceof b2Fixture ? broadPhase.GetUserData(proxy) : null);
         if (b2Shape.TestOverlap(shape, transform, fixture.GetShape(), fixture.GetBody().GetTransform())) return callback(fixture);
         return true;
      };
      var aabb = new b2AABB();
      shape.ComputeAABB(aabb, transform);
      broadPhase.Query(WorldQueryWrapper, aabb);
   }
   b2World.prototype.QueryPoint = function (callback, p) {
      var __this = this;
      var broadPhase = __this.m_contactManager.m_broadPhase;

      function WorldQueryWrapper(proxy) {
         var fixture = (broadPhase.GetUserData(proxy) instanceof b2Fixture ? broadPhase.GetUserData(proxy) : null);
         if (fixture.TestPoint(p)) return callback(fixture);
         return true;
      };
      var aabb = new b2AABB();
      aabb.lowerBound.Set(p.x - b2Settings.b2_linearSlop, p.y - b2Settings.b2_linearSlop);
      aabb.upperBound.Set(p.x + b2Settings.b2_linearSlop, p.y + b2Settings.b2_linearSlop);
      broadPhase.Query(WorldQueryWrapper, aabb);
   }
   b2World.prototype.RayCast = function (callback, point1, point2) {
      var __this = this;
      var broadPhase = __this.m_contactManager.m_broadPhase;
      var output = new b2RayCastOutput;

      function RayCastWrapper(input, proxy) {
         var userData = broadPhase.GetUserData(proxy);
         var fixture = (userData instanceof b2Fixture ? userData : null);
         var hit = fixture.RayCast(output, input);
         if (hit) {
            var fraction = output.fraction;
            var point = new b2Vec2((1.0 - fraction) * point1.x + fraction * point2.x, (1.0 - fraction) * point1.y + fraction * point2.y);
            return callback(fixture, point, output.normal, fraction);
         }
         return input.maxFraction;
      };
      var input = new b2RayCastInput(point1, point2);
      broadPhase.RayCast(RayCastWrapper, input);
   }
   b2World.prototype.RayCastOne = function (point1, point2) {
      var __this = this;
      var result;

      function RayCastOneWrapper(fixture, point, normal, fraction) {
         if (fraction === undefined) fraction = 0;
         result = fixture;
         return fraction;
      };
      __this.RayCast(RayCastOneWrapper, point1, point2);
      return result;
   }
   b2World.prototype.RayCastAll = function (point1, point2) {
      var __this = this;
      var result = new Vector();

      function RayCastAllWrapper(fixture, point, normal, fraction) {
         if (fraction === undefined) fraction = 0;
         result[result.length] = fixture;
         return 1;
      };
      __this.RayCast(RayCastAllWrapper, point1, point2);
      return result;
   }
   b2World.prototype.GetBodyList = function () {
      return this.m_bodyList;
   }
   b2World.prototype.GetJointList = function () {
      return this.m_jointList;
   }
   b2World.prototype.GetContactList = function () {
      return this.m_contactList;
   }
   b2World.prototype.IsLocked = function () {
      return (this.m_flags & b2World.e_locked) > 0;
   }
   b2World.prototype.Solve = function (step) {
      var b;
      for (var controller = this.m_controllerList; controller; controller = controller.m_next) {
         controller.Step(step);
      }
      var island = this.m_island;
      island.Initialize(this.m_bodyCount, this.m_contactCount, this.m_jointCount, null, this.m_contactManager.m_contactListener, this.m_contactSolver);
      for (b = this.m_bodyList;
      b; b = b.m_next) {
         b.m_flags &= ~b2Body.e_islandFlag;
      }
      for (var c = this.m_contactList; c; c = c.m_next) {
         c.m_flags &= ~b2Contact.e_islandFlag;
      }
      for (var j = this.m_jointList; j; j = j.m_next) {
         j.m_islandFlag = false;
      }
      var stackSize = parseInt(this.m_bodyCount);
      var stack = this.s_stack;
      for (var seed = this.m_bodyList; seed; seed = seed.m_next) {
         if (seed.m_flags & b2Body.e_islandFlag) {
            continue;
         }
         if (seed.IsAwake() == false || seed.IsActive() == false) {
            continue;
         }
         if (seed.GetType() == b2Body.b2_staticBody) {
            continue;
         }
         island.Clear();
         var stackCount = 0;
         stack[stackCount++] = seed;
         seed.m_flags |= b2Body.e_islandFlag;
         while (stackCount > 0) {
            b = stack[--stackCount];
            island.AddBody(b);
            if (b.IsAwake() == false) {
               b.SetAwake(true);
            }
            if (b.GetType() == b2Body.b2_staticBody) {
               continue;
            }
            var other;
            for (var ce = b.m_contactList; ce; ce = ce.next) {
               if (ce.contact.m_flags & b2Contact.e_islandFlag) {
                  continue;
               }
               if (ce.contact.IsSensor() == true || ce.contact.IsEnabled() == false || ce.contact.IsTouching() == false) {
                  continue;
               }
               island.AddContact(ce.contact);
               ce.contact.m_flags |= b2Contact.e_islandFlag;
               other = ce.other;
               if (other.m_flags & b2Body.e_islandFlag) {
                  continue;
               }
               stack[stackCount++] = other;
               other.m_flags |= b2Body.e_islandFlag;
            }
            for (var jn = b.m_jointList; jn; jn = jn.next) {
               if (jn.joint.m_islandFlag == true) {
                  continue;
               }
               other = jn.other;
               if (other.IsActive() == false) {
                  continue;
               }
               island.AddJoint(jn.joint);
               jn.joint.m_islandFlag = true;
               if (other.m_flags & b2Body.e_islandFlag) {
                  continue;
               }
               stack[stackCount++] = other;
               other.m_flags |= b2Body.e_islandFlag;
            }
         }
         island.Solve(step, this.m_gravity, this.m_allowSleep);
         for (var i = 0; i < island.m_bodyCount; ++i) {
            b = island.m_bodies[i];
            if (b.GetType() == b2Body.b2_staticBody) {
               b.m_flags &= ~b2Body.e_islandFlag;
            }
         }
      }
      for (i = 0;
      i < stack.length; ++i) {
         if (!stack[i]) break;
         stack[i] = null;
      }
      for (b = this.m_bodyList;
      b; b = b.m_next) {
         if (b.IsAwake() == false || b.IsActive() == false) {
            continue;
         }
         if (b.GetType() == b2Body.b2_staticBody) {
            continue;
         }
         b.SynchronizeFixtures();
      }
      this.m_contactManager.FindNewContacts();
   }
   b2World.prototype.SolveTOI = function (step) {
      var b;
      var fA;
      var fB;
      var bA;
      var bB;
      var cEdge;
      var j;
      var island = this.m_island;
      island.Initialize(this.m_bodyCount, b2Settings.b2_maxTOIContactsPerIsland, b2Settings.b2_maxTOIJointsPerIsland, null, this.m_contactManager.m_contactListener, this.m_contactSolver);
      var queue = b2World.s_queue;
      for (b = this.m_bodyList;
      b; b = b.m_next) {
         b.m_flags &= ~b2Body.e_islandFlag;
         b.m_sweep.t0 = 0.0;
      }
      var c;
      for (c = this.m_contactList;
      c; c = c.m_next) {
         c.m_flags &= ~ (b2Contact.e_toiFlag | b2Contact.e_islandFlag);
      }
      for (j = this.m_jointList;
      j; j = j.m_next) {
         j.m_islandFlag = false;
      }
      for (;;) {
         var minContact = null;
         var minTOI = 1.0;
         for (c = this.m_contactList;
         c; c = c.m_next) {
            if (c.IsSensor() == true || c.IsEnabled() == false || c.IsContinuous() == false) {
               continue;
            }
            var toi = 1.0;
            if (c.m_flags & b2Contact.e_toiFlag) {
               toi = c.m_toi;
            }
            else {
               fA = c.m_fixtureA;
               fB = c.m_fixtureB;
               bA = fA.m_body;
               bB = fB.m_body;
               if ((bA.GetType() != b2Body.b2_dynamicBody || bA.IsAwake() == false) && (bB.GetType() != b2Body.b2_dynamicBody || bB.IsAwake() == false)) {
                  continue;
               }
               var t0 = bA.m_sweep.t0;
               if (bA.m_sweep.t0 < bB.m_sweep.t0) {
                  t0 = bB.m_sweep.t0;
                  bA.m_sweep.Advance(t0);
               }
               else if (bB.m_sweep.t0 < bA.m_sweep.t0) {
                  t0 = bA.m_sweep.t0;
                  bB.m_sweep.Advance(t0);
               }
               toi = c.ComputeTOI(bA.m_sweep, bB.m_sweep);
               b2Settings.b2Assert(0.0 <= toi && toi <= 1.0);
               if (toi > 0.0 && toi < 1.0) {
                  toi = (1.0 - toi) * t0 + toi;
                  if (toi > 1) toi = 1;
               }
               c.m_toi = toi;
               c.m_flags |= b2Contact.e_toiFlag;
            }
            if (Number.MIN_VALUE < toi && toi < minTOI) {
               minContact = c;
               minTOI = toi;
            }
         }
         if (minContact == null || 1.0 - 100.0 * Number.MIN_VALUE < minTOI) {
            break;
         }
         fA = minContact.m_fixtureA;
         fB = minContact.m_fixtureB;
         bA = fA.m_body;
         bB = fB.m_body;
         b2World.s_backupA.Set(bA.m_sweep);
         b2World.s_backupB.Set(bB.m_sweep);
         bA.Advance(minTOI);
         bB.Advance(minTOI);
         minContact.Update(this.m_contactManager.m_contactListener);
         minContact.m_flags &= ~b2Contact.e_toiFlag;
         if (minContact.IsSensor() == true || minContact.IsEnabled() == false) {
            bA.m_sweep.Set(b2World.s_backupA);
            bB.m_sweep.Set(b2World.s_backupB);
            bA.SynchronizeTransform();
            bB.SynchronizeTransform();
            continue;
         }
         if (minContact.IsTouching() == false) {
            continue;
         }
         var seed = bA;
         if (seed.GetType() != b2Body.b2_dynamicBody) {
            seed = bB;
         }
         island.Clear();
         var queueStart = 0;
         var queueSize = 0;
         queue[queueStart + queueSize++] = seed;
         seed.m_flags |= b2Body.e_islandFlag;
         while (queueSize > 0) {
            b = queue[queueStart++];
            --queueSize;
            island.AddBody(b);
            if (b.IsAwake() == false) {
               b.SetAwake(true);
            }
            if (b.GetType() != b2Body.b2_dynamicBody) {
               continue;
            }
            for (cEdge = b.m_contactList;
            cEdge; cEdge = cEdge.next) {
               if (island.m_contactCount == island.m_contactCapacity) {
                  break;
               }
               if (cEdge.contact.m_flags & b2Contact.e_islandFlag) {
                  continue;
               }
               if (cEdge.contact.IsSensor() == true || cEdge.contact.IsEnabled() == false || cEdge.contact.IsTouching() == false) {
                  continue;
               }
               island.AddContact(cEdge.contact);
               cEdge.contact.m_flags |= b2Contact.e_islandFlag;
               var other = cEdge.other;
               if (other.m_flags & b2Body.e_islandFlag) {
                  continue;
               }
               if (other.GetType() != b2Body.b2_staticBody) {
                  other.Advance(minTOI);
                  other.SetAwake(true);
               }
               queue[queueStart + queueSize] = other;
               ++queueSize;
               other.m_flags |= b2Body.e_islandFlag;
            }
            for (var jEdge = b.m_jointList; jEdge; jEdge = jEdge.next) {
               if (island.m_jointCount == island.m_jointCapacity) continue;
               if (jEdge.joint.m_islandFlag == true) continue;
               other = jEdge.other;
               if (other.IsActive() == false) {
                  continue;
               }
               island.AddJoint(jEdge.joint);
               jEdge.joint.m_islandFlag = true;
               if (other.m_flags & b2Body.e_islandFlag) continue;
               if (other.GetType() != b2Body.b2_staticBody) {
                  other.Advance(minTOI);
                  other.SetAwake(true);
               }
               queue[queueStart + queueSize] = other;
               ++queueSize;
               other.m_flags |= b2Body.e_islandFlag;
            }
         }
         var subStep = b2World.s_timestep;
         subStep.warmStarting = false;
         subStep.dt = (1.0 - minTOI) * step.dt;
         subStep.inv_dt = 1.0 / subStep.dt;
         subStep.dtRatio = 0.0;
         subStep.velocityIterations = step.velocityIterations;
         subStep.positionIterations = step.positionIterations;
         island.SolveTOI(subStep);
         var i = 0;
         for (i = 0;
         i < island.m_bodyCount; ++i) {
            b = island.m_bodies[i];
            b.m_flags &= ~b2Body.e_islandFlag;
            if (b.IsAwake() == false) {
               continue;
            }
            if (b.GetType() != b2Body.b2_dynamicBody) {
               continue;
            }
            b.SynchronizeFixtures();
            for (cEdge = b.m_contactList;
            cEdge; cEdge = cEdge.next) {
               cEdge.contact.m_flags &= ~b2Contact.e_toiFlag;
            }
         }
         for (i = 0;
         i < island.m_contactCount; ++i) {
            c = island.m_contacts[i];
            c.m_flags &= ~ (b2Contact.e_toiFlag | b2Contact.e_islandFlag);
         }
         for (i = 0;
         i < island.m_jointCount; ++i) {
            j = island.m_joints[i];
            j.m_islandFlag = false;
         }
         this.m_contactManager.FindNewContacts();
      }
   }
   b2World.prototype.DrawJoint = function (joint) {
      var b1 = joint.GetBodyA();
      var b2 = joint.GetBodyB();
      var xf1 = b1.m_xf;
      var xf2 = b2.m_xf;
      var x1 = xf1.position;
      var x2 = xf2.position;
      var p1 = joint.GetAnchorA();
      var p2 = joint.GetAnchorB();
      var color = b2World.s_jointColor;
      switch (joint.m_type) {
      case b2Joint.e_distanceJoint:
         this.m_debugDraw.DrawSegment(p1, p2, color);
         break;
      case b2Joint.e_pulleyJoint:
         {
            var pulley = ((joint instanceof b2PulleyJoint ? joint : null));
            var s1 = pulley.GetGroundAnchorA();
            var s2 = pulley.GetGroundAnchorB();
            this.m_debugDraw.DrawSegment(s1, p1, color);
            this.m_debugDraw.DrawSegment(s2, p2, color);
            this.m_debugDraw.DrawSegment(s1, s2, color);
         }
         break;
      case b2Joint.e_mouseJoint:
         this.m_debugDraw.DrawSegment(p1, p2, color);
         break;
      default:
         if (b1 != this.m_groundBody) this.m_debugDraw.DrawSegment(x1, p1, color);
         this.m_debugDraw.DrawSegment(p1, p2, color);
         if (b2 != this.m_groundBody) this.m_debugDraw.DrawSegment(x2, p2, color);
      }
   }
   b2World.prototype.DrawShape = function (shape, xf, color) {
      switch (shape.m_type) {
      case b2Shape.e_circleShape:
         {
            var circle = ((shape instanceof b2CircleShape ? shape : null));
            var center = b2Math.MulX(xf, circle.m_p);
            var radius = circle.m_radius;
            var axis = xf.R.col1;
            this.m_debugDraw.DrawSolidCircle(center, radius, axis, color);
         }
         break;
      case b2Shape.e_polygonShape:
         {
            var i = 0;
            var poly = ((shape instanceof b2PolygonShape ? shape : null));
            var vertexCount = parseInt(poly.GetVertexCount());
            var localVertices = poly.GetVertices();
            var vertices = new Vector(vertexCount);
            for (i = 0;
            i < vertexCount; ++i) {
               vertices[i] = b2Math.MulX(xf, localVertices[i]);
            }
            this.m_debugDraw.DrawSolidPolygon(vertices, vertexCount, color);
         }
         break;
      case b2Shape.e_edgeShape:
         {
            var edge = (shape instanceof b2EdgeShape ? shape : null);
            this.m_debugDraw.DrawSegment(b2Math.MulX(xf, edge.GetVertex1()), b2Math.MulX(xf, edge.GetVertex2()), color);
         }
         break;
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.b2World.s_timestep2 = new b2TimeStep();
      Box2D.Dynamics.b2World.s_xf = new b2Transform();
      Box2D.Dynamics.b2World.s_backupA = new b2Sweep();
      Box2D.Dynamics.b2World.s_backupB = new b2Sweep();
      Box2D.Dynamics.b2World.s_timestep = new b2TimeStep();
      Box2D.Dynamics.b2World.s_queue = new Vector();
      Box2D.Dynamics.b2World.s_jointColor = new b2Color(0.5, 0.8, 0.8);
      Box2D.Dynamics.b2World.e_newFixture = 0x0001;
      Box2D.Dynamics.b2World.e_locked = 0x0002;
   });
})();
(function () {
   var b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2CircleContact = Box2D.Dynamics.Contacts.b2CircleContact,
      b2Contact = Box2D.Dynamics.Contacts.b2Contact,
      b2ContactConstraint = Box2D.Dynamics.Contacts.b2ContactConstraint,
      b2ContactConstraintPoint = Box2D.Dynamics.Contacts.b2ContactConstraintPoint,
      b2ContactEdge = Box2D.Dynamics.Contacts.b2ContactEdge,
      b2ContactFactory = Box2D.Dynamics.Contacts.b2ContactFactory,
      b2ContactRegister = Box2D.Dynamics.Contacts.b2ContactRegister,
      b2ContactResult = Box2D.Dynamics.Contacts.b2ContactResult,
      b2ContactSolver = Box2D.Dynamics.Contacts.b2ContactSolver,
      b2EdgeAndCircleContact = Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,
      b2NullContact = Box2D.Dynamics.Contacts.b2NullContact,
      b2PolyAndCircleContact = Box2D.Dynamics.Contacts.b2PolyAndCircleContact,
      b2PolyAndEdgeContact = Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,
      b2PolygonContact = Box2D.Dynamics.Contacts.b2PolygonContact,
      b2PositionSolverManifold = Box2D.Dynamics.Contacts.b2PositionSolverManifold,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2AABB = Box2D.Collision.b2AABB,
      b2Bound = Box2D.Collision.b2Bound,
      b2BoundValues = Box2D.Collision.b2BoundValues,
      b2Collision = Box2D.Collision.b2Collision,
      b2ContactID = Box2D.Collision.b2ContactID,
      b2ContactPoint = Box2D.Collision.b2ContactPoint,
      b2Distance = Box2D.Collision.b2Distance,
      b2DistanceInput = Box2D.Collision.b2DistanceInput,
      b2DistanceOutput = Box2D.Collision.b2DistanceOutput,
      b2DistanceProxy = Box2D.Collision.b2DistanceProxy,
      b2DynamicTree = Box2D.Collision.b2DynamicTree,
      b2DynamicTreeBroadPhase = Box2D.Collision.b2DynamicTreeBroadPhase,
      b2DynamicTreeNode = Box2D.Collision.b2DynamicTreeNode,
      b2DynamicTreePair = Box2D.Collision.b2DynamicTreePair,
      b2Manifold = Box2D.Collision.b2Manifold,
      b2ManifoldPoint = Box2D.Collision.b2ManifoldPoint,
      b2Point = Box2D.Collision.b2Point,
      b2RayCastInput = Box2D.Collision.b2RayCastInput,
      b2RayCastOutput = Box2D.Collision.b2RayCastOutput,
      b2Segment = Box2D.Collision.b2Segment,
      b2SeparationFunction = Box2D.Collision.b2SeparationFunction,
      b2Simplex = Box2D.Collision.b2Simplex,
      b2SimplexCache = Box2D.Collision.b2SimplexCache,
      b2SimplexVertex = Box2D.Collision.b2SimplexVertex,
      b2TimeOfImpact = Box2D.Collision.b2TimeOfImpact,
      b2TOIInput = Box2D.Collision.b2TOIInput,
      b2WorldManifold = Box2D.Collision.b2WorldManifold,
      ClipVertex = Box2D.Collision.ClipVertex,
      Features = Box2D.Collision.Features,
      IBroadPhase = Box2D.Collision.IBroadPhase;

   Box2D.inherit(b2CircleContact, Box2D.Dynamics.Contacts.b2Contact);
   b2CircleContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2CircleContact.b2CircleContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2CircleContact.Create = function (allocator) {
      return new b2CircleContact();
   }
   b2CircleContact.Destroy = function (contact, allocator) {}
   b2CircleContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
   }
   b2CircleContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      b2Collision.CollideCircles(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2CircleShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2CircleShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2Contact.b2Contact = function () {
      this.m_nodeA = new b2ContactEdge();
      this.m_nodeB = new b2ContactEdge();
      this.m_manifold = new b2Manifold();
      this.m_oldManifold = new b2Manifold();
   };
   b2Contact.prototype.GetManifold = function () {
      return this.m_manifold;
   }
   b2Contact.prototype.GetWorldManifold = function (worldManifold) {
      var bodyA = this.m_fixtureA.GetBody();
      var bodyB = this.m_fixtureB.GetBody();
      var shapeA = this.m_fixtureA.GetShape();
      var shapeB = this.m_fixtureB.GetShape();
      worldManifold.Initialize(this.m_manifold, bodyA.GetTransform(), shapeA.m_radius, bodyB.GetTransform(), shapeB.m_radius);
   }
   b2Contact.prototype.IsTouching = function () {
      return (this.m_flags & b2Contact.e_touchingFlag) == b2Contact.e_touchingFlag;
   }
   b2Contact.prototype.IsContinuous = function () {
      return (this.m_flags & b2Contact.e_continuousFlag) == b2Contact.e_continuousFlag;
   }
   b2Contact.prototype.SetSensor = function (sensor) {
      if (sensor) {
         this.m_flags |= b2Contact.e_sensorFlag;
      }
      else {
         this.m_flags &= ~b2Contact.e_sensorFlag;
      }
   }
   b2Contact.prototype.IsSensor = function () {
      return (this.m_flags & b2Contact.e_sensorFlag) == b2Contact.e_sensorFlag;
   }
   b2Contact.prototype.SetEnabled = function (flag) {
      if (flag) {
         this.m_flags |= b2Contact.e_enabledFlag;
      }
      else {
         this.m_flags &= ~b2Contact.e_enabledFlag;
      }
   }
   b2Contact.prototype.IsEnabled = function () {
      return (this.m_flags & b2Contact.e_enabledFlag) == b2Contact.e_enabledFlag;
   }
   b2Contact.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Contact.prototype.GetFixtureA = function () {
      return this.m_fixtureA;
   }
   b2Contact.prototype.GetFixtureB = function () {
      return this.m_fixtureB;
   }
   b2Contact.prototype.FlagForFiltering = function () {
      this.m_flags |= b2Contact.e_filterFlag;
   }
   b2Contact.prototype.b2Contact = function () {}
   b2Contact.prototype.Reset = function (fixtureA, fixtureB) {
      if (fixtureA === undefined) fixtureA = null;
      if (fixtureB === undefined) fixtureB = null;
      this.m_flags = b2Contact.e_enabledFlag;
      if (!fixtureA || !fixtureB) {
         this.m_fixtureA = null;
         this.m_fixtureB = null;
         return;
      }
      if (fixtureA.IsSensor() || fixtureB.IsSensor()) {
         this.m_flags |= b2Contact.e_sensorFlag;
      }
      var bodyA = fixtureA.GetBody();
      var bodyB = fixtureB.GetBody();
      if (bodyA.GetType() != b2Body.b2_dynamicBody || bodyA.IsBullet() || bodyB.GetType() != b2Body.b2_dynamicBody || bodyB.IsBullet()) {
         this.m_flags |= b2Contact.e_continuousFlag;
      }
      this.m_fixtureA = fixtureA;
      this.m_fixtureB = fixtureB;
      this.m_manifold.m_pointCount = 0;
      this.m_prev = null;
      this.m_next = null;
      this.m_nodeA.contact = null;
      this.m_nodeA.prev = null;
      this.m_nodeA.next = null;
      this.m_nodeA.other = null;
      this.m_nodeB.contact = null;
      this.m_nodeB.prev = null;
      this.m_nodeB.next = null;
      this.m_nodeB.other = null;
   }
   b2Contact.prototype.Update = function (listener) {
      var tManifold = this.m_oldManifold;
      this.m_oldManifold = this.m_manifold;
      this.m_manifold = tManifold;
      this.m_flags |= b2Contact.e_enabledFlag;
      var touching = false;
      var wasTouching = (this.m_flags & b2Contact.e_touchingFlag) == b2Contact.e_touchingFlag;
      var bodyA = this.m_fixtureA.m_body;
      var bodyB = this.m_fixtureB.m_body;
      var aabbOverlap = this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);
      if (this.m_flags & b2Contact.e_sensorFlag) {
         if (aabbOverlap) {
            var shapeA = this.m_fixtureA.GetShape();
            var shapeB = this.m_fixtureB.GetShape();
            var xfA = bodyA.GetTransform();
            var xfB = bodyB.GetTransform();
            touching = b2Shape.TestOverlap(shapeA, xfA, shapeB, xfB);
         }
         this.m_manifold.m_pointCount = 0;
      }
      else {
         if (bodyA.GetType() != b2Body.b2_dynamicBody || bodyA.IsBullet() || bodyB.GetType() != b2Body.b2_dynamicBody || bodyB.IsBullet()) {
            this.m_flags |= b2Contact.e_continuousFlag;
         }
         else {
            this.m_flags &= ~b2Contact.e_continuousFlag;
         }
         if (aabbOverlap) {
            this.Evaluate();
            touching = this.m_manifold.m_pointCount > 0;
            for (var i = 0; i < this.m_manifold.m_pointCount; ++i) {
               var mp2 = this.m_manifold.m_points[i];
               mp2.m_normalImpulse = 0.0;
               mp2.m_tangentImpulse = 0.0;
               var id2 = mp2.m_id;
               for (var j = 0; j < this.m_oldManifold.m_pointCount; ++j) {
                  var mp1 = this.m_oldManifold.m_points[j];
                  if (mp1.m_id.key == id2.key) {
                     mp2.m_normalImpulse = mp1.m_normalImpulse;
                     mp2.m_tangentImpulse = mp1.m_tangentImpulse;
                     break;
                  }
               }
            }
         }
         else {
            this.m_manifold.m_pointCount = 0;
         }
         if (touching != wasTouching) {
            bodyA.SetAwake(true);
            bodyB.SetAwake(true);
         }
      }
      if (touching) {
         this.m_flags |= b2Contact.e_touchingFlag;
      }
      else {
         this.m_flags &= ~b2Contact.e_touchingFlag;
      }
      if (wasTouching == false && touching == true) {
         listener.BeginContact(this);
      }
      if (wasTouching == true && touching == false) {
         listener.EndContact(this);
      }
      if ((this.m_flags & b2Contact.e_sensorFlag) == 0) {
         listener.PreSolve(this, this.m_oldManifold);
      }
   }
   b2Contact.prototype.Evaluate = function () {}
   b2Contact.prototype.ComputeTOI = function (sweepA, sweepB) {
      b2Contact.s_input.proxyA.Set(this.m_fixtureA.GetShape());
      b2Contact.s_input.proxyB.Set(this.m_fixtureB.GetShape());
      b2Contact.s_input.sweepA = sweepA;
      b2Contact.s_input.sweepB = sweepB;
      b2Contact.s_input.tolerance = b2Settings.b2_linearSlop;
      return b2TimeOfImpact.TimeOfImpact(b2Contact.s_input);
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag = 0x0001;
      Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag = 0x0002;
      Box2D.Dynamics.Contacts.b2Contact.e_islandFlag = 0x0004;
      Box2D.Dynamics.Contacts.b2Contact.e_toiFlag = 0x0008;
      Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag = 0x0010;
      Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag = 0x0020;
      Box2D.Dynamics.Contacts.b2Contact.e_filterFlag = 0x0040;
      Box2D.Dynamics.Contacts.b2Contact.s_input = new b2TOIInput();
   });
   b2ContactConstraint.b2ContactConstraint = function () {
      this.localPlaneNormal = new b2Vec2();
      this.localPoint = new b2Vec2();
      this.normal = new b2Vec2();
      this.normalMass = new b2Mat22();
      this.K = new b2Mat22();
   };
   b2ContactConstraint.prototype.b2ContactConstraint = function () {
      this.points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.points[i] = new b2ContactConstraintPoint();
      }
   }
   b2ContactConstraintPoint.b2ContactConstraintPoint = function () {
      this.localPoint = new b2Vec2();
      this.rA = new b2Vec2();
      this.rB = new b2Vec2();
   };
   b2ContactEdge.b2ContactEdge = function () {};
   b2ContactFactory.b2ContactFactory = function () {};
   b2ContactFactory.prototype.b2ContactFactory = function (allocator) {
      this.m_allocator = allocator;
      this.InitializeRegisters();
   }
   b2ContactFactory.prototype.AddType = function (createFcn, destroyFcn, type1, type2) {
      if (type1 === undefined) type1 = 0;
      if (type2 === undefined) type2 = 0;
      this.m_registers[type1][type2].createFcn = createFcn;
      this.m_registers[type1][type2].destroyFcn = destroyFcn;
      this.m_registers[type1][type2].primary = true;
      if (type1 != type2) {
         this.m_registers[type2][type1].createFcn = createFcn;
         this.m_registers[type2][type1].destroyFcn = destroyFcn;
         this.m_registers[type2][type1].primary = false;
      }
   }
   b2ContactFactory.prototype.InitializeRegisters = function () {
      this.m_registers = new Vector(b2Shape.e_shapeTypeCount);
      for (var i = 0; i < b2Shape.e_shapeTypeCount; i++) {
         this.m_registers[i] = new Vector(b2Shape.e_shapeTypeCount);
         for (var j = 0; j < b2Shape.e_shapeTypeCount; j++) {
            this.m_registers[i][j] = new b2ContactRegister();
         }
      }
      this.AddType(b2CircleContact.Create, b2CircleContact.Destroy, b2Shape.e_circleShape, b2Shape.e_circleShape);
      this.AddType(b2PolyAndCircleContact.Create, b2PolyAndCircleContact.Destroy, b2Shape.e_polygonShape, b2Shape.e_circleShape);
      this.AddType(b2PolygonContact.Create, b2PolygonContact.Destroy, b2Shape.e_polygonShape, b2Shape.e_polygonShape);
      this.AddType(b2EdgeAndCircleContact.Create, b2EdgeAndCircleContact.Destroy, b2Shape.e_edgeShape, b2Shape.e_circleShape);
      this.AddType(b2PolyAndEdgeContact.Create, b2PolyAndEdgeContact.Destroy, b2Shape.e_polygonShape, b2Shape.e_edgeShape);
   }
   b2ContactFactory.prototype.Create = function (fixtureA, fixtureB) {
      var type1 = parseInt(fixtureA.GetType());
      var type2 = parseInt(fixtureB.GetType());
      var reg = this.m_registers[type1][type2];
      var c;
      if (reg.pool) {
         c = reg.pool;
         reg.pool = c.m_next;
         reg.poolCount--;
         c.Reset(fixtureA, fixtureB);
         return c;
      }
      var createFcn = reg.createFcn;
      if (createFcn != null) {
         if (reg.primary) {
            c = createFcn(this.m_allocator);
            c.Reset(fixtureA, fixtureB);
            return c;
         }
         else {
            c = createFcn(this.m_allocator);
            c.Reset(fixtureB, fixtureA);
            return c;
         }
      }
      else {
         return null;
      }
   }
   b2ContactFactory.prototype.Destroy = function (contact) {
      if (contact.m_manifold.m_pointCount > 0) {
         contact.m_fixtureA.m_body.SetAwake(true);
         contact.m_fixtureB.m_body.SetAwake(true);
      }
      var type1 = parseInt(contact.m_fixtureA.GetType());
      var type2 = parseInt(contact.m_fixtureB.GetType());
      var reg = this.m_registers[type1][type2];
      if (true) {
         reg.poolCount++;
         contact.m_next = reg.pool;
         reg.pool = contact;
      }
      var destroyFcn = reg.destroyFcn;
      destroyFcn(contact, this.m_allocator);
   }
   b2ContactRegister.b2ContactRegister = function () {};
   b2ContactResult.b2ContactResult = function () {
      this.position = new b2Vec2();
      this.normal = new b2Vec2();
      this.id = new b2ContactID();
   };
   b2ContactSolver.b2ContactSolver = function () {
      this.m_step = new b2TimeStep();
      this.m_constraints = new Vector();
   };
   b2ContactSolver.prototype.b2ContactSolver = function () {}
   b2ContactSolver.prototype.Initialize = function (step, contacts, contactCount, allocator) {
      if (contactCount === undefined) contactCount = 0;
      var contact;
      this.m_step.Set(step);
      this.m_allocator = allocator;
      var i = 0;
      var tVec;
      var tMat;
      this.m_constraintCount = contactCount;
      while (this.m_constraints.length < this.m_constraintCount) {
         this.m_constraints[this.m_constraints.length] = new b2ContactConstraint();
      }
      for (i = 0;
      i < contactCount; ++i) {
         contact = contacts[i];
         var fixtureA = contact.m_fixtureA;
         var fixtureB = contact.m_fixtureB;
         var shapeA = fixtureA.m_shape;
         var shapeB = fixtureB.m_shape;
         var radiusA = shapeA.m_radius;
         var radiusB = shapeB.m_radius;
         var bodyA = fixtureA.m_body;
         var bodyB = fixtureB.m_body;
         var manifold = contact.GetManifold();
         var friction = b2Settings.b2MixFriction(fixtureA.GetFriction(), fixtureB.GetFriction());
         var restitution = b2Settings.b2MixRestitution(fixtureA.GetRestitution(), fixtureB.GetRestitution());
         var vAX = bodyA.m_linearVelocity.x;
         var vAY = bodyA.m_linearVelocity.y;
         var vBX = bodyB.m_linearVelocity.x;
         var vBY = bodyB.m_linearVelocity.y;
         var wA = bodyA.m_angularVelocity;
         var wB = bodyB.m_angularVelocity;
         b2Settings.b2Assert(manifold.m_pointCount > 0);
         b2ContactSolver.s_worldManifold.Initialize(manifold, bodyA.m_xf, radiusA, bodyB.m_xf, radiusB);
         var normalX = b2ContactSolver.s_worldManifold.m_normal.x;
         var normalY = b2ContactSolver.s_worldManifold.m_normal.y;
         var cc = this.m_constraints[i];
         cc.bodyA = bodyA;
         cc.bodyB = bodyB;
         cc.manifold = manifold;
         cc.normal.x = normalX;
         cc.normal.y = normalY;
         cc.pointCount = manifold.m_pointCount;
         cc.friction = friction;
         cc.restitution = restitution;
         cc.localPlaneNormal.x = manifold.m_localPlaneNormal.x;
         cc.localPlaneNormal.y = manifold.m_localPlaneNormal.y;
         cc.localPoint.x = manifold.m_localPoint.x;
         cc.localPoint.y = manifold.m_localPoint.y;
         cc.radius = radiusA + radiusB;
         cc.type = manifold.m_type;
         for (var k = 0; k < cc.pointCount; ++k) {
            var cp = manifold.m_points[k];
            var ccp = cc.points[k];
            ccp.normalImpulse = cp.m_normalImpulse;
            ccp.tangentImpulse = cp.m_tangentImpulse;
            ccp.localPoint.SetV(cp.m_localPoint);
            var rAX = ccp.rA.x = b2ContactSolver.s_worldManifold.m_points[k].x - bodyA.m_sweep.c.x;
            var rAY = ccp.rA.y = b2ContactSolver.s_worldManifold.m_points[k].y - bodyA.m_sweep.c.y;
            var rBX = ccp.rB.x = b2ContactSolver.s_worldManifold.m_points[k].x - bodyB.m_sweep.c.x;
            var rBY = ccp.rB.y = b2ContactSolver.s_worldManifold.m_points[k].y - bodyB.m_sweep.c.y;
            var rnA = rAX * normalY - rAY * normalX;
            var rnB = rBX * normalY - rBY * normalX;
            rnA *= rnA;
            rnB *= rnB;
            var kNormal = bodyA.m_invMass + bodyB.m_invMass + bodyA.m_invI * rnA + bodyB.m_invI * rnB;
            ccp.normalMass = 1.0 / kNormal;
            var kEqualized = bodyA.m_mass * bodyA.m_invMass + bodyB.m_mass * bodyB.m_invMass;
            kEqualized += bodyA.m_mass * bodyA.m_invI * rnA + bodyB.m_mass * bodyB.m_invI * rnB;
            ccp.equalizedMass = 1.0 / kEqualized;
            var tangentX = normalY;
            var tangentY = (-normalX);
            var rtA = rAX * tangentY - rAY * tangentX;
            var rtB = rBX * tangentY - rBY * tangentX;
            rtA *= rtA;
            rtB *= rtB;
            var kTangent = bodyA.m_invMass + bodyB.m_invMass + bodyA.m_invI * rtA + bodyB.m_invI * rtB;
            ccp.tangentMass = 1.0 / kTangent;
            ccp.velocityBias = 0.0;
            var tX = vBX + ((-wB * rBY)) - vAX - ((-wA * rAY));
            var tY = vBY + (wB * rBX) - vAY - (wA * rAX);
            var vRel = cc.normal.x * tX + cc.normal.y * tY;
            if (vRel < (-b2Settings.b2_velocityThreshold)) {
               ccp.velocityBias += (-cc.restitution * vRel);
            }
         }
         if (cc.pointCount == 2) {
            var ccp1 = cc.points[0];
            var ccp2 = cc.points[1];
            var invMassA = bodyA.m_invMass;
            var invIA = bodyA.m_invI;
            var invMassB = bodyB.m_invMass;
            var invIB = bodyB.m_invI;
            var rn1A = ccp1.rA.x * normalY - ccp1.rA.y * normalX;
            var rn1B = ccp1.rB.x * normalY - ccp1.rB.y * normalX;
            var rn2A = ccp2.rA.x * normalY - ccp2.rA.y * normalX;
            var rn2B = ccp2.rB.x * normalY - ccp2.rB.y * normalX;
            var k11 = invMassA + invMassB + invIA * rn1A * rn1A + invIB * rn1B * rn1B;
            var k22 = invMassA + invMassB + invIA * rn2A * rn2A + invIB * rn2B * rn2B;
            var k12 = invMassA + invMassB + invIA * rn1A * rn2A + invIB * rn1B * rn2B;
            var k_maxConditionNumber = 100.0;
            if (k11 * k11 < k_maxConditionNumber * (k11 * k22 - k12 * k12)) {
               cc.K.col1.Set(k11, k12);
               cc.K.col2.Set(k12, k22);
               cc.K.GetInverse(cc.normalMass);
            }
            else {
               cc.pointCount = 1;
            }
         }
      }
   }
   b2ContactSolver.prototype.InitVelocityConstraints = function (step) {
      var tVec;
      var tVec2;
      var tMat;
      for (var i = 0; i < this.m_constraintCount; ++i) {
         var c = this.m_constraints[i];
         var bodyA = c.bodyA;
         var bodyB = c.bodyB;
         var invMassA = bodyA.m_invMass;
         var invIA = bodyA.m_invI;
         var invMassB = bodyB.m_invMass;
         var invIB = bodyB.m_invI;
         var normalX = c.normal.x;
         var normalY = c.normal.y;
         var tangentX = normalY;
         var tangentY = (-normalX);
         var tX = 0;
         var j = 0;
         var tCount = 0;
         if (step.warmStarting) {
            tCount = c.pointCount;
            for (j = 0;
            j < tCount; ++j) {
               var ccp = c.points[j];
               ccp.normalImpulse *= step.dtRatio;
               ccp.tangentImpulse *= step.dtRatio;
               var PX = ccp.normalImpulse * normalX + ccp.tangentImpulse * tangentX;
               var PY = ccp.normalImpulse * normalY + ccp.tangentImpulse * tangentY;
               bodyA.m_angularVelocity -= invIA * (ccp.rA.x * PY - ccp.rA.y * PX);
               bodyA.m_linearVelocity.x -= invMassA * PX;
               bodyA.m_linearVelocity.y -= invMassA * PY;
               bodyB.m_angularVelocity += invIB * (ccp.rB.x * PY - ccp.rB.y * PX);
               bodyB.m_linearVelocity.x += invMassB * PX;
               bodyB.m_linearVelocity.y += invMassB * PY;
            }
         }
         else {
            tCount = c.pointCount;
            for (j = 0;
            j < tCount; ++j) {
               var ccp2 = c.points[j];
               ccp2.normalImpulse = 0.0;
               ccp2.tangentImpulse = 0.0;
            }
         }
      }
   }
   b2ContactSolver.prototype.SolveVelocityConstraints = function () {
      var j = 0;
      var ccp;
      var rAX = 0;
      var rAY = 0;
      var rBX = 0;
      var rBY = 0;
      var dvX = 0;
      var dvY = 0;
      var vn = 0;
      var vt = 0;
      var lambda = 0;
      var maxFriction = 0;
      var newImpulse = 0;
      var PX = 0;
      var PY = 0;
      var dX = 0;
      var dY = 0;
      var P1X = 0;
      var P1Y = 0;
      var P2X = 0;
      var P2Y = 0;
      var tMat;
      var tVec;
      for (var i = 0; i < this.m_constraintCount; ++i) {
         var c = this.m_constraints[i];
         var bodyA = c.bodyA;
         var bodyB = c.bodyB;
         var wA = bodyA.m_angularVelocity;
         var wB = bodyB.m_angularVelocity;
         var vA = bodyA.m_linearVelocity;
         var vB = bodyB.m_linearVelocity;
         var invMassA = bodyA.m_invMass;
         var invIA = bodyA.m_invI;
         var invMassB = bodyB.m_invMass;
         var invIB = bodyB.m_invI;
         var normalX = c.normal.x;
         var normalY = c.normal.y;
         var tangentX = normalY;
         var tangentY = (-normalX);
         var friction = c.friction;
         var tX = 0;
         for (j = 0;
         j < c.pointCount; j++) {
            ccp = c.points[j];
            dvX = vB.x - wB * ccp.rB.y - vA.x + wA * ccp.rA.y;
            dvY = vB.y + wB * ccp.rB.x - vA.y - wA * ccp.rA.x;
            vt = dvX * tangentX + dvY * tangentY;
            lambda = ccp.tangentMass * (-vt);
            maxFriction = friction * ccp.normalImpulse;
            newImpulse = b2Math.Clamp(ccp.tangentImpulse + lambda, (-maxFriction), maxFriction);
            lambda = newImpulse - ccp.tangentImpulse;
            PX = lambda * tangentX;
            PY = lambda * tangentY;
            vA.x -= invMassA * PX;
            vA.y -= invMassA * PY;
            wA -= invIA * (ccp.rA.x * PY - ccp.rA.y * PX);
            vB.x += invMassB * PX;
            vB.y += invMassB * PY;
            wB += invIB * (ccp.rB.x * PY - ccp.rB.y * PX);
            ccp.tangentImpulse = newImpulse;
         }
         var tCount = parseInt(c.pointCount);
         if (c.pointCount == 1) {
            ccp = c.points[0];
            dvX = vB.x + ((-wB * ccp.rB.y)) - vA.x - ((-wA * ccp.rA.y));
            dvY = vB.y + (wB * ccp.rB.x) - vA.y - (wA * ccp.rA.x);
            vn = dvX * normalX + dvY * normalY;
            lambda = (-ccp.normalMass * (vn - ccp.velocityBias));
            newImpulse = ccp.normalImpulse + lambda;
            newImpulse = newImpulse > 0 ? newImpulse : 0.0;
            lambda = newImpulse - ccp.normalImpulse;
            PX = lambda * normalX;
            PY = lambda * normalY;
            vA.x -= invMassA * PX;
            vA.y -= invMassA * PY;
            wA -= invIA * (ccp.rA.x * PY - ccp.rA.y * PX);
            vB.x += invMassB * PX;
            vB.y += invMassB * PY;
            wB += invIB * (ccp.rB.x * PY - ccp.rB.y * PX);
            ccp.normalImpulse = newImpulse;
         }
         else {
            var cp1 = c.points[0];
            var cp2 = c.points[1];
            var aX = cp1.normalImpulse;
            var aY = cp2.normalImpulse;
            var dv1X = vB.x - wB * cp1.rB.y - vA.x + wA * cp1.rA.y;
            var dv1Y = vB.y + wB * cp1.rB.x - vA.y - wA * cp1.rA.x;
            var dv2X = vB.x - wB * cp2.rB.y - vA.x + wA * cp2.rA.y;
            var dv2Y = vB.y + wB * cp2.rB.x - vA.y - wA * cp2.rA.x;
            var vn1 = dv1X * normalX + dv1Y * normalY;
            var vn2 = dv2X * normalX + dv2Y * normalY;
            var bX = vn1 - cp1.velocityBias;
            var bY = vn2 - cp2.velocityBias;
            tMat = c.K;
            bX -= tMat.col1.x * aX + tMat.col2.x * aY;
            bY -= tMat.col1.y * aX + tMat.col2.y * aY;
            var k_errorTol = 0.001;
            for (;;) {
               tMat = c.normalMass;
               var xX = (-(tMat.col1.x * bX + tMat.col2.x * bY));
               var xY = (-(tMat.col1.y * bX + tMat.col2.y * bY));
               if (xX >= 0.0 && xY >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               xX = (-cp1.normalMass * bX);
               xY = 0.0;
               vn1 = 0.0;
               vn2 = c.K.col1.y * xX + bY;
               if (xX >= 0.0 && vn2 >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               xX = 0.0;
               xY = (-cp2.normalMass * bY);
               vn1 = c.K.col2.x * xY + bX;
               vn2 = 0.0;
               if (xY >= 0.0 && vn1 >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               xX = 0.0;
               xY = 0.0;
               vn1 = bX;
               vn2 = bY;
               if (vn1 >= 0.0 && vn2 >= 0.0) {
                  dX = xX - aX;
                  dY = xY - aY;
                  P1X = dX * normalX;
                  P1Y = dX * normalY;
                  P2X = dY * normalX;
                  P2Y = dY * normalY;
                  vA.x -= invMassA * (P1X + P2X);
                  vA.y -= invMassA * (P1Y + P2Y);
                  wA -= invIA * (cp1.rA.x * P1Y - cp1.rA.y * P1X + cp2.rA.x * P2Y - cp2.rA.y * P2X);
                  vB.x += invMassB * (P1X + P2X);
                  vB.y += invMassB * (P1Y + P2Y);
                  wB += invIB * (cp1.rB.x * P1Y - cp1.rB.y * P1X + cp2.rB.x * P2Y - cp2.rB.y * P2X);
                  cp1.normalImpulse = xX;
                  cp2.normalImpulse = xY;
                  break;
               }
               break;
            }
         }
         bodyA.m_angularVelocity = wA;
         bodyB.m_angularVelocity = wB;
      }
   }
   b2ContactSolver.prototype.FinalizeVelocityConstraints = function () {
      for (var i = 0; i < this.m_constraintCount; ++i) {
         var c = this.m_constraints[i];
         var m = c.manifold;
         for (var j = 0; j < c.pointCount; ++j) {
            var point1 = m.m_points[j];
            var point2 = c.points[j];
            point1.m_normalImpulse = point2.normalImpulse;
            point1.m_tangentImpulse = point2.tangentImpulse;
         }
      }
   }
   b2ContactSolver.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var minSeparation = 0.0;
      for (var i = 0; i < this.m_constraintCount; i++) {
         var c = this.m_constraints[i];
         var bodyA = c.bodyA;
         var bodyB = c.bodyB;
         var invMassA = bodyA.m_mass * bodyA.m_invMass;
         var invIA = bodyA.m_mass * bodyA.m_invI;
         var invMassB = bodyB.m_mass * bodyB.m_invMass;
         var invIB = bodyB.m_mass * bodyB.m_invI;
         b2ContactSolver.s_psm.Initialize(c);
         var normal = b2ContactSolver.s_psm.m_normal;
         for (var j = 0; j < c.pointCount; j++) {
            var ccp = c.points[j];
            var point = b2ContactSolver.s_psm.m_points[j];
            var separation = b2ContactSolver.s_psm.m_separations[j];
            var rAX = point.x - bodyA.m_sweep.c.x;
            var rAY = point.y - bodyA.m_sweep.c.y;
            var rBX = point.x - bodyB.m_sweep.c.x;
            var rBY = point.y - bodyB.m_sweep.c.y;
            minSeparation = minSeparation < separation ? minSeparation : separation;
            var C = b2Math.Clamp(baumgarte * (separation + b2Settings.b2_linearSlop), (-b2Settings.b2_maxLinearCorrection), 0.0);
            var impulse = (-ccp.equalizedMass * C);
            var PX = impulse * normal.x;
            var PY = impulse * normal.y;bodyA.m_sweep.c.x -= invMassA * PX;
            bodyA.m_sweep.c.y -= invMassA * PY;
            bodyA.m_sweep.a -= invIA * (rAX * PY - rAY * PX);
            bodyA.SynchronizeTransform();
            bodyB.m_sweep.c.x += invMassB * PX;
            bodyB.m_sweep.c.y += invMassB * PY;
            bodyB.m_sweep.a += invIB * (rBX * PY - rBY * PX);
            bodyB.SynchronizeTransform();
         }
      }
      return minSeparation > (-1.5 * b2Settings.b2_linearSlop);
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold = new b2WorldManifold();
      Box2D.Dynamics.Contacts.b2ContactSolver.s_psm = new b2PositionSolverManifold();
   });
   Box2D.inherit(b2EdgeAndCircleContact, Box2D.Dynamics.Contacts.b2Contact);
   b2EdgeAndCircleContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2EdgeAndCircleContact.b2EdgeAndCircleContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2EdgeAndCircleContact.Create = function (allocator) {
      return new b2EdgeAndCircleContact();
   }
   b2EdgeAndCircleContact.Destroy = function (contact, allocator) {}
   b2EdgeAndCircleContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
   }
   b2EdgeAndCircleContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      this.b2CollideEdgeAndCircle(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2EdgeShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2CircleShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2EdgeAndCircleContact.prototype.b2CollideEdgeAndCircle = function (manifold, edge, xf1, circle, xf2) {}
   Box2D.inherit(b2NullContact, Box2D.Dynamics.Contacts.b2Contact);
   b2NullContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2NullContact.b2NullContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2NullContact.prototype.b2NullContact = function () {
      this.__super.b2Contact.call(this);
   }
   b2NullContact.prototype.Evaluate = function () {}
   Box2D.inherit(b2PolyAndCircleContact, Box2D.Dynamics.Contacts.b2Contact);
   b2PolyAndCircleContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2PolyAndCircleContact.b2PolyAndCircleContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2PolyAndCircleContact.Create = function (allocator) {
      return new b2PolyAndCircleContact();
   }
   b2PolyAndCircleContact.Destroy = function (contact, allocator) {}
   b2PolyAndCircleContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
      b2Settings.b2Assert(fixtureA.GetType() == b2Shape.e_polygonShape);
      b2Settings.b2Assert(fixtureB.GetType() == b2Shape.e_circleShape);
   }
   b2PolyAndCircleContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.m_body;
      var bB = this.m_fixtureB.m_body;
      b2Collision.CollidePolygonAndCircle(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2PolygonShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2CircleShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   Box2D.inherit(b2PolyAndEdgeContact, Box2D.Dynamics.Contacts.b2Contact);
   b2PolyAndEdgeContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2PolyAndEdgeContact.b2PolyAndEdgeContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2PolyAndEdgeContact.Create = function (allocator) {
      return new b2PolyAndEdgeContact();
   }
   b2PolyAndEdgeContact.Destroy = function (contact, allocator) {}
   b2PolyAndEdgeContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
      b2Settings.b2Assert(fixtureA.GetType() == b2Shape.e_polygonShape);
      b2Settings.b2Assert(fixtureB.GetType() == b2Shape.e_edgeShape);
   }
   b2PolyAndEdgeContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      this.b2CollidePolyAndEdge(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2PolygonShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2EdgeShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2PolyAndEdgeContact.prototype.b2CollidePolyAndEdge = function (manifold, polygon, xf1, edge, xf2) {}
   Box2D.inherit(b2PolygonContact, Box2D.Dynamics.Contacts.b2Contact);
   b2PolygonContact.prototype.__super = Box2D.Dynamics.Contacts.b2Contact.prototype;
   b2PolygonContact.b2PolygonContact = function () {
      Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this, arguments);
   };
   b2PolygonContact.Create = function (allocator) {
      return new b2PolygonContact();
   }
   b2PolygonContact.Destroy = function (contact, allocator) {}
   b2PolygonContact.prototype.Reset = function (fixtureA, fixtureB) {
      this.__super.Reset.call(this, fixtureA, fixtureB);
   }
   b2PolygonContact.prototype.Evaluate = function () {
      var bA = this.m_fixtureA.GetBody();
      var bB = this.m_fixtureB.GetBody();
      b2Collision.CollidePolygons(this.m_manifold, (this.m_fixtureA.GetShape() instanceof b2PolygonShape ? this.m_fixtureA.GetShape() : null), bA.m_xf, (this.m_fixtureB.GetShape() instanceof b2PolygonShape ? this.m_fixtureB.GetShape() : null), bB.m_xf);
   }
   b2PositionSolverManifold.b2PositionSolverManifold = function () {};
   b2PositionSolverManifold.prototype.b2PositionSolverManifold = function () {
      this.m_normal = new b2Vec2();
      this.m_separations = new Vector_a2j_Number(b2Settings.b2_maxManifoldPoints);
      this.m_points = new Vector(b2Settings.b2_maxManifoldPoints);
      for (var i = 0; i < b2Settings.b2_maxManifoldPoints; i++) {
         this.m_points[i] = new b2Vec2();
      }
   }
   b2PositionSolverManifold.prototype.Initialize = function (cc) {
      b2Settings.b2Assert(cc.pointCount > 0);
      var i = 0;
      var clipPointX = 0;
      var clipPointY = 0;
      var tMat;
      var tVec;
      var planePointX = 0;
      var planePointY = 0;
      switch (cc.type) {
      case b2Manifold.e_circles:
         {
            tMat = cc.bodyA.m_xf.R;
            tVec = cc.localPoint;
            var pointAX = cc.bodyA.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            var pointAY = cc.bodyA.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tMat = cc.bodyB.m_xf.R;
            tVec = cc.points[0].localPoint;
            var pointBX = cc.bodyB.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            var pointBY = cc.bodyB.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            var dX = pointBX - pointAX;
            var dY = pointBY - pointAY;
            var d2 = dX * dX + dY * dY;
            if (d2 > Number.MIN_VALUE * Number.MIN_VALUE) {
               var d = Math.sqrt(d2);
               this.m_normal.x = dX / d;
               this.m_normal.y = dY / d;
            }
            else {
               this.m_normal.x = 1.0;
               this.m_normal.y = 0.0;
            }
            this.m_points[0].x = 0.5 * (pointAX + pointBX);
            this.m_points[0].y = 0.5 * (pointAY + pointBY);
            this.m_separations[0] = dX * this.m_normal.x + dY * this.m_normal.y - cc.radius;
         }
         break;
      case b2Manifold.e_faceA:
         {
            tMat = cc.bodyA.m_xf.R;
            tVec = cc.localPlaneNormal;
            this.m_normal.x = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            this.m_normal.y = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = cc.bodyA.m_xf.R;
            tVec = cc.localPoint;
            planePointX = cc.bodyA.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            planePointY = cc.bodyA.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tMat = cc.bodyB.m_xf.R;
            for (i = 0;
            i < cc.pointCount; ++i) {
               tVec = cc.points[i].localPoint;
               clipPointX = cc.bodyB.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
               clipPointY = cc.bodyB.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
               this.m_separations[i] = (clipPointX - planePointX) * this.m_normal.x + (clipPointY - planePointY) * this.m_normal.y - cc.radius;
               this.m_points[i].x = clipPointX;
               this.m_points[i].y = clipPointY;
            }
         }
         break;
      case b2Manifold.e_faceB:
         {
            tMat = cc.bodyB.m_xf.R;
            tVec = cc.localPlaneNormal;
            this.m_normal.x = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
            this.m_normal.y = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
            tMat = cc.bodyB.m_xf.R;
            tVec = cc.localPoint;
            planePointX = cc.bodyB.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
            planePointY = cc.bodyB.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
            tMat = cc.bodyA.m_xf.R;
            for (i = 0;
            i < cc.pointCount; ++i) {
               tVec = cc.points[i].localPoint;
               clipPointX = cc.bodyA.m_xf.position.x + (tMat.col1.x * tVec.x + tMat.col2.x * tVec.y);
               clipPointY = cc.bodyA.m_xf.position.y + (tMat.col1.y * tVec.x + tMat.col2.y * tVec.y);
               this.m_separations[i] = (clipPointX - planePointX) * this.m_normal.x + (clipPointY - planePointY) * this.m_normal.y - cc.radius;
               this.m_points[i].Set(clipPointX, clipPointY);
            }
            this.m_normal.x *= (-1);
            this.m_normal.y *= (-1);
         }
         break;
      }
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA = new b2Vec2();
      Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB = new b2Vec2();
   });
})();
(function () {
   var b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2CircleShape = Box2D.Collision.Shapes.b2CircleShape,
      b2EdgeChainDef = Box2D.Collision.Shapes.b2EdgeChainDef,
      b2EdgeShape = Box2D.Collision.Shapes.b2EdgeShape,
      b2MassData = Box2D.Collision.Shapes.b2MassData,
      b2PolygonShape = Box2D.Collision.Shapes.b2PolygonShape,
      b2Shape = Box2D.Collision.Shapes.b2Shape,
      b2BuoyancyController = Box2D.Dynamics.Controllers.b2BuoyancyController,
      b2ConstantAccelController = Box2D.Dynamics.Controllers.b2ConstantAccelController,
      b2ConstantForceController = Box2D.Dynamics.Controllers.b2ConstantForceController,
      b2Controller = Box2D.Dynamics.Controllers.b2Controller,
      b2ControllerEdge = Box2D.Dynamics.Controllers.b2ControllerEdge,
      b2GravityController = Box2D.Dynamics.Controllers.b2GravityController,
      b2TensorDampingController = Box2D.Dynamics.Controllers.b2TensorDampingController;

   Box2D.inherit(b2BuoyancyController, Box2D.Dynamics.Controllers.b2Controller);
   b2BuoyancyController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2BuoyancyController.b2BuoyancyController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.normal = new b2Vec2(0, (-1));
      this.offset = 0;
      this.density = 0;
      this.velocity = new b2Vec2(0, 0);
      this.linearDrag = 2;
      this.angularDrag = 1;
      this.useDensity = false;
      this.useWorldGravity = true;
      this.gravity = null;
   };
   b2BuoyancyController.prototype.Step = function (step) {
      if (!this.m_bodyList) return;
      if (this.useWorldGravity) {
         this.gravity = this.GetWorld().GetGravity().Copy();
      }
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (body.IsAwake() == false) {
            continue;
         }
         var areac = new b2Vec2();
         var massc = new b2Vec2();
         var area = 0.0;
         var mass = 0.0;
         for (var fixture = body.GetFixtureList(); fixture; fixture = fixture.GetNext()) {
            var sc = new b2Vec2();
            var sarea = fixture.GetShape().ComputeSubmergedArea(this.normal, this.offset, body.GetTransform(), sc);
            area += sarea;
            areac.x += sarea * sc.x;
            areac.y += sarea * sc.y;
            var shapeDensity = 0;
            if (this.useDensity) {
               shapeDensity = 1;
            }
            else {
               shapeDensity = 1;
            }
            mass += sarea * shapeDensity;
            massc.x += sarea * sc.x * shapeDensity;
            massc.y += sarea * sc.y * shapeDensity;
         }
         areac.x /= area;
         areac.y /= area;
         massc.x /= mass;
         massc.y /= mass;
         if (area < Number.MIN_VALUE) continue;
         var buoyancyForce = this.gravity.GetNegative();
         buoyancyForce.Multiply(this.density * area);
         body.ApplyForce(buoyancyForce, massc);
         var dragForce = body.GetLinearVelocityFromWorldPoint(areac);
         dragForce.Subtract(this.velocity);
         dragForce.Multiply((-this.linearDrag * area));
         body.ApplyForce(dragForce, areac);
         body.ApplyTorque((-body.GetInertia() / body.GetMass() * area * body.GetAngularVelocity() * this.angularDrag));
      }
   }
   b2BuoyancyController.prototype.Draw = function (debugDraw) {
      var r = 1000;
      var p1 = new b2Vec2();
      var p2 = new b2Vec2();
      p1.x = this.normal.x * this.offset + this.normal.y * r;
      p1.y = this.normal.y * this.offset - this.normal.x * r;
      p2.x = this.normal.x * this.offset - this.normal.y * r;
      p2.y = this.normal.y * this.offset + this.normal.x * r;
      var color = new b2Color(0, 0, 1);
      debugDraw.DrawSegment(p1, p2, color);
   }
   Box2D.inherit(b2ConstantAccelController, Box2D.Dynamics.Controllers.b2Controller);
   b2ConstantAccelController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2ConstantAccelController.b2ConstantAccelController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.A = new b2Vec2(0, 0);
   };
   b2ConstantAccelController.prototype.Step = function (step) {
      var smallA = new b2Vec2(this.A.x * step.dt, this.A.y * step.dt);
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (!body.IsAwake()) continue;
         body.SetLinearVelocity(new b2Vec2(body.GetLinearVelocity().x + smallA.x, body.GetLinearVelocity().y + smallA.y));
      }
   }
   Box2D.inherit(b2ConstantForceController, Box2D.Dynamics.Controllers.b2Controller);
   b2ConstantForceController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2ConstantForceController.b2ConstantForceController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.F = new b2Vec2(0, 0);
   };
   b2ConstantForceController.prototype.Step = function (step) {
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (!body.IsAwake()) continue;
         body.ApplyForce(this.F, body.GetWorldCenter());
      }
   }
   b2Controller.b2Controller = function () {};
   b2Controller.prototype.Step = function (step) {}
   b2Controller.prototype.Draw = function (debugDraw) {}
   b2Controller.prototype.AddBody = function (body) {
      var edge = new b2ControllerEdge();
      edge.controller = this;
      edge.body = body;
      edge.nextBody = this.m_bodyList;
      edge.prevBody = null;
      this.m_bodyList = edge;
      if (edge.nextBody) edge.nextBody.prevBody = edge;
      this.m_bodyCount++;
      edge.nextController = body.m_controllerList;
      edge.prevController = null;
      body.m_controllerList = edge;
      if (edge.nextController) edge.nextController.prevController = edge;
      body.m_controllerCount++;
   }
   b2Controller.prototype.RemoveBody = function (body) {
      var edge = body.m_controllerList;
      while (edge && edge.controller != this)
      edge = edge.nextController;
      if (edge.prevBody) edge.prevBody.nextBody = edge.nextBody;
      if (edge.nextBody) edge.nextBody.prevBody = edge.prevBody;
      if (edge.nextController) edge.nextController.prevController = edge.prevController;
      if (edge.prevController) edge.prevController.nextController = edge.nextController;
      if (this.m_bodyList == edge) this.m_bodyList = edge.nextBody;
      if (body.m_controllerList == edge) body.m_controllerList = edge.nextController;
      body.m_controllerCount--;
      this.m_bodyCount--;
   }
   b2Controller.prototype.Clear = function () {
      while (this.m_bodyList)
      this.RemoveBody(this.m_bodyList.body);
   }
   b2Controller.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Controller.prototype.GetWorld = function () {
      return this.m_world;
   }
   b2Controller.prototype.GetBodyList = function () {
      return this.m_bodyList;
   }
   b2ControllerEdge.b2ControllerEdge = function () {};
   Box2D.inherit(b2GravityController, Box2D.Dynamics.Controllers.b2Controller);
   b2GravityController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2GravityController.b2GravityController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.G = 1;
      this.invSqr = true;
   };
   b2GravityController.prototype.Step = function (step) {
      var i = null;
      var body1 = null;
      var p1 = null;
      var mass1 = 0;
      var j = null;
      var body2 = null;
      var p2 = null;
      var dx = 0;
      var dy = 0;
      var r2 = 0;
      var f = null;
      if (this.invSqr) {
         for (i = this.m_bodyList;
         i; i = i.nextBody) {
            body1 = i.body;
            p1 = body1.GetWorldCenter();
            mass1 = body1.GetMass();
            for (j = this.m_bodyList;
            j != i; j = j.nextBody) {
               body2 = j.body;
               p2 = body2.GetWorldCenter();
               dx = p2.x - p1.x;
               dy = p2.y - p1.y;
               r2 = dx * dx + dy * dy;
               if (r2 < Number.MIN_VALUE) continue;
               f = new b2Vec2(dx, dy);
               f.Multiply(this.G / r2 / Math.sqrt(r2) * mass1 * body2.GetMass());
               if (body1.IsAwake()) body1.ApplyForce(f, p1);
               f.Multiply((-1));
               if (body2.IsAwake()) body2.ApplyForce(f, p2);
            }
         }
      }
      else {
         for (i = this.m_bodyList;
         i; i = i.nextBody) {
            body1 = i.body;
            p1 = body1.GetWorldCenter();
            mass1 = body1.GetMass();
            for (j = this.m_bodyList;
            j != i; j = j.nextBody) {
               body2 = j.body;
               p2 = body2.GetWorldCenter();
               dx = p2.x - p1.x;
               dy = p2.y - p1.y;
               r2 = dx * dx + dy * dy;
               if (r2 < Number.MIN_VALUE) continue;
               f = new b2Vec2(dx, dy);
               f.Multiply(this.G / r2 * mass1 * body2.GetMass());
               if (body1.IsAwake()) body1.ApplyForce(f, p1);
               f.Multiply((-1));
               if (body2.IsAwake()) body2.ApplyForce(f, p2);
            }
         }
      }
   }
   Box2D.inherit(b2TensorDampingController, Box2D.Dynamics.Controllers.b2Controller);
   b2TensorDampingController.prototype.__super = Box2D.Dynamics.Controllers.b2Controller.prototype;
   b2TensorDampingController.b2TensorDampingController = function () {
      Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this, arguments);
      this.T = new b2Mat22();
      this.maxTimestep = 0;
   };
   b2TensorDampingController.prototype.SetAxisAligned = function (xDamping, yDamping) {
      if (xDamping === undefined) xDamping = 0;
      if (yDamping === undefined) yDamping = 0;
      this.T.col1.x = (-xDamping);
      this.T.col1.y = 0;
      this.T.col2.x = 0;
      this.T.col2.y = (-yDamping);
      if (xDamping > 0 || yDamping > 0) {
         this.maxTimestep = 1 / Math.max(xDamping, yDamping);
      }
      else {
         this.maxTimestep = 0;
      }
   }
   b2TensorDampingController.prototype.Step = function (step) {
      var timestep = step.dt;
      if (timestep <= Number.MIN_VALUE) return;
      if (timestep > this.maxTimestep && this.maxTimestep > 0) timestep = this.maxTimestep;
      for (var i = this.m_bodyList; i; i = i.nextBody) {
         var body = i.body;
         if (!body.IsAwake()) {
            continue;
         }
         var damping = body.GetWorldVector(b2Math.MulMV(this.T, body.GetLocalVector(body.GetLinearVelocity())));
         body.SetLinearVelocity(new b2Vec2(body.GetLinearVelocity().x + damping.x * timestep, body.GetLinearVelocity().y + damping.y * timestep));
      }
   }
})();
(function () {
   var b2Color = Box2D.Common.b2Color,
      b2internal = Box2D.Common.b2internal,
      b2Settings = Box2D.Common.b2Settings,
      b2Mat22 = Box2D.Common.Math.b2Mat22,
      b2Mat33 = Box2D.Common.Math.b2Mat33,
      b2Math = Box2D.Common.Math.b2Math,
      b2Sweep = Box2D.Common.Math.b2Sweep,
      b2Transform = Box2D.Common.Math.b2Transform,
      b2Vec2 = Box2D.Common.Math.b2Vec2,
      b2Vec3 = Box2D.Common.Math.b2Vec3,
      b2DistanceJoint = Box2D.Dynamics.Joints.b2DistanceJoint,
      b2DistanceJointDef = Box2D.Dynamics.Joints.b2DistanceJointDef,
      b2FrictionJoint = Box2D.Dynamics.Joints.b2FrictionJoint,
      b2FrictionJointDef = Box2D.Dynamics.Joints.b2FrictionJointDef,
      b2GearJoint = Box2D.Dynamics.Joints.b2GearJoint,
      b2GearJointDef = Box2D.Dynamics.Joints.b2GearJointDef,
      b2Jacobian = Box2D.Dynamics.Joints.b2Jacobian,
      b2Joint = Box2D.Dynamics.Joints.b2Joint,
      b2JointDef = Box2D.Dynamics.Joints.b2JointDef,
      b2JointEdge = Box2D.Dynamics.Joints.b2JointEdge,
      b2LineJoint = Box2D.Dynamics.Joints.b2LineJoint,
      b2LineJointDef = Box2D.Dynamics.Joints.b2LineJointDef,
      b2MouseJoint = Box2D.Dynamics.Joints.b2MouseJoint,
      b2MouseJointDef = Box2D.Dynamics.Joints.b2MouseJointDef,
      b2PrismaticJoint = Box2D.Dynamics.Joints.b2PrismaticJoint,
      b2PrismaticJointDef = Box2D.Dynamics.Joints.b2PrismaticJointDef,
      b2PulleyJoint = Box2D.Dynamics.Joints.b2PulleyJoint,
      b2PulleyJointDef = Box2D.Dynamics.Joints.b2PulleyJointDef,
      b2RevoluteJoint = Box2D.Dynamics.Joints.b2RevoluteJoint,
      b2RevoluteJointDef = Box2D.Dynamics.Joints.b2RevoluteJointDef,
      b2WeldJoint = Box2D.Dynamics.Joints.b2WeldJoint,
      b2WeldJointDef = Box2D.Dynamics.Joints.b2WeldJointDef,
      b2Body = Box2D.Dynamics.b2Body,
      b2BodyDef = Box2D.Dynamics.b2BodyDef,
      b2ContactFilter = Box2D.Dynamics.b2ContactFilter,
      b2ContactImpulse = Box2D.Dynamics.b2ContactImpulse,
      b2ContactListener = Box2D.Dynamics.b2ContactListener,
      b2ContactManager = Box2D.Dynamics.b2ContactManager,
      b2DebugDraw = Box2D.Dynamics.b2DebugDraw,
      b2DestructionListener = Box2D.Dynamics.b2DestructionListener,
      b2FilterData = Box2D.Dynamics.b2FilterData,
      b2Fixture = Box2D.Dynamics.b2Fixture,
      b2FixtureDef = Box2D.Dynamics.b2FixtureDef,
      b2Island = Box2D.Dynamics.b2Island,
      b2TimeStep = Box2D.Dynamics.b2TimeStep,
      b2World = Box2D.Dynamics.b2World;

   Box2D.inherit(b2DistanceJoint, Box2D.Dynamics.Joints.b2Joint);
   b2DistanceJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2DistanceJoint.b2DistanceJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_u = new b2Vec2();
   };
   b2DistanceJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2DistanceJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2DistanceJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse * this.m_u.x, inv_dt * this.m_impulse * this.m_u.y);
   }
   b2DistanceJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2DistanceJoint.prototype.GetLength = function () {
      return this.m_length;
   }
   b2DistanceJoint.prototype.SetLength = function (length) {
      if (length === undefined) length = 0;
      this.m_length = length;
   }
   b2DistanceJoint.prototype.GetFrequency = function () {
      return this.m_frequencyHz;
   }
   b2DistanceJoint.prototype.SetFrequency = function (hz) {
      if (hz === undefined) hz = 0;
      this.m_frequencyHz = hz;
   }
   b2DistanceJoint.prototype.GetDampingRatio = function () {
      return this.m_dampingRatio;
   }
   b2DistanceJoint.prototype.SetDampingRatio = function (ratio) {
      if (ratio === undefined) ratio = 0;
      this.m_dampingRatio = ratio;
   }
   b2DistanceJoint.prototype.b2DistanceJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_length = def.length;
      this.m_frequencyHz = def.frequencyHz;
      this.m_dampingRatio = def.dampingRatio;
      this.m_impulse = 0.0;
      this.m_gamma = 0.0;
      this.m_bias = 0.0;
   }
   b2DistanceJoint.prototype.InitVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      this.m_u.x = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      this.m_u.y = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      var length = Math.sqrt(this.m_u.x * this.m_u.x + this.m_u.y * this.m_u.y);
      if (length > b2Settings.b2_linearSlop) {
         this.m_u.Multiply(1.0 / length);
      }
      else {
         this.m_u.SetZero();
      }
      var cr1u = (r1X * this.m_u.y - r1Y * this.m_u.x);
      var cr2u = (r2X * this.m_u.y - r2Y * this.m_u.x);
      var invMass = bA.m_invMass + bA.m_invI * cr1u * cr1u + bB.m_invMass + bB.m_invI * cr2u * cr2u;
      this.m_mass = invMass != 0.0 ? 1.0 / invMass : 0.0;
      if (this.m_frequencyHz > 0.0) {
         var C = length - this.m_length;
         var omega = 2.0 * Math.PI * this.m_frequencyHz;
         var d = 2.0 * this.m_mass * this.m_dampingRatio * omega;
         var k = this.m_mass * omega * omega;
         this.m_gamma = step.dt * (d + step.dt * k);
         this.m_gamma = this.m_gamma != 0.0 ? 1 / this.m_gamma : 0.0;
         this.m_bias = C * step.dt * k * this.m_gamma;
         this.m_mass = invMass + this.m_gamma;
         this.m_mass = this.m_mass != 0.0 ? 1.0 / this.m_mass : 0.0;
      }
      if (step.warmStarting) {
         this.m_impulse *= step.dtRatio;
         var PX = this.m_impulse * this.m_u.x;
         var PY = this.m_impulse * this.m_u.y;
         bA.m_linearVelocity.x -= bA.m_invMass * PX;
         bA.m_linearVelocity.y -= bA.m_invMass * PY;
         bA.m_angularVelocity -= bA.m_invI * (r1X * PY - r1Y * PX);
         bB.m_linearVelocity.x += bB.m_invMass * PX;
         bB.m_linearVelocity.y += bB.m_invMass * PY;
         bB.m_angularVelocity += bB.m_invI * (r2X * PY - r2Y * PX);
      }
      else {
         this.m_impulse = 0.0;
      }
   }
   b2DistanceJoint.prototype.SolveVelocityConstraints = function (step) {
      var tMat;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var v1X = bA.m_linearVelocity.x + ((-bA.m_angularVelocity * r1Y));
      var v1Y = bA.m_linearVelocity.y + (bA.m_angularVelocity * r1X);
      var v2X = bB.m_linearVelocity.x + ((-bB.m_angularVelocity * r2Y));
      var v2Y = bB.m_linearVelocity.y + (bB.m_angularVelocity * r2X);
      var Cdot = (this.m_u.x * (v2X - v1X) + this.m_u.y * (v2Y - v1Y));
      var impulse = (-this.m_mass * (Cdot + this.m_bias + this.m_gamma * this.m_impulse));
      this.m_impulse += impulse;
      var PX = impulse * this.m_u.x;
      var PY = impulse * this.m_u.y;
      bA.m_linearVelocity.x -= bA.m_invMass * PX;
      bA.m_linearVelocity.y -= bA.m_invMass * PY;
      bA.m_angularVelocity -= bA.m_invI * (r1X * PY - r1Y * PX);
      bB.m_linearVelocity.x += bB.m_invMass * PX;
      bB.m_linearVelocity.y += bB.m_invMass * PY;
      bB.m_angularVelocity += bB.m_invI * (r2X * PY - r2Y * PX);
   }
   b2DistanceJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var tMat;
      if (this.m_frequencyHz > 0.0) {
         return true;
      }
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      var dY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      var length = Math.sqrt(dX * dX + dY * dY);
      dX /= length;
      dY /= length;
      var C = length - this.m_length;
      C = b2Math.Clamp(C, (-b2Settings.b2_maxLinearCorrection), b2Settings.b2_maxLinearCorrection);
      var impulse = (-this.m_mass * C);
      this.m_u.Set(dX, dY);
      var PX = impulse * this.m_u.x;
      var PY = impulse * this.m_u.y;
      bA.m_sweep.c.x -= bA.m_invMass * PX;
      bA.m_sweep.c.y -= bA.m_invMass * PY;
      bA.m_sweep.a -= bA.m_invI * (r1X * PY - r1Y * PX);
      bB.m_sweep.c.x += bB.m_invMass * PX;
      bB.m_sweep.c.y += bB.m_invMass * PY;
      bB.m_sweep.a += bB.m_invI * (r2X * PY - r2Y * PX);
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return b2Math.Abs(C) < b2Settings.b2_linearSlop;
   }
   Box2D.inherit(b2DistanceJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2DistanceJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2DistanceJointDef.b2DistanceJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2DistanceJointDef.prototype.b2DistanceJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_distanceJoint;
      this.length = 1.0;
      this.frequencyHz = 0.0;
      this.dampingRatio = 0.0;
   }
   b2DistanceJointDef.prototype.Initialize = function (bA, bB, anchorA, anchorB) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA.SetV(this.bodyA.GetLocalPoint(anchorA));
      this.localAnchorB.SetV(this.bodyB.GetLocalPoint(anchorB));
      var dX = anchorB.x - anchorA.x;
      var dY = anchorB.y - anchorA.y;
      this.length = Math.sqrt(dX * dX + dY * dY);
      this.frequencyHz = 0.0;
      this.dampingRatio = 0.0;
   }
   Box2D.inherit(b2FrictionJoint, Box2D.Dynamics.Joints.b2Joint);
   b2FrictionJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2FrictionJoint.b2FrictionJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchorA = new b2Vec2();
      this.m_localAnchorB = new b2Vec2();
      this.m_linearMass = new b2Mat22();
      this.m_linearImpulse = new b2Vec2();
   };
   b2FrictionJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
   }
   b2FrictionJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
   }
   b2FrictionJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_linearImpulse.x, inv_dt * this.m_linearImpulse.y);
   }
   b2FrictionJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_angularImpulse;
   }
   b2FrictionJoint.prototype.SetMaxForce = function (force) {
      if (force === undefined) force = 0;
      this.m_maxForce = force;
   }
   b2FrictionJoint.prototype.GetMaxForce = function () {
      return this.m_maxForce;
   }
   b2FrictionJoint.prototype.SetMaxTorque = function (torque) {
      if (torque === undefined) torque = 0;
      this.m_maxTorque = torque;
   }
   b2FrictionJoint.prototype.GetMaxTorque = function () {
      return this.m_maxTorque;
   }
   b2FrictionJoint.prototype.b2FrictionJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_localAnchorA.SetV(def.localAnchorA);
      this.m_localAnchorB.SetV(def.localAnchorB);
      this.m_linearMass.SetZero();
      this.m_angularMass = 0.0;
      this.m_linearImpulse.SetZero();
      this.m_angularImpulse = 0.0;
      this.m_maxForce = def.maxForce;
      this.m_maxTorque = def.maxTorque;
   }
   b2FrictionJoint.prototype.InitVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      var K = new b2Mat22();
      K.col1.x = mA + mB;
      K.col2.x = 0.0;
      K.col1.y = 0.0;
      K.col2.y = mA + mB;
      K.col1.x += iA * rAY * rAY;
      K.col2.x += (-iA * rAX * rAY);
      K.col1.y += (-iA * rAX * rAY);
      K.col2.y += iA * rAX * rAX;
      K.col1.x += iB * rBY * rBY;
      K.col2.x += (-iB * rBX * rBY);
      K.col1.y += (-iB * rBX * rBY);
      K.col2.y += iB * rBX * rBX;
      K.GetInverse(this.m_linearMass);
      this.m_angularMass = iA + iB;
      if (this.m_angularMass > 0.0) {
         this.m_angularMass = 1.0 / this.m_angularMass;
      }
      if (step.warmStarting) {
         this.m_linearImpulse.x *= step.dtRatio;
         this.m_linearImpulse.y *= step.dtRatio;
         this.m_angularImpulse *= step.dtRatio;
         var P = this.m_linearImpulse;
         bA.m_linearVelocity.x -= mA * P.x;
         bA.m_linearVelocity.y -= mA * P.y;
         bA.m_angularVelocity -= iA * (rAX * P.y - rAY * P.x + this.m_angularImpulse);
         bB.m_linearVelocity.x += mB * P.x;
         bB.m_linearVelocity.y += mB * P.y;
         bB.m_angularVelocity += iB * (rBX * P.y - rBY * P.x + this.m_angularImpulse);
      }
      else {
         this.m_linearImpulse.SetZero();
         this.m_angularImpulse = 0.0;
      }
   }
   b2FrictionJoint.prototype.SolveVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var vA = bA.m_linearVelocity;
      var wA = bA.m_angularVelocity;
      var vB = bB.m_linearVelocity;
      var wB = bB.m_angularVelocity;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var maxImpulse = 0; {
         var Cdot = wB - wA;
         var impulse = (-this.m_angularMass * Cdot);
         var oldImpulse = this.m_angularImpulse;
         maxImpulse = step.dt * this.m_maxTorque;
         this.m_angularImpulse = b2Math.Clamp(this.m_angularImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_angularImpulse - oldImpulse;
         wA -= iA * impulse;
         wB += iB * impulse;
      } {
         var CdotX = vB.x - wB * rBY - vA.x + wA * rAY;
         var CdotY = vB.y + wB * rBX - vA.y - wA * rAX;
         var impulseV = b2Math.MulMV(this.m_linearMass, new b2Vec2((-CdotX), (-CdotY)));
         var oldImpulseV = this.m_linearImpulse.Copy();
         this.m_linearImpulse.Add(impulseV);
         maxImpulse = step.dt * this.m_maxForce;
         if (this.m_linearImpulse.LengthSquared() > maxImpulse * maxImpulse) {
            this.m_linearImpulse.Normalize();
            this.m_linearImpulse.Multiply(maxImpulse);
         }
         impulseV = b2Math.SubtractVV(this.m_linearImpulse, oldImpulseV);
         vA.x -= mA * impulseV.x;
         vA.y -= mA * impulseV.y;
         wA -= iA * (rAX * impulseV.y - rAY * impulseV.x);
         vB.x += mB * impulseV.x;
         vB.y += mB * impulseV.y;
         wB += iB * (rBX * impulseV.y - rBY * impulseV.x);
      }
      bA.m_angularVelocity = wA;
      bB.m_angularVelocity = wB;
   }
   b2FrictionJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      return true;
   }
   Box2D.inherit(b2FrictionJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2FrictionJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2FrictionJointDef.b2FrictionJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2FrictionJointDef.prototype.b2FrictionJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_frictionJoint;
      this.maxForce = 0.0;
      this.maxTorque = 0.0;
   }
   b2FrictionJointDef.prototype.Initialize = function (bA, bB, anchor) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA.SetV(this.bodyA.GetLocalPoint(anchor));
      this.localAnchorB.SetV(this.bodyB.GetLocalPoint(anchor));
   }
   Box2D.inherit(b2GearJoint, Box2D.Dynamics.Joints.b2Joint);
   b2GearJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2GearJoint.b2GearJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_groundAnchor1 = new b2Vec2();
      this.m_groundAnchor2 = new b2Vec2();
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_J = new b2Jacobian();
   };
   b2GearJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2GearJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2GearJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse * this.m_J.linearB.x, inv_dt * this.m_impulse * this.m_J.linearB.y);
   }
   b2GearJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      var tMat = this.m_bodyB.m_xf.R;
      var rX = this.m_localAnchor1.x - this.m_bodyB.m_sweep.localCenter.x;
      var rY = this.m_localAnchor1.y - this.m_bodyB.m_sweep.localCenter.y;
      var tX = tMat.col1.x * rX + tMat.col2.x * rY;
      rY = tMat.col1.y * rX + tMat.col2.y * rY;
      rX = tX;
      var PX = this.m_impulse * this.m_J.linearB.x;
      var PY = this.m_impulse * this.m_J.linearB.y;
      return inv_dt * (this.m_impulse * this.m_J.angularB - rX * PY + rY * PX);
   }
   b2GearJoint.prototype.GetRatio = function () {
      return this.m_ratio;
   }
   b2GearJoint.prototype.SetRatio = function (ratio) {
      if (ratio === undefined) ratio = 0;
      this.m_ratio = ratio;
   }
   b2GearJoint.prototype.b2GearJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var type1 = parseInt(def.joint1.m_type);
      var type2 = parseInt(def.joint2.m_type);
      this.m_revolute1 = null;
      this.m_prismatic1 = null;
      this.m_revolute2 = null;
      this.m_prismatic2 = null;
      var coordinate1 = 0;
      var coordinate2 = 0;
      this.m_ground1 = def.joint1.GetBodyA();
      this.m_bodyA = def.joint1.GetBodyB();
      if (type1 == b2Joint.e_revoluteJoint) {
         this.m_revolute1 = (def.joint1 instanceof b2RevoluteJoint ? def.joint1 : null);
         this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1);
         this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2);
         coordinate1 = this.m_revolute1.GetJointAngle();
      }
      else {
         this.m_prismatic1 = (def.joint1 instanceof b2PrismaticJoint ? def.joint1 : null);
         this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1);
         this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2);
         coordinate1 = this.m_prismatic1.GetJointTranslation();
      }
      this.m_ground2 = def.joint2.GetBodyA();
      this.m_bodyB = def.joint2.GetBodyB();
      if (type2 == b2Joint.e_revoluteJoint) {
         this.m_revolute2 = (def.joint2 instanceof b2RevoluteJoint ? def.joint2 : null);
         this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1);
         this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2);
         coordinate2 = this.m_revolute2.GetJointAngle();
      }
      else {
         this.m_prismatic2 = (def.joint2 instanceof b2PrismaticJoint ? def.joint2 : null);
         this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1);
         this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2);
         coordinate2 = this.m_prismatic2.GetJointTranslation();
      }
      this.m_ratio = def.ratio;
      this.m_constant = coordinate1 + this.m_ratio * coordinate2;
      this.m_impulse = 0.0;
   }
   b2GearJoint.prototype.InitVelocityConstraints = function (step) {
      var g1 = this.m_ground1;
      var g2 = this.m_ground2;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var ugX = 0;
      var ugY = 0;
      var rX = 0;
      var rY = 0;
      var tMat;
      var tVec;
      var crug = 0;
      var tX = 0;
      var K = 0.0;
      this.m_J.SetZero();
      if (this.m_revolute1) {
         this.m_J.angularA = (-1.0);
         K += bA.m_invI;
      }
      else {
         tMat = g1.m_xf.R;
         tVec = this.m_prismatic1.m_localXAxis1;
         ugX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         ugY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tMat = bA.m_xf.R;
         rX = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         rY = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = tMat.col1.x * rX + tMat.col2.x * rY;
         rY = tMat.col1.y * rX + tMat.col2.y * rY;
         rX = tX;
         crug = rX * ugY - rY * ugX;
         this.m_J.linearA.Set((-ugX), (-ugY));
         this.m_J.angularA = (-crug);
         K += bA.m_invMass + bA.m_invI * crug * crug;
      }
      if (this.m_revolute2) {
         this.m_J.angularB = (-this.m_ratio);
         K += this.m_ratio * this.m_ratio * bB.m_invI;
      }
      else {
         tMat = g2.m_xf.R;
         tVec = this.m_prismatic2.m_localXAxis1;
         ugX = tMat.col1.x * tVec.x + tMat.col2.x * tVec.y;
         ugY = tMat.col1.y * tVec.x + tMat.col2.y * tVec.y;
         tMat = bB.m_xf.R;
         rX = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         rY = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = tMat.col1.x * rX + tMat.col2.x * rY;
         rY = tMat.col1.y * rX + tMat.col2.y * rY;
         rX = tX;
         crug = rX * ugY - rY * ugX;
         this.m_J.linearB.Set((-this.m_ratio * ugX), (-this.m_ratio * ugY));
         this.m_J.angularB = (-this.m_ratio * crug);
         K += this.m_ratio * this.m_ratio * (bB.m_invMass + bB.m_invI * crug * crug);
      }
      this.m_mass = K > 0.0 ? 1.0 / K : 0.0;
      if (step.warmStarting) {
         bA.m_linearVelocity.x += bA.m_invMass * this.m_impulse * this.m_J.linearA.x;
         bA.m_linearVelocity.y += bA.m_invMass * this.m_impulse * this.m_J.linearA.y;
         bA.m_angularVelocity += bA.m_invI * this.m_impulse * this.m_J.angularA;
         bB.m_linearVelocity.x += bB.m_invMass * this.m_impulse * this.m_J.linearB.x;
         bB.m_linearVelocity.y += bB.m_invMass * this.m_impulse * this.m_J.linearB.y;
         bB.m_angularVelocity += bB.m_invI * this.m_impulse * this.m_J.angularB;
      }
      else {
         this.m_impulse = 0.0;
      }
   }
   b2GearJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var Cdot = this.m_J.Compute(bA.m_linearVelocity, bA.m_angularVelocity, bB.m_linearVelocity, bB.m_angularVelocity);
      var impulse = (-this.m_mass * Cdot);
      this.m_impulse += impulse;
      bA.m_linearVelocity.x += bA.m_invMass * impulse * this.m_J.linearA.x;
      bA.m_linearVelocity.y += bA.m_invMass * impulse * this.m_J.linearA.y;
      bA.m_angularVelocity += bA.m_invI * impulse * this.m_J.angularA;
      bB.m_linearVelocity.x += bB.m_invMass * impulse * this.m_J.linearB.x;
      bB.m_linearVelocity.y += bB.m_invMass * impulse * this.m_J.linearB.y;
      bB.m_angularVelocity += bB.m_invI * impulse * this.m_J.angularB;
   }
   b2GearJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var linearError = 0.0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var coordinate1 = 0;
      var coordinate2 = 0;
      if (this.m_revolute1) {
         coordinate1 = this.m_revolute1.GetJointAngle();
      }
      else {
         coordinate1 = this.m_prismatic1.GetJointTranslation();
      }
      if (this.m_revolute2) {
         coordinate2 = this.m_revolute2.GetJointAngle();
      }
      else {
         coordinate2 = this.m_prismatic2.GetJointTranslation();
      }
      var C = this.m_constant - (coordinate1 + this.m_ratio * coordinate2);
      var impulse = (-this.m_mass * C);
      bA.m_sweep.c.x += bA.m_invMass * impulse * this.m_J.linearA.x;
      bA.m_sweep.c.y += bA.m_invMass * impulse * this.m_J.linearA.y;
      bA.m_sweep.a += bA.m_invI * impulse * this.m_J.angularA;
      bB.m_sweep.c.x += bB.m_invMass * impulse * this.m_J.linearB.x;
      bB.m_sweep.c.y += bB.m_invMass * impulse * this.m_J.linearB.y;
      bB.m_sweep.a += bB.m_invI * impulse * this.m_J.angularB;
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return linearError < b2Settings.b2_linearSlop;
   }
   Box2D.inherit(b2GearJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2GearJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2GearJointDef.b2GearJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
   };
   b2GearJointDef.prototype.b2GearJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_gearJoint;
      this.joint1 = null;
      this.joint2 = null;
      this.ratio = 1.0;
   }
   b2Jacobian.b2Jacobian = function () {
      this.linearA = new b2Vec2();
      this.linearB = new b2Vec2();
   };
   b2Jacobian.prototype.SetZero = function () {
      this.linearA.SetZero();
      this.angularA = 0.0;
      this.linearB.SetZero();
      this.angularB = 0.0;
   }
   b2Jacobian.prototype.Set = function (x1, a1, x2, a2) {
      if (a1 === undefined) a1 = 0;
      if (a2 === undefined) a2 = 0;
      this.linearA.SetV(x1);
      this.angularA = a1;
      this.linearB.SetV(x2);
      this.angularB = a2;
   }
   b2Jacobian.prototype.Compute = function (x1, a1, x2, a2) {
      if (a1 === undefined) a1 = 0;
      if (a2 === undefined) a2 = 0;
      return (this.linearA.x * x1.x + this.linearA.y * x1.y) + this.angularA * a1 + (this.linearB.x * x2.x + this.linearB.y * x2.y) + this.angularB * a2;
   }
   b2Joint.b2Joint = function () {
      this.m_edgeA = new b2JointEdge();
      this.m_edgeB = new b2JointEdge();
      this.m_localCenterA = new b2Vec2();
      this.m_localCenterB = new b2Vec2();
   };
   b2Joint.prototype.GetType = function () {
      return this.m_type;
   }
   b2Joint.prototype.GetAnchorA = function () {
      return null;
   }
   b2Joint.prototype.GetAnchorB = function () {
      return null;
   }
   b2Joint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return null;
   }
   b2Joint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2Joint.prototype.GetBodyA = function () {
      return this.m_bodyA;
   }
   b2Joint.prototype.GetBodyB = function () {
      return this.m_bodyB;
   }
   b2Joint.prototype.GetNext = function () {
      return this.m_next;
   }
   b2Joint.prototype.GetUserData = function () {
      return this.m_userData;
   }
   b2Joint.prototype.SetUserData = function (data) {
      this.m_userData = data;
   }
   b2Joint.prototype.IsActive = function () {
      return this.m_bodyA.IsActive() && this.m_bodyB.IsActive();
   }
   b2Joint.Create = function (def, allocator) {
      var joint = null;
      switch (def.type) {
      case b2Joint.e_distanceJoint:
         {
            joint = new b2DistanceJoint((def instanceof b2DistanceJointDef ? def : null));
         }
         break;
      case b2Joint.e_mouseJoint:
         {
            joint = new b2MouseJoint((def instanceof b2MouseJointDef ? def : null));
         }
         break;
      case b2Joint.e_prismaticJoint:
         {
            joint = new b2PrismaticJoint((def instanceof b2PrismaticJointDef ? def : null));
         }
         break;
      case b2Joint.e_revoluteJoint:
         {
            joint = new b2RevoluteJoint((def instanceof b2RevoluteJointDef ? def : null));
         }
         break;
      case b2Joint.e_pulleyJoint:
         {
            joint = new b2PulleyJoint((def instanceof b2PulleyJointDef ? def : null));
         }
         break;
      case b2Joint.e_gearJoint:
         {
            joint = new b2GearJoint((def instanceof b2GearJointDef ? def : null));
         }
         break;
      case b2Joint.e_lineJoint:
         {
            joint = new b2LineJoint((def instanceof b2LineJointDef ? def : null));
         }
         break;
      case b2Joint.e_weldJoint:
         {
            joint = new b2WeldJoint((def instanceof b2WeldJointDef ? def : null));
         }
         break;
      case b2Joint.e_frictionJoint:
         {
            joint = new b2FrictionJoint((def instanceof b2FrictionJointDef ? def : null));
         }
         break;
      default:
         break;
      }
      return joint;
   }
   b2Joint.Destroy = function (joint, allocator) {}
   b2Joint.prototype.b2Joint = function (def) {
      b2Settings.b2Assert(def.bodyA != def.bodyB);
      this.m_type = def.type;
      this.m_prev = null;
      this.m_next = null;
      this.m_bodyA = def.bodyA;
      this.m_bodyB = def.bodyB;
      this.m_collideConnected = def.collideConnected;
      this.m_islandFlag = false;
      this.m_userData = def.userData;
   }
   b2Joint.prototype.InitVelocityConstraints = function (step) {}
   b2Joint.prototype.SolveVelocityConstraints = function (step) {}
   b2Joint.prototype.FinalizeVelocityConstraints = function () {}
   b2Joint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      return false;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Joints.b2Joint.e_unknownJoint = 0;
      Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint = 1;
      Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint = 2;
      Box2D.Dynamics.Joints.b2Joint.e_distanceJoint = 3;
      Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint = 4;
      Box2D.Dynamics.Joints.b2Joint.e_mouseJoint = 5;
      Box2D.Dynamics.Joints.b2Joint.e_gearJoint = 6;
      Box2D.Dynamics.Joints.b2Joint.e_lineJoint = 7;
      Box2D.Dynamics.Joints.b2Joint.e_weldJoint = 8;
      Box2D.Dynamics.Joints.b2Joint.e_frictionJoint = 9;
      Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit = 0;
      Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit = 1;
      Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit = 2;
      Box2D.Dynamics.Joints.b2Joint.e_equalLimits = 3;
   });
   b2JointDef.b2JointDef = function () {};
   b2JointDef.prototype.b2JointDef = function () {
      this.type = b2Joint.e_unknownJoint;
      this.userData = null;
      this.bodyA = null;
      this.bodyB = null;
      this.collideConnected = false;
   }
   b2JointEdge.b2JointEdge = function () {};
   Box2D.inherit(b2LineJoint, Box2D.Dynamics.Joints.b2Joint);
   b2LineJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2LineJoint.b2LineJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_localXAxis1 = new b2Vec2();
      this.m_localYAxis1 = new b2Vec2();
      this.m_axis = new b2Vec2();
      this.m_perp = new b2Vec2();
      this.m_K = new b2Mat22();
      this.m_impulse = new b2Vec2();
   };
   b2LineJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2LineJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2LineJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * (this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.x), inv_dt * (this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.y));
   }
   b2LineJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.y;
   }
   b2LineJoint.prototype.GetJointTranslation = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var p1 = bA.GetWorldPoint(this.m_localAnchor1);
      var p2 = bB.GetWorldPoint(this.m_localAnchor2);
      var dX = p2.x - p1.x;
      var dY = p2.y - p1.y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var translation = axis.x * dX + axis.y * dY;
      return translation;
   }
   b2LineJoint.prototype.GetJointSpeed = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var p1X = bA.m_sweep.c.x + r1X;
      var p1Y = bA.m_sweep.c.y + r1Y;
      var p2X = bB.m_sweep.c.x + r2X;
      var p2Y = bB.m_sweep.c.y + r2Y;
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var v1 = bA.m_linearVelocity;
      var v2 = bB.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var w2 = bB.m_angularVelocity;
      var speed = (dX * ((-w1 * axis.y)) + dY * (w1 * axis.x)) + (axis.x * (((v2.x + ((-w2 * r2Y))) - v1.x) - ((-w1 * r1Y))) + axis.y * (((v2.y + (w2 * r2X)) - v1.y) - (w1 * r1X)));
      return speed;
   }
   b2LineJoint.prototype.IsLimitEnabled = function () {
      return this.m_enableLimit;
   }
   b2LineJoint.prototype.EnableLimit = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableLimit = flag;
   }
   b2LineJoint.prototype.GetLowerLimit = function () {
      return this.m_lowerTranslation;
   }
   b2LineJoint.prototype.GetUpperLimit = function () {
      return this.m_upperTranslation;
   }
   b2LineJoint.prototype.SetLimits = function (lower, upper) {
      if (lower === undefined) lower = 0;
      if (upper === undefined) upper = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_lowerTranslation = lower;
      this.m_upperTranslation = upper;
   }
   b2LineJoint.prototype.IsMotorEnabled = function () {
      return this.m_enableMotor;
   }
   b2LineJoint.prototype.EnableMotor = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableMotor = flag;
   }
   b2LineJoint.prototype.SetMotorSpeed = function (speed) {
      if (speed === undefined) speed = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_motorSpeed = speed;
   }
   b2LineJoint.prototype.GetMotorSpeed = function () {
      return this.m_motorSpeed;
   }
   b2LineJoint.prototype.SetMaxMotorForce = function (force) {
      if (force === undefined) force = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_maxMotorForce = force;
   }
   b2LineJoint.prototype.GetMaxMotorForce = function () {
      return this.m_maxMotorForce;
   }
   b2LineJoint.prototype.GetMotorForce = function () {
      return this.m_motorImpulse;
   }
   b2LineJoint.prototype.b2LineJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_localXAxis1.SetV(def.localAxisA);
      this.m_localYAxis1.x = (-this.m_localXAxis1.y);
      this.m_localYAxis1.y = this.m_localXAxis1.x;
      this.m_impulse.SetZero();
      this.m_motorMass = 0.0;
      this.m_motorImpulse = 0.0;
      this.m_lowerTranslation = def.lowerTranslation;
      this.m_upperTranslation = def.upperTranslation;
      this.m_maxMotorForce = def.maxMotorForce;
      this.m_motorSpeed = def.motorSpeed;
      this.m_enableLimit = def.enableLimit;
      this.m_enableMotor = def.enableMotor;
      this.m_limitState = b2Joint.e_inactiveLimit;
      this.m_axis.SetZero();
      this.m_perp.SetZero();
   }
   b2LineJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      this.m_localCenterA.SetV(bA.GetLocalCenter());
      this.m_localCenterB.SetV(bB.GetLocalCenter());
      var xf1 = bA.GetTransform();
      var xf2 = bB.GetTransform();
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      var dY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      this.m_invMassA = bA.m_invMass;
      this.m_invMassB = bB.m_invMass;
      this.m_invIA = bA.m_invI;
      this.m_invIB = bB.m_invI; {
         this.m_axis.SetV(b2Math.MulMV(xf1.R, this.m_localXAxis1));
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         this.m_motorMass = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_a1 * this.m_a1 + this.m_invIB * this.m_a2 * this.m_a2;
         this.m_motorMass = this.m_motorMass > Number.MIN_VALUE ? 1.0 / this.m_motorMass : 0.0;
      } {
         this.m_perp.SetV(b2Math.MulMV(xf1.R, this.m_localYAxis1));
         this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
         this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
         var m1 = this.m_invMassA;
         var m2 = this.m_invMassB;
         var i1 = this.m_invIA;
         var i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
      }
      if (this.m_enableLimit) {
         var jointTransition = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            this.m_limitState = b2Joint.e_equalLimits;
         }
         else if (jointTransition <= this.m_lowerTranslation) {
            if (this.m_limitState != b2Joint.e_atLowerLimit) {
               this.m_limitState = b2Joint.e_atLowerLimit;
               this.m_impulse.y = 0.0;
            }
         }
         else if (jointTransition >= this.m_upperTranslation) {
            if (this.m_limitState != b2Joint.e_atUpperLimit) {
               this.m_limitState = b2Joint.e_atUpperLimit;
               this.m_impulse.y = 0.0;
            }
         }
         else {
            this.m_limitState = b2Joint.e_inactiveLimit;
            this.m_impulse.y = 0.0;
         }
      }
      else {
         this.m_limitState = b2Joint.e_inactiveLimit;
      }
      if (this.m_enableMotor == false) {
         this.m_motorImpulse = 0.0;
      }
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_motorImpulse *= step.dtRatio;
         var PX = this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.x;
         var PY = this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.y) * this.m_axis.y;
         var L1 = this.m_impulse.x * this.m_s1 + (this.m_motorImpulse + this.m_impulse.y) * this.m_a1;
         var L2 = this.m_impulse.x * this.m_s2 + (this.m_motorImpulse + this.m_impulse.y) * this.m_a2;
         bA.m_linearVelocity.x -= this.m_invMassA * PX;
         bA.m_linearVelocity.y -= this.m_invMassA * PY;
         bA.m_angularVelocity -= this.m_invIA * L1;
         bB.m_linearVelocity.x += this.m_invMassB * PX;
         bB.m_linearVelocity.y += this.m_invMassB * PY;
         bB.m_angularVelocity += this.m_invIB * L2;
      }
      else {
         this.m_impulse.SetZero();
         this.m_motorImpulse = 0.0;
      }
   }
   b2LineJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var v1 = bA.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var v2 = bB.m_linearVelocity;
      var w2 = bB.m_angularVelocity;
      var PX = 0;
      var PY = 0;
      var L1 = 0;
      var L2 = 0;
      if (this.m_enableMotor && this.m_limitState != b2Joint.e_equalLimits) {
         var Cdot = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
         var oldImpulse = this.m_motorImpulse;
         var maxImpulse = step.dt * this.m_maxMotorForce;
         this.m_motorImpulse = b2Math.Clamp(this.m_motorImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_motorImpulse - oldImpulse;
         PX = impulse * this.m_axis.x;
         PY = impulse * this.m_axis.y;
         L1 = impulse * this.m_a1;
         L2 = impulse * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      var Cdot1 = this.m_perp.x * (v2.x - v1.x) + this.m_perp.y * (v2.y - v1.y) + this.m_s2 * w2 - this.m_s1 * w1;
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         var Cdot2 = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var f1 = this.m_impulse.Copy();
         var df = this.m_K.Solve(new b2Vec2(), (-Cdot1), (-Cdot2));
         this.m_impulse.Add(df);
         if (this.m_limitState == b2Joint.e_atLowerLimit) {
            this.m_impulse.y = b2Math.Max(this.m_impulse.y, 0.0);
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            this.m_impulse.y = b2Math.Min(this.m_impulse.y, 0.0);
         }
         var b = (-Cdot1) - (this.m_impulse.y - f1.y) * this.m_K.col2.x;
         var f2r = 0;
         if (this.m_K.col1.x != 0.0) {
            f2r = b / this.m_K.col1.x + f1.x;
         }
         else {
            f2r = f1.x;
         }
         this.m_impulse.x = f2r;
         df.x = this.m_impulse.x - f1.x;
         df.y = this.m_impulse.y - f1.y;
         PX = df.x * this.m_perp.x + df.y * this.m_axis.x;
         PY = df.x * this.m_perp.y + df.y * this.m_axis.y;
         L1 = df.x * this.m_s1 + df.y * this.m_a1;
         L2 = df.x * this.m_s2 + df.y * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      else {
         var df2 = 0;
         if (this.m_K.col1.x != 0.0) {
            df2 = ((-Cdot1)) / this.m_K.col1.x;
         }
         else {
            df2 = 0.0;
         }
         this.m_impulse.x += df2;
         PX = df2 * this.m_perp.x;
         PY = df2 * this.m_perp.y;
         L1 = df2 * this.m_s1;
         L2 = df2 * this.m_s2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      bA.m_linearVelocity.SetV(v1);
      bA.m_angularVelocity = w1;
      bB.m_linearVelocity.SetV(v2);
      bB.m_angularVelocity = w2;
   }
   b2LineJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var limitC = 0;
      var oldLimitImpulse = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var c1 = bA.m_sweep.c;
      var a1 = bA.m_sweep.a;
      var c2 = bB.m_sweep.c;
      var a2 = bB.m_sweep.a;
      var tMat;
      var tX = 0;
      var m1 = 0;
      var m2 = 0;
      var i1 = 0;
      var i2 = 0;
      var linearError = 0.0;
      var angularError = 0.0;
      var active = false;
      var C2 = 0.0;
      var R1 = b2Mat22.FromAngle(a1);
      var R2 = b2Mat22.FromAngle(a2);
      tMat = R1;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = R2;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = c2.x + r2X - c1.x - r1X;
      var dY = c2.y + r2Y - c1.y - r1Y;
      if (this.m_enableLimit) {
         this.m_axis = b2Math.MulMV(R1, this.m_localXAxis1);
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         var translation = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            C2 = b2Math.Clamp(translation, (-b2Settings.b2_maxLinearCorrection), b2Settings.b2_maxLinearCorrection);
            linearError = b2Math.Abs(translation);
            active = true;
         }
         else if (translation <= this.m_lowerTranslation) {
            C2 = b2Math.Clamp(translation - this.m_lowerTranslation + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
            linearError = this.m_lowerTranslation - translation;
            active = true;
         }
         else if (translation >= this.m_upperTranslation) {
            C2 = b2Math.Clamp(translation - this.m_upperTranslation + b2Settings.b2_linearSlop, 0.0, b2Settings.b2_maxLinearCorrection);
            linearError = translation - this.m_upperTranslation;
            active = true;
         }
      }
      this.m_perp = b2Math.MulMV(R1, this.m_localYAxis1);
      this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
      this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
      var impulse = new b2Vec2();
      var C1 = this.m_perp.x * dX + this.m_perp.y * dY;
      linearError = b2Math.Max(linearError, b2Math.Abs(C1));
      angularError = 0.0;
      if (active) {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
         this.m_K.Solve(impulse, (-C1), (-C2));
      }
      else {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         var k11 = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         var impulse1 = 0;
         if (k11 != 0.0) {
            impulse1 = ((-C1)) / k11;
         }
         else {
            impulse1 = 0.0;
         }
         impulse.x = impulse1;
         impulse.y = 0.0;
      }
      var PX = impulse.x * this.m_perp.x + impulse.y * this.m_axis.x;
      var PY = impulse.x * this.m_perp.y + impulse.y * this.m_axis.y;
      var L1 = impulse.x * this.m_s1 + impulse.y * this.m_a1;
      var L2 = impulse.x * this.m_s2 + impulse.y * this.m_a2;
      c1.x -= this.m_invMassA * PX;
      c1.y -= this.m_invMassA * PY;
      a1 -= this.m_invIA * L1;
      c2.x += this.m_invMassB * PX;
      c2.y += this.m_invMassB * PY;
      a2 += this.m_invIB * L2;
      bA.m_sweep.a = a1;
      bB.m_sweep.a = a2;
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return linearError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.inherit(b2LineJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2LineJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2LineJointDef.b2LineJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
      this.localAxisA = new b2Vec2();
   };
   b2LineJointDef.prototype.b2LineJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_lineJoint;
      this.localAxisA.Set(1.0, 0.0);
      this.enableLimit = false;
      this.lowerTranslation = 0.0;
      this.upperTranslation = 0.0;
      this.enableMotor = false;
      this.maxMotorForce = 0.0;
      this.motorSpeed = 0.0;
   }
   b2LineJointDef.prototype.Initialize = function (bA, bB, anchor, axis) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA = this.bodyA.GetLocalPoint(anchor);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchor);
      this.localAxisA = this.bodyA.GetLocalVector(axis);
   }
   Box2D.inherit(b2MouseJoint, Box2D.Dynamics.Joints.b2Joint);
   b2MouseJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2MouseJoint.b2MouseJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.K = new b2Mat22();
      this.K1 = new b2Mat22();
      this.K2 = new b2Mat22();
      this.m_localAnchor = new b2Vec2();
      this.m_target = new b2Vec2();
      this.m_impulse = new b2Vec2();
      this.m_mass = new b2Mat22();
      this.m_C = new b2Vec2();
   };
   b2MouseJoint.prototype.GetAnchorA = function () {
      return this.m_target;
   }
   b2MouseJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor);
   }
   b2MouseJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse.x, inv_dt * this.m_impulse.y);
   }
   b2MouseJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2MouseJoint.prototype.GetTarget = function () {
      return this.m_target;
   }
   b2MouseJoint.prototype.SetTarget = function (target) {
      if (this.m_bodyB.IsAwake() == false) {
         this.m_bodyB.SetAwake(true);
      }
      this.m_target = target;
   }
   b2MouseJoint.prototype.GetMaxForce = function () {
      return this.m_maxForce;
   }
   b2MouseJoint.prototype.SetMaxForce = function (maxForce) {
      if (maxForce === undefined) maxForce = 0;
      this.m_maxForce = maxForce;
   }
   b2MouseJoint.prototype.GetFrequency = function () {
      return this.m_frequencyHz;
   }
   b2MouseJoint.prototype.SetFrequency = function (hz) {
      if (hz === undefined) hz = 0;
      this.m_frequencyHz = hz;
   }
   b2MouseJoint.prototype.GetDampingRatio = function () {
      return this.m_dampingRatio;
   }
   b2MouseJoint.prototype.SetDampingRatio = function (ratio) {
      if (ratio === undefined) ratio = 0;
      this.m_dampingRatio = ratio;
   }
   b2MouseJoint.prototype.b2MouseJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_target.SetV(def.target);
      var tX = this.m_target.x - this.m_bodyB.m_xf.position.x;
      var tY = this.m_target.y - this.m_bodyB.m_xf.position.y;
      var tMat = this.m_bodyB.m_xf.R;
      this.m_localAnchor.x = (tX * tMat.col1.x + tY * tMat.col1.y);
      this.m_localAnchor.y = (tX * tMat.col2.x + tY * tMat.col2.y);
      this.m_maxForce = def.maxForce;
      this.m_impulse.SetZero();
      this.m_frequencyHz = def.frequencyHz;
      this.m_dampingRatio = def.dampingRatio;
      this.m_beta = 0.0;
      this.m_gamma = 0.0;
   }
   b2MouseJoint.prototype.InitVelocityConstraints = function (step) {
      var b = this.m_bodyB;
      var mass = b.GetMass();
      var omega = 2.0 * Math.PI * this.m_frequencyHz;
      var d = 2.0 * mass * this.m_dampingRatio * omega;
      var k = mass * omega * omega;
      this.m_gamma = step.dt * (d + step.dt * k);
      this.m_gamma = this.m_gamma != 0 ? 1 / this.m_gamma : 0.0;
      this.m_beta = step.dt * k * this.m_gamma;
      var tMat;tMat = b.m_xf.R;
      var rX = this.m_localAnchor.x - b.m_sweep.localCenter.x;
      var rY = this.m_localAnchor.y - b.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * rX + tMat.col2.x * rY);rY = (tMat.col1.y * rX + tMat.col2.y * rY);
      rX = tX;
      var invMass = b.m_invMass;
      var invI = b.m_invI;this.K1.col1.x = invMass;
      this.K1.col2.x = 0.0;
      this.K1.col1.y = 0.0;
      this.K1.col2.y = invMass;
      this.K2.col1.x = invI * rY * rY;
      this.K2.col2.x = (-invI * rX * rY);
      this.K2.col1.y = (-invI * rX * rY);
      this.K2.col2.y = invI * rX * rX;
      this.K.SetM(this.K1);
      this.K.AddM(this.K2);
      this.K.col1.x += this.m_gamma;
      this.K.col2.y += this.m_gamma;
      this.K.GetInverse(this.m_mass);
      this.m_C.x = b.m_sweep.c.x + rX - this.m_target.x;
      this.m_C.y = b.m_sweep.c.y + rY - this.m_target.y;
      b.m_angularVelocity *= 0.98;
      this.m_impulse.x *= step.dtRatio;
      this.m_impulse.y *= step.dtRatio;
      b.m_linearVelocity.x += invMass * this.m_impulse.x;
      b.m_linearVelocity.y += invMass * this.m_impulse.y;
      b.m_angularVelocity += invI * (rX * this.m_impulse.y - rY * this.m_impulse.x);
   }
   b2MouseJoint.prototype.SolveVelocityConstraints = function (step) {
      var b = this.m_bodyB;
      var tMat;
      var tX = 0;
      var tY = 0;
      tMat = b.m_xf.R;
      var rX = this.m_localAnchor.x - b.m_sweep.localCenter.x;
      var rY = this.m_localAnchor.y - b.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rX + tMat.col2.x * rY);
      rY = (tMat.col1.y * rX + tMat.col2.y * rY);
      rX = tX;
      var CdotX = b.m_linearVelocity.x + ((-b.m_angularVelocity * rY));
      var CdotY = b.m_linearVelocity.y + (b.m_angularVelocity * rX);
      tMat = this.m_mass;
      tX = CdotX + this.m_beta * this.m_C.x + this.m_gamma * this.m_impulse.x;
      tY = CdotY + this.m_beta * this.m_C.y + this.m_gamma * this.m_impulse.y;
      var impulseX = (-(tMat.col1.x * tX + tMat.col2.x * tY));
      var impulseY = (-(tMat.col1.y * tX + tMat.col2.y * tY));
      var oldImpulseX = this.m_impulse.x;
      var oldImpulseY = this.m_impulse.y;
      this.m_impulse.x += impulseX;
      this.m_impulse.y += impulseY;
      var maxImpulse = step.dt * this.m_maxForce;
      if (this.m_impulse.LengthSquared() > maxImpulse * maxImpulse) {
         this.m_impulse.Multiply(maxImpulse / this.m_impulse.Length());
      }
      impulseX = this.m_impulse.x - oldImpulseX;
      impulseY = this.m_impulse.y - oldImpulseY;
      b.m_linearVelocity.x += b.m_invMass * impulseX;
      b.m_linearVelocity.y += b.m_invMass * impulseY;
      b.m_angularVelocity += b.m_invI * (rX * impulseY - rY * impulseX);
   }
   b2MouseJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      return true;
   }
   Box2D.inherit(b2MouseJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2MouseJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2MouseJointDef.b2MouseJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.target = new b2Vec2();
   };
   b2MouseJointDef.prototype.b2MouseJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_mouseJoint;
      this.maxForce = 0.0;
      this.frequencyHz = 5.0;
      this.dampingRatio = 0.7;
   }
   Box2D.inherit(b2PrismaticJoint, Box2D.Dynamics.Joints.b2Joint);
   b2PrismaticJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2PrismaticJoint.b2PrismaticJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_localXAxis1 = new b2Vec2();
      this.m_localYAxis1 = new b2Vec2();
      this.m_axis = new b2Vec2();
      this.m_perp = new b2Vec2();
      this.m_K = new b2Mat33();
      this.m_impulse = new b2Vec3();
   };
   b2PrismaticJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2PrismaticJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2PrismaticJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * (this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x), inv_dt * (this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y));
   }
   b2PrismaticJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.y;
   }
   b2PrismaticJoint.prototype.GetJointTranslation = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var p1 = bA.GetWorldPoint(this.m_localAnchor1);
      var p2 = bB.GetWorldPoint(this.m_localAnchor2);
      var dX = p2.x - p1.x;
      var dY = p2.y - p1.y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var translation = axis.x * dX + axis.y * dY;
      return translation;
   }
   b2PrismaticJoint.prototype.GetJointSpeed = function () {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var p1X = bA.m_sweep.c.x + r1X;
      var p1Y = bA.m_sweep.c.y + r1Y;
      var p2X = bB.m_sweep.c.x + r2X;
      var p2Y = bB.m_sweep.c.y + r2Y;
      var dX = p2X - p1X;
      var dY = p2Y - p1Y;
      var axis = bA.GetWorldVector(this.m_localXAxis1);
      var v1 = bA.m_linearVelocity;
      var v2 = bB.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var w2 = bB.m_angularVelocity;
      var speed = (dX * ((-w1 * axis.y)) + dY * (w1 * axis.x)) + (axis.x * (((v2.x + ((-w2 * r2Y))) - v1.x) - ((-w1 * r1Y))) + axis.y * (((v2.y + (w2 * r2X)) - v1.y) - (w1 * r1X)));
      return speed;
   }
   b2PrismaticJoint.prototype.IsLimitEnabled = function () {
      return this.m_enableLimit;
   }
   b2PrismaticJoint.prototype.EnableLimit = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableLimit = flag;
   }
   b2PrismaticJoint.prototype.GetLowerLimit = function () {
      return this.m_lowerTranslation;
   }
   b2PrismaticJoint.prototype.GetUpperLimit = function () {
      return this.m_upperTranslation;
   }
   b2PrismaticJoint.prototype.SetLimits = function (lower, upper) {
      if (lower === undefined) lower = 0;
      if (upper === undefined) upper = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_lowerTranslation = lower;
      this.m_upperTranslation = upper;
   }
   b2PrismaticJoint.prototype.IsMotorEnabled = function () {
      return this.m_enableMotor;
   }
   b2PrismaticJoint.prototype.EnableMotor = function (flag) {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_enableMotor = flag;
   }
   b2PrismaticJoint.prototype.SetMotorSpeed = function (speed) {
      if (speed === undefined) speed = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_motorSpeed = speed;
   }
   b2PrismaticJoint.prototype.GetMotorSpeed = function () {
      return this.m_motorSpeed;
   }
   b2PrismaticJoint.prototype.SetMaxMotorForce = function (force) {
      if (force === undefined) force = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_maxMotorForce = force;
   }
   b2PrismaticJoint.prototype.GetMotorForce = function () {
      return this.m_motorImpulse;
   }
   b2PrismaticJoint.prototype.b2PrismaticJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_localXAxis1.SetV(def.localAxisA);
      this.m_localYAxis1.x = (-this.m_localXAxis1.y);
      this.m_localYAxis1.y = this.m_localXAxis1.x;
      this.m_refAngle = def.referenceAngle;
      this.m_impulse.SetZero();
      this.m_motorMass = 0.0;
      this.m_motorImpulse = 0.0;
      this.m_lowerTranslation = def.lowerTranslation;
      this.m_upperTranslation = def.upperTranslation;
      this.m_maxMotorForce = def.maxMotorForce;
      this.m_motorSpeed = def.motorSpeed;
      this.m_enableLimit = def.enableLimit;
      this.m_enableMotor = def.enableMotor;
      this.m_limitState = b2Joint.e_inactiveLimit;
      this.m_axis.SetZero();
      this.m_perp.SetZero();
   }
   b2PrismaticJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      this.m_localCenterA.SetV(bA.GetLocalCenter());
      this.m_localCenterB.SetV(bB.GetLocalCenter());
      var xf1 = bA.GetTransform();
      var xf2 = bB.GetTransform();
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
      var dY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
      this.m_invMassA = bA.m_invMass;
      this.m_invMassB = bB.m_invMass;
      this.m_invIA = bA.m_invI;
      this.m_invIB = bB.m_invI; {
         this.m_axis.SetV(b2Math.MulMV(xf1.R, this.m_localXAxis1));
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         this.m_motorMass = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_a1 * this.m_a1 + this.m_invIB * this.m_a2 * this.m_a2;
         if (this.m_motorMass > Number.MIN_VALUE) this.m_motorMass = 1.0 / this.m_motorMass;
      } {
         this.m_perp.SetV(b2Math.MulMV(xf1.R, this.m_localYAxis1));
         this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
         this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
         var m1 = this.m_invMassA;
         var m2 = this.m_invMassB;
         var i1 = this.m_invIA;
         var i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 + i2 * this.m_s2;
         this.m_K.col1.z = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = i1 + i2;
         this.m_K.col2.z = i1 * this.m_a1 + i2 * this.m_a2;
         this.m_K.col3.x = this.m_K.col1.z;
         this.m_K.col3.y = this.m_K.col2.z;
         this.m_K.col3.z = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
      }
      if (this.m_enableLimit) {
         var jointTransition = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            this.m_limitState = b2Joint.e_equalLimits;
         }
         else if (jointTransition <= this.m_lowerTranslation) {
            if (this.m_limitState != b2Joint.e_atLowerLimit) {
               this.m_limitState = b2Joint.e_atLowerLimit;
               this.m_impulse.z = 0.0;
            }
         }
         else if (jointTransition >= this.m_upperTranslation) {
            if (this.m_limitState != b2Joint.e_atUpperLimit) {
               this.m_limitState = b2Joint.e_atUpperLimit;
               this.m_impulse.z = 0.0;
            }
         }
         else {
            this.m_limitState = b2Joint.e_inactiveLimit;
            this.m_impulse.z = 0.0;
         }
      }
      else {
         this.m_limitState = b2Joint.e_inactiveLimit;
      }
      if (this.m_enableMotor == false) {
         this.m_motorImpulse = 0.0;
      }
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_motorImpulse *= step.dtRatio;
         var PX = this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x;
         var PY = this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y;
         var L1 = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1;
         var L2 = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;
         bA.m_linearVelocity.x -= this.m_invMassA * PX;
         bA.m_linearVelocity.y -= this.m_invMassA * PY;
         bA.m_angularVelocity -= this.m_invIA * L1;
         bB.m_linearVelocity.x += this.m_invMassB * PX;
         bB.m_linearVelocity.y += this.m_invMassB * PY;
         bB.m_angularVelocity += this.m_invIB * L2;
      }
      else {
         this.m_impulse.SetZero();
         this.m_motorImpulse = 0.0;
      }
   }
   b2PrismaticJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var v1 = bA.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var v2 = bB.m_linearVelocity;
      var w2 = bB.m_angularVelocity;
      var PX = 0;
      var PY = 0;
      var L1 = 0;
      var L2 = 0;
      if (this.m_enableMotor && this.m_limitState != b2Joint.e_equalLimits) {
         var Cdot = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var impulse = this.m_motorMass * (this.m_motorSpeed - Cdot);
         var oldImpulse = this.m_motorImpulse;
         var maxImpulse = step.dt * this.m_maxMotorForce;
         this.m_motorImpulse = b2Math.Clamp(this.m_motorImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_motorImpulse - oldImpulse;
         PX = impulse * this.m_axis.x;
         PY = impulse * this.m_axis.y;
         L1 = impulse * this.m_a1;
         L2 = impulse * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      var Cdot1X = this.m_perp.x * (v2.x - v1.x) + this.m_perp.y * (v2.y - v1.y) + this.m_s2 * w2 - this.m_s1 * w1;
      var Cdot1Y = w2 - w1;
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         var Cdot2 = this.m_axis.x * (v2.x - v1.x) + this.m_axis.y * (v2.y - v1.y) + this.m_a2 * w2 - this.m_a1 * w1;
         var f1 = this.m_impulse.Copy();
         var df = this.m_K.Solve33(new b2Vec3(), (-Cdot1X), (-Cdot1Y), (-Cdot2));
         this.m_impulse.Add(df);
         if (this.m_limitState == b2Joint.e_atLowerLimit) {
            this.m_impulse.z = b2Math.Max(this.m_impulse.z, 0.0);
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            this.m_impulse.z = b2Math.Min(this.m_impulse.z, 0.0);
         }
         var bX = (-Cdot1X) - (this.m_impulse.z - f1.z) * this.m_K.col3.x;
         var bY = (-Cdot1Y) - (this.m_impulse.z - f1.z) * this.m_K.col3.y;
         var f2r = this.m_K.Solve22(new b2Vec2(), bX, bY);
         f2r.x += f1.x;
         f2r.y += f1.y;
         this.m_impulse.x = f2r.x;
         this.m_impulse.y = f2r.y;
         df.x = this.m_impulse.x - f1.x;
         df.y = this.m_impulse.y - f1.y;
         df.z = this.m_impulse.z - f1.z;
         PX = df.x * this.m_perp.x + df.z * this.m_axis.x;
         PY = df.x * this.m_perp.y + df.z * this.m_axis.y;
         L1 = df.x * this.m_s1 + df.y + df.z * this.m_a1;
         L2 = df.x * this.m_s2 + df.y + df.z * this.m_a2;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      else {
         var df2 = this.m_K.Solve22(new b2Vec2(), (-Cdot1X), (-Cdot1Y));
         this.m_impulse.x += df2.x;
         this.m_impulse.y += df2.y;
         PX = df2.x * this.m_perp.x;
         PY = df2.x * this.m_perp.y;
         L1 = df2.x * this.m_s1 + df2.y;
         L2 = df2.x * this.m_s2 + df2.y;
         v1.x -= this.m_invMassA * PX;
         v1.y -= this.m_invMassA * PY;
         w1 -= this.m_invIA * L1;
         v2.x += this.m_invMassB * PX;
         v2.y += this.m_invMassB * PY;
         w2 += this.m_invIB * L2;
      }
      bA.m_linearVelocity.SetV(v1);
      bA.m_angularVelocity = w1;
      bB.m_linearVelocity.SetV(v2);
      bB.m_angularVelocity = w2;
   }
   b2PrismaticJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var limitC = 0;
      var oldLimitImpulse = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var c1 = bA.m_sweep.c;
      var a1 = bA.m_sweep.a;
      var c2 = bB.m_sweep.c;
      var a2 = bB.m_sweep.a;
      var tMat;
      var tX = 0;
      var m1 = 0;
      var m2 = 0;
      var i1 = 0;
      var i2 = 0;
      var linearError = 0.0;
      var angularError = 0.0;
      var active = false;
      var C2 = 0.0;
      var R1 = b2Mat22.FromAngle(a1);
      var R2 = b2Mat22.FromAngle(a2);
      tMat = R1;
      var r1X = this.m_localAnchor1.x - this.m_localCenterA.x;
      var r1Y = this.m_localAnchor1.y - this.m_localCenterA.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = R2;
      var r2X = this.m_localAnchor2.x - this.m_localCenterB.x;
      var r2Y = this.m_localAnchor2.y - this.m_localCenterB.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var dX = c2.x + r2X - c1.x - r1X;
      var dY = c2.y + r2Y - c1.y - r1Y;
      if (this.m_enableLimit) {
         this.m_axis = b2Math.MulMV(R1, this.m_localXAxis1);
         this.m_a1 = (dX + r1X) * this.m_axis.y - (dY + r1Y) * this.m_axis.x;
         this.m_a2 = r2X * this.m_axis.y - r2Y * this.m_axis.x;
         var translation = this.m_axis.x * dX + this.m_axis.y * dY;
         if (b2Math.Abs(this.m_upperTranslation - this.m_lowerTranslation) < 2.0 * b2Settings.b2_linearSlop) {
            C2 = b2Math.Clamp(translation, (-b2Settings.b2_maxLinearCorrection), b2Settings.b2_maxLinearCorrection);
            linearError = b2Math.Abs(translation);
            active = true;
         }
         else if (translation <= this.m_lowerTranslation) {
            C2 = b2Math.Clamp(translation - this.m_lowerTranslation + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
            linearError = this.m_lowerTranslation - translation;
            active = true;
         }
         else if (translation >= this.m_upperTranslation) {
            C2 = b2Math.Clamp(translation - this.m_upperTranslation + b2Settings.b2_linearSlop, 0.0, b2Settings.b2_maxLinearCorrection);
            linearError = translation - this.m_upperTranslation;
            active = true;
         }
      }
      this.m_perp = b2Math.MulMV(R1, this.m_localYAxis1);
      this.m_s1 = (dX + r1X) * this.m_perp.y - (dY + r1Y) * this.m_perp.x;
      this.m_s2 = r2X * this.m_perp.y - r2Y * this.m_perp.x;
      var impulse = new b2Vec3();
      var C1X = this.m_perp.x * dX + this.m_perp.y * dY;
      var C1Y = a2 - a1 - this.m_refAngle;
      linearError = b2Math.Max(linearError, b2Math.Abs(C1X));
      angularError = b2Math.Abs(C1Y);
      if (active) {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         this.m_K.col1.x = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         this.m_K.col1.y = i1 * this.m_s1 + i2 * this.m_s2;
         this.m_K.col1.z = i1 * this.m_s1 * this.m_a1 + i2 * this.m_s2 * this.m_a2;
         this.m_K.col2.x = this.m_K.col1.y;
         this.m_K.col2.y = i1 + i2;
         this.m_K.col2.z = i1 * this.m_a1 + i2 * this.m_a2;
         this.m_K.col3.x = this.m_K.col1.z;
         this.m_K.col3.y = this.m_K.col2.z;
         this.m_K.col3.z = m1 + m2 + i1 * this.m_a1 * this.m_a1 + i2 * this.m_a2 * this.m_a2;
         this.m_K.Solve33(impulse, (-C1X), (-C1Y), (-C2));
      }
      else {
         m1 = this.m_invMassA;
         m2 = this.m_invMassB;
         i1 = this.m_invIA;
         i2 = this.m_invIB;
         var k11 = m1 + m2 + i1 * this.m_s1 * this.m_s1 + i2 * this.m_s2 * this.m_s2;
         var k12 = i1 * this.m_s1 + i2 * this.m_s2;
         var k22 = i1 + i2;
         this.m_K.col1.Set(k11, k12, 0.0);
         this.m_K.col2.Set(k12, k22, 0.0);
         var impulse1 = this.m_K.Solve22(new b2Vec2(), (-C1X), (-C1Y));
         impulse.x = impulse1.x;
         impulse.y = impulse1.y;
         impulse.z = 0.0;
      }
      var PX = impulse.x * this.m_perp.x + impulse.z * this.m_axis.x;
      var PY = impulse.x * this.m_perp.y + impulse.z * this.m_axis.y;
      var L1 = impulse.x * this.m_s1 + impulse.y + impulse.z * this.m_a1;
      var L2 = impulse.x * this.m_s2 + impulse.y + impulse.z * this.m_a2;
      c1.x -= this.m_invMassA * PX;
      c1.y -= this.m_invMassA * PY;
      a1 -= this.m_invIA * L1;
      c2.x += this.m_invMassB * PX;
      c2.y += this.m_invMassB * PY;
      a2 += this.m_invIB * L2;
      bA.m_sweep.a = a1;
      bB.m_sweep.a = a2;
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return linearError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.inherit(b2PrismaticJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2PrismaticJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2PrismaticJointDef.b2PrismaticJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
      this.localAxisA = new b2Vec2();
   };
   b2PrismaticJointDef.prototype.b2PrismaticJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_prismaticJoint;
      this.localAxisA.Set(1.0, 0.0);
      this.referenceAngle = 0.0;
      this.enableLimit = false;
      this.lowerTranslation = 0.0;
      this.upperTranslation = 0.0;
      this.enableMotor = false;
      this.maxMotorForce = 0.0;
      this.motorSpeed = 0.0;
   }
   b2PrismaticJointDef.prototype.Initialize = function (bA, bB, anchor, axis) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA = this.bodyA.GetLocalPoint(anchor);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchor);
      this.localAxisA = this.bodyA.GetLocalVector(axis);
      this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
   }
   Box2D.inherit(b2PulleyJoint, Box2D.Dynamics.Joints.b2Joint);
   b2PulleyJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2PulleyJoint.b2PulleyJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_groundAnchor1 = new b2Vec2();
      this.m_groundAnchor2 = new b2Vec2();
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_u1 = new b2Vec2();
      this.m_u2 = new b2Vec2();
   };
   b2PulleyJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2PulleyJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2PulleyJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse * this.m_u2.x, inv_dt * this.m_impulse * this.m_u2.y);
   }
   b2PulleyJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return 0.0;
   }
   b2PulleyJoint.prototype.GetGroundAnchorA = function () {
      var a = this.m_ground.m_xf.position.Copy();
      a.Add(this.m_groundAnchor1);
      return a;
   }
   b2PulleyJoint.prototype.GetGroundAnchorB = function () {
      var a = this.m_ground.m_xf.position.Copy();
      a.Add(this.m_groundAnchor2);
      return a;
   }
   b2PulleyJoint.prototype.GetLength1 = function () {
      var p = this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
      var sX = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x;
      var sY = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y;
      var dX = p.x - sX;
      var dY = p.y - sY;
      return Math.sqrt(dX * dX + dY * dY);
   }
   b2PulleyJoint.prototype.GetLength2 = function () {
      var p = this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
      var sX = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x;
      var sY = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
      var dX = p.x - sX;
      var dY = p.y - sY;
      return Math.sqrt(dX * dX + dY * dY);
   }
   b2PulleyJoint.prototype.GetRatio = function () {
      return this.m_ratio;
   }
   b2PulleyJoint.prototype.b2PulleyJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      var tMat;
      var tX = 0;
      var tY = 0;
      this.m_ground = this.m_bodyA.m_world.m_groundBody;
      this.m_groundAnchor1.x = def.groundAnchorA.x - this.m_ground.m_xf.position.x;
      this.m_groundAnchor1.y = def.groundAnchorA.y - this.m_ground.m_xf.position.y;
      this.m_groundAnchor2.x = def.groundAnchorB.x - this.m_ground.m_xf.position.x;
      this.m_groundAnchor2.y = def.groundAnchorB.y - this.m_ground.m_xf.position.y;
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_ratio = def.ratio;
      this.m_constant = def.lengthA + this.m_ratio * def.lengthB;
      this.m_maxLength1 = b2Math.Min(def.maxLengthA, this.m_constant - this.m_ratio * b2PulleyJoint.b2_minPulleyLength);
      this.m_maxLength2 = b2Math.Min(def.maxLengthB, (this.m_constant - b2PulleyJoint.b2_minPulleyLength) / this.m_ratio);
      this.m_impulse = 0.0;
      this.m_limitImpulse1 = 0.0;
      this.m_limitImpulse2 = 0.0;
   }
   b2PulleyJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var p1X = bA.m_sweep.c.x + r1X;
      var p1Y = bA.m_sweep.c.y + r1Y;
      var p2X = bB.m_sweep.c.x + r2X;
      var p2Y = bB.m_sweep.c.y + r2Y;
      var s1X = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x;
      var s1Y = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y;
      var s2X = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x;
      var s2Y = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
      this.m_u1.Set(p1X - s1X, p1Y - s1Y);
      this.m_u2.Set(p2X - s2X, p2Y - s2Y);
      var length1 = this.m_u1.Length();
      var length2 = this.m_u2.Length();
      if (length1 > b2Settings.b2_linearSlop) {
         this.m_u1.Multiply(1.0 / length1);
      }
      else {
         this.m_u1.SetZero();
      }
      if (length2 > b2Settings.b2_linearSlop) {
         this.m_u2.Multiply(1.0 / length2);
      }
      else {
         this.m_u2.SetZero();
      }
      var C = this.m_constant - length1 - this.m_ratio * length2;
      if (C > 0.0) {
         this.m_state = b2Joint.e_inactiveLimit;
         this.m_impulse = 0.0;
      }
      else {
         this.m_state = b2Joint.e_atUpperLimit;
      }
      if (length1 < this.m_maxLength1) {
         this.m_limitState1 = b2Joint.e_inactiveLimit;
         this.m_limitImpulse1 = 0.0;
      }
      else {
         this.m_limitState1 = b2Joint.e_atUpperLimit;
      }
      if (length2 < this.m_maxLength2) {
         this.m_limitState2 = b2Joint.e_inactiveLimit;
         this.m_limitImpulse2 = 0.0;
      }
      else {
         this.m_limitState2 = b2Joint.e_atUpperLimit;
      }
      var cr1u1 = r1X * this.m_u1.y - r1Y * this.m_u1.x;
      var cr2u2 = r2X * this.m_u2.y - r2Y * this.m_u2.x;
      this.m_limitMass1 = bA.m_invMass + bA.m_invI * cr1u1 * cr1u1;
      this.m_limitMass2 = bB.m_invMass + bB.m_invI * cr2u2 * cr2u2;
      this.m_pulleyMass = this.m_limitMass1 + this.m_ratio * this.m_ratio * this.m_limitMass2;
      this.m_limitMass1 = 1.0 / this.m_limitMass1;
      this.m_limitMass2 = 1.0 / this.m_limitMass2;
      this.m_pulleyMass = 1.0 / this.m_pulleyMass;
      if (step.warmStarting) {
         this.m_impulse *= step.dtRatio;
         this.m_limitImpulse1 *= step.dtRatio;
         this.m_limitImpulse2 *= step.dtRatio;
         var P1X = ((-this.m_impulse) - this.m_limitImpulse1) * this.m_u1.x;
         var P1Y = ((-this.m_impulse) - this.m_limitImpulse1) * this.m_u1.y;
         var P2X = ((-this.m_ratio * this.m_impulse) - this.m_limitImpulse2) * this.m_u2.x;
         var P2Y = ((-this.m_ratio * this.m_impulse) - this.m_limitImpulse2) * this.m_u2.y;
         bA.m_linearVelocity.x += bA.m_invMass * P1X;
         bA.m_linearVelocity.y += bA.m_invMass * P1Y;
         bA.m_angularVelocity += bA.m_invI * (r1X * P1Y - r1Y * P1X);
         bB.m_linearVelocity.x += bB.m_invMass * P2X;
         bB.m_linearVelocity.y += bB.m_invMass * P2Y;
         bB.m_angularVelocity += bB.m_invI * (r2X * P2Y - r2Y * P2X);
      }
      else {
         this.m_impulse = 0.0;
         this.m_limitImpulse1 = 0.0;
         this.m_limitImpulse2 = 0.0;
      }
   }
   b2PulleyJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      var tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var v1X = 0;
      var v1Y = 0;
      var v2X = 0;
      var v2Y = 0;
      var P1X = 0;
      var P1Y = 0;
      var P2X = 0;
      var P2Y = 0;
      var Cdot = 0;
      var impulse = 0;
      var oldImpulse = 0;
      if (this.m_state == b2Joint.e_atUpperLimit) {
         v1X = bA.m_linearVelocity.x + ((-bA.m_angularVelocity * r1Y));
         v1Y = bA.m_linearVelocity.y + (bA.m_angularVelocity * r1X);
         v2X = bB.m_linearVelocity.x + ((-bB.m_angularVelocity * r2Y));
         v2Y = bB.m_linearVelocity.y + (bB.m_angularVelocity * r2X);
         Cdot = (-(this.m_u1.x * v1X + this.m_u1.y * v1Y)) - this.m_ratio * (this.m_u2.x * v2X + this.m_u2.y * v2Y);
         impulse = this.m_pulleyMass * ((-Cdot));
         oldImpulse = this.m_impulse;
         this.m_impulse = b2Math.Max(0.0, this.m_impulse + impulse);
         impulse = this.m_impulse - oldImpulse;
         P1X = (-impulse * this.m_u1.x);
         P1Y = (-impulse * this.m_u1.y);
         P2X = (-this.m_ratio * impulse * this.m_u2.x);
         P2Y = (-this.m_ratio * impulse * this.m_u2.y);
         bA.m_linearVelocity.x += bA.m_invMass * P1X;
         bA.m_linearVelocity.y += bA.m_invMass * P1Y;
         bA.m_angularVelocity += bA.m_invI * (r1X * P1Y - r1Y * P1X);
         bB.m_linearVelocity.x += bB.m_invMass * P2X;
         bB.m_linearVelocity.y += bB.m_invMass * P2Y;
         bB.m_angularVelocity += bB.m_invI * (r2X * P2Y - r2Y * P2X);
      }
      if (this.m_limitState1 == b2Joint.e_atUpperLimit) {
         v1X = bA.m_linearVelocity.x + ((-bA.m_angularVelocity * r1Y));
         v1Y = bA.m_linearVelocity.y + (bA.m_angularVelocity * r1X);
         Cdot = (-(this.m_u1.x * v1X + this.m_u1.y * v1Y));
         impulse = (-this.m_limitMass1 * Cdot);
         oldImpulse = this.m_limitImpulse1;
         this.m_limitImpulse1 = b2Math.Max(0.0, this.m_limitImpulse1 + impulse);
         impulse = this.m_limitImpulse1 - oldImpulse;
         P1X = (-impulse * this.m_u1.x);
         P1Y = (-impulse * this.m_u1.y);
         bA.m_linearVelocity.x += bA.m_invMass * P1X;
         bA.m_linearVelocity.y += bA.m_invMass * P1Y;
         bA.m_angularVelocity += bA.m_invI * (r1X * P1Y - r1Y * P1X);
      }
      if (this.m_limitState2 == b2Joint.e_atUpperLimit) {
         v2X = bB.m_linearVelocity.x + ((-bB.m_angularVelocity * r2Y));
         v2Y = bB.m_linearVelocity.y + (bB.m_angularVelocity * r2X);
         Cdot = (-(this.m_u2.x * v2X + this.m_u2.y * v2Y));
         impulse = (-this.m_limitMass2 * Cdot);
         oldImpulse = this.m_limitImpulse2;
         this.m_limitImpulse2 = b2Math.Max(0.0, this.m_limitImpulse2 + impulse);
         impulse = this.m_limitImpulse2 - oldImpulse;
         P2X = (-impulse * this.m_u2.x);
         P2Y = (-impulse * this.m_u2.y);
         bB.m_linearVelocity.x += bB.m_invMass * P2X;
         bB.m_linearVelocity.y += bB.m_invMass * P2Y;
         bB.m_angularVelocity += bB.m_invI * (r2X * P2Y - r2Y * P2X);
      }
   }
   b2PulleyJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var s1X = this.m_ground.m_xf.position.x + this.m_groundAnchor1.x;
      var s1Y = this.m_ground.m_xf.position.y + this.m_groundAnchor1.y;
      var s2X = this.m_ground.m_xf.position.x + this.m_groundAnchor2.x;
      var s2Y = this.m_ground.m_xf.position.y + this.m_groundAnchor2.y;
      var r1X = 0;
      var r1Y = 0;
      var r2X = 0;
      var r2Y = 0;
      var p1X = 0;
      var p1Y = 0;
      var p2X = 0;
      var p2Y = 0;
      var length1 = 0;
      var length2 = 0;
      var C = 0;
      var impulse = 0;
      var oldImpulse = 0;
      var oldLimitPositionImpulse = 0;
      var tX = 0;
      var linearError = 0.0;
      if (this.m_state == b2Joint.e_atUpperLimit) {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         p1X = bA.m_sweep.c.x + r1X;
         p1Y = bA.m_sweep.c.y + r1Y;
         p2X = bB.m_sweep.c.x + r2X;
         p2Y = bB.m_sweep.c.y + r2Y;
         this.m_u1.Set(p1X - s1X, p1Y - s1Y);
         this.m_u2.Set(p2X - s2X, p2Y - s2Y);
         length1 = this.m_u1.Length();
         length2 = this.m_u2.Length();
         if (length1 > b2Settings.b2_linearSlop) {
            this.m_u1.Multiply(1.0 / length1);
         }
         else {
            this.m_u1.SetZero();
         }
         if (length2 > b2Settings.b2_linearSlop) {
            this.m_u2.Multiply(1.0 / length2);
         }
         else {
            this.m_u2.SetZero();
         }
         C = this.m_constant - length1 - this.m_ratio * length2;
         linearError = b2Math.Max(linearError, (-C));
         C = b2Math.Clamp(C + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
         impulse = (-this.m_pulleyMass * C);
         p1X = (-impulse * this.m_u1.x);
         p1Y = (-impulse * this.m_u1.y);
         p2X = (-this.m_ratio * impulse * this.m_u2.x);
         p2Y = (-this.m_ratio * impulse * this.m_u2.y);
         bA.m_sweep.c.x += bA.m_invMass * p1X;
         bA.m_sweep.c.y += bA.m_invMass * p1Y;
         bA.m_sweep.a += bA.m_invI * (r1X * p1Y - r1Y * p1X);
         bB.m_sweep.c.x += bB.m_invMass * p2X;
         bB.m_sweep.c.y += bB.m_invMass * p2Y;
         bB.m_sweep.a += bB.m_invI * (r2X * p2Y - r2Y * p2X);
         bA.SynchronizeTransform();
         bB.SynchronizeTransform();
      }
      if (this.m_limitState1 == b2Joint.e_atUpperLimit) {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         p1X = bA.m_sweep.c.x + r1X;
         p1Y = bA.m_sweep.c.y + r1Y;
         this.m_u1.Set(p1X - s1X, p1Y - s1Y);
         length1 = this.m_u1.Length();
         if (length1 > b2Settings.b2_linearSlop) {
            this.m_u1.x *= 1.0 / length1;
            this.m_u1.y *= 1.0 / length1;
         }
         else {
            this.m_u1.SetZero();
         }
         C = this.m_maxLength1 - length1;
         linearError = b2Math.Max(linearError, (-C));
         C = b2Math.Clamp(C + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
         impulse = (-this.m_limitMass1 * C);
         p1X = (-impulse * this.m_u1.x);
         p1Y = (-impulse * this.m_u1.y);
         bA.m_sweep.c.x += bA.m_invMass * p1X;
         bA.m_sweep.c.y += bA.m_invMass * p1Y;
         bA.m_sweep.a += bA.m_invI * (r1X * p1Y - r1Y * p1X);
         bA.SynchronizeTransform();
      }
      if (this.m_limitState2 == b2Joint.e_atUpperLimit) {
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         p2X = bB.m_sweep.c.x + r2X;
         p2Y = bB.m_sweep.c.y + r2Y;
         this.m_u2.Set(p2X - s2X, p2Y - s2Y);
         length2 = this.m_u2.Length();
         if (length2 > b2Settings.b2_linearSlop) {
            this.m_u2.x *= 1.0 / length2;
            this.m_u2.y *= 1.0 / length2;
         }
         else {
            this.m_u2.SetZero();
         }
         C = this.m_maxLength2 - length2;
         linearError = b2Math.Max(linearError, (-C));
         C = b2Math.Clamp(C + b2Settings.b2_linearSlop, (-b2Settings.b2_maxLinearCorrection), 0.0);
         impulse = (-this.m_limitMass2 * C);
         p2X = (-impulse * this.m_u2.x);
         p2Y = (-impulse * this.m_u2.y);
         bB.m_sweep.c.x += bB.m_invMass * p2X;
         bB.m_sweep.c.y += bB.m_invMass * p2Y;
         bB.m_sweep.a += bB.m_invI * (r2X * p2Y - r2Y * p2X);
         bB.SynchronizeTransform();
      }
      return linearError < b2Settings.b2_linearSlop;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength = 2.0;
   });
   Box2D.inherit(b2PulleyJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2PulleyJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2PulleyJointDef.b2PulleyJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.groundAnchorA = new b2Vec2();
      this.groundAnchorB = new b2Vec2();
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2PulleyJointDef.prototype.b2PulleyJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_pulleyJoint;
      this.groundAnchorA.Set((-1.0), 1.0);
      this.groundAnchorB.Set(1.0, 1.0);
      this.localAnchorA.Set((-1.0), 0.0);
      this.localAnchorB.Set(1.0, 0.0);
      this.lengthA = 0.0;
      this.maxLengthA = 0.0;
      this.lengthB = 0.0;
      this.maxLengthB = 0.0;
      this.ratio = 1.0;
      this.collideConnected = true;
   }
   b2PulleyJointDef.prototype.Initialize = function (bA, bB, gaA, gaB, anchorA, anchorB, r) {
      if (r === undefined) r = 0;
      this.bodyA = bA;
      this.bodyB = bB;
      this.groundAnchorA.SetV(gaA);
      this.groundAnchorB.SetV(gaB);
      this.localAnchorA = this.bodyA.GetLocalPoint(anchorA);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchorB);
      var d1X = anchorA.x - gaA.x;
      var d1Y = anchorA.y - gaA.y;
      this.lengthA = Math.sqrt(d1X * d1X + d1Y * d1Y);
      var d2X = anchorB.x - gaB.x;
      var d2Y = anchorB.y - gaB.y;
      this.lengthB = Math.sqrt(d2X * d2X + d2Y * d2Y);
      this.ratio = r;
      var C = this.lengthA + this.ratio * this.lengthB;
      this.maxLengthA = C - this.ratio * b2PulleyJoint.b2_minPulleyLength;
      this.maxLengthB = (C - b2PulleyJoint.b2_minPulleyLength) / this.ratio;
   }
   Box2D.inherit(b2RevoluteJoint, Box2D.Dynamics.Joints.b2Joint);
   b2RevoluteJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2RevoluteJoint.b2RevoluteJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.K = new b2Mat22();
      this.K1 = new b2Mat22();
      this.K2 = new b2Mat22();
      this.K3 = new b2Mat22();
      this.impulse3 = new b2Vec3();
      this.impulse2 = new b2Vec2();
      this.reduced = new b2Vec2();
      this.m_localAnchor1 = new b2Vec2();
      this.m_localAnchor2 = new b2Vec2();
      this.m_impulse = new b2Vec3();
      this.m_mass = new b2Mat33();
   };
   b2RevoluteJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchor1);
   }
   b2RevoluteJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchor2);
   }
   b2RevoluteJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse.x, inv_dt * this.m_impulse.y);
   }
   b2RevoluteJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.z;
   }
   b2RevoluteJoint.prototype.GetJointAngle = function () {
      return this.m_bodyB.m_sweep.a - this.m_bodyA.m_sweep.a - this.m_referenceAngle;
   }
   b2RevoluteJoint.prototype.GetJointSpeed = function () {
      return this.m_bodyB.m_angularVelocity - this.m_bodyA.m_angularVelocity;
   }
   b2RevoluteJoint.prototype.IsLimitEnabled = function () {
      return this.m_enableLimit;
   }
   b2RevoluteJoint.prototype.EnableLimit = function (flag) {
      this.m_enableLimit = flag;
   }
   b2RevoluteJoint.prototype.GetLowerLimit = function () {
      return this.m_lowerAngle;
   }
   b2RevoluteJoint.prototype.GetUpperLimit = function () {
      return this.m_upperAngle;
   }
   b2RevoluteJoint.prototype.SetLimits = function (lower, upper) {
      if (lower === undefined) lower = 0;
      if (upper === undefined) upper = 0;
      this.m_lowerAngle = lower;
      this.m_upperAngle = upper;
   }
   b2RevoluteJoint.prototype.IsMotorEnabled = function () {
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      return this.m_enableMotor;
   }
   b2RevoluteJoint.prototype.EnableMotor = function (flag) {
      this.m_enableMotor = flag;
   }
   b2RevoluteJoint.prototype.SetMotorSpeed = function (speed) {
      if (speed === undefined) speed = 0;
      this.m_bodyA.SetAwake(true);
      this.m_bodyB.SetAwake(true);
      this.m_motorSpeed = speed;
   }
   b2RevoluteJoint.prototype.GetMotorSpeed = function () {
      return this.m_motorSpeed;
   }
   b2RevoluteJoint.prototype.SetMaxMotorTorque = function (torque) {
      if (torque === undefined) torque = 0;
      this.m_maxMotorTorque = torque;
   }
   b2RevoluteJoint.prototype.GetMotorTorque = function () {
      return this.m_maxMotorTorque;
   }
   b2RevoluteJoint.prototype.b2RevoluteJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_localAnchor1.SetV(def.localAnchorA);
      this.m_localAnchor2.SetV(def.localAnchorB);
      this.m_referenceAngle = def.referenceAngle;
      this.m_impulse.SetZero();
      this.m_motorImpulse = 0.0;
      this.m_lowerAngle = def.lowerAngle;
      this.m_upperAngle = def.upperAngle;
      this.m_maxMotorTorque = def.maxMotorTorque;
      this.m_motorSpeed = def.motorSpeed;
      this.m_enableLimit = def.enableLimit;
      this.m_enableMotor = def.enableMotor;
      this.m_limitState = b2Joint.e_inactiveLimit;
   }
   b2RevoluteJoint.prototype.InitVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      if (this.m_enableMotor || this.m_enableLimit) {}
      tMat = bA.m_xf.R;
      var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
      var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
      r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
      r1X = tX;
      tMat = bB.m_xf.R;
      var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
      var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
      r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
      r2X = tX;
      var m1 = bA.m_invMass;
      var m2 = bB.m_invMass;
      var i1 = bA.m_invI;
      var i2 = bB.m_invI;
      this.m_mass.col1.x = m1 + m2 + r1Y * r1Y * i1 + r2Y * r2Y * i2;
      this.m_mass.col2.x = (-r1Y * r1X * i1) - r2Y * r2X * i2;
      this.m_mass.col3.x = (-r1Y * i1) - r2Y * i2;
      this.m_mass.col1.y = this.m_mass.col2.x;
      this.m_mass.col2.y = m1 + m2 + r1X * r1X * i1 + r2X * r2X * i2;
      this.m_mass.col3.y = r1X * i1 + r2X * i2;
      this.m_mass.col1.z = this.m_mass.col3.x;
      this.m_mass.col2.z = this.m_mass.col3.y;
      this.m_mass.col3.z = i1 + i2;
      this.m_motorMass = 1.0 / (i1 + i2);
      if (this.m_enableMotor == false) {
         this.m_motorImpulse = 0.0;
      }
      if (this.m_enableLimit) {
         var jointAngle = bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
         if (b2Math.Abs(this.m_upperAngle - this.m_lowerAngle) < 2.0 * b2Settings.b2_angularSlop) {
            this.m_limitState = b2Joint.e_equalLimits;
         }
         else if (jointAngle <= this.m_lowerAngle) {
            if (this.m_limitState != b2Joint.e_atLowerLimit) {
               this.m_impulse.z = 0.0;
            }
            this.m_limitState = b2Joint.e_atLowerLimit;
         }
         else if (jointAngle >= this.m_upperAngle) {
            if (this.m_limitState != b2Joint.e_atUpperLimit) {
               this.m_impulse.z = 0.0;
            }
            this.m_limitState = b2Joint.e_atUpperLimit;
         }
         else {
            this.m_limitState = b2Joint.e_inactiveLimit;
            this.m_impulse.z = 0.0;
         }
      }
      else {
         this.m_limitState = b2Joint.e_inactiveLimit;
      }
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_motorImpulse *= step.dtRatio;
         var PX = this.m_impulse.x;
         var PY = this.m_impulse.y;
         bA.m_linearVelocity.x -= m1 * PX;
         bA.m_linearVelocity.y -= m1 * PY;
         bA.m_angularVelocity -= i1 * ((r1X * PY - r1Y * PX) + this.m_motorImpulse + this.m_impulse.z);
         bB.m_linearVelocity.x += m2 * PX;
         bB.m_linearVelocity.y += m2 * PY;
         bB.m_angularVelocity += i2 * ((r2X * PY - r2Y * PX) + this.m_motorImpulse + this.m_impulse.z);
      }
      else {
         this.m_impulse.SetZero();
         this.m_motorImpulse = 0.0;
      }
   }
   b2RevoluteJoint.prototype.SolveVelocityConstraints = function (step) {
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var tMat;
      var tX = 0;
      var newImpulse = 0;
      var r1X = 0;
      var r1Y = 0;
      var r2X = 0;
      var r2Y = 0;
      var v1 = bA.m_linearVelocity;
      var w1 = bA.m_angularVelocity;
      var v2 = bB.m_linearVelocity;
      var w2 = bB.m_angularVelocity;
      var m1 = bA.m_invMass;
      var m2 = bB.m_invMass;
      var i1 = bA.m_invI;
      var i2 = bB.m_invI;
      if (this.m_enableMotor && this.m_limitState != b2Joint.e_equalLimits) {
         var Cdot = w2 - w1 - this.m_motorSpeed;
         var impulse = this.m_motorMass * ((-Cdot));
         var oldImpulse = this.m_motorImpulse;
         var maxImpulse = step.dt * this.m_maxMotorTorque;
         this.m_motorImpulse = b2Math.Clamp(this.m_motorImpulse + impulse, (-maxImpulse), maxImpulse);
         impulse = this.m_motorImpulse - oldImpulse;
         w1 -= i1 * impulse;
         w2 += i2 * impulse;
      }
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         var Cdot1X = v2.x + ((-w2 * r2Y)) - v1.x - ((-w1 * r1Y));
         var Cdot1Y = v2.y + (w2 * r2X) - v1.y - (w1 * r1X);
         var Cdot2 = w2 - w1;
         this.m_mass.Solve33(this.impulse3, (-Cdot1X), (-Cdot1Y), (-Cdot2));
         if (this.m_limitState == b2Joint.e_equalLimits) {
            this.m_impulse.Add(this.impulse3);
         }
         else if (this.m_limitState == b2Joint.e_atLowerLimit) {
            newImpulse = this.m_impulse.z + this.impulse3.z;
            if (newImpulse < 0.0) {
               this.m_mass.Solve22(this.reduced, (-Cdot1X), (-Cdot1Y));
               this.impulse3.x = this.reduced.x;
               this.impulse3.y = this.reduced.y;
               this.impulse3.z = (-this.m_impulse.z);
               this.m_impulse.x += this.reduced.x;
               this.m_impulse.y += this.reduced.y;
               this.m_impulse.z = 0.0;
            }
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            newImpulse = this.m_impulse.z + this.impulse3.z;
            if (newImpulse > 0.0) {
               this.m_mass.Solve22(this.reduced, (-Cdot1X), (-Cdot1Y));
               this.impulse3.x = this.reduced.x;
               this.impulse3.y = this.reduced.y;
               this.impulse3.z = (-this.m_impulse.z);
               this.m_impulse.x += this.reduced.x;
               this.m_impulse.y += this.reduced.y;
               this.m_impulse.z = 0.0;
            }
         }
         v1.x -= m1 * this.impulse3.x;
         v1.y -= m1 * this.impulse3.y;
         w1 -= i1 * (r1X * this.impulse3.y - r1Y * this.impulse3.x + this.impulse3.z);
         v2.x += m2 * this.impulse3.x;
         v2.y += m2 * this.impulse3.y;
         w2 += i2 * (r2X * this.impulse3.y - r2Y * this.impulse3.x + this.impulse3.z);
      }
      else {
         tMat = bA.m_xf.R;
         r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         var CdotX = v2.x + ((-w2 * r2Y)) - v1.x - ((-w1 * r1Y));
         var CdotY = v2.y + (w2 * r2X) - v1.y - (w1 * r1X);
         this.m_mass.Solve22(this.impulse2, (-CdotX), (-CdotY));
         this.m_impulse.x += this.impulse2.x;
         this.m_impulse.y += this.impulse2.y;
         v1.x -= m1 * this.impulse2.x;
         v1.y -= m1 * this.impulse2.y;
         w1 -= i1 * (r1X * this.impulse2.y - r1Y * this.impulse2.x);
         v2.x += m2 * this.impulse2.x;
         v2.y += m2 * this.impulse2.y;
         w2 += i2 * (r2X * this.impulse2.y - r2Y * this.impulse2.x);
      }
      bA.m_linearVelocity.SetV(v1);
      bA.m_angularVelocity = w1;
      bB.m_linearVelocity.SetV(v2);
      bB.m_angularVelocity = w2;
   }
   b2RevoluteJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var oldLimitImpulse = 0;
      var C = 0;
      var tMat;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var angularError = 0.0;
      var positionError = 0.0;
      var tX = 0;
      var impulseX = 0;
      var impulseY = 0;
      if (this.m_enableLimit && this.m_limitState != b2Joint.e_inactiveLimit) {
         var angle = bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
         var limitImpulse = 0.0;
         if (this.m_limitState == b2Joint.e_equalLimits) {
            C = b2Math.Clamp(angle - this.m_lowerAngle, (-b2Settings.b2_maxAngularCorrection), b2Settings.b2_maxAngularCorrection);
            limitImpulse = (-this.m_motorMass * C);
            angularError = b2Math.Abs(C);
         }
         else if (this.m_limitState == b2Joint.e_atLowerLimit) {
            C = angle - this.m_lowerAngle;
            angularError = (-C);
            C = b2Math.Clamp(C + b2Settings.b2_angularSlop, (-b2Settings.b2_maxAngularCorrection), 0.0);
            limitImpulse = (-this.m_motorMass * C);
         }
         else if (this.m_limitState == b2Joint.e_atUpperLimit) {
            C = angle - this.m_upperAngle;
            angularError = C;
            C = b2Math.Clamp(C - b2Settings.b2_angularSlop, 0.0, b2Settings.b2_maxAngularCorrection);
            limitImpulse = (-this.m_motorMass * C);
         }
         bA.m_sweep.a -= bA.m_invI * limitImpulse;
         bB.m_sweep.a += bB.m_invI * limitImpulse;
         bA.SynchronizeTransform();
         bB.SynchronizeTransform();
      } {
         tMat = bA.m_xf.R;
         var r1X = this.m_localAnchor1.x - bA.m_sweep.localCenter.x;
         var r1Y = this.m_localAnchor1.y - bA.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r1X + tMat.col2.x * r1Y);
         r1Y = (tMat.col1.y * r1X + tMat.col2.y * r1Y);
         r1X = tX;
         tMat = bB.m_xf.R;
         var r2X = this.m_localAnchor2.x - bB.m_sweep.localCenter.x;
         var r2Y = this.m_localAnchor2.y - bB.m_sweep.localCenter.y;
         tX = (tMat.col1.x * r2X + tMat.col2.x * r2Y);
         r2Y = (tMat.col1.y * r2X + tMat.col2.y * r2Y);
         r2X = tX;
         var CX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
         var CY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
         var CLengthSquared = CX * CX + CY * CY;
         var CLength = Math.sqrt(CLengthSquared);
         positionError = CLength;
         var invMass1 = bA.m_invMass;
         var invMass2 = bB.m_invMass;
         var invI1 = bA.m_invI;
         var invI2 = bB.m_invI;
         var k_allowedStretch = 10.0 * b2Settings.b2_linearSlop;
         if (CLengthSquared > k_allowedStretch * k_allowedStretch) {
            var uX = CX / CLength;
            var uY = CY / CLength;
            var k = invMass1 + invMass2;
            var m = 1.0 / k;
            impulseX = m * ((-CX));
            impulseY = m * ((-CY));
            var k_beta = 0.5;
            bA.m_sweep.c.x -= k_beta * invMass1 * impulseX;
            bA.m_sweep.c.y -= k_beta * invMass1 * impulseY;
            bB.m_sweep.c.x += k_beta * invMass2 * impulseX;
            bB.m_sweep.c.y += k_beta * invMass2 * impulseY;
            CX = bB.m_sweep.c.x + r2X - bA.m_sweep.c.x - r1X;
            CY = bB.m_sweep.c.y + r2Y - bA.m_sweep.c.y - r1Y;
         }
         this.K1.col1.x = invMass1 + invMass2;
         this.K1.col2.x = 0.0;
         this.K1.col1.y = 0.0;
         this.K1.col2.y = invMass1 + invMass2;
         this.K2.col1.x = invI1 * r1Y * r1Y;
         this.K2.col2.x = (-invI1 * r1X * r1Y);
         this.K2.col1.y = (-invI1 * r1X * r1Y);
         this.K2.col2.y = invI1 * r1X * r1X;
         this.K3.col1.x = invI2 * r2Y * r2Y;
         this.K3.col2.x = (-invI2 * r2X * r2Y);
         this.K3.col1.y = (-invI2 * r2X * r2Y);
         this.K3.col2.y = invI2 * r2X * r2X;
         this.K.SetM(this.K1);
         this.K.AddM(this.K2);
         this.K.AddM(this.K3);
         this.K.Solve(b2RevoluteJoint.tImpulse, (-CX), (-CY));
         impulseX = b2RevoluteJoint.tImpulse.x;
         impulseY = b2RevoluteJoint.tImpulse.y;
         bA.m_sweep.c.x -= bA.m_invMass * impulseX;
         bA.m_sweep.c.y -= bA.m_invMass * impulseY;
         bA.m_sweep.a -= bA.m_invI * (r1X * impulseY - r1Y * impulseX);
         bB.m_sweep.c.x += bB.m_invMass * impulseX;
         bB.m_sweep.c.y += bB.m_invMass * impulseY;
         bB.m_sweep.a += bB.m_invI * (r2X * impulseY - r2Y * impulseX);
         bA.SynchronizeTransform();
         bB.SynchronizeTransform();
      }
      return positionError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.postDefs.push(function () {
      Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse = new b2Vec2();
   });
   Box2D.inherit(b2RevoluteJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2RevoluteJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2RevoluteJointDef.b2RevoluteJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2RevoluteJointDef.prototype.b2RevoluteJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_revoluteJoint;
      this.localAnchorA.Set(0.0, 0.0);
      this.localAnchorB.Set(0.0, 0.0);
      this.referenceAngle = 0.0;
      this.lowerAngle = 0.0;
      this.upperAngle = 0.0;
      this.maxMotorTorque = 0.0;
      this.motorSpeed = 0.0;
      this.enableLimit = false;
      this.enableMotor = false;
   }
   b2RevoluteJointDef.prototype.Initialize = function (bA, bB, anchor) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA = this.bodyA.GetLocalPoint(anchor);
      this.localAnchorB = this.bodyB.GetLocalPoint(anchor);
      this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
   }
   Box2D.inherit(b2WeldJoint, Box2D.Dynamics.Joints.b2Joint);
   b2WeldJoint.prototype.__super = Box2D.Dynamics.Joints.b2Joint.prototype;
   b2WeldJoint.b2WeldJoint = function () {
      Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this, arguments);
      this.m_localAnchorA = new b2Vec2();
      this.m_localAnchorB = new b2Vec2();
      this.m_impulse = new b2Vec3();
      this.m_mass = new b2Mat33();
   };
   b2WeldJoint.prototype.GetAnchorA = function () {
      return this.m_bodyA.GetWorldPoint(this.m_localAnchorA);
   }
   b2WeldJoint.prototype.GetAnchorB = function () {
      return this.m_bodyB.GetWorldPoint(this.m_localAnchorB);
   }
   b2WeldJoint.prototype.GetReactionForce = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return new b2Vec2(inv_dt * this.m_impulse.x, inv_dt * this.m_impulse.y);
   }
   b2WeldJoint.prototype.GetReactionTorque = function (inv_dt) {
      if (inv_dt === undefined) inv_dt = 0;
      return inv_dt * this.m_impulse.z;
   }
   b2WeldJoint.prototype.b2WeldJoint = function (def) {
      this.__super.b2Joint.call(this, def);
      this.m_localAnchorA.SetV(def.localAnchorA);
      this.m_localAnchorB.SetV(def.localAnchorB);
      this.m_referenceAngle = def.referenceAngle;
      this.m_impulse.SetZero();
      this.m_mass = new b2Mat33();
   }
   b2WeldJoint.prototype.InitVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      this.m_mass.col1.x = mA + mB + rAY * rAY * iA + rBY * rBY * iB;
      this.m_mass.col2.x = (-rAY * rAX * iA) - rBY * rBX * iB;
      this.m_mass.col3.x = (-rAY * iA) - rBY * iB;
      this.m_mass.col1.y = this.m_mass.col2.x;
      this.m_mass.col2.y = mA + mB + rAX * rAX * iA + rBX * rBX * iB;
      this.m_mass.col3.y = rAX * iA + rBX * iB;
      this.m_mass.col1.z = this.m_mass.col3.x;
      this.m_mass.col2.z = this.m_mass.col3.y;
      this.m_mass.col3.z = iA + iB;
      if (step.warmStarting) {
         this.m_impulse.x *= step.dtRatio;
         this.m_impulse.y *= step.dtRatio;
         this.m_impulse.z *= step.dtRatio;
         bA.m_linearVelocity.x -= mA * this.m_impulse.x;
         bA.m_linearVelocity.y -= mA * this.m_impulse.y;
         bA.m_angularVelocity -= iA * (rAX * this.m_impulse.y - rAY * this.m_impulse.x + this.m_impulse.z);
         bB.m_linearVelocity.x += mB * this.m_impulse.x;
         bB.m_linearVelocity.y += mB * this.m_impulse.y;
         bB.m_angularVelocity += iB * (rBX * this.m_impulse.y - rBY * this.m_impulse.x + this.m_impulse.z);
      }
      else {
         this.m_impulse.SetZero();
      }
   }
   b2WeldJoint.prototype.SolveVelocityConstraints = function (step) {
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      var vA = bA.m_linearVelocity;
      var wA = bA.m_angularVelocity;
      var vB = bB.m_linearVelocity;
      var wB = bB.m_angularVelocity;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var Cdot1X = vB.x - wB * rBY - vA.x + wA * rAY;
      var Cdot1Y = vB.y + wB * rBX - vA.y - wA * rAX;
      var Cdot2 = wB - wA;
      var impulse = new b2Vec3();
      this.m_mass.Solve33(impulse, (-Cdot1X), (-Cdot1Y), (-Cdot2));
      this.m_impulse.Add(impulse);
      vA.x -= mA * impulse.x;
      vA.y -= mA * impulse.y;
      wA -= iA * (rAX * impulse.y - rAY * impulse.x + impulse.z);
      vB.x += mB * impulse.x;
      vB.y += mB * impulse.y;
      wB += iB * (rBX * impulse.y - rBY * impulse.x + impulse.z);
      bA.m_angularVelocity = wA;
      bB.m_angularVelocity = wB;
   }
   b2WeldJoint.prototype.SolvePositionConstraints = function (baumgarte) {
      if (baumgarte === undefined) baumgarte = 0;
      var tMat;
      var tX = 0;
      var bA = this.m_bodyA;
      var bB = this.m_bodyB;
      tMat = bA.m_xf.R;
      var rAX = this.m_localAnchorA.x - bA.m_sweep.localCenter.x;
      var rAY = this.m_localAnchorA.y - bA.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rAX + tMat.col2.x * rAY);
      rAY = (tMat.col1.y * rAX + tMat.col2.y * rAY);
      rAX = tX;
      tMat = bB.m_xf.R;
      var rBX = this.m_localAnchorB.x - bB.m_sweep.localCenter.x;
      var rBY = this.m_localAnchorB.y - bB.m_sweep.localCenter.y;
      tX = (tMat.col1.x * rBX + tMat.col2.x * rBY);
      rBY = (tMat.col1.y * rBX + tMat.col2.y * rBY);
      rBX = tX;
      var mA = bA.m_invMass;
      var mB = bB.m_invMass;
      var iA = bA.m_invI;
      var iB = bB.m_invI;
      var C1X = bB.m_sweep.c.x + rBX - bA.m_sweep.c.x - rAX;
      var C1Y = bB.m_sweep.c.y + rBY - bA.m_sweep.c.y - rAY;
      var C2 = bB.m_sweep.a - bA.m_sweep.a - this.m_referenceAngle;
      var k_allowedStretch = 10.0 * b2Settings.b2_linearSlop;
      var positionError = Math.sqrt(C1X * C1X + C1Y * C1Y);
      var angularError = b2Math.Abs(C2);
      if (positionError > k_allowedStretch) {
         iA *= 1.0;
         iB *= 1.0;
      }
      this.m_mass.col1.x = mA + mB + rAY * rAY * iA + rBY * rBY * iB;
      this.m_mass.col2.x = (-rAY * rAX * iA) - rBY * rBX * iB;
      this.m_mass.col3.x = (-rAY * iA) - rBY * iB;
      this.m_mass.col1.y = this.m_mass.col2.x;
      this.m_mass.col2.y = mA + mB + rAX * rAX * iA + rBX * rBX * iB;
      this.m_mass.col3.y = rAX * iA + rBX * iB;
      this.m_mass.col1.z = this.m_mass.col3.x;
      this.m_mass.col2.z = this.m_mass.col3.y;
      this.m_mass.col3.z = iA + iB;
      var impulse = new b2Vec3();
      this.m_mass.Solve33(impulse, (-C1X), (-C1Y), (-C2));
      bA.m_sweep.c.x -= mA * impulse.x;
      bA.m_sweep.c.y -= mA * impulse.y;
      bA.m_sweep.a -= iA * (rAX * impulse.y - rAY * impulse.x + impulse.z);
      bB.m_sweep.c.x += mB * impulse.x;
      bB.m_sweep.c.y += mB * impulse.y;
      bB.m_sweep.a += iB * (rBX * impulse.y - rBY * impulse.x + impulse.z);
      bA.SynchronizeTransform();
      bB.SynchronizeTransform();
      return positionError <= b2Settings.b2_linearSlop && angularError <= b2Settings.b2_angularSlop;
   }
   Box2D.inherit(b2WeldJointDef, Box2D.Dynamics.Joints.b2JointDef);
   b2WeldJointDef.prototype.__super = Box2D.Dynamics.Joints.b2JointDef.prototype;
   b2WeldJointDef.b2WeldJointDef = function () {
      Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this, arguments);
      this.localAnchorA = new b2Vec2();
      this.localAnchorB = new b2Vec2();
   };
   b2WeldJointDef.prototype.b2WeldJointDef = function () {
      this.__super.b2JointDef.call(this);
      this.type = b2Joint.e_weldJoint;
      this.referenceAngle = 0.0;
   }
   b2WeldJointDef.prototype.Initialize = function (bA, bB, anchor) {
      this.bodyA = bA;
      this.bodyB = bB;
      this.localAnchorA.SetV(this.bodyA.GetLocalPoint(anchor));
      this.localAnchorB.SetV(this.bodyB.GetLocalPoint(anchor));
      this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
   }
})();
(function () {
   var b2DebugDraw = Box2D.Dynamics.b2DebugDraw;
   b2DebugDraw.b2DebugDraw = function () {
      this.m_drawScale = 1.0;
      this.m_lineThickness = 1.0;
      this.m_alpha = 1.0;
      this.m_fillAlpha = 1.0;
      this.m_xformScale = 1.0;
      var __this = this;
      //#WORKAROUND
      this.m_sprite = {
         graphics: {
            clear: function () {
               __this.m_ctx.clearRect(0, 0, __this.m_ctx.canvas.width, __this.m_ctx.canvas.height)
            }
         }
      };
   };
   b2DebugDraw.prototype._color = function (color, alpha) {
      return "rgba(" + ((color & 0xFF0000) >> 16) + "," + ((color & 0xFF00) >> 8) + "," + (color & 0xFF) + "," + alpha + ")";
   };
   b2DebugDraw.prototype.b2DebugDraw = function () {
      this.m_drawFlags = 0;
   };
   b2DebugDraw.prototype.SetFlags = function (flags) {
      if (flags === undefined) flags = 0;
      this.m_drawFlags = flags;
   };
   b2DebugDraw.prototype.GetFlags = function () {
      return this.m_drawFlags;
   };
   b2DebugDraw.prototype.AppendFlags = function (flags) {
      if (flags === undefined) flags = 0;
      this.m_drawFlags |= flags;
   };
   b2DebugDraw.prototype.ClearFlags = function (flags) {
      if (flags === undefined) flags = 0;
      this.m_drawFlags &= ~flags;
   };
   b2DebugDraw.prototype.SetSprite = function (sprite) {
      this.m_ctx = sprite;
   };
   b2DebugDraw.prototype.GetSprite = function () {
      return this.m_ctx;
   };
   b2DebugDraw.prototype.SetDrawScale = function (drawScale) {
      if (drawScale === undefined) drawScale = 0;
      this.m_drawScale = drawScale;
   };
   b2DebugDraw.prototype.GetDrawScale = function () {
      return this.m_drawScale;
   };
   b2DebugDraw.prototype.SetLineThickness = function (lineThickness) {
      if (lineThickness === undefined) lineThickness = 0;
      this.m_lineThickness = lineThickness;
      this.m_ctx.strokeWidth = lineThickness;
   };
   b2DebugDraw.prototype.GetLineThickness = function () {
      return this.m_lineThickness;
   };
   b2DebugDraw.prototype.SetAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
      this.m_alpha = alpha;
   };
   b2DebugDraw.prototype.GetAlpha = function () {
      return this.m_alpha;
   };
   b2DebugDraw.prototype.SetFillAlpha = function (alpha) {
      if (alpha === undefined) alpha = 0;
      this.m_fillAlpha = alpha;
   };
   b2DebugDraw.prototype.GetFillAlpha = function () {
      return this.m_fillAlpha;
   };
   b2DebugDraw.prototype.SetXFormScale = function (xformScale) {
      if (xformScale === undefined) xformScale = 0;
      this.m_xformScale = xformScale;
   };
   b2DebugDraw.prototype.GetXFormScale = function () {
      return this.m_xformScale;
   };
   b2DebugDraw.prototype.DrawPolygon = function (vertices, vertexCount, color) {
      if (!vertexCount) return;
      var s = this.m_ctx;
      var drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.moveTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      for (var i = 1; i < vertexCount; i++) {
         s.lineTo(vertices[i].x * drawScale, vertices[i].y * drawScale);
      }
      s.lineTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      s.closePath();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawSolidPolygon = function (vertices, vertexCount, color) {
      if (!vertexCount) return;
      var s = this.m_ctx;
      var drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.fillStyle = this._color(color.color, this.m_fillAlpha);
      s.moveTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      for (var i = 1; i < vertexCount; i++) {
         s.lineTo(vertices[i].x * drawScale, vertices[i].y * drawScale);
      }
      s.lineTo(vertices[0].x * drawScale, vertices[0].y * drawScale);
      s.closePath();
      s.fill();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawCircle = function (center, radius, color) {
      if (!radius) return;
      var s = this.m_ctx;
      var drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.arc(center.x * drawScale, center.y * drawScale, radius * drawScale, 0, Math.PI * 2, true);
      s.closePath();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawSolidCircle = function (center, radius, axis, color) {
      if (!radius) return;
      var s = this.m_ctx,
         drawScale = this.m_drawScale,
         cx = center.x * drawScale,
         cy = center.y * drawScale;
      s.moveTo(0, 0);
      s.beginPath();
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.fillStyle = this._color(color.color, this.m_fillAlpha);
      s.arc(cx, cy, radius * drawScale, 0, Math.PI * 2, true);
      s.moveTo(cx, cy);
      s.lineTo((center.x + axis.x * radius) * drawScale, (center.y + axis.y * radius) * drawScale);
      s.closePath();
      s.fill();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawSegment = function (p1, p2, color) {
      var s = this.m_ctx,
         drawScale = this.m_drawScale;
      s.strokeStyle = this._color(color.color, this.m_alpha);
      s.beginPath();
      s.moveTo(p1.x * drawScale, p1.y * drawScale);
      s.lineTo(p2.x * drawScale, p2.y * drawScale);
      s.closePath();
      s.stroke();
   };
   b2DebugDraw.prototype.DrawTransform = function (xf) {
      var s = this.m_ctx,
         drawScale = this.m_drawScale;
      s.beginPath();
      s.strokeStyle = this._color(0xff0000, this.m_alpha);
      s.moveTo(xf.position.x * drawScale, xf.position.y * drawScale);
      s.lineTo((xf.position.x + this.m_xformScale * xf.R.col1.x) * drawScale, (xf.position.y + this.m_xformScale * xf.R.col1.y) * drawScale);

      s.strokeStyle = this._color(0xff00, this.m_alpha);
      s.moveTo(xf.position.x * drawScale, xf.position.y * drawScale);
      s.lineTo((xf.position.x + this.m_xformScale * xf.R.col2.x) * drawScale, (xf.position.y + this.m_xformScale * xf.R.col2.y) * drawScale);
      s.closePath();
      s.stroke();
   };
})();
var i;
for (i = 0; i < Box2D.postDefs.length; ++i) Box2D.postDefs[i]();

module.exports = Box2D
},{}]},{},[43])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL0FwcERhdGEvUm9hbWluZy9ucG0vbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIkIyZC5qcyIsIkNvbmZpZy5qcyIsIkNvbnRyb2xsZXJzL0Fzc2V0Q29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0VudGl0eUNvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9HYW1lQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0dyYXBoaWNzQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0hVRENvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9JZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9Jbml0Q29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL0tleWJvYXJkQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1BoeXNpY3NDb250cm9sbGVyLmpzIiwiQ29udHJvbGxlcnMvUmVnaXN0ZXJBc0NvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9UZXJyYWluQ29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1RlcnJhaW5TbGljZUNvbnRyb2xsZXIuanMiLCJDb250cm9sbGVycy9UZXN0Q29udHJvbGxlci5qcyIsIkNvbnRyb2xsZXJzL1dvcmxkQ29udHJvbGxlci5qcyIsIkdhbWVVdGlsaXR5LmpzIiwiSW5jbHVkZXMuanMiLCJMb2dpYy9BbnRMb2dpYy5qcyIsIkxvZ2ljL0dyaWZmaW5Mb2dpYy5qcyIsIkxvZ2ljL0hlcm9Mb2dpYy5qcyIsIkxvZ2ljL0h5ZW5hTG9naWMuanMiLCJNb2RlbHMvQXNzZXRNb2RlbC5qcyIsIk1vZGVscy9FbnRpdHlNb2RlbC5qcyIsIk1vZGVscy9HYW1lTW9kZWwuanMiLCJNb2RlbHMvR3JhcGhpY3NNb2RlbC5qcyIsIk1vZGVscy9IVURNb2RlbC5qcyIsIk1vZGVscy9JZGVudGlmaWNhdGlvbk1vZGVsLmpzIiwiTW9kZWxzL0tleWJvYXJkTW9kZWwuanMiLCJNb2RlbHMvUGh5c2ljc01vZGVsLmpzIiwiTW9kZWxzL1JlZ2lzdGVyQXNNb2RlbC5qcyIsIk1vZGVscy9UZXJyYWluTW9kZWwuanMiLCJNb2RlbHMvVGVycmFpblNsaWNlTW9kZWwuanMiLCJNb2RlbHMvVGVzdE1vZGVsLmpzIiwiTW9kZWxzL1dvcmxkTW9kZWwuanMiLCJSZW5kZXJlcnMvQW50UmVuZGVyZXIuanMiLCJSZW5kZXJlcnMvQmFja2dyb3VuZFJlbmRlcmVyLmpzIiwiUmVuZGVyZXJzL0dyaWZmaW5SZW5kZXJlci5qcyIsIlJlbmRlcmVycy9IZXJvUmVuZGVyZXIuanMiLCJSZW5kZXJlcnMvSHllbmFSZW5kZXJlci5qcyIsIlJlbmRlcmVycy9UZXJyYWluQ2VsbFJlbmRlcmVyLmpzIiwiUmVuZGVyZXJzL1RlcnJhaW5TbGljZVJlbmRlcmVyLmpzIiwibWFpbi5qcyIsIm5vZGVfbW9kdWxlcy9ib3gyZHdlYi9ib3gyZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxcUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0UUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbE5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcFRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25IQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIFRoaXMgZmlsZSBjb250YWlucyBzaG9ydGN1dHMgZm9yIHRoZSBtZXRob2RzIG9mIHRoZSBCb3gyRCBsaWJyYXJ5IHRoYXQgYXJlIHVzZWRcclxuLy8gdG9vIG9mdGVuIHRvIHR5cGUgdGhlaXIgbG9uZyBuYW1lc1xyXG5cclxudmFyIEIyZCA9IGZ1bmN0aW9uKCl7XHJcblxyXG59O1xyXG5cclxuQjJkLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKXtcclxuXHRpbmNsdWRlKCk7XHJcblxyXG5cdHRoaXMuYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyO1xyXG5cdHRoaXMuYjJCb2R5RGVmID0gQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmO1xyXG5cdHRoaXMuYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5O1xyXG5cdHRoaXMuYjJGaXh0dXJlRGVmID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmO1xyXG5cdHRoaXMuYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlO1xyXG5cdHRoaXMuYjJXb3JsZCA9IEJveDJELkR5bmFtaWNzLmIyV29ybGQ7XHJcblx0dGhpcy5iMk1hc3NEYXRhID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMk1hc3NEYXRhO1xyXG5cdHRoaXMuYjJQb2x5Z29uU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyUG9seWdvblNoYXBlO1xyXG5cdHRoaXMuYjJDaXJjbGVTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZTtcclxuXHR0aGlzLmIyRGVidWdEcmF3ID0gQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXc7IFxyXG5cdHRoaXMuYjJDb250YWN0TGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lcjtcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBCMmQ7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkIyZFwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuT1RIRVJfU1RVRkZcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwidmFyIENvbmZpZyA9IGZ1bmN0aW9uKCl7XHJcblx0dGhpcy5TQ1JFRU5fVyA9IDA7IC8vIHNldCB1cCB3aGVuIHRoZSBwYWdlIGlzIGxvYWRlZCAodG8gOTUlIG9mIHdpZHRoIG9mIGNvbnRhaW5pbmcgZWxlbWVudCkgXHJcblx0dGhpcy5TQ1JFRU5fSCA9IDYwMDtcclxuXHJcblx0dGhpcy5NQUlOX0NBTlZBU19OQU1FID0gXCJkaXNwbGF5X2NhbnZhc1wiO1xyXG5cdHRoaXMuREVCVUdfQ0FOVkFTX05BTUUgPSBcImRlYnVnX2NhbnZhc1wiO1xyXG5cclxuXHQvLyBGcmFtZXMgUGVyIFNlY29uZC4gRXNzZW50aWFsbHksIGZyZXF1ZW5jeSBvZiBjcmVhdGVqcy5UaWNrZXIgXHJcblx0Ly8gV2FybmluZyEgRnJlcXVlbmN5IG9mIHRoZSBCb3gyRCBwaHlzaWNzIHVwZGF0ZXMgbWF5IGJlIGRpZmZlcmVudFxyXG5cdC8vIChDdXJyZW50bHkgbm90IGltcGxlbWVudGVkKVxyXG5cdHRoaXMuRlBTID0gMzA7IFxyXG5cdFxyXG5cdC8vdGhlIG1vdmVtZW50IGVkZ2UsIGNvbnRyb2xzIHRlcnJhaW4gZ2VuZXJhdGlvblxyXG5cdHRoaXMubW92ZW1lbnRfZWRnZSA9IDA7XHJcblxyXG5cdC8vIEJveDJEIHN0dWZmID4+PlxyXG5cdHRoaXMuQjJEID0ge1xyXG5cdFx0U0NBTEU6IDMwLFxyXG5cdFx0U1BTOiA2MCwgXHRcdFx0Ly8gU3RlcHMgUGVyIFNlY29uZFxyXG5cdFx0VkVMT0NJVFlfSVRSOiA4LFx0Ly8gdmVsb2NpdHkgaXRlcmF0aW9uc1xyXG5cdFx0UE9TSVRJT05fSVRSOiAzLFx0Ly8gcG9zaXRpb24gaXRlcmF0aW9uc1xyXG5cdFx0ZGVidWdfZHJhdzogZmFsc2VcclxuXHR9O1xyXG5cclxuXHR0aGlzLlRlcnJhaW5TbGljZSA9IHtcclxuXHRcdGdyaWRfcm93czogMjAsXHJcblx0XHRncmlkX2NvbHVtbnM6IDIwLFxyXG5cdFx0Y2VsbF93OiAxLCAvLyBpbiBtZXRlcnNcclxuXHJcblx0XHQvLyBpcyBhdXRvbWF0aWNhbGx5IGluY3JlbWVudGVkIGVhY2ggdGltZSBuZXcgVGVycmFpblNsaWNlTW9kZWwgaXMgaW5zdGFudGlhdGVkOlxyXG5cdFx0bmV4dF9zbGljZV9pZDogMCBcclxuXHR9O1xyXG5cclxuXHR0aGlzLldvcmxkID0ge1xyXG5cdFx0bWF4eTogMjIsXHJcblxyXG5cdH07XHJcblx0Ly8gPDw8XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBDb25maWc7XHJcbiIsIlxyXG52YXIgQXNzZXRDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0LypcclxuXHQgICBBc3NldENvbnRyb2xsZXIgaXMgaW4gY2hhcmdlIG9mIHNldHRpbmcgdXAgYWxsIGJpdG1hcHMvYW5pbWF0aW9ucy9vdGhlciByZXNvdXJjZXNcclxuXHQgICBmb3IgZXZlcnlvbmUgZWxzZS5cclxuICAgKi9cclxuXHJcblx0Ly8gdXNlIEFzc2V0TW9kZWwubG9hZGVyLmdldFJlc3VsdChcImlkX29mX3RoZV9hc3NldFwiKTtcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbihhc3NldF9wYXRoKXtcclxuXHRcdGluY2x1ZGUoKTtcdFxyXG5cclxuXHRcdC8qIFRPRE8gbWFrZSBtb2RlbCB3aXRoIHRoZSBlYXNpbHkgbWFuYWdlZCB0YWJsZXMgb2YgcmVzb3VyY2VzIHdoaWNoIHdpbGwgYmVcclxuXHRcdCAgIGFkZGVkIHRvIHRoZSBsb2FkZXIgYXV0b21hdGljYWxseVxyXG5cdFx0Ki9cclxuXHJcblx0XHQvL2xvYWRlciA9IG5ldyBjcmVhdGVqcy5Mb2FkUXVldWUoZmFsc2UpOyAvLyBsb2FkaW5nIHJlc291cnNlcyB1c2luZyBwcmVsb2FkLmpzXHJcblx0XHQvL2xvYWRlci5hZGRFdmVudExpc3RlbmVyKFwiY29tcGxldGVcIiwgaGFuZGxlQ29tcGxldGUpO1xyXG5cdFx0dmFyIG1hbmlmZXN0ID0gQXNzZXRNb2RlbC5tYW5pZmVzdDtcdFxyXG5cdFx0QXNzZXRNb2RlbC5sb2FkZXIubG9hZE1hbmlmZXN0KG1hbmlmZXN0LCB0cnVlLCBhc3NldF9wYXRoKTtcclxuXHRcdFxyXG5cdH07XHJcblxyXG5cdHZhciBwb3N0X2luaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogdGhpcyBmdW5jdGlvbiB3aWxsIGJlIGRvbmUgZGlmZmVyZW50bHkgYXQgc29tZSBwb2ludFxyXG5cdFx0ICogaXQnbGwgaGF2ZSBzb21ldGhpbmcgdG8gZG8gd2l0aCByZWZhY3RvcmluZyBJbml0Q29udHJvbGxlclxyXG5cdFx0ICovXHJcblxyXG5cdFx0Ly9Bc3NldE1vZGVsLmFuaW1hdGlvbnNbXCJhbnRcIl0gPSBuZXcgY3JlYXRlanMuU3ByaXRlU2hlZXQoe1xyXG5cdFx0XHQvL1wiZnJhbWVyYXRlXCI6IDAuMixcclxuXHRcdFx0Ly9cImltYWdlc1wiOiBbZ2V0X2Fzc2V0KFwiQW50MVwiKSwgZ2V0X2Fzc2V0KFwiQW50MlwiKSwgZ2V0X2Fzc2V0KFwiQW50M1wiKV0sXHJcblx0XHRcdC8vXCJmcmFtZXNcIjogeyBcInJlZ1hcIjogMywgXCJyZWdZXCI6IDYsIFwiaGVpZ2h0XCI6IDI1LCBcIndpZHRoXCI6IDUwLCBcImNvdW50XCI6IDZ9LFxyXG5cdFx0XHQvL1wiYW5pbWF0aW9uc1wiOiB7XHJcblx0XHRcdFx0Ly9cIndhbGtcIjogWzAsIDEsIFwid2Fsa1wiXSxcclxuXHRcdFx0XHQvL1widXBzaWRlX2Rvd25cIjogWzIsIDMsIFwidXBzaWRlX2Rvd25cIl0sXHJcblx0XHRcdFx0Ly9cImRlYXRoXCI6IFs0LCA1LCBcImRlYXRoXCJdXHJcblx0XHRcdC8vfVxyXG5cdFx0Ly99KVxyXG5cclxuXHR9O1xyXG5cdFxyXG5cclxuXHR2YXIgZ2V0X2Fzc2V0ID0gZnVuY3Rpb24oaWQpe1xyXG5cclxuXHRcdHZhciByZXN1bHQgPSBBc3NldE1vZGVsLmxvYWRlci5nZXRSZXN1bHQoaWQpO1xyXG5cclxuXHRcdGlmKCFyZXN1bHQpe1xyXG5cdFx0XHR0aHJvdyBcIkVycm9yOiBhc3NldCB3aXRoIGlkIFwiICsgaWQgKyBcIiBjb3VsZCBub3QgYmUgbG9hZGVkLlwiICtcclxuXHRcdFx0XHRcIiBDaGVjayB0aGF0IGlkIGlzIHZhbGlkIGFuZCB0aGF0IGFzc2V0cyB3ZXJlIHByb3Blcmx5IGxvYWRlZFwiO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdH07XHJcblx0XHRcclxuXHJcblxyXG5cdFxyXG5cdHJldHVybiB7XHJcblx0XHRpbml0OiBpbml0LFxyXG5cdFx0Z2V0X2Fzc2V0OiBnZXRfYXNzZXQsXHJcblx0fTtcclxuXHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEFzc2V0Q29udHJvbGxlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkFzc2V0Q29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJ2YXIgRW50aXR5Q29udHJvbGxlciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKiBEZXNjcmlwdGlvblxyXG4gICAgKi9cclxuXHJcbiAgICB2YXIgdHlwZV9sb2dpY190YWJsZTtcclxuXHJcbiAgICB2YXIgQ291bnQgPSAwO1xyXG5cclxuICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8qIGlzIHJhbiBmcm9tIHRoZSBJbml0Q29udHJvbGxlciBvbmNlIHdoZW4gdGhlIGdhbWUgaXMgbG9hZGVkICovXHJcblxyXG4gICAgICAgIGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHNcclxuXHJcbiAgICAgICAgdHlwZV9sb2dpY190YWJsZSA9IHtcclxuICAgICAgICAgICAgXCJhbnRcIjogQW50TG9naWMsXHJcbiAgICAgICAgICAgIFwiaGVyb1wiOiBIZXJvTG9naWMsXHJcbiAgICAgICAgICAgIFwiR3JpZmZpblwiOiBHcmlmZmluTG9naWMsXHJcbiAgICAgICAgICAgIFwiSHllbmFcIjogSHllbmFMb2dpYyxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmb3IgKHR5cGUgaW4gdHlwZV9sb2dpY190YWJsZSkge1xyXG4gICAgICAgICAgICB2YXIgbG9naWMgPSB0eXBlX2xvZ2ljX3RhYmxlW3R5cGVdO1xyXG4gICAgICAgICAgICBsb2dpYy5pbml0KCk7XHJcblxyXG4gICAgICAgICAgICBpZiAobG9naWMuYmVnaW5fY29udGFjdCkge1xyXG4gICAgICAgICAgICAgICAgUGh5c2ljc0NvbnRyb2xsZXIubGlzdGVuX2Zvcl9jb250YWN0X3dpdGgodHlwZSwgXCJCZWdpbkNvbnRhY3RcIiwgbG9naWMuYmVnaW5fY29udGFjdCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChsb2dpYy5lbmRfY29udGFjdCkge1xyXG4gICAgICAgICAgICAgICAgUGh5c2ljc0NvbnRyb2xsZXIubGlzdGVuX2Zvcl9jb250YWN0X3dpdGgodHlwZSwgXCJFbmRDb250YWN0XCIsIGxvZ2ljLmVuZF9jb250YWN0KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGxvZ2ljLnByZV9zb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgUGh5c2ljc0NvbnRyb2xsZXIubGlzdGVuX2Zvcl9jb250YWN0X3dpdGgodHlwZSwgXCJQcmVTb2x2ZVwiLCBsb2dpYy5wcmVfc29sdmUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobG9naWMucG9zdF9zb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgUGh5c2ljc0NvbnRyb2xsZXIubGlzdGVuX2Zvcl9jb250YWN0X3dpdGgodHlwZSwgXCJQb3N0U29sdmVcIiwgbG9naWMucG9zdF9zb2x2ZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzcGF3bigxMCwgMTAsIFwiaGVyb1wiKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHNwYXduID0gZnVuY3Rpb24gKHgsIHksIHR5cGUpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAqIHNwYXduIGVudGl0eSBvZiB0aGUgZ2l2ZW4gdHlwZSBhdCB0aGUgZ2l2ZW4gY29vcmRpbmF0ZXNcclxuICAgICAgICAqIGFsc28gcmVnaXN0ZXJlcyB0aGluZyBhcyBhd2FpdGluZyBncmFwaGljcyBpbml0aWFsaXphdGlvblxyXG4gICAgICAgICovXHJcbiAgICAgICAgdmFyIGxvZ2ljID0gdHlwZV9sb2dpY190YWJsZVt0eXBlXTtcclxuXHJcbiAgICAgICAgaWYgKGxvZ2ljKSB7XHJcbiAgICAgICAgICAgIHZhciBuZXdfZW50aXR5ID0gbG9naWMuc3Bhd24oeCwgeSk7XHJcbiAgICAgICAgICAgIFJlZ2lzdGVyQXNDb250cm9sbGVyLnJlZ2lzdGVyX2FzKFwiYXdhaXRpbmdfZ3JhcGhpY3NfaW5pdGlhbGl6YXRpb25cIiwgbmV3X2VudGl0eSlcclxuXHJcbiAgICAgICAgICAgIGlmICghRW50aXR5TW9kZWwuZm9yX2xvZ2ljX3VwZGF0ZVt0eXBlXSkge1xyXG4gICAgICAgICAgICAgICAgRW50aXR5TW9kZWwuZm9yX2xvZ2ljX3VwZGF0ZVt0eXBlXSA9IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBsb2dpY191cGRfdGFibGUgPSBFbnRpdHlNb2RlbC5mb3JfbG9naWNfdXBkYXRlW3R5cGVdO1xyXG4gICAgICAgICAgICBsb2dpY191cGRfdGFibGVbbmV3X2VudGl0eS5pZF0gPSBuZXdfZW50aXR5O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IFwiTG9naWMgZm9yIHRoZSB0eXBlIFwiICsgdHlwZSArIFwiIGlzIG5vdCBkZWZpbmVkXCI7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9O1xyXG5cclxuXHJcblxyXG4gICAgdmFyIGRlc3Bhd24gPSBmdW5jdGlvbiAoZW50aXR5KSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogdGhpcyBmdW5jdGlvbiB3aWxsIGRlc3Bhd24gZ2l2ZW4gZW50aXR5XHJcbiAgICAgICAgICogaW4gb25lIG9mIHR3byB3YXlzOlxyXG4gICAgICAgICAqIGlmIGVudGl0eSBoYXMgZGVzcGF3biBmdW5jdGlvbiwgaXQgd2lsbCBiZSBjYWxsZWRcclxuICAgICAgICAgKiBpZiBub3QsIGVudGl0eSB3aWxsIGJlIGRlbGV0ZWQgZGlyZWN0bHlcclxuICAgICAgICAqL1xyXG5cclxuICAgICAgICB2YXIgdHlwZSA9IGVudGl0eS50eXBlO1xyXG4gICAgICAgIHZhciBpZCA9IGVudGl0eS5pZDtcclxuICAgICAgICB2YXIgbG9naWMgPSB0eXBlX2xvZ2ljX3RhYmxlW3R5cGVdO1xyXG5cclxuICAgICAgICBpZiAobG9naWMuZGVzcGF3bikge1xyXG4gICAgICAgICAgICAvLyBpZiBjdXN0b20gZGVzcGF3biBmdW5jdGlvbiBpcyBwcm92aWRlZCwgY2FsbCBpdFxyXG4gICAgICAgICAgICBsb2dpYy5kZXNwYXduKGVudGl0eSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZGVzcGF3biBjYWxsZWQgZm9yIHRoZSB0eXBlXCIsIHR5cGUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIG9yIGRlbGV0ZSBkaXJlY3RseVxyXG4gICAgICAgICAgICBkZWxldGVfZW50aXR5KGVudGl0eSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH07XHJcblxyXG5cclxuXHJcbiAgICB2YXIgZGVsZXRlX2VudGl0eSA9IGZ1bmN0aW9uIChlbnRpdHkpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAqIFRoaXMgZnVuY3Rpb24gd2lsbCByZW1vdmUgdGhpcyBlbnRpdHkgYWxvbmcgd2l0aCBzb21lIG90aGVyIGluZm8gYWJvdXQgdGhpcyBlbnRpdHlcclxuICAgICAgICAqIGZyb20gdGhlIHdvcmxkLCBpdCdsbCBhbHNvIGZyZWUgdGhlIGlkIG9mIHRoaXMgZW50aXR5LiBUaGUgcGh5c2ljYWwgYm9keSB3aWxsIGJlIGRlbGV0ZWRcclxuICAgICAgICAqIHRvbzsgXHJcbiAgICAgICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHN1cHBvc2VkIHRvIGJlIGNhbGxlZCBieSB0aGUgaW5kaXZpZHVhbCBsb2dpYyBtb2R1bGVzLCB3aGVuIHRoZSBhcmUgZmluaXNoZWRcclxuICAgICAgICAqIGFuaW1hdGluZyBkZWF0L2Rlc3RydWN0aW9uIG9mIHNvbWV0aGluZyBhbmQgd2FudCB0byBnZXQgcmlkIG9mIGl0XHJcbiAgICAgICAgKi9cclxuXHJcbiAgICAgICAgLy8gVE9ETzogZmluaXNoIHRoaXMgZnVuY3Rpb24gYW5kIHRoZW4gdXBkYXRlIGl0IHJlZ3VsYXJseTtcclxuICAgICAgICAvLyBUaGlzIG9uZSBpcyB2ZXJ5IHNlbnNpdGl2ZSwgYXMgZXZlbiBvbmUgcmVmZXJlbmNlIGxlZnQgbWF5IHByZXZlbnQgXHJcbiAgICAgICAgLy8gb2JqZWN0IGZyb20gYmVpbmcgZGVsZXRlZCBhbmQgY2F1c2UgbWVtb3J5IGxlYWtzLiBUZXN0aW5nIGlzIHJlcXVpcmVkXHJcbiAgICAgICAgaWYgKGVudGl0eS5ib2R5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIGJvZHkgPSBlbnRpdHkuYm9keTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBib2R5IGlzIHJlcXVpcmVkLiBpZiBwbGFjZSB3aGVyZSBib2R5IGlzIHN0b3JlZCBjaGFuZ2VkLCB5b3Ugc2hvdWxkIHVwZGF0ZSB0aGlzIGZ1bmN0aW9uXHJcbiAgICAgICAgICAgIHRocm93IFwiQm9keSBvZiB0aGUgaW5zdGFuY2UgaXMgdW5kZWZpbmVkXCJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChlbnRpdHkuaWQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgaWQgPSBlbnRpdHkuaWQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gaWQgaXMgbmVlZGVkLCBpZiBpZCBzeXN0ZW0gY2hhbmdlZCwgYW5kIHlvdSBhcmUgaGVyZSwgdXBkYXRlIHRoaXMgZnVuY3Rpb25cclxuICAgICAgICAgICAgdGhyb3cgXCJUaGVyZSBpcyBubyBpZCBhc3NvY2lhdGVkIHdpdGggdGhpcyBpbnN0YW5jZVwiXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZW50aXR5LnR5cGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSA9IGVudGl0eS50eXBlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGlkIGlzIG5lZWRlZCwgaWYgaWQgc3lzdGVtIGNoYW5nZWQsIGFuZCB5b3UgYXJlIGhlcmUsIHVwZGF0ZSB0aGlzIGZ1bmN0aW9uXHJcbiAgICAgICAgICAgIHRocm93IFwiVGhlcmUgaXMgbm8gdHlwZSBhc3NvY2lhdGVkIHdpdGggdGhpcyBpbnN0YW5jZVwiXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyByZW1vdmUgZ3JhcGhpY3NcclxuICAgICAgICAvL0dyYXBoaWNzQ29udHJvbGxlci5kZXN0cm95X2dyYXBoaWNzX2ZvcihpZCk7XHJcbiAgICAgICAgUmVnaXN0ZXJBc0NvbnRyb2xsZXIucmVnaXN0ZXJfYXMoXCJyZW1vdmVkX2VudGl0eVwiLCBlbnRpdHkpO1xyXG4gICAgICAgIC8vIHJlbW92ZSBwaHlzaWNzXHJcbiAgICAgICAgUGh5c2ljc0NvbnRyb2xsZXIucmVtb3ZlX2JvZHkoYm9keSk7XHJcbiAgICAgICAgLy8gcmVtb3ZlIHN0b3JlZCByZWZlcmVuY2VzIHdpdGhpbiBFbnRpdHlDb250cm9sbGVyL01vZGVsXHJcbiAgICAgICAgZGVsZXRlIEVudGl0eU1vZGVsLmZvcl9sb2dpY191cGRhdGVbdHlwZV1baWRdO1xyXG4gICAgICAgIC8vIGZyZWUgdGhlIGlkXHJcbiAgICAgICAgSWRlbnRpZmljYXRpb25Db250cm9sbGVyLnJlbW92ZV9pZChpZCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbiAoZGVsdGEpIHtcclxuICAgICAgICAvKiBpcyByYW4gZWFjaCB0aWNrIGZyb20gdGhlIEdhbWVDb250cm9sbGVyLnVwZGF0ZV9hbGwgKi9cclxuICAgICAgICB2YXIgZGVidWdfY29tbWFuZHMgPSBLZXlib2FyZENvbnRyb2xsZXIuZGVidWdfY29tbWFuZHMoKTtcclxuXHJcbiAgICAgICAgLy8gZGVtb25zdHJhdGlvbiBwdXJwb3NlcyBmb3IgYW50XHJcbiAgICAgICAgaWYgKGRlYnVnX2NvbW1hbmRzKFwic3Bhd25fYW50XCIpKSB7XHJcbiAgICAgICAgICAgIHZhciBuZXdfYW50ID0gc3Bhd24oV29ybGRDb250cm9sbGVyLmdldF9tb3ZlbWVudF9lZGdlKCkgKyBNYXRoLnJhbmRvbSgpICogNTAsIDEwLCBcImFudFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGRlbW9uc3RyYXRpb24gcHVycG9zZXMgZm9yIGdyaWZmaW5cclxuXHJcbiAgICAgICAgaWYgKGRlYnVnX2NvbW1hbmRzKFwic3Bhd25fZ3JpZmZpblwiKSAmJiBDb3VudCA+IDUpIHtcclxuICAgICAgICAgICAgdmFyIG5ld19ncmlmZmluID0gc3Bhd24oTWF0aC5yYW5kb20oKSAqIDUwICsgV29ybGRDb250cm9sbGVyLmdldF9tb3ZlbWVudF9lZGdlKCksIC0yMCwgXCJHcmlmZmluXCIpO1xyXG4gICAgICAgICAgICBDb3VudCA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIENvdW50Kys7XHJcblxyXG4gICAgICAgIGlmIChkZWJ1Z19jb21tYW5kcyhcInNwYXduX2dyaWZmaW5cIikpIHtcclxuICAgICAgICAgICAgdmFyIG5ld19ncmlmZmluID0gc3Bhd24oTWF0aC5yYW5kb20oKSAqIDUwICsgV29ybGRDb250cm9sbGVyLmdldF9tb3ZlbWVudF9lZGdlKCksIDEwLCBcIkdyaWZmaW5cIik7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgLy8gZGVtb25zdHJhdGlvbiBwdXJwb3NlcyBmb3IgaHllbmFcclxuICAgICAgICBpZiAoZGVidWdfY29tbWFuZHMoXCJzcGF3bl9oeWVuYVwiKSkge1xyXG4gICAgICAgICAgICB2YXIgbmV3X2h5ZW5hID0gc3Bhd24oTWF0aC5yYW5kb20oKSAqIDUwICsgV29ybGRDb250cm9sbGVyLmdldF9tb3ZlbWVudF9lZGdlKCksIDEwLCBcIkh5ZW5hXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yICh2YXIgdHlwZSBpbiBFbnRpdHlNb2RlbC5mb3JfbG9naWNfdXBkYXRlKSB7XHJcbiAgICAgICAgICAgIHZhciB0YWJsZSA9IEVudGl0eU1vZGVsLmZvcl9sb2dpY191cGRhdGVbdHlwZV07XHJcblxyXG4gICAgICAgICAgICB2YXIgbG9naWMgPSB0eXBlX2xvZ2ljX3RhYmxlW3R5cGVdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpZCBpbiB0YWJsZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVudGl0eSA9IHRhYmxlW2lkXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoYmV5b25kX3dvcmxkX2JvdW5kYXJ5KGVudGl0eSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBvdXRzaWRlIGJvdW5kYXJpZXMgb2YgdGhlIHdvcmxkLCBkZXNwYXduXHJcbiAgICAgICAgICAgICAgICAgICAgZGVzcGF3bihlbnRpdHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlbnRpdHkudHlwZSA9PSBcImhlcm9cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHkuaHAgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVudGl0eSBvZiB0eXBlXCIsIHR5cGUsIFwiZGVsZXRlZCBkdWUgdG8gdGhlIHdvcmxkIGJvdW5kYXJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBlbHNlIHRpY2sgaXRzIEFJXHJcbiAgICAgICAgICAgICAgICAgICAgbG9naWMudGlja19BSShlbnRpdHkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gLy8gZW5kIGZvciBpbiBcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBiZXlvbmRfd29ybGRfYm91bmRhcnkgPSBmdW5jdGlvbiAoZW50aXR5KSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgKiBjaGVja3MgaWYgdGhlIGVudGl0eSBpcyBiZXlvbmQgb25lIG9mIHRoZSB3b3JsZCBib3VuZGFyaWVzLFxyXG4gICAgICAgICovXHJcbiAgICAgICAgdmFyIGJvZHkgPSBlbnRpdHkuYm9keTtcclxuICAgICAgICByZXR1cm4gKGJvZHkuR2V0V29ybGRDZW50ZXIoKS54IDwgV29ybGRDb250cm9sbGVyLmdldF9tb3ZlbWVudF9lZGdlKCkgfHxcclxuICAgICAgICAgICAgYm9keS5HZXRXb3JsZENlbnRlcigpLnkgPiBDb25maWcuV29ybGQubWF4eSk7XHJcblxyXG4gICAgfTtcclxuXHRcdFxyXG5cdFx0XHJcblx0XHR2YXIgY3JlYXRlX2Fic3RyYWN0X2VudGl0eSA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHJldHVybiBuZXcgQWJzdHJhY3RFbnRpdHkoKTtcclxuXHRcdH07XHJcblx0XHRcclxuXHRcdFxyXG5cdHZhciBnZXRfYWxsX2hlcm9lcyA9IGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gezA6RW50aXR5TW9kZWwuaGVyb307XHJcblx0fTtcclxuXHRcclxuXHR2YXIgZ2V0X215X2hlcm8gPSBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIEVudGl0eU1vZGVsLmhlcm87XHJcblx0fTtcclxuXHRcclxuXHR2YXIgbG9hZF9oZXJvID0gZnVuY3Rpb24oaWQpe1xyXG5cdFx0RW50aXR5TW9kZWwuaGVybyA9IElkZW50aWZpY2F0aW9uQ29udHJvbGxlci5nZXRfYnlfaWQoaWQpO1xyXG5cdH1cclxuXHRcclxuXHR2YXIgaGFuZGxlX2hlcm9fc3luYyA9IGZ1bmN0aW9uKCl7fTtcclxuXHRcclxuXHR2YXIgaGFuZGxlX2RlbGV0ZSA9IGZ1bmN0aW9uKCl7fTtcclxuXHRcclxuXHR2YXIgaGFuZGxlX3NwYXduID0gZnVuY3Rpb24oKXt9O1xyXG5cdFxyXG5cdHZhciByZWdfZm9yX2xvZ2ljX3VwZGF0ZSA9IGZ1bmN0aW9uKCl7fTtcclxuXHRcclxuXHQvKipcclxuXHREb2N1bWVudGF0aW9uIHdpbGwgYmUgaGVyZSwgc29tZWRheVxyXG5cdCovXHJcblx0dGhpcy5BYnN0cmFjdEVudGl0eSA9IGZ1bmN0aW9uKCl7XHJcblx0XHR0aGlzLmhwID0gMjtcclxuXHRcdHRoaXMuc3BlZWQgPSA3O1xyXG5cdFx0dGhpcy5qdW1wX2ZvcmNlID0gMTI1O1xyXG5cdFx0dGhpcy5kYW1hZ2UgPSA1O1xyXG5cdFx0dGhpcy5wb2ludF92YWx1ZSA9IDIwMDtcclxuXHRcdHRoaXMuc2lnaHRfcmFuZ2UgPSAxNjsgLy9kaXN0YW5jZSBhdCB3aGljaCBlbnRpdHkgZGV0ZWN0cyBoZXJvZXNcclxuXHRcdHRoaXMuYXR0YWNrX3JhbmdlID0gODsgLy9kaXN0YW5jZSBhdCB3aGljaCBlbnRpdHkgbGVhcHMgYXQgdGhlIGhlcm9cclxuXHRcdFxyXG5cdFx0dGhpcy5oaXRfdGFrZW4gPSBmYWxzZTsgLy93aGV0aGVyIGEgaGl0IGhhcyBiZWVuIHRha2VuIHNpbmNlIHRoZSBsYXN0IHRpY2tcclxuXHRcdHRoaXMuZGFtYWdlX3Rha2VuID0gMDsgLy90aGUgYW1vdW50IG9mIGRhbWFnZSBpbmZsaWN0ZWQgYnkgaGl0cyBzaW5jZSB0aGUgbGFzdCB0aWNrXHJcblx0XHRcclxuXHRcdHRoaXMuZGlyZWN0aW9uID0gZmFsc2U7XHQvL2ZhbHNlPWxlZnQsIHRydWU9cmlnaHQ7XHJcblx0XHR0aGlzLmRpcmVjdGlvbl9wcmV2aW91cyA9IGZhbHNlOy8vc3RvcmUgZGlyZWN0aW9uIGZyb20gZW5kIG9mIHByZXZpb3VzIHRpY2tcclxuXHRcdHRoaXMueF9wcmV2aW91cyA9IDA7XHRcdC8vc3RvcmUgeCB2YWx1ZSBmcm9tIGVuZCBvZiBwcmV2aW91cyB0aWNrXHJcblx0XHRcclxuXHRcdHRoaXMuaXNfaWRsZSA9IHRydWU7IC8vZGV0ZXJtaW5lcyB3aGV0aGVyIGVudGl0eSBpcyBhZ2dyZXNzaXZlIG9yIGlkbGVcclxuXHRcdHRoaXMuaWRsZV9kdXJhdGlvbiA9IDQwOyAvLyB0aW1lIGJ1ZmZlciBiZXR3ZWVuIGNoYW5naW5nIGlkbGUgc3RhdGVzXHJcblx0XHR0aGlzLmlkbGVfdGltZXIgPSB0aGlzLmlkbGVfZHVyYXRpb247XHJcblx0XHR0aGlzLmlkbGVfY291bnRlciA9IDA7IC8vdXNlZCB0byBtYW5hZ2UgdGhlIG51bWJlciBvZiB0aW1lcyB0aGUgZW50aXR5IGhhcyBjaGFuZ2VkIHN0YXRlIHdoaWxlIGlkbGVcclxuXHRcdHRoaXMuaXNfYWxpdmUgPSB0cnVlOyAvL2Rpc2FibGVzIGF0dGFja2luZyBhbmQgcGxheXMgZGVhdGggYW5pbWF0aW9uIHdoaWxlIGZhbHNlXHJcblx0XHR0aGlzLmRlYXRoX2R1cmF0aW9uID0gMzA7Ly90aW1lIGJldHdlZW4gZGVhdGggYW5kIGRlbGV0aW9uXHJcblx0XHR0aGlzLmRlY2F5X2R1cmF0aW9uID0gMjA7Ly90aW1lIGJldHdlZW4gZGVjYXkgYW5pbWF0aW9uIGFuZCBkZWxldGlvblxyXG5cdFx0dGhpcy5kZWF0aF90aW1lciA9IC0xO1xyXG5cdFx0dGhpcy5ydW5uaW5nX2F3YXkgPSBmYWxzZTsgLy93aGV0aGVyIHRoZSBlbnRpdHkgaXMgcnVubmluZyBhd2F5XHJcblx0XHR0aGlzLnJ1bl9hd2F5X2R1cmF0aW9uID0gMzA7IC8vc2V0IGNvd2FyZGljZSBsZXZlbFxyXG5cdFx0dGhpcy5ydW5fYXdheV90aW1lciA9IC0xO1xyXG5cdFx0dGhpcy5jYW5fYXR0YWNrID0gdHJ1ZTtcdC8vd2hldGhlciBhdHRhY2tpbmcgaXMgZW5hYmxlZFxyXG5cdFx0dGhpcy5hdHRhY2tfY29vbGRvd24gPSAxMDsgLy9hdHRhY2sgY29vbGRvd25cclxuXHRcdHRoaXMuYXR0YWNrX2Nvb2xkb3duX3RpbWVyID0gLTE7XHJcblx0XHR0aGlzLmNhbl9sZWFwID0gdHJ1ZTtcdFx0Ly9sZWFwaW5nIGVuYWJsZWRcclxuXHRcdHRoaXMubGVhcF9jb29sZG93biA9IDQwOy8vbWluaW11bSB0aW1lIGJldHdlZW4gbGVhcHNcclxuXHRcdHRoaXMubGVhcF9jb29sZG93bl90aW1lciA9IC0xOyBcclxuXHRcdHRoaXMuY2hhcmdlX2R1cmF0aW9uID0gODA7Ly9tYXhpbXVtIGxlbmd0aCBvZiBhIGNoYXJnZVxyXG5cdFx0dGhpcy5jaGFyZ2VfdGltZXIgPSB0aGlzLmNoYXJnZV9kdXJhdGlvbjtcclxuXHRcdHRoaXMuY2hhcmdlX2Nvb2xkb3duID0gMjA7Ly9taW5pbXVtIHRpbWUgYmV0d2VlbiBjaGFyZ2VzXHJcblx0XHR0aGlzLmNoYXJnZV9jb29sZG93bl90aW1lciA9IC0xO1xyXG5cdFx0dGhpcy5ibGlua2luZyA9IGZhbHNlO1x0Ly93aGV0aGVyIGVudGl0eSBpcyBibGlua2luZ1xyXG5cdFx0dGhpcy5ibGlua19kdXJhdGlvbiA9IDIwOy8vaG93IGxvbmcgdGhlIGVudGl0eSBibGlua3MgYWZ0ZXIgdGFraW5nIGRhbWFnZVxyXG5cdFx0dGhpcy5ibGlua190aW1lciA9IC0xO1xyXG5cdFx0dGhpcy5tYWludGVuYW5jZV9mcmVxdWVuY3kgPSAyMDsvL3RpY2tzIGJldHdlZW4gcm91dGluZSBtYWludGVuYW5jZSBjaGVja3NcclxuXHRcdHRoaXMubWFpbnRlbmFuY2VfdGltZXIgPSB0aGlzLm1haW50ZW5hbmNlX2ZyZXF1ZW5jeTtcclxuXHRcdFxyXG5cdFx0dGhpcy5wYXRoX2Jsb2NrZWQgPSBmYWxzZTsvL2lzIHRoaXMgZGVwcmVjYXRlZD8gc2V0IGR1cmluZyBjb2xsaXNpb25cclxuXHRcdHRoaXMub2JzdHJ1Y3Rpb25fdG9sZXJhbmNlID0gNDsvL2hvdyBtYW55IHRpbWVzIHRoZSBlbnRpdHkgY2FuIGJlIGJsb2NrZWQgYmVmb3JlIGhlIHRha2VzIGFjdGlvblxyXG5cdFx0dGhpcy5ibG9ja2VkX2NvdW50ID0gMDsvL3RyYWNrcyBudW1iZXIgb2YgdGltZXMgYmxvY2tlZCBiZXR3ZWVuIG1haW50ZW5hbmNlIGNoZWNrc1xyXG5cdFx0XHJcblx0XHR0aGlzLm5lZWRzX2dyYXBoaWNzX3VwZGF0ZSA9IGZhbHNlOyAvL2FjY2Vzc2VkIGJ5IHJlbmRlcmVyIGZvciBhbmltYXRpb24gcHVycG9zZXNcclxuXHRcdHRoaXMuYW5pbWF0aW9uID0gXCJzdGFuZFwiOyAvL2FjY2Vzc2VkIGJ5IHJlbmRlcmVyIGZvciBhbmltYXRpb24gcHVycG9zZXNcclxuXHRcdFxyXG5cdFx0dGhpcy5qdW1wID0gZnVuY3Rpb24oZW50aXR5KXtcclxuXHRcdFx0QXBwbHlJbXB1bHNlKG5ldyBCMmQuYjJWZWMyKCgyKmVudGl0eS5qdW1wX2ZvcmNlKmVudGl0eS5kaXJlY3Rpb24pIC0gZW50aXR5Lmp1bXBfZm9yY2UsIC0xKmVudGl0eS5qdW1wX2ZvcmNlLzIpLCBib2R5LkdldFdvcmxkQ2VudGVyKCkpO1xyXG5cdFx0fTtcclxuXHRcdFxyXG5cdFx0dGhpcy5tb3ZlID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyIGRpciA9ICh0aGlzLmRpcmVjdGlvbioyLTEpO1xyXG5cdFx0XHR2YXIgdmVsb2NpdHkgPSB0aGlzLmJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKTtcclxuXHRcdFx0dmVsb2NpdHkueCA9IHRoaXMuc3BlZWQqZGlyOyAvL21vdmUgc3BlZWQgaW4gY3VycmVudCBkaXJlY3Rpb25cclxuXHRcdFx0dGhpcy5ib2R5LlNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5KTtcclxuXHRcdH07XHJcblx0XHRcdFxyXG5cdFx0Ly9jaGVjayBmb3IgZW5lbWllcyBpbiByYW5nZSAodmlzaW9uIG9yIGp1bXApXHJcblx0XHR0aGlzLmVuZW15X2luX3JhbmdlID0gZnVuY3Rpb24ocmFuZ2Upe1xyXG5cdFx0XHR2YXIgb3V0cHV0ID0gZmFsc2U7XHJcblx0XHRcdC8qXHJcblx0XHRcdC8vbXVsdGlwbGF5ZXIgaW1wbGVtZW50YXRpb25cclxuXHRcdFx0dmFyIGhlcm9fbGlzdCA9IFtdO1xyXG5cdFx0XHRcclxuXHRcdFx0Zm9yIChpPTA7aTxoZXJvX2xpc3QubGVuZ3RoO2krKyl7XHJcblx0XHRcdFx0aWYoaW4gcmFuZ2Upe1xyXG5cdFx0XHRcdG91dHB1dCA9IHRydWU7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBvdXRwdXQ7XHJcblx0XHRcdCovXHJcblx0XHRcdHZhciBoZXJvX3ggPSBFbnRpdHlDb250cm9sbGVyLmdldF9teV9oZXJvKCkuYm9keS5HZXRXb3JsZENlbnRlcigpLng7XHJcblx0XHRcdG91dHB1dCA9IChNYXRoLmFicyhoZXJvX3ggLSB0aGlzLmJvZHkuR2V0V29ybGRDZW50ZXIoKS54KSA8IHJhbmdlKTtcclxuXHRcdFx0cmV0dXJuIG91dHB1dDtcclxuXHRcdH07XHJcblx0XHRcclxuXHRcdC8vcmV0dXJucyB0aGUgZGlyZWN0aW9uIG9mIG5lYXJlc3QgZW5lbXlcclxuXHRcdHRoaXMuZGlyZWN0aW9uX25lYXJlc3RfZW5lbXkgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHQvKi8vaW4gbXVsdGlwbGF5ZXIsIGZpcnN0IGZpbmQgbmVhcmVzdCBlbmVteVxyXG5cdFx0XHR2YXIgbmVhcmVzdCA9IGhlcm9bMF07XHJcblx0XHRcdGZvcihpIDwgOCl7XHJcblx0XHRcdFx0aWYodHlwZW9mIGhlcm9baV0gIT09ICd1bmRlZmluZWQnKXtcclxuXHRcdFx0XHRcdGlmKGRpc3RhbmNlX2Zvcm11bGEoaGVyb1tpXSx0aGlzKSA8IGRpc3RhbmNlX2Zvcm11bGEobmVhcmVzdCx0aGlzKSl7XHJcblx0XHRcdFx0XHRcdG5lYXJlc3QgPSBoZXJvW2ldO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSovXHJcblx0XHRcdHZhciBuZWFyZXN0O1xyXG5cdFx0XHR2YXIgaGVyb194ID0gRW50aXR5Q29udHJvbGxlci5nZXRfbXlfaGVybygpLmJvZHkuR2V0V29ybGRDZW50ZXIoKS54O1xyXG5cdFx0XHR2YXIgZGlzdGFuY2UgPSAoaGVyb194IC0gdGhpcy5ib2R5LkdldFdvcmxkQ2VudGVyKCkueCk7XHJcblx0XHRcdHJldHVybiAoZGlzdGFuY2UgPiAwKTsvL3JldHVybiB0cnVlL3JpZ2h0IG9mIGRpc3RhbmNlIGlzIHBvc2l0aXZlLCByZXR1cm4gZmFsc2UvbGVmdCBpZiBkaXN0YW5jZSBpcyBuZWdhdGl2ZVxyXG5cdFx0fTtcclxuXHRcdFxyXG5cdFx0Ly9kZWNyZWFzZSBoZWFsdGhcclxuXHRcdHRoaXMudGFrZV9kYW1hZ2UgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHR0aGlzLmhwIC09IHRoaXMuZGFtYWdlX3Rha2VuO1xyXG5cdFx0XHR0aGlzLmRhbWFnZV90YWtlbiA9IDA7XHJcblx0XHRcdHRoaXMuaGl0X3Rha2VuID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuYmxpbmtpbmcgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLmJsaW5rX3RpbWVyID0gdGhpcy5ibGlua19kdXJhdGlvbjtcclxuXHRcdFx0Ly9rbm9ja2JhY2sgaGVyZVxyXG5cdFx0fTtcclxuXHRcdFxyXG5cdFx0Ly9kaWVcclxuXHRcdHRoaXMuZGllID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYgKHRoaXMuaXNfYWxpdmUpey8vaWYgYWxpdmUsIGtpbGwgaXRcclxuXHRcdFx0XHR0aGlzLmRlYXRoX3RpbWVyID0gdGhpcy5kZWF0aF9kdXJhdGlvbjtcclxuXHRcdFx0XHR0aGlzLmlzX2FsaXZlID0gZmFsc2U7XHJcblx0XHRcdFx0V29ybGRDb250cm9sbGVyLmluY3JlYXNlX3Njb3JlKHRoaXMucG9pbnRfdmFsdWUpO1xyXG5cdFx0XHRcdHRoaXMuaGl0X3Rha2VuID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5jYW5fYXR0YWNrID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5jaGFuZ2VfYW5pbWF0aW9uKHRoaXMsXCJkZWF0aFwiKTtcclxuXHRcdFx0XHRyZXR1cm4gO1xyXG5cdFx0XHR9ZWxzZXsvL2Vsc2UgZGVjYXlcclxuXHRcdFx0XHR0aGlzLmRlYXRoX3RpbWVyLS07XHJcblx0XHRcdFx0aWYgKHRoaXMuZGVhdGhfdGltZXIgPD0gdGhpcy5kZWF0aF9kdXJhdGlvbiAmJiB0aGlzLmRlYXRoX3RpbWVyID4gdGhpcy5kZWNheV9kdXJhdGlvbiAmJiB0aGlzLmRlYXRoX3RpbWVyID4gMCl7XHJcblx0XHRcdFx0XHR0aGlzLmNoYW5nZV9hbmltYXRpb24oXCJkZWF0aFwiKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKHRoaXMuZGVhdGhfdGltZXIgPD0gdGhpcy5kZWNheV9kdXJhdGlvbiAmJiB0aGlzLmRlYXRoX3RpbWVyID4gMCl7XHJcblx0XHRcdFx0XHR0aGlzLmNoYW5nZV9hbmltYXRpb24oXCJkZWNheVwiKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0RW50aXR5Q29udHJvbGxlci5kZWxldGVfZW50aXR5KHRoaXMpOy8vcmVtb3ZlIGluc3RhbmNlIGZyb20gbWVtb3J5XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvL3Rha2VzIGEgc3RyaW5nIGFzIHBhcmFtZXRlcnMuIHJldHVybnMgdGhlIGZpeHR1cmUgd2l0aCBmaXh0dXJlX25hbWUgPT0gbmFtZSwgb3IgbnVsbCBpZiBpdCBkb2VzIG5vdCBleGlzdFxyXG5cdFx0dGhpcy5nZXRfZml4dHVyZSA9IGZ1bmN0aW9uKG5hbWUpe1xyXG5cdFx0XHR2YXIgY3VycmVudF9maXh0dXJlID0gdGhpcy5ib2R5LkdldEZpeHR1cmVMaXN0KCk7XHJcblx0XHRcdHdoaWxlIChjdXJyZW50X2ZpeHR1cmUgIT0gbnVsbCl7XHJcblx0XHRcdFx0aWYgKGN1cnJlbnRfZml4dHVyZS5HZXRVc2VyRGF0YSgpICE9IG51bGwpe1xyXG5cdFx0XHRcdFx0aWYgKGN1cnJlbnRfZml4dHVyZS5HZXRVc2VyRGF0YSgpLm5hbWUgPT0gbmFtZSl7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjdXJyZW50X2ZpeHR1cmUgPSBjdXJyZW50X2ZpeHR1cmUuR2V0TmV4dCgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChjdXJyZW50X2ZpeHR1cmUuR2V0VXNlckRhdGEoKSA9PSBudWxsKXtcclxuXHRcdFx0XHRjdXJyZW50X2ZpeHR1cmUgPSBudWxsO1xyXG5cdFx0XHR9ZWxzZSBpZiAoY3VycmVudF9maXh0dXJlLkdldFVzZXJEYXRhKCkubmFtZSAhPSBuYW1lKXtcclxuXHRcdFx0XHRjdXJyZW50X2ZpeHR1cmUgPSBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBjdXJyZW50X2ZpeHR1cmU7XHJcblx0XHR9O1xyXG5cdFx0XHJcblx0XHQvL2NoZWNrcyBpZiBtb3ZlbWVudCBpcyB2b2x1bnRhcnkgb3IgZm9yY2VkXHJcblx0XHR0aGlzLm1vdmVtZW50X3ZvbHVudGFyeSA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdC8vaWYgZGlyZWN0aW9uIGJlaW5nIGZhY2VkIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBkaXJlY3Rpb24gbW92aW5nLCByZXR1cm4gZmFsc2VcclxuXHRcdFx0dmFyIG91dHB1dCA9IHRydWU7XHJcblx0XHRcdHZhciB2ZWxvY2l0eSA9IHRoaXMuYm9keS5HZXRMaW5lYXJWZWxvY2l0eSgpLng7XHJcblx0XHRcdGlmKHZlbG9jaXR5ICE9IDApe1xyXG5cdFx0XHRcdG91dHB1dCA9ICh2ZWxvY2l0eS9NYXRoLmFicyh2ZWxvY2l0eSkgPT0gKHRoaXMuZGlyZWN0aW9uKSoyLTEpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBvdXRwdXQ7XHJcblx0XHR9O1xyXG5cclxuXHRcdC8vY2hlY2tzIGlmIGluIHRoZSBhaXJcclxuXHRcdHRoaXMuaW5fYWlyID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyIGJvZHkgPSB0aGlzLmJvZHk7XHJcblx0XHRcdHZhciBvYmplY3RzX2JlbmVhdGg7XHJcblx0XHRcdGlmIChib2R5LkdldEZpeHR1cmVMaXN0KCkgIT0gbnVsbCl7Ly9wcmV2ZW50IGJ1Z3Mgb24gZGVzdHJ1Y3Rpb25cclxuXHRcdFx0XHR2YXIgQUFCQiA9IGJvZHkuR2V0Rml4dHVyZUxpc3QoKS5HZXROZXh0KCkuR2V0TmV4dCgpLkdldEFBQkIoKTtcclxuXHRcdFx0XHRvYmplY3RzX2JlbmVhdGggPSBQaHlzaWNzQ29udHJvbGxlci5xdWVyeV9hYWJiKEFBQkIpO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRvYmplY3RzX2JlbmVhdGggPSAwO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiAob2JqZWN0c19iZW5lYXRoIDwgNSk7Ly9mb3Igc29tZSBteXN0ZXJpb3VzIHJlYXNvbiwgaXQgY291bnRzIDQgY29sbGlzaW9ucyBldmVuIGluIG1pZCBhaXJcclxuXHRcdH07XHJcblxyXG5cdFx0Ly9jaGVja3MgaWYgdGhlcmUgaXMgYSBjb2xsaXNpb24gaW4gY3VycmVudCBkaXJlY3Rpb25cclxuXHRcdHRoaXMucGF0aF9mcmVlID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyIGJvZHkgPSB0aGlzLmJvZHk7XHJcblx0XHRcdHZhciBvYmplY3RzX2JlZm9yZTtcclxuXHRcdFx0dmFyIEFBQkI7XHJcblx0XHRcdGlmIChib2R5LkdldEZpeHR1cmVMaXN0KCkgIT0gbnVsbCl7Ly9wcmV2ZW50IGJ1Z3Mgb24gZGVzdHJ1Y3Rpb25cclxuXHRcdFx0XHRpZiAodGhpcy5kaXJlY3Rpb24pe1xyXG5cdFx0XHRcdFx0QUFCQiA9IGJvZHkuR2V0Rml4dHVyZUxpc3QoKS5HZXRBQUJCKCk7XHJcblx0XHRcdFx0XHRvYmplY3RzX2JlZm9yZSA9IFBoeXNpY3NDb250cm9sbGVyLnF1ZXJ5X2FhYmIoQUFCQik7XHJcblx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHRBQUJCID0gYm9keS5HZXRGaXh0dXJlTGlzdCgpLkdldE5leHQoKS5HZXRBQUJCKCk7XHJcblx0XHRcdFx0XHRvYmplY3RzX2JlZm9yZSA9IFBoeXNpY3NDb250cm9sbGVyLnF1ZXJ5X2FhYmIoQUFCQik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRvYmplY3RzX2JlZm9yZSA9IDA7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIChvYmplY3RzX2JlZm9yZSA8IDQpOy8vYXNzdW1lcyBjb250YWN0IHdpdGggYm90dG9tIHNlbnNvciwgdG9wIHNlbnNvciwgYW5kIG1haW4gc2hhcGUgXHJcblx0XHR9O1xyXG5cclxuXHRcdC8vc2V0dGVyIGZvciBhbmltYXRpb24gdmFyaWFibGUsIGVuc3VyZXMgdGhlIGFuaW1hdGlvbiBpcyBvbmx5IHJlc2V0IG9uIGFjdHVhbCBjaGFuZ2VcclxuXHRcdHRoaXMuY2hhbmdlX2FuaW1hdGlvbiA9IGZ1bmN0aW9uKG5ld19hbmltYXRpb24pe1xyXG5cdFx0XHRpZih0aGlzLmFuaW1hdGlvbiAhPSBuZXdfYW5pbWF0aW9uKXtcclxuXHRcdFx0XHR0aGlzLmFuaW1hdGlvbiA9IG5ld19hbmltYXRpb247XHJcblx0XHRcdFx0dGhpcy5uZWVkc19ncmFwaGljc191cGRhdGUgPSB0cnVlO1xyXG5cdFx0XHR9ZWxzZXsgXHJcblx0XHRcdFx0dGhpcy5uZWVkc19ncmFwaGljc191cGRhdGUgPSBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9O1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0dXBkYXRlOiB1cGRhdGUsXHJcblx0XHQvL2dldF9vcGVyYXRpb246IGdldF9vcGVyYXRpb24sXHJcblx0XHRyZWdfZm9yX2xvZ2ljX3VwZGF0ZTogcmVnX2Zvcl9sb2dpY191cGRhdGUsXHJcblx0XHRzcGF3bjogc3Bhd24sXHJcblx0XHRkZWxldGVfZW50aXR5OiBkZWxldGVfZW50aXR5LFxyXG5cdFx0Ly9mdWxmaWxsX2RlbGV0ZV9yZXF1ZXN0OiBmdWxmaWxsX2RlbGV0ZV9yZXF1ZXN0LFxyXG5cdFx0aGFuZGxlX3NwYXduOiBoYW5kbGVfc3Bhd24sXHJcblx0XHRoYW5kbGVfZGVsZXRlOiBoYW5kbGVfZGVsZXRlLFxyXG5cdFx0aGFuZGxlX2hlcm9fc3luYzogaGFuZGxlX2hlcm9fc3luYyxcclxuXHRcdGdldF9hbGxfaGVyb2VzOiBnZXRfYWxsX2hlcm9lcyxcclxuXHRcdGdldF9teV9oZXJvOiBnZXRfbXlfaGVybyxcclxuXHRcdGNyZWF0ZV9hYnN0cmFjdF9lbnRpdHk6IGNyZWF0ZV9hYnN0cmFjdF9lbnRpdHksXHJcblx0XHRsb2FkX2hlcm86IGxvYWRfaGVybyxcclxuICAgIH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEVudGl0eUNvbnRyb2xsZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuICAgIGN1cnJlbnRfbW9kdWxlOiBcIkVudGl0eUNvbnRyb2xsZXJcIixcclxuICAgIGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUIHwgSW5jbHVkZXMuY2hvaWNlcy5MT0dJQ1xyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbiAoKSB7IGV2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTsgfSIsIlxyXG5cclxudmFyIEdhbWVDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcclxuXHRcdGluY2x1ZGUoKTtcclxuXHR9O1xyXG5cdFx0XHJcblxyXG5cdHZhciB1cGRhdGVfYWxsID0gZnVuY3Rpb24oZXZlbnQpe1xyXG5cdFx0LypcclxuXHRcdCAqIG1haW4gZnVuY3Rpb24gcHJldHR5IG11Y2hcclxuXHRcdCAqIGV2ZXJ5Z2hpbmcgZWxzZSBpcyBjYWxsZWQgZnJvbSBoZXJlIGV2ZXJ5IHRpY2tcclxuXHRcdCAqL1xyXG5cdCAgICB2YXIgY21kcyA9IEtleWJvYXJkQ29udHJvbGxlci5wYXVzZV9jb21tYW5kcygpO1xyXG5cdCAgICBpZiAoY21kcyhcInBhdXNlXCIpICYmIEdhbWVNb2RlbC5wYXVzZUNvdW50ZXIgPiAxMCAmJiBHcmFwaGljc0NvbnRyb2xsZXIuZ2V0X2hlYWx0aCgpID4gMCkge1xyXG5cdCAgICAgICAgY3JlYXRlanMuVGlja2VyLnBhdXNlZCA9ICFjcmVhdGVqcy5UaWNrZXIucGF1c2VkO1xyXG5cdCAgICAgICAgR2FtZU1vZGVsLnBhdXNlQ291bnRlciA9IDA7XHJcblx0ICAgICAgICBjb25zb2xlLmxvZyhcInBhdXNlXCIpO1xyXG5cdCAgICB9XHJcblx0ICAgIEdhbWVNb2RlbC5wYXVzZUNvdW50ZXIgKz0gMTtcclxuXHRcdFxyXG5cdFx0aWYgKCFjcmVhdGVqcy5UaWNrZXIucGF1c2VkKXtcclxuXHRcdFx0dmFyIGRlbHRhID0gZXZlbnQuZGVsdGE7XHJcblxyXG5cdFx0XHQvLyAhISEhIHdvcmxkIHNpbXVsYXRpb24gc3RlcCBnb2VzIHNvbWV3aGVyZSByaWdodCBoZXJlXHJcblx0XHRcdC8vIGFzIHBlciBjdXJyZW50IGRlc2lnbiwgd2lsbCB0YWtlIGRlbHRhIGFzIGFuIGFyZ3VtZW50XHJcblx0XHRcclxuXHRcdFx0Ly9UZXJyYWluQ29udHJvbGxlci5nZW5lcmF0ZV90ZXJyYWluKCk7IFxyXG5cdFx0XHQvL1BsYXllckNvbnRyb2xsZXIudXBkYXRlKCk7XHJcblx0XHRcclxuXHRcdFx0V29ybGRDb250cm9sbGVyLnVwZGF0ZShkZWx0YSk7XHJcblxyXG5cdFx0XHRUZXJyYWluQ29udHJvbGxlci51cGRhdGUoKTtcclxuXHRcdFx0RW50aXR5Q29udHJvbGxlci51cGRhdGUoKTtcclxuXHJcblx0XHRcdC8vIFNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgYWxsIG1vdmVtZW50IG9mIG9iamVjdHMgaXMgZG9uZTpcclxuXHRcdFx0SFVEQ29udHJvbGxlci51cGRhdGUoKTtcclxuXHRcdFx0Ly9CYWNrZ3JvdW5kQ29udHJvbGxlci51cGRhdGUoKTtcclxuXHRcdFx0R3JhcGhpY3NDb250cm9sbGVyLnVwZGF0ZSgpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0aW5pdDogaW5pdCxcclxuXHRcdHVwZGF0ZV9hbGw6IHVwZGF0ZV9hbGwsXHJcblx0fTtcclxuXHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVDb250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiR2FtZUNvbnRyb2xsZXJcIiwgXHJcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFRcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwiLypcclxuR3JhcGhpY3NDb250cm9sbGVyXHJcblx0UHVibGljIEZ1bmN0aW9uczpcclxuXHQtaW5pdCgpXHJcblx0XHRzZXRzIHVwIHRoZSBHcmFwaGljc0NvbnRyb2xsZXIgZm9yIHRoZSByZXN0IG9mIHRoZSBnYW1lLCBjYWxsZWQgb25jZSBkdXJpbmcgaW5pdGlhbGl6YXRpb25cclxuXHQtdXBkYXRlKGludCBkZWx0YSlcclxuXHRcdGNvbW1vbiBmdW5jdGlvbiwgY2FsbGVkIGVhY2ggdGljay4gcGVyZm9ybXMgcm91dGluZSBncmFwaGljcyBtYWludGVuYW5jZVxyXG5cdFx0cmVnaXN0ZXJzIGFsbCBpbnN0YW5jZXMgdGhhdCB3ZXJlIG1hcmtlZCBmb3IgcmVnaXN0cmF0aW9uIHNpbmNlIHRoZSBsYXN0IHRpY2tcclxuXHRcdHJlbmRlcnMgYWxsIHJlZ2lzdGVyZWQgaW5zdGFuY2VzXHJcblx0LWdldF9zdGFnZSgpXHJcblx0XHRyZXR1cm5zIHRoZSBzdGFnZSBvYmplY3QsIGFuIGVhc2VsanMgb2JqZWN0IHRoYXQgc3RvcmVzIGluZm9ybWF0aW9uIGFib3V0IHRoZSBnYW1lXHJcblx0LWdldF9jYW1lcmEoKVxyXG5cdFx0cmV0dXJucyB0aGUgY2FtZXJhIG9iamVjdCwgd2hpY2ggY29udHJvbHMgdGhlIHZpZXcgb2Zmc2V0XHJcblx0LWdldF9hc3NldChzdHJpbmcgaWQpXHJcblx0XHRyZXRyaWV2ZXMgdGhlIGFzc2V0IHdpdGggaWQ7IGFuIGFsaWFzIGZvciB0aGUgc2FtZSBmdW5jdGlvbiBpbiBBc3NldENvbnRyb2xsZXJcclxuXHQtcmVnX2Zvcl9yZW5kZXIoRWFzZWxqc19vYmogc3ByaXRlLCBPYmplY3QgZW50aXR5X2luc3RhbmNlKVxyXG5cdFx0bGlua3MgYW4gZW50aXR5IHdpdGggYSBzcHJpdGUgYW5kIHJlZ2lzdGVycyBpdCB0byBiZSByZW5kZXJlZCBlYWNoIHRpY2tcclxuXHQtc2V0X3JlZ19wb3NpdGlvbihlYXNlbGpzX29iaixpbnQgb2Zmc2V0X3gsaW50IG9mZnNldF95KVxyXG5cdFx0YWRqdXN0cyBhIHNwcml0ZXMgeCBhbmQgeSBvZmZzZXRzIHRvIGNvbmZvcm0gdG8gdGhlIGJveDJkIHN5c3RlbVxyXG5cdC1yZXF1ZXN0X2JpdG1hcChzdHJpbmc/IGlkKVxyXG5cdFx0cmV0cmlldmVzIGEgcHJldmlvdXNseSBsb2FkZWQgYXNzZXQgYXMgYSBzcHJpdGVcclxuXHQtcmVxdWVzdF9hbmltYXRlZChzdHJpbmcgaWQsIHN0cmluZ3x8aW50IHN0YXJ0X2FuaW1hdGlvbi9zdGFydF9mcmFtZSlcclxuXHRcdHJldHVybnMgYSBuZXcgc3ByaXRlIG9iamVjdCBnZW5lcmF0ZWQgZnJvbSB0aGUgaW1hZ2UgaWQgYW5kIHRoZSBzdGFydCBmcmFtZVxyXG5cdC1kZXN0cm95X2dyYXBoaWNzX2ZvcihpbnQgaWQpXHJcblx0XHRkZXN0cm95cyB0aGUgZ3JhcGhpY3Mgb2JqZWN0cyBhc3NvY2lhdGVkIHdpdGggdGhlIGluc3RhbmNlIG9mIHRoZSBwYXNzZWQgaWRcclxuXHQtZm9sbG93KGludCBpZClcclxuXHRcdHNldHMgdGhlIGNhbWVyYSB0byBmb2xsb3cgdGhlIG9iamVjdCBvZiB0aGUgcGFzc2VkIGlkXHJcblx0LWdldF9tb3ZlbWVudF9lZGdlKClcclxuXHRcdHJldHVybnMgbGVmdCBjYW1lcmEgYm91bmQsIGEuay5hLCB0aGUgbW92ZW1lbnQgZWRnZS4gdXNlZCBmb3IgbG90cyBvZiB0aGluZ3NcclxuXHRcdFxyXG4qL1xyXG52YXIgR3JhcGhpY3NDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0LyogXHJcblx0Q29udHJvbHMgYWxsIGdyYXBoaWNzIGFuZCBwcm92aWRlcyBhbiBpbnRlcmZhY2UgZm9yIGNvbW1vbiBlYXNlbC5qcyBmdW5jdGlvbnNcclxuXHQqL1xyXG5cdFxyXG5cdHZhciBnZXRfYXNzZXQ7IFxyXG5cdHZhciB0eXBlX3JlbmRlcmVyX3RhYmxlO1xyXG5cdHZhciBQcml2YXRlR3JhcGhpY3M7IFxyXG5cdHZhciByZVJlbmRlciA9IGZhbHNlO1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiBpcyByYW4gZnJvbSB0aGUgSW5pdENvbnRyb2xsZXIgb25jZSB3aGVuIHRoZSBnYW1lIGlzIGxvYWRlZCAqL1xyXG5cdFx0aW5jbHVkZSgpOyAvLyBzYXRpc2Z5IHJlcXVpcmVtZW50c1xyXG5cclxuXHRcdC8vQWxsIHJlbmRlcmVycyBtdXN0IGJlIHJlZ2lzdGVyZWQgaGVyZVxyXG5cdFx0Ly9MaW5rcyBlYWNoIHJlbmRlcmVyIHdpdGggaXRzIG9iamVjdCBpZFxyXG5cdFx0dHlwZV9yZW5kZXJlcl90YWJsZSA9IHtcclxuXHRcdC8vIHR5cGU6XHRyZW5kZXJlcjpcclxuXHRcdFx0XCJhbnRcIjogQW50UmVuZGVyZXIsXHJcblx0XHRcdFwiaGVyb1wiOiBIZXJvUmVuZGVyZXIsXHJcblx0XHRcdFwiR3JpZmZpblwiOkdyaWZmaW5SZW5kZXJlcixcclxuXHRcdFx0XCJIeWVuYVwiOiBIeWVuYVJlbmRlcmVyLFxyXG5cdFx0XHRcInRlcnJhaW5fY2VsbFwiOiBUZXJyYWluQ2VsbFJlbmRlcmVyLFxyXG5cdFx0XHRcInRlcnJhaW5fc2xpY2VcIjogVGVycmFpblNsaWNlUmVuZGVyZXIsXHJcblx0XHR9O1xyXG5cclxuXHRcdGdldF9hc3NldCA9IEFzc2V0Q29udHJvbGxlci5nZXRfYXNzZXQ7IC8vIGZvciBxdWlja2VyIGFjY2Vzc1xyXG5cclxuXHRcdEdyYXBoaWNzTW9kZWwuc3RhZ2UgPSBuZXcgY3JlYXRlanMuU3RhZ2UoQ29uZmlnLk1BSU5fQ0FOVkFTX05BTUUpO1xyXG5cdFx0R3JhcGhpY3NNb2RlbC5zdGFnZS5jYW52YXMud2lkdGggPSBDb25maWcuU0NSRUVOX1c7XHJcblx0XHRHcmFwaGljc01vZGVsLnN0YWdlLmNhbnZhcy5oZWlnaHQgPSBDb25maWcuU0NSRUVOX0g7XHJcblx0XHRcclxuXHRcdEdyYXBoaWNzTW9kZWwuY2FtZXJhLm9mZnNldF9mcm9tX2ZvbGxvd2VkLnggLT0gKDE2MTQgLSBHcmFwaGljc01vZGVsLnN0YWdlLmNhbnZhcy53aWR0aCkgLyAzO1xyXG5cclxuXHRcdC8vIGluaXQgYWxsIHJlbmRlcmVyc1xyXG5cdFx0Zm9yKHR5cGUgaW4gdHlwZV9yZW5kZXJlcl90YWJsZSl7XHJcblx0XHRcdHR5cGVfcmVuZGVyZXJfdGFibGVbdHlwZV0uaW5pdCgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIHRoaXMgb2JqZWN0IGlzIHBhc3NlZCB0byBhbGwgcmVuZGVyZXJzIHRvIGdpdmUgdGhlbSBhY2Nlc3MgdG8gZnVuY3Rpb25zXHJcblx0XHQvLyB0aGF0IG5vIG9uZSBlbHNlIGlzIHN1cHBvc2VkIHRvIGJlIGFibGUgdG8gYWNjZXNzXHJcblx0XHRQcml2YXRlR3JhcGhpY3MgPSB7XHJcblx0XHRcdHN0YWdlOiBHcmFwaGljc01vZGVsLnN0YWdlLFxyXG5cdFx0XHRyZXF1ZXN0X2JpdG1hcDogcmVxdWVzdF9iaXRtYXAsXHJcblx0XHRcdHJlcXVlc3RfYW5pbWF0ZWQ6IHJlcXVlc3RfYW5pbWF0ZWQsXHJcblx0XHRcdGdldF9hc3NldDogZ2V0X2Fzc2V0LFxyXG5cdFx0XHR0cmFuc194eTogdHJhbnNfeHksXHJcblx0XHRcdHJlZ19mb3JfcmVuZGVyOiByZWdfZm9yX3JlbmRlcixcclxuXHRcdH07XHJcblxyXG5cdFx0QmFja2dyb3VuZFJlbmRlcmVyLmluaXQoKTtcclxuXHJcblx0fTtcclxuXHJcbiAgICBcclxuXHR2YXIgdXBkYXRlID0gZnVuY3Rpb24oZGVsdGEpe1xyXG5cdFx0LyogaXMgcmFuIGVhY2ggdGljayBmcm9tIHRoZSBHYW1lQ29udHJvbGxlci51cGRhdGVfYWxsICovXHJcblx0XHRcclxuXHRcdHVwZGF0ZV9jYW1lcmEoKTsgLy8gbmVlZHMgdG8gYmUgdXBkYXRlZCBmaXJzdFxyXG5cclxuXHRcdGRlc3Ryb3lfdW5uZWVkZWQoKTsgLy8gZ29lcyBzZWNvbmQsIGRvIG5vdCB1cGRhdGUgYW55IHN0dWZmIGJlZm9yZSB1bm5lZWRlZCBzdHVmZiBpcyByZW1vdmVkXHJcblxyXG5cdFx0cmVnaXN0ZXJfbmV3X3N0dWZmKCk7XHJcblxyXG5cdFx0cmVuZGVyX3RoaW5ncygpO1xyXG5cdFx0XHJcblx0XHRzeW5jaHJvbml6ZV90b19waHlzaWNhbF9ib2RpZXMoKTtcclxuXHJcblx0XHRCYWNrZ3JvdW5kUmVuZGVyZXIucmVuZGVyKCk7XHJcblx0XHRcclxuXHRcdEdyYXBoaWNzTW9kZWwuc3RhZ2UudXBkYXRlKCk7XHJcblx0fTtcclxuXHJcblx0dmFyIGRlc3Ryb3lfdW5uZWVkZWQgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyoqXHJcblx0XHQqIGRlc3Ryb3kgZ3JhcGhpY3MgZm9yIGV2ZXJ5dGhpbmcgdGhhdCB3YXMgbWFya2VkXHJcblx0XHQqIGZvciBkZXN0cnVjdGlvblxyXG5cdFx0Ki9cclxuXHJcblx0XHR2YXIgc2xpY2VzID0gUmVnaXN0ZXJBc0NvbnRyb2xsZXIucmV0cmlldmVfcmVnaXN0ZXJlZF9hcyhcInJlbW92ZWRfc2xpY2VcIik7XHJcblxyXG5cdFx0dmFyIGVudGl0aWVzID0gUmVnaXN0ZXJBc0NvbnRyb2xsZXIucmV0cmlldmVfcmVnaXN0ZXJlZF9hcyhcInJlbW92ZWRfZW50aXR5XCIpO1xyXG5cclxuXHRcdHdoaWxlKHNsaWNlcy5sZW5ndGggPiAwKXtcclxuXHRcdFx0dmFyIHNsaWNlID0gc2xpY2VzLnBvcCgpO1xyXG5cdFx0XHR2YXIgZ3JpZCA9IHNsaWNlLmdyaWQ7XHJcblxyXG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgZ3JpZC5sZW5ndGg7IGkrKyl7XHJcblx0XHRcdFx0dmFyIHJvdyA9IGdyaWRbaV07IC8vIG9yIGlzIGl0IGEgY29sdW1uP1xyXG5cclxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgcm93Lmxlbmd0aDsgaisrKXtcclxuXHRcdFx0XHRcdHZhciBjZWxsID0gcm93W2pdO1xyXG5cdFx0XHRcdFx0aWYoY2VsbC5raW5kICE9IDApe1xyXG5cdFx0XHRcdFx0XHRkZXN0cm95X2dyYXBoaWNzX2ZvcihjZWxsLmlkKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHdoaWxlKGVudGl0aWVzLmxlbmd0aCA+IDApe1xyXG5cdFx0XHR2YXIgZW50aXR5ID0gZW50aXRpZXMucG9wKCk7XHJcblx0XHRcdGRlc3Ryb3lfZ3JhcGhpY3NfZm9yKGVudGl0eS5pZCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHJcblx0dmFyIGZvbGxvdyA9IGZ1bmN0aW9uKGlkKXtcclxuXHRcdC8vb3JkZXIgY2FtZXJhIHRvIGZvbGxvdyB0aGUgZ3JhcGhpY2FsIHJlcHJlc2VudGF0aW9uXHJcblx0XHQvL29mIGFuIG9iamVjdCB3aXRoIHRoZSBnaXZlbiBpZCwgaWYgaXQgZXhpc3RzXHJcblx0XHRHcmFwaGljc01vZGVsLmNhbWVyYS5mb2xsb3dpbmcgPSBHcmFwaGljc01vZGVsLmFsbF9waHlzaWNhbFtpZF07XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHR2YXIgcmVnaXN0ZXJfbmV3X3N0dWZmID0gZnVuY3Rpb24oKXtcclxuXHRcdC8vc2VhcmNoIHRocm91Z2ggYWxsIGluc3RhbmNlcyBpbiB0aGUgcXVldWUgXHJcblx0XHQvL2FuZCByZWdpc3RlciB0aGVtIGZvciBncmFwaGljcyB1cGRhdGVzLlxyXG5cclxuXHRcdC8vIHJldHJpZXZlIGluc3RhbmNlcyBvZiBwaHlzaWNhbCB0aGluZ3MgdGhhdCBkbyBub3QgaGF2ZSBncmFwaGljcyB5ZXRcclxuXHRcdHZhciBuZXdfc3R1ZmYgPSBSZWdpc3RlckFzQ29udHJvbGxlci5yZXRyaWV2ZV9yZWdpc3RlcmVkX2FzKFwiYXdhaXRpbmdfZ3JhcGhpY3NfaW5pdGlhbGl6YXRpb25cIik7XHJcblxyXG5cdFx0dmFyIGxlbmd0aCA9IG5ld19zdHVmZi5sZW5ndGhcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKyl7XHJcblx0XHRcdHZhciBuZXdfb2JqID0gbmV3X3N0dWZmLnBvcCgpO1xyXG5cdFx0XHRpZih0eXBlX3JlbmRlcmVyX3RhYmxlW25ld19vYmoudHlwZV0pe1xyXG5cdFx0XHRcdC8vIGlmIHJlbmRlcmVyIGV4aXN0cyBmb3IgdGhpcyB0eXBlLCByZWdpc3RlciB0aHJvdWdoIGl0XHJcblx0XHRcdFx0dHlwZV9yZW5kZXJlcl90YWJsZVtuZXdfb2JqLnR5cGVdLnJlZ2lzdGVyKG5ld19vYmosIFByaXZhdGVHcmFwaGljcyk7XHRcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0dGhyb3cgXCJObyByZW5kZXJlciBmb3VuZCBmb3IgdGhlIHR5cGUgXCIgKyBTdHJpbmcobmV3X29iai50eXBlKSArXHJcblx0XHRcdFx0XHRcIiBjb25maXJtIHRoYXQgcmVuZGVyZXIgZXhpc3RzIGFuZCBpcyBhZGRlZCB0byB0aGUgR3JhcGhpY3NDb250cm9sbGVyLnR5cGVfcmVuZGVyZXJfdGFibGVcIlxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHR2YXIgcmVuZGVyX3RoaW5ncyA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKipcclxuXHRcdCogY2FsbCByZW5kZXJlcnMgZm9yIGV2ZXJ5dGhpbmdcclxuXHRcdCovXHJcblx0XHRcclxuXHRcdHZhciB0b19yZW5kZXIgPSBHcmFwaGljc01vZGVsLnNwZWNpYWxfcmVuZGVyO1xyXG5cclxuXHRcdGZvcih2YXIgdHlwZSBpbiB0b19yZW5kZXIpe1xyXG5cdFx0XHR2YXIgdGFibGUgPSB0b19yZW5kZXJbdHlwZV07XHJcblx0XHRcdHZhciByZW5kZXJlciA9IHR5cGVfcmVuZGVyZXJfdGFibGVbdHlwZV07XHJcblxyXG5cdFx0XHRmb3IodmFyIGlkIGluIHRhYmxlKXtcclxuXHRcdFx0XHRyZW5kZXJlci5yZW5kZXIodGFibGVbaWRdLCBQcml2YXRlR3JhcGhpY3MpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHR9O1xyXG5cclxuXHQvL2NhbGxlZCBmcm9tIHVwZGF0ZSgpLCBtYWludGFpbnMgY2FtZXJhIHBvc2l0aW9uXHJcblx0dmFyIHVwZGF0ZV9jYW1lcmEgPSBmdW5jdGlvbigpe1xyXG5cdFx0dmFyIGNhbWVyYSA9IEdyYXBoaWNzTW9kZWwuY2FtZXJhO1xyXG5cdFx0dmFyIGNlbnRlciA9IGNhbWVyYS5jZW50ZXI7XHJcblx0XHRcclxuXHRcdGNlbnRlci54ID0gQ29uZmlnLlNDUkVFTl9XLzIgLSBjYW1lcmEub2Zmc2V0X2Zyb21fZm9sbG93ZWQueDtcclxuXHRcdC8vQ0FNRVJBIFNIT1VMRCBOT1QgTU9WRSBWRVJUSUNBTExZXHJcblx0XHQvL2NlbnRlci55ID0gQ29uZmlnLlNDUkVFTl9ILzIgLSBjYW1lcmEub2Zmc2V0X2Zyb21fZm9sbG93ZWQueTtcclxuXHRcdFxyXG5cdFx0aWYoY2FtZXJhLmZvbGxvd2luZyAhPSBudWxsKXtcclxuXHRcdCAgICBjYW1lcmEub2Zmc2V0LnggPSBjZW50ZXIueCAtIGNhbWVyYS5mb2xsb3dpbmcucGh5c2ljYWxfaW5zdGFuY2UuYm9keS5HZXRXb3JsZENlbnRlcigpLnggKiBDb25maWcuQjJELlNDQUxFO1xyXG5cdFx0XHRjYW1lcmEub2Zmc2V0LnkgPSBjZW50ZXIueSAtIGNhbWVyYS5mb2xsb3dpbmcucGh5c2ljYWxfaW5zdGFuY2UuYm9keS5HZXRXb3JsZENlbnRlcigpLnkgKiBDb25maWcuQjJELlNDQUxFO1xyXG5cdFx0XHQvLyBub3csIHdlIGRvIG5vdCB3YW50IHRoZSBjYW1lcmEgdG8gZGlzcGxheSB3aGF0IGlzIGJlaGluZCB0aGUgbW92ZW1lbnQgZWRnZS4gYnV0IHRoZSBjYW1lcmEgaXMgYSByZWxhdGl2ZSB0aGluZ1xyXG5cdFx0XHQvLyBzbyB3ZSBjYW4ndCBqdXN0IGxpbWl0IHNvbWUgc29ydCBvZiB4IHBvc2l0aW9uIG9yIHN1Y2guXHJcblx0XHRcdC8vIEknbGwgdXNlIHRoZSBmb2xsb3dpbmcgdGVjaG5pcXVlOiBcclxuXHRcdFx0Ly8gICAxLiBjYWxjdWxhdGUgd2VyZSB0aGUgcGh5c2ljYWwgbW92ZW1lbnQgZWRnZSB3b3VsZCBiZSBpZiBkcmF3biByaWdodCBub3cgdG8gdGhlIGNhbnZhc1xyXG5cdFx0XHQvLyAgIDIuIGlmIGl0IHdvdWxkIGJlIGRpc3BsYXllZCBvbi1zY3JlZW4sIG9mZnNldCBjYW1lcmEgc28gdGhhdCBpdCB3b3VsZG4ndCBiZSBhbnltb3JlXHJcblxyXG5cdFx0XHR2YXIgbW92X2VkZ2VfZ3JhcGhpY3NfeCA9IChXb3JsZENvbnRyb2xsZXIuZ2V0X21vdmVtZW50X2VkZ2UoKSAqIENvbmZpZy5CMkQuU0NBTEUpICsgY2FtZXJhLm9mZnNldC54O1xyXG5cclxuXHRcdFx0Ly8gcmVjYWxsIHRoYXQgbGVmdCBkaXNwbGF5IGVkZ2UgaXMgMCBmb3IgZ3JhcGhpY3MsIGFzICgwLCAwKSBpcyB0aGUgdG9wLWxlZnQgY29ybmVyXHJcblx0XHRcdGlmKG1vdl9lZGdlX2dyYXBoaWNzX3ggPiAwKXtcclxuXHRcdFx0XHQvLyBpZiBtb3ZlbWVudCBlZGdlIHdvdWxkIGJlIGRpc3BsYXllZFxyXG5cdFx0XHRcdGNhbWVyYS5vZmZzZXQueCAtPSBtb3ZfZWRnZV9ncmFwaGljc194O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRpZiAoY2FtZXJhLm9mZnNldC55IDwgMCkge1xyXG5cdFx0ICAgIGNhbWVyYS5vZmZzZXQueSA9IDA7XHJcblx0XHR9XHJcblxyXG5cdFx0YWRqdXN0X2RlYnVnX2RyYXcoKTsgLy8gZ29lcyBsYXN0XHJcblx0fTtcclxuXHJcblx0XHJcblxyXG5cclxuXHQvLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuXHR2YXIgYWRqdXN0X2RlYnVnX2RyYXcgPSBmdW5jdGlvbigpe1xyXG5cdFx0dmFyIGNhbWVyYSA9IEdyYXBoaWNzTW9kZWwuY2FtZXJhO1xyXG5cdFx0VGVzdENvbnRyb2xsZXIuc2V0X2RlYnVnX29mZnNldChjYW1lcmEub2Zmc2V0LngsIGNhbWVyYS5vZmZzZXQueSk7XHJcblx0fTtcclxuXHJcblx0dmFyIHJlcXVlc3RfYml0bWFwID0gZnVuY3Rpb24oaWQpe1xyXG5cdFx0Ly8gaWYgaWQgaXMgaW52YWxpZCwgdGhyb3cgbWVhbmluZ2Z1bCBleGNlcHRpb24/XHJcblx0XHR2YXIgYml0bWFwID0gbmV3IGNyZWF0ZWpzLkJpdG1hcChnZXRfYXNzZXQoaWQpKTtcclxuXHRcdC8vIG1vcmUgY29tcGxpY2F0ZWQgc2V0dGluZyBmb3IgcmVnaXN0cmF0aW9uIHBvc2l0aW9uIG1heSBiZSBuZWVkZWQsIGRlcGVuZGluZyBvbiB0aGUgYm9keSBhdHRhY2hlZFxyXG5cdFx0aWYgKCEoYml0bWFwLmltYWdlKSl7XHJcblx0XHRcdHRocm93IFwiRXJyb3I6IGltYWdlIHdhc24ndCBjb3JyZWN0bHkgbG9hZGVkIGZvciB0aGlzIGJpdG1hcFwiO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRiaXRtYXAucmVnWCA9IGJpdG1hcC5pbWFnZS53aWR0aC8yO1xyXG5cdFx0Yml0bWFwLnJlZ1kgPSBiaXRtYXAuaW1hZ2UuaGVpZ2h0LzI7XHJcblxyXG5cdFx0cmV0dXJuIGJpdG1hcDtcclxuXHRcdC8vIFRPRE8gcmVzZWFyY2ggRGlzcGxheU9iamVjdCdzIGNhY2hpbmcuIGFuZCBtYXliZSBpbmNvcnBvcmF0ZVxyXG5cdH07XHJcblx0XHJcblx0XHJcblx0dmFyIHJlcXVlc3RfYW5pbWF0ZWQgPSBmdW5jdGlvbihpZCwgc3RhcnRfZnJhbWUpe1xyXG5cdFx0Ly8gdGhpcyBpbXBsZW1lbnRhdGlvbiBpcyB0ZW1wb3JhcnlcclxuXHRcdC8vIHVudGlsIEkgc2V0dXAgZWZmaWNpZW50IGZhY2lsaXR5IGZvciBkZWZpbmluZyBzcHJpdGVzaGVldHNcclxuXHRcdC8vIHdpdGhpbiBHcmFwaGljc0NvbnRyb2xsZXJcclxuXHJcblx0XHRpZighaWQgfHwgIXN0YXJ0X2ZyYW1lKXtcclxuXHRcdFx0aWYoIWlkKXtcclxuXHRcdFx0XHR0aHJvdyBcIndyb25nIGlkXCI7XHJcblx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdHRocm93IFwid3Jvbmcgc3RhcnRfZnJhbWVcIjtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHJcblx0XHR2YXIgc3ByaXRlID0gbmV3IGNyZWF0ZWpzLlNwcml0ZShpZCwgc3RhcnRfZnJhbWUpO1xyXG5cclxuXHRcdHJldHVybiBzcHJpdGU7XHJcblx0fTtcclxuXHJcblx0XHJcblx0Ly9jb252ZXJ0cyBlYXNlbGpzIG9yaWdpbnMgdG8gYm94MmQgb3JpZ2luc1xyXG5cdHZhciBzeW5jaHJvbml6ZV90b19waHlzaWNhbF9ib2RpZXMgPSBmdW5jdGlvbigpe1xyXG5cclxuXHRcdHZhciB0aWxlcyA9IEdyYXBoaWNzTW9kZWwuYWxsX3BoeXNpY2FsO1xyXG5cclxuXHRcdGZvcih2YXIgaWQgaW4gdGlsZXMpe1xyXG5cdFx0XHR2YXIgdGlsZSA9IHRpbGVzW2lkXTtcclxuXHRcdFx0dmFyIGJvZHkgPSB0aWxlLnBoeXNpY2FsX2luc3RhbmNlLmJvZHk7XHJcblx0XHRcdHZhciB0aWxlX3BvcyA9IHRyYW5zX3h5KGJvZHkuR2V0V29ybGRDZW50ZXIoKSk7XHJcblxyXG5cdFx0XHR0aWxlLnggPSB0aWxlX3Bvcy54O1xyXG5cdFx0XHR0aWxlLnkgPSB0aWxlX3Bvcy55O1xyXG5cdFx0fVxyXG5cdH07XHJcblx0XHJcblxyXG5cdHZhciB0cmFuc194eSA9IGZ1bmN0aW9uKHBvc2l0aW9uX3ZlY3Rvcl91bnNjYWxlZCl7XHJcblx0XHQvLyB0YWtlcyBwb3NpdGlvbiB2ZWN0b3Igd2l0aCB2YWx1ZXMgaW4gbWV0ZXJzLCB0cmFuc2xhdGVzXHJcblx0XHQvLyBpdCB0byBwaXhlbCBwb3NpdGlvbiB0YWtpbmcgdGhlIGNhbWVyYSBwb3NpdGlvbiBpbnRvIGFjY291bnRcclxuXHRcdHZhciBjYW1lcmEgPSBHcmFwaGljc01vZGVsLmNhbWVyYTtcclxuXHJcblx0XHR2YXIgeCA9IChwb3NpdGlvbl92ZWN0b3JfdW5zY2FsZWQueCAqIENvbmZpZy5CMkQuU0NBTEUpICsgY2FtZXJhLm9mZnNldC54O1xyXG5cdFx0dmFyIHkgPSAocG9zaXRpb25fdmVjdG9yX3Vuc2NhbGVkLnkgKiBDb25maWcuQjJELlNDQUxFKSArIGNhbWVyYS5vZmZzZXQueTtcclxuXHJcblx0XHRyZXR1cm4ge3g6IHgsIHk6IHl9O1x0XHJcblx0fTtcclxuXHJcblx0dmFyIHNldF9yZWdfcG9zaXRpb24gPSBmdW5jdGlvbihlYXNlbGpzX29iaiwgb2Zmc2V0X3gsIG9mZnNldF95KXtcclxuXHRcdC8vIHNldHMgcmVnaXN0cmF0aW9uIHBvc2l0aW9uIG9mIHRoZSBlYXNlbGpzIG9iamVjdFxyXG5cdFx0Ly8gcmVnaXNyYXRpb24gcG9zaXRpb24gaXMgdGhlIHJlbGF0aXZlIHBvaW50IG9mIHRoZSBvYmplY3RcclxuXHRcdC8vIHRoYXQgeW91IG1vdmUgd2hlbiB5b3Ugc2V0IG9iamVjdCdzIHggYW5kIHkgY29vcmRpbmF0c1xyXG5cdFx0Ly8gaS5lLiBpZiByZWcuIHBvc2l0aW9uIG9mIHRoZSBwbGF5ZXIgaXMgaGVhZCwgYW5kIHlvdSBzZXQgdGhlaXJcclxuXHRcdC8vIHBvc2l0aW9uIHRvICgwLCAwKSwgdGhlaXIgaGVhZCB3aWxsIGJlIGF0ICgwLCAwKVxyXG5cdFx0Ly8gY3VycmVudGx5IHRoZSByZWdpc3RyYXRpb24gcG9zaXRpb24gaXMgc2V0IHRvIHRoZSBtaWRkbGUgb2YgdGhlIGJvZHlcclxuXHRcdC8vIHRvIG1hdGNoIHdoYXQgYm94MmQgZG9lc1xyXG5cdFx0Ly8gbGFzdCB0d28gYXJndW1lbnRzIGFyZSBvcHRpb25hbCBhbmQgc2V0IFBJWEVMIG9mZnNldCBmcm9tIHRoZSBub3JtYWwgcmVnaXN0cmF0aW9uXHJcblx0XHQvLyBwb3NpdGlvblxyXG5cdFx0XHJcblx0XHQvLyB0aGlzIGlmIHN0YXRlbWVudCBzaG91bGQgYmUgdGVtcG9yYXJ5XHJcblx0XHRpZihlYXNlbGpzX29iai5pbWFnZSl7XHJcblx0XHRcdHZhciB3ID0gZWFzZWxqc19vYmouaW1hZ2Uud2lkdGg7XHRcclxuXHRcdFx0dmFyIGggPSBlYXNlbGpzX29iai5pbWFnZS5oZWlnaHQ7XHRcclxuXHRcdH1lbHNle1xyXG5cdFx0XHR2YXIgdyA9IGVhc2VsanNfb2JqLnNwcml0ZVNoZWV0Ll9mcmFtZVdpZHRoO1xyXG5cdFx0XHR2YXIgaCA9IGVhc2VsanNfb2JqLnNwcml0ZVNoZWV0Ll9mcmFtZUhlaWdodDtcclxuXHRcdH07XHJcblxyXG5cdFx0dmFyIG9mZnNldF94ID0gb2Zmc2V0X3ggfHwgMDtcclxuXHRcdHZhciBvZmZzZXRfeSA9IG9mZnNldF95IHx8IDA7XHJcblxyXG5cdFx0ZWFzZWxqc19vYmoucmVnWCA9IHcvMiArIG9mZnNldF94O1xyXG5cdFx0ZWFzZWxqc19vYmoucmVnWSA9IGgvMiArIG9mZnNldF95O1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgcmVnX2Zvcl9yZW5kZXIgPSBmdW5jdGlvbihlYXNlbGpzX29iaiwgcGh5c2ljYWxfaW5zdGFuY2Upe1xyXG5cdFx0Ly8gcmVnaXN0ZXJlcyBvYmplY3QgZm9yIHJlbmRlcmluZyB3aXRoaW4gZ3JhcGhpY3MgY29udHJvbGxlclxyXG5cdFx0Ly8gaWYgKE9QVElPTkFMISkgcGh5c2ljYWxfaW5zdGFuY2UgaXMgZ2l2ZW4sIGdyYXBoaWNzIGNvbnRyb2xsZXIgd2lsbCBhdXRvbWF0aWNhbGx5XHJcblx0XHQvLyBzZXQgdGhlIGVhc2VsanNfb2JqJ3MgcG9zaXRpb24gdG8gcG9zaXRpb24gb2YgdGhhdCBib2R5LCBlYWNoIHRpY2suXHJcblx0XHQvLyBpZiB0aGUgdHlwZSBvZiB0aGUgcGh5c2ljYWwgaW5zdGFuY2UgaXMgYXNzb2NpYXRlZCB3aXRoIHNvbWUgcmVuZGVyZXJcclxuXHRcdFx0XHJcblx0XHRcclxuXHRcdGlmKHBoeXNpY2FsX2luc3RhbmNlKXtcclxuXHJcblx0XHRcdGlmKHBoeXNpY2FsX2luc3RhbmNlLmJvZHkgPT0gbnVsbCl7XHJcblx0XHRcdFx0Ly8gYXJlIHlvdSB0cnlpbmcgdG8gZG8gc29tZXRoaW5nIHRlcnJpYmxlPyBzdWNoIGFzIHJlZ2lzdGVyaW5nXHJcblx0XHRcdFx0Ly8gc29tZSBvYmplY3QgdGhhdCBkb2Vzbid0IG5lZWQgZ3JhcGhpY2FsIHJlcHJlc2VudGF0aW9uP1xyXG5cdFx0XHRcdHRocm93IFwiUGh5c2ljYWwgaW5zdGFuY2UgaXMgcHJvdmlkZWQsIGJ1dCBpdCBoYXMgbm8gYm9keVwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBpZCA9IHBoeXNpY2FsX2luc3RhbmNlLmlkO1xyXG5cdFx0XHR2YXIgdHlwZSA9IHBoeXNpY2FsX2luc3RhbmNlLnR5cGU7XHJcblxyXG5cdFx0XHRpZihpZCA9PSBudWxsIHx8IHR5cGUgPT0gbnVsbCl7XHJcblx0XHRcdFx0dGhyb3cgXCJJZCBvciB0eXBlIGlzIHVuZGVmaW5lZCBmb3IgdGhpcyBwaHlzaWNhbCBpbnN0YW5jZVwiO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRlYXNlbGpzX29iai5waHlzaWNhbF9pbnN0YW5jZSA9IHBoeXNpY2FsX2luc3RhbmNlO1xyXG5cdFx0XHRHcmFwaGljc01vZGVsLmFsbF9waHlzaWNhbFtpZF0gPSBlYXNlbGpzX29iajtcclxuXHJcblx0XHRcdGlmKCFHcmFwaGljc01vZGVsLnNwZWNpYWxfcmVuZGVyW3R5cGVdKXtcclxuXHRcdFx0XHRHcmFwaGljc01vZGVsLnNwZWNpYWxfcmVuZGVyW3R5cGVdID0ge307XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdEdyYXBoaWNzTW9kZWwuc3BlY2lhbF9yZW5kZXJbdHlwZV1baWRdID0gZWFzZWxqc19vYmo7XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdEFkZFRvU3RhZ2UoZWFzZWxqc19vYmopO1xyXG5cdH07XHJcblxyXG5cdHZhciBBZGRUb1N0YWdlID0gZnVuY3Rpb24oZWxlbWVudCl7XHJcblx0XHQvLyBjYW4gYmUgdXBkYXRlZCBsYXRlciB0byBtYW5hZ2Ugei1pbmRleCBvciB3aGF0ZXZlclxyXG5cdFx0R3JhcGhpY3NNb2RlbC5zdGFnZS5hZGRDaGlsZChlbGVtZW50KTtcclxuXHR9O1xyXG5cdFxyXG5cclxuXHR2YXIgZ2V0X3N0YWdlID0gZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiBHcmFwaGljc01vZGVsLnN0YWdlO1xyXG5cdH07XHJcblx0XHJcblx0dmFyIGdldF9jYW1lcmEgPSBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIEdyYXBoaWNzTW9kZWwuY2FtZXJhO1xyXG5cdH07XHJcblx0XHJcblx0dmFyIGRlc3Ryb3lfZ3JhcGhpY3NfZm9yID0gZnVuY3Rpb24oaWQpe1xyXG5cdFx0LyoqXHJcblx0XHQqIHJlbW92ZSBmcm9tIHRoZSBzdGFnZSBhbmQgZGVzdHJveSBncmFwaGljcyBpbnN0YW5jZXMgZm9yIHRoZSBvYmplY3Qgd2l0aCB0aGUgZ2l2ZW4gaWRcclxuXHRcdCogdGhpcyBpbmNsdWRlcyByZW1vdmluZyBhbGwgcmVmZXJlbmNlcyB0byBpdC5cclxuXHRcdCogVE9ETzogSU1QT1JUQU5UISEhIGlmIEdyYXBoaWNzQ29udHJvbGxlciB3YXMgdXBkYXRlZCB0byBzdG9yZSBtb3JlXHJcblx0XHQqIHJlZmVyZW5jZXMgdG8gc29tZSBncmFwaGljcyBpbnN0YW5jZXMsIFVQREFURSB0aGlzIGZ1bmN0aW9uIHRvIHJlZmxlY3QgY2hhbmdlc1xyXG5cdFx0KiBldmVuIGEgc2luZ2xlIHJlZmVyZW5jZSB0byB0aGUgb2JqZWN0IG1heSBjYXVzZSBpdCB0byBzdGF5IGluIG1lbW9yeVxyXG5cdFx0Ki9cclxuXHRcdFxyXG5cclxuXHRcdGlmKEdyYXBoaWNzTW9kZWwuYWxsX3BoeXNpY2FsW2lkXSAhPSBudWxsKXtcclxuXHRcdFx0dmFyIGdyYXBoaWNzX2luc3RhbmNlID0gR3JhcGhpY3NNb2RlbC5hbGxfcGh5c2ljYWxbaWRdO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdC8vIGlmIHlvdSBlbmNvdW50ZXIgdGhpcyBleGNlcHRpb24sIG1heWJlIGltcGxlbWVudGF0aW9uIGNoYW5nZWQuIFxyXG5cdFx0XHQvLyBJZiB0aGF0J3MgdGhlIGNhc2UsIHNvbWUgdGhpbmdzIG5lZWQgcmV3cml0aW5nLiBUaGlzIGZ1bmN0aW9uIGluXHJcblx0XHRcdC8vIHBydGljdWxhci4gT3IgbWF5YmUgdGhlcmUgaXMgYSBidWcuXHJcblx0XHRcdHRocm93IFwiVGhlIGdyYXBoaWNzIG9iamVjdCB3aXRoIGlkIFwiICsgU3RyaW5nKGlkKSArIFwiIGlzbid0IHJlZ2lzdGVyZWQgYXMgaGF2aW5nIHBoeXNpY2FsIGJvZHlcIjtcclxuXHRcdH1cclxuXHJcblx0XHRpZihncmFwaGljc19pbnN0YW5jZS5waHlzaWNhbF9pbnN0YW5jZS50eXBlICE9IG51bGwpe1xyXG5cdFx0XHR2YXIgdHlwZSA9IGdyYXBoaWNzX2luc3RhbmNlLnBoeXNpY2FsX2luc3RhbmNlLnR5cGU7XHJcblxyXG5cdFx0fWVsc2V7XHJcblx0XHRcdC8vIGlmIHlvdSBlbmNvdW50ZXIgdGhpcyBleGNlcHRpb24gaXQgbWF5IG1lYW4gYSBidWcsIG9yIGFsdGVybmF0aXZlbHlcclxuXHRcdFx0Ly8gaXQgbWF5IG1lYW4gdGhhdCBpbXBsZW1lbnRhdGlvbiBjaGFuZ2VkIGFuZCB0aGlzIGZ1bmN0aW9uIG5lZWRzIGFuIHVwZGF0ZVxyXG5cdFx0XHR0aHJvdyBcIlBoeXNpY2FsIGluc3RhbmNlIHdpdGggaWQgXCIgKyBTdHJpbmcoaWQpICsgXCIgZG9lc24ndCBzZWVtIHRvIGhhdmUgYSB0eXBlXCI7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdC8vIHJlbW92ZSBmcm9tIHRoZSBzdGFnZSBcclxuXHRcdFxyXG5cdFx0XHQvKiBncmFwaGljc19pbnN0YW5jZS5yZW1vdmVBbGxFdmVudExpc3RlbmVycygpOyBcclxuXHRcdFx0ICAgY291bGQgYmUgbmVjZXNzYXJ5IHRvIHJlbW92ZSBhdHRhY2hlZCBldmVudCBsaXN0ZW5lcnMsIGJ1dCBpdCBzZWVtcywgYXQgbGVhc3RcclxuXHRcdFx0ICAgc28gZmFyLCB0aGF0IHRoaXMgc3R1ZmYgaXMgZG9uZSBhdXRvbWF0aWNhbGx5IGJlIGVhc2VsanMgKi9cclxuXHJcblx0XHRcdEdyYXBoaWNzTW9kZWwuc3RhZ2UucmVtb3ZlQ2hpbGQoZ3JhcGhpY3NfaW5zdGFuY2UpO1xyXG5cclxuXHRcdC8vIHJlbW92ZSBmcm9tIGFsbF9waHlzaWNhbCAocmVzcG9uc2libGUgdHJhY2tpbmcgZm9yIGJvZHkgcG9zaXRpb24pXHJcblx0XHRcdGRlbGV0ZSBHcmFwaGljc01vZGVsLmFsbF9waHlzaWNhbFtpZF07XHJcblx0XHQvLyByZW1vdmUgZnJvbSBzcGVjaWFsX3JlbmRlclxyXG5cdFx0XHRkZWxldGUgR3JhcGhpY3NNb2RlbC5zcGVjaWFsX3JlbmRlclt0eXBlXVtpZF07XHJcblx0XHQvLyBUT0RPOiByZW1vdmUgY2FtZXJhIHJlZmVyZW5jZSBpZiBmb2xsb3dpbmcgdGhpcyBvYmplY3RcclxuXHRcdFx0XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdC8vIGRlY2xhcmUgcHVibGljXHJcblx0XHRpbml0OiBpbml0LCBcclxuXHRcdHVwZGF0ZTogdXBkYXRlLFxyXG5cdFx0Z2V0X3N0YWdlOiBnZXRfc3RhZ2UsXHJcblx0XHRnZXRfY2FtZXJhOiBnZXRfY2FtZXJhLFxyXG5cdFx0Z2V0X2Fzc2V0OiBnZXRfYXNzZXQsXHJcblx0XHRyZWdfZm9yX3JlbmRlcjogcmVnX2Zvcl9yZW5kZXIsXHJcblx0XHRzZXRfcmVnX3Bvc2l0aW9uOiBzZXRfcmVnX3Bvc2l0aW9uLFxyXG5cdFx0cmVxdWVzdF9iaXRtYXA6IHJlcXVlc3RfYml0bWFwLFxyXG5cdFx0cmVxdWVzdF9hbmltYXRlZDogcmVxdWVzdF9hbmltYXRlZCxcclxuXHRcdGRlc3Ryb3lfZ3JhcGhpY3NfZm9yOiBkZXN0cm95X2dyYXBoaWNzX2ZvcixcclxuXHRcdGZvbGxvdzogZm9sbG93LFxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdyYXBoaWNzQ29udHJvbGxlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkdyYXBoaWNzQ29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVCB8IEluY2x1ZGVzLmNob2ljZXMuUkVOREVSRVJTXHJcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cclxuXHJcbiIsInZhciBIVURDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcclxuXHRcdFxyXG5cdFx0aW5jbHVkZSgpO1xyXG5cdFx0XHJcblx0XHRIVURNb2RlbC5zY29yZSA9IG5ldyBjcmVhdGVqcy5UZXh0KCk7XHJcblx0XHRHcmFwaGljc0NvbnRyb2xsZXIucmVnX2Zvcl9yZW5kZXIoSFVETW9kZWwuc2NvcmUpO1xyXG5cdFx0SFVETW9kZWwuaGVhbHRoID0gbmV3IGNyZWF0ZWpzLlRleHQoKTtcclxuXHRcdEdyYXBoaWNzQ29udHJvbGxlci5yZWdfZm9yX3JlbmRlcihIVURNb2RlbC5oZWFsdGgpO1xyXG5cdFx0SFVETW9kZWwuc2NvcmVfdGl0bGUgPSBuZXcgY3JlYXRlanMuVGV4dCgpO1xyXG5cdFx0R3JhcGhpY3NDb250cm9sbGVyLnJlZ19mb3JfcmVuZGVyKEhVRE1vZGVsLnNjb3JlX3RpdGxlKTtcclxuXHRcdEhVRE1vZGVsLmhlYWx0aF90aXRsZSA9IG5ldyBjcmVhdGVqcy5UZXh0KCk7XHJcblx0XHRHcmFwaGljc0NvbnRyb2xsZXIucmVnX2Zvcl9yZW5kZXIoSFVETW9kZWwuaGVhbHRoX3RpdGxlKTtcclxuXHJcblx0XHRIVURNb2RlbC5oZWFsdGhfdGl0bGUudGV4dCA9IFwiSGVhbHRoOiBcIjtcclxuXHRcdEhVRE1vZGVsLmhlYWx0aF90aXRsZS54ID0gMTA7XHJcblx0XHRIVURNb2RlbC5oZWFsdGhfdGl0bGUueSA9IDMwO1xyXG5cdFx0SFVETW9kZWwuaGVhbHRoLnRleHQgPSBcIjEwMFwiO1xyXG5cdFx0SFVETW9kZWwuaGVhbHRoLnggPSA4MDtcclxuXHRcdEhVRE1vZGVsLmhlYWx0aC55ID0gMzA7XHJcblx0XHRIVURNb2RlbC5oZWFsdGguZm9udCA9IFwiMjBweCBBcmlhbFwiO1xyXG5cdFx0SFVETW9kZWwuaGVhbHRoX3RpdGxlLmZvbnQgPSBcIjIwcHggQXJpYWxcIjtcclxuXHRcdEhVRE1vZGVsLmhlYWx0aC5jb2xvciA9IFwiI2ZmMDAwMFwiO1xyXG5cdFx0SFVETW9kZWwuaGVhbHRoX3RpdGxlLmNvbG9yID0gXCIjZmYwMDAwXCI7XHJcblx0XHRIVURNb2RlbC5zY29yZV90aXRsZS50ZXh0ID0gXCJTY29yZTogXCI7XHJcblx0XHRIVURNb2RlbC5zY29yZV90aXRsZS54ID0gMTA7XHJcblx0XHRIVURNb2RlbC5zY29yZV90aXRsZS55ID0gMTA7XHJcblx0XHRIVURNb2RlbC5zY29yZS50ZXh0ID0gXCIwXCI7XHJcblx0XHRIVURNb2RlbC5zY29yZS54ID0gODA7XHJcblx0XHRIVURNb2RlbC5zY29yZS55ID0gMTA7XHJcblx0XHRIVURNb2RlbC5zY29yZS5mb250ID0gXCIyMHB4IEFyaWFsXCI7XHJcblx0XHRIVURNb2RlbC5zY29yZV90aXRsZS5mb250ID0gXCIyMHB4IEFyaWFsXCI7XHJcblx0fTtcclxuXHRcclxuXHR2YXIgdXBkYXRlID0gZnVuY3Rpb24oKXtcclxuXHRcdHZhciBjYW1lcmEgPSBHcmFwaGljc0NvbnRyb2xsZXIuZ2V0X2NhbWVyYSgpO1xyXG5cdFx0dmFyIGhlcm8gPSBFbnRpdHlDb250cm9sbGVyLmdldF9teV9oZXJvKCk7XHJcblx0XHRcclxuXHRcdHVwZGF0ZV9zY29yZShXb3JsZENvbnRyb2xsZXIuZ2V0X3Njb3JlKCkpO1xyXG5cdFx0dXBkYXRlX2hlYWx0aChoZXJvLmhwKTtcclxuXHRcdFxyXG5cdH07XHJcblx0XHJcblx0dmFyIHVwZGF0ZV9zY29yZSA9IGZ1bmN0aW9uKHNjb3JlKXtcclxuXHRcdEhVRE1vZGVsLnNjb3JlLnRleHQgPSBwYXJzZUludChzY29yZSk7XHJcblx0fTtcclxuXHRcclxuXHR2YXIgdXBkYXRlX2hlYWx0aCA9IGZ1bmN0aW9uKGhlYWx0aCl7XHJcblx0XHRIVURNb2RlbC5oZWFsdGgudGV4dCA9IHBhcnNlSW50KGhlYWx0aCk7XHJcblx0fTtcclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0dXBkYXRlOiB1cGRhdGUsXHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gSFVEQ29udHJvbGxlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkhVRENvbnRyb2xsZXJcIiwgXHJcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLkRFRkFVTFQgfCBJbmNsdWRlcy5jaG9pY2VzLlJFTkRFUkVSU1xyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcbiIsIlxyXG52YXIgSWRlbnRpZmljYXRpb25Db250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0LyogSXMgaW4gY2hhcmdlIG9mIGdpdmluZyB1bmlxdWUgSUQncyB0byBldmVyeXRoaW5nXHJcblx0ICogdGhhdCB3YW50cyB0aGVtXHJcblx0Ki9cclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogaXMgcmFuIGZyb20gdGhlIEluaXRDb250cm9sbGVyIG9uY2Ugd2hlbiB0aGUgZ2FtZSBpcyBsb2FkZWQgKi9cclxuXHJcblx0XHRpbmNsdWRlKCk7IC8vIHNhdGlzZnkgcmVxdWlyZW1lbnRzXHJcblxyXG5cdFx0Ly8gY3JlYXRlIDEwMCBpZCdzXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgMTAwOyBpKyspe1xyXG5cdFx0XHR2YXIgaWQgPSBJZGVudGlmaWNhdGlvbk1vZGVsLm5leHRfaWQgKys7XHJcblx0XHRcdElkZW50aWZpY2F0aW9uTW9kZWwuZnJlZV9pZHMucHVzaChpZCk7XHJcblx0XHRcdElkZW50aWZpY2F0aW9uTW9kZWwuaWRfbWF0Y2hpbmdbaWRdID0gbnVsbDtcclxuXHRcdH1cclxuXHJcblx0fTtcclxuXHJcblx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKGRlbHRhKXtcclxuXHRcdC8qIGlzIHJhbiBlYWNoIHRpY2sgZnJvbSB0aGUgR2FtZUNvbnRyb2xsZXIudXBkYXRlX2FsbCAqL1xyXG5cdFx0Ly8gY2xlYW51cCBpZHMsIGlmIHRvbyBtYW55IGZyZWUgaWRzIChsaWtlIGlmIG5vbi1mcmVlIGlkJ3MgPCBmcmVlIGlkJ3MvMTBcclxuXHRcdFxyXG5cdFx0Ly9UT0RPOiBtYWtlIGZ1bmN0aW9uIHRvIGFjdHVhbGx5IGJlIGNhbGxlZCBmcm9tIHRoZSBHYW1lQ29udHJvbGxlci51cGRhdGVfYWxsXHJcblx0XHQvLyBUT0RPOiBsb29wIHRocm91Z2ggYWxsIG5vbi1mcmVlIGlkJ3MsIGFuZCBpZiBhbnkgb2YgdGhlbSByZWZlcmVuY2UgbnVsbCxcclxuXHRcdC8vIHJlbW92ZSAodW5yZWdpc3RlcikgdGhlbTtcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIGFzc2lnbl9pZCA9IGZ1bmN0aW9uKG9iaiwgc2V0X2lkKXtcclxuXHRcdC8qKlxyXG5cdFx0KiBhc3NpZ25zIGlkIHRvIHRoZSBvYmplY3RcclxuXHRcdCogc2V0cyBwcm9wZXJ0eSBpZCBvbiB0aGUgb2JqZWN0IGdpdmVuLiB5b3UgY2FuIGdpdmUgT1BUSU9OQUwgcGFyYW1ldGVyXHJcblx0XHQqIHNldF9pZCB3aGljaCBzaG91bGQgYmUgYSBmdW5jdGlvbiB0aGF0IHRha2VzIG9iamVjdCBhbmQgaWQgYW5kIGFzc2lnbnNcclxuXHRcdCogaWQgdG8gdGhlIG9iamVjdC4gdGhpcyBjYW4gYmUgdXNlZnVsIGlmIHlvdSB3YW50IHRvIHN0b3JlIGlkIGluIHNvbWUgdW51c3VhbFxyXG5cdFx0KiBwbGFjZSwgb3IgcGVyZm9ybSBzb21lIGV4dHJhIG9wZXJhdGlvbnMgYmVmb3JlIGlkIGlzIGFzc2lnbmVkXHJcblx0XHQqXHJcblx0XHQqIHJldHVybiBpZCBhc3NpZ25lZFxyXG5cdFx0KiBJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIgd2lsbCByZW1lbWJlciB0aGF0IHRoaXMgaWQgaGFzIGJlZW4gYXNzaWduZWRcclxuXHRcdCogdGhpcyBvYmplY3RcclxuXHRcdCovXHJcblx0XHR2YXIgZnJlZSA9IElkZW50aWZpY2F0aW9uTW9kZWwuZnJlZV9pZHM7XHJcblx0XHR2YXIgaWQ7XHJcblxyXG5cdFx0Ly8gZ2V0IGZyZWUgaWRcclxuXHRcdGlmKGZyZWUubGVuZ3RoID4gMCl7XHJcblx0XHRcdGlkID0gZnJlZS5wb3AoKTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRpZCA9IElkZW50aWZpY2F0aW9uTW9kZWwubmV4dF9pZCsrO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIHNldCBpZCBvbiB0aGUgb2JqZWN0LiB0aHJvdWdoIGZ1bmN0aW9uIGlmIHByb3ZpZGVkXHJcblx0XHRpZihzZXRfaWQpe1xyXG5cdFx0XHRzZXRfaWQob2JqLCBpZCk7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0b2JqLmlkID0gaWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gYXNzb2NpYXRlIGlkIHdpdGggdGhlIG9iamVjdCBvYmpcclxuXHRcdElkZW50aWZpY2F0aW9uTW9kZWwuaWRfbWF0Y2hpbmdbaWRdID0gb2JqO1xyXG5cclxuXHRcdHJldHVybiBpZFxyXG5cdH07XHJcblxyXG5cdHZhciBnZXRfYnlfaWQgPSBmdW5jdGlvbihpZCl7XHJcblx0XHQvKipcclxuXHRcdCogZ2V0IG9iamVjdCBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIGlkXHJcblx0XHQqL1xyXG5cdFx0cmV0dXJuIElkZW50aWZpY2F0aW9uTW9kZWwuaWRfbWF0Y2hpbmdbaWRdO1xyXG5cdH07XHJcblxyXG5cdHZhciByZW1vdmVfaWQgPSBmdW5jdGlvbihpZCl7XHJcblx0XHQvKipcclxuXHRcdCogbWFyayBpZCBhcyBmcmVlIGFuZCBubyBsb25nZXIgYXNzaWNpYXRlIGl0IHdpdGggYW55IG9iamVjdFxyXG5cdFx0KiBub3RpY2UgdGhhdCB5b3UgeW91cnNlbGYgaXMgcmVzcG9uc2libGUgZm9yIG1ha2luZyBzdXJlXHJcblx0XHQqIHRoYXQgb2JqZWN0IHRoYXQgd2FzIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGlkIGRvZXNuJ3QgdGhpbmtcclxuXHRcdCogdGhhdCBoZSBpcyBzdGlsbCBhc3NpZ25lZCB0aGlzIGlzXHJcblx0XHQqL1xyXG5cclxuXHRcdC8vIFRPRE86IG1ha2Ugc3VyZSB0aGF0IGFsbCBrbm93biBwbGFjZXMgdGhhdCB1c2UgaWRzIChQaHlzaWNzQ29udHJvbGxlcnMnXHJcblx0XHQvLyBjb250YWN0IGxpc3RlbmVyIGZvciBleGFtcGxlKSBhcmUgbm90aWZpZWQgdGhhdCBpZCBoYWQgYmVlbiB1bnJlZ2lzdGVyZWRcclxuXHRcdGRlbGV0ZSBJZGVudGlmaWNhdGlvbk1vZGVsLmlkX21hdGNoaW5nW2lkXTtcclxuXHRcdElkZW50aWZpY2F0aW9uTW9kZWwuZnJlZV9pZHMucHVzaChpZCk7XHJcblx0fTtcclxuXHRcclxuXHR2YXIgYXNzaWduX3R5cGUgPSBmdW5jdGlvbihvYmosIHR5cGUpe1xyXG5cdFx0LyoqXHJcblx0XHQqIGFzc2lnbnMgd2FudGVkIHR5cGUgKHN0cmluZykgdG8gdGhlIGdpdmVuXHJcblx0XHQqIG1vZGVsIGRlZmluaXRpb25cclxuXHRcdCogaWYgeW91IHRyeSB0byBhc3NpZ24gc2FtZSB0eXBlIHR3aWNlLCB0aHJvd3MgZXhjZXB0aW9uO1xyXG5cdFx0KiBJZC4uLkNvbnRyb2xsZXIgYWxsb3dzIHlvdSB0byByZXRyaWV2ZSBtb2RlbFxyXG5cdFx0Ki9cclxuXHJcblx0XHR2YXIgdHlwZXMgPSBJZGVudGlmaWNhdGlvbk1vZGVsLnR5cGVzO1xyXG5cdFx0aWYodHlwZXNbdHlwZV0pe1xyXG5cdFx0XHR0aHJvdyBcIkVycm9yOiB0eXBlIFwiICsgdHlwZSArIFwiIGlzIGFscmVhZHkgcmVnaXN0ZXJlZC4gXCIgK1xyXG5cdFx0XHRcdFwiWW91IGNhbid0IHJlZ2lzdGVyIHRoZSBzYW1lIHR5cGUgdHdpY2VcIjtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHR0eXBlc1t0eXBlXSA9IG9iajtcclxuXHRcdFx0b2JqLnByb3RvdHlwZS50eXBlID0gdHlwZTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdH07XHJcblx0XHJcblx0dmFyIGdldF9ieV90eXBlID0gZnVuY3Rpb24odHlwZSl7XHJcblx0XHQvKipcclxuXHRcdCogZ2V0cyBvYmplY3QgYnkgaXQncyB0eXBlXHJcblx0XHQqL1xyXG5cdFx0dmFyIHR5cGVzID0gSWRlbnRpZmljYXRpb25Nb2RlbC50eXBlcztcclxuXHRcdGlmKHR5cGVzW3R5cGVdKXtcclxuXHRcdFx0cmV0dXJuIHR5cGVzW3R5cGVdO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdHRocm93IFwiRXJyb3I6IHR5cGUgXCIgKyB0eXBlICsgXCIgd2Fzbid0IGRlZmluZWQgeWV0XCI7XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHRcclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0dXBkYXRlOiB1cGRhdGUsXHJcblx0XHRhc3NpZ25faWQ6IGFzc2lnbl9pZCxcclxuXHRcdGdldF9ieV9pZDogZ2V0X2J5X2lkLFxyXG5cdFx0cmVtb3ZlX2lkOiByZW1vdmVfaWQsXHJcblx0XHRhc3NpZ25fdHlwZTogYXNzaWduX3R5cGUsXHJcblx0XHRnZXRfYnlfdHlwZTogZ2V0X2J5X3R5cGUsXHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gSWRlbnRpZmljYXRpb25Db250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiSWRlbnRpZmljYXRpb25Db250cm9sbGVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5PV05fTU9ERUxcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwidmFyIEluaXRDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0Ly8gd2h5IGRvIHlvdSB3YW50IHRvIHB1dCBpbml0aWFsaXphdGlvbiBvZiBldmVyeXRoaW5nIGludG8gdGhlIEluaXRDb250cm9sbGVyP1xyXG5cdC8vIEJlY2F1c2UgaWYgaW5pdGlhbGl6YXRpb24gb2Ygc210aCBkZXBlbmRzIG9uIGluaXRpYWxpemF0aW9uIG9mIHNtdGggZWxzZSxcclxuXHQvLyBpdCdzIGVhc2llciB0byBjb250cm9sIGhlcmVcclxuXHQvL1xyXG5cdC8vIGUuZy4gaWYgeW91IHRyeSB0byBkbyB2YXIgZm9vID0gJCgnI2ZvbycpOyBzb21ld2hlcmUgaW4gb3RoZXIgbW9kdWxlLFxyXG5cdC8vIHlvdSBjYW4gZ2V0IGZvbyA9IG51bGw7IGFzIGNvZGUgb2YgdGhhdCBtb2R1bGUgY2FuIGV4ZWN1dGUgYmVmb3JlIHRoZSBodG1sIGRvY3VtZW50XHJcblx0Ly8gd2FzIGZ1bGx5IGxvYWRlZCwgYnV0ID5Jbml0Q29udHJvbGxlci5pbml0PCBpcyBjYWxsZWQgYWZ0ZXIgZG9jdW1lbnQgd2FzIGxvYWRlZCwgc29cclxuXHQvLyAtMSBwb3RlbnRpYWwgcHJvYmxlbS4gQnR3LCBhdCB0aGlzIG1vbWVudCBpbiB0aW1lIHRoZSB0aGUgc3R1ZmYgaXMgc2V0IHRvIHdvcmsgdGhhdCB3YXlcclxuXHQvLyB1c2luZyBodG1sICg8Ym9keSBvbmxvYWQ9Li4uKTsgbWF5YmUgdXNpbmcgSlMgd291bGQgYmUgYmV0dGVyPyBJZGs7XHJcblx0XHRcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbihtb2RlKXtcclxuXHRcdGluY2x1ZGUoKTtcclxuXHJcblx0XHRlbmFibGVfYXJyb3drZXlfc2Nyb2xsKGZhbHNlKTtcclxuXHRcdHNldHVwX3NjcmVlbigpO1xyXG5cdFx0c2V0dXBfZXZlbnRzKCk7XHJcblxyXG5cdFx0aW5pdF9hbGxfbW9kdWxlcyhtb2RlKTsgLy8gY2FsbCAuaW5pdCBmdW5jdGlvbiBvZiBldmVyeW9uZS4gZS5nLiBQbGF5ZXJDb250cm9sbGVyLmluaXQoKTsgZXRjLlxyXG5cclxuXHRcdFxyXG5cdFx0Ly8gTm90aWNlIHRoYXQgYXNzZXQgZGVwZW5kZW50IHN0dWZmIGRvZXNuJ3QgKGFuZCBtdXN0bid0KSBzdGFydCB1bnRpbFxyXG5cdFx0Ly8gYWxsIGFzc2V0cyBhcmUgY29tcGxldGVseSBsb2FkZWQuIFRoYXQgaW5jbHVkZXMgdGlja2VyLCBpLmUuIG5vIHRpY2tzIGFyZSBwcm9jZXNzZWRcclxuXHRcdC8vIHVudGlsIGV2ZXJ5dGhpbmcgaXMgbG9hZGVkLiBJZiB5b3Ugd2FudCBzb21ldGhpbmcgZGlmZmVyZW50LCBlLmcuIGRpc3BsYXkgc29tZSBzb3J0IG9mIGxvYWRpbmdcclxuXHRcdC8vIGFuaW1hdGlvbiAtIGxldCBtZSBrbm93LlxyXG5cdFx0Ly8gTG9vayBpbnRvIHRoZSBzZXR1cF9hc3NldF9kZXBlbmRlbnQgZnVuY3Rpb25cclxuXHRcdFx0QXNzZXRNb2RlbC5sb2FkZXIgPSBuZXcgY3JlYXRlanMuTG9hZFF1ZXVlKGZhbHNlKTsgLy8gbG9hZGluZyByZXNvdXJzZXMgdXNpbmcgcHJlbG9hZC5qc1xyXG5cdFx0XHRBc3NldE1vZGVsLmxvYWRlci5hZGRFdmVudExpc3RlbmVyKFwiY29tcGxldGVcIiwgc2V0dXBfYXNzZXRfZGVwZW5kYW50KTtcclxuXHJcblx0XHQvLyBpZiBtb3JlIHN0dWZmIG5lZWRzIHRvIGJlIGRvbmUgZm9yIHRoZSB0ZXN0IG1vZGUsIFxyXG5cdFx0Ly8gb3IgbW9yZSB0eXBlcyBvZiBpdCBuZWVkcyB0byBiZSBhZGRlZFxyXG5cdFx0Ly8geW91IGNhbiBzYWZlbHkgbWFrZSB0aGUgZm9sbG93aW5nIGEgc2VwYXJhdGUgZnVuY3Rpb25cclxuXHRcdFx0dmFyIGFzc2V0X3BhdGggPSAobW9kZSA9PSBcInRlc3RcIikgPyBcIi4vYXNzZXRzL2FydC9cIiA6IFwiLi4vR2FtZUNvZGUvYXNzZXRzL2FydC9cIjtcclxuXHJcblx0XHRBc3NldENvbnRyb2xsZXIuaW5pdChhc3NldF9wYXRoKTtcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIGluaXRfYWxsX21vZHVsZXMgPSBmdW5jdGlvbihtb2RlKXtcclxuXHRcdC8vIFRPRE86IGJldHRlciB3YXkgdG8gZG8gc3R1ZmYgbGlrZSB0aGF0IChjYWxsIGNlcnRhaW4gZnVuY3Rpb25cclxuXHRcdC8vIG9mIGV2ZXJ5IG1vZHVsZSBpbiB0aGUgb3JkZXIuIFxyXG5cdFx0Ly8gQWxzbywgaW5pdCBhbmQgdXBkYXRlIGZ1bmN0aW9ucyBvZiBlYWNoIG1vZHVsZSBzaG91bGQgcHJvYmFibHlcclxuXHRcdC8vIGFjY2VwdCBzb21lIGFyZ3VtZW50LiBJIHRoaW5rIHRvIG1ha2UgdGhpcyBhcmd1bWVudCBhbiBvYmplY3QsXHJcblx0XHQvLyB0aGlzIHdheSB3ZSBjYW4gYWRkIG1vcmUgdGhpbmdzIHRvIGJlIHBhc3NlZCB3L28gYW55IHByb2JsZW0gYW5kXHJcblx0XHQvLyB3ZSB3b24ndCBuZWVkIHRvIGNoYW5nZSBhbnl0aGluZ1xyXG5cdFx0XHJcblx0XHRCMmQuaW5pdCgpOyAvLyBnb2VzIGZpcnN0XHJcblx0XHRJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0UmVnaXN0ZXJBc0NvbnRyb2xsZXIuaW5pdCgpO1xyXG5cclxuXHRcdC8vQXNzZXRDb250cm9sbGVyLmluaXQoKTsgLy8gY2FsbGVkIGZyb20gdGhlIEluaXRDb250cm9sbGVyLmluaXQvLyBzdHVmZiBoYXMgdG8gY2hhbmdlXHJcblx0XHRHYW1lQ29udHJvbGxlci5pbml0KCk7XHJcblx0XHRLZXlib2FyZENvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0UGh5c2ljc0NvbnRyb2xsZXIuaW5pdCgpO1xyXG5cclxuXHRcdFRlc3RDb250cm9sbGVyLmluaXQobW9kZSk7XHJcblx0XHRcclxuXHJcblx0XHQvL1BsYXllckNvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0VGVycmFpbkNvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0VGVycmFpblNsaWNlQ29udHJvbGxlci5pbml0KCk7XHJcblx0XHRXb3JsZENvbnRyb2xsZXIuaW5pdCgpO1xyXG5cclxuXHRcdC8vIFdBUk5JTkchISEgR3JhcGhpY3NDb250cm9sbGVyLmluaXQgaXMgY2FsbGVkIGZyb20gdGhlXHJcblx0XHQvLyBzZXR1cF9hc3NldF9kZXBlbmRlbnQgZnVuY3Rpb24gYXMgaXQsIHdlbGwsIGRlcGVuZHMgb24gYXNzZXRzIGJlaW5nIGxvYWRlZFxyXG5cclxuXHR9O1xyXG5cclxuXHJcblx0dmFyIGVuYWJsZV9hcnJvd2tleV9zY3JvbGwgPSBmdW5jdGlvbihlbmFibGVfc2Nyb2xsKXtcclxuXHRcdGlmKGVuYWJsZV9zY3JvbGwgPT0gZmFsc2UpeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGUpeyAvLyAuZ2V0RWxlbWVudEJ5SWQoXCJkaXNwbGF5X2NhbnZhc1wiKVxyXG5cdFx0XHRcdGFycm93cyA9IFszNywgMzgsIDM5LCA0MF07ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcblx0XHRcdFx0aWYoYXJyb3dzLmluZGV4T2YoZS5rZXlDb2RlKSA+IC0xKXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHRcdFx0XHR9ZWxzZXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG5cdFx0XHRcdFx0cmV0dXJuIHRydWUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG5cdFx0XHRcdH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcblx0XHRcdH0pICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG5cdFx0fVx0XHRcclxuXHR9O1xyXG5cdFxyXG5cdHZhciBzZXR1cF9zY3JlZW4gPSBmdW5jdGlvbigpe1xyXG5cclxuXHRcdC8vIFNldHRpbmcgdXAgb3RoZXIgc3R1ZmY6XHJcblx0XHQvLyBlLmcgc2V0dXAgY2FudmFzIHNpemVcclxuXHRcdFxyXG5cdFx0Ly8gVE9ETzogYWxsb3cgcmVzaXplcz9cclxuXHJcblx0XHRDb25maWcuU0NSRUVOX1cgPSAkKCcjY2FudmFzX2NvbnRhaW5lcicpLndpZHRoKCk7IC8vIGlzIGR5bmFtaWNhbGx5IHNldCB0byBwaXhlbCB3aWR0aCBvZiB0aGUgY29udGFpbmluZyBlbGVtZW50XHJcblxyXG5cdFx0Ly8gcG9zc2libGUgcmVzaXppbmcgdGVjaG5pcXVlOiBcclxuXHRcdC8vIGh0dHA6Ly93d3cuZmFiaW9iaW9uZGkuY29tL2Jsb2cvMjAxMi8wOC9jcmVhdGVqcy1hbmQtaHRtbDUtY2FudmFzLXJlc2l6ZS1mdWxsc2NyZWVuLWFuZC1saXF1aWQtbGF5b3V0cy9cclxuXHJcblx0XHRcclxuXHRcdC8vJCgnI2RlYnVnX2NhbnZhcycpLndpZHRoKFN0cmluZyhTQ1JFRU5fVykgKyBcInB4XCIpO1xyXG5cdFx0Ly8kKCcjZGlzcGxheV9jYW52YXMnKS53aWR0aChTdHJpbmcoU0NSRUVOX1cpICsgXCJweFwiKTtcclxuXHJcblx0XHQvLyQoJyNkZWJ1Z19jYW52YXMnKS5oZWlnaHQoU3RyaW5nKFNDUkVFTl9IKSArIFwicHhcIik7XHJcblx0XHQvLyQoJyNkaXNwbGF5X2NhbnZhcycpLmhlaWdodChTdHJpbmcoU0NSRUVOX0gpICsgXCJweFwiKTtcclxuXHRcdFxyXG5cdH07XHJcblxyXG5cdHZhciBzZXR1cF90aWNrZXIgPSBmdW5jdGlvbigpe1xyXG5cclxuXHRcdGNyZWF0ZWpzLlRpY2tlci5zZXRGUFMoQ29uZmlnLkZQUyk7XHJcblxyXG5cdFx0Ly8gdGlja2VyOiBvbiBlYWNoIHRpY2sgY2FsbCBHYW1lQ29udHJvbGxlci51cGRhdGVfYWxsKCk7XHJcblx0XHRjcmVhdGVqcy5UaWNrZXIuYWRkRXZlbnRMaXN0ZW5lcihcInRpY2tcIiwgR2FtZUNvbnRyb2xsZXIudXBkYXRlX2FsbCk7XHJcblxyXG5cdFxyXG5cdH07XHJcblxyXG5cdHZhciBzZXR1cF9ldmVudHMgPSBmdW5jdGlvbigpe1xyXG5cclxuXHJcblx0XHQvLyBrZXlib2FyZCBpbnB1dCBldmVudDogb24gZWFjaCBrZXlib2FyZCBldmVudCBjYWxsIGFwcHJvcHJpYXRlIEtleWJvYXJkQ29udHJvbGxlciBmdW5jdGlvblxyXG5cdFx0ZG9jdW1lbnQub25rZXlkb3duID0gS2V5Ym9hcmRDb250cm9sbGVyLmtleWRvd247XHJcblx0XHRkb2N1bWVudC5vbmtleXVwID0gS2V5Ym9hcmRDb250cm9sbGVyLmtleXVwO1xyXG5cclxuXHRcdFx0Ly8gb24gaW50ZXJydXB0IGV2ZW50OiBzdG9wL3BhdXNlIHRpY2tlciA/XHJcblxyXG5cdH07XHJcblxyXG5cdHZhciBzZXR1cF9hc3NldF9kZXBlbmRhbnQgPSBmdW5jdGlvbigpe1xyXG5cdFx0Ly8gdGhpcyBtYXkgbmVlZCB0byBtb3ZlIHRvIGVpdGhlciBsb2FkX2dhbWUgb3Igc29tZSBzb3J0IG9mIHJlc2l6aW5nIGZ1bmN0aW9uXHJcblx0XHRcclxuXHRcdEVudGl0eUNvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0R3JhcGhpY3NDb250cm9sbGVyLmluaXQoKTtcclxuXHRcdEhVRENvbnRyb2xsZXIuaW5pdCgpO1xyXG5cdFx0Ly9CYWNrZ3JvdW5kQ29udHJvbGxlci5pbml0KCk7XHJcblxyXG5cclxuXHRcdHNldHVwX3RpY2tlcigpO1xyXG5cclxuXHRcdC8vVGVycmFpbkNvbnRyb2xsZXIuZ2VuZXJhdGVfdGVycmFpbigpOyAvLyBJbml0aWFsIHRlcnJhaW4gZ2VuZXJhdGlvbiAvLyBkZXByZWNhdGVkLCBnZW5lcmF0aW9uIHdpbGwgYmUgY2FsbGVkIGZyb20gdXBkYXRlIGVhY2ggdGlja1xyXG5cdH07XHJcblxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0aW5pdDogaW5pdCxcclxuXHR9O1xyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBJbml0Q29udHJvbGxlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkluaXRDb250cm9sbGVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5BTExcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuIiwidmFyIEtleWJvYXJkQ29udHJvbGxlciA9IChmdW5jdGlvbigpXHJcbntcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHJcblx0XHRpbmNsdWRlKCk7XHJcblx0fTtcclxuXHRcclxuXHR2YXIgZ2V0X2FjdGl2ZV9jb21tYW5kc19mdW5jdGlvbiA9IGZ1bmN0aW9uKHRhYmxlKXtcclxuXHRcdC8vIGdldCBhbGwgY29tbWFuZHMgYXNzb2NpYXRlZCB3aXRoIGtleXMgdGhhdCBhcmUgZGVmaW5lZCBpbiB0aGUgPnRhYmxlPCxcclxuXHRcdC8vIGFuZCBhcmUgY3VycmVudGx5IHByZXNzZWRcclxuXHRcdC8vXHJcblx0XHQvLyByZXR1cm5zOiBhcnJheSBvZiBjb21tYW5kc1xyXG5cdFx0Ly9cclxuXHRcdC8vIFRPRE86IFJFRkFDVE9SIHRoaXMgZnVuY3Rpb24gdG8gd29yayBiZXR0ZXIgYW5kIHNvIHBlb3BsZSBkbyBub3RcclxuXHRcdC8vIG5lZWQgdG8gY2FsbCBpdCBlYWNoIHRpY2suIGluc3RlYWQgdGhleSBzaG91bGQgZ2V0IHJlZmVyZW5jZSB0byBmdW5jdGlvbiBvbmUgdGltZVxyXG5cdFx0Ly8gYW5kIHN0YXkgdXBkYXRlZCBvbiB0aGUgYWN0aXZlIGNvbW1hbmRzXHJcblx0XHRcclxuXHRcdHZhciBjb21tYW5kcyA9IFtdO1xyXG5cdFx0XHJcblx0XHQkLmVhY2goS2V5Ym9hcmRNb2RlbC50cmFuc2xhdGlvbl90YWJsZXMuY29kZV90b19uYW1lLCBmdW5jdGlvbihrZXksIGNtZCl7XHJcblx0XHRcdGlmKEtleWJvYXJkTW9kZWwua2V5c1trZXldICYmIHRhYmxlW2NtZF0pe1xyXG5cdFx0XHRcdGNvbW1hbmRzLnB1c2godGFibGVbY21kXSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdHZhciBnZXRfa2V5ID0gZnVuY3Rpb24oa2V5KXtcclxuXHRcdFx0aWYoY29tbWFuZHMuaW5kZXhPZihrZXkpID4gLTEpe1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2VcclxuXHRcdFx0fTtcclxuXHRcdH07XHJcblxyXG5cdFx0cmV0dXJuIGdldF9rZXk7XHJcblx0fTtcclxuXHJcblx0Ly8gcHVibGljOlxyXG5cdFxyXG5cdHZhciBrZXlkb3duID0gZnVuY3Rpb24oZXZlbnQpe1xyXG5cdFx0S2V5Ym9hcmRNb2RlbC5rZXlzW2V2ZW50LmtleUNvZGVdID0gdHJ1ZTtcclxuXHR9O1xyXG5cclxuXHR2YXIga2V5dXAgPSBmdW5jdGlvbihldmVudCl7XHJcblx0XHRkZWxldGUgS2V5Ym9hcmRNb2RlbC5rZXlzW2V2ZW50LmtleUNvZGVdO1xyXG5cdH07XHJcblxyXG5cclxuXHR2YXIgbW92ZW1lbnRfY29tbWFuZHMgPSBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIGdldF9hY3RpdmVfY29tbWFuZHNfZnVuY3Rpb24oS2V5Ym9hcmRNb2RlbC50cmFuc2xhdGlvbl90YWJsZXMubW92ZW1lbnQpO1xyXG5cdH07XHJcblxyXG5cdHZhciBwYXVzZV9jb21tYW5kcyA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgcmV0dXJuIGdldF9hY3RpdmVfY29tbWFuZHNfZnVuY3Rpb24oS2V5Ym9hcmRNb2RlbC50cmFuc2xhdGlvbl90YWJsZXMucGF1c2UpO1xyXG5cdH07XHJcblxyXG5cdHZhciBkZWJ1Z19jb21tYW5kcyA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKipcclxuXHRcdCogY29tbWFuZHMgYWN0aXZlIGluIGRlYnVnIG1vZGVcclxuXHRcdCovXHJcblx0XHRyZXR1cm4gZ2V0X2FjdGl2ZV9jb21tYW5kc19mdW5jdGlvbihLZXlib2FyZE1vZGVsLnRyYW5zbGF0aW9uX3RhYmxlcy5kZWJ1Zyk7XHJcblx0fTtcclxuXHRcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGtleWRvd246IGtleWRvd24sXHJcblx0XHRrZXl1cDoga2V5dXAsXHJcbiAgICAgICAgcGF1c2VfY29tbWFuZHM6IHBhdXNlX2NvbW1hbmRzLFxyXG5cdFx0bW92ZW1lbnRfY29tbWFuZHM6IG1vdmVtZW50X2NvbW1hbmRzLFxyXG5cdFx0ZGVidWdfY29tbWFuZHM6IGRlYnVnX2NvbW1hbmRzLFxyXG5cdFx0aW5pdDogaW5pdCxcclxuXHR9O1xyXG5cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gS2V5Ym9hcmRDb250cm9sbGVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiS2V5Ym9hcmRDb250cm9sbGVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUXHJcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cclxuXHJcbiIsIi8vIE5vdGVzOlxyXG4vLyBub3RpY2UgdGhhdCB5b3UgY2FuIHJldXNlIGJvZHkgZGVmaW5pdGlvbnMgbXVsdGlwbGUgdGltZXMsIGl0IG1ha2VzIHNlbnNlIHRvIGhhdmVcclxuLy8gY29sbGVjdGlvbiBvZiBib2R5IGRlZmluaXRpb25zIHRoYXQgYXJlIGNvbW1vbmx5IHVzZSBhbmQgbWF5YmUgYWxsb3cgc29tZSBzb3J0IG9mIFxyXG4vLyBpbmhlcml0YW5jZSAoaS5lLiB5b3UgY2FuIG1ha2Ugc29tZSBkZWZpbml0aW9uIG9uIHRvcCBvZiB0aGUgYW5vdGhlciBkZWZpbml0aW9uKVxyXG4vLyAvLyBib2RpZXMgYXJlIGFsbG93ZWQgdG8gaGF2ZSB1c2VyRGF0YSBvbiB0aGVtIHRoYXQgaXMganVzdCByZWZlcmVuY2UgdG8gc29tZSBvYmplY3QuXHJcbi8vIG1heSBiZSB1c2VmdWwgaW4gc29tZSBzaXR1YXRpb25zXHJcbi8vXHJcbi8vIFF1ZXN0aW9uOlxyXG4vLyBkb2VzIGl0IG1ha2Ugc2Vuc2UgdG8gYWxsb3cgdXNlcnMgdG8gcGFzcyBhbnkgcHJvcGVydGllcyBhcyBwYXJ0IG9mIG9iamVjdCBkZWZpbml0aW9uXHJcbi8vIGFuZCBqdXN0IGFwcGx5IHRob3NlIHByb3BlcnRpZXMgYXV0b21hdGljYWxseSB0byB0aGUgdXNlckRhdGEgcHJvcGVydHkgb2YgYm9keT9cclxuXHJcbnZhciBCMmRDb25maWc7XHJcblxyXG52YXIgUGh5c2ljc0NvbnRyb2xsZXIgPSAoZnVuY3Rpb24oKXtcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0aW5jbHVkZSgpO1xyXG5cclxuXHRcdEIyZENvbmZpZyA9IENvbmZpZy5CMkQ7XHJcblxyXG5cdFx0UGh5c2ljc01vZGVsLnNjYWxlID0gQjJkQ29uZmlnLlNDQUxFO1xyXG5cdFx0UGh5c2ljc01vZGVsLnN0ZXBfYW1vdW50ID0gMS8oQjJkQ29uZmlnLlNQUyk7XHJcblxyXG5cdFx0UGh5c2ljc01vZGVsLmdyYXZpdHkgPSBuZXcgQjJkLmIyVmVjMigwLDMwKTsgLy8gZWFydGggZ3Jhdml0eVxyXG5cdFx0UGh5c2ljc01vZGVsLndvcmxkID0gbmV3IEIyZC5iMldvcmxkKFBoeXNpY3NNb2RlbC5ncmF2aXR5LCB0cnVlKTtcclxuXHJcblx0XHRpbml0X2NvbGxpc2lvbl9saXN0ZW5lcigpO1xyXG5cclxuXHR9O1xyXG5cdFxyXG5cdHZhciBzdGVwID0gZnVuY3Rpb24gKGRlbHRhX21zKSB7XHJcblx0XHQvLyAhPyBzaG91bGQgSSBzZXQgdXBwZXIgbGltaXQgb24gZGVsdGEgdG8gcHJldmVudCB3b3JsZCBmcm9tXHJcblx0XHQvLyBmYXN0IGZvcndhcmRpbmcgaWYgdGhlIHRpY2tlciB3YXMgcGF1c2VkPyBvciB0aGF0IGlzIG5vdCBhIHByb2JsZW0gaW4gb3VyIGNhc2U/XHJcblx0XHQvLyBpbnZlc3RpZ2F0aW9uIGlzIG5lZWRlZFxyXG5cclxuXHRcdHZhciBkZWx0YSA9IGRlbHRhX21zLzEwMDA7XHJcblxyXG5cdFx0UGh5c2ljc01vZGVsLnRpbWVUb0NvdmVyICs9IGRlbHRhO1xyXG5cclxuXHRcdHdoaWxlIChQaHlzaWNzTW9kZWwudGltZVRvQ292ZXIgPiBQaHlzaWNzTW9kZWwuc3RlcF9hbW91bnQpIHtcclxuXHRcdFx0UGh5c2ljc01vZGVsLnRpbWVUb0NvdmVyIC09IFBoeXNpY3NNb2RlbC5zdGVwX2Ftb3VudDtcclxuXHRcdFx0UGh5c2ljc01vZGVsLndvcmxkLlN0ZXAoXHJcblx0XHRcdFx0UGh5c2ljc01vZGVsLnN0ZXBfYW1vdW50LFxyXG5cdFx0XHRcdEIyZENvbmZpZy5QT1NJVElPTl9JVFIsIC8vIHZlbG9jaXR5IGl0ZXJhdGlvbnNcclxuXHRcdFx0XHRCMmRDb25maWcuVkVMT0NJVFlfSVRSIC8vIHBvc2l0aW9uIGl0ZXJhdGlvbnNcclxuXHRcdFx0KTtcclxuXHRcdH1cclxuXHR9OyAgLy8gZW5kIHN0ZXAgXHJcblxyXG5cdHZhciBkcmF3X2RlYnVnID0gZnVuY3Rpb24oKXtcclxuXHRcdGlmIChCMmRDb25maWcuZGVidWdfZHJhdykge1xyXG5cdFx0XHRQaHlzaWNzTW9kZWwud29ybGQuRHJhd0RlYnVnRGF0YSgpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHZhciBnZXRfcGFyZW50X2NoYWluID0gZnVuY3Rpb24odGVtcGxhdGUsIGRlZmF1bHRfZGVmKXtcclxuXHRcdHZhciBuZXh0ID0gdGVtcGxhdGU7XHJcblx0XHR2YXIgYW5jZXN0b3JzID0gW107XHJcblxyXG5cdFx0d2hpbGUobmV4dCAhPSBudWxsKXtcclxuXHRcdFx0YW5jZXN0b3JzLnB1c2gobmV4dCk7XHJcblx0XHRcdG5leHQgPSBuZXh0W1wicGFyZW50XCJdO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKGRlZmF1bHRfZGVmKXtcclxuXHRcdFx0YW5jZXN0b3JzLnB1c2goZGVmYXVsdF9kZWYpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBhbmNlc3RvcnM7XHJcblx0XHRcclxuXHR9O1xyXG5cclxuXHR2YXIgYXBwbHlfcGFyZW50cyA9IGZ1bmN0aW9uKHRlbXBsYXRlX25hbWUsIHRlbXBsYXRlX2NvbGxlY3Rpb24pe1xyXG5cdFx0Ly8gVE9ETzogcmVmYWN0b3IgdGhlIGNvZGUgc28gdGhpcyB0aGluZyBpcyBkb25lIG9ubHkgb25jZVxyXG5cdFx0Ly8gYXQgdGhlIGxvYWQgdGltXHJcblx0XHQvLyB0aGF0IGNvdWxkIHByb2JhYmx5IGJlIGRvbmUgZXZlbiBmb3Igb3RoZXIgdGhpbmdzLlxyXG5cdFx0Ly8gaWRlYTogc3RvcmUgY29tcGlsZWQgYm9keS9maXh0dXJlIGV0Yy4gdG9nZXRoZXIgd2l0aCB0aGVcclxuXHRcdC8vIHRlbXBsYXRlLiB0aGlzIHdheSB5b3UnbGwgaGF2ZSBlYXN5IGFjY2VzcyB0byB0aGUgYWxsIGRlZmluZWRcclxuXHRcdC8vIG9wdGlvbnMgZm9yIGRlYnVnZ2luZztcclxuXHRcdFxyXG5cdFx0dmFyIGRlZmF1bHRfdG1wbGF0ZSA9IHRlbXBsYXRlX2NvbGxlY3Rpb25bXCJkZWZhdWx0XCJdO1xyXG5cclxuXHRcdHZhciBjaGFpbiA9IGdldF9wYXJlbnRfY2hhaW4odGVtcGxhdGVfY29sbGVjdGlvblt0ZW1wbGF0ZV9uYW1lXSwgZGVmYXVsdF90bXBsYXRlKTtcclxuXHJcblx0XHR2YXIgZmluYWxfZGVmaW5pdGlvbiA9IHt9O1xyXG5cclxuXHRcdGZvcih2YXIgaSA9IGNoYWluLmxlbmd0aCAtIDE7IGkgPj0gMCA7IGktLSl7XHJcblx0XHRcdC8vIG1heSBiZSBuZWVkZWQgdG8gYmUgbWFkZSBtb3JlIGVmZmljaWVudCBieSBtb3ZpbmcgdGhlIG90aGVyIHdheVxyXG5cdFx0XHQvLyBhbmQgbm90IGNvbnNpZGVyaW5nIG9wdGlvbnMgdGhhdCB3ZXJlIGFscmVhZHkgZW5jb3VudGVyZWQgaW4gY2hpbGRyZW5cclxuXHRcdFx0dmFyIGN1cnJlbnQgPSBjaGFpbltpXTtcclxuXHJcblxyXG5cdFx0XHRmb3IodmFyIHByb3AgaW4gY3VycmVudCl7XHJcblx0XHRcdFx0ZmluYWxfZGVmaW5pdGlvbltwcm9wXSA9IGN1cnJlbnRbcHJvcF07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmluYWxfZGVmaW5pdGlvbjtcclxuXHR9OyAvLyBlbmQgYXBwbHlfcGFyZW50c1xyXG5cdFx0XHJcblx0dmFyIHRhcmdldF9wcm9wcyA9IHtcclxuXHRcdGJvZHlfZGVmOiBbXHJcblx0XHRcdFwiYWN0aXZlXCIsXHJcblx0XHRcdFwiYWxsb3dTbGVlcFwiLFxyXG5cdFx0XHRcImFuZ2xlXCIsXHJcblx0XHRcdFwiYW5ndWxhckRhbXBpbmdcIixcclxuXHRcdFx0XCJhbmd1bGFyVmVsb2NpdHlcIixcclxuXHRcdFx0XCJhd2FrZVwiLFxyXG5cdFx0XHRcImJ1bGxldFwiLFxyXG5cdFx0XHRcImZpeGVkUm90YXRpb25cIixcclxuXHRcdFx0XCJpbmVydGlhU2NhbGVcIixcclxuXHRcdFx0XCJsaW5lYXJEYW1waW5nXCIsXHJcblx0XHRcdFwibGluZWFyVmVsb2NpdHlcIixcclxuXHRcdFx0XCJwb3NpdGlvblwiLFxyXG5cdFx0XHRcInR5cGVcIixcclxuXHRcdFx0Ly9cInVzZXJEYXRhXCIgLy8gZG9lc24ndCBzZWVtIHRvIHByb3Blcmx5IHdvcmssIGRvaW5nIGl0IGRpZmZlcmVudGx5XHJcblx0XHRdLFxyXG5cdFx0Zml4dHVyZV9kZWY6IFtcclxuXHRcdFx0XCJkZW5zaXR5XCIsXHJcblx0XHRcdC8vXCJmaWx0ZXJcIiwgaW1wbGVtZW50IGxhdGVyIGlmIG5lZWRlZFxyXG5cdFx0XHRcImZyaWN0aW9uXCIsXHJcblx0XHRcdFwiaXNTZW5zb3JcIixcclxuXHRcdFx0XCJyZXN0aXR1dGlvblwiLFxyXG5cdFx0XHRcInNoYXBlXCIsXHJcblx0XHRcdFwidXNlckRhdGFcIlxyXG5cdFx0XVxyXG5cdH07XHJcblxyXG5cdHZhciBhcHBseV9wcm9wZXJ0eV9saXN0ID0gZnVuY3Rpb24oc291cmNlLCBkZXN0aW5hdGlvbiwgbGlzdCl7XHJcblx0XHQvKipcclxuXHRcdCAqIHRha2VzIHR3byBvYmplY3RzIGFuZCB0aGUgbGlzdCBvZiBzdHJpbmdzXHJcblx0XHQgKiBjb3BpZXMgYWxsIHByb3BlcnRpZXMgd2l0aCBuYW1lcyBmb3VuZCBpbiB0aGUgbGlzdFxyXG5cdFx0ICogZnJvbSBzb3VyY2UgdG8gZGVzdGluYXRpb25cclxuXHRcdCAqIHNjaXBzIHByb3BlcnRpZXMgd2hpY2ggYXJlIG51bGwvdW5kZWZpbmVkXHJcblx0XHQgKi9cclxuXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKyl7XHJcblx0XHRcdHZhciBwcm9wID0gbGlzdFtpXTtcclxuXHRcdFx0aWYoc291cmNlW3Byb3BdICE9IG51bGwpe1xyXG5cdFx0XHRcdGRlc3RpbmF0aW9uW3Byb3BdID0gc291cmNlW3Byb3BdO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGRlc3RpbmF0aW9uO1xyXG5cdH07XHJcblxyXG5cdHZhciBQcm9wZXJ0eVVuZGVmaW5lZCA9IGZ1bmN0aW9uIFByb3BlcnR5VW5kZWZpbmVkKHByb3BlcnR5X25hbWUpe1xyXG5cdFx0dGhpcy5uYW1lID0gXCJQcm9wZXJ0eVVuZGVmaW5lZFwiO1xyXG5cdFx0dGhpcy5tZXNzYWdlID0gXCJFcnJvcjogXCIgKyBwcm9wZXJ0eV9uYW1lICsgXCIgaXMgbm90IGRlZmluZWRcIjtcclxuXHR9O1xyXG5cdFByb3BlcnR5VW5kZWZpbmVkLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcclxuXHRQcm9wZXJ0eVVuZGVmaW5lZC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQcm9wZXJ0eVVuZGVmaW5lZDtcclxuXHJcblx0dmFyIGdldF9mb3JtYWxfYm9keV9kZWYgPSBmdW5jdGlvbihub25fZm9ybWFsX2RlZil7XHJcblx0XHQvKipcclxuXHRcdCAqIHR1cm4gbm9uIGZvcm1hbCBkZWZpbml0aW9uIGludG8gdGhlIGZvcm1hbCBvbmVcclxuXHRcdCAqIG5vbi1mb3JtYWwgZGVmaW5pdGlvbiBpcyBhbiBvYmplY3QgdGhhdCBjb250YWluc1xyXG5cdFx0ICogcHJvcGVydGllcyBTT01FIG9mIHdoaWNoIGFyZSBib3gyZCBwcm9wZXJ0aWVzIG9yIGFyZSBcclxuXHRcdCAqIGludGVuZGVkIHRvIGJlIHRyYW5zZm9ybWVkIGludG8gc3VjaC4gRS5nLiB0aGUgbm9uLWZvcm1hbFxyXG5cdFx0ICogZGVmaW5pdGlvbiBtYXkgY29udGFpbiBwcm9wZXJ0aWVzIHZ4IGFuZCB2eSB3aGljaCB3aWxsIGJlIHRyYW5zZm9ybWVkXHJcblx0XHQgKiBpbnRvIHRoZSBsaW5lYXJWZWxvY2l0eSB2ZWN0b3IgaW4gdGhlIGZvcm1hbCBkZWZpbml0aW9uXHJcblx0XHQgKi9cclxuXHJcblx0XHR2YXIgbmZkZWYgPSBub25fZm9ybWFsX2RlZjtcclxuXHJcblx0XHR2YXIgZGVmaW5pdGlvbiA9IG5ldyBCMmQuYjJCb2R5RGVmKCk7XHJcblxyXG5cdFx0aWYobmZkZWYudnggIT0gbnVsbCAmJiBuZmRlZi52eSAhPSBudWxsKXtcclxuXHRcdFx0Ly8gY2hlY2sgZm9yIGluZm9ybWFsIHBhcmFtZXRlciBzcGVjaWZpY2F0aW9uIGZpcnN0XHJcblx0XHRcdG5mZGVmLmxpbmVhclZlbG9jaXR5ID0gbmV3IEIyZC5iMlZlYzIobmZkZWYudngsIG5mZGVmLnZ5KTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHQvLyBtYXliZSB0aGUgbGluZWFyVmVsb2NpdHkgd2FzIHNwZWNpZmllZCBkaXJlY3RseSBhcyB2ZWN0b3IsXHJcblx0XHRcdC8vIGFuZCBub3QgdGhyb3VnaCBpbmZvcm1hbCBwYXJhbWV0ZXJzOyBjaGVja2luZyB0aGF0LCBhbmQgaWYgbm90LFxyXG5cdFx0XHQvLyBleGNlcHRpb25cclxuXHRcdFx0aWYoIShuZmRlZi5saW5lYXJWZWxvY2l0eSkpe1xyXG5cdFx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcImxpbmVhclZlbG9jaXR5XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0aWYobmZkZWYueCAhPSBudWxsICYmIG5mZGVmLnkgIT0gbnVsbCl7XHJcblx0XHRcdC8vIHNhbWUgcHJvY2VkdXJlIGFzIGZvciB0aGUgbGluZWFyIHZlbG9jaXR5XHJcblx0XHRcdC8vIGNoZWNraW5nIGZvciBpbmZvcm1hbCBzcGVjaWZpY2F0aW9uIGhlcmVcclxuXHRcdFx0Ly8gYW5kIGlmIHByZXNlbnQsIHR1cm5pbmcgaW50byB0aGUgZm9ybWFsXHJcblx0XHRcdG5mZGVmLnBvc2l0aW9uID0gbmV3IEIyZC5iMlZlYzIobmZkZWYueCwgbmZkZWYueSk7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0Ly8gY2hlY2tpbmcgaWYgZm9ybWFsIHdhcyBzcGVjaWZpZWQgZGlyZWN0bHlcclxuXHRcdFx0aWYoIShuZmRlZi5wb3NpdGlvbikpe1xyXG5cdFx0XHRcdC8vIGlmIG5vdCwgdGhyb3cgY3VzdG9tIGV4Y2VwdGlvblxyXG5cdFx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcInBvc2l0aW9uXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0aWYobmZkZWYudHlwZSl7XHJcblx0XHRcdG5mZGVmLnR5cGUgPSB7XHJcblx0XHRcdFx0XCJzdGF0aWNcIjogQjJkLmIyQm9keS5iMl9zdGF0aWNCb2R5LCBcclxuXHRcdFx0XHRcImR5bmFtaWNcIjogQjJkLmIyQm9keS5iMl9keW5hbWljQm9keSxcclxuXHRcdFx0XHRcImtpbmVtYXRpY1wiOiBCMmQuYjJCb2R5LmIyX2tpbmVtYXRpY0JvZHlcclxuXHRcdFx0fVtuZmRlZi50eXBlXTsgLy8gdHVybiBzdHJpbmctdHlwZSBpbnRvIGIyZCB0eXBlXHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0dGhyb3cgbmV3IFByb3BlcnR5VW5kZWZpbmVkKFwidHlwZVwiKTtcclxuXHRcdH1cclxuXHJcblx0XHRhcHBseV9wcm9wZXJ0eV9saXN0KG5mZGVmLCBkZWZpbml0aW9uLCB0YXJnZXRfcHJvcHMuYm9keV9kZWYpO1xyXG5cclxuXHRcdHJldHVybiBkZWZpbml0aW9uO1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgZ2V0X2Zvcm1hbF9maXh0dXJlX2RlZiA9IGZ1bmN0aW9uKG5vbl9mb3JtYWxfZGVmKXtcclxuXHRcdC8qKlxyXG5cdFx0ICogdHVybnMgbm9uLWZvcm1hbCBkZWZpbml0aW9uIGludG8gdGhlIGZvcm1hbCBvbmVcclxuXHRcdCAqIHNlZSBnZXRfZnJvbWFsX2JvZHlfZGVmIGZvciBleHBsYW5hdGlvblxyXG5cdFx0ICovXHJcblxyXG5cdFx0dmFyIG5mZGVmID0gbm9uX2Zvcm1hbF9kZWY7XHJcblx0XHR2YXIgc2hhcGUgPSBuZmRlZi5zaGFwZTtcclxuXHRcdHZhciBmaXh0dXJlX2RlZiA9IG5ldyBCMmQuYjJGaXh0dXJlRGVmKCk7XHJcblxyXG5cdFx0YXBwbHlfcHJvcGVydHlfbGlzdChub25fZm9ybWFsX2RlZiwgZml4dHVyZV9kZWYsIHRhcmdldF9wcm9wcy5maXh0dXJlX2RlZik7XHJcblxyXG5cdFx0c3dpdGNoIChzaGFwZSkge1xyXG5cdFx0XHRjYXNlIFwicmVjdGFuZ2xlXCI6XHJcblxyXG5cdFx0XHRcdGlmKG5mZGVmLndpZHRoICE9IG51bGwgJiYgbmZkZWYuaGVpZ2h0ICE9IG51bGwpe1xyXG5cdFx0XHRcdFx0Zml4dHVyZV9kZWYuc2hhcGUgPSBuZXcgQjJkLmIyUG9seWdvblNoYXBlKCk7XHJcblx0XHRcdFx0XHRpZiAobmZkZWYub2Zmc2V0ICE9IG51bGwpe1xyXG5cdFx0XHRcdFx0XHR2YXIgb2Zmc2V0ID0gbmV3IEIyZC5iMlZlYzIobmZkZWYub2Zmc2V0LnggLG5mZGVmLm9mZnNldC55KTtcclxuXHRcdFx0XHRcdFx0Zml4dHVyZV9kZWYuc2hhcGUuU2V0QXNPcmllbnRlZEJveChuZmRlZi53aWR0aC8yLCBuZmRlZi5oZWlnaHQvMiwgb2Zmc2V0LCAwKTtcclxuXHRcdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0XHRmaXh0dXJlX2RlZi5zaGFwZS5TZXRBc0JveChuZmRlZi53aWR0aC8yLCBuZmRlZi5oZWlnaHQvMik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHR0aHJvdyBuZXcgUHJvcGVydHlVbmRlZmluZWQoXCJ3aWR0aCBvciBoZWlnaHRcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIFwicG9seWdvblwiOlxyXG5cclxuXHRcdFx0XHRpZihuZmRlZi5wb2ludHMgIT0gbnVsbCl7XHJcblx0XHRcdFx0XHRmaXh0dXJlX2RlZi5zaGFwZSA9IG5ldyBCMmQuYjJQb2x5Z29uU2hhcGUoKTtcclxuXHRcdFx0XHRcdGZpeHR1cmVfZGVmLnNoYXBlLlNldEFzQXJyYXkobmZkZWYucG9pbnRzLCBuZmRlZi5wb2ludHMubGVuZ3RoKTtcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcInBvaW50c1wiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJjaXJjbGVcIjpcclxuXHJcblx0XHRcdFx0aWYobmZkZWYucmFkaXVzICE9IG51bGwpe1xyXG5cdFx0XHRcdFx0Zml4dHVyZV9kZWYuc2hhcGUgPSBuZXcgQjJkLmIyQ2lyY2xlU2hhcGUobmZkZWYucmFkaXVzKTtcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcInJhZGl1c1wiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGRlZmF1bHQ6XHJcblx0XHRcdFx0dGhyb3cgXCJFcnJvcjogc2hhcGUgbXVzdCBiZSBvbmUgb2YgdGhlIGZvbGxvd2luZzogXCIgKyBcclxuXHRcdFx0XHRcdCdcInBvbHlnb25cIiwgXCJyZWN0YW5nbGVcIiwgXCJjaXJjbGVcIi4gWW91IHNwZWNpZmllZDogJyArXHJcblx0XHRcdFx0XHRTdHJpbmcoc2hhcGUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBmaXh0dXJlX2RlZjtcclxuXHJcblx0fTtcclxuXHRcclxuXHJcblx0dmFyIGdldF9ib2R5ID0gZnVuY3Rpb24obm9uX2Zvcm1hbF9kZWYsIGVudGl0eV9pbnN0YW5jZSl7XHJcblx0XHQvKipcclxuXHRcdCAqIHRha2VzIG5vbi1mb3JtYWwgZGVmaW5pdGlvblxyXG5cdFx0ICogcmV0dXJucyBib2R5IGJhc2VkIG9uIHRoaXMgZGVmaW5pdGlvblxyXG5cdFx0ICpcclxuXHRcdCAqL1xyXG5cdFx0aWYgKGVudGl0eV9pbnN0YW5jZSA9PSBudWxsKXtcclxuXHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcImVudGl0eV9pbnN0YW5jZVwiKTtcclxuXHRcdH1cclxuXHRcdHZhciBkZWZpbml0aW9uID0gZ2V0X2Zvcm1hbF9ib2R5X2RlZihub25fZm9ybWFsX2RlZik7XHJcblxyXG5cdFx0dmFyIGJvZHkgPSBQaHlzaWNzTW9kZWwud29ybGQuQ3JlYXRlQm9keShkZWZpbml0aW9uKTtcclxuXHJcblx0XHQvL2lmKGJvZHkudXNlckRhdGEgPT0gbnVsbCl7XHJcblx0XHRcdC8vYm9keS51c2VyRGF0YSA9IHt9O1xyXG5cdFx0Ly99XHJcblxyXG5cdFx0Ly8gYXBwZW5kIHBhc3NlZCBkZWZpbml0aW9uIHRvIHRoZSB1c2VyIGRhdGEgb2YgdGhlIGJvZHlcclxuXHRcdC8vIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXMsIGFuZCBhbHNvIHRvIGFsbG93IGVhc3kgc3BlY2lmaWNhdGlvbiBvZiBcclxuXHRcdC8vIGN1c3RvbSBwYXJhbWV0ZXJzIGR1cmluZyBkZWZpbml0aW9uLiBJZiB0aGlzIHdpbGwgY2F1c2UgY29uZnVzaW9uLFxyXG5cdFx0Ly8gSSdsbCByZW1vdmUgdGhhdFxyXG5cdFx0Ly9ib2R5LnVzZXJEYXRhLmRlZiA9IG5vbl9mb3JtYWxfZGVmO1xyXG5cdFx0Ym9keS5TZXRVc2VyRGF0YSh7ZGVmOiBub25fZm9ybWFsX2RlZiwgZW50aXR5X2luc3RhbmNlOiBlbnRpdHlfaW5zdGFuY2V9KTtcclxuXHRcdFxyXG5cdFx0cmV0dXJuIGJvZHk7XHJcblx0XHJcblx0fTtcclxuXHJcblx0dmFyIGF0dGFjaF9maXh0dXJlID0gZnVuY3Rpb24oYm9keSwgbm9uX2Zvcm1hbF9kZWYsIGZpeHR1cmVfbmFtZSl7XHJcblx0XHQvKipcclxuXHRcdCAqIGdpdmVuIGIyZCBib2R5LCAobm9uLWZvcm1hbCkgZml4dHVyZSBkZWZpbml0aW9uIGFuZCAoT1BUSU9OQUwpIGZpeHR1cmVfbmFtZVxyXG5cdFx0ICogdGhpcyBmdW5jdGlvbiBhdHRhY2hlcyBmaXh0dXJlIHRvIHRoZSBib2R5XHJcblx0XHQgKi9cclxuXHJcblx0XHR2YXIgZml4dHVyZV9kZWYgPSBnZXRfZm9ybWFsX2ZpeHR1cmVfZGVmKG5vbl9mb3JtYWxfZGVmKTtcclxuXHJcblx0XHRpZihmaXh0dXJlX2RlZi51c2VyRGF0YSA9PSBudWxsKXtcclxuXHRcdFx0Zml4dHVyZV9kZWYudXNlckRhdGEgPSB7fTtcclxuXHRcdH1cclxuXHJcblx0XHRmaXh0dXJlX2RlZi51c2VyRGF0YS5kZWYgPSBub25fZm9ybWFsX2RlZjtcclxuXHRcdGZpeHR1cmVfZGVmLnVzZXJEYXRhLm5hbWUgPSBmaXh0dXJlX25hbWU7XHJcblx0XHRcclxuXHRcdGJvZHkuQ3JlYXRlRml4dHVyZShmaXh0dXJlX2RlZik7XHJcblx0XHRcclxuXHR9O1xyXG5cclxuXHR2YXIgYXR0YWNoX3NlbnNvcnMgPSBmdW5jdGlvbihib2R5KXtcclxuXHRcdHZhciBTRU5TT1JfVEhJQ0tORVNTID0gMC4xO1xyXG5cdFx0XHJcblx0XHQvLyBnZXQgdGhlIHdpZHRoIGFuZCBoZWlnaHQgb2YgdGhlIGJvZHkncyBtYWluIGZpeHR1cmVcclxuXHRcdC8vIGFuZCBjcmVhdGUgNCBzZW5zb3IgZml4dHVyZXMgYmFzZWQgb24gdGhvc2UgcGFyYW1ldGVyc1xyXG5cdFx0Ly8gY2FsY3VsYXRlIG9mZnNldCBvZiBzZW5zb3JzIHNvIHRoYXQgdGhleSBtYXRjaCB0aGUgbWFpbiBmaXh0dXJlXHJcblx0XHR2YXIgeCA9IGJvZHkuR2V0UG9zaXRpb24oKS54O1xyXG5cdFx0dmFyIHkgPSBib2R5LkdldFBvc2l0aW9uKCkueTtcclxuXHJcblx0XHQvLyBUT0RPOiBjaGFuZ2UgdG8gZ2V0dGluZyBkaW1lbnRpb25zIG9mIG1haW4gZml4dHVyZVxyXG5cdFx0dmFyIGggPSBib2R5LkdldEZpeHR1cmVMaXN0KCkuR2V0QUFCQigpLkdldEV4dGVudHMoKS55O1xyXG5cdFx0dmFyIHcgPSBib2R5LkdldEZpeHR1cmVMaXN0KCkuR2V0QUFCQigpLkdldEV4dGVudHMoKS54O1xyXG5cdFx0XHJcblx0XHQvL2F0dGFjaCB0b3AgZml4dHVyZVxyXG5cdFx0dmFyIHRvcF9zZW5zb3IgPSB7fTtcclxuXHRcdHRvcF9zZW5zb3Iuc2hhcGUgPSBcInJlY3RhbmdsZVwiO1xyXG5cdFx0dG9wX3NlbnNvci5kZW5zaXR5ID0gMDtcclxuXHRcdHRvcF9zZW5zb3IuaXNTZW5zb3IgPSB0cnVlO1xyXG5cdFx0dG9wX3NlbnNvci5oZWlnaHQgPSBTRU5TT1JfVEhJQ0tORVNTO1xyXG5cdFx0dG9wX3NlbnNvci53aWR0aCA9ICh3KjIgLSBTRU5TT1JfVEhJQ0tORVNTKjIpIC0gMC4zO1xyXG5cdFx0dG9wX3NlbnNvci5vZmZzZXQgPSB7eDowLCB5OiAoLTEqaCkgKyBTRU5TT1JfVEhJQ0tORVNTLzJ9O1xyXG5cdFx0YXR0YWNoX2ZpeHR1cmUoYm9keSx0b3Bfc2Vuc29yLFwidG9wXCIpO1xyXG5cdFx0XHJcblx0XHQvL2F0dGFjaCBib3R0b20gZml4dHVyZVxyXG5cdFx0dmFyIGJvdHRvbV9zZW5zb3IgPSB0b3Bfc2Vuc29yO1xyXG5cdFx0Ly9ib3R0b21fc2Vuc29yLndpZHRoICs9IDAuNDtcclxuXHRcdGJvdHRvbV9zZW5zb3Iub2Zmc2V0ID0ge3g6MCwgeTogaCAtIFNFTlNPUl9USElDS05FU1MvMn07XHJcblx0XHRhdHRhY2hfZml4dHVyZShib2R5LGJvdHRvbV9zZW5zb3IsXCJib3R0b21cIik7XHJcblx0XHRcclxuXHRcdC8vYXR0YWNoIGxlZnQgZml4dHVyZVxyXG5cdFx0dmFyIGxlZnRfc2Vuc29yID0gdG9wX3NlbnNvcjtcclxuXHRcdGxlZnRfc2Vuc29yLmhlaWdodCA9IChoKjIgLSBTRU5TT1JfVEhJQ0tORVNTKjIpIC0gMC4zO1xyXG5cdFx0bGVmdF9zZW5zb3Iud2lkdGggPSBTRU5TT1JfVEhJQ0tORVNTO1xyXG5cdFx0bGVmdF9zZW5zb3Iub2Zmc2V0ID0ge3g6KC0xKncpICsgU0VOU09SX1RISUNLTkVTUy8yLHk6MH07XHJcblx0XHRhdHRhY2hfZml4dHVyZShib2R5LGxlZnRfc2Vuc29yLFwibGVmdFwiKTtcclxuXHRcdFxyXG5cdFx0Ly9hdHRhY2ggcmlnaHQgZml4dHVyZVxyXG5cdFx0dmFyIHJpZ2h0X3NlbnNvciA9IGxlZnRfc2Vuc29yO1xyXG5cdFx0cmlnaHRfc2Vuc29yLm9mZnNldCA9IHt4OncgLSBTRU5TT1JfVEhJQ0tORVNTLzIsIHk6MH07XHJcblx0XHRhdHRhY2hfZml4dHVyZShib2R5LHJpZ2h0X3NlbnNvcixcInJpZ2h0XCIpO1xyXG5cdH07XHJcblx0XHJcblx0XHJcblx0XHJcblxyXG5cdHZhciBnZXRfcmVjdGFuZ3VsYXIgPSBmdW5jdGlvbihkZWYsIGVudGl0eV9pbnN0YW5jZSl7XHJcblx0XHQvLyBnZXQgYXBwcm9wcmlhdGUgdGVtcGxhdGUgY29sbGVjdGlvbiB0byBkcmF3IGZyb21cclxuXHRcdHZhciB0ZW1wbGF0ZV9uYW1lID0gZW50aXR5X2luc3RhbmNlLnR5cGU7XHJcblx0XHR2YXIgdGVtcGxhdGVfY29sbGVjdGlvbiA9IFBoeXNpY3NNb2RlbC5yX3RlbXBsYXRlcztcclxuXHRcdHZhciBjb21waWxlZF90ZW1wbGF0ZSA9IGFwcGx5X3BhcmVudHModGVtcGxhdGVfbmFtZSwgdGVtcGxhdGVfY29sbGVjdGlvbik7XHJcblxyXG5cdFx0Ly8gYXBwbHkgY3VzdG9tIG92ZXJyaWRlXHJcblx0XHR2YXIgZmluYWxfZGVmID0gY29tcGlsZWRfdGVtcGxhdGU7XHJcblx0XHRmb3IodmFyIHByb3AgaW4gZGVmKXtcclxuXHRcdFx0ZmluYWxfZGVmW3Byb3BdID0gZGVmW3Byb3BdO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZpbmFsX2RlZi5zaGFwZSA9IFwicmVjdGFuZ2xlXCI7XHJcblxyXG5cdFx0Ly8gZmluYWxfZGVmIGNvbnRhaW5zIGFsbCBmaW5hbCBkYXRhLCBhYm91dCBib2R5IHdlIGFyZSBhYm91dCB0byBjcmVhdGVcclxuXHRcdC8vIGl0IHRha2VzIGludG8gYWNjb3VudCB0ZW1wbGF0ZSBnaXZlbiBhbmQgYWxsIGl0J3MgcGFyZW50c1xyXG5cdFx0Ly8gYW5kIGFsc28gbWFudWFsbHkgc3BlY2lmaWVkIHBhcmFtZXRlcnMuIEhvd2V2ZXIsIHRoaXMgZGVmaW5pdGlvbiBpcyByYXcsXHJcblx0XHQvLyBpLmUuIHNvbWUgZGF0YSBpbiBpdCBtYXkgbm90IGJlIGluIGl0cyBmaW5hbCBmb3JtLCBlLmcuIGxpbmVhciB2ZWxvY2l0eSBpcyBzcGVjaWZpZWRcclxuXHRcdC8vIGFzIHR3byBwYXJhbWV0ZXJzLCB2eCBhbmQgdnksIHdoaWxlIGl0IHdob3VsZCBiZSBjb252ZXJ0ZWQgaW50byB0aGUgdmVjdG9yXHJcblx0XHQvLyBmb3IgYm94MmQuIHNvIGZpbmFsX2RlZiBpcyBhIGZpbmFsIGRlc2NyaXB0aW9uLCBidXQgbm90IGluIGZpbmFsIGZvcm1cclxuXHJcblxyXG5cdFx0dmFyIGJvZHkgPSBnZXRfYm9keShmaW5hbF9kZWYsIGVudGl0eV9pbnN0YW5jZSk7XHJcblx0XHQgXHJcblx0XHRhdHRhY2hfZml4dHVyZShib2R5LCBmaW5hbF9kZWYsIFwibWFpblwiKTtcclxuXHRcdFxyXG5cdFx0Ly9JZiB0aGUgb2JqZWN0IGhhcyBkaXJlY3Rpb25hbCBzZW5zb3JzLCBhdHRhY2ggc2Vuc29ycyBoZXJlXHJcblx0XHRpZihmaW5hbF9kZWYuYm9yZGVyX3NlbnNvcnMpe1xyXG5cdFx0XHRhdHRhY2hfc2Vuc29ycyhib2R5KTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gYm9keTtcclxuXHR9O1xyXG5cclxuXHR2YXIgZ2V0X2NpcmN1bGFyID0gZnVuY3Rpb24oZGVmLCB0ZW1wbGF0ZSl7XHJcblx0XHR2YXIgdHlwZSA9IFwiY2lyY3VsYXJcIjtcclxuXHRcdC8vIGRvbnQnIGZvcmdldCBhYm91dCByZWZhY3RvcmluZyBzb21lIHN0dWZmIGludG8gdGhlXHJcblx0XHQvLyBzZXRfY29tbW9uIGZ1bmN0aW9uXHJcblx0XHRcclxuXHRcdHZhciBkZWZpbml0aW9uID0gbmV3IEIyZC5iMkJvZHlEZWYoKTtcclxuXHRcdFxyXG5cdH07XHJcblx0XHRcclxuXHR2YXIgZ2V0X3BvbHlnb25hbCA9IGZ1bmN0aW9uKGRlZiwgdGVtcGxhdGUpe1xyXG5cdFx0dmFyIHR5cGUgPSBcInBvbHlnb25hbFwiO1xyXG5cdFx0XHJcblx0XHR2YXIgZGVmaW5pdGlvbiA9IG5ldyBCMmQuYjJCb2R5RGVmKCk7XHJcblx0XHRcclxuXHR9O1xyXG5cclxuXHR2YXIgc2V0X2RlYnVnX2RyYXcgPSBmdW5jdGlvbihkZWJ1Z19kcmF3KXtcclxuXHRcdFBoeXNpY3NNb2RlbC53b3JsZC5TZXREZWJ1Z0RyYXcoZGVidWdfZHJhdyk7XHJcblx0fTtcclxuXHJcblxyXG5cdFxyXG5cdHZhciBsaXN0ZW5fZm9yX2NvbnRhY3Rfd2l0aCA9IGZ1bmN0aW9uKHdoYXQsIGNvbGxpc2lvbl9ldmVudF9uYW1lLCBjdXN0b21fZnVuY3Rpb24pe1xyXG5cdFx0LyoqXHJcblx0XHQgKiBzZXR1cHMgY3VzdG9tX2Z1bmN0aW9uIHRvIGJlIGNhbGxlZCBlYWNoIHRpbWUgdGhlIGNvbGxpc2lvbiBldmVudCBcclxuXHRcdCAqIG9jY3VycyBhbmQgaW52b2x2ZXMgPndoYXQ8XHJcblx0XHQgKiBUQUtFUzpcclxuXHRcdCAqIFx0PndoYXQ8XHJcblx0XHQgKiBcdFx0c3RyaW5nIFxyXG5cdFx0ICogXHRcdGlkIG9mIGFuIG9iamVjdCAoXCIzODNcIikgb3IgaXQncyB0eXBlIChcInBsYXllclwiKVxyXG5cdFx0ICogXHQ+Y29sbGlzaW9uX2V2ZW50X25hbWU8XHJcblx0XHQgKiBcdFx0c3RyaW5nLiBvbmUgb2Y6XHJcblx0XHQgKiBcdFx0QmVnaW5Db250YWN0LCBFbmRDb250YWN0LCBQcmVTb2x2ZSwgUG9zdFNvbHZlXHJcblx0XHQgKiBcdD5jdXN0b21fZnVuY3Rpb248IFxyXG5cdFx0ICogXHRcdGZ1bmN0aW9uXHJcblx0XHQgKiBcdFx0ZnVuY3Rpb24gdG8gYmUgY2FsbGVkIG9uIG9uZSBvZiB0aG9zZSBldmVudHNcclxuXHRcdCAqIFx0XHRub3RpY2UgdGhhdCBmdW5jdGlvbiB3aWxsIGJlIHdyYXBwZWQsIHNvIGl0IHNob3VsZFxyXG5cdFx0ICogXHRcdGFjY2VwdCBleHRyYSBwYXJhbWV0ZXIgPmluZm88IHRoYXQgd2lsbCBjb250YWluXHJcblx0XHQgKiBcdFx0dW5wYWNrZWQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGNvbGxpc2lvblxyXG5cdFx0ICovXHJcblxyXG5cclxuXHRcdGlmKHdoYXQgPT0gbnVsbCl7XHJcblx0XHRcdHRocm93IG5ldyBQcm9wZXJ0eVVuZGVmaW5lZChcIndoYXRcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoXHJcblx0XHRcdGNvbGxpc2lvbl9ldmVudF9uYW1lICE9IFwiQmVnaW5Db250YWN0XCIgJiYgY29sbGlzaW9uX2V2ZW50X25hbWUgIT0gXCJFbmRDb250YWN0XCIgJiZcclxuXHRcdFx0Y29sbGlzaW9uX2V2ZW50X25hbWUgIT0gXCJQcmVTb2x2ZVwiICYmIGNvbGxpc2lvbl9ldmVudF9uYW1lICE9IFwiUG9zdFNvbHZlXCIgXHJcblx0XHQpe1xyXG5cdFx0XHR0aHJvdyBcImNvbGxpc2lvbl9ldmVudF9uYW1lIHNob3VsZCBiZSBvbmUgb2Y6IFByZVNvbHZlLCBQb3N0U29sdmUsIEVuZENvbnRhY3QsIEJlZ2luQ29udGFjdFwiO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKGN1c3RvbV9mdW5jdGlvbiA9PSBudWxsIHx8IHR5cGVvZihjdXN0b21fZnVuY3Rpb24pICE9IFwiZnVuY3Rpb25cIil7XHJcblx0XHRcdHRocm93IFwiUHJvcGVydHkgY3VzdG9tX2Z1bmN0aW9uIGlzIG5vdCBkZWZpbmVkIG9yIGlzbid0IGEgZnVuY3Rpb25cIlxyXG5cdFx0fVxyXG5cclxuXHRcdHZhciB0YXJnZXRfZnVuY3Rpb25fdGFibGUgPSBQaHlzaWNzTW9kZWwuYXdhaXRpbmdfY29udGFjdFtjb2xsaXNpb25fZXZlbnRfbmFtZV07IFxyXG5cclxuXHRcdGlmKHRhcmdldF9mdW5jdGlvbl90YWJsZVt3aGF0XSA9PSBudWxsKXtcclxuXHRcdFx0dGFyZ2V0X2Z1bmN0aW9uX3RhYmxlW3doYXRdID0gW2N1c3RvbV9mdW5jdGlvbl07XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0dGFyZ2V0X2Z1bmN0aW9uX3RhYmxlW3doYXRdLnB1c2goY3VzdG9tX2Z1bmN0aW9uKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHRcdFxyXG5cdHZhciBpbml0X2NvbGxpc2lvbl9saXN0ZW5lciA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcclxuXHRcdC8qKlxyXG5cdFx0ICovXHJcblx0XHRcclxuXHRcdHZhciBjYWxsX2FsbCA9IGZ1bmN0aW9uKGxpc3QsIGFyZ3Mpe1xyXG5cdFx0XHQvKipcclxuXHRcdFx0ICogY2FsbCBhbGwgZnVuY3Rpb25zIGluIGxpc3QgcHJvdmlkaW5nIGFyZ3VtZW50c1xyXG5cdFx0XHQgKiBmcm9tIHRoZSBhcnJheSBhcmdzXHJcblx0XHRcdCAqIGlmIGxpc3QgZ2l2ZSBpcyBudWxsL3VuZGVmaW5lZCwgZG8gbm90aGluZ1xyXG5cdFx0XHQgKi9cclxuXHJcblx0XHRcdGlmKGxpc3QgIT0gbnVsbCl7XHJcblx0XHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspe1xyXG5cdFx0XHRcdFx0bGlzdFtpXS5hcHBseSh0aGlzLCBhcmdzKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cdFx0dmFyIGdldF9pZCA9IGZ1bmN0aW9uKG9iail7XHJcblx0XHRcdHVzZXJEYXRhID0gb2JqLkdldFVzZXJEYXRhKCk7XHJcblx0XHRcdGlmKHVzZXJEYXRhICE9IG51bGwgJiYgdXNlckRhdGEuaWQgIT0gbnVsbCl7XHJcblx0XHRcdFx0cmV0dXJuIHVzZXJEYXRhLmlkO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRyZXR1cm4gXCJbTk9fSURdXCJcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdH07XHJcblxyXG5cdFx0dmFyIGdldF90eXBlID0gZnVuY3Rpb24ob2JqKXtcclxuXHRcdFx0dmFyIHVzZXJEYXRhID0gb2JqLkdldFVzZXJEYXRhKCk7XHJcblx0XHRcdGlmKHVzZXJEYXRhICE9IG51bGwgJiYgdXNlckRhdGEuZW50aXR5X2luc3RhbmNlLnR5cGUgIT0gbnVsbCl7XHJcblx0XHRcdFx0cmV0dXJuIHVzZXJEYXRhLmVudGl0eV9pbnN0YW5jZS50eXBlO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdH07XHJcblxyXG5cdFx0dmFyIHVucGFja19jb250YWN0X2luZm8gPSBmdW5jdGlvbihjb250YWN0LCBteV90eXBlKXtcclxuXHRcdFx0LyoqXHJcblx0XHRcdCAqIHVucGFja3MgaW5mbyBhYm91dCB0aGUgY29sbGlzaW9uIGFuZCBcclxuXHRcdFx0ICogcmV0dXJucyBpdFxyXG5cdFx0XHQgKiA+bXlfdHlwZTwgaXMgYW4gdHlwZSBvZiBhbiBvYmplY3QgdGhhdCB3aWxsXHJcblx0XHRcdCAqIGdvIHVuZGVyIHRoZSA+TWU8IHBhcmFtZWV0ZXIgaW5zaWRlIG9mIGluZm9cclxuXHRcdFx0ICogKEFzIG9wcG9zZWQgdG8gVGhlbSwgd2hpY2ggaXMgdGhlIG90aGVyIG9iamVjdClcclxuXHRcdFx0ICovXHJcblx0XHRcdGlmKG15X3R5cGUgPT0gbnVsbCl7XHJcblx0XHRcdFx0Ly8gPm15X3R5cGU8IGlzbid0IHN1cHBvc2VkIHRvIGJlIG51bGwvdW5kZWZpbmVkXHJcblx0XHRcdFx0dGhyb3cgbmV3IFByb3BlcnR5VW5kZWZpbmVkKFwibXlfdHlwZVwiKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dmFyIEEgPSB7fTtcclxuXHRcdFx0dmFyIEIgPSB7fTtcclxuXHJcblx0XHRcdEEuZml4dHVyZSA9IGNvbnRhY3QubV9maXh0dXJlQTtcclxuXHRcdFx0Qi5maXh0dXJlID0gY29udGFjdC5tX2ZpeHR1cmVCO1xyXG5cdFx0XHRBLmJvZHkgPSBBLmZpeHR1cmUuR2V0Qm9keSgpO1xyXG5cdFx0XHRCLmJvZHkgPSBCLmZpeHR1cmUuR2V0Qm9keSgpO1xyXG5cclxuXHRcdFx0QS5pZCA9IGdldF9pZChBLmJvZHkpO1xyXG5cdFx0XHRCLmlkID0gZ2V0X2lkKEIuYm9keSk7XHJcblxyXG5cdFx0XHQvL0EuZW50aXR5ID0gSWRlbnRpZmljYXRpb25Db250cm9sbGVyLmdldF9ieV9pZChBLmlkKTtcclxuXHRcdFx0Ly9CLmVudGl0eSA9IElkZW50aWZpY2F0aW9uQ29udHJvbGxlci5nZXRfYnlfaWQoQi5pZCk7XHJcblx0XHRcdEEuZW50aXR5ID0gQS5ib2R5LkdldFVzZXJEYXRhKCkuZW50aXR5X2luc3RhbmNlO1xyXG5cdFx0XHRCLmVudGl0eSA9IEIuYm9keS5HZXRVc2VyRGF0YSgpLmVudGl0eV9pbnN0YW5jZTtcclxuXHJcblx0XHRcdEEudHlwZSA9IGdldF90eXBlKEEuYm9keSk7XHJcblx0XHRcdEIudHlwZSA9IGdldF90eXBlKEIuYm9keSk7XHJcblxyXG5cdFx0XHRBLmZpeHR1cmVfbmFtZSA9IGdldF9jdXN0b21fcHJvcGVydHkoQS5maXh0dXJlLCBcIm5hbWVcIik7XHJcblx0XHRcdEIuZml4dHVyZV9uYW1lID0gZ2V0X2N1c3RvbV9wcm9wZXJ0eShCLmZpeHR1cmUsIFwibmFtZVwiKTtcclxuXHJcblx0XHRcdC8vIFRPRE86IHVucGFjayBtb3JlIGluZm8gaWYgbmVjZXNzYXJ5XHJcblxyXG5cdFx0XHR2YXIgaW5mbyA9IHt9O1xyXG5cclxuXHRcdFx0aWYoQS50eXBlID09IG15X3R5cGUpe1xyXG5cdFx0XHRcdGluZm8uTWUgPSBBO1xyXG5cdFx0XHRcdGluZm8uVGhlbSA9IEI7XHJcblx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdGluZm8uTWUgPSBCO1xyXG5cdFx0XHRcdGluZm8uVGhlbSA9IEE7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHJldHVybiBpbmZvO1xyXG5cdFx0XHRcclxuXHRcdH07XHJcblx0XHRcclxuXHRcdHZhciBjb21tb25fY29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QsIGFyZ3MsIGxpc3RzKXtcclxuXHRcdFx0Ly8gY3JlYXRlIGluZm8sIGNhbGwgcmVzcGVjdGl2ZSBmdW5jdGlvbnMgZm9yIGVhY2ggaWQuIHVzZSBwcm92aWRlZCBhcmd1bWVudHMgPmFyZ3M8XHJcblx0XHRcdC8vIGxvb2t1cCBpZHMgaW4gdGhlIHByb3ZpZGVkIHRhYmxlIG9mIGxpc3RzID5saXN0czxcclxuXHRcdFx0XHJcblx0XHRcdC8qIG5leHQgYXZhaWxhYmxlIGluZGV4IGluIHRoZSBhcmdzIGFycmF5IFxyXG5cdFx0XHQgKiBpdCdzIHVzZWQgdG8gZGV0ZXJtaW5lIGF0IHdoYXQgaW5kZXggdGhlIGluZm8gb2JqZWN0IHNob3VsZCBiZSBpbnNlcnRlZCBhcyovXHJcblx0XHRcdHZhciBuZXh0X2FyZ19pbmRleCA9IGFyZ3MubGVuZ3RoOyBcclxuXHJcblx0XHRcdHZhciB0eXBlMSA9IGdldF90eXBlKGNvbnRhY3QubV9maXh0dXJlQS5HZXRCb2R5KCkpO1xyXG5cdFx0XHR2YXIgdHlwZTIgPSBnZXRfdHlwZShjb250YWN0Lm1fZml4dHVyZUIuR2V0Qm9keSgpKTtcclxuXHJcblx0XHRcdGlmKHR5cGUxICE9IG51bGwpe1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGFyZ3NbbmV4dF9hcmdfaW5kZXhdID0gdW5wYWNrX2NvbnRhY3RfaW5mbyhjb250YWN0LCB0eXBlMSk7XHJcblx0XHRcdFx0Y2FsbF9hbGwobGlzdHNbdHlwZTFdLCBhcmdzKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYodHlwZTIgIT0gbnVsbCl7XHJcblx0XHRcdFx0YXJnc1tuZXh0X2FyZ19pbmRleF0gPSB1bnBhY2tfY29udGFjdF9pbmZvKGNvbnRhY3QsIHR5cGUyKTtcclxuXHRcdFx0XHRjYWxsX2FsbChsaXN0c1t0eXBlMl0sIGFyZ3MpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0fTtcclxuXHRcdFxyXG5cdFx0dmFyIFByZVNvbHZlID0gZnVuY3Rpb24oY29udGFjdCwgaW1wdWxzZSl7XHJcblx0XHRcdFxyXG5cdFx0XHR2YXIgbGlzdHMgPSBQaHlzaWNzTW9kZWwuYXdhaXRpbmdfY29udGFjdC5QcmVTb2x2ZTtcclxuXHJcblx0XHRcdHZhciBhcmdzID0gW2NvbnRhY3QsIGltcHVsc2VdO1xyXG5cclxuXHRcdFx0Y29tbW9uX2NvbnRhY3QoY29udGFjdCwgYXJncywgbGlzdHMpO1xyXG5cdFxyXG5cdFx0fTtcclxuXHRcdFxyXG5cdFx0dmFyIFBvc3RTb2x2ZSA9IGZ1bmN0aW9uKGNvbnRhY3QsIG9sZE1hbmlmb2xkKXtcclxuXHRcdFx0dmFyIGxpc3RzID0gUGh5c2ljc01vZGVsLmF3YWl0aW5nX2NvbnRhY3QuUG9zdFNvbHZlO1xyXG5cclxuXHRcdFx0dmFyIGFyZ3MgPSBbY29udGFjdCwgb2xkTWFuaWZvbGRdO1xyXG5cclxuXHRcdFx0Y29tbW9uX2NvbnRhY3QoY29udGFjdCwgYXJncywgbGlzdHMpO1xyXG5cdFx0fTtcclxuXHJcblx0XHR2YXIgQmVnaW5Db250YWN0ID0gZnVuY3Rpb24oY29udGFjdCl7XHJcblx0XHRcdHZhciBsaXN0cyA9IFBoeXNpY3NNb2RlbC5hd2FpdGluZ19jb250YWN0LkJlZ2luQ29udGFjdDtcclxuXHJcblx0XHRcdHZhciBhcmdzID0gW2NvbnRhY3RdO1xyXG5cclxuXHRcdFx0Y29tbW9uX2NvbnRhY3QoY29udGFjdCwgYXJncywgbGlzdHMpO1xyXG5cdFx0fTtcclxuXHJcblx0XHR2YXIgRW5kQ29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3Qpe1xyXG5cdFx0XHR2YXIgbGlzdHMgPSBQaHlzaWNzTW9kZWwuYXdhaXRpbmdfY29udGFjdC5FbmRDb250YWN0O1xyXG5cclxuXHRcdFx0dmFyIGFyZ3MgPSBbY29udGFjdF07XHJcblxyXG5cdFx0XHRjb21tb25fY29udGFjdChjb250YWN0LCBhcmdzLCBsaXN0cyk7XHJcblx0XHR9O1xyXG5cdFx0XHJcblx0XHRcclxuXHRcdFxyXG5cdFx0dmFyIGxpc3RlbmVyID0gbmV3IEIyZC5iMkNvbnRhY3RMaXN0ZW5lcjtcclxuXHRcdGxpc3RlbmVyLlByZVNvbHZlID0gUHJlU29sdmU7XHJcblx0XHRsaXN0ZW5lci5Qb3N0U29sdmUgPSBQb3N0U29sdmU7XHJcblx0XHRsaXN0ZW5lci5CZWdpbkNvbnRhY3QgPSBCZWdpbkNvbnRhY3Q7XHJcblx0XHRsaXN0ZW5lci5FbmRDb250YWN0ID0gRW5kQ29udGFjdDtcclxuXHRcdFxyXG5cdFx0UGh5c2ljc01vZGVsLndvcmxkLlNldENvbnRhY3RMaXN0ZW5lcihsaXN0ZW5lcik7XHJcblx0XHJcblx0fTtcclxuXHJcblx0dmFyIGdldF9jdXN0b21fcHJvcGVydHkgPSBmdW5jdGlvbihiMmRfb2JqLCBwcm9wZXJ0eV9uYW1lKXtcclxuXHRcdFxyXG5cdFx0LyoqXHJcblx0XHQgKiBnaXZlbiBhbnkgYm94MmQgb2JqZWN0IHRoYXQgaGFzIEdldFVzZXJEYXRhIG1ldGhvZFxyXG5cdFx0ICogdGhpcyBmdW5jdGlvbiB3aWxsIHJldHVybiBjdXN0b20gcHJvcGVydHkgd2l0aCBnaXZlblxyXG5cdFx0ICogcHJvcGVydHlfbmFtZSBpZiB0aGlzIHByb3BlcnR5IGlzIHNldCBvbiB1c2VyRGF0YSBvZiB0aGUgb2JqZWN0XHJcblx0XHQgKiBpZiBub3QsIHRoZSBmdW5jdGlvbiByZXR1cm5zIG51bGxcclxuXHRcdCAqL1xyXG5cdFx0dmFyIHVzZXJfZGF0YSA9IGIyZF9vYmouR2V0VXNlckRhdGEoKTtcclxuXHRcdGlmKHVzZXJfZGF0YSAmJiB1c2VyX2RhdGFbcHJvcGVydHlfbmFtZV0pe1xyXG5cdFx0XHRyZXR1cm4gdXNlcl9kYXRhW3Byb3BlcnR5X25hbWVdO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0fVxyXG5cdH07XHJcblx0XHJcblx0dmFyIHJlbW92ZV9ib2R5ID0gZnVuY3Rpb24oYm9keSl7XHJcblx0XHQvKipcclxuXHRcdCogZGVzdHJveSBnaXZlbiBib2R5IChyZW1vdmUgaXQgZnJvbSB3b3JsZCBhbmQgcmVtb3ZlIGFsbCByZWZlcmVuY2VzIFBoeXNpY3MgaGFzIHRvIGl0KVxyXG5cdFx0Ki9cclxuXHRcdFxyXG5cdFx0Ly8gVE9ETzogSU1QT1JUQU5UISEhIHVwZGF0ZSB0aGlzIGZ1bmN0aW9uIGlmIHlvdSBzdG9yZSBleHRyYSByZWZlcmVuY2VzXHJcblx0XHQvLyB0byB0aGUgYm9keSB3aXRoaW4gUGh5c2ljc01vZGVsL0NvbnRyb2xsZXIuXHJcblx0XHQvLyBFdmVuIGEgc2luZ2xlIHJlZmVyZW5jZSB0byB0aGUgYm9keSBtYXkga2VlcCBpdCBmcm9tIGJlaW5nIGRlbGV0ZWRcclxuXHRcdC8vIGZyb20gdGhlIG1lbW9yeSBcclxuXHRcdFBoeXNpY3NNb2RlbC53b3JsZC5EZXN0cm95Qm9keShib2R5KTtcclxuXHR9O1xyXG5cdFxyXG5cdC8vYSB2ZXJ5IGltcG9ydGFudCBmdW5jdGlvbiB0aGF0IEkgbmVlZCBmb3IgdGhlIGh5ZW5hXHJcblx0Ly9yZXR1cm5zIHRoZSBudW1iZXIgb2Ygc2hhcGVzIGluIGNvbnRhY3Qgd2l0aCBhIGdpdmVuIGJvdW5kaW5nIGJveFxyXG5cdHZhciBxdWVyeV9hYWJiID0gZnVuY3Rpb24oYWFiYil7XHJcblx0XHR2YXIgY291bnQgPSAwO1xyXG5cdFx0UGh5c2ljc01vZGVsLndvcmxkLlF1ZXJ5QUFCQihcclxuXHRcdGZ1bmN0aW9uKG1heCl7XHJcblx0XHRcdGNvdW50Kys7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fSxcclxuXHRcdGFhYmIpO1xyXG5cdFx0cmV0dXJuIGNvdW50O1xyXG5cdH07XHJcblx0XHJcblx0XHJcblx0cmV0dXJuIHtcclxuXHRcdGdldF9ib2R5OiBnZXRfYm9keSxcclxuXHRcdGdldF9yZWN0YW5ndWxhcjogZ2V0X3JlY3Rhbmd1bGFyLFxyXG5cdFx0c3RlcDogc3RlcCxcclxuXHRcdGluaXQ6IGluaXQsXHJcblx0XHRzZXRfZGVidWdfZHJhdzogc2V0X2RlYnVnX2RyYXcsXHJcblx0XHRkcmF3X2RlYnVnOiBkcmF3X2RlYnVnLFxyXG5cdFx0bGlzdGVuX2Zvcl9jb250YWN0X3dpdGg6IGxpc3Rlbl9mb3JfY29udGFjdF93aXRoLFxyXG5cdFx0cmVtb3ZlX2JvZHk6IHJlbW92ZV9ib2R5LFxyXG5cdFx0cXVlcnlfYWFiYjogcXVlcnlfYWFiYixcclxuXHR9O1xyXG59KSgpO1xyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUGh5c2ljc0NvbnRyb2xsZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRjdXJyZW50X21vZHVsZTogXCJQaHlzaWNzQ29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJcclxudmFyIFJlZ2lzdGVyQXNDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0LyogQWxsb3dzIHlvdSB0byByZWdpc3RlciBvYmplY3QgYXMgc29tZXRoaW5nLFxyXG5cdCAqIGZvciBvdGhlciBtb2R1bGVzIHRvIGFjY2Vzc1xyXG5cdCAqIE9uZSB1c2UgY291bGQgYmUgcmVnaXN0ZXJpbmcgbmV3bHkgZ2VuZXJhdGVkIHRlcnJhaW4gc2xpY2UgZnJvbSB0aGUgc2xpY2UgY29udHJvbGxlcixcclxuXHQgKiBmb3IgdGhlIEdyYXBoaWNzQ29udHJvbGxlciB0byBub3RpY2UgYW5kIGdlbmVyYXRlIGdyYXBoaWNzIGZvciBpdFxyXG5cdCovXHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcclxuXHRcdC8qIGlzIHJhbiBmcm9tIHRoZSBJbml0Q29udHJvbGxlciBvbmNlIHdoZW4gdGhlIGdhbWUgaXMgbG9hZGVkICovXHJcblxyXG5cdFx0aW5jbHVkZSgpOyAvLyBzYXRpc2Z5IHJlcXVpcmVtZW50c1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgdXBkYXRlID0gZnVuY3Rpb24oZGVsdGEpe1xyXG5cdFx0LyogaXMgcmFuIGVhY2ggdGljayBmcm9tIHRoZSBHYW1lQ29udHJvbGxlci51cGRhdGVfYWxsICovXHJcblxyXG5cdFx0Ly8gVE9ETzogYXV0b21hdGljYWxseSBkZWxldGUgc3R1ZmYgZGVwZW5kaW5nIG9uIHRpbWVvdXQgc3R1ZmZcclxuXHRcdC8vIGNhbGN1bGF0ZSB0aW1lb3V0IG9mIFxyXG5cdH07XHJcblxyXG5cdHZhciByZWdpc3Rlcl9hcyA9IGZ1bmN0aW9uKHdoYXQsIG9iail7XHJcblx0XHQvKipcclxuXHRcdCogc2ltcGxlIG9uZSB0aW1lIGxvb2t1cCByZWdpc3RlcmluZyBvZiBvYmplY3RcclxuXHRcdCogPndoYXQ8IC0gc3RyaW5nLiBlLmcuIFwibmV3X3RlcnJhaW5fc2xpY2VcIlxyXG5cdFx0KiA+b2JqPCAtIG9iamVjdCB0byByZWdpc3RlclxyXG5cdFx0Ki9cclxuXHRcdFxyXG5cdFx0dmFyIHRhYmxlID0gUmVnaXN0ZXJBc01vZGVsLnNpbXBsZV9vbmVfdGltZV9sb29rdXA7XHJcblxyXG5cdFx0aWYodGFibGVbd2hhdF0pe1xyXG5cdFx0XHR0YWJsZVt3aGF0XS5wdXNoKG9iaik7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0dGFibGVbd2hhdF0gPSBbb2JqXTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHR2YXIgcmV0cmlldmVfcmVnaXN0ZXJlZF9hcyA9IGZ1bmN0aW9uKHdoYXQpe1xyXG5cdFx0LyoqXHJcblx0XHQqIHJldHVybnMgcmVmZXJlbmNlIHRvIHRoZSBvYmplY3QgY29udGF0aW5pbmdcclxuXHRcdCogdGhpbmdzIGN1cnJlbnRseSByZWdpc3RlcmVkIGFzID53aGF0PFxyXG5cdFx0KiB5b3UgYXJlIHJlc3BvbnNpYmxlIGZvciBwb3BwaW5nIChvciBub3QgcG9wcGluZykgdGhlbVxyXG5cdFx0KiBmcm9tIHRoZSBhcnJheSB0byBubyBsb25nZXIgY29uc2llZGVyIChvciBjb250aW51ZSB0byBjb25zaWRlcilcclxuXHRcdCogdGhlbSBhcyByZWdpc3RlcmVkIGFzID53aGF0PFxyXG5cdFx0Ki9cclxuXHRcdHZhciBsaXN0ID0gUmVnaXN0ZXJBc01vZGVsLnNpbXBsZV9vbmVfdGltZV9sb29rdXBbd2hhdF07XHJcblx0XHRpZihsaXN0KXtcclxuXHRcdFx0cmV0dXJuIGxpc3Q7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0cmV0dXJuIFtdO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0dXBkYXRlOiB1cGRhdGUsXHJcblx0XHRyZWdpc3Rlcl9hczogcmVnaXN0ZXJfYXMsXHJcblx0XHRyZXRyaWV2ZV9yZWdpc3RlcmVkX2FzOiByZXRyaWV2ZV9yZWdpc3RlcmVkX2FzXHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUmVnaXN0ZXJBc0NvbnRyb2xsZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRjdXJyZW50X21vZHVsZTogXCJSZWdpc3RlckFzQ29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJjb25maWcgPSByZXF1aXJlIChcIi4uL0NvbmZpZy5qc1wiKTtcclxuXHJcbnZhciBUZXJyYWluQ29udHJvbGxlciA9IChmdW5jdGlvbigpe1xyXG5cdC8qIHRoaXMgd2lsbCBiZSB0aGUgcGh5c2ljYWwgcmVwcmVzZW50YXRpb24gb2YgdGhlIHRlcnJhaW5cclxuXHQgKiBjdXJyZW50bHkgaXQgY29udGFpbnMgZ3JhcGhpY2FsIGJpdHMsIGJ1dCB0aGF0IHdpbGwgY2hhbmdlXHJcblx0ICovXHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcclxuXHQgICAgaW5jbHVkZSgpO1xyXG5cdCAgICBUZXJyYWluTW9kZWwuc2VlZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoyMDAwKSArIDEwMDA7Ly9wbGFjZWhvbGRlciBmb3Igc2VlZFxyXG5cclxuXHR9O1xyXG5cdFxyXG5cdFxyXG5cdHZhciB1cGRhdGUgPSBmdW5jdGlvbigpe1xyXG5cdFx0Ly8gY2hlY2sgZm9yIGFueSBjaHVua3MgdG8gYmUgdW5sb2FkZWQvZGVsZXRlZCB3aWxsIGdvIGhlcmUsIGZvciBub3dcclxuXHRcdC8vIG1heWJlIGl0J2xsIGNoZWNrIGZvciBhbGwgcGxheWVycyB0byBiZSBzdWZmaWNpZW50bHkgZmFyIHRvIHRoZSByaWdodFxyXG5cdFx0Ly8gb2YgaXQsIG1heWJlIG9uZSBjaHVuayBpbiBhZHZhbmNlLCBvciBzbXRoIGxpa2UgdGhhdFxyXG5cdFx0Ly9pZiAoY29uZmlnLm1vdmVtZW50X2VkZ2UueCA+IHgpXHJcblx0XHR3aGlsZShUZXJyYWluTW9kZWwudGVycmFpbl9zbGljZXNfcXVldWUubGVuZ3RoIDwgNCl7XHJcblx0XHRcdHZhciBzbGljZSA9IE5ld1RlcnJhaW5TbGljZSgpO1xyXG5cdFx0XHRUZXJyYWluTW9kZWwudGVycmFpbl9zbGljZXNfcXVldWUucHVzaChzbGljZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGNtZHMgPSBLZXlib2FyZENvbnRyb2xsZXIuZGVidWdfY29tbWFuZHMoKTtcclxuXHJcblx0XHRpZihjbWRzKFwibmV3X3NsaWNlXCIpKXtcclxuXHRcdFx0XHJcblx0XHRcdHZhciBzbGljZSA9IE5ld1RlcnJhaW5TbGljZSgpO1xyXG5cdFx0XHRUZXJyYWluTW9kZWwudGVycmFpbl9zbGljZXNfcXVldWUucHVzaChzbGljZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoV29ybGRDb250cm9sbGVyLmdldF9tb3ZlbWVudF9lZGdlKCkgPiAoVGVycmFpbk1vZGVsLnRlcnJhaW5fc2xpY2VzX3F1ZXVlLmxlbmd0aC0zKSooMjApKXtcclxuXHRcdFx0dmFyIHNsaWNlID0gTmV3VGVycmFpblNsaWNlKFRlcnJhaW5Nb2RlbC5zZWVkKTtcclxuXHRcdFx0VGVycmFpbk1vZGVsLnRlcnJhaW5fc2xpY2VzX3F1ZXVlLnB1c2goc2xpY2UpO1xyXG5cdFx0XHRUZXJyYWluTW9kZWwuc2VlZCA9ICgoKFRlcnJhaW5Nb2RlbC5zZWVkKSAqIChUZXJyYWluTW9kZWwuc2VlZCkgLSBUZXJyYWluTW9kZWwuc2VlZCAvIDIpKSAlIDIwMDAgKyAxMDAxO1xyXG5cdFx0XHRXb3JsZENvbnRyb2xsZXIuc2V0X3NwYXduKCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGNoZWNrX2Zvcl9vbGRfc2xpY2VzKCk7XHJcblx0fTtcclxuXHJcblxyXG5cdHZhciBOZXdUZXJyYWluU2xpY2UgPSBmdW5jdGlvbihzZWVkKXtcclxuXHRcdC8qIHRoaXMgdGFrZXMgY2FyZSBvZiBhcHBlbmRpbmcgbmV3IHRlcnJhaW4gc2xpY2UgdG8gdGhlIGdlbmVyYXRlZCB0ZXJyYWluXHJcblx0XHQgKiBpdCBjYWxjdWxhdGVzIGl0J3Mgb3JpZ2luIHggYW5kIHkgcG9zaXRpb25zIGFuZCB3aGF0ZXZlciBvdGhlciBzdHVmZixcclxuXHRcdCAqIGdlbmVyYXRlcyBzbGljZTsgc2V0cyB1cCBldmVyeXRoaW5nXHJcblx0XHQgKi9cclxuXHRcdHZhciB4X29mZnNldCA9IFRlcnJhaW5Nb2RlbC5zbGljZV9jb3VudGVyICogQ29uZmlnLlRlcnJhaW5TbGljZS5ncmlkX2NvbHVtbnM7XHJcblxyXG5cdFx0VGVycmFpbk1vZGVsLnNsaWNlX2NvdW50ZXIrKzsgLy8gVE9ETzogY2hhbmdlIGhvdyBpdCB3b3JrcyB3aGVuIHRydWx5IGluZmluaXRlXHJcblxyXG5cdFx0aWYoVGVycmFpbk1vZGVsLmluaXRpYWxfZ2VuZXJhdGVkIDwgMyl7XHJcblx0XHRcdFRlcnJhaW5Nb2RlbC5pbml0aWFsX2dlbmVyYXRlZCsrO1xyXG5cdFx0XHR2YXIgc2xpY2UgPSBuZXcgVGVycmFpblNsaWNlQ29udHJvbGxlci5nZW5lcmF0ZV9pbml0aWFsKHhfb2Zmc2V0KTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHR2YXIgc2xpY2UgPSBuZXcgVGVycmFpblNsaWNlQ29udHJvbGxlci5nZW5lcmF0ZV9yYW5kb20oeF9vZmZzZXQsIHNlZWQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdElkZW50aWZpY2F0aW9uQ29udHJvbGxlci5hc3NpZ25faWQoc2xpY2UpO1xyXG5cclxuXHRcdE1hcmtBc05ld1RlcnJhaW5TbGljZShzbGljZSk7IFxyXG5cclxuXHRcdHJldHVybiBzbGljZTtcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIGNoZWNrX2Zvcl9vbGRfc2xpY2VzID0gZnVuY3Rpb24oKXtcclxuXHRcdC8qKlxyXG5cdFx0KiBjaGVjayBmb3Igc2xpY2VzIHRoYXQgYXJlIHRvbyBmYXIgYmVoaW5kIGFuZCBzaG91bGQgYmUgcmVtb3ZlZFxyXG5cdFx0Ki9cclxuXHJcblx0XHR2YXIgdHF1ZXVlID0gVGVycmFpbk1vZGVsLnRlcnJhaW5fc2xpY2VzX3F1ZXVlO1xyXG5cdFx0dmFyIGN1dF9vZmZfaW5kZXggPSAwOyAvLyB3aGF0IGFtbnQgb2Ygc2xpY2VzIHNob3VsZCBnbyBvZmYgdGhlIHF1ZXVlXHJcblxyXG5cdFx0Ly8gZmluZCB0aGUgb2xkIHNsaWNlcyBhbmQgaGFuZGxlIHRoZWlyIGRlbGV0aW9uXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdHF1ZXVlLmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0dmFyIHNsaWNlID0gdHF1ZXVlW2ldO1xyXG5cdFx0XHR2YXIgc2xpY2VfZW5kX3ggPSBzbGljZS5vcmlnaW4ueCArIHNsaWNlLmdyaWRfY29sdW1ucyAqIHNsaWNlLmNlbGxfdztcclxuXHJcblx0XHRcdGlmKHNsaWNlX2VuZF94IDwgV29ybGRDb250cm9sbGVyLmdldF9tb3ZlbWVudF9lZGdlKXtcclxuXHRcdFx0XHQvLyBpZiBzbGljZSBpcyB1bnJlYWNoYWJsZSwgZGVsZXRlIGl0IFxyXG5cdFx0XHRcdGN1dF9vZmZfaW5kZXgrKztcclxuXHRcdFx0XHRkZWxldGVfc2xpY2Uoc2xpY2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gbm93IHJlbW92ZSBhbGwgZm91bmQgb2xkIHNsaWNlcyBmcm9tIHRoZSBxdWV1ZVxyXG5cdFx0aWYoY3V0X29mZl9pbmRleCA+IDApe1xyXG5cdFx0XHRUZXJyYWluTW9kZWwudGVycmFpbl9zbGljZXNfcXVldWUgPSB0cXVldWUuc2xpY2UoY3V0X29mZl9pbmRleCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHJcblx0dmFyIGRlbGV0ZV9zbGljZSA9IGZ1bmN0aW9uKHNsaWNlKXtcclxuXHRcdC8qKlxyXG5cdFx0KiBhc3N1bWVzIHRoYXQgc2xpY2Ugd2lsbCBiZSBwb3BwZWQgZnJvbSB0aGUgdGVycmFpbiBzbGljZSBxdWV1ZSBlbHNld2hlcmVcclxuXHRcdCogKG9yIHdhcyBhbHJlYWR5KVxyXG5cdFx0KiBvdGhlcndpc2UgdGhlIHNsaWNlIHdvbid0IGJlIHByb3Blcmx5IGRlbGV0ZWRcclxuXHRcdCovXHJcblx0XHRcdFxyXG5cdFx0Y29uc29sZS5sb2coXCJkZWxldGluZyBzbGljZSB3aXRoIG9yaWdpblwiLCBzbGljZS5vcmlnaW4pO1xyXG5cdFx0XHJcblx0XHR2YXIgZ3JpZCA9IHNsaWNlLmdyaWQ7XHJcblx0XHRcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBncmlkLmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0dmFyIHJvdyA9IGdyaWRbaV07XHJcblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCByb3cubGVuZ3RoOyBqKyspe1xyXG5cdFx0XHRcdHZhciBjZWxsID0gcm93W2pdO1xyXG5cdFx0XHRcdGlmKGNlbGwua2luZCAhPSAwKXtcclxuXHRcdFx0XHRcdFBoeXNpY3NDb250cm9sbGVyLnJlbW92ZV9ib2R5KGNlbGwuYm9keSk7XHJcblx0XHRcdFx0XHRJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIucmVtb3ZlX2lkKGNlbGwuaWQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdFxyXG5cdFx0Ly8gRm9yIGdyYXBoaWNzIHRvIHBpY2sgdXAgYW5kIGRlbGV0ZSB1bm5lZWRlZCBncmFwaGljc1xyXG5cdFx0UmVnaXN0ZXJBc0NvbnRyb2xsZXIucmVnaXN0ZXJfYXMoXCJyZW1vdmVkX3NsaWNlXCIsIHNsaWNlKTtcclxuXHJcblx0XHQvLyBmcmVlIHRoZSBpZCAoeWVzLCB0ZXJyYWluIHNsaWNlIGhhcyBpZCBpZFxyXG5cdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyLnJlbW92ZV9pZChzbGljZS5pZCk7XHJcblx0fTtcclxuXHRcclxuXHRcclxuXHJcblx0XHJcblx0dmFyIGZvcl9lYWNoX3RpbGUgPSBmdW5jdGlvbihmKXtcclxuXHRcdC8vIHRha2VzIGZ1bmN0aW9uID5mPCB0aGF0IHRha2VzIHRocmVlIHBhcmFtZXRlcnM6IHRpbGUgKGVhc2VsanMgb2JqZWN0KSxcclxuXHRcdC8vIHRlcnJhaW5fbHZsIChpbnQpLCBhbmQgdGlsZV9pbmRleCAoaW50KVxyXG5cdFx0Ly8gY2FsbHMgdGhpcyBmdW5jdGlvbiBmb3IgZXZlcnkgdGlsZSBvZiB0aGUgdGVycmFpblxyXG5cdFx0XHJcblx0XHR2YXIgcXVldWVzID0gVGVycmFpbk1vZGVsLnRlcnJhaW5fcXVldWVzO1xyXG5cclxuXHRcdCQuZWFjaChxdWV1ZXMsIGZ1bmN0aW9uKHRlcnJhaW5fbHZsKXtcclxuXHRcdFx0JC5lYWNoKHF1ZXVlc1t0ZXJyYWluX2x2bF0sIGZ1bmN0aW9uKHRpbGVfaW5kZXgpe1xyXG5cdFx0XHRcdGYocXVldWVzW3RlcnJhaW5fbHZsXVt0aWxlX2luZGV4XSwgdGVycmFpbl9sdmwsIHRpbGVfaW5kZXgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cclxuXHR9O1xyXG5cclxuXHRcclxuXHR2YXIgTWFya0FzTmV3VGVycmFpblNsaWNlID0gZnVuY3Rpb24oc2xpY2Upe1xyXG5cdFx0Ly9UZXJyYWluTW9kZWwubmV3X3NsaWNlcy5wdXNoKHNsaWNlKTtcclxuXHRcdFJlZ2lzdGVyQXNDb250cm9sbGVyLnJlZ2lzdGVyX2FzKFwiYXdhaXRpbmdfZ3JhcGhpY3NfaW5pdGlhbGl6YXRpb25cIiwgc2xpY2UpO1xyXG5cdH07XHJcblxyXG5cdC8vdmFyIE5ld1NsaWNlc0F2YWlsYWJsZSA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvL3JldHVybiAoVGVycmFpbk1vZGVsLm5ld19zbGljZXMubGVuZ3RoID4gMCk7XHJcblx0Ly99O1xyXG5cclxuXHQvL3ZhciBHZXROZXdUZXJyYWluU2xpY2VzID0gZnVuY3Rpb24oKXtcclxuXHRcdC8vcmV0dXJuIFRlcnJhaW5Nb2RlbC5uZXdfc2xpY2VzO1xyXG5cdC8vfTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdHVwZGF0ZTogdXBkYXRlLFxyXG5cdFx0aW5pdDogaW5pdCxcclxuXHRcdE5ld1RlcnJhaW5TbGljZTogTmV3VGVycmFpblNsaWNlLFxyXG5cdFx0TWFya0FzTmV3VGVycmFpblNsaWNlOiBNYXJrQXNOZXdUZXJyYWluU2xpY2UsXHJcblx0XHQvL05ld1NsaWNlc0F2YWlsYWJsZTogTmV3U2xpY2VzQXZhaWxhYmxlLFxyXG5cdFx0Ly9HZXROZXdUZXJyYWluU2xpY2VzOiBHZXROZXdUZXJyYWluU2xpY2VzLFxyXG5cdH1cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gVGVycmFpbkNvbnRyb2xsZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRjdXJyZW50X21vZHVsZTogXCJUZXJyYWluQ29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJcclxudmFyIFRlcnJhaW5TbGljZUNvbnRyb2xsZXIgPSAoZnVuY3Rpb24gKCkge1xyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiBpcyByYW4gZnJvbSB0aGUgSW5pdENvbnRyb2xsZXIgb25jZSB3aGVuIHRoZSBnYW1lIGlzIGxvYWRlZCAqL1xyXG5cdFx0aW5jbHVkZSgpOyAvLyBzYXRpc2Z5IHJlcXVpcmVtZW50c1xyXG5cdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyLmFzc2lnbl90eXBlKFRlcnJhaW5TbGljZU1vZGVsLkNlbGwsIFwidGVycmFpbl9jZWxsXCIpO1xyXG5cdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyLmFzc2lnbl90eXBlKFRlcnJhaW5TbGljZU1vZGVsLlNsaWNlLCBcInRlcnJhaW5fc2xpY2VcIik7XHJcblxyXG5cdH07XHJcblxyXG5cdHZhciB1cGRhdGUgPSBmdW5jdGlvbihzbGljZSl7XHJcblx0XHRcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIGdldF9uZXh0X29yaWdpbiA9IGZ1bmN0aW9uKCl7XHJcblx0fTtcclxuXHRcclxuXHJcblx0XHJcblx0dmFyIHNwYXduQmxvY2sgPSBmdW5jdGlvbih4LCB5LCBraW5kKXtcclxuXHRcdC8vc3Bhd24gaW5zdGFuY2Ugb2YgdGhpcyBlbnRpdHkgYXQgdGhlIGdpdmVuIGNvb3JkaW5hdGVzXHJcblx0XHR2YXIgYmxvY2sgPSBuZXcgVGVycmFpblNsaWNlTW9kZWwuQ2VsbChraW5kJTMpOyAvL2tpbmQgaXMgYW4gaW50LCAxID0gYmxvY2ssIDIgPSBwbGF0Zm9ybVxyXG5cdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyLmFzc2lnbl9pZChibG9jayk7IC8vZXZlbnR1YWxseSB3ZSBtYXkgd2FudCB0byByZW1vdmUgdGhpcyBmb3IgdGhlIHNha2Ugb2YgZWZmaWNpZW5jeVxyXG5cdFx0YmxvY2suYm9keSA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7eDogeCwgeTogeX0sIGJsb2NrKTtcclxuXHRcdHJldHVybiBibG9jaztcclxuXHR9O1xyXG5cdFxyXG5cdHZhciBzcGF3blNwaWtlID0gZnVuY3Rpb24oeCwgeSl7XHJcblx0XHQvL3NwYXduIGluc3RhbmNlIG9mIHRoaXMgZW50aXR5IGF0IHRoZSBnaXZlbiBjb29yZGluYXRlc1xyXG5cdFx0dmFyIHNwaWtlID0gbmV3IFRlcnJhaW5TbGljZU1vZGVsLkNlbGwoMyk7IC8va2luZCA9IDMgbWVhbnMgc3Bpa2VzXHJcblx0XHRzcGlrZS5jYW5fYXR0YWNrID0gdHJ1ZTtcclxuXHRcdHNwaWtlLmRhbWFnZSA9IDQ7XHJcblx0XHRJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuYXNzaWduX2lkKHNwaWtlKTsgLy9ldmVudHVhbGx5IHdlIG1heSB3YW50IHRvIHJlbW92ZSB0aGlzIGZvciB0aGUgc2FrZSBvZiBlZmZpY2llbmN5XHJcblx0XHRzcGlrZS5ib2R5ID0gUGh5c2ljc0NvbnRyb2xsZXIuZ2V0X3JlY3Rhbmd1bGFyKHt4OiB4LCB5OiB5fSwgc3Bpa2UpO1xyXG5cdFx0cmV0dXJuIHNwaWtlO1xyXG5cdH07XHJcblx0XHJcblx0dmFyIHNwYXduR2FwID0gZnVuY3Rpb24oeCx5KXtcclxuXHRcdC8vIDAgd2lsbCBiZSB0aGUgaWQgZm9yIHRoZSBcImFpclwiIGkuZS4gbm90aGluZ1xyXG5cdFx0dmFyIGdhcDtcclxuXHRcdGdhcCA9IG5ldyBUZXJyYWluU2xpY2VNb2RlbC5DZWxsKDApO1xyXG5cdFx0Ly9JZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuYXNzaWduX2lkKGdhcCk7IC8vIERPIE5PVCBBU1NJR04gSURTIFRPIEVNUFRZIFNQQUNFU1xyXG5cdFx0cmV0dXJuIGdhcDtcclxuXHR9O1xyXG5cdFxyXG5cdHZhciBnZXRSYW5kb21OdW1iZXIgPSBmdW5jdGlvbiAoc2VlZCkge1xyXG5cdFx0cmV0dXJuIChzZWVkKnNlZWQpJTIwMDAgKyAxMDAwO1xyXG5cdH07XHJcblx0XHJcblx0dmFyIGJ1aWxkVGVycmFpblNsaWNlXzAwID0gZnVuY3Rpb24oc2xpY2Usc2VlZCl7XHJcblx0XHJcblx0ICAgIC8vc2V0IHZhcmlhYmxlc1xyXG5cdCAgICAvL2NvbnNvbGUubG9nKHNlZWQpO1xyXG5cdCAgICB2YXIgc2VlZCA9IHNlZWQ7XHJcblx0XHR2YXIgcm93cyA9IHNsaWNlLmdyaWRfcm93cztcclxuXHRcdHZhciBjb2x1bW5zID0gc2xpY2UuZ3JpZF9jb2x1bW5zO1xyXG5cdFx0dmFyIGksajtcclxuXHRcdHZhciBncm91bmRfbHZsID0gcm93cyAtIDM7IC8vdGhlIHJvdyB0aGF0IGlzIGNvbnNpZGVyZWQgZ3JvdW5kIGxldmVsLlxyXG5cdFx0dmFyIHZnYXBfbWluID0gNztcclxuXHRcdHZhciB2Z2FwX2xlbiA9IDA7XHJcblx0XHR2YXIgaGdhcF9taW4gPSAxMDtcdFx0XHRcdC8vbWluaW11bSBzaXplIG9mIGdhcHMgYmV0d2VlbiBwbGF0Zm9ybXNcclxuXHRcdHZhciBoZ2FwX2xlbiA9IDA7IFx0XHQvL2N1cnJlbnQgbnVtYmVyIG9mIGNvbnNlY3V0aXZlIGhvcml6b250YWwgZ2Fwc1xyXG5cdFx0dmFyIHBpdF9tYXggPSA4O1x0XHRcdFx0Ly9tYXhpbXVtIGxlbiBvZiBwaXRzIGluIGJsb2Nrc1xyXG5cdFx0dmFyIHBpdF9sZW4gPSAwOyBcdFx0Ly9jdXJyZW50IG51bWJlciBvZiBjb25zZWN1dGl2ZSBwaXRzXHJcblx0XHR2YXIgaGFzX3BpdCA9IFtdO1xyXG5cdFx0dmFyIHBpdF9mcmVxdWVuY3kgPSA2OyBcdFx0Ly9iYXNlIHBlcmNlbnRhZ2UgY2hhbmNlIG9mIGEgcGl0IGJlaW5nIGR1Z1xyXG5cdFx0dmFyIHBsYXRmb3JtX2xlbl9tYXggPSA3O1x0Ly9tYXhpbXVtIGxlbiBvZiBhIHBsYXRmb3JtXHJcblx0XHR2YXIgcGxhdGZvcm1fbGVuX21pbiA9IDM7IC8vbWluaW11bSBsZW4gb2YgYSBwbGF0Zm9ybVxyXG5cdFx0dmFyIHBsYXRmb3JtX2xlbiA9IDA7IFx0XHQvL2xlbiBvZiBjdXJyZW50bHkgZ2VuZXJhdGVkIHBsYXRmb3JtXHJcblx0XHR2YXIgcGxhdGZvcm1fY291bnRfbWF4ID0gMjsgLy9tYXhpbXVtIG51bWJlciBvZiBwbGF0Zm9ybXMgcGVyIGNvbHVtblxyXG5cdFx0dmFyIHBsYXRmb3JtX2NvdW50ID0gW107IFx0XHQvL2tlZXBzIHRyYWNrIG9mIHBsYXRmb3JtcyBwZXIgY29sdW1uXHJcblx0XHR2YXIgcGxhdGZvcm1fZnJlcXVlbmN5ID0gMTA7Ly9iYXNlIHBlcmNlbnRhZ2UgY2hhbmNlIG9mIGEgcGxhdGZvcm0gdG8gYmUgZ2VuZXJhdGVkXHJcblx0XHR2YXIgc3Bpa2VfZnJlcXVlbmN5ID0gNTsvL2Jhc2UgcGVyY2VudGFnZSBjaGFuY2Ugb2YgYSBwbGF0Zm9ybSB0byBoYXZlIHNwaWtlc1xyXG5cdFx0LypcclxuXHRcdHZhciBzcGlrZSBmcmVxdWVuY3lcclxuXHRcdHZhciBjb2x1bW4gZnJlcXVlbmN5XHJcblx0XHRldGMuXHJcblx0XHQqL1xyXG5cdFx0Zm9yKGk9MDsgaTw9Y29sdW1ucztpKyspe1xyXG5cdFx0XHRwbGF0Zm9ybV9jb3VudFtpXSA9IDA7XHJcblx0XHRcdGhhc19waXRbaV0gPSBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHQvL2J1aWxkIHRoZSBzdGFnZSBmcm9tIHRoZSBib3R0b20gdXBcclxuXHRcdC8qXHJcblx0XHRCdWlsZCBTdGFnZSBmcm9tIGJvdHRvbSB1cCwgbGVmdCB0byByaWdodFxyXG5cdFx0bG9hZCBibG9ja3MgYW5kIGdhcHMgaW50byBzbGljZS5ncmlkW2ldW2pdXHJcblx0XHRcclxuXHRcdCovXHJcblx0XHRmb3IoaT1yb3dzIC0gMTtpPj0wO2ktLSl7IC8vb3V0ZXIgbG9vcDogZ2VuZXJhdGUgcm93cyBib3R0b20gdG8gdG9wXHJcblx0XHRcdHNsaWNlLmdyaWRbaV0gPSBbXTtcclxuXHRcdFx0aWYgKHZnYXBfbGVuIDwgdmdhcF9taW4pe1xyXG5cdFx0XHRcdHZnYXBfbGVuKys7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHNlZWQgJSAxMCA9PSAwKSB7XHJcblx0XHRcdCAgICBzZWVkICs9IGk7XHJcblx0XHRcdH1cclxuXHRcdFx0Zm9yKGo9MDtqPGNvbHVtbnM7aisrKXsgLy9pbm5lciBsb29wOiBnZW5lcmF0ZSBmcm9tIGxlZnQgdG8gcmlnaHQgd2l0aGluIGN1cnJlbnQgcm93XHJcblx0XHRcdFx0dmFyIHggPSBzbGljZS5vcmlnaW4ueCArIGogKiBzbGljZS5jZWxsX3cgKyBzbGljZS5jZWxsX3cvMjtcclxuXHRcdFx0XHR2YXIgeSA9IHNsaWNlLm9yaWdpbi55ICsgaSAqIHNsaWNlLmNlbGxfdyArIHNsaWNlLmNlbGxfdy8yO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGlmIChpID49IGdyb3VuZF9sdmwpe1x0Ly9JZiBvbiBvciBiZWxvdyBncm91bmQgbGV2ZWwsIEdlbmVyYXRlIEdyb3VuZFxyXG5cdFx0XHRcdCAgICBpZiAocGl0X2xlbiA8IHBpdF9tYXggJiYgKGdldFJhbmRvbU51bWJlcihzZWVkKSAlIGkgPCBwaXRfZnJlcXVlbmN5IHx8IHBpdF9sZW4gIT0gMCkgfHwgaGFzX3BpdFtqXSkge1xyXG5cdFx0XHRcdFx0XHRzbGljZS5ncmlkW2ldW2pdID0gc3Bhd25HYXAoeCx5KTsgLy9jcmVhdGUgZ2FwXHJcblx0XHRcdFx0XHRcdGhhc19waXRbal0gPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRwaXRfbGVuKys7IC8vdGhlIHBpdCBnZXRzIHdpZGVyXHJcblx0XHRcdFx0XHRcdHNlZWQgPSBnZXRSYW5kb21OdW1iZXIoc2VlZCkgKyA3MTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGVsc2V7XHJcblx0XHRcdFx0XHRcdHNsaWNlLmdyaWRbaV1bal0gPSBzcGF3bkJsb2NrKHgseSwxKTsvL2NyZWF0ZSBhIGdyb3VuZCBibG9jayAoMSBtZWFucyBncm91bmQpXHJcblx0XHRcdFx0XHRcdHBpdF9sZW4gPSAwOyAvL2FueSBwaXRzIGJlaW5nIHNwYXduZWQgaGF2ZSBiZWVuIGludGVycnVwdGVkXHJcblx0XHRcdFx0XHRcdGlmIChpID09IGdyb3VuZF9sdmwpXHJcblx0XHRcdFx0XHRcdFx0c2xpY2UuZ3JpZFtpXVtqXS5wb3NpdGlvbiA9IFwic3VyZmFjZVwiO1xyXG5cdFx0XHRcdFx0XHRlbHNle1xyXG5cdFx0XHRcdFx0XHRzbGljZS5ncmlkW2ldW2pdLnBvc2l0aW9uID0gXCJ1bmRlcmdyb3VuZFwiO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fWVsc2V7IC8vRWxTRSBHZW5lcmF0ZSBQbGF0Zm9ybXNcclxuXHRcdFx0XHRcdGlmKChoZ2FwX2xlbiA+PSBoZ2FwX21pbiB8fCBwbGF0Zm9ybV9sZW4gPiAwKSAvL2lmIHRoZXJlIGlzIGEgbGFyZ2UgZ2FwIG9yIGEgcGxhdGZvcm0gYmVpbmcgYnVpbHRcclxuXHRcdFx0XHRcdCYmIChwbGF0Zm9ybV9sZW4gPCBwbGF0Zm9ybV9sZW5fbWF4KSAvLyBhbmQgYW55IHBsYXRmb3JtIGJlaW5nIGJ1aWx0IGlzIGxlc3MgdGhhbiBtYXggbGVuXHJcblx0XHRcdFx0XHQmJiAocGxhdGZvcm1fY291bnRbal0gPCBwbGF0Zm9ybV9jb3VudF9tYXgpIC8vIGFuZCB0aGUgY3VycmVudCBjb2x1bW4ncyBwbGF0Zm9ybSBsaW1pdCBoYXMgbm90IGJlZW4gbWV0XHJcblx0XHRcdFx0XHQmJiAodmdhcF9sZW4gPj0gdmdhcF9taW4pIC8vaWYgdGhlIHZlcnRpY2FsIGdhcCBtaW5pbXVtIGhhcyBiZWVuIG1ldFxyXG5cdFx0XHRcdFx0JiYgKHBsYXRmb3JtX2xlbiA+IDAgfHwgKGo8Y29sdW1ucy0xICYmIHBsYXRmb3JtX2NvdW50W2orMV0gPCBwbGF0Zm9ybV9jb3VudF9tYXgpKSl7IC8vYW5kIHRoZSBwbGF0Zm9ybSBpcyBub3QgZ29pbmcgdG8gYmUgYSBzaW5nbGV0b25cclxuXHRcdFx0XHRcdFx0aWYgKGdldFJhbmRvbU51bWJlcihzZWVkKSUxMDAgPCBwbGF0Zm9ybV9mcmVxdWVuY3kgfHwgKHBsYXRmb3JtX2xlbiA+IDAgJiYgcGxhdGZvcm1fbGVuIDw9IHBsYXRmb3JtX2xlbl9taW4pKXtcclxuXHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0c2xpY2UuZ3JpZFtpXVtqXSA9IHNwYXduQmxvY2soeCx5LDIpOy8vY3JlYXRlIHBsYXRmb3JtICgyIG1lYW5zIHBsYXRmb3JtKVxyXG5cdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdGlmKGdldFJhbmRvbU51bWJlcihzZWVkKSUyMDAgPCBzcGlrZV9mcmVxdWVuY3kpe1xyXG5cdFx0XHRcdFx0XHRcdCAgICBzbGljZS5ncmlkW2kgKyAxXVtqXSA9IHNwYXduU3Bpa2UoeCwgeSAtIHNsaWNlLmNlbGxfdyk7XHJcblx0XHRcdFx0XHRcdFx0ICAgIHNlZWQgPSBnZXRSYW5kb21OdW1iZXIoc2VlZCkgKyAyMTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0Ly9jaGVjayBhZXN0aGV0aWMgc3R1ZmYsIGxpa2UgcGxhdGZvcm0gZWRnZXNcclxuXHRcdFx0XHRcdFx0XHRpZiAocGxhdGZvcm1fbGVuID09IDApe1xyXG5cdFx0XHRcdFx0XHRcdFx0c2xpY2UuZ3JpZFtpXVtqXS5wb3NpdGlvbiA9IFwibGVmdFwiO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRlbHNle1xyXG5cdFx0XHRcdFx0XHRcdFx0c2xpY2UuZ3JpZFtpXVtqXS5wb3NpdGlvbiA9IFwicmlnaHRcIjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYgKGo+MCl7aWYgKHNsaWNlLmdyaWRbaV1bai0xXS5raW5kICE9IDApe1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHNsaWNlLmdyaWRbaV1bai0xXS5wb3NpdGlvbiAhPSBcImxlZnRcIil7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNsaWNlLmdyaWRbaV1bai0xXS5wb3NpdGlvbiA9IFwibWlkZGxlXCI7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fX1cclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRzZWVkID0gZ2V0UmFuZG9tTnVtYmVyKHNlZWQpO1xyXG5cdFx0XHRcdFx0XHRcdHBsYXRmb3JtX2xlbisrO1x0Ly9wbGF0Zm9ybSBnZXRzIGxvbmdlciwgYW5kIFxyXG5cdFx0XHRcdFx0XHRcdHBsYXRmb3JtX2NvdW50W2pdKys7Ly90aGUgbnVtYmVyIG9mIHBsYXRmb3JtcyBpbiB0aGUgY3VycmVudCBjb2x1bW4gaW5jcmVhc2VzXHJcblx0XHRcdFx0XHRcdFx0aGdhcF9sZW4gPSAwOyBcdFx0Ly9yZXNldCB0aGUgZ2FwIGNvdW50ZXIgdG8gMFxyXG5cdFx0XHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdFx0XHRpZiAoc2xpY2UuZ3JpZFtpXVtqXSA9PSBudWxsKXtcclxuXHRcdFx0XHRcdFx0XHRcdHNsaWNlLmdyaWRbaV1bal0gPSBzcGF3bkdhcCh4LHkpOyAvL2NyZWF0ZSBhIGdhcFxyXG5cdFx0XHRcdFx0XHRcdFx0cGxhdGZvcm1fbGVuID0gMDsgLy9pZiB0aGVyZSB3YXMgYSBwbGF0Zm9ybSwgaXQgaGFzIGJlZW4gaW50ZXJydXB0ZWRcclxuXHRcdFx0XHRcdFx0XHRcdGhnYXBfbGVuKys7IC8vdGhlIGdhcCBnZXRzIHdpZGVyXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdFx0aWYgKHNsaWNlLmdyaWRbaV1bal0gPT0gbnVsbCl7XHJcblx0XHRcdFx0XHRcdFx0c2xpY2UuZ3JpZFtpXVtqXSA9IHNwYXduR2FwKHgseSk7IC8vY3JlYXRlIGEgZ2FwXHJcblx0XHRcdFx0XHRcdFx0cGxhdGZvcm1fbGVuID0gMDsgLy9pZiB0aGVyZSB3YXMgYSBwbGF0Zm9ybSwgaXQgaGFzIGJlZW4gaW50ZXJydXB0ZWRcclxuXHRcdFx0XHRcdFx0XHRoZ2FwX2xlbisrOyAvL3RoZSBnYXAgZ2V0cyB3aWRlclxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0c2VlZCA9IGdldFJhbmRvbU51bWJlcihzZWVkKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0dmdhcF9sZW4gPSB2Z2FwX2xlbiV2Z2FwX21pbjtcclxuXHRcdH1cclxuXHRcdHJldHVybiBzbGljZTtcclxuXHR9O1xyXG5cdFxyXG5cdC8vcHJlZ2VuZXJhdGVkIHNsaWNlXHJcblx0dmFyIGJ1aWxkVGVycmFpblNsaWNlXzAxID0gZnVuY3Rpb24oc2xpY2Usc2VlZCl7XHJcblx0XHQvL3NldCB2YXJpYWJsZXNcclxuXHRcdHZhciByb3dzID0gc2xpY2UuZ3JpZF9yb3dzO1xyXG5cdFx0dmFyIGNvbHVtbnMgPSBzbGljZS5ncmlkX2NvbHVtbnM7XHJcblx0XHR2YXIgaSxqO1xyXG5cdFx0dmFyIGdyb3VuZF9sdmwgPSByb3dzIC0gMzsgLy90aGUgcm93IHRoYXQgaXMgY29uc2lkZXJlZCBncm91bmQgbGV2ZWwuXHJcblx0XHR2YXIgdmdhcF9taW4gPSA3O1xyXG5cdFx0dmFyIHZnYXBfbGVuID0gMDtcclxuXHRcdHZhciBoZ2FwX21pbiA9IDEwO1x0XHRcdFx0Ly9taW5pbXVtIHNpemUgb2YgZ2FwcyBiZXR3ZWVuIHBsYXRmb3Jtc1xyXG5cdFx0dmFyIGhnYXBfbGVuID0gMDsgXHRcdC8vY3VycmVudCBudW1iZXIgb2YgY29uc2VjdXRpdmUgaG9yaXpvbnRhbCBnYXBzXHJcblx0XHR2YXIgcGl0X21heCA9IDIwO1x0XHRcdFx0Ly9tYXhpbXVtIGxlbiBvZiBwaXRzIGluIGJsb2Nrc1xyXG5cdFx0dmFyIHBpdF9sZW4gPSAwOyBcdFx0Ly9jdXJyZW50IG51bWJlciBvZiBjb25zZWN1dGl2ZSBwaXRzXHJcblx0XHR2YXIgaGFzX3BpdCA9IFtdO1xyXG5cdFx0dmFyIHBpdF9mcmVxdWVuY3kgPSAwOyBcdFx0Ly9iYXNlIHBlcmNlbnRhZ2UgY2hhbmNlIG9mIGEgcGl0IGJlaW5nIGR1Z1xyXG5cdFx0dmFyIHBsYXRmb3JtX2xlbl9tYXggPSA3O1x0Ly9tYXhpbXVtIGxlbiBvZiBhIHBsYXRmb3JtXHJcblx0XHR2YXIgcGxhdGZvcm1fbGVuX21pbiA9IDM7IC8vbWluaW11bSBsZW4gb2YgYSBwbGF0Zm9ybVxyXG5cdFx0dmFyIHBsYXRmb3JtX2xlbiA9IDA7IFx0XHQvL2xlbiBvZiBjdXJyZW50bHkgZ2VuZXJhdGVkIHBsYXRmb3JtXHJcblx0XHR2YXIgcGxhdGZvcm1fY291bnRfbWF4ID0gMjsgLy9tYXhpbXVtIG51bWJlciBvZiBwbGF0Zm9ybXMgcGVyIGNvbHVtblxyXG5cdFx0dmFyIHBsYXRmb3JtX2NvdW50ID0gW107IFx0XHQvL2tlZXBzIHRyYWNrIG9mIHBsYXRmb3JtcyBwZXIgY29sdW1uXHJcblx0XHR2YXIgcGxhdGZvcm1fZnJlcXVlbmN5ID0gNTsvL2Jhc2UgcGVyY2VudGFnZSBjaGFuY2Ugb2YgYSBwbGF0Zm9ybSB0byBiZSBnZW5lcmF0ZWRcclxuXHRcdGZvcihpPTA7IGk8PWNvbHVtbnM7aSsrKXtcclxuXHRcdFx0cGxhdGZvcm1fY291bnRbaV0gPSAwO1xyXG5cdFx0XHRoYXNfcGl0W2ldID0gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRmb3IoaT1yb3dzIC0gMTtpPj0wO2ktLSl7IC8vb3V0ZXIgbG9vcDogZ2VuZXJhdGUgcm93cyBib3R0b20gdG8gdG9wXHJcblx0XHRcdHNsaWNlLmdyaWRbaV0gPSBbXTtcclxuXHRcdFx0Zm9yKGo9MDtqPGNvbHVtbnM7aisrKXsgLy9pbm5lciBsb29wOiBnZW5lcmF0ZSBmcm9tIGxlZnQgdG8gcmlnaHQgd2l0aGluIGN1cnJlbnQgcm93XHJcblx0XHRcdFx0dmFyIHggPSBzbGljZS5vcmlnaW4ueCArIGogKiBzbGljZS5jZWxsX3cgKyBzbGljZS5jZWxsX3cvMjtcclxuXHRcdFx0XHR2YXIgeSA9IHNsaWNlLm9yaWdpbi55ICsgaSAqIHNsaWNlLmNlbGxfdyArIHNsaWNlLmNlbGxfdy8yO1xyXG5cdFx0XHRcdGlmIChpID49IGdyb3VuZF9sdmwpe1x0Ly9JZiBvbiBvciBiZWxvdyBncm91bmQgbGV2ZWwsIEdlbmVyYXRlIEdyb3VuZFxyXG5cdFx0XHRcdFx0c2xpY2UuZ3JpZFtpXVtqXSA9IHNwYXduQmxvY2soeCx5LDEpOy8vY3JlYXRlIGEgZ3JvdW5kIGJsb2NrICgxIG1lYW5zIGdyb3VuZClcclxuXHRcdFx0XHRcdGlmIChpID09IGdyb3VuZF9sdmwpXHJcblx0XHRcdFx0XHRcdHNsaWNlLmdyaWRbaV1bal0ucG9zaXRpb24gPSBcInN1cmZhY2VcIjtcclxuXHRcdFx0XHRcdGVsc2V7XHJcblx0XHRcdFx0XHRzbGljZS5ncmlkW2ldW2pdLnBvc2l0aW9uID0gXCJ1bmRlcmdyb3VuZFwiO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0c2xpY2UuZ3JpZFtpXVtqXSA9IHNwYXduR2FwKHgseSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gc2xpY2U7XHJcblx0fTtcclxuXHRcclxuXHR2YXIgZ2VuZXJhdGVfaW5pdGlhbCA9IGZ1bmN0aW9uKHhfb2Zmc2V0KXtcclxuXHRcdHZhciBzbGljZSA9IG5ldyBUZXJyYWluU2xpY2VNb2RlbC5TbGljZSgpO1xyXG5cdFx0c2xpY2Uub3JpZ2luLnggPSB4X29mZnNldDtcclxuXHRcdHNsaWNlLm9yaWdpbi55ID0gMDtcclxuXHRcdHNsaWNlID0gYnVpbGRUZXJyYWluU2xpY2VfMDEoc2xpY2UpO1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gc2xpY2U7XHJcblx0fVxyXG5cdFxyXG5cdHZhciBnZW5lcmF0ZV9yYW5kb20gPSBmdW5jdGlvbih4X29mZnNldCwgc2VlZCl7XHJcblx0XHR2YXIgc2xpY2UgPSBuZXcgVGVycmFpblNsaWNlTW9kZWwuU2xpY2UoKTtcclxuXHRcdHNsaWNlLm9yaWdpbi54ID0geF9vZmZzZXQ7XHJcblx0XHRzbGljZS5vcmlnaW4ueSA9IDA7XHJcblx0XHQvL2dldCBhIHJhbmRvbSBraW5kIG9mIHNsaWNlXHJcblx0XHRpZiAoZ2V0UmFuZG9tTnVtYmVyKHNlZWQpJTEwMCA8IDk1KXtcclxuXHRcdFx0c2xpY2UgPSBidWlsZFRlcnJhaW5TbGljZV8wMChzbGljZSxzZWVkKTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRzbGljZSA9IGJ1aWxkVGVycmFpblNsaWNlXzAxKHNsaWNlLHNlZWQpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRyZXR1cm4gc2xpY2U7XHJcblx0fTtcclxuXHRcclxuXHJcblxyXG5cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdC8vIGRlY2xhcmUgcHVibGljXHJcblx0XHRpbml0OiBpbml0LCBcclxuXHRcdHVwZGF0ZTogdXBkYXRlLFxyXG5cdFx0Z2VuZXJhdGVfaW5pdGlhbDogZ2VuZXJhdGVfaW5pdGlhbCxcclxuXHRcdGdlbmVyYXRlX3JhbmRvbTogZ2VuZXJhdGVfcmFuZG9tLFxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFRlcnJhaW5TbGljZUNvbnRyb2xsZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRjdXJyZW50X21vZHVsZTogXCJUZXJyYWluU2xpY2VDb250cm9sbGVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5ERUZBVUxUXHJcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cclxuXHJcbiIsInZhciBUZXN0Q29udHJvbGxlciA9IChmdW5jdGlvbigpe1xyXG5cdC8vIHBsYWNlaG9sZGVyIGZvciBpbXBsZW1lbnRpbmcgdGVzdGluZ1xyXG5cdC8vIG1heSBiZSBjaGFuZ2VkL3JlbW92ZWQvdXBncmFkZWQgZGVwZW5kaW5nIG9uIGhvdyB3ZSB3aWxsIGhhbmRsZSBvdXIgdGVzdHNcclxuXHRcclxuXHRcclxuXHR2YXIgcHJlaW5pdF90ZXN0cyA9IGZ1bmN0aW9uKCl7XHJcblx0Ly9Gb3IgdGVzdHMgcmVxdWlyaW5nIHJ1biBiZWZvcmUgaW5pdCBpcyBjYWxsZWRcclxuXHRcclxuXHRcclxuXHR9O1xyXG5cdFxyXG5cdFxyXG5cdHZhciB0ZXN0ID0gZnVuY3Rpb24oKXtcclxuXHRcdC8vIGlmIHlvdSBuZWVkIHNvbWUgc29ydCBvZiB0ZXN0cyBsYXVuY2hlZCwgdGhpcyBpcyBvbmUgb2YgdGhlIHBsYWNlcyB0byBkbyBpdFxyXG5cdFx0UVVuaXQudGVzdCggXCJoZWxsbyB0ZXN0XCIsIGZ1bmN0aW9uKCBhc3NlcnQgKSB7XHJcblx0XHRcdGFzc2VydC5vayggMSA9PSBcIjFcIiwgXCJQYXNzZWQhXCIgKTtcclxuXHRcdH0pO1xyXG5cdFx0SW5jbHVkZXMuYXV0b21hdGVkX3Rlc3RzKCk7XHJcblx0fTtcclxuXHJcblx0dmFyIHBvc3RfbG9hZGluZ190ZXN0cyA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvLyBUT0RPOiBjYWxsIHdoZW4gbG9hZGluZyBhc3NldHMgaXMgY29tcGxldGVkIGlmIHRoZXJlIGFyZSBzb21lIHRlc3RzIHRoYXQgbmVlZFxyXG5cdFx0Ly8gdG8gYmUgZG9uZSBhdCB0aGF0IG1vbWVudC4gKFJlZmVyIHRvIEluaXRDb250cm9sbGVyLmluaXQgYW5kIFxyXG5cdFx0Ly8gSW5pdENvbnRyb2xsZXIuc2V0dXBfYXNzZXRfZGVwZW5kZW50IG1ldGhvZHNcclxuXHR9O1xyXG5cclxuXHR2YXIgdGVzdE1vZGU7XHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24obW9kZSl7XHJcblx0XHRpbmNsdWRlKCk7XHJcblx0XHQvLyBTZXRzIHVwIHRoZSBkZWJ1ZyBjYW52YXMgZHVyaW5nIHRlc3RpbmdcclxuXHRcdFRlc3RNb2RlbC5kX2NhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKENvbmZpZy5ERUJVR19DQU5WQVNfTkFNRSk7XHJcblx0XHR0ZXN0TW9kZSA9IG1vZGU7XHJcblxyXG5cdFx0aWYobW9kZSA9PSBcInRlc3RcIil7XHJcblx0XHRcdFRlc3RNb2RlbC5jb250ZXh0ID0gVGVzdE1vZGVsLmRfY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuXHRcdFx0XHJcblx0XHRcdFRlc3RNb2RlbC5kZWJ1Z0RyYXcgPSBuZXcgQjJkLmIyRGVidWdEcmF3KCk7XHJcblx0XHRcdFRlc3RNb2RlbC5kZWJ1Z0RyYXcuU2V0U3ByaXRlKFRlc3RNb2RlbC5jb250ZXh0KTtcclxuXHRcdFx0VGVzdE1vZGVsLmRlYnVnRHJhdy5TZXREcmF3U2NhbGUoQ29uZmlnLkIyRC5TQ0FMRSk7XHJcblx0XHRcdFRlc3RNb2RlbC5kZWJ1Z0RyYXcuU2V0RmlsbEFscGhhKDAuMyk7XHJcblx0XHRcdFRlc3RNb2RlbC5kZWJ1Z0RyYXcuU2V0TGluZVRoaWNrbmVzcygxLjApO1xyXG5cdFx0XHRUZXN0TW9kZWwuZGVidWdEcmF3LlNldEZsYWdzKEIyZC5iMkRlYnVnRHJhdy5lX3NoYXBlQml0IHwgQjJkLmIyRGVidWdEcmF3LmVfam9pbnRCaXQpO1xyXG5cclxuXHRcdFx0UGh5c2ljc0NvbnRyb2xsZXIuc2V0X2RlYnVnX2RyYXcoVGVzdE1vZGVsLmRlYnVnRHJhdyk7XHJcblxyXG5cdFx0XHRDb25maWcuQjJELmRlYnVnX2RyYXcgPSB0cnVlO1xyXG5cdFx0XHQvLyBTY3JlZW5fVyB3YXMgc2V0dXAgb25seSBhZnRlciB0aGlzIHdhcyBjYWxsZWRcclxuXHJcblx0XHRcdFRlc3RNb2RlbC5kX2NhbnZhcy53aWR0aCA9IENvbmZpZy5TQ1JFRU5fVztcclxuXHRcdFx0VGVzdE1vZGVsLmRfY2FudmFzLmhlaWdodCA9IENvbmZpZy5TQ1JFRU5fSDtcclxuXHJcblx0XHRcdC8vJCgnIycrQ29uZmlnLkRFQlVHX0NBTlZBU19OQU1FKS5zaG93KCk7XHJcblxyXG5cdFx0fWVsc2V7XHJcblx0XHRcdC8vZF9jYW52YXMuaGlkZSgpO1xyXG5cdFx0fVxyXG5cdH07XHJcblx0XHJcblx0Ly90aGlzIGZ1bmN0aW9uIHNldHMgdGhlIHggYW5kIHkgb2Zmc2V0cyBvZiB0aGUgZGVidWcgY2FudmFzXHJcblx0dmFyIHNldF9kZWJ1Z19vZmZzZXQgPSBmdW5jdGlvbih4X29mZnNldCwgeV9vZmZzZXQpe1xyXG5cdCAgICBpZiAodGVzdE1vZGUgPT0gXCJ0ZXN0XCIpe1xyXG5cdCAgICAgICAgY29udGV4dCA9IFRlc3RNb2RlbC5jb250ZXh0O1xyXG5cdCAgICAgICAgY29udGV4dC5zYXZlKCk7XHJcblx0ICAgICAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBDb25maWcuU0NSRUVOX1csIENvbmZpZy5TQ1JFRU5fSCk7XHJcblx0ICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZSh4X29mZnNldCwgeV9vZmZzZXQpO1xyXG5cdCAgICAgICAgUGh5c2ljc0NvbnRyb2xsZXIuZHJhd19kZWJ1ZygpO1xyXG5cdCAgICAgICAgY29udGV4dC5yZXN0b3JlKCk7XHJcblx0ICAgIH1cclxuXHR9O1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0aW5pdDogaW5pdCwgXHJcblx0XHR0ZXN0OiB0ZXN0LFxyXG5cdFx0cG9zdF9sb2FkaW5nX3Rlc3RzOiBwb3N0X2xvYWRpbmdfdGVzdHMsXHJcblx0XHRwcmVpbml0X3Rlc3RzOiBwcmVpbml0X3Rlc3RzLFxyXG5cdFx0c2V0X2RlYnVnX29mZnNldDogc2V0X2RlYnVnX29mZnNldFxyXG5cdH1cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gVGVzdENvbnRyb2xsZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRjdXJyZW50X21vZHVsZTogXCJUZXN0Q29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJcdFxyXG52YXIgV29ybGRDb250cm9sbGVyID0gKGZ1bmN0aW9uKCl7XHJcblx0LyogYWxsIHRoZSBwaHlzaWNzIGNvbnRyb2wgb2YgdGhlIHdob2xlIHdvcmxkXHJcblx0Ki9cclxuICAgIHZhciBtb3ZlbWVudF9lZGdlO1xyXG4gICAgdmFyIHNwYXduX2VuZW15O1xyXG4gICAgdmFyIGRpZmZpY3VsdHk7XHJcblx0XHR2YXIgc2Vhc29uO1xyXG5cdFx0dmFyIG1vdmVtZW50X2VkZ2VfYnVmZmVyO1xyXG5cdFx0dmFyIGJvZHlfdGVzdDtcclxuXHRcdHZhciBzY29yZTtcclxuXHRcdHZhciBwcm9ncmVzcztcclxuXHQvL3ZhciB0ZW1wID0gMDtcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogaXMgcmFuIGZyb20gdGhlIEluaXRDb250cm9sbGVyIG9uY2Ugd2hlbiB0aGUgZ2FtZSBpcyBsb2FkZWQgKi9cclxuXHJcblx0XHRpbmNsdWRlKCk7IC8vIHNhdGlzZnkgcmVxdWlyZW1lbnRzXHJcblx0XHRtb3ZlbWVudF9lZGdlX2J1ZmZlciA9IDIwO1xyXG5cdFx0bW92ZW1lbnRfZWRnZSA9IDA7XHJcblx0XHRzZWFzb24gPSAwO1xyXG5cdFx0c2NvcmUgPSAwO1xyXG5cdFx0cHJvZ3Jlc3MgPSAyMDtcclxuXHRcdC8vYm9keV90ZXN0ID0gbmV3IHBsYXRmb3JtKCk7XHJcblx0XHQvL3ZhciBpZCA9IElkZW50aWZpY2F0aW9uQ29udHJvbGxlci5hc3NpZ25faWQoYm9keV90ZXN0KTtcclxuXHRcdC8vdmFyIGJvZHlfdGVzdCA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7fSwgYm9keV90ZXN0KTtcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKGRlbHRhKXtcclxuXHRcdC8qIGlzIHJhbiBlYWNoIHRpY2sgZnJvbSB0aGUgR2FtZUNvbnRyb2xsZXIudXBkYXRlX2FsbCAqL1xyXG5cdFx0UGh5c2ljc0NvbnRyb2xsZXIuc3RlcChkZWx0YSk7XHJcblx0XHR1cGRhdGVfcHJvZ3Jlc3MoKTtcclxuXHRcdG1vdmVtZW50X2VkZ2UgPSAocHJvZ3Jlc3MgLSBtb3ZlbWVudF9lZGdlX2J1ZmZlcik7XHJcblx0XHRnZXRfc3Bhd24oKTtcclxuXHRcdC8vaWYodGVtcCsrID09IDApe1xyXG5cdFx0XHQvL1RlcnJhaW5Db250cm9sbGVyLk5ld1RlcnJhaW5TbGljZSgpO1xyXG5cdFx0Ly99XHJcblxyXG5cdH07XHJcblx0XHJcblx0dmFyIHVwZGF0ZV9wcm9ncmVzcyA9IGZ1bmN0aW9uKCl7XHJcblx0XHR2YXIgaGVyb2VzID0gRW50aXR5Q29udHJvbGxlci5nZXRfYWxsX2hlcm9lcygpO1xyXG5cdFx0dmFyIG1pbl94ID0gSW5maW5pdHk7XHJcblx0XHRmb3IodmFyIG5ldF9pZCBpbiBoZXJvZXMpe1xyXG5cdFx0XHQvLyBpdGVyYXRlIHRocm91Z2ggYWxsIGNvbm5lY3RlZCBoZXJvZXNcclxuXHRcdFx0Ly8gYW5kIGNob29zZSBtaW5pbXVtIG9mIHRoZWlyIHggcG9zaXRpb25zXHJcblx0XHRcdHZhciBoZXJvX3ggPSBoZXJvZXNbbmV0X2lkXS5ib2R5LkdldFdvcmxkQ2VudGVyKCkueDtcclxuXHRcdFx0aWYoaGVyb194IDwgbWluX3gpe1xyXG5cdFx0XHRcdG1pbl94ID0gaGVyb194O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0aWYocHJvZ3Jlc3MgPCBoZXJvX3ggKXtcclxuXHRcdFx0cHJvZ3Jlc3MgPSBoZXJvX3g7XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHR2YXIgZ2V0X21vdmVtZW50X2VkZ2UgPSBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIG1vdmVtZW50X2VkZ2U7XHJcblx0fVxyXG5cclxuXHR2YXIgZ2V0X3NwYXduID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICBkaWZmaWN1bHR5ID0gTWF0aC5mbG9vcihnZXRfbW92ZW1lbnRfZWRnZSgpIC8gMTAwKTtcclxuXHJcblx0ICAgIHZhciBzcGF3bl9udW07XHJcblx0ICAgIGlmIChzcGF3bl9lbmVteSkge1xyXG5cdCAgICAgICAgZm9yIChpID0gMDsgaSA8IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpIDsgaSsrKSB7XHJcblx0ICAgICAgICAgICAgc3Bhd25fbnVtID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMCk7XHJcblx0ICAgICAgICAgICAgLy8gZGVtb25zdHJhdGlvbiBwdXJwb3NlcyBmb3IgaHllbmFcclxuXHQgICAgICAgICAgICBpZiAoc3Bhd25fbnVtIDw9IDUgKiBkaWZmaWN1bHR5KSB7XHJcblx0ICAgICAgICAgICAgICAgIHZhciBuZXdfaHllbmEgPSBFbnRpdHlDb250cm9sbGVyLnNwYXduKDYwICsgZ2V0X21vdmVtZW50X2VkZ2UoKSwgMTAsIFwiSHllbmFcIik7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIC8qICAgIC8vIGRlbW9uc3RyYXRpb24gcHVycG9zZXMgZm9yIGdyaWZmaW5cclxuXHQgICAgICAgICAgICBlbHNlIGlmIChzcGF3bl9udW0gPD0gMTUgKiBFbnRpdHlNb2RlbC5kaWZmaWN1bHR5ICYmIENvdW50ID4gNSkge1xyXG5cdCAgICAgICAgICAgICAgICB2YXIgbmV3X2dyaWZmaW4gPSBzcGF3big2MCArIFdvcmxkQ29udHJvbGxlci5nZXRfbW92ZW1lbnRfZWRnZSgpICsgaSwgLTIwLCBcIkdyaWZmaW5cIik7XHJcblx0ICAgICAgICAgICAgICAgIENvdW50ID0gMDtcclxuXHQgICAgICAgICAgICB9Ki9cclxuXHQgICAgICAgICAgICBlbHNlIGlmIChzcGF3bl9udW0gPD0gMTUgKiBkaWZmaWN1bHR5KSB7XHJcblx0ICAgICAgICAgICAgICAgIHZhciBuZXdfZ3JpZmZpbiA9IEVudGl0eUNvbnRyb2xsZXIuc3Bhd24oNjAgKyBnZXRfbW92ZW1lbnRfZWRnZSgpLCAxMCwgXCJHcmlmZmluXCIpO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICAgICAgLy8gZGVtb25zdHJhdGlvbiBwdXJwb3NlcyBmb3IgYW50XHJcblx0ICAgICAgICAgICAgZWxzZSB7XHJcblx0ICAgICAgICAgICAgICAgIHZhciBuZXdfYW50ID0gRW50aXR5Q29udHJvbGxlci5zcGF3bihnZXRfbW92ZW1lbnRfZWRnZSgpICsgNjAsIDEwLCBcImFudFwiKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBzcGF3bl9lbmVteSA9IGZhbHNlO1xyXG5cdCAgICB9XHJcblx0ICAgIHJldHVybiBzcGF3bl9udW07XHJcblx0fVxyXG5cclxuXHR2YXIgc2V0X3NwYXduID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICBzcGF3bl9lbmVteSA9IHRydWU7XHJcblx0fVxyXG5cdFxyXG5cdHZhciBnZXRfc2Vhc29uID0gZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiBzZWFzb247XHJcblx0fVxyXG5cdFxyXG5cdHZhciBzZXRfc2Vhc29uID0gZnVuY3Rpb24oaW5kZXgpe1xyXG5cdFx0c2Vhc29uID0gaW5kZXg7XHJcblx0fVxyXG5cdFxyXG5cdHZhciBNYXJrQXNOZXdUZXJyYWluU2xpY2UgPSBmdW5jdGlvbihzbGljZSl7XHJcblx0XHRcclxuXHR9O1xyXG5cdFxyXG5cdHZhciBnZXRfcHJvZ3Jlc3MgPSBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIHByb2dyZXNzO1xyXG5cdH07XHJcblx0XHJcblx0dmFyIGluY3JlYXNlX3Byb2dyZXNzID0gZnVuY3Rpb24oYW1vdW50KXtcclxuXHRcdHByb2dyZXNzICs9IGFtb3VudDtcclxuXHR9O1xyXG5cdFxyXG5cdHZhciBnZXRfc2NvcmUgPSBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIHNjb3JlO1xyXG5cdH07XHJcblx0XHJcblx0dmFyIGluY3JlYXNlX3Njb3JlID0gZnVuY3Rpb24oYW1vdW50KXtcclxuXHRcdHNjb3JlICs9IGFtb3VudDtcclxuXHR9O1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0dXBkYXRlOiB1cGRhdGUsXHJcblx0XHRnZXRfbW92ZW1lbnRfZWRnZTogZ2V0X21vdmVtZW50X2VkZ2UsXHJcblx0XHRnZXRfc2Vhc29uOiBnZXRfc2Vhc29uLFxyXG5cdFx0c2V0X3NlYXNvbjogc2V0X3NlYXNvbixcclxuXHRcdGdldF9zcGF3bjogZ2V0X3NwYXduLFxyXG5cdFx0c2V0X3NwYXduOiBzZXRfc3Bhd24sXHJcblx0XHRpbmNyZWFzZV9zY29yZTogaW5jcmVhc2Vfc2NvcmUsXHJcblx0XHRpbmNyZWFzZV9wcm9ncmVzczogaW5jcmVhc2VfcHJvZ3Jlc3MsXHJcblx0XHRnZXRfc2NvcmU6IGdldF9zY29yZSxcclxuXHRcdGdldF9wcm9ncmVzczogZ2V0X3Byb2dyZXNzLFxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFdvcmxkQ29udHJvbGxlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIldvcmxkQ29udHJvbGxlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuREVGQVVMVFxyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJ2YXIgR2FtZVV0aWxpdHkgPSAoZnVuY3Rpb24oKVxyXG57XHJcbiAgZnVuY3Rpb24gYXJyb3dfa2V5X3Njcm9sbGluZyhmbGFnKSB7XHJcbiAgICAvLyBDb25maWd1cmVzIGFycm93IGtleSBzY3JvbGxpbmcgZm9yIGNhbnZhc1xyXG4gICAgaWYgKGZsYWcgPT0gZmFsc2UpIHtcclxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChlKSB7IC8vIC5nZXRFbGVtZW50QnlJZChcImRpc3BsYXlfY2FudmFzXCIpXHJcbiAgICAgICAgYXJyb3dzID0gWzM3LCAzOCwgMzksIDQwXTtcclxuICAgICAgICBpZiAoYXJyb3dzLmluZGV4T2YoZS5rZXlDb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcblx0dmFyIGxnID0gZnVuY3Rpb24oKVxyXG5cdHtcclxuXHRcdC8qXHJcblx0XHQgKiBzaG9ydGN1dCB0byBjb25zb2xlLmxvZygpXHJcblx0XHQgKiBwcmludHMgYWxsIGFyZ3VtZW50cyB0byBjb25zb2xlXHJcblx0XHQgKiBmaXJzdCBhcmd1bWVudCBpcyB1c2VkIGFzIGEgbGFiZWwgZm9yIHRoZSByZXN0XHJcblx0XHQgKlxyXG5cdFx0ICogZWFjaCBsYWJlbGVkIGdyb3VwIGlzIGVuY2xvc2VkIGludG8gdGhlIGNvbG9yZWQgZGVsaW1pdGVyc1xyXG5cdFx0ICogPj4+IGFuZCA8PDwgc28gaXQncyBlYXNpbHkgZGlzdGluZ3Vpc2hlZC4gSSBmb3VuZCBpdCBoZWxwZnVsLFxyXG5cdFx0ICogaWYgeW91IGRvbid0IGxldCBtZSBrbm93LCBvciB1c2Ugc29tZXRoaW5nIGVsc2VcclxuXHRcdCAqL1xyXG5cdFx0Y29uc29sZS5sb2coXCIlcyAlYyAlc1wiLCBhcmd1bWVudHNbMF0sIFwiYmFja2dyb3VuZDogI0RBRjJCMVwiLCBcIj4+PlwiKTtcclxuXHRcdFxyXG5cdFx0Zm9yKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuXHRcdHtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJcXHRcIiwgYXJndW1lbnRzW2ldKTtcclxuXHRcdH1cclxuXHRcdGNvbnNvbGUubG9nKFwiJWM8PDxcIiwgXCJiYWNrZ3JvdW5kOiAjREFGMkIxXCIpO1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgcmFuZG9tX2Nob2ljZSA9IGZ1bmN0aW9uKHByb2JhYmlsaXRpZXMsIGNob2ljZXMpe1xyXG5cdFx0LypcclxuXHRcdCAgIHRha2VzIDIgYXJyYXlzIHdpdGggZWxlbWVudHMgYXQgY29ycmVzcG9uZGluZyBpbmRleGVzXHJcblx0XHQgICBiZWluZyBjaG9pY2UgYW5kIGl0J3MgcHJvYmFiaWxpdHkuIHBpY2tzIHJhbmRvbSBvbmUuXHJcblx0XHQgICBjaG9pY2VzIGFyZSBhbnl0aGluZywgcHJvYmFiaWxpdHkgaXMgaW50ZWdlciBhLCBzdWNoIHRoYXRcclxuXHRcdCAgIHByb2JhYmlsaXR5IG9mIGEgY2hvaWNlIGlzIGEvMTAuIHdpdGggYSA8IDEwLCBvZiBjb3Vyc2VcclxuXHRcdCAgIGFuZCBwcm9iYWJpbGl0aWVzIGFkZGluZyB1cCB0byAxMC4gXHJcblx0XHQgICBZZXMsIGl0J3Mgbm90IHZlcnkgZ29vZCBpbXBsZW1lbnRhdGlvbiAocmVhZDogdGVycmlibGUpLCBcclxuXHRcdCAgIGFuZCBzaW5jZSB5b3Ugbm90aWNlZCwgbm93IGl0J3MgeW91ciBqb2IgdG8gaW1wcm92ZSBpdC5cclxuXHJcblx0XHQqL1xyXG5cclxuXHRcdC8vIGFycmF5IHdpdGggY2hvaWNlcyBkdXBsaWNhdGVkIGEgcHJvcGVyIGFtb3VudCBvZiB0aW1lcyBiYXNlZCBvblxyXG5cdFx0Ly8gdGhlaXIgcHJvYmFiaWxpdHlcclxuXHRcdHZhciBibGFoID0gW107IFxyXG5cclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBjaG9pY2VzLmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IHByb2JhYmlsaXRpZXNbaV07IGorKyl7XHJcblx0XHRcdFx0YmxhaC5wdXNoKGNob2ljZXNbaV0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIHJhbmRfaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBibGFoLmxlbmd0aCk7XHJcblxyXG5cdFx0cmV0dXJuIGJsYWhbcmFuZF9pbmRleF07XHJcblx0fTtcclxuXHJcblx0XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRsZzogbGcsXHJcblx0XHRyYW5kb21fY2hvaWNlOiByYW5kb21fY2hvaWNlXHJcblx0fTtcclxuXHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVVdGlsaXR5O1xyXG4iLCJ2YXIgSW5jbHVkZSA9IGZ1bmN0aW9uKCl7XHJcblxyXG5cdHZhciBtb2R1bGVzO1xyXG5cclxuXHQvLyBzaW1wbGUgZW51bWVyYXRvciAvLyBvcHRpb24gY29kZXMgTVVTVCBiZSBwb3dlciBvZiAyIG9yIHN1bSBvZiBvdGhlciBvcHRpb25zICh3aXRoIDAgYmVpbmcgdGhlIG9ubHkgZXhjZXB0aW9uKSwgYW5kIHVuaXF1ZVxyXG5cdHZhciBjaG9pY2VzID0gKGZ1bmN0aW9uKCl7XHJcblx0XHQvLyBzaW1wbGUgb3B0aW9uczogbnVtYmVyaWMgdmFsdWUgbXVzdCBiZSAwIG9yIHNvbWUgcG93ZXIgb2YgMiwgbmFtZSBzaG91bGQgYmUgYWxsIGNhcHMgYW5kIHVuaXF1ZVxyXG5cdFx0dmFyIHJlc3VsdCA9IHtOT05FOiAwLCBBTExfQ09OVFJPTExFUlM6IDEsIEFMTF9NT0RFTFM6IDIsIE9XTl9NT0RFTDogNCwgT1RIRVJfU1RVRkY6IDgsIFJFTkRFUkVSUzogMTYsIExPR0lDOiAzMn07XHJcblxyXG5cdFx0Ly8gY29tcGxleCBvcHRpb25zOiBzaG91bGQgY29uc2lzdCBvZiBzaW1wbGUgb3B0aW9ucywgYml0d2lzZSghKSBPUidlZCBvciBBTkQnZWQgdG9nZXRoZXIgaW4gYW55IGZhc2hpb25cclxuXHRcdHJlc3VsdC5ERUZBVUxUID0gKHJlc3VsdC5BTExfQ09OVFJPTExFUlMgfCByZXN1bHQuT1dOX01PREVMIHwgcmVzdWx0Lk9USEVSX1NUVUZGKTtcclxuXHRcdHJlc3VsdC5BTEwgPSAgKHJlc3VsdC5BTExfQ09OVFJPTExFUlMgfCByZXN1bHQuQUxMX01PREVMUyB8IHJlc3VsdC5PVEhFUl9TVFVGRik7IFxyXG5cdFx0cmVzdWx0LlJFTkRFUkVSX1NQRUNJRklDID0gKHJlc3VsdC5BTExfQ09OVFJPTExFUlMgfCByZXN1bHQuT1RIRVJfU1RVRkYpO1xyXG5cdFx0cmVzdWx0LkxPR0lDX1NQRUNJRklDID0gKHJlc3VsdC5BTExfQ09OVFJPTExFUlMgfCByZXN1bHQuT1RIRVJfU1RVRkYpO1xyXG5cclxuXHRcdC8vIG9iamVjdCBpcyBpbW11dGFibGVcclxuXHRcdHJldHVybiBPYmplY3QuZnJlZXplKHJlc3VsdCk7XHJcblx0fSkoKTtcclxuXHJcblx0dmFyIG1vZHVsZV9uYW1lcyA9IHtcclxuXHRcdENvbnRyb2xsZXJzOiBbXHJcblx0XHRcdFwiQXNzZXRDb250cm9sbGVyXCIsXHJcblx0XHRcdFwiRW50aXR5Q29udHJvbGxlclwiLFxyXG5cdFx0XHRcIkdhbWVDb250cm9sbGVyXCIsXHJcblx0XHRcdFwiR3JhcGhpY3NDb250cm9sbGVyXCIsXHJcblx0XHRcdFwiSW5pdENvbnRyb2xsZXJcIixcclxuXHRcdFx0XCJLZXlib2FyZENvbnRyb2xsZXJcIixcclxuXHRcdFx0XCJQaHlzaWNzQ29udHJvbGxlclwiLFxyXG5cdFx0XHRcIlRlcnJhaW5Db250cm9sbGVyXCIsXHJcblx0XHRcdFwiVGVycmFpblNsaWNlQ29udHJvbGxlclwiLFxyXG5cdFx0XHRcIlRlc3RDb250cm9sbGVyXCIsXHJcblx0XHRcdFwiV29ybGRDb250cm9sbGVyXCIsXHJcblx0XHRcdFwiSWRlbnRpZmljYXRpb25Db250cm9sbGVyXCIsXHJcblx0XHRcdFwiUmVnaXN0ZXJBc0NvbnRyb2xsZXJcIixcclxuXHRcdFx0XCJIVURDb250cm9sbGVyXCIsXHJcblx0XHRdLFxyXG5cclxuXHRcdE1vZGVsczogW1xyXG5cdFx0XHJcblx0XHRcdFwiQXNzZXRNb2RlbFwiLFxyXG5cdFx0XHRcIkdhbWVNb2RlbFwiLFxyXG5cdFx0XHRcIkdyYXBoaWNzTW9kZWxcIixcclxuXHRcdFx0XCJLZXlib2FyZE1vZGVsXCIsXHJcblx0XHRcdFwiUGh5c2ljc01vZGVsXCIsXHJcblx0XHRcdFwiVGVycmFpbk1vZGVsXCIsXHJcblx0XHRcdFwiVGVycmFpblNsaWNlTW9kZWxcIixcclxuXHRcdFx0XCJUZXN0TW9kZWxcIixcclxuXHRcdFx0XCJXb3JsZE1vZGVsXCIsXHJcblx0XHRcdFwiRW50aXR5TW9kZWxcIixcclxuXHRcdFx0XCJSZWdpc3RlckFzTW9kZWxcIixcclxuXHRcdFx0XCJIVURNb2RlbFwiLFxyXG5cdFx0XSxcclxuXHJcblx0XHRPdGhlcjogW1xyXG5cdFx0XHJcblx0XHRcdFwiQjJkXCIsXHJcblx0XHRcdFwiQm94MkRcIixcclxuXHRcdFx0XCJDb25maWdcIixcclxuXHRcdFx0XCJHYW1lVXRpbGl0eVwiLFxyXG5cdFx0XSxcclxuXHJcblx0XHRSZW5kZXJlcnM6IFtcclxuXHRcdFx0XCJBbnRSZW5kZXJlclwiLFxyXG5cdFx0XHRcIkhlcm9SZW5kZXJlclwiLFxyXG5cdFx0XHRcIlRlcnJhaW5DZWxsUmVuZGVyZXJcIixcclxuXHRcdFx0XCJHcmlmZmluUmVuZGVyZXJcIixcclxuXHRcdFx0XCJIeWVuYVJlbmRlcmVyXCIsXHJcblx0XHRcdFwiVGVycmFpblNsaWNlUmVuZGVyZXJcIixcclxuXHRcdFx0XCJCYWNrZ3JvdW5kUmVuZGVyZXJcIixcclxuXHJcblx0XHRdLFxyXG5cclxuXHRcdExvZ2ljOiBbXHJcblx0XHRcdFwiQW50TG9naWNcIixcclxuXHRcdFx0XCJIZXJvTG9naWNcIixcclxuXHRcdFx0XCJHcmlmZmluTG9naWNcIixcclxuXHRcdFx0XCJIeWVuYUxvZ2ljXCIsXHJcblx0XHRdLFxyXG5cclxuXHR9Oy8vZW5kIG1vZHVsZV9uYW1lc1xyXG5cclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cclxuXHRcdG1vZHVsZXMgPSB7XHJcblx0XHRcdEFzc2V0Q29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvQXNzZXRDb250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRHcmFwaGljc0NvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL0dyYXBoaWNzQ29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0S2V5Ym9hcmRDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9LZXlib2FyZENvbnRyb2xsZXIuanNcIiksXHJcblx0XHRcdFBoeXNpY3NDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9QaHlzaWNzQ29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0VGVycmFpbkNvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL1RlcnJhaW5Db250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRUZXJyYWluU2xpY2VDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9UZXJyYWluU2xpY2VDb250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRXb3JsZENvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL1dvcmxkQ29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0SW5pdENvbnRyb2xsZXI6IHJlcXVpcmUoXCIuL0NvbnRyb2xsZXJzL0luaXRDb250cm9sbGVyLmpzXCIpLFxyXG5cdFx0XHRUZXN0Q29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvVGVzdENvbnRyb2xsZXIuanNcIiksXHJcblx0XHRcdEdhbWVDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9HYW1lQ29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0RW50aXR5Q29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvRW50aXR5Q29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9JZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuanNcIiksXHJcblx0XHRcdFJlZ2lzdGVyQXNDb250cm9sbGVyOiByZXF1aXJlKFwiLi9Db250cm9sbGVycy9SZWdpc3RlckFzQ29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0SFVEQ29udHJvbGxlcjogcmVxdWlyZShcIi4vQ29udHJvbGxlcnMvSFVEQ29udHJvbGxlci5qc1wiKSxcclxuXHRcdFx0XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBNb2RlbHNcclxuXHJcblx0XHRcdEdhbWVNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0dhbWVNb2RlbC5qc1wiKSxcclxuXHRcdFx0VGVycmFpblNsaWNlTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9UZXJyYWluU2xpY2VNb2RlbC5qc1wiKSxcclxuXHRcdFx0QXNzZXRNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0Fzc2V0TW9kZWwuanNcIiksXHJcblx0XHRcdFBoeXNpY3NNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL1BoeXNpY3NNb2RlbC5qc1wiKSxcclxuXHRcdFx0R3JhcGhpY3NNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0dyYXBoaWNzTW9kZWwuanNcIiksXHJcblx0XHRcdFRlcnJhaW5Nb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL1RlcnJhaW5Nb2RlbC5qc1wiKSxcclxuXHRcdFx0V29ybGRNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL1dvcmxkTW9kZWwuanNcIiksXHJcblx0XHRcdEtleWJvYXJkTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9LZXlib2FyZE1vZGVsLmpzXCIpLFxyXG5cdFx0XHRUZXN0TW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9UZXN0TW9kZWwuanNcIiksXHJcblx0XHRcdElkZW50aWZpY2F0aW9uTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9JZGVudGlmaWNhdGlvbk1vZGVsLmpzXCIpLFxyXG5cdFx0XHRFbnRpdHlNb2RlbDogcmVxdWlyZShcIi4vTW9kZWxzL0VudGl0eU1vZGVsLmpzXCIpLFxyXG5cdFx0XHRSZWdpc3RlckFzTW9kZWw6IHJlcXVpcmUoXCIuL01vZGVscy9SZWdpc3RlckFzTW9kZWwuanNcIiksXHJcblx0XHRcdEhVRE1vZGVsOiByZXF1aXJlKFwiLi9Nb2RlbHMvSFVETW9kZWwuanNcIiksXHJcblx0XHRcdFxyXG5cdFx0XHRcdFxyXG5cdFx0XHQvLyBPdGhlciBzdHVmZlxyXG5cdFx0XHRcclxuXHRcdFx0Q29uZmlnOiByZXF1aXJlKFwiLi9Db25maWcuanNcIiksXHJcblx0XHRcdEdhbWVVdGlsaXR5OiByZXF1aXJlKFwiLi9HYW1lVXRpbGl0eS5qc1wiKSxcclxuXHRcdFx0QjJkOiByZXF1aXJlKFwiLi9CMmQuanNcIiksXHJcblx0XHRcdEJveDJEOiByZXF1aXJlKFwiYm94MmR3ZWJcIiksXHJcblx0XHRcdFxyXG5cdFx0XHQvLyBSZW5kZXJlcnNcclxuXHRcdFx0XHJcblx0XHRcdEFudFJlbmRlcmVyOiByZXF1aXJlKFwiLi9SZW5kZXJlcnMvQW50UmVuZGVyZXIuanNcIiksXHJcblx0XHRcdEdyaWZmaW5SZW5kZXJlcjogcmVxdWlyZShcIi4vUmVuZGVyZXJzL0dyaWZmaW5SZW5kZXJlci5qc1wiKSxcclxuXHRcdFx0SHllbmFSZW5kZXJlcjogcmVxdWlyZShcIi4vUmVuZGVyZXJzL0h5ZW5hUmVuZGVyZXIuanNcIiksXHJcblx0XHRcdEhlcm9SZW5kZXJlcjogcmVxdWlyZShcIi4vUmVuZGVyZXJzL0hlcm9SZW5kZXJlci5qc1wiKSxcclxuXHRcdFx0VGVycmFpbkNlbGxSZW5kZXJlcjogcmVxdWlyZShcIi4vUmVuZGVyZXJzL1RlcnJhaW5DZWxsUmVuZGVyZXIuanNcIiksXHJcblx0XHRcdFRlcnJhaW5TbGljZVJlbmRlcmVyOiByZXF1aXJlKFwiLi9SZW5kZXJlcnMvVGVycmFpblNsaWNlUmVuZGVyZXIuanNcIiksXHJcblx0XHRcdEJhY2tncm91bmRSZW5kZXJlcjogcmVxdWlyZShcIi4vUmVuZGVyZXJzL0JhY2tncm91bmRSZW5kZXJlci5qc1wiKSxcclxuXHRcdFx0XHJcblx0XHRcdFxyXG5cdFx0XHRcclxuXHRcdFx0XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBMb2dpY1xyXG5cdFx0XHRBbnRMb2dpYzogcmVxdWlyZShcIi4vTG9naWMvQW50TG9naWMuanNcIiksXHJcblx0XHRcdEdyaWZmaW5Mb2dpYzogcmVxdWlyZShcIi4vTG9naWMvR3JpZmZpbkxvZ2ljLmpzXCIpLFxyXG5cdFx0XHRIeWVuYUxvZ2ljOiByZXF1aXJlKFwiLi9Mb2dpYy9IeWVuYUxvZ2ljLmpzXCIpLFxyXG5cdFx0XHRIZXJvTG9naWM6IHJlcXVpcmUoXCIuL0xvZ2ljL0hlcm9Mb2dpYy5qc1wiKSxcclxuXHRcdFx0XHJcblx0XHRcdFxyXG5cclxuXHRcdH07XHJcblxyXG5cdH07IC8vIGVuZCBpbml0XHJcblxyXG5cdHZhciBvcHRpb25faXNfc2V0ID0gZnVuY3Rpb24od2hhdF9tb2RzX3NlbGVjdGVkLCBvcHRpb25zKXtcclxuXHRcdGlmKHdoYXRfbW9kc19zZWxlY3RlZCA9PSAwICYmIG9wdGlvbnMgPT0gMCl7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0Ly8gYmUgbWluZGZ1bCBvZiBiaXR3aXNlIG9wZXJhdG9yIGFoZWFkXHJcblx0XHRyZXR1cm4gKHdoYXRfbW9kc19zZWxlY3RlZCAmIG9wdGlvbnMpO1xyXG5cdH07Ly9lbmQgb3B0aW9uX2lzX3NldFxyXG5cclxuXHR2YXIgZ2V0X21vZHVsZSA9IGZ1bmN0aW9uKG5hbWUpe1xyXG5cdFx0Ly8gY2FuIGJlIG1vZGlmaWVkIHRvIHRocm93IG9iamVjdCBlcnJvciBpbnN0ZWFkIG9mIHNpbXBsZSBvbmVcclxuXHRcdC8vIGluIHRoYXQgY2FzZSBpdCBtYXkgY29udGFpbiBsaXN0IG9mIGRlZmluZWQgbW9kdWxlc1xyXG5cdFx0Ly8gbWF5IGFsc28gYmUgbW9kaWZpZWQgdG8gY2hlY2sgd2hldGhlciBtb2R1bGUgaXMgbWlzc2luZyBmcm9tIFxyXG5cdFx0Ly8gbW9kdWxlX25hbWVzLCBtb2R1bGVzLCBvciBib3RoLCBhbmQgZ2l2ZSBtb3JlIGFjY3VyYXRlIGRlc2NyaXB0aW9uXHJcblx0XHR2YXIgbWVzc2FnZSA9IFwiTW9kdWxlIFwiICsgbmFtZSArIFxyXG5cdFx0XHRcIiBpcyB1bmRlZmluZWQuIE5vdGUgdGhhdCB5b3UgbXVzdCBoYXJkY29kZSBhbGwgbmV3IG1vZHVsZXNcIiArIFxyXG5cdFx0XHRcIiBpbnRvIHRoZSBJbmNsdWRlcy5tb2R1bGVfbmFtZXMgQU5EIEluY2x1ZGVzLm1vZHVsZXMuXCJcclxuXHRcdFxyXG5cdFx0aWYobW9kdWxlcyl7XHJcblx0XHRcdGlmKG1vZHVsZXNbbmFtZV0pe1xyXG5cdFx0XHRcdHJldHVybiBtb2R1bGVzW25hbWVdO1xyXG5cdFx0XHR9ZWxzZSBpZihjb25zb2xlLndhcm4peyAvLyBjaGVjayBpZiBjb25zb2xlLndhcm4gaXMgYXZhaWxhYmxlXHJcblx0XHRcdFx0Y29uc29sZS53YXJuKG1lc3NhZ2UpO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHR0aHJvdyBtZXNzYWdlO1xyXG5cdFx0XHR9XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0dGhyb3cgXCJFcnJvcjogWW91IG11c3QgcnVuIHRoZSBJbmNsdWRlcy5pbml0KCkgYmVmb3JlIHlvdSBjYW4gdXNlIGFueSBtb2R1bGVzXCI7XHJcblx0XHR9XHJcblx0fTsvL2VuZCBnZXRfbW9kdWxlXHJcblx0XHJcblxyXG5cdHZhciBnZXRfbmFtZXMgPSBmdW5jdGlvbihjdXJyZW50X21vZHVsZV9uYW1lLCBvcHRpb25zX2NvZGUpe1xyXG5cdFx0dmFyIHJlc3VsdCA9IHtNb2RlbHM6IFtdLCBDb250cm9sbGVyczogW10sIE90aGVyOiBbXSwgUmVuZGVyZXJzOiBbXSwgTG9naWM6IFtdLH07XHJcblxyXG5cdFx0aWYob3B0aW9uX2lzX3NldChjaG9pY2VzLk5PTkUsIG9wdGlvbnNfY29kZSkpe1xyXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChvcHRpb25faXNfc2V0KGNob2ljZXMuQUxMX0NPTlRST0xMRVJTLCBvcHRpb25zX2NvZGUpKXtcclxuXHJcblx0XHRcdHZhciBjb250cm9sbGVyX25hbWVzID0gbW9kdWxlX25hbWVzLkNvbnRyb2xsZXJzO1xyXG5cclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGNvbnRyb2xsZXJfbmFtZXMubGVuZ3RoOyBpKyspe1xyXG5cclxuXHRcdFx0XHR2YXIgY3RsX25hbWUgPSBjb250cm9sbGVyX25hbWVzW2ldO1xyXG5cclxuXHRcdFx0XHRpZihjdGxfbmFtZSAhPSBjdXJyZW50X21vZHVsZV9uYW1lKXtcclxuXHRcdFx0XHRcdHJlc3VsdC5Db250cm9sbGVycy5wdXNoKGN0bF9uYW1lKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5BTExfTU9ERUxTLCBvcHRpb25zX2NvZGUpKXtcclxuXHRcdFx0cmVzdWx0Lk1vZGVscyA9IG1vZHVsZV9uYW1lcy5Nb2RlbHM7XHJcblx0XHR9ZWxzZSBpZihvcHRpb25faXNfc2V0KGNob2ljZXMuT1dOX01PREVMLCBvcHRpb25zX2NvZGUpKXtcclxuXHRcdFx0dmFyIG93bl9tb2RlbCA9IGN1cnJlbnRfbW9kdWxlX25hbWUucmVwbGFjZShcIkNvbnRyb2xsZXJcIiwgXCJNb2RlbFwiKTtcclxuXHRcdFx0cmVzdWx0Lk1vZGVscy5wdXNoKG93bl9tb2RlbCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYob3B0aW9uX2lzX3NldChjaG9pY2VzLk9USEVSX1NUVUZGLCBvcHRpb25zX2NvZGUpKXtcclxuXHRcdFx0cmVzdWx0Lk90aGVyID0gbW9kdWxlX25hbWVzLk90aGVyO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5SRU5ERVJFUlMsIG9wdGlvbnNfY29kZSkpe1xyXG5cdFx0XHRyZXN1bHQuUmVuZGVyZXJzID0gbW9kdWxlX25hbWVzLlJlbmRlcmVycztcclxuXHRcdH1cclxuXHJcblx0XHRpZihvcHRpb25faXNfc2V0KGNob2ljZXMuTE9HSUMsIG9wdGlvbnNfY29kZSkpe1xyXG5cdFx0XHRyZXN1bHQuTG9naWMgPSBtb2R1bGVfbmFtZXMuTG9naWM7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9Oy8vZW5kIGdldF9uYW1lc1xyXG5cclxuXHR2YXIgc2VjdGlvbnMgPSBbXCJNb2RlbHNcIiwgXCJDb250cm9sbGVyc1wiLCBcIk90aGVyXCIsIFwiUmVuZGVyZXJzXCIsIFwiTG9naWNcIl07XHJcblx0dmFyIGdldF9uYW1lX3N0YXRlbWVudHMgPSBmdW5jdGlvbihuYW1lcyl7XHJcblx0XHR2YXIgcmVzdWx0ID0gXCJcIjtcclxuXHRcdGZvcih2YXIgc2VjdGlvbl9pbmRleCA9IDA7IHNlY3Rpb25faW5kZXggPCBzZWN0aW9ucy5sZW5ndGg7IHNlY3Rpb25faW5kZXgrKyl7XHJcblx0XHRcdHZhciBzZWN0aW9uID0gc2VjdGlvbnNbc2VjdGlvbl9pbmRleF07XHJcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBuYW1lc1tzZWN0aW9uXS5sZW5ndGg7IGkrKyl7XHJcblx0XHRcdFx0cmVzdWx0ICs9IChcInZhciBcIiArIG5hbWVzW3NlY3Rpb25dW2ldICsgXCI7IFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiByZXN1bHQ7XHJcblx0XHRcclxuXHR9Oy8vZW5kIGdldF9uYW1lX3N0YXRlbWVudHNcclxuXHJcblx0dmFyIGdldF9tb2R1bGVfc3RhdGVtZW50cyA9IGZ1bmN0aW9uKG5hbWVzKXtcclxuXHRcdHZhciByZXN1bHQgPSBcIlwiO1xyXG5cdFx0Zm9yKHZhciBzZWN0aW9uX2luZGV4ID0gMDsgc2VjdGlvbl9pbmRleCA8IHNlY3Rpb25zLmxlbmd0aDsgc2VjdGlvbl9pbmRleCsrKXtcclxuXHRcdFx0dmFyIHNlY3Rpb24gPSBzZWN0aW9uc1tzZWN0aW9uX2luZGV4XTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IG5hbWVzW3NlY3Rpb25dLmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0XHRyZXN1bHQgKz0gKG5hbWVzW3NlY3Rpb25dW2ldICsgXCIgPSBJbmNsdWRlcy5nZXRfbW9kdWxlKFxcXCJcIiArIG5hbWVzW3NlY3Rpb25dW2ldICsgXCJcXFwiKTsgXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9Oy8vZW5kIGdldF9tb2R1bGVfc3RhdGVtZW50c1xyXG5cclxuXHR2YXIgZ2V0X2luY2x1ZGVfZGF0YSA9IGZ1bmN0aW9uKHBhcmFtcyl7XHJcblx0XHR2YXIgY3VycmVudF9tb2R1bGUgPSBwYXJhbXMuY3VycmVudF9tb2R1bGU7XHJcblx0XHR2YXIgaW5jbHVkZV9vcHRpb25zID0gcGFyYW1zLmluY2x1ZGVfb3B0aW9ucztcclxuXHRcdHZhciBuYW1lcyA9IGdldF9uYW1lcyhjdXJyZW50X21vZHVsZSwgaW5jbHVkZV9vcHRpb25zKTtcclxuXHJcblx0XHR2YXIgbmFtZV9zdGF0ZW1lbnRzID0gZ2V0X25hbWVfc3RhdGVtZW50cyhuYW1lcyk7XHJcblx0XHR2YXIgbW9kdWxlX3N0YXRlbWVudHMgPSBnZXRfbW9kdWxlX3N0YXRlbWVudHMobmFtZXMpO1xyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGltcG9ydGVkX21vZHVsZXM6IG5hbWVzLFxyXG5cdFx0XHRuYW1lX3N0YXRlbWVudHM6IG5hbWVfc3RhdGVtZW50cyxcclxuXHRcdFx0bW9kdWxlX3N0YXRlbWVudHM6IG1vZHVsZV9zdGF0ZW1lbnRzLFxyXG5cdFx0fTtcclxuXHJcblx0fTsvL2VuZCBnZXRfaW5jbHVkZV9kYXRhXHJcblxyXG5cdHZhciBhdXRvbWF0ZWRfdGVzdHMgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHJcblx0XHRRVW5pdC50ZXN0KFwib3B0aW9uIG1hdGNoaW5nIGZ1bmN0aW9uXCIsIGZ1bmN0aW9uKCBhc3NlcnQpIHtcclxuXHJcblx0XHRcdC8vSWYgYm90aCBhcmUgbm9uZVxyXG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLk5PTkUsIGNob2ljZXMuTk9ORSksIHRydWUpO1xyXG5cclxuXHRcdFx0YXNzZXJ0LnRocm93cyhvcHRpb25faXNfc2V0KGNob2ljZXMuTk9ORSwgLTEpKTtcclxuXHJcblx0XHRcdC8vSWYgYm90aCBtYXRjaCwgaXQgcmV0dXJucyB0aGUgdmFsdWUgb2YgY2hvaWNlc1xyXG5cdFx0XHQvL0lmIHRoZXkgZG9uJ3QgbWF0Y2gsIGl0IHJldHVybnMgMFxyXG5cdFx0XHRcclxuXHRcdFx0Ly9NQVRDSFxyXG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLkFMTF9DT05UUk9MTEVSUywgY2hvaWNlcy5BTExfQ09OVFJPTExFUlMpLCAxKTtcclxuXHRcdFx0YXNzZXJ0LmVxdWFsKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5BTExfTU9ERUxTLCBjaG9pY2VzLkFMTF9NT0RFTFMpLCAyKTtcclxuXHRcdFx0YXNzZXJ0LmVxdWFsKG9wdGlvbl9pc19zZXQoY2hvaWNlcy5PVEhFUl9TVFVGRiwgY2hvaWNlcy5PVEhFUl9TVFVGRiksIDgpO1xyXG5cclxuXHRcdFx0Ly9NaXNtYXRjaFxyXG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLk5PTkUsIGNob2ljZXMuQUxMX0NPTlRST0xMRVJTKSwgMCk7XHJcblx0XHRcdGFzc2VydC5lcXVhbChvcHRpb25faXNfc2V0KGNob2ljZXMuT1RIRVJfU1RVRkYsIGNob2ljZXMuTk9ORSksIDApO1xyXG5cdFx0XHRhc3NlcnQuZXF1YWwob3B0aW9uX2lzX3NldChjaG9pY2VzLkFMTF9NT0RFTFMsIGNob2ljZXMuQUxMX0NPTlRST0xMRVJTKSwgMCk7XHJcblx0XHRcdGFzc2VydC5lcXVhbChvcHRpb25faXNfc2V0KGNob2ljZXMuT1dOX01PREVMLCBjaG9pY2VzLkFMTF9NT0RFTFMpLCAwKTtcclxuXHRcdH0pOy8vZW5kIG9wdGlvbiBtYXRjaGluZyB0ZXN0XHJcblx0XHRcclxuXHR9Oy8vZW5kIGF1dG9tYXRlZF90ZXN0c1xyXG5cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGluaXQ6IGluaXQsXHJcblx0XHRtb2R1bGVfbmFtZXM6IG1vZHVsZV9uYW1lcyxcclxuXHRcdGdldF9tb2R1bGU6IGdldF9tb2R1bGUsXHJcblx0XHRnZXRfaW5jbHVkZV9kYXRhOiBnZXRfaW5jbHVkZV9kYXRhLFxyXG5cdFx0Y2hvaWNlczogY2hvaWNlcyxcclxuXHRcdGF1dG9tYXRlZF90ZXN0czogYXV0b21hdGVkX3Rlc3RzXHJcblx0fTtcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBJbmNsdWRlO1xyXG5cclxuIiwidmFyIEFudExvZ2ljID0gKGZ1bmN0aW9uKCl7XHJcblxyXG5cdHZhciBBbnQgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogV2lsbCBiZSBpbnN0YW50aWF0ZWQgZm9yIGV2ZXJ5IGNyZWF0ZWQgZW50aXR5IHRvIGhvbGQgYWxsIHRoZSBpbmZvcm1hdGlvbiBcclxuXHRcdFx0YWJvdXQgdGhlIHBoeXNpY2FsIChub3QgZ3JhcGhpY2FsKSBzdGF0ZSBvZiB0aGUgZW50aXR5IGluIHF1ZXN0aW9uLiBcclxuXHRcdFx0ZGVjbGFyZSB0aGUgcHJvcGVydGllcyBsaWtlIHRoaXM6XHJcblx0XHRcdHRoaXMuc29tZV9zdGF0ZV92YXJpYWJsZV9pbml0aWFsX3ZhbHVlID0gMDtcclxuXHRcdFx0aW5zdGFudGlhdGUgKG1vc3QgbGlrZWx5IGluIHRoZSBzcGF3biBmdW5jdGlvbikgbGlrZSB0aGF0OlxyXG5cdFx0XHR2YXIgbmV3X2VudGl0eV9pbnN0YW5jZSA9IG5ldyBBbnQoKTtcclxuXHRcdCovXHJcblx0XHJcblxyXG5cdFx0dmFyIGVudGl0eSA9IEVudGl0eUNvbnRyb2xsZXIuY3JlYXRlX2Fic3RyYWN0X2VudGl0eSgpO1xyXG5cdFx0XHJcblx0XHRlbnRpdHkuaGVyb19odXJ0X21lID0gZmFsc2U7XHJcblx0XHRlbnRpdHkubWVfaHVydF9oZXJvID0gZmFsc2U7XHJcblx0XHRlbnRpdHkuZGVhdGhfdGljayA9IDA7XHJcblx0XHRlbnRpdHkuaHAgPSAzO1xyXG5cdFx0ZW50aXR5LnNwZWVkID0gMztcclxuXHRcdGVudGl0eS5kYW1hZ2UgPSAxO1xyXG5cdFx0ZW50aXR5LnBvaW50X3ZhbHVlID0gNTA7XHJcblx0XHRlbnRpdHkuY2FuX2F0dGFjayA9IHRydWU7XHJcblx0XHRlbnRpdHkuYWxpdmVmbGFnID0gdHJ1ZTtcclxuXHRcdGVudGl0eS51bmh1cnRmbGFnID0gdHJ1ZTtcclxuXHRcdGVudGl0eS5zdGFydF93YWxraW5nID0gdHJ1ZTtcclxuXHRcdGVudGl0eS5wb3AgPSA0MDtcclxuXHRcdGVudGl0eS5wb3B1cCA9IDA7XHJcblx0XHRlbnRpdHkuYW5pbWF0aW9uID0gXCJ3YWxrXCI7XHJcblx0XHRlbnRpdHkuZGVjYXlfZHVyYXRpb24gPSAwO1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gZW50aXR5O1xyXG5cdFx0XHJcblx0XHQvKlxyXG5cdFx0dGhpcy5oZXJvX2h1cnRfbWUgPSBmYWxzZTtcclxuXHRcdHRoaXMubWVfaHVydF9oZXJvID0gZmFsc2U7XHJcblx0XHR0aGlzLmRlYXRoX3RpY2sgPSAwO1xyXG5cclxuXHRcdC8vc2V0IHlvdXIgZ2FtZSBsb2dpYyBwYXJhbWV0ZXJzIGhlcmVcclxuXHRcdC8vdGhpcy5vYmplY3RfaWQgPSAxOyAvL2hhcmRjb2RlIGEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIGVhY2ggbmV3IGVuZW15IGNsYXNzXHJcblx0XHR0aGlzLmhwID0gMztcclxuXHRcdHRoaXMuc3BlZWQgPSAzO1xyXG5cdFx0dGhpcy5kYW1hZ2UgPSAxO1xyXG5cdFx0dGhpcy5wb2ludF92YWx1ZSA9IDUwO1xyXG5cdFx0Ly90aGlzLmF0dGFja19jb29sZG93biA9IDQ7IC8vdXNlIHRoaXMgZm9yIGVuZW1pZXMgd2hvIG5lZWRcclxuXHRcdHRoaXMuY2FuX2F0dGFjayA9IHRydWU7Ly91c2UgdGhpcyBmb3IgZW5lbWllcyB3aG8gYWx0ZXJuYXRlIGJldHdlZW4gXHJcblx0XHQvL3RoaXMuY29vbGRvd25fdGltZXI9LTE7XHJcblx0XHR0aGlzLkFJX3N0YXRlID0gXCJ3YWxrXCI7Ly91c2UgdGhpcyB0byBrZWVwIHRyYWNrIG9mIHRoZSBlbmVteSdzIEFJIHN0YXRlXHJcblx0XHR0aGlzLmFsaXZlZmxhZyA9IHRydWU7XHJcblx0XHR0aGlzLnVuaHVydGZsYWcgPSB0cnVlO1xyXG5cdFx0dGhpcy5zdGFydF93YWxraW5nID0gdHJ1ZTtcclxuXHRcdHRoaXMucG9wID0gNDA7XHJcblx0XHR0aGlzLnBvcHVwID0gMDtcclxuXHRcdCovXHJcblx0fTtcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogSXMgcmFuIGZyb20gdGhlIEVudGl0eUNvbnRyb2xsZXIuaW5pdCBvbmNlIGR1cmluZyBnYW1lIGxvYWRpbmcgXHJcblx0XHQgXHR5b3Ugc2hvdWxkIGFzc2lnbiB0eXBlIHRvIHlvdXIgbW9kZWwgaGVyZSB1c2luZyB0aGUgaWRlbnRpZmljYXRpb24gY29udHJvbGxlclxyXG5cdFx0ICovXHJcblx0XHRpbmNsdWRlKCk7IC8vIHNhdGlzZnkgcmVxdWlyZW1lbnRzLCBHT0VTIEZJUlNUXHJcblx0XHRJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuYXNzaWduX3R5cGUoQW50LCBcImFudFwiKTtcclxuXHR9O1xyXG5cclxuXHR2YXIgc3Bhd24gPSBmdW5jdGlvbih4LCB5KXtcclxuXHRcdC8qIHNwYXduIGluc3RhbmNlIG9mIHRoaXMgZW50aXR5IGF0IHRoZSBnaXZlbiBjb29yZGluYXRlc1xyXG5cdFx0XHR5b3Ugd2lsbCBoYXZlIHRvIGNyZWF0ZSBuZXcgZW50aXR5IGluc3RhbmNlLCBhc3NpZ24gaXQgaWRcclxuXHRcdFx0dXNpbmcgdGhlIElkZW50aWZpY2F0aW9uQ29udHJvbGxlci5hc3NpZ25faWQoZW50aXR5X2luc3RhbmNlKSxcclxuXHRcdFx0YXNzaWduIGl0IGEgYm9keSB3aGljaCB5b3UgY2FuIGdldCB0aHJvdWdoIFBoeXNpY3NDb250cm9sbGVyXHJcblx0XHRcdGRvIGFueSBvdGhlciBzdHVmZiB5b3Ugd2FudCB0byBkbyBkdXJpbmcgc3Bhd25pbmcsXHJcblx0XHRcdGFuZCBmaW5hbGx5IHlvdSBIQVZFIFRPKCEhISkgcmV0dXJuIHRoZSBpbnN0YW5jZSB5b3UganVzdCBjcmVhdGVkIGZyb20gdGhpcyBmdW5jdGlvblxyXG5cdFx0Ki9cclxuXHJcblx0XHR2YXIgbmV3X2FudCA9IG5ldyBBbnQoKTtcclxuXHRcdG5ld19hbnQudHlwZSA9IFwiYW50XCI7XHJcblx0XHR2YXIgaWQgPSBJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuYXNzaWduX2lkKG5ld19hbnQpO1xyXG5cclxuXHRcdG5ld19hbnQuYm9keSA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7eDogeCwgeTogeSwgYm9yZGVyX3NlbnNvcnM6IHRydWV9LCBuZXdfYW50KTtcdFxyXG5cclxuXHRcdHJldHVybiBuZXdfYW50O1xyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgdGlja19BSSA9IGZ1bmN0aW9uKGFudCl7XHJcblx0XHQvKiBJcyByYW4gZWFjaCB0aWNrIGZyb20gdGhlIEVudGl0eUNvbnRyb2xsZXIudXBkYXRlIGZvciBldmVyeSByZWdpc3RlcmVkXHJcblx0XHRcdGVudGl0eSBvZiB0aGlzIHR5cGUuIEkgZ2l2ZW4gZW50aXR5X2luc3RhbmNlXHJcblx0XHQqL1xyXG5cclxuXHQgICAgLy9pZiBlbmVteSBpcyBkZWFkLCBkaWVcclxuXHRcdC8vaWYgKGFudC5ib2R5LkdldFdvcmxkQ2VudGVyKCkueSA+IDIyIHx8IGFudC5ib2R5LkdldFdvcmxkQ2VudGVyKCkueCA8IENvbmZpZy5QbGF5ZXIubW92ZW1lbnRfZWRnZSAtIDEpIHtcclxuXHRcdFx0Ly9FbnRpdHlDb250cm9sbGVyLmRlbGV0ZV9lbnRpdHkoKTtcclxuXHRcdFx0Ly9jb25zb2xlLmxvZyhcImRyb3Agb2YgZGVhdGhcIik7XHJcblx0XHQvL31cclxuXHRcdGlmIChhbnQuaHAgPT0gMSkge1xyXG5cdFx0XHRpZiAoYW50Lmhlcm9faHVydF9tZSl7XHJcblx0XHRcdFx0YW50LnRha2VfZGFtYWdlKCk7XHJcblx0XHRcdFx0YW50LmRpZSgpO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRhbnQucG9wdXArKztcclxuXHRcdFx0XHRpZihhbnQucG9wID09IGFudC5wb3B1cCAmJiBhbnQuYW5pbWF0aW9uID09IFwidXBzaWRlX2Rvd25cIilcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHQvL3ZhciBBbnRib2R5ID0gYW50LmJvZHk7XHJcblx0XHRcdFx0XHQvL0FudGJvZHkuQXBwbHlJbXB1bHNlKG5ldyBCMmQuYjJWZWMyKDEwLCAtMjApLCBBbnRib2R5LkdldFdvcmxkQ2VudGVyKCkpO1xyXG5cdFx0XHRcdFx0YW50Lmp1bXAoKTtcclxuXHRcdFx0XHRcdGFudC5wb3B1cCA9IDA7XHJcblx0XHRcdFx0XHRhbnQuY2FuX2F0dGFjayA9IHRydWU7XHJcblx0XHRcdFx0XHRhbnQudW5odXJ0ZmxhZyA9IHRydWU7XHJcblx0XHRcdFx0XHRhbnQuc3RhcnRfd2Fsa2luZyA9IHRydWU7XHJcblx0XHRcdFx0XHRhbnQuY2hhbmdlX2FuaW1hdGlvbihhbnQsIFwid2Fsa1wiKTtcclxuXHRcdFx0XHRcdGFudC5ocCsrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdH1lbHNlIGlmIChhbnQuaHAgPD0gMCkge1xyXG5cdFx0XHRhbnQuZGllKCk7XHJcblx0XHR9ZWxzZSB7IC8vIGFudC5ocCA+PSAxXHJcblx0XHRcdC8vZG8gbWFpbnRlbmFuY2VcclxuXHRcdFx0YW50LmRpcmVjdGlvbl9wcmV2aW91cyA9IGFudC5kaXJlY3Rpb247XHRcdFx0XHQvL3JlbWVtYmVyIHdoYXQgaHllbmEncyBkaXJlY3Rpb24gd2FzIGF0IHN0YXJ0IG9mIHRpY2tcclxuXHRcdFx0YW50LnhfcHJldmlvdXMgPSBhbnQuYm9keS5HZXRXb3JsZENlbnRlcigpLnhcclxuXHRcdFx0aWYgKGFudC5hbmltYXRpb24gPT0gXCJ3YWxrXCIpIHtcclxuXHRcdFx0XHQvL3ZhciBBbnRib2R5ID0gYW50LmJvZHk7XHJcblx0XHRcdFx0Ly9BbnRib2R5LkFwcGx5SW1wdWxzZShuZXcgQjJkLmIyVmVjMigtNSwwKSwgQW50Ym9keS5HZXRXb3JsZENlbnRlcigpKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZighYW50LnBhdGhfZnJlZSgpIHx8IGFudC54cHJldmlvdXMgPT0gYW50LmJvZHkuR2V0V29ybGRDZW50ZXIoKS54KXtcclxuXHRcdFx0XHRcdGFudC5kaXJlY3Rpb24gPSAhYW50LmRpcmVjdGlvbjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YW50Lm1vdmUoKTtcclxuXHRcdFx0XHQvL3ZhciB2ZWxvY2l0eSA9IEFudGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKTtcclxuXHRcdFx0XHQvL3ZlbG9jaXR5LnggPSAtYW50LnNwZWVkO1xyXG5cdFx0XHRcdC8vQW50Ym9keS5TZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eSk7IC8vIGJvZHkuU2V0TGluZWFyVmVsb2NpdHkobmV3IGIyVmVjMig1LCAwKSk7IHdvdWxkIHdvcmsgdG9vXHJcblx0XHRcdFx0Ly9BbnRib2R5LlNldEF3YWtlKHRydWUpO1xyXG5cdFx0XHRcdGFudC5zdGFydF93YWxraW5nID0gZmFsc2U7XHJcblx0XHRcdFx0YW50LnBvcHVwID0gMDtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0XHJcblx0XHRcdGlmIChhbnQuY2FuX2F0dGFjayAmJiBhbnQubWVfaHVydF9oZXJvICYmIGFudC5hbmltYXRpb24gPT0gXCJ3YWxrXCIpe1xyXG5cdFx0XHRcdC8vIHBhc3NcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoYW50Lmhlcm9faHVydF9tZSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGFudC50YWtlX2RhbWFnZSgpO1xyXG5cdFx0XHRcdGFudC5oZXJvX2h1cnRfbWUgPSBmYWxzZTtcclxuXHRcdFx0XHRhbnQuY2FuX2F0dGFjayA9IGZhbHNlO1xyXG5cdFx0XHRcdGFudC5jaGFuZ2VfYW5pbWF0aW9uKGFudCwgXCJ1cHNpZGVfZG93blwiKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cclxuXHQvKlxyXG5cdHZhciBhbnQuY2hhbmdlX2FuaW1hdGlvbiA9IGZ1bmN0aW9uKGFudCwgcHJvZ3Jlc3Nfc3RhdGUpIHtcclxuXHRcdGFudC5hbmltYXRpb24gPSBwcm9ncmVzc19zdGF0ZTtcclxuXHJcblx0fTtcclxuXHQqL1xyXG5cdC8vIC8vIC8vU2V0IHVwIENvbGxpc2lvbiBoYW5kbGVyXHJcblx0XHJcblx0XHJcblx0dmFyIGJlZ2luX2NvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0LCBpbmZvKXtcclxuXHRcdC8vaGFuZGxlIGNvbGxpc2lvbnMgaGVyZVxyXG5cdFx0XHJcblx0XHQvL2NvbnNvbGUubG9nKGluZm8uTWUuaWQsIFwiOlwiLCBcIk15IGZpeHR1cmVcIiwgXCInXCIgKyBpbmZvLk1lLmZpeHR1cmVfbmFtZSArIFwiJ1wiLCBcImNhbWUgaW50byBjb250YWN0IHdpdGggZml4dHVyZVwiLCBcclxuXHRcdFx0Ly9cIidcIiArIGluZm8uVGhlbS5maXh0dXJlX25hbWUgKyBcIidcIiwgXCJvZlwiLCBpbmZvLlRoZW0uaWQpO1xyXG5cdFx0XHJcblx0XHR2YXIgdHlwZSA9IGluZm8uTWUudHlwZTtcclxuXHJcblx0XHRpZih0eXBlICE9PSBcImFudFwiKVxyXG5cdFx0XHRjb25zb2xlLmxvZyhcIkVycm9yXCIsIHR5cGUsIFwiaW5zdGVhZCBvZiBhbnQgd2l0aCBvdGhlciBiZWluZ1wiLCBpbmZvLlRoZW0udHlwZSk7XHJcblx0XHRcclxuXHRcdFxyXG5cdFx0aWYoaW5mby5UaGVtLnR5cGUgPT0gXCJoZXJvXCIpXHJcblx0XHR7XHJcblx0XHRcdFxyXG5cdFx0XHRpZihpbmZvLlRoZW0uZml4dHVyZV9uYW1lICE9IFwiYm90dG9tXCIgJiYgaW5mby5NZS5lbnRpdHkuY2FuX2F0dGFjaylcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGluZm8uTWUuZW50aXR5Lm1lX2h1cnRfaGVybyA9IHRydWU7XHJcblx0XHRcdFx0XHJcblx0XHRcdH1cdFxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpbmZvLk1lLmVudGl0eS5oaXRfdGFrZW4gPSB0cnVlOy8vdGFrZSBkYW1hZ2UgaWYgZW5lbXkgY29sbGlkZXMgZnJvbSBhYm92ZSBhbmQgZGlzdGFuY2UgPCB2dWxuZXJhYmlsaXR5IHJhZGl1c1xyXG5cdFx0XHRcdGluZm8uTWUuZW50aXR5LmRhbWFnZV90YWtlbiA9IGluZm8uVGhlbS5lbnRpdHkuZGFtYWdlO1xyXG5cdFx0XHRcdGluZm8uTWUuZW50aXR5Lmhlcm9faHVydF9tZSA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0fTtcclxuXHJcblx0dmFyIGVuZF9jb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCwgaW5mbykge1xyXG5cdFxyXG5cdH07XHJcblxyXG5cdFxyXG5cdHJldHVybiB7XHJcblx0XHQvLyBkZWNsYXJlIHB1YmxpY1xyXG5cdFx0aW5pdDogaW5pdCwgXHJcblx0XHRzcGF3bjogc3Bhd24sXHJcblx0XHR0aWNrX0FJOiB0aWNrX0FJLFxyXG5cdFx0YmVnaW5fY29udGFjdDogYmVnaW5fY29udGFjdCxcclxuXHRcdGVuZF9jb250YWN0OiBlbmRfY29udGFjdCxcclxuXHR9O1xyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBBbnRMb2dpYztcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkFudExvZ2ljXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5MT0dJQ19TUEVDSUZJQ1xyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcbiIsInZhciBHcmlmZmluTG9naWMgPSAoZnVuY3Rpb24oKXtcclxuICAgXHJcblx0dmFyIEdyaWZmaW4gPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogV2lsbCBiZSBpbnN0YW50aWF0ZWQgZm9yIGV2ZXJ5IGNyZWF0ZWQgZW50aXR5IHRvIGhvbGQgYWxsIHRoZSBpbmZvcm1hdGlvbiBcclxuXHRcdFx0YWJvdXQgdGhlIHBoeXNpY2FsIChub3QgZ3JhcGhpY2FsKSBzdGF0ZSBvZiB0aGUgZW50aXR5IGluIHF1ZXN0aW9uLiBcclxuXHRcdFx0ZGVjbGFyZSB0aGUgcHJvcGVydGllcyBsaWtlIHRoaXM6XHJcblx0XHRcdHRoaXMuc29tZV9zdGF0ZV92YXJpYWJsZV9pbml0aWFsX3ZhbHVlID0gMDtcclxuXHRcdFx0aW5zdGFudGlhdGUgKG1vc3QgbGlrZWx5IGluIHRoZSBzcGF3biBmdW5jdGlvbikgbGlrZSB0aGF0OlxyXG5cdFx0XHR2YXIgbmV3X2VudGl0eV9pbnN0YW5jZSA9IG5ldyBHcmlmZmluKCk7XHJcblx0XHQqL1xyXG5cdFx0dGhpcy5oZXJvX2h1cnRfbWUgPSBmYWxzZTtcclxuXHRcdHRoaXMubWVfaHVydF9oZXJvID0gZmFsc2U7XHJcblx0XHR0aGlzLmRlYXRoX3RpY2sgPSAwO1xyXG5cclxuXHRcdC8vc2V0IHlvdXIgZ2FtZSBsb2dpYyBwYXJhbWV0ZXJzIGhlcmVcclxuXHRcdC8vdGhpcy5vYmplY3RfaWQgPSAxOyAvL2hhcmRjb2RlIGEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIGVhY2ggbmV3IGVuZW15IGNsYXNzXHJcblx0XHR0aGlzLmhwID0gMztcclxuXHRcdHRoaXMuc3BlZWQgPSA2O1xyXG5cdFx0dGhpcy5kYW1hZ2UgPSAxMDtcclxuXHRcdHRoaXMucG9pbnRfdmFsdWUgPSAxMDA7XHJcblx0XHQvL3RoaXMuYXR0YWNrX2Nvb2xkb3duID0gNDsgLy91c2UgdGhpcyBmb3IgZW5lbWllcyB3aG8gbmVlZFxyXG5cdFx0dGhpcy5jYW5fYXR0YWNrID0gdHJ1ZTsvL3VzZSB0aGlzIGZvciBlbmVtaWVzIHdobyBhbHRlcm5hdGUgYmV0d2VlbiBcclxuXHRcdC8vdGhpcy5jb29sZG93bl90aW1lcj0tMTtcclxuXHRcdHRoaXMuQUlfc3RhdGUgPSBcImZseVwiOy8vdXNlIHRoaXMgdG8ga2VlcCB0cmFjayBvZiB0aGUgZW5lbXkncyBBSSBzdGF0ZVxyXG5cdFx0dGhpcy5hbGl2ZWZsYWcgPSB0cnVlO1xyXG5cdFx0dGhpcy51bmh1cnRmbGFnID0gdHJ1ZTtcclxuXHRcdHRoaXMubmVlZHNfZ3JhcGhpY3NfdXBkYXRlID0gZmFsc2U7XHJcblxyXG5cdFx0dGhpcy5kaXJlY3Rpb24gPSBmYWxzZTtcclxuXHRcdHRoaXMuZmx5X2ZvcmNlID0gMTAwO1xyXG5cdH07XHJcblxyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oKXtcclxuXHRcdC8qIElzIHJhbiBmcm9tIHRoZSBFbnRpdHlDb250cm9sbGVyLmluaXQgb25jZSBkdXJpbmcgZ2FtZSBsb2FkaW5nIFxyXG5cdFx0IFx0eW91IHNob3VsZCBhc3NpZ24gdHlwZSB0byB5b3VyIG1vZGVsIGhlcmUgdXNpbmcgdGhlIGlkZW50aWZpY2F0aW9uIGNvbnRyb2xsZXJcclxuXHRcdCAqL1xyXG5cdFx0aW5jbHVkZSgpOyAvLyBzYXRpc2Z5IHJlcXVpcmVtZW50cywgR09FUyBGSVJTVFxyXG5cdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyLmFzc2lnbl90eXBlKEdyaWZmaW4sIFwiR3JpZmZpblwiKTtcclxuXHR9O1xyXG5cclxuXHR2YXIgc3Bhd24gPSBmdW5jdGlvbih4LCB5KXtcclxuXHRcdC8qIHNwYXduIGluc3RhbmNlIG9mIHRoaXMgZW50aXR5IGF0IHRoZSBnaXZlbiBjb29yZGluYXRlc1xyXG5cdFx0XHR5b3Ugd2lsbCBoYXZlIHRvIGNyZWF0ZSBuZXcgZW50aXR5IGluc3RhbmNlLCBhc3NpZ24gaXQgaWRcclxuXHRcdFx0dXNpbmcgdGhlIElkZW50aWZpY2F0aW9uQ29udHJvbGxlci5hc3NpZ25faWQoZW50aXR5X2luc3RhbmNlKSxcclxuXHRcdFx0YXNzaWduIGl0IGEgYm9keSB3aGljaCB5b3UgY2FuIGdldCB0aHJvdWdoIFBoeXNpY3NDb250cm9sbGVyXHJcblx0XHRcdGRvIGFueSBvdGhlciBzdHVmZiB5b3Ugd2FudCB0byBkbyBkdXJpbmcgc3Bhd25pbmcsXHJcblx0XHRcdGFuZCBmaW5hbGx5IHlvdSBIQVZFIFRPKCEhISkgcmV0dXJuIHRoZSBpbnN0YW5jZSB5b3UganVzdCBjcmVhdGVkIGZyb20gdGhpcyBmdW5jdGlvblxyXG5cdFx0Ki9cclxuXHJcblx0XHR2YXIgbmV3X0dyaWZmaW4gPSBuZXcgR3JpZmZpbigpO1xyXG5cdFx0dmFyIGlkID0gSWRlbnRpZmljYXRpb25Db250cm9sbGVyLmFzc2lnbl9pZChuZXdfR3JpZmZpbik7XHJcblxyXG5cdFx0bmV3X0dyaWZmaW4uYm9keSA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7eDogeCwgeTogeSwgYm9yZGVyX3NlbnNvcnM6IHRydWV9LCBuZXdfR3JpZmZpbik7XHRcclxuXHJcblx0XHRyZXR1cm4gbmV3X0dyaWZmaW47XHJcblxyXG5cdH07XHJcblxyXG5cdHZhciB0aWNrX0FJID0gZnVuY3Rpb24oR3JpZmZpbil7XHJcblx0XHQvKiBJcyByYW4gZWFjaCB0aWNrIGZyb20gdGhlIEVudGl0eUNvbnRyb2xsZXIudXBkYXRlIGZvciBldmVyeSByZWdpc3RlcmVkXHJcblx0XHRcdGVudGl0eSBvZiB0aGlzIHR5cGUuIEkgZ2l2ZW4gZW50aXR5X2luc3RhbmNlXHJcblx0XHQqL1xyXG5cclxuXHJcblx0XHRpZiAoR3JpZmZpbi5ocCA9PSAxKSB7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoR3JpZmZpbi5oZXJvX2h1cnRfbWUpe1xyXG5cdFx0XHRcdHdvdW5kX0dyaWZmaW4oR3JpZmZpbiwgMSk7XHJcblx0XHRcdFx0V29ybGRDb250cm9sbGVyLmluY3JlYXNlX3Njb3JlKCk7XHJcblx0XHRcdFx0R3JpZmZpbi5oZXJvX2h1cnRfbWUgPSBmYWxzZTtcclxuXHRcdFx0XHRHcmlmZmluLmNhbl9hdHRhY2sgPSBmYWxzZTtcclxuXHRcdFx0XHRcclxuXHRcdFx0fVxyXG5cclxuXHRcdH1lbHNlIGlmIChHcmlmZmluLmhwIDw9IDApIHtcclxuXHRcdFx0Y2hhbmdlX3N0YXRlKEdyaWZmaW4sIFwiZGVhdGhcIik7XHJcblx0XHRcdEdyaWZmaW4uY2FuX2F0dGFjayA9IGZhbHNlO1xyXG5cdFx0XHRHcmlmZmluLmRlYXRoX3RpY2srKztcclxuXHRcdFx0R3JpZmZpbi5pc19hbGl2ZSA9IGZhbHNlO1xyXG5cdFx0XHRHcmlmZmluLmhpdF90YWtlbiA9IGZhbHNlO1xyXG5cclxuXHRcdFx0XHJcblx0XHRcdGlmKEdyaWZmaW4uZGVhdGhfdGljayA9PSAxNSl7XHJcblx0XHRcdFx0RW50aXR5Q29udHJvbGxlci5kZWxldGVfZW50aXR5KEdyaWZmaW4pO1xyXG5cdFx0XHRcdHJldHVybiBcclxuXHRcdFx0fWVsc2UgaWYoR3JpZmZpbi5kZWF0aF90aWNrID4gMTUpe1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0fWVsc2UgeyAvLyBHcmlmZmluLmhwID49IDFcclxuXHJcblx0XHRcdGlmIChHcmlmZmluLkFJX3N0YXRlID09IFwid2Fsa1wiKSB7XHJcblx0XHRcdFx0dmFyIEdyaWZmaW5ib2R5ID0gR3JpZmZpbi5ib2R5O1xyXG5cdFx0XHRcdHZhciB2ZWxvY2l0eSA9IEdyaWZmaW5ib2R5LkdldExpbmVhclZlbG9jaXR5KCk7XHJcblx0XHRcdFx0dmVsb2NpdHkueCA9IC1HcmlmZmluLnNwZWVkO1xyXG5cdFx0XHRcdEdyaWZmaW5ib2R5LlNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5KTsgLy8gYm9keS5TZXRMaW5lYXJWZWxvY2l0eShuZXcgYjJWZWMyKDUsIDApKTsgd291bGQgd29yayB0b29cclxuXHRcdFx0XHRHcmlmZmluYm9keS5TZXRBd2FrZSh0cnVlKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKEdyaWZmaW4uQUlfc3RhdGUgPT0gXCJmbHlcIikge1xyXG5cdFx0XHQgICAgdmFyIGJvZHkgPSBHcmlmZmluLmJvZHk7XHJcblx0XHRcdCAgICBib2R5LkFwcGx5SW1wdWxzZShuZXcgQjJkLmIyVmVjMigoMiAqIEdyaWZmaW4uZmx5X2ZvcmNlICogR3JpZmZpbi5kaXJlY3Rpb24pIC0gR3JpZmZpbi5mbHlfZm9yY2UsIDEgKiBHcmlmZmluLmZseV9mb3JjZSAvIDIpLCBib2R5LkdldFdvcmxkQ2VudGVyKCkpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoR3JpZmZpbi5jYW5fYXR0YWNrICYmIEdyaWZmaW4ubWVfaHVydF9oZXJvICYmIEdyaWZmaW4uQUlfc3RhdGUgPT0gXCJ3YWxrXCIpe1xyXG5cdFx0XHRcdC8vIHBhc3NcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoR3JpZmZpbi5oZXJvX2h1cnRfbWUpXHJcblx0XHRcdHtcclxuXHRcdFx0XHR3b3VuZF9HcmlmZmluKEdyaWZmaW4sIDEpO1xyXG5cdFx0XHRcdEdyaWZmaW4uaGVyb19odXJ0X21lID0gZmFsc2U7XHJcblx0XHRcdFx0R3JpZmZpbi5jYW5fYXR0YWNrID0gZmFsc2U7XHJcblx0XHRcdFx0Y2hhbmdlX2FuaW1hdGlvbihHcmlmZmluLCBcImluanVyeVwiKTtcclxuICAgICAgICAgICAgICAgIFx0XHRcdFx0XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0XHJcblx0fTtcclxuXHJcblxyXG5cdHZhciB3b3VuZF9HcmlmZmluID0gZnVuY3Rpb24oR3JpZmZpbiwgd291bmQpe1xyXG5cdFx0R3JpZmZpbi5ocCAtPSB3b3VuZDtcclxuXHRcdEdyaWZmaW4uaGVyb19odXJ0X21lID0gZmFsc2U7XHJcblx0fTtcclxuXHJcblx0dmFyIGNoYW5nZV9zdGF0ZSA9IGZ1bmN0aW9uKEdyaWZmaW4sIHByb2dyZXNzX3N0YXRlKSB7XHJcblx0XHRHcmlmZmluLkFJX3N0YXRlID0gcHJvZ3Jlc3Nfc3RhdGU7XHJcblxyXG5cdH07XHJcblxyXG5cdC8vIC8vIC8vU2V0IHVwIENvbGxpc2lvbiBoYW5kbGVyXHJcblx0XHJcblx0XHJcblx0dmFyIGJlZ2luX2NvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0LCBpbmZvKXtcclxuXHRcdC8vaGFuZGxlIGNvbGxpc2lvbnMgaGVyZVxyXG5cdFx0XHJcblx0XHQvL2NvbnNvbGUubG9nKGluZm8uTWUuaWQsIFwiOlwiLCBcIk15IGZpeHR1cmVcIiwgXCInXCIgKyBpbmZvLk1lLmZpeHR1cmVfbmFtZSArIFwiJ1wiLCBcImNhbWUgaW50byBjb250YWN0IHdpdGggZml4dHVyZVwiLCBcclxuXHRcdFx0Ly9cIidcIiArIGluZm8uVGhlbS5maXh0dXJlX25hbWUgKyBcIidcIiwgXCJvZlwiLCBpbmZvLlRoZW0uaWQpO1xyXG5cdFx0XHJcblx0XHR2YXIgdHlwZSA9IGluZm8uTWUudHlwZTtcclxuXHJcblx0XHRpZih0eXBlICE9PSBcIkdyaWZmaW5cIilcclxuXHRcdFx0Y29uc29sZS5sb2coXCJFcnJvclwiLCB0eXBlLCBcImluc3RlYWQgb2YgR3JpZmZpbiB3aXRoIG90aGVyIGJlaW5nXCIsIGluZm8uVGhlbS50eXBlKTtcclxuXHRcdFxyXG5cdFx0XHJcblx0XHRpZihpbmZvLlRoZW0udHlwZSA9PSBcImhlcm9cIilcclxuXHRcdHtcclxuXHRcdFx0XHJcblx0XHRcdGlmKGluZm8uVGhlbS5maXh0dXJlX25hbWUgIT0gXCJib3R0b21cIiAmJiBpbmZvLk1lLmVudGl0eS5jYW5fYXR0YWNrKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aW5mby5NZS5lbnRpdHkubWVfaHVydF9oZXJvID0gdHJ1ZTtcclxuXHRcdFx0XHRcclxuXHRcdFx0fVx0XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0e1xyXG5cclxuXHRcdFx0XHRpbmZvLk1lLmVudGl0eS5oZXJvX2h1cnRfbWUgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdH07XHJcblx0XHJcblx0dmFyIGNoYW5nZV9hbmltYXRpb24gPSBmdW5jdGlvbiAoR3JpZmZpbiwgbmV3X2FuaW1hdGlvbikge1xyXG5cdFx0XHRpZiAoR3JpZmZpbi5hbmltYXRpb24gIT0gbmV3X2FuaW1hdGlvbikge1xyXG5cdFx0XHRcdEdyaWZmaW4uYW5pbWF0aW9uID0gbmV3X2FuaW1hdGlvbjtcclxuXHRcdFx0XHRHcmlmZmluLm5lZWRzX2dyYXBoaWNzX3VwZGF0ZSA9IHRydWU7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRHcmlmZmluLm5lZWRzX2dyYXBoaWNzX3VwZGF0ZSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHZhciBlbmRfY29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QsIGluZm8pIHtcclxuXHRcclxuXHR9O1xyXG5cclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0c3Bhd246IHNwYXduLFxyXG5cdFx0dGlja19BSTogdGlja19BSSxcclxuXHRcdGJlZ2luX2NvbnRhY3Q6IGJlZ2luX2NvbnRhY3QsXHJcblx0XHRlbmRfY29udGFjdDogZW5kX2NvbnRhY3QsXHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR3JpZmZpbkxvZ2ljO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiR3JpZmZpbkxvZ2ljXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5MT0dJQ19TUEVDSUZJQ1xyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcbiIsInZhciBIZXJvTG9naWMgPSAoZnVuY3Rpb24oKXtcblxuXHR2YXIgSGVybyA9IGZ1bmN0aW9uKCl7XG5cdFx0LyogV2lsbCBiZSBpbnN0YW50aWF0ZWQgZm9yIGV2ZXJ5IGNyZWF0ZWQgZW50aXR5IHRvIGhvbGQgYWxsIHRoZSBpbmZvcm1hdGlvbiBcblx0XHRcdGFib3V0IHRoZSBwaHlzaWNhbCAobm90IGdyYXBoaWNhbCkgc3RhdGUgb2YgdGhlIGVudGl0eSBpbiBxdWVzdGlvbi4gXG5cdFx0XHRkZWNsYXJlIHRoZSBwcm9wZXJ0aWVzIGxpa2UgdGhpczpcblx0XHRcdHRoaXMuc29tZV9zdGF0ZV92YXJpYWJsZV9pbml0aWFsX3ZhbHVlID0gMDtcblx0XHRcdGluc3RhbnRpYXRlIChtb3N0IGxpa2VseSBpbiB0aGUgc3Bhd24gZnVuY3Rpb24pIGxpa2UgdGhhdDpcblx0XHRcdHZhciBuZXdfZW50aXR5X2luc3RhbmNlID0gbmV3IEhlcm8oKTtcblx0XHQqL1xuXHRcdHRoaXMuaHAgPSAxMDA7XG5cdFx0dGhpcy53b3VuZCA9IGZhbHNlO1xuXHRcdHRoaXMuZGFtYWdlX3Rha2VuID0gMTtcblx0XHR0aGlzLmRhbWFnZSA9IDE7XG5cdFx0dGhpcy5qdW1wcyA9IDA7XG5cdFx0XG5cdFx0dGhpcy5zY29yZSA9IDA7XG5cdFx0dGhpcy5zdGF0ZSA9IFwid2Fsa1wiO1xuXHRcdHRoaXMuYW5fZnJhbWUgPTA7XG5cdFx0dGhpcy5kZWF0aF90aWNrPTA7XG5cdFx0dGhpcy5qdW1wX3RpY2s9MDtcblx0XHR0aGlzLndhbGtfdGljaz0wO1xuXHRcdHRoaXMuaXNfd2FsayA9IGZhbHNlO1xuXHRcdHRoaXMuaXNfanVtcCA9IGZhbHNlO1xuXHRcdHRoaXMuZGVhdGggPSBmYWxzZTtcblx0XHQvKlxuXHRcdFx0d2hlbmV2ZXIgdGhlIHVwLHJpZ2h0LGxlZnQgYnV0dG9ucyBhcmUgcHJlc3NlZCB0aGUgXG5cdFx0XHRjb3Jvc3BvbmRpbmcgdmFsdWUgaXMgc2V0IHRvIDAgYW5kIHRoZSBvdGhlciBhcmUgaW5jcmVhc2VkIGJ5MVxuXHRcdFx0dGhlIHZhbHVlIG9mIHRoZSBib29sZWFuIGNvcm9zcG9kaW5nIHRvIHRoZSBidXR0b24gcHJlc3NlZCBpcyBzZXQgdG8gdHJ1ZVxuXHRcdCovXG5cdFx0dGhpcy51cCA9ZmFsc2U7XG5cdFx0dGhpcy5yaWdodD1mYWxzZTtcblx0XHR0aGlzLmxlZnQ9ZmFsc2U7XG5cdFx0dGhpcy5mYWNpbmcgPSBcInJpZ2h0XCI7IC8vb3Igd2lsbCBiZSBsZWZ0XG5cdH07XG5cblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xuXHRcdC8qIElzIHJhbiBmcm9tIHRoZSBFbnRpdHlDb250cm9sbGVyLmluaXQgb25jZSBkdXJpbmcgZ2FtZSBsb2FkaW5nIFxuXHRcdFx0eW91IHNob3VsZCBhc3NpZ24gdHlwZSB0byB5b3VyIG1vZGVsIGhlcmUgdXNpbmcgdGhlIGlkZW50aWZpY2F0aW9uIGNvbnRyb2xsZXJcblx0XHQqL1xuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHMsIEdPRVMgRklSU1Rcblx0XHRJZGVudGlmaWNhdGlvbkNvbnRyb2xsZXIuYXNzaWduX3R5cGUoSGVybywgXCJoZXJvXCIpO1xuXHR9O1xuXG5cdHZhciBzcGF3biA9IGZ1bmN0aW9uKHgsIHkpe1xuXHRcdC8qIHNwYXduIGluc3RhbmNlIG9mIHRoaXMgZW50aXR5IGF0IHRoZSBnaXZlbiBjb29yZGluYXRlc1xuXHRcdFx0eW91IHdpbGwgaGF2ZSB0byBjcmVhdGUgbmV3IGVudGl0eSBpbnN0YW5jZSwgYXNzaWduIGl0IGlkXG5cdFx0XHR1c2luZyB0aGUgSWRlbnRpZmljYXRpb25Db250cm9sbGVyLmFzc2lnbl9pZChlbnRpdHlfaW5zdGFuY2UpLFxuXHRcdFx0YXNzaWduIGl0IGEgYm9keSB3aGljaCB5b3UgY2FuIGdldCB0aHJvdWdoIFBoeXNpY3NDb250cm9sbGVyXG5cdFx0XHRkbyBhbnkgb3RoZXIgc3R1ZmYgeW91IHdhbnQgdG8gZG8gZHVyaW5nIHNwYXduaW5nLFxuXHRcdFx0YW5kIGZpbmFsbHkgeW91IEhBVkUgVE8oISEhKSByZXR1cm4gdGhlIGluc3RhbmNlIHlvdSBqdXN0IGNyZWF0ZWQgZnJvbSB0aGlzIGZ1bmN0aW9uXG5cdFx0Ki9cblxuXHRcdHZhciBoZXJvID0gbmV3IEhlcm8oKTtcblxuXHRcdGhlcm8uYm9keSA9IFBoeXNpY3NDb250cm9sbGVyLmdldF9yZWN0YW5ndWxhcih7eDogeCwgeTogeSwgYm9yZGVyX3NlbnNvcnM6IHRydWV9LCBoZXJvKTtcblxuXHRcdHZhciBpZCA9IElkZW50aWZpY2F0aW9uQ29udHJvbGxlci5hc3NpZ25faWQoaGVybyk7XG5cdFx0RW50aXR5Q29udHJvbGxlci5sb2FkX2hlcm8oaGVyby5pZCk7XG5cdFx0XG5cdFx0aGVyby5ocCA9IDEwMDtcblx0XHRoZXJvLndvdW5kID0gZmFsc2U7XG5cdFx0aGVyby5qdW1wcyA9IDA7XG5cdFx0aGVyby5zY29yZSA9IDA7XG5cblx0XHRyZXR1cm4gaGVybztcblx0XG5cdH07XG5cblx0dmFyIHRpY2tfQUkgPSBmdW5jdGlvbihoZXJvKXtcblx0XHQvKiBJcyByYW4gZWFjaCB0aWNrIGZyb20gdGhlIEVudGl0eUNvbnRyb2xsZXIudXBkYXRlIGZvciBldmVyeSByZWdpc3RlcmVkXG5cdFx0XHRlbnRpdHkgb2YgdGhpcyB0eXBlLiBJIGdpdmVuIGVudGl0eV9pbnN0YW5jZVxuXHRcdCovXG5cblx0XHR2YXIgY21kcyA9IEtleWJvYXJkQ29udHJvbGxlci5tb3ZlbWVudF9jb21tYW5kcygpO1xuXG4gICAgICAgXG4gICAgICAgIC8vRW5kIFNjb3JlIFRyYWNraW5nXG5cblx0XHRpZihoZXJvLmhwIDw9IDApXG5cdFx0e1xuXHRcdFx0aGVyby5ocD0wO1xuXHRcdFx0aWYoaGVyby5kZWF0aCA9PSBmYWxzZSl7XG5cdFx0XHRcdGNoYW5nZV9zdGF0ZShoZXJvLFwiZGVhdGhcIik7XG5cdFx0XHRcdGhlcm8uZGVhdGggPSB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0aGVyby5kZWF0aF90aWNrKys7XG5cdFx0XHRpZiAoaGVyby5kZWF0aF90aWNrID09IDcwKSB7XG5cdFx0XHRcdGRlc3Bhd24oaGVybyk7XHRcblx0XHRcdH1cblx0XHRcdFxuXHRcdH1cblx0XHRlbHNle1xuXHRcdFx0aWYoY21kcyhcInJpZ2h0XCIpKXtcblx0XHRcdFx0IGlmKGhlcm8uanVtcHM9PTAmJmhlcm8uaXNfd2FsayA9PSBmYWxzZSl7XG5cdFx0XHRcdFx0Y2hhbmdlX3N0YXRlKGhlcm8sXCJ3YWxrXCIpO1xuXHRcdFx0XHRcdGhlcm8uaXNfd2FsayA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYoaGVyby5yaWdodCA9PSBmYWxzZSl7XG5cdFx0XHRcdFx0aGVyby5yaWdodCA9IHRydWU7XG5cdFx0XHRcdFx0aGVyby5sZWZ0ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdG1vdmVfcmlnaHQoaGVybyk7XG5cdFx0XHR9XG5cdFx0XHRpZihjbWRzKFwibGVmdFwiKSl7XG5cdFx0XHRcdGlmKGhlcm8uanVtcHM9PTAmJmhlcm8uaXNfd2FsayA9PSBmYWxzZSl7XG5cdFx0XHRcdFx0Y2hhbmdlX3N0YXRlKGhlcm8sXCJ3YWxrXCIpO1xuXHRcdFx0XHRcdGhlcm8uaXNfd2FsayA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGlmKGhlcm8ubGVmdCA9PSBmYWxzZSl7XG5cdFx0XHRcdFx0aGVyby5sZWZ0ID0gdHJ1ZTtcblx0XHRcdFx0XHRoZXJvLnJpZ2h0ID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdFx0bW92ZV9sZWZ0KGhlcm8pO1xuXHRcdFx0fVxuXHRcdFx0aWYoY21kcyhcImRvd25cIikpe1xuXHRcdFx0ICAgIHNsYW0oaGVybyk7XG5cdFx0XHQgICAgc3RvcF9oZXJvKGhlcm8pO1xuXHRcdFx0fVxuXHRcdFx0aWYoY21kcyhcInVwXCIpKXtcblx0XHRcdFx0aGVyby5pc193YWxrPWZhbHNlO1xuXHRcdFx0XHRqdW1wKGhlcm8pO1xuXHRcdFx0XHRcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYoaGVyby53b3VuZClcblx0XHR7XG5cdFx0XHRoZXJvLmhwIC09IGhlcm8uZGFtYWdlX3Rha2VuO1xuXHRcdFx0Y29uc29sZS5sb2coXCJUYWtpbmcgZGFtYWdlXCIpO1xuXHRcdH1cblx0XHRcblx0XHRpZiAoaGVyby5ib2R5LkdldFdvcmxkQ2VudGVyKCkueCA8IFdvcmxkQ29udHJvbGxlci5nZXRfbW92ZW1lbnRfZWRnZSgpICsgaGVyby5ib2R5LkdldFVzZXJEYXRhKCkuZGVmLndpZHRoLzIpIHtcblx0XHRcdHN0b3BfaGVybyhoZXJvKTtcblx0XHRcdGNvbnNvbGUubG9nKFwid29ya2luZ1wiKTtcblx0XHR9XG5cdFx0Ly9pZiAoaGVyby5ib2R5LkdldFdvcmxkQ2VudGVyKCkueSA+IDIyKSB7XG5cdFx0XHQvL2hlcm8uaHAgPSAwO1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhcImRyb3Agb2YgZGVhdGhcIik7XG5cdFx0Ly99XG5cdH07XG5cblx0dmFyIGRlc3Bhd24gPSBmdW5jdGlvbihoZXJvKXtcblx0XHQvKipcblx0XHQqIGNhbGxlZCB3aGVuIGhlcm8gc2hvdWxkIGRlc3Bhd24gKGRpZSk7XG5cdFx0Ki9cblxuXHRcdEVudGl0eUNvbnRyb2xsZXIuZGVsZXRlX2VudGl0eShoZXJvKTtcblx0XHRjb25zb2xlLmxvZyhcIlBsYXllciBJcyBEZWFkXCIpO1xuXHR9O1xuXHRcblx0XG5cdHZhciBjaGFuZ2Vfc3RhdGUgPSBmdW5jdGlvbihoZXJvLCBuZXdfc3RhdGUpe1xuXHRcdGhlcm8uc3RhdGUgPSBuZXdfc3RhdGU7XG5cdFx0aGVyby53YWxrX3RpY2sgPSAwO1xuXHRcdGhlcm8uZGVhdGhfdGljayA9IDA7XG5cdFx0aGVyby5qdW1wX3RpY2sgPSAwO1xuXHR9O1xuXHR2YXIgYmVnaW5fY29udGFjdCA9IGZ1bmN0aW9uKGNvbnRhY3QsIGluZm8pe1xuXHRcdGlmIChpbmZvLk1lLmZpeHR1cmVfbmFtZSA9PSBcImJvdHRvbVwiKXtcblx0XHRcdGlmKGluZm8uVGhlbS5maXh0dXJlX25hbWUgPT0gXCJ0b3BcIiB8fCBpbmZvLlRoZW0uZW50aXR5LmtpbmQgPT0gMSB8fCBpbmZvLlRoZW0uZW50aXR5LmtpbmQgPT0gMil7XG5cdFx0XHRcdGluZm8uTWUuZW50aXR5Lmp1bXBzID0gMDtcblx0XHRcdH1cblx0XHRcdGlmKGluZm8uVGhlbS5lbnRpdHkua2luZCA9PSAzKXtcblx0XHRcdCAgICBpZiAoaW5mby5NZS5lbnRpdHkuaHAgPiAwKSB7XG5cdFx0XHQgICAgICAgIGluZm8uTWUuZW50aXR5LndvdW5kID0gdHJ1ZTtcblx0XHRcdCAgICB9XG5cdFx0XHRcdGluZm8uTWUuZW50aXR5LmRhbWFnZV90YWtlbiA9IGluZm8uVGhlbS5lbnRpdHkuZGFtYWdlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihpbmZvLk1lLmZpeHR1cmVfbmFtZSAhPSBcImJvdHRvbVwiICYmIGluZm8uVGhlbS5lbnRpdHkuY2FuX2F0dGFjayl7XG5cdFx0XHRpZih0eXBlb2YgaW5mby5UaGVtLmVudGl0eS5raW5kID09PSAndW5kZWZpbmVkJyl7XG5cdFx0XHRcdC8vc3R1cGlkIGNoYWluIG9mIGJveDJkIGZ1bmN0aW9ucyByZXR1cm5zIHt4OmhhbGZfaGVpZ2h0LHk6aGFsZl93aWR0aH1cblx0XHRcdFx0dmFyIG15X2V4dGVudHMgPSBpbmZvLk1lLmVudGl0eS5ib2R5LkdldEZpeHR1cmVMaXN0KCkuR2V0TmV4dCgpLkdldE5leHQoKS5HZXROZXh0KCkuR2V0TmV4dCgpLkdldEFBQkIoKS5HZXRFeHRlbnRzKCk7XG5cdFx0XHRcdHZhciBteV9jb29yZGluYXRlcyA9IGluZm8uTWUuZW50aXR5LmJvZHkuR2V0V29ybGRDZW50ZXIoKTtcblx0XHRcdFx0dmFyIG90aGVyX2V4dGVudHMgPSBpbmZvLlRoZW0uZW50aXR5LmJvZHkuR2V0Rml4dHVyZUxpc3QoKS5HZXROZXh0KCkuR2V0TmV4dCgpLkdldE5leHQoKS5HZXROZXh0KCkuR2V0QUFCQigpLkdldEV4dGVudHMoKTtcblx0XHRcdFx0dmFyIG90aGVyX2Nvb3JkaW5hdGVzID0gaW5mby5UaGVtLmVudGl0eS5ib2R5LkdldFdvcmxkQ2VudGVyKCk7XG5cdFx0XHRcdC8vcHJldmVudHMgdGFraW5nIGRhbWFnZSB3aGlsZSBvbiB0b3Agb2YgZW5lbWllc1xuXHRcdFx0XHRpZiAoIShteV9jb29yZGluYXRlcy55IDw9IG90aGVyX2Nvb3JkaW5hdGVzLnkgLSAobXlfZXh0ZW50cy55ICsgb3RoZXJfZXh0ZW50cy55IC0gMC41KSkpIHtcblx0XHRcdFx0ICAgIGlmIChpbmZvLk1lLmVudGl0eS5ocCA+IDApIHtcblx0XHRcdFx0ICAgICAgICBpbmZvLk1lLmVudGl0eS53b3VuZCA9IHRydWU7XG5cdFx0XHRcdCAgICB9XG5cdFx0XHRcdFx0aW5mby5NZS5lbnRpdHkuZGFtYWdlX3Rha2VuID0gaW5mby5UaGVtLmVudGl0eS5kYW1hZ2U7XG5cdFx0XHRcdH1cblx0XHRcdH1lbHNle1xuXHRcdFx0XHRpbmZvLk1lLmVudGl0eS53b3VuZCA9IHRydWU7XG5cdFx0XHRcdGluZm8uTWUuZW50aXR5LmRhbWFnZV90YWtlbiA9IGluZm8uVGhlbS5lbnRpdHkuZGFtYWdlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcdFx0XG5cdH07XG5cblx0dmFyIHRha2VfaGl0ID0gZnVuY3Rpb24oaGVybywgYW1vdW50KXtcblx0ICAgIGhlcm8uaHAgLT0gYW1vdW50O1xuXHR9XG5cblx0dmFyIGVuZF9jb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCwgaW5mbyl7XG5cdFx0XHRcblx0XHRpbmZvLk1lLmVudGl0eS53b3VuZCA9IGZhbHNlO1xuXHR9O1xuXG5cdHZhciBzdG9wX2hlcm8gPSBmdW5jdGlvbiAoaGVybykge1xuXHRcdC8vdmFyIGJvZHkgPSBoZXJvLmJvZHk7XG5cdFx0Ly92YXIgdmVsb2NpdHkgPSBib2R5LkdldExpbmVhclZlbG9jaXR5KCk7XG5cdFx0Ly92ZWxvY2l0eS54ID0gMDtcblx0XHQvL2JvZHkuU2V0TGluZWFyVmVsb2NpdHkodmVsb2NpdHkpOyAvLyBib2R5LlNldExpbmVhclZlbG9jaXR5KG5ldyBiMlZlYzIoNSwgMCkpOyB3b3VsZCB3b3JrIHRvb1xuXHRcdC8vYm9keS5TZXRBd2FrZSh0cnVlKTtcblxuXHRcdHZhciBib2R5ID0gaGVyby5ib2R5O1xuXHRcdHZhciB3ID0gaGVyby5ib2R5LkdldFVzZXJEYXRhKCkuZGVmLndpZHRoLzI7XG5cdFx0dmFyIHBvcyA9IG5ldyBCMmQuYjJWZWMyKFdvcmxkQ29udHJvbGxlci5nZXRfbW92ZW1lbnRfZWRnZSgpICsgdywgYm9keS5HZXRXb3JsZENlbnRlcigpLnkpXG5cdFx0dmFyIHZlbCA9IGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKTtcblx0XHRpZih2ZWwueCA8IDAgfHwgYm9keS5HZXRXb3JsZENlbnRlcigpLnggPiBwb3MueCl7XG5cdFx0XHR2YXIgdmVsID0gbmV3IEIyZC5iMlZlYzIoMCwgdmVsLnkpO1xuXHRcdFx0Ym9keS5TZXRMaW5lYXJWZWxvY2l0eSh2ZWwpO1xuXHRcdH1cblxuXHQgICAgYm9keS5TZXRBd2FrZSh0cnVlKTtcblx0fVxuXG5cdHZhciBzbGFtID0gZnVuY3Rpb24oaGVybyl7XG5cdCAgICB2YXIgYm9keSA9IGhlcm8uYm9keTtcblx0ICAgIGJvZHkuQXBwbHlJbXB1bHNlKG5ldyBCMmQuYjJWZWMyKDAsIDIwKSwgYm9keS5HZXRXb3JsZENlbnRlcigpKTtcblx0fTtcblx0dmFyIGp1bXAgPSBmdW5jdGlvbihoZXJvKXtcblx0ICAgIHZhciBib2R5ID0gaGVyby5ib2R5O1xuXHQgICAgdmFyIHcgPSBoZXJvLmJvZHkuR2V0VXNlckRhdGEoKS5kZWYud2lkdGggLyAyO1xuXHQgICAgdmFyIHBvcyA9IG5ldyBCMmQuYjJWZWMyKFdvcmxkQ29udHJvbGxlci5nZXRfbW92ZW1lbnRfZWRnZSgpICsgdywgYm9keS5HZXRXb3JsZENlbnRlcigpLnkpXG5cdCAgICB2YXIgdmVsID0gYm9keS5HZXRMaW5lYXJWZWxvY2l0eSgpO1xuXHQgICAgY29uc29sZS5sb2coaGVyby5qdW1wcyk7XG5cdFx0aWYgKGhlcm8uanVtcHMgPT0gMCl7XG5cdFx0ICAgIGNoYW5nZV9zdGF0ZShoZXJvLCBcImp1bXBcIik7XG5cdFx0XHR2YXIgdmVsID0gbmV3IEIyZC5iMlZlYzIodmVsLngsIC0xOCk7XG5cdFx0XHRib2R5LlNldExpbmVhclZlbG9jaXR5KHZlbCk7XG5cdFx0XHRoZXJvLmJvZHkuU2V0QXdha2UodHJ1ZSk7XG5cdFx0ICAgIGhlcm8uanVtcHMgKz0gMTtcblx0XHR9XG5cdFx0ZWxzZSBpZiAoaGVyby5qdW1wcyA9PSAxICYmIGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKS55ID4gLTEpIHtcblx0XHQgICAgY2hhbmdlX3N0YXRlKGhlcm8sIFwianVtcFwiKTtcblx0XHQgICAgdmFyIG1pbl9jaGVjayA9IHZlbC55IC0gMTg7XG5cdFx0ICAgIGlmIChtaW5fY2hlY2sgPiAtOSkge1xuXHRcdCAgICAgICAgbWluX2NoZWNrID0gLTk7XG5cdFx0ICAgIH1cblx0XHQgICAgdmFyIHZlbCA9IG5ldyBCMmQuYjJWZWMyKHZlbC54LCBtaW5fY2hlY2spO1xuXHRcdCAgICBib2R5LlNldExpbmVhclZlbG9jaXR5KHZlbCk7XG5cdFx0ICAgIGhlcm8uYm9keS5TZXRBd2FrZSh0cnVlKTtcblx0XHQgICAgaGVyby5qdW1wcyArPSAxO1xuXHRcdH1cblxuXHRcdC8vaGVyby55ID0gYm9keS5HZXRQb3NpdGlvbigpLnkgKiAzMDtcblx0XG5cdH07XG5cblx0dmFyIHNldF9jb29yZGluYXRlcyA9IGZ1bmN0aW9uKHBvc2l0aW9uX3ZlY3RvciwgaGVybyl7XG5cdFx0Ly8gVE9ETzogcmVtb3ZlO1xuXHRcdC8vIHRlbXBvcmFyeS90ZXN0aW5nXG5cdFx0aGVyby54ID0gKHBvc2l0aW9uX3ZlY3Rvci54IC0gMS41LzIpICogMzAgO1xuXHRcdGhlcm8ueSA9IChwb3NpdGlvbl92ZWN0b3IueSArIDIuNS8yKSAqIDMwIDtcblxuXHR9O1xuXG5cdHZhciBiMmJfZ2V0X2Nvb3JkaW5hdGVzID0gZnVuY3Rpb24oaGVybyl7XG5cdFx0cmV0dXJuIGhlcm8uYm9keS5HZXRXb3JsZENlbnRlcigpO1xuXHR9O1xuXG5cdHZhciBtb3ZlX2xlZnQgPSBmdW5jdGlvbihoZXJvKXtcblx0XHR2YXIgdmVsb2NpdHkgPSBoZXJvLmJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKTtcblx0XHR2ZWxvY2l0eS54ID0gLTg7XG5cdFx0aGVyby5ib2R5LlNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5KTsgLy8gaGVyby5TZXRMaW5lYXJWZWxvY2l0eShuZXcgYjJWZWMyKDUsIDApKTsgd291bGQgd29yayB0b29cblx0XHRoZXJvLmJvZHkuU2V0QXdha2UodHJ1ZSk7XG5cdH07XG5cblx0dmFyIG1vdmVfcmlnaHQgPSBmdW5jdGlvbihoZXJvKXtcblx0XHR2YXIgdmVsb2NpdHkgPSBoZXJvLmJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKTtcblx0XHR2ZWxvY2l0eS54ID0gKzg7XG5cdFx0aGVyby5ib2R5LlNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5KTsgLy8gaGVyby5TZXRMaW5lYXJWZWxvY2l0eShuZXcgYjJWZWMyKDUsIDApKTsgd291bGQgd29yayB0b29cblx0XHRoZXJvLmJvZHkuU2V0QXdha2UodHJ1ZSk7XG5cdH07XG5cblx0dmFyIG1vdmUgPSBmdW5jdGlvbihvZmZzZXRfeCwgb2Zmc2V0X3ksIGhlcm8pe1xuXHRcdC8vIHVuaW1wbGVtZW50ZWRcblx0XHQvLyBzaG91bGQgaXQgaGFyZC1zZXQgcG9zaXRpb24gKG5vdCBzYWZlISlcblx0XHQvLyBvciBqdXN0IGFsbG93IHRvIHNldCBhbnkgdmVsb2NpdHkvaW1wdWxzZSB2ZWN0b3I/XG5cdH07XG5cdHZhciBnZXRfaGVyb194ID0gZnVuY3Rpb24oKXtcblx0XHRcdHJldHVybiBoZXJvLmJvZHkuR2V0V29ybGRDZW50ZXIoKS54O1xuXHRcblx0fTtcblxuXHRyZXR1cm4ge1xuXHRcdC8vIGRlY2xhcmUgcHVibGljXG5cdFx0aW5pdDogaW5pdCwgXG5cdFx0c3Bhd246IHNwYXduLFxuXHRcdGRlc3Bhd246IGRlc3Bhd24sXG5cdFx0dGlja19BSTogdGlja19BSSxcblx0XHRiZWdpbl9jb250YWN0OiBiZWdpbl9jb250YWN0LFxuXHRcdGVuZF9jb250YWN0OiBlbmRfY29udGFjdCxcblx0XHRnZXRfaGVyb194OiBnZXRfaGVyb194LFxuXHR9O1xufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBIZXJvTG9naWM7XG5cbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xuXHRjdXJyZW50X21vZHVsZTogXCJIZXJvTG9naWNcIiwgXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5MT0dJQ19TUEVDSUZJQ1xufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxuIiwiLyogXHJcblx0RW5lbXk6IEh5ZW5hIFxyXG5cdGNsYXNzIGFuZCBmdW5jdGlvbnMgZm9yIHRoZSBIeWVuYSB0eXBlIGVuZW15XHJcblx0cHVibGljIGZ1bmN0aW9uczpcclxuXHRcdC1pbml0KClcclxuXHRcdFx0aW5pdGlhbGl6ZXMgZGVmYXVsdCBjbGFzcyBkYXRhIGZvciBhbGwgaW5zdGFuY2VzIG9mIGNsYXNzIEh5ZW5hXHJcblx0XHQtc3Bhd24oaW50IHgsIGludCB5KVxyXG5cdFx0XHRyZXR1cm5zIGEgbmV3IGluc3RhbmNlIG9mIGNsYXNzIEh5ZW5hIHdpdGggdW5pcXVlIGluc3RhbmNlIElEIGF0IGdsb2JhbCBjb29yZGluYXRlcyh4LHkpXHJcblx0XHQtdGlja19BSSgpXHJcblx0XHRcdHJ1bnMgaHllbmEgQUkgc2NyaXB0LCB0byBiZSBjYWxsZWQgZm9yIGVhY2ggaW5zdGFuY2Ugb24gZ2FtZSB0aWNrXHJcblx0XHQtYmVnaW5fY29udGFjdCgpXHJcblx0XHRcdGhhbmRsZXMgY29sbGlzaW9ucywgY2FsbGVkIG9uIGNvbGxpc2lvbiB3aXRoIGFueSBvYmplY3RcclxuXHRcdC1lbmRfY29udGFjdCgpXHJcblx0XHRcdGNhbGxiYWNrIGZ1bmN0aW9uIGZvciBib3gyZFxyXG4qL1xyXG5cclxudmFyIEh5ZW5hTG9naWMgPSAoZnVuY3Rpb24oKXtcclxuXHQvL0luc3RhbnRpYXRlZCBmb3IgZWFjaCBpbnN0YW5jZSBvZiBoeWVuYSBhdCBjcmVhdGlvblxyXG5cdC8vY2FsbCBjb25zdHJ1Y3RvciB0aHJvdWdoIHdyYXBwZXIgZnVuY3Rpb24gc3Bhd24oKVxyXG5cdHZhciBIeWVuYSA9IGZ1bmN0aW9uKCl7XHJcblxyXG5cdFx0dmFyIGVudGl0eSA9IEVudGl0eUNvbnRyb2xsZXIuY3JlYXRlX2Fic3RyYWN0X2VudGl0eSgpO1xyXG5cclxuXHRcdC8vRGVjbGFyZSBpbml0aWFsIHZhcmlhYmxlcyBmb3IgdGhlIEh5ZW5hXHJcblx0XHJcblx0XHRlbnRpdHkuaHAgPSAyO1xyXG5cdFx0ZW50aXR5LnNwZWVkID0gNztcclxuXHRcdGVudGl0eS5qdW1wX2ZvcmNlID0gMTI1O1xyXG5cdFx0ZW50aXR5LmRhbWFnZSA9IDU7XHJcblx0XHRlbnRpdHkucG9pbnRfdmFsdWUgPSAyMDA7XHJcblx0XHRlbnRpdHkuc2lnaHRfcmFuZ2UgPSAxNjsgLy9kaXN0YW5jZSBhdCB3aGljaCBoeWVuYSBkZXRlY3RzIGhlcm9lc1xyXG5cdFx0ZW50aXR5LmF0dGFja19yYW5nZSA9IDg7IC8vZGlzdGFuY2UgYXQgd2hpY2ggaHllbmEgbGVhcHMgYXQgdGhlIGhlcm9cclxuXHRcdFxyXG5cdFx0ZW50aXR5LmhpdF90YWtlbiA9IGZhbHNlOyAvL3doZXRoZXIgYSBoaXQgaGFzIGJlZW4gdGFrZW4gc2luY2UgdGhlIGxhc3QgdGlja1xyXG5cdFx0ZW50aXR5LmRhbWFnZV90YWtlbiA9IDA7IC8vdGhlIGFtb3VudCBvZiBkYW1hZ2UgaW5mbGljdGVkIGJ5IGhpdHMgc2luY2UgdGhlIGxhc3QgdGlja1xyXG5cdFx0XHJcblx0XHRlbnRpdHkuZGlyZWN0aW9uID0gZmFsc2U7XHQvL2ZhbHNlPWxlZnQsIHRydWU9cmlnaHQ7XHJcblx0XHRlbnRpdHkuZGlyZWN0aW9uX3ByZXZpb3VzID0gZmFsc2U7Ly9zdG9yZSBkaXJlY3Rpb24gZnJvbSBlbmQgb2YgcHJldmlvdXMgdGlja1xyXG5cdFx0ZW50aXR5LnhfcHJldmlvdXMgPSAwO1x0XHQvL3N0b3JlIHggdmFsdWUgZnJvbSBlbmQgb2YgcHJldmlvdXMgdGlja1xyXG5cdFx0XHJcblx0XHRlbnRpdHkuaXNfaWRsZSA9IHRydWU7IC8vZGV0ZXJtaW5lcyB3aGV0aGVyIGh5ZW5hIGlzIGFnZ3Jlc3NpdmUgb3IgaWRsZVxyXG5cdFx0ZW50aXR5LmlkbGVfZHVyYXRpb24gPSA0MDsgLy8gdGltZSBidWZmZXIgYmV0d2VlbiBjaGFuZ2luZyBpZGxlIHN0YXRlc1xyXG5cdFx0ZW50aXR5LmlkbGVfdGltZXIgPSBlbnRpdHkuaWRsZV9kdXJhdGlvbjtcclxuXHRcdGVudGl0eS5pZGxlX2NvdW50ZXIgPSAwOyAvL3VzZWQgdG8gbWFuYWdlIHRoZSBudW1iZXIgb2YgdGltZXMgdGhlIGh5ZW5hIGhhcyBjaGFuZ2VkIHN0YXRlIHdoaWxlIGlkbGVcclxuXHRcdGVudGl0eS5pc19hbGl2ZSA9IHRydWU7IC8vZGlzYWJsZXMgYXR0YWNraW5nIGFuZCBwbGF5cyBkZWF0aCBhbmltYXRpb24gd2hpbGUgZmFsc2VcclxuXHRcdGVudGl0eS5kZWF0aF9kdXJhdGlvbiA9IDMwOy8vdGltZSBiZXR3ZWVuIGRlYXRoIGFuZCBkZWxldGlvblxyXG5cdFx0ZW50aXR5LmRlY2F5X2R1cmF0aW9uID0gMjA7Ly90aW1lIGJldHdlZW4gZGVjYXkgYW5pbWF0aW9uIGFuZCBkZWxldGlvblxyXG5cdFx0ZW50aXR5LmRlYXRoX3RpbWVyID0gLTE7XHJcblx0XHRlbnRpdHkucnVubmluZ19hd2F5ID0gZmFsc2U7IC8vd2hldGhlciB0aGUgaHllbmEgaXMgcnVubmluZyBhd2F5XHJcblx0XHRlbnRpdHkucnVuX2F3YXlfZHVyYXRpb24gPSAzMDsgLy9zZXQgY293YXJkaWNlIGxldmVsXHJcblx0XHRlbnRpdHkucnVuX2F3YXlfdGltZXIgPSAtMTtcclxuXHRcdGVudGl0eS5jYW5fYXR0YWNrID0gdHJ1ZTtcdC8vd2hldGhlciBhdHRhY2tpbmcgaXMgZW5hYmxlZFxyXG5cdFx0ZW50aXR5LmF0dGFja19jb29sZG93biA9IDEwOyAvL2F0dGFjayBjb29sZG93blxyXG5cdFx0ZW50aXR5LmF0dGFja19jb29sZG93bl90aW1lciA9IC0xO1xyXG5cdFx0ZW50aXR5LmNhbl9sZWFwID0gdHJ1ZTtcdFx0Ly9sZWFwaW5nIGVuYWJsZWRcclxuXHRcdGVudGl0eS5sZWFwX2Nvb2xkb3duID0gNDA7Ly9taW5pbXVtIHRpbWUgYmV0d2VlbiBsZWFwc1xyXG5cdFx0ZW50aXR5LmxlYXBfY29vbGRvd25fdGltZXIgPSAtMTsgXHJcblx0XHRlbnRpdHkuY2hhcmdlX2R1cmF0aW9uID0gODA7Ly9tYXhpbXVtIGxlbmd0aCBvZiBhIGNoYXJnZVxyXG5cdFx0ZW50aXR5LmNoYXJnZV90aW1lciA9IGVudGl0eS5jaGFyZ2VfZHVyYXRpb247XHJcblx0XHRlbnRpdHkuY2hhcmdlX2Nvb2xkb3duID0gMjA7Ly9taW5pbXVtIHRpbWUgYmV0d2VlbiBjaGFyZ2VzXHJcblx0XHRlbnRpdHkuY2hhcmdlX2Nvb2xkb3duX3RpbWVyID0gLTE7XHJcblx0XHRlbnRpdHkuYmxpbmtpbmcgPSBmYWxzZTtcdC8vd2hldGhlciBoeWVuYSBpcyBibGlua2luZ1xyXG5cdFx0ZW50aXR5LmJsaW5rX2R1cmF0aW9uID0gMjA7Ly9ob3cgbG9uZyB0aGUgaHllbmEgYmxpbmtzIGFmdGVyIHRha2luZyBkYW1hZ2VcclxuXHRcdGVudGl0eS5ibGlua190aW1lciA9IC0xO1xyXG5cdFx0ZW50aXR5Lm1haW50ZW5hbmNlX2ZyZXF1ZW5jeSA9IDIwOy8vdGlja3MgYmV0d2VlbiByb3V0aW5lIG1haW50ZW5hbmNlIGNoZWNrc1xyXG5cdFx0ZW50aXR5Lm1haW50ZW5hbmNlX3RpbWVyID0gZW50aXR5Lm1haW50ZW5hbmNlX2ZyZXF1ZW5jeTtcclxuXHRcdFxyXG5cdFx0ZW50aXR5LmJhcmVseV9vYnN0cnVjdGVkID0gZmFsc2U7XHJcblx0XHRlbnRpdHkuY29sbGlzaW9uX2J1ZmZlciA9IDAuMlx0Ly90aGUgcmVnaW9uIG9mIG92ZXJsYXAgYWNjb3VudGVkIGZvciBkdXJpbmcgY29sbGlzaW9uIGNoZWNraW5nXHJcblx0XHRlbnRpdHkucGF0aF9ibG9ja2VkID0gZmFsc2U7XHQvL2lzIGVudGl0eSBkZXByZWNhdGVkPyBzZXQgZHVyaW5nIGNvbGxpc2lvblxyXG5cdFx0ZW50aXR5Lm9ic3RydWN0aW9uX3RvbGVyYW5jZSA9IDQ7Ly9ob3cgbWFueSB0aW1lcyB0aGUgaHllbmEgY2FuIGJlIGJsb2NrZWQgYmVmb3JlIGhlIHRha2VzIGFjdGlvblxyXG5cdFx0ZW50aXR5LmJsb2NrZWRfY291bnQgPSAwO1x0XHRcdC8vdHJhY2tzIG51bWJlciBvZiB0aW1lcyBibG9ja2VkIGJldHdlZW4gbWFpbnRlbmFuY2UgY2hlY2tzXHJcblx0XHRcclxuXHRcdGVudGl0eS5uZWVkc19ncmFwaGljc191cGRhdGUgPSBmYWxzZTsgLy9hY2Nlc3NlZCBieSByZW5kZXJlciBmb3IgYW5pbWF0aW9uIHB1cnBvc2VzXHJcblx0XHRlbnRpdHkuYW5pbWF0aW9uID0gXCJzdGFuZFwiOyAvL2FjY2Vzc2VkIGJ5IHJlbmRlcmVyIGZvciBhbmltYXRpb24gcHVycG9zZXNcclxuXHRcdFxyXG5cdFx0cmV0dXJuIGVudGl0eTtcclxuXHR9O1xyXG5cclxuXHQvL0luaXRpYWxpemUgY2xhc3MgdmFyaWFibGVzLCBjYWxsZWQgb25jZSBpbiBFbnRpdHlDb250cm9sbGVyLmluaXQoKSBkdXJpbmcgZ2FtZSBsb2FkXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0aW5jbHVkZSgpOyAvLyBzYXRpc2Z5IHJlcXVpcmVtZW50cywgR09FUyBGSVJTVFxyXG5cdFx0SWRlbnRpZmljYXRpb25Db250cm9sbGVyLmFzc2lnbl90eXBlKEh5ZW5hLCBcIkh5ZW5hXCIpOyAvL2Fzc2lnbiBjbGFzcyBpZFxyXG5cdH07XHJcblxyXG5cdC8vSW5zdGFudGlhdGVzIGNsYXNzIEh5ZW5hXHJcblx0Ly9XcmFwcGVyIGZvciBjb25zdHJ1Y3RvciwgYXNzaWducyB1bmlxdWUgSURcclxuXHR2YXIgc3Bhd24gPSBmdW5jdGlvbih4LCB5KXtcclxuXHRcdHZhciBuZXdfaHllbmEgPSBuZXcgSHllbmEoKTtcclxuXHRcdG5ld19oeWVuYS50eXBlID0gXCJIeWVuYVwiO1xyXG5cdFx0dmFyIGlkID0gSWRlbnRpZmljYXRpb25Db250cm9sbGVyLmFzc2lnbl9pZChuZXdfaHllbmEpO1xyXG5cclxuXHRcdG5ld19oeWVuYS5ib2R5ID0gUGh5c2ljc0NvbnRyb2xsZXIuZ2V0X3JlY3Rhbmd1bGFyKHt4OiB4LCB5OiB5LCBib3JkZXJfc2Vuc29yczogdHJ1ZX0sIG5ld19oeWVuYSk7XHRcclxuXHRcdG5ld19oeWVuYS5QaHlzaWNzQ29udHJvbGxlciA9IFBoeXNpY3NDb250cm9sbGVyO1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gbmV3X2h5ZW5hO1xyXG5cdH07XHJcblx0XHJcbi8vLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uQ09NTUVOQ0UuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXFxcXFxyXG4vLy4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uQVJUSUZJQ0lBTC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxcXFxcclxuLy8uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uSFlFTkEuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cXFxcXHJcbi8vLi4uLi4uLi4uLi4uLi4uLi4uLi4uLklOVEVMTElHRU5DRS4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXFxcXFxyXG5cdFxyXG5cdC8vIElzIHJ1biBlYWNoIHRpY2sgZnJvbSB0aGUgRW50aXR5Q29udHJvbGxlci51cGRhdGUgZm9yIGV2ZXJ5IHJlZ2lzdGVyZWQgaW5zdGFuY2VcclxuXHR2YXIgdGlja19BSSA9IGZ1bmN0aW9uKEh5ZW5hKXtcclxuXHRcdC8vQ2hlY2sgaWYgRGVhZC4uLi4uLi4uXHJcblx0XHQvL0lmIEh5ZW5hIGlzIG9mZiB0aGUgc2NyZWVuLCBkZWxldGVcclxuXHRcdGlmIChIeWVuYS5ib2R5LkdldFdvcmxkQ2VudGVyKCkueCA8PSBXb3JsZENvbnRyb2xsZXIuZ2V0X21vdmVtZW50X2VkZ2UoKSArIDEuMTI1KXtcclxuXHRcdFx0SHllbmEuYm9keS5BcHBseUltcHVsc2UobmV3IEIyZC5iMlZlYzIoSHllbmEuanVtcF9mb3JjZSwgMCksIEh5ZW5hLmJvZHkuR2V0V29ybGRDZW50ZXIoKSk7XHJcblx0XHR9XHJcblx0XHRpZiAoSHllbmEuaHAgPD0gMCl7Ly9pZiBtb3J0YWxseSB3b3VuZGVkXHJcblx0XHRcdEh5ZW5hLmRpZShIeWVuYSk7IC8vZGllXHJcblx0XHR9ZWxzZXsgLy8gRG8gTGl2ZSBIeWVuYSBTdHVmZlxyXG5cdFx0XHQvL01haW50ZW5hbmNlLi4uLlxyXG5cdFx0XHRIeWVuYS5kaXJlY3Rpb25fcHJldmlvdXMgPSBIeWVuYS5kaXJlY3Rpb247XHRcdFx0XHQvL3JlbWVtYmVyIHdoYXQgaHllbmEncyBkaXJlY3Rpb24gd2FzIGF0IHN0YXJ0IG9mIHRpY2tcclxuXHRcdFx0SHllbmEueF9wcmV2aW91cyA9IEh5ZW5hLmJvZHkuR2V0V29ybGRDZW50ZXIoKS54OyAvL3JlbWVtYmVyIHdoYXQgaHllbmEncyB4IHdhcyBhdCBzdGFydCBvZiB0aWNrXHJcblx0XHRcdEh5ZW5hLmxlYXBfY29vbGRvd25fdGltZXItLTtcdFx0XHQvL2Vuc3VyZSB0aGUgaHllbmEgaXMgbm90IGV0ZXJuYWxseSBqdW1waW5nXHJcblx0XHRcdC8vbWFpbnRhaW4gYmxpbmtpbmdcclxuXHRcdFx0aWYoSHllbmEuYmxpbmtpbmcpe1xyXG5cdFx0XHRcdEh5ZW5hLmJsaW5rX3RpbWVyLS07XHJcblx0XHRcdFx0aWYoSHllbmEuYmxpbmtfdGltZXIgPT0gMCl7XHJcblx0XHRcdFx0XHRIeWVuYS5ibGlua2luZyA9IGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHQvL21haW50YWluIGF0dGFjayBjb29sZG93blxyXG5cdFx0XHRpZihIeWVuYS5hdHRhY2tfY29vbGRvd25fdGltZXIgPiAwKXsgXHJcblx0XHRcdFx0SHllbmEuYXR0YWNrX2Nvb2xkb3duX3RpbWVyLS07XHJcblx0XHRcdFx0SHllbmEuY2FuX2F0dGFjayA9IChIeWVuYS5hdHRhY2tfY29vbGRvd25fdGltZXIgPT0gMCk7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly9tYWludGFpbiB0aGUgaHllbmEncyBhbHRlcm5hdGluZyBwaGFzZXMgb2YgcnVubmluZyBhbmQgc3RvcHBpbmdcclxuXHRcdFx0aWYoSHllbmEuY2hhcmdlX3RpbWVyIDw9IDApe1xyXG5cdFx0XHRcdEh5ZW5hLmNoYXJnZV9jb29sZG93bl90aW1lci0tO1xyXG5cdFx0XHRcdGlmIChIeWVuYS5jaGFyZ2VfY29vbGRvd25fdGltZXIgPD0gMCl7XHJcblx0XHRcdFx0XHRIeWVuYS5jaGFyZ2VfdGltZXIgPSBIeWVuYS5jaGFyZ2VfZHVyYXRpb247XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vbWFpbnRhaW4gdGhlIGh5ZW5hJ3MgY293YXJkbHkgdGFjdGljc1xyXG5cdFx0XHRpZiAoSHllbmEucnVubmluZ19hd2F5KXtcdC8vaWYgaHllbmEgaXMgZGVsaWJlcmF0ZWx5IHJ1bm5pbmcgYXdheVxyXG5cdFx0XHRcdEh5ZW5hLnJ1bl9hd2F5X3RpbWVyLS07XHQvL3RpY2tkb3duIHJ1bl9hd2F5IHRpbWVyXHJcblx0XHRcdFx0aWYgKEh5ZW5hLnJ1bl9hd2F5X3RpbWVyID09IDApeyAvL21heWJlIHN0b3AgcnVubmluZyBhd2F5XHJcblx0XHRcdFx0XHRIeWVuYS5ydW5fYXdheV90aW1lciA9IC0xO1xyXG5cdFx0XHRcdFx0SHllbmEuZGlyZWN0aW9uID0gSHllbmEuZGlyZWN0aW9uX25lYXJlc3RfZW5lbXkoSHllbmEpO1xyXG5cdFx0XHRcdFx0SHllbmEucnVubmluZ19hd2F5ID0gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vY2hlY2sgcGVyaW9kaWNhbGx5IHRvIGVuc3VyZSB0aGUgaHllbmEgaXMgbm90IHN0dWNrIGluIGEgY29ybmVyIGFuZCBvdGhlciByb3V0aW5lIG1haW50ZW5hbmNlXHJcblx0XHRcdEh5ZW5hLm1haW50ZW5hbmNlX3RpbWVyLS07XHJcblx0XHRcdGlmIChIeWVuYS5tYWludGVuYW5jZV90aW1lciA9PSAwKXtcclxuXHRcdFx0XHRpZiAoSHllbmEucGF0aF9mcmVlKEh5ZW5hKSl7XHJcblx0XHRcdFx0XHRIeWVuYS5wYXRoX2Jsb2NrZWQgPSBmYWxzZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKEh5ZW5hLmJsb2NrZWRfY291bnQgPiBIeWVuYS5vYnN0cnVjdGlvbl90b2xlcmFuY2Upe1x0Ly95b3Uga25vdyBoZSdzIHN0dWNrIG5vd1xyXG5cdFx0XHRcdFx0aWYgKEh5ZW5hLmNhbl9sZWFwKXtcclxuXHRcdFx0XHRcdFx0SHllbmEucGF0aF9ibG9ja2VkID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0bGVhcChIeWVuYSk7XHQvL3RpbWUgdG8ganVtcCBmb3IgaXRcclxuXHRcdFx0XHRcdFx0SHllbmEucGF0aF9ibG9ja2VkID0gZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdEh5ZW5hLmJsb2NrZWRfY291bnQgPSAwO1xyXG5cdFx0XHRcdEh5ZW5hLm1haW50ZW5hbmNlX3RpbWVyID0gSHllbmEubWFpbnRlbmFuY2VfZnJlcXVlbmN5OyAvL3Jlc2V0IGNoZWNrIHRpbWVyXHJcblx0XHRcdH1cclxuXHRcdFx0Ly9SdW4gTWFpbiBBSSBTY3JpcHQuLi4uLlxyXG5cdFx0XHRpZighSHllbmEuaW5fYWlyKEh5ZW5hKSB8fCBIeWVuYS5ib2R5LkdldExpbmVhclZlbG9jaXR5KCkueSA9PSAwKXsgLy9pZiBvbiBncm91bmQgT1IgaWYgd2Ugc3VzcGVjdCBoZSdzIHN0dWNrIG9uIGEgY29ybmVyXHJcblx0XHRcdFx0aWYgKEh5ZW5hLmVuZW15X2luX3JhbmdlKEh5ZW5hLEh5ZW5hLnNpZ2h0X3JhbmdlKSl7IC8vaWYgZW5lbXkgbmVhcmJ5XHJcblx0XHRcdFx0XHRIeWVuYS5pZGxlID0gZmFsc2U7XHJcblx0XHRcdFx0XHRpZiAoSHllbmEuaGl0X3Rha2VuKXtcdC8vaWYgaHllbmEgd2FzIGF0dGFja2VkLFxyXG5cdFx0XHRcdFx0XHRIeWVuYS5ydW5uaW5nX2F3YXkgPSB0cnVlO1x0Ly9iYWNrIG9mZlxyXG5cdFx0XHRcdFx0XHRIeWVuYS5ydW5fYXdheV90aW1lciA9IEh5ZW5hLnJ1bl9hd2F5X2R1cmF0aW9uO1xyXG5cdFx0XHRcdFx0XHRIeWVuYS5kaXJlY3Rpb24gPSAhKEh5ZW5hLmRpcmVjdGlvbik7XHJcblx0XHRcdFx0XHR9ZWxzZSBpZiAoKEh5ZW5hLmVuZW15X2luX3JhbmdlKEh5ZW5hLEh5ZW5hLmF0dGFja19yYW5nZSkgfHwgSHllbmEucGF0aF9ibG9ja2VkKSAmJiBIeWVuYS5jYW5fbGVhcCAmJiBIeWVuYS5sZWFwX2Nvb2xkb3duX3RpbWVyIDw9IDApeyAvL2lmIGVuZW15IGluIHJhbmdlIG9yIHBhdGggaXMgYmxvY2tlZCwgYW5kIGxlYXBpbmcgaXMgZW5hYmxlZCwgbGVhcFxyXG5cdFx0XHRcdFx0XHRIeWVuYS5kaXJlY3Rpb24gPSBIeWVuYS5kaXJlY3Rpb25fbmVhcmVzdF9lbmVteShIeWVuYSk7XHJcblx0XHRcdFx0XHRcdGxlYXAoSHllbmEpO1xyXG5cdFx0XHRcdFx0XHRIeWVuYS5jYW5fbGVhcCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRIeWVuYS5sZWFwX2Nvb2xkb3duX3RpbWVyID0gSHllbmEubGVhcF9jb29sZG93bjtcclxuXHRcdFx0XHRcdFx0SHllbmEuY2hhbmdlX2FuaW1hdGlvbihIeWVuYSxcImxlYXBcIik7XHJcblx0XHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdFx0aWYoIUh5ZW5hLnJ1bm5pbmdfYXdheSAmJiAhSHllbmEuaW5fYWlyKEh5ZW5hKSl7IC8vaWYgaHllbmEgaXNuJ3QgY293ZXJpbmcgb3IgaW4gdGhlIGFpciwgZmFjZSB0aGUgZW5lbXlcclxuXHRcdFx0XHRcdFx0XHRIeWVuYS5kaXJlY3Rpb24gPSBIeWVuYS5kaXJlY3Rpb25fbmVhcmVzdF9lbmVteShIeWVuYSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYgKEh5ZW5hLmNoYXJnZV90aW1lciA+IDApeyAvL2lmIGNoYXJnZSBkdXJhdGlvbiA+IDBcclxuXHRcdFx0XHRcdFx0XHRydW4oSHllbmEpO1xyXG5cdFx0XHRcdFx0XHRcdEh5ZW5hLmNoYW5nZV9hbmltYXRpb24oSHllbmEsXCJydW5cIik7IC8vY2hhcmdlIHRoZSBlbmVteVxyXG5cdFx0XHRcdFx0XHRcdEh5ZW5hLmNoYXJnZV90aW1lci0tO1xyXG5cdFx0XHRcdFx0XHRcdGlmKEh5ZW5hLmNoYXJnZV90aW1lciA9PSAwKXtcclxuXHRcdFx0XHRcdFx0XHRcdEh5ZW5hLmNoYXJnZV9jb29sZG93bl90aW1lciA9IEh5ZW5hLmNoYXJnZV9jb29sZG93bjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYoSHllbmEueF9wcmV2aW91cyA9PSBIeWVuYS5ib2R5LkdldFdvcmxkQ2VudGVyKCkueCl7IC8vY2hlY2sgaWYgaHllbmEgaGFzIG1vdmVkIHN1Y2Nlc3NmdWxseVxyXG5cdFx0XHRcdFx0XHRcdFx0SHllbmEuYmxvY2tlZF9jb3VudCsrO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fWVsc2V7Ly9lbHNlIHN0YW5kIGFnZ3Jlc3NpdmVseVxyXG5cdFx0XHRcdFx0XHRcdEh5ZW5hLmNoYW5nZV9hbmltYXRpb24oSHllbmEsXCJzdGFuZFwiKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0SHllbmEuaWRsZSA9IHRydWU7IC8vaWRsZSBtb2RlXHJcblx0XHRcdFx0XHRIeWVuYS5pZGxlX3RpbWVyLS07XHJcblx0XHRcdFx0XHRpZiAoSHllbmEuaWRsZV90aW1lciA9PSAwKXtcclxuXHRcdFx0XHRcdFx0SHllbmEuaWRsZV90aW1lciA9IEh5ZW5hLmlkbGVfZHVyYXRpb247XHJcblx0XHRcdFx0XHRcdEh5ZW5hLmlkbGVfY291bnRlciA9IChIeWVuYS5pZGxlX2NvdW50ZXIrMSklMjc7XHJcblx0XHRcdFx0XHRcdGlmIChIeWVuYS5pZGxlX2NvdW50ZXIlNCA9PSAwICYmIEh5ZW5hLmlkbGVfY291bnRlciU1ICE9IDApe1xyXG5cdFx0XHRcdFx0XHRcdEh5ZW5hLmRpcmVjdGlvbiA9ICEoSHllbmEuZGlyZWN0aW9uKTsvL3VzZSB3ZWlyZCBtb2R1bG9zIHRvIGdldCByYW5kb20gbG9va2luZyBpZGxlIGJlaGF2aW9yXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmIChIeWVuYS5pZGxlX2NvdW50ZXIlMiA9PSAwIHx8IEh5ZW5hLmlkbGVfY291bnRlciUzID09IDApeyAvL3VzZSB3ZWlyZCBtb2R1bG9zIHRvIGdldCByYW5kb20gbG9va2luZyBpZGxlIGJlaGF2aW9yXHJcblx0XHRcdFx0XHRcdHdhbGsoSHllbmEpO1xyXG5cdFx0XHRcdFx0XHRIeWVuYS5jaGFuZ2VfYW5pbWF0aW9uKEh5ZW5hLFwid2Fsa1wiKTsvL3BhY2VcclxuXHRcdFx0XHRcdFx0aWYoSHllbmEueF9wcmV2aW91cyA9PSBIeWVuYS5ib2R5LkdldFdvcmxkQ2VudGVyKCkueCl7IC8vY2hlY2sgaWYgaHllbmEgaGFzIHdhbmRlcmVkIHN1Y2Nlc3NmdWxseVxyXG5cdFx0XHRcdFx0XHRcdEh5ZW5hLmJsb2NrZWRfY291bnQrKzsgLy9lbHNlIGNoZWNrIGZvciBiZWluZyBzdHVja1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdFx0SHllbmEuY2hhbmdlX2FuaW1hdGlvbihIeWVuYSxcInN0YW5kXCIpOy8vbG9pdGVyXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9ZWxzZXsvL2lmIGluIHRoZSBhaXJcclxuXHRcdFx0XHRpZihIeWVuYS5tb3ZlbWVudF92b2x1bnRhcnkoSHllbmEpKXtcclxuXHRcdFx0XHRcdEh5ZW5hLmNoYW5nZV9hbmltYXRpb24oSHllbmEsXCJsZWFwXCIpOy8vaWYgdm9sdW50YXJ5LCBsZWFwXHJcblx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHRIeWVuYS5jaGFuZ2VfYW5pbWF0aW9uKEh5ZW5hLFwiZmFsbFwiKTsvL2Vsc2UsIGZhbGxcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKEh5ZW5hLmhpdF90YWtlbil7XHJcblx0XHRcdFx0SHllbmEudGFrZV9kYW1hZ2UoSHllbmEpOyAvL2lmIGhpdCwgdGFrZSBkYW1hZ2VcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH07XHJcbi8vLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uRU5ELi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxcXFxcclxuLy8uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5BUlRJRklDSUFMLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXFxcXFxyXG4vLy4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uSU5URUxMSUdFTkNFLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cXFxcXHJcblxyXG5cclxuLy8uLi4uLi4uLi4uLi4uLi4uLi4uLi5IRUxQRVIgRlVOQ1RJT05TLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxyXG5cdFxyXG5cdFxyXG5cdC8vcnVuXHJcblx0dmFyIHJ1biA9IGZ1bmN0aW9uKGh5ZW5hKXtcclxuXHRcdHZhciBib2R5ID0gaHllbmEuYm9keTtcclxuXHRcdHZhciB2ZWxvY2l0eSA9IGJvZHkuR2V0TGluZWFyVmVsb2NpdHkoKTtcclxuXHRcdHZlbG9jaXR5LnggPSBoeWVuYS5zcGVlZCooMipoeWVuYS5kaXJlY3Rpb24tMSk7IC8vbW92ZSBzcGVlZCBpbiBjdXJyZW50IGRpcmVjdGlvblxyXG5cdFx0Ym9keS5TZXRMaW5lYXJWZWxvY2l0eSh2ZWxvY2l0eSk7XHJcblx0XHRib2R5LlNldEF3YWtlKHRydWUpO1xyXG5cdH07XHJcblx0XHJcblx0Ly93YWxrXHJcblx0dmFyIHdhbGsgPSBmdW5jdGlvbihoeWVuYSl7XHJcblx0XHR2YXIgYm9keSA9IGh5ZW5hLmJvZHk7XHJcblx0XHR2YXIgdmVsb2NpdHkgPSBib2R5LkdldExpbmVhclZlbG9jaXR5KCk7XHJcblx0XHR2ZWxvY2l0eS54ID0gaHllbmEuc3BlZWQqKDIqaHllbmEuZGlyZWN0aW9uLTEpLzM7XHJcblx0XHRib2R5LlNldExpbmVhclZlbG9jaXR5KHZlbG9jaXR5KTtcclxuXHRcdGJvZHkuU2V0QXdha2UodHJ1ZSk7XHJcblx0fTtcclxuXHRcclxuXHQvL2xlYXBcclxuXHR2YXIgbGVhcCA9IGZ1bmN0aW9uKGh5ZW5hKXtcclxuXHRcdHZhciBib2R5ID0gaHllbmEuYm9keTtcclxuXHRcdGlmIChoeWVuYS5wYXRoX2Jsb2NrZWQpey8vanVtcCBvdXQgb2YgYSBob2xlIG9yIG92ZXIgYSB3YWxsXHJcblx0XHRcdGJvZHkuQXBwbHlJbXB1bHNlKG5ldyBCMmQuYjJWZWMyKC0xMCsoMjAqaHllbmEuZGlyZWN0aW9uKSwgLTEqaHllbmEuanVtcF9mb3JjZSksIGJvZHkuR2V0V29ybGRDZW50ZXIoKSk7XHJcblx0XHRcdC8vdmFyIGEgPSAoMTAwIC0gKGh5ZW5hLmRpcmVjdGlvbioyMCkpKk1hdGguUEkvMTgwO1xyXG5cdFx0fWVsc2V7IC8vbGVhcCB2aWNpb3VzbHkgYXQgaGVyb1xyXG5cdFx0XHRib2R5LkFwcGx5SW1wdWxzZShuZXcgQjJkLmIyVmVjMigoMipoeWVuYS5qdW1wX2ZvcmNlKmh5ZW5hLmRpcmVjdGlvbikgLSBoeWVuYS5qdW1wX2ZvcmNlLCAtMSpoeWVuYS5qdW1wX2ZvcmNlLzIpLCBib2R5LkdldFdvcmxkQ2VudGVyKCkpO1xyXG5cdFx0XHQvL3ZhciBhID0gTWF0aC5hdGFuKGJvZHkuR2V0V29ybGRDZW50ZXIoKS55IC0gcGNvbmYuaGVyb195LCBib2R5LkdldFdvcmxkQ2VudGVyKCkueCAtIHBjb25mLmhlcm9feCk7XHJcblx0XHR9XHJcblx0XHQvL2JvZHkuQXBwbHlJbXB1bHNlKG5ldyBCMmQuYjJWZWMyKGh5ZW5hLmp1bXBfZm9yY2UqTWF0aC5zaW4oYSksIGh5ZW5hLmp1bXBfZm9yY2UqTWF0aC5jb3MoYSkpLCBib2R5LkdldFdvcmxkQ2VudGVyKCkpO1xyXG5cdFx0aHllbmEuY2FuX2xlYXAgPSBmYWxzZTtcclxuXHR9O1xyXG5cdFxyXG5cclxuLy8uLi4uLi4uLi4uLi4uLi4uLi4uLi4uQ09MTElTSU9OIEhBTkRMRVJTLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uXHJcblx0Ly9jYWxsZWQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgY29sbGlzaW9uXHJcblx0dmFyIGJlZ2luX2NvbnRhY3QgPSBmdW5jdGlvbihjb250YWN0LCBpbmZvKXtcclxuXHRcdHZhciB0eXBlID0gaW5mby5NZS50eXBlO1xyXG5cdFx0dmFyIGh5ZW5hID0gaW5mby5NZS5lbnRpdHk7XHJcblx0XHR2YXIgaHllbmFfeCA9IGh5ZW5hLmJvZHkuR2V0V29ybGRDZW50ZXIoKS54O1xyXG5cdFx0dmFyIGh5ZW5hX3kgPSBoeWVuYS5ib2R5LkdldFdvcmxkQ2VudGVyKCkueDtcclxuXHRcdHZhciBoeWVuYV93ID0gMS4xMjU7IC8vaGFsZiB3aWR0aCBvZiBoeWVuYVxyXG5cdFx0dmFyIGh5ZW5hX2ggPSAwLjg3NTsgLy9oYWxmIHRoZSBoZWlnaHQgb2YgaHllbmFcclxuXHRcdHZhciBvdGhlcl94ID0gaW5mby5UaGVtLmVudGl0eS5ib2R5LkdldFdvcmxkQ2VudGVyKCkueDtcclxuXHRcdHZhciBvdGhlcl95ID0gaW5mby5UaGVtLmVudGl0eS5ib2R5LkdldFdvcmxkQ2VudGVyKCkueTtcclxuXHRcdHZhciBvdGhlcl93ID0gaHllbmEuZ2V0X2ZpeHR1cmUoaW5mby5UaGVtLmVudGl0eSxcIm1haW5cIikuR2V0QUFCQigpLkdldEV4dGVudHMoKS54O1xyXG5cdFx0dmFyIG90aGVyX2ggPSBoeWVuYS5nZXRfZml4dHVyZShpbmZvLlRoZW0uZW50aXR5LFwibWFpblwiKS5HZXRBQUJCKCkuR2V0RXh0ZW50cygpLnk7XHJcblx0XHRcclxuXHRcdC8qKlxyXG5cdFx0KGh5ZW5hX3cgKyBvdGhlcl93ICsgYnVmZmVyKSA9IG1pbmltdW0gaG9yaXpvbnRhbCBkaXN0YW5jZSBmb3Igbm9uLXZlcnRpY2FsbHkgc3RhY2tlZCBlbnRpdGllc1xyXG5cdFx0YWJzKHRoZW0ueCAtIG1lLngpID0gYWJzb2x1dGUgaG9yaXpvbnRhbCBkaXN0YW5jZVxyXG5cdFx0KGFic19oZGlzdGFuY2UgPCBtaW5faGRpc3RhbmNlKSBpbXBsaWVzIHZlcnRpY2FsIHN0YWNraW5nXHJcblx0XHRcclxuXHRcdChoeWVuYV9oICsgb3RoZXJfaCArIGJ1ZmZlcikgPSBtaW5pbXVtIHZlcnRpY2FsIGRpc3RhbmNlIGZvciBub24tYWRqYWNlbnQgZW50aXRpZXNcclxuXHRcdChhYnNfdmRpc3RhbmNlIDwgbWluX3ZkaXN0YW5jZSkgaW1wbGllcyBhZGphY2VuY3lcclxuXHRcdFxyXG5cdFx0KGh5ZW5hLnggLSBvdGhlci54KSA8IDAgaWYgKGh5ZW5hLnggPCBvdGhlci54KVxyXG5cdFx0KGh5ZW5hLnggLSBvdGhlci54KSA9IDAgaWYgKGh5ZW5hLnggPSBvdGhlci54KVxyXG5cdFx0KGh5ZW5hLnggLSBvdGhlci54KSA+IDAgaWYgKGh5ZW5hLnggPiBvdGhlci54KVxyXG5cdFx0c21hbGxlciB4IGlzIHRvIHRoZSBsZWZ0IG9mIGJpZ2dlciB4XHJcblx0XHRzbWFsbGVyIHkgaXMgYWJvdmUgYmlnZ2VyIHlcclxuXHRcdDAgPSBsZWZ0O1xyXG5cdFx0MSA9IHJpZ2h0O1xyXG5cdFx0KChoeWVuYS54IC0gb3RoZXIueCkgPiAwKSByZXR1cm5zIHRydWUgaWYgaHllbmEgaXMgdG8gdGhlIHJpZ2h0IG9mIHRoZSBlbmVteSwgZWxzZSBmYWxzZVxyXG5cdFx0KChoeWVuYS54IC0gb3RoZXIueCkgPCAwKSByZXR1cm5zIHRydWUgaWYgb3RoZXIgaXMgdG8gdGhlIHJpZ2h0IG9mIGh5ZW5hLCBlbHNlIGZhbHNlXHJcblx0XHRcclxuXHRcdCgoaHllbmEueSAtIG90aGVyLnkpID4gMCkgcmV0dXJucyB0cnVlIGlmIGh5ZW5hIGlzIGJlbG93IHRoZSBlbmVteSAoaHllbmFfeSA+IG90aGVyX3kpLCBlbHNlIGZhbHNlXHJcblx0XHQoKGh5ZW5hLnkgLSBvdGhlci55KSA8IDApIHJldHVybnMgdHJ1ZSBpZiBvdGhlciBpcyBhYm92ZSBoeWVuYShoeWVuYV95IDwgb3RoZXJfeSksIGVsc2UgZmFsc2VcclxuXHRcdCovXHJcblx0XHRcclxuXHRcdC8vdWx0aW1hdGUgY29sbGlzaW9uIGRldGVjdG9yXHJcblx0XHRpZiAoaW5mby5NZS5maXh0dXJlX25hbWUgPT0gXCJtYWluXCIpe1xyXG5cdFx0XHQvL2lmIGFkamFjZW50XHJcblx0XHRcdGlmIChNYXRoLmFicyhoeWVuYV95IC0gb3RoZXJfeSkgPCAoaHllbmFfaCArIG90aGVyX2ggLSBoeWVuYS5jb2xsaXNpb25fYnVmZmVyKSl7IC8vaWYgYWRqYWNlbnRcclxuXHRcdFx0XHRpZiAoKGh5ZW5hX2grb3RoZXJfaCkgLSAob3RoZXJfeS1oeWVuYV95KSA8IGh5ZW5hLmNvbGxpc2lvbl9idWZmZXIpey8vaWYgdGhlIGh5ZW5hIGlzIGNsb3NlIGVub3VnaCB0byB0aGUgdG9wIHRoYXQgaGUgY291bGQgYWxtb3N0IHdhbGsgb3ZlciBpdC4uLlxyXG5cdFx0XHRcdFx0aHllbmEuYmFyZWx5X29ic3RydWN0ZWQgPSB0cnVlOy8vY2FsbCBmb3IgYSB0aW55IGJ1bXBcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdGh5ZW5hLmJsb2NrZWRfY291bnQrKzsgLy9lbHNlIGNhbGwgZm9yIGEgcmVhbCBqdW1wXHJcblx0XHRcdFx0XHRoeWVuYS5wYXRoX2Jsb2NrZWQgPSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoaW5mby5UaGVtLnR5cGUgPT0gXCJoZXJvXCIpey8vaWYgb3RoZXIgPSBoZXJvLCBkZWFsIGRhbWFnZVxyXG5cdFx0XHRcdFx0aWYoaHllbmEuY2FuX2F0dGFjayl7XHJcblx0XHRcdFx0XHRcdGh5ZW5hLmF0dGFja19jb29sZG93bl90aW1lciA9IGh5ZW5hLmF0dGFja19jb29sZG93bjsvL3NldCBjb29sZG93biB0aW1lclxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0Ly9pZiBvdGhlciBpcyBiZWxvd1xyXG5cdFx0XHRcdGlmKHRydWUpe31cclxuXHRcdFx0XHRcdC8vcmVzZXQganVtcFxyXG5cdFx0XHRcdFx0Ly9pZiBoZXJvLCBkZWFsIGRhbWFnZVxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdC8vaWYgb3RoZXIgaXMgYWJvdmU6XHJcblx0XHRcdFx0XHQvL2lmIGhlcm8sIHRha2UgZGFtYWdlXHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0dmFyIHZ1bG5lcmFiaWxpdHlfcmFkaXVzID0gKDEuMTI1ICsgMC40NSAtIDAuMyk7Ly8gaHllbmFfd2lkdGgvMiArIGhlcm9fd2lkdGgvMiAtIGJ1ZmZlciwgaW4gbWV0ZXJzXHJcblx0XHQvL2lmIGJvdHRvbSBjb2xsaWRpbmcgd2l0aCB0aGUgZ3JvdW5kIG9yIHRvcCBvZiBhbm90aGVyIG9iamVjdCwgZW5hYmxlIGxlYXBcclxuXHRcdGlmIChpbmZvLk1lLmZpeHR1cmVfbmFtZSA9PSBcImJvdHRvbVwiICYmIChpbmZvLlRoZW0uZml4dHVyZV9uYW1lID09IFwidG9wXCIgfHwgaW5mby5UaGVtLmVudGl0eS5raW5kID09IDEgfHwgaW5mby5UaGVtLmVudGl0eS5raW5kID09IDIpKXtcclxuXHRcdFx0aHllbmEuY2FuX2xlYXAgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvL2lmIGNvbGxpZGluZyB3aXRoIGEgd2FsbCwgZGV0ZWN0IGJsb2NrZWQgcGF0aFxyXG5cdFx0aWYgKChpbmZvLk1lLmZpeHR1cmVfbmFtZSA9PSBcImxlZnRcIiAmJiAhaHllbmEuZGlyZWN0aW9uKXx8KGluZm8uTWUuZml4dHVyZV9uYW1lID09IFwicmlnaHRcIiAmJiBoeWVuYS5kaXJlY3Rpb24pKXtcclxuXHRcdFx0aHllbmEucGF0aF9ibG9ja2VkID0gdHJ1ZTtcclxuXHRcdFx0aHllbmEuYmxvY2tlZF9jb3VudCsrO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvL2lmIGNvbGxpZGluZyB3aXRoIGEgcGxheWVyLCBjaGVjayBmb3IgZGFtYWdlXHJcblx0XHRpZihpbmZvLlRoZW0udHlwZSA9PSBcImhlcm9cIil7XHJcblx0XHRcdGlmKGluZm8uVGhlbS5maXh0dXJlX25hbWUgIT0gXCJib3R0b21cIil7IC8vaWYgY2FuX2F0dGFjayBhbmQgY29sbGlkaW5nIHdpdGggYSBmaXh0dXJlIG90aGVyIHRoYW4gXCJib3R0b21cIlxyXG5cdFx0XHRcdGlmKGh5ZW5hLmNhbl9hdHRhY2spe1xyXG5cdFx0XHRcdFx0aHllbmEuYXR0YWNrX2Nvb2xkb3duX3RpbWVyID0gaHllbmEuYXR0YWNrX2Nvb2xkb3duOy8vc2V0IGNvb2xkb3duIHRpbWVyXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9ZWxzZSBpZihNYXRoLmFicyhpbmZvLlRoZW0uZW50aXR5LmJvZHkuR2V0V29ybGRDZW50ZXIoKS54IC0gaHllbmEuYm9keS5HZXRXb3JsZENlbnRlcigpLngpIDwgdnVsbmVyYWJpbGl0eV9yYWRpdXMgJiYgIWh5ZW5hLmJsaW5raW5nKXtcclxuXHRcdFx0XHRoeWVuYS5oaXRfdGFrZW4gPSB0cnVlOy8vdGFrZSBkYW1hZ2UgaWYgZW5lbXkgY29sbGlkZXMgZnJvbSBhYm92ZSBhbmQgZGlzdGFuY2UgPCB2dWxuZXJhYmlsaXR5IHJhZGl1c1xyXG5cdFx0XHRcdGh5ZW5hLmRhbWFnZV90YWtlbiA9IGluZm8uVGhlbS5lbnRpdHkuZGFtYWdlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0Ly9jYWxsZWQgdXBvbiBlbmQgb2YgY29sbGlzaW9uXHJcblx0dmFyIGVuZF9jb250YWN0ID0gZnVuY3Rpb24oY29udGFjdCwgaW5mbyl7XHJcblx0XHRcclxuXHR9O1xyXG5cclxuXHJcbi8vLi4uLi4uLi4uLi4uLi4uLi5ERUNMQVJFIFBVQkxJQyBGVU5DVElPTlMuLi4uLi4uLi4uLi4uLi4uLi4uLi5cclxuXHRyZXR1cm4ge1xyXG5cdFx0aW5pdDogaW5pdCwgXHJcblx0XHRzcGF3bjogc3Bhd24sXHJcblx0XHR0aWNrX0FJOiB0aWNrX0FJLFxyXG5cdFx0YmVnaW5fY29udGFjdDogYmVnaW5fY29udGFjdCxcclxuXHRcdGVuZF9jb250YWN0OiBlbmRfY29udGFjdCxcclxuXHR9O1xyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBIeWVuYUxvZ2ljO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiSHllbmFMb2dpY1wiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuTE9HSUNfU1BFQ0lGSUNcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG4iLCJ2YXIgQXNzZXRNb2RlbCA9IG5ldyBmdW5jdGlvbigpe1xyXG5cdC8vIEFzIGFsd2F5cywgYWxtb3N0IGFueXRoaW5nIGlzIGluaXRpYWxpemVkIGluIHRoZSBJbml0Q29udHJvbGxlclxyXG5cdFxyXG5cdHRoaXMubG9hZGVyO1xyXG5cclxuXHR0aGlzLm1hbmlmZXN0ID0gWyAvLyBkZWZpbmluZyByZXNvdXJjZXMgdG8gYmUgbG9hZGVkIGluIGJ1bGsgd2l0aCBwcmVsb2FkLmpzXHJcblx0XHRcdHtzcmM6IFwiZ3JlZWtfd2Fycmlvci5wbmdcIiwgaWQ6IFwiZ3JlZWtfd2FycmlvclwifSxcclxuXHRcdFx0Ly97c3JjOiwgaWQ6fSxcclxuXHRcdFx0e3NyYzogXCJtaWRkbGVfdGVycmFpbi5wbmdcIiwgaWQ6XCJtaWRkbGVfdGVycmFpblwifSxcclxuXHRcdFx0e3NyYzogXCJib3R0b21fdGVycmFpbi5wbmdcIiwgaWQ6IFwiYm90dG9tX3RlcnJhaW5cIn0sXHJcblx0XHRcdHtzcmM6IFwiZ3Jhc3Nfc3VtbWVyLnBuZ1wiLCBpZDogXCJncmFzc19zdW1tZXJcIiB9LFxyXG5cdFx0XHR7c3JjOiBcImdyYXNzX3dpbnRlci5wbmdcIiwgaWQ6IFwiZ3Jhc3Nfd2ludGVyXCIgfSxcclxuXHRcdFx0e3NyYzogXCJncmFzc19mYWxsLnBuZ1wiLCBpZDogXCJncmFzc19mYWxsXCIgfSxcclxuXHRcdFx0e3NyYzogXCJncmFzc19zcHJpbmcucG5nXCIsIGlkOiBcImdyYXNzX3NwcmluZ1wiIH0sXHJcblx0XHRcdHtzcmM6IFwiQW50Q2hvbXBlcnMucG5nXCIsIGlkOiBcIkFudDFcIn0sXHJcblx0XHRcdHtzcmM6IFwiQW50Q2hvbXBlcnMyLnBuZ1wiLCBpZDogXCJBbnQyXCJ9LFxyXG5cdFx0XHR7c3JjOiBcIkFudENob21wZXJzRGVhdGgucG5nXCIsIGlkOiBcIkFudDNcIn0sXHJcblx0XHRcdHtzcmM6IFwiR3JlZWsgTGFuZHNjYXBlIGZhbGwucG5nXCIsIGlkOiBcIkZhbGxcIn0sXHJcblx0XHRcdHtzcmM6IFwiR3JlZWsgTGFuZHNjYXBlIHNwcmluZy5wbmdcIiwgaWQ6IFwiU3ByaW5nXCJ9LFxyXG5cdFx0XHR7c3JjOiBcIkdyZWVrIExhbmRzY2FwZSB3aW50ZXIucG5nXCIsIGlkOiBcIldpbnRlclwifSxcclxuXHRcdFx0e3NyYzogXCJHcmVlayBMYW5kc2NhcGUgc3VtbWVyLnBuZ1wiLCBpZDogXCJTdW1tZXJcIn0sXHJcblx0XHRcdHtzcmM6IFwiZ3JpZmZpblBoYXNlMVNtYWxsLnBuZ1wiLCBpZDogXCJHcmlmZmluMVwiIH0sXHJcblx0XHRcdHtzcmM6IFwiZ3JpZmZpblBoYXNlMlNtYWxsLnBuZ1wiLCBpZDogXCJHcmlmZmluMlwiIH0sXHJcblx0XHRcdHtzcmM6IFwiZ3JpZmZpblBoYXNlM1NtYWxsLnBuZ1wiLCBpZDogXCJHcmlmZmluM1wiIH0sXHJcblx0XHRcdHsgc3JjOiBcImdyaWZmaW5EZWF0aFNtYWxsLnBuZ1wiLCBpZDogXCJHcmlmZmluRGVhdGhcIiB9LFxyXG4gICAgICAgICAgICB7IHNyYzogXCJncmlmZmluRGVhdGhTbWFsbDIucG5nXCIsIGlkOiBcIkdyaWZmaW5EZWF0aDJcIiB9LFxyXG4gICAgICAgICAgICB7IHNyYzogXCJncmlmZmluRGVhdGhTbWFsbDMucG5nXCIsIGlkOiBcIkdyaWZmaW5EZWF0aDNcIiB9LFxyXG5cdFx0XHR7c3JjOiBcInBsYXRmb3JtX2xlZnQucG5nXCIsIGlkOiBcImxlZnRfcGxhdGZvcm1cIiB9LFxyXG5cdFx0XHR7c3JjOiBcInBsYXRmb3JtX21pZGRsZS5wbmdcIiwgaWQ6IFwibWlkZGxlX3BsYXRmb3JtXCIgfSxcclxuXHRcdFx0e3NyYzogXCJwbGF0Zm9ybV9yaWdodC5wbmdcIiwgaWQ6IFwicmlnaHRfcGxhdGZvcm1cIiB9LFxyXG5cdFx0XHR7c3JjOiBcIkh5ZW5hUGhhc2U0LnBuZ1wiLCBpZDogXCJIeWVuYVNwcml0ZVwiIH0sXHJcblx0XHRcdHtzcmM6IFwicGxhdGZvcm1fc3Bpa2VzLnBuZ1wiLCBpZDogXCJwbGF0Zm9ybV9zcGlrZXNcIiB9LFxyXG5cdFx0XHR7c3JjOiBcIkhlcm8ucG5nXCIsIGlkOiBcIkhlcm9cIn0sXHJcblx0XHRcdHtzcmM6IFwiSGVyb0hpdFJlZC5wbmdcIiwgaWQ6IFwiSGVyb1JcIn0sXHJcblx0XHRcdHtzcmM6IFwiSGVyb0hpdFdoaXRlLnBuZ1wiLCBpZDogXCJIZXJvV1wifSxcclxuXHJcblxyXG5cdFx0XHRcclxuXHRcdF07IFxyXG5cdFx0Ly8gVE9ETyBtYWtlIGFkZGluZyByZXNvdXJjZXMgZWFzaWVyPyBBdXRvbWF0aWMgbG9hZGluZyBcclxuXHRcdC8vIG9mIGV2ZXJ5dGhpbmcgZnJvbSBhc3NldHMsIGF1dG9tYXRpYyBuYW1lcyBldGMuP1xyXG5cclxuXHR0aGlzLnNoYXBlcyA9IHt9OyAvLyBtYXliZSB0aGlzIGFyZW4ndCBuZWVkZWRcclxuXHJcblx0dGhpcy5iaXRtYXBzID0ge307XHJcblxyXG5cdHRoaXMuYW5pbWF0aW9ucyA9IHt9O1xyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQXNzZXRNb2RlbDtcclxuIiwidmFyIEVudGl0eU1vZGVsID0gZnVuY3Rpb24oKXtcdFxyXG5cdC8vIGFzc29jaWF0ZXMgdHlwZSB3aXRoIHRoZSBBSVxyXG5cdHRoaXMudHlwZV90b19BSSA9IHt9O1xyXG5cclxuXHR0aGlzLmZvcl9sb2dpY191cGRhdGUgPSB7fTsgLy8ga2V5OiB0eXBlLCB2YWx1ZTogdGFibGUgb2Ygb2JqZWN0cyB3aXRoIGlkIGZvciBrZXksIG9iamVjdCBmb3IgdmFsdWVcclxuXHRcclxuXHRcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IEVudGl0eU1vZGVsO1xyXG5cclxuIiwidmFyIEdhbWVNb2RlbCA9IG5ldyBmdW5jdGlvbigpeyAvLyBtYWluIG1vZGVsXHJcbiAgICB0aGlzLnBhdXNlQ291bnRlciA9IDA7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVNb2RlbDtcclxuIiwidmFyIEdyYXBoaWNzTW9kZWwgPSBmdW5jdGlvbigpe1xyXG5cdHRoaXMuc3RhZ2U7IC8vIG1haW4gc3RhZ2UgdG8gd2hlcmUgZXZlcnl0aGluZyB3aWxsIGJlIGRyYXduXHJcblx0Ly8gbm90ZSB0aGF0IGV2ZXJ5IGdyYXBoaWNzIG9iamVjdCBtdXN0IGJlIGF1Z21lbnRlZCB3aXRoXHJcblx0Ly8gdGhlIHJlZmVyZW5jZSB0byB0aGUgY29ycmVzcG9uZGluZyBwaHlzaWNzIG9iamVjdCwgaWYgYW55XHJcblx0dGhpcy5vdGhlcl9wbGF5ZXJzID0gW107IC8vIGFycmF5IG9mIHBsYXllcnMgb3RoZXIgdGhlbiBoZXJvIGZvciBtdWx0aXBsYXllclxyXG5cclxuXHQvLyBhbGwgb2JqZWN0IHJlZ2lzdGVyZWQgZm9yIGNvbnRpbmlvdXMgdXBkYXRlIHRvIG1hdGNoIHRoZWlyIHBoeXNpY2FsIGJvZHlcclxuXHQvLyBwb3NpdGlvbiBcclxuXHR0aGlzLmFsbF9waHlzaWNhbCA9IHt9OyBcclxuXHR0aGlzLnNwZWNpYWxfcmVuZGVyID0ge307IC8vIG1hdGNoZXMgdHlwZSB3aXRoIGFycmF5IG9mIGFsbCBvYmplY3RzIG9mIHRoYXQgdHlwZSB0byBiZSByZW5kZXJlZFxyXG5cclxuXHQvLyBhbGwgc3ByaXRlc2hlZXQgZGVmaW5pdGlvbnMgKGFkZGVkIGF0IHRoZSBpbml0aWFsaXphdGlvbiBzdGFnZVxyXG5cdC8vIGJlY2F1c2UgdGhleSBuZWVkIGFzc2V0cyB0byBiZSBsb2FkZWQpXHJcblx0dGhpcy5zcHJpdGVzaGVldHMgPSB7fTsgXHJcblxyXG5cdHRoaXMuY2FtZXJhID0ge1xyXG5cdFx0Ly8gc2hvdWxkIGJlIGVhc2VsanMgb2JqZWN0IG9yIG51bGxcclxuXHRcdGZvbGxvd2luZzogbnVsbCxcclxuXHJcblx0XHQvLyBpbnRlcm5hbCBjYW1lcmEgaW1wbGVtZW50YXRpb24gdGhpbmcgdG8ga25vdyBob3cgZmFyIHRvIG9mZnNldCBmcm9tIHRoZVxyXG5cdFx0Ly8gaW5pdGlhbCBwb3NpdGlvblxyXG5cdFx0b2Zmc2V0OiB7eDogMCwgeTogMH0sXHJcblxyXG5cdFx0Ly8gdGhlIG9mZnNldCBvZiB0aGUgY2FtZXJhIGZyb20gdGhlIGZvbGxvd2VkIG9iamVjdFxyXG5cdFx0Ly8gZS5nLiBvZmZzZXQgb2Yge3g6IDEwMCwgeTogMTAwfSB3aWxsIGNlbnRlciBjYW1lcmFcclxuXHRcdC8vIDEwMCBwaXhlbHMgdG8gdGhlIHJpZ2h0IGFuZCAxMDAgcGl4ZWxzIGJlbG93IHRoZSBmb2xsb3dlZCBvYmplY3RcclxuXHRcdG9mZnNldF9mcm9tX2ZvbGxvd2VkOiB7IHg6IDQwMCwgeTogLTEwMCB9LFxyXG5cdFx0Ly9vZmZzZXRfZnJvbV9mb2xsb3dlZDoge3g6IDMzMCwgeTogLTIwNX0sIC8vRk9SIEdBTUUgUEFHRVxyXG5cdFx0Ly8gdGhpcyBpcyBjZW50ZXIgb2YgdGhlIHNjcmVlbiBpbiBwaXhlbHMuIGdldHMgZHluYW1pY2FsbHkgcmVjYWxjdWxhdGVkIFxyXG5cdFx0Ly8gZHVyaW5nIHRoZSBjYW1lcmEgdXBkYXRlIHNvIGlmIGl0J3MgZXZlciBjaGFuZ2VkLCBjYW1lcmEgc3RpbGwgd29ya3MgYXMgZXhwZWN0ZWRcclxuXHRcdGNlbnRlcjoge3g6IDAsIHk6IDB9XHJcblxyXG5cdH07XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBuZXcgR3JhcGhpY3NNb2RlbDtcclxuXHJcbiIsInZhciBIVURNb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblx0XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBIVURNb2RlbDtcclxuXHJcbiIsIlxyXG52YXIgSWRlbnRpZmljYXRpb25Nb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblx0XHJcblx0Ly8gbmV4dCB1bmlxdWUgaWQgdG8gYmUgZ2l2ZW4gaWYgbm90IGZyZWUgaWQncyByZW1haW5cclxuXHR0aGlzLm5leHRfaWQgPSAwO1xyXG5cclxuXHQvLyBhcnJheSBvZiBmcmVlIGlkJ3MuIHB1c2ggd2hlbiBmcmVlZCwgcG9wIHdoZW4gZnJlZSBpZCBpcyBuZWVkZWRcclxuXHQvLyBpZiBhcnJheSBpcyBlbXB0eSwgZ2V0IG5leHQgaWQgdXNpbmcgPm5leHRfaWQ8XHJcblx0dGhpcy5mcmVlX2lkcyA9IFtdO1xyXG5cclxuXHQvLyBhcnJheSBtYXRjaGVzIGlkcyB0byB0aGVpciBjb3JyZXNwb25kaW5nIG9iamVjdHNcclxuXHR0aGlzLmlkX21hdGNoaW5nID0gW107XHJcblxyXG5cdC8vIHJlZ2lzdHJ5IG9mIHR5cGVzIHRvIG1ha2Ugc3VyZSB0aGF0IG5vIHR5cGUgaXMgcmVnaXN0ZXJkIHR3aWNlXHJcblx0Ly8gYW5kIGVuYWJsZSBwZW9wbGUgdG8gZ2V0IHRoZSBtb2RlbCBieSB0eXBlIG5hbWVcclxuXHR0aGlzLnR5cGVzID0ge31cclxuXHRcclxuXHQvL2xpc3Qgb2YgaGVyb2VzIGFuZCBjb21wYW5pb25zIHNwYXduZWRcclxuXHR0aGlzLmhlcm87XHJcblx0dGhpcy5jb21wYW5pb25zID0gW107XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBJZGVudGlmaWNhdGlvbk1vZGVsO1xyXG5cclxuXHJcbiIsInZhciBLZXlib2FyZE1vZGVsID0gZnVuY3Rpb24oKXtcclxuXHR0aGlzLmtleXMgPSB7fTtcclxuXHJcblx0dGhpcy50cmFuc2xhdGlvbl90YWJsZXMgPSB7XHJcblx0XHRjb2RlX3RvX25hbWU6IHtcclxuXHRcdFx0ODogICBcImJhY2tzcGFjZVwiLCAvLyAgYmFja3NwYWNlXHJcblx0XHRcdDk6ICAgXCJ0YWJcIiwgLy8gIHRhYlxyXG5cdFx0XHQxMzogIFwiZW50ZXJcIiwgLy8gIGVudGVyXHJcblx0XHRcdDE2OiAgXCJzaGlmdFwiLCAvLyAgc2hpZnRcclxuXHRcdFx0MTc6ICBcImN0cmxcIiwgLy8gIGN0cmxcclxuXHRcdFx0MTg6ICBcImFsdFwiLCAvLyAgYWx0XHJcblx0XHRcdDE5OiAgXCJwYXVzZS9icmVha1wiLCAvLyAgcGF1c2UvYnJlYWtcclxuXHRcdFx0MjA6ICBcImNhcHMgbG9ja1wiLCAvLyAgY2FwcyBsb2NrXHJcblx0XHRcdDI3OiAgXCJlc2NhcGVcIiwgLy8gIGVzY2FwZVxyXG5cdFx0XHQzMzogIFwicGFnZSB1cFwiLCAvLyBwYWdlIHVwLCB0byBhdm9pZCBkaXNwbGF5aW5nIGFsdGVybmF0ZSBjaGFyYWN0ZXIgYW5kIGNvbmZ1c2luZyBwZW9wbGVcclxuXHRcdFx0MzQ6ICBcInBhZ2UgZG93blwiLCAvLyBwYWdlIGRvd25cclxuXHRcdFx0MzU6ICBcImVuZFwiLCAvLyBlbmRcclxuXHRcdFx0MzY6ICBcImhvbWVcIiwgLy8gaG9tZVxyXG5cdFx0XHQzNzogIFwibGVmdCBhcnJvd1wiLCAvLyBsZWZ0IGFycm93XHJcblx0XHRcdDM4OiAgXCJ1cCBhcnJvd1wiLCAvLyB1cCBhcnJvd1xyXG5cdFx0XHQzOTogIFwicmlnaHQgYXJyb3dcIiwgLy8gcmlnaHQgYXJyb3dcclxuXHRcdFx0NDA6ICBcImRvd24gYXJyb3dcIiwgLy8gZG93biBhcnJvd1xyXG5cdFx0XHQ0NTogIFwiaW5zZXJ0XCIsIC8vIGluc2VydFxyXG5cdFx0XHQ0NjogIFwiZGVsZXRlXCIsIC8vIGRlbGV0ZVxyXG5cdFx0XHQ0ODogIFwiMFwiLFxyXG5cdFx0XHQ0OTogIFwiMVwiLFxyXG5cdFx0XHQ1MDogIFwiMlwiLFxyXG5cdFx0XHQ1MTogIFwiM1wiLFxyXG5cdFx0XHQ1MjogIFwiNFwiLFxyXG5cdFx0XHQ1MzogIFwiNVwiLFxyXG5cdFx0XHQ1NDogIFwiNlwiLFxyXG5cdFx0XHQ1NTogIFwiN1wiLFxyXG5cdFx0XHQ1NjogIFwiOFwiLFxyXG5cdFx0XHQ1NzogIFwiOVwiLFxyXG5cdFx0XHQ2NTogIFwiYVwiLFxyXG5cdFx0XHQ2NjogIFwiYlwiLFxyXG5cdFx0XHQ2NzogIFwiY1wiLFxyXG5cdFx0XHQ2ODogIFwiZFwiLFxyXG5cdFx0XHQ2OTogIFwiZVwiLFxyXG5cdFx0XHQ3MDogIFwiZlwiLFxyXG5cdFx0XHQ3MTogIFwiZ1wiLFxyXG5cdFx0XHQ3MjogIFwiaFwiLFxyXG5cdFx0XHQ3MzogIFwiaVwiLFxyXG5cdFx0XHQ3NDogIFwialwiLFxyXG5cdFx0XHQ3NTogIFwia1wiLFxyXG5cdFx0XHQ3NjogIFwibFwiLFxyXG5cdFx0XHQ3NzogIFwibVwiLFxyXG5cdFx0XHQ3ODogIFwiblwiLFxyXG5cdFx0XHQ3OTogIFwib1wiLFxyXG5cdFx0XHQ4MDogIFwicFwiLFxyXG5cdFx0XHQ4MTogIFwicVwiLFxyXG5cdFx0XHQ4MjogIFwiclwiLFxyXG5cdFx0XHQ4MzogIFwic1wiLFxyXG5cdFx0XHQ4NDogIFwidFwiLFxyXG5cdFx0XHQ4NTogIFwidVwiLFxyXG5cdFx0XHQ4NjogIFwidlwiLFxyXG5cdFx0XHQ4NzogIFwid1wiLFxyXG5cdFx0XHQ4ODogIFwieFwiLFxyXG5cdFx0XHQ4OTogIFwieVwiLFxyXG5cdFx0XHQ5MDogIFwielwiLFxyXG5cdFx0XHQ5MTogIFwibGVmdCB3aW5kb3dcIiwgLy8gbGVmdCB3aW5kb3dcclxuXHRcdFx0OTI6ICBcInJpZ2h0IHdpbmRvd1wiLCAvLyByaWdodCB3aW5kb3dcclxuXHRcdFx0OTM6ICBcInNlbGVjdCBrZXlcIiwgLy8gc2VsZWN0IGtleVxyXG5cdFx0XHQ5NjogIFwibnVtcGFkIDBcIiwgLy8gbnVtcGFkIDBcclxuXHRcdFx0OTc6ICBcIm51bXBhZCAxXCIsIC8vIG51bXBhZCAxXHJcblx0XHRcdDk4OiAgXCJudW1wYWQgMlwiLCAvLyBudW1wYWQgMlxyXG5cdFx0XHQ5OTogIFwibnVtcGFkIDNcIiwgLy8gbnVtcGFkIDNcclxuXHRcdFx0MTAwOiBcIm51bXBhZCA0XCIsIC8vIG51bXBhZCA0XHJcblx0XHRcdDEwMTogXCJudW1wYWQgNVwiLCAvLyBudW1wYWQgNVxyXG5cdFx0XHQxMDI6IFwibnVtcGFkIDZcIiwgLy8gbnVtcGFkIDZcclxuXHRcdFx0MTAzOiBcIm51bXBhZCA3XCIsIC8vIG51bXBhZCA3XHJcblx0XHRcdDEwNDogXCJudW1wYWQgOFwiLCAvLyBudW1wYWQgOFxyXG5cdFx0XHQxMDU6IFwibnVtcGFkIDlcIiwgLy8gbnVtcGFkIDlcclxuXHRcdFx0MTA2OiBcIm11bHRpcGx5XCIsIC8vIG11bHRpcGx5XHJcblx0XHRcdDEwNzogXCJhZGRcIiwgLy8gYWRkXHJcblx0XHRcdDEwOTogXCJzdWJ0cmFjdFwiLCAvLyBzdWJ0cmFjdFxyXG5cdFx0XHQxMTA6IFwiZGVjaW1hbCBwb2ludFwiLCAvLyBkZWNpbWFsIHBvaW50XHJcblx0XHRcdDExMTogXCJkaXZpZGVcIiwgLy8gZGl2aWRlXHJcblx0XHRcdDExMjogXCJGMVwiLCAvLyBGMVxyXG5cdFx0XHQxMTM6IFwiRjJcIiwgLy8gRjJcclxuXHRcdFx0MTE0OiBcIkYzXCIsIC8vIEYzXHJcblx0XHRcdDExNTogXCJGNFwiLCAvLyBGNFxyXG5cdFx0XHQxMTY6IFwiRjVcIiwgLy8gRjVcclxuXHRcdFx0MTE3OiBcIkY2XCIsIC8vIEY2XHJcblx0XHRcdDExODogXCJGN1wiLCAvLyBGN1xyXG5cdFx0XHQxMTk6IFwiRjhcIiwgLy8gRjhcclxuXHRcdFx0MTIwOiBcIkY5XCIsIC8vIEY5XHJcblx0XHRcdDEyMTogXCJGMTBcIiwgLy8gRjEwXHJcblx0XHRcdDEyMjogXCJGMTFcIiwgLy8gRjExXHJcblx0XHRcdDEyMzogXCJGMTJcIiwgLy8gRjEyXHJcblx0XHRcdDE0NDogXCJudW0gbG9ja1wiLCAvLyBudW0gbG9ja1xyXG5cdFx0XHQxNDU6IFwic2Nyb2xsIGxvY2tcIiwgLy8gc2Nyb2xsIGxvY2tcclxuXHRcdFx0MTg2OiBcIjtcIiwgLy8gc2VtaS1jb2xvblxyXG5cdFx0XHQxODc6IFwiPVwiLCAvLyBlcXVhbC1zaWduXHJcblx0XHRcdDE4ODogXCIsXCIsIC8vIGNvbW1hXHJcblx0XHRcdDE4OTogXCItXCIsIC8vIGRhc2hcclxuXHRcdFx0MTkwOiBcIi5cIiwgLy8gcGVyaW9kXHJcblx0XHRcdDE5MTogXCIvXCIsIC8vIGZvcndhcmQgc2xhc2hcclxuXHRcdFx0MTkyOiBcImBcIiwgLy8gZ3JhdmUgYWNjZW50XHJcblx0XHRcdDIxOTogXCJbXCIsIC8vIG9wZW4gYnJhY2tldFxyXG5cdFx0XHQyMjA6IFwiXFxcXFwiLCAvLyBiYWNrIHNsYXNoXHJcblx0XHRcdDIyMTogXCJdXCIsIC8vIGNsb3NlIGJyYWNrZXRcclxuXHRcdFx0MjIyOiBcIidcIiwgLy8gc2luZ2xlIHF1b3RlXHJcblx0XHR9LFxyXG5cclxuXHRcdG1vdmVtZW50OiB7XHJcblx0XHRcdFwibGVmdCBhcnJvd1wiOiBcImxlZnRcIixcclxuXHRcdFx0XCJ1cCBhcnJvd1wiOiBcInVwXCIsXHJcblx0XHRcdFwiZG93biBhcnJvd1wiOiBcImRvd25cIixcclxuXHRcdFx0XCJyaWdodCBhcnJvd1wiOiBcInJpZ2h0XCIsXHJcblx0XHR9LFxyXG5cclxuXHRcdHBhdXNlOiB7XHJcblx0XHQgICAgXCJwXCI6IFwicGF1c2VcIixcclxuXHRcdH0sXHJcblx0XHRcclxuXHRcdGRlYnVnOiB7XHJcblx0XHRcdFwiYVwiOiBcInNwYXduX2FudFwiLFxyXG5cdFx0XHRcInpcIjogXCJzZWFzb25cIixcclxuXHRcdFx0XCJnXCI6IFwic3Bhd25fZ3JpZmZpblwiLFxyXG5cdFx0XHRcInNcIjogXCJuZXdfc2xpY2VcIixcclxuXHRcdFx0XCJoXCI6IFwic3Bhd25faHllbmFcIixcclxuXHRcdH0sXHJcblxyXG5cdH1cclxuXHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBuZXcgS2V5Ym9hcmRNb2RlbDtcclxuXHJcbiIsIlxyXG52YXIgUGh5c2ljc01vZGVsID0gZnVuY3Rpb24oKSB7XHJcblx0XHJcblx0dGhpcy5ncmF2aXR5O1xyXG5cdHRoaXMud29ybGQ7XHJcbiBcclxuXHQvLyBnZXR0aW5nIGNvbnRleHQgb2YgdGhlIGRlYnVnIGNhbnZhcywgZm9yIGJveDJkIHRvIGRyYXcgZGVidWdnaW4gYm94ZXNcclxuXHJcblx0Ly8gdGltZVRvQ292ZXIgaXMgdGhlIHRpbWUgdGhhdCBzaW11bGF0aW9uIG11c3QgY292ZXIgdG8gY2F0Y2ggdXAgdG8gdGhlIHJlYWwgd29ybGQgdGltZTtcclxuXHQvLyBzaW5jZSBjcmVhdGVqcyB0aWNrZXIgaXMgd2hhdCB3ZSB1c2UgZm9yIHRpbWluZywgYW5kIGJveDJkIHRpY2tzXHJcblx0Ly8gbXVzdCBiZSBvZiBjb25zdGFudCBsZW5ndGggYW5kIGluZGVwZW5kZW50IGZyb20gdGhlIGdyYXBoaWNzIGZyYW1lcmF0ZSxcclxuXHQvLyB3ZSBrZWVwIHRyYWNrIG9mIHRpbWUgdGhhdCBwYXNzZWQgc2luY2UgbGFzdCBib3gyZCBzdGVwIGJ5IGFkZGluZyB0aW1lIGRlbHRhc1xyXG5cdC8vIHRvIHRoZSB0aW1lVG9Db3Zlci4gVGhlbiwgd2hlbiB0aW1lVG9Db3ZlciBleGNlZWRzIGRlc2lyZWQgYm94MmQgc3RlcCBsZW5ndGgsXHJcblx0Ly8gd2UgcGVyZm9ybSB0aGUgc3RlcCBhbmQgc3VidHJhY3QgdGhlIGNvcnJlc3BvbmRpbmcgdGltZSBmcm9tIHRoZSB0aW1lVG9Db3ZlcjtcclxuXHQvLyBJZiBhbnl0aGluZyBpcyBzdGlsbCB1bmNsZWFyLCBhc2sgbWUgKEFLKTtcclxuXHRcdHRoaXMudGltZVRvQ292ZXIgPSAwOyBcclxuXHJcblx0dGhpcy5zdGVwX2Ftb3VudDtcclxuXHJcblx0dGhpcy5hd2FpdGluZ19jb250YWN0ID0ge1xyXG5cdFx0UHJlU29sdmU6IHt9LFxyXG5cdFx0UG9zdFNvbHZlOiB7fSxcclxuXHRcdEJlZ2luQ29udGFjdDoge30sXHJcblx0XHRFbmRDb250YWN0OiB7fSxcclxuXHR9O1xyXG5cclxufTsgXHJcblxyXG4vKlxyXG4gKiBQYXJhbWV0ZXJzIGZvciBiMmQgYm9keSBkZWZpbml0aW9uXHJcblx0YWN0aXZlOiB0cnVlXHJcblx0YWxsb3dTbGVlcDogdHJ1ZVxyXG5cdGFuZ2xlOiAwXHJcblx0YW5ndWxhckRhbXBpbmc6IDBcclxuXHRhbmd1bGFyVmVsb2NpdHk6IDBcclxuXHRhd2FrZTogdHJ1ZVxyXG5cdGJ1bGxldDogZmFsc2VcclxuXHRmaXhlZFJvdGF0aW9uOiBmYWxzZVxyXG5cdGluZXJ0aWFTY2FsZTogMVxyXG5cdGxpbmVhckRhbXBpbmc6IDBcclxuXHRsaW5lYXJWZWxvY2l0eTogYjJWZWMyXHJcblx0cG9zaXRpb246IGIyVmVjMlxyXG5cdHR5cGU6IDBcclxuXHR1c2VyRGF0YTogbnVsbFxyXG4qL1xyXG5cclxuLypcclxuICogRml4dHVyZSBkZWZpbml0aW9uIHBhcmFtZXRlcnM6XHJcblx0ZGVuc2l0eTogMFxyXG5cdGZpbHRlcjogYjJGaWx0ZXJEYXRhXHJcblx0ZnJpY3Rpb246IDAuMlxyXG5cdGlzU2Vuc29yOiBmYWxzZVxyXG5cdHJlc3RpdHV0aW9uOiAwXHJcblx0c2hhcGU6IG51bGxcclxuXHR1c2VyRGF0YTogbnVsbFxyXG4gKi9cclxuXHJcbi8vIHJlY3Rhbmd1bGFyXHJcblBoeXNpY3NNb2RlbC5wcm90b3R5cGUucl90ZW1wbGF0ZXMgPSByX3RlbXBsYXRlcyA9IHt9O1xyXG4vLyBjaXJjdWxhclxyXG5QaHlzaWNzTW9kZWwucHJvdG90eXBlLmNfdGVtcGxhdGVzID0gY190ZW1wbGF0ZXMgPSB7fTtcclxuLy8gcG9seWdvbmFsXHJcblBoeXNpY3NNb2RlbC5wcm90b3R5cGUucF90ZW1wbGF0ZXMgPSBwX3RlbXBsYXRlcyA9IHt9O1xyXG5cclxuXHJcblxyXG5yX3RlbXBsYXRlc1tcImRlZmF1bHRcIl0gPSB7XHJcblxyXG5cdC8vc2hhcGU6IFwicmVjdGFuZ2xlXCIsIC8vIGltcGxpZWQgZnJvbSB0aGUgdGVtcGxhdGUgdHlwZVxyXG5cdHg6IDMsXHJcblx0eTogMyxcclxuXHR2eDogMCxcclxuXHR2eTogMCxcclxuXHJcblx0d2lkdGg6IDUsXHJcblx0aGVpZ2h0OiA1LFxyXG5cdGRlbnNpdHk6IDIsXHJcblx0ZnJpY3Rpb246IDEsXHJcblx0cmVzdGl0dXRpb246IDAuMixcclxuXHRpc1NlbnNvcjogZmFsc2UsXHJcblxyXG5cclxuXHRhY3RpdmU6IHRydWUsXHJcblx0YWxsb3dTbGVlcDogdHJ1ZSxcclxuXHRhbmdsZTogMCxcclxuXHRhbmd1bGFyVmVsb2NpdHk6IDAsXHJcblx0YXdha2U6IHRydWUsXHJcblx0YnVsbGV0OiBmYWxzZSxcclxuXHRmaXhlZFJvdGF0aW9uOiBmYWxzZSxcclxuXHR0eXBlOiBcImR5bmFtaWNcIixcclxuXHJcbn07XHJcblxyXG5yX3RlbXBsYXRlcy5saXZpbmcgPSB7XHJcblx0Zml4ZWRSb3RhdGlvbjogdHJ1ZSxcclxuXHRhd2FrZTogdHJ1ZSxcclxuXHRpc1NlbnNvcjogZmFsc2UsXHJcblx0Ly9tb2JleHArK1xyXG59O1xyXG5cclxucl90ZW1wbGF0ZXMudGVycmFpbl9jZWxsID0ge1xyXG5cdHR5cGU6IFwic3RhdGljXCIsXHJcblx0d2lkdGg6IDEsXHJcblx0aGVpZ2h0OiAxLFxyXG5cdGZyaWN0aW9uOiAyLFxyXG5cdC8vbW9iZXhwKytcclxufTtcclxuXHJcbnJfdGVtcGxhdGVzLmhlcm8gPSB7XHJcblx0cGFyZW50OiByX3RlbXBsYXRlcy5saXZpbmcsXHJcblx0d2lkdGg6IDAuOSxcclxuXHRoZWlnaHQ6IDEuNyxcclxuXHRkZW5zaXR5OiA0LjUsXHJcblx0dHlwZTogXCJkeW5hbWljXCIsXHJcblx0Ly9tb2JleHArK1xyXG59O1xyXG5cclxucl90ZW1wbGF0ZXMuYW50ID0ge1xyXG5cdHBhcmVudDogcl90ZW1wbGF0ZXMubGl2aW5nLFxyXG5cdHdpZHRoOiAxLFxyXG5cdGhlaWdodDogMC41LFxyXG5cdHR5cGU6IFwiZHluYW1pY1wiLFxyXG5cdHg6IDQwLFxyXG5cdHk6IDEwLFxyXG5cdC8vbW9iZXhwKytcclxufTtcclxuXHJcbnJfdGVtcGxhdGVzLkdyaWZmaW4gPSB7XHJcblx0cGFyZW50OiByX3RlbXBsYXRlcy5saXZpbmcsXHJcblx0d2lkdGg6IDQsXHJcblx0aGVpZ2h0OiAyLjUsXHJcblx0dHlwZTogXCJkeW5hbWljXCIsXHJcblx0eDogNjUsXHJcblx0eTogMTAsXHJcblx0Ly9tb2JleHArK1xyXG59O1xyXG5cclxucl90ZW1wbGF0ZXMuSHllbmEgPSB7XHJcblx0cGFyZW50OiByX3RlbXBsYXRlcy5saXZpbmcsXHJcblx0d2lkdGg6IDIuMjUsXHJcblx0aGVpZ2h0OiAxLjc1LFxyXG5cdHR5cGU6IFwiZHluYW1pY1wiLFxyXG5cdHg6IDY1LFxyXG5cdHk6IDEwLFxyXG5cdC8vbW9iZXhwKytcclxufTtcclxuXHJcbnJfdGVtcGxhdGVzLnRlc3QgPSB7XHJcblx0d2lkdGg6IDEsXHJcblx0aGVpZ2h0OiAyLFxyXG5cdGZpeGVkUm90YXRpb246IGZhbHNlLFxyXG5cdC8vbW9iZXhwKytcclxufVxyXG5cclxucl90ZW1wbGF0ZXMucGxhdGZvcm0gPSB7XHJcbiAgICB4OiAxMCxcclxuICAgIHk6IDExLFxyXG4gICAgd2lkdGg6IDEwLFxyXG4gICAgaGVpZ2h0OiAuNSxcclxuICAgIHR5cGU6IFwic3RhdGljXCIsXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IFBoeXNpY3NNb2RlbDtcclxuIiwidmFyIFJlZ2lzdGVyQXNNb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblx0XHJcblx0Ly8gcmVnaXN0ZXIgc3R1ZmYgZm9yIG9uZSB0aW1lIGxvb2t1cFxyXG5cdC8vIHRoZSBvbmUgcmVxdWVzdGluZyBzdHVmZiBpcyBzdXBwb3NlZCB0byBwb3AgdGhlIGVhY2ggZXhhbWluZWQgZWxlbWVudFxyXG5cdC8vIHRoZXJlIGlzIG5vIHRpbWVvdXRzIG9yIGF1dG9tYXRpYyBjbGVhbnVwXHJcblx0dGhpcy5zaW1wbGVfb25lX3RpbWVfbG9va3VwID0ge307XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBSZWdpc3RlckFzTW9kZWw7XHJcblxyXG4iLCJ2YXIgVGVycmFpbk1vZGVsID0gZnVuY3Rpb24oKXtcclxuXHQvL1RoaXMgaXMgcGh5c2ljcywgZm9yIGdyYXBoaWNzIGxvb2sgaW50byB0aGUgR3JhcGhpY3NDb250cm9sbGVyL01vZGVsXHJcblx0dGhpcy50ZXJyYWluX3NsaWNlc19xdWV1ZSA9IFtdO1xyXG5cdC8vdGhpcy5uZXdfc2xpY2VzID0gW107XHJcblx0dGhpcy5zZWVkO1xyXG5cclxuXHQvLyBob3cgbWFueSBpbml0aWFsIChub24tcmFuZG9tKSB0ZXJyYWluIHNsaWNlc1xyXG5cdC8vIHdlcmUgZ2VuZXJhdGVkIGFscmVhZHk/XHJcblx0dGhpcy5pbml0aWFsX2dlbmVyYXRlZCA9IDA7XHJcblxyXG5cclxuXHQvLyB1c2VkIHRvIGRldGVybWluZSB4IG9mZnNldCBvZiB0aGUgbmV4dCBzbGljZVxyXG5cdC8vIFRPRE86IHVwZGF0ZSB0aGlzIHdoZW4gdHJ1bHkgaW5maW5pdGUgdGVycmFpbiB3aWxsIGJlIGltcGxlbWVudGVkXHJcblx0dGhpcy5zbGljZV9jb3VudGVyID0gMDtcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBUZXJyYWluTW9kZWw7XHJcbiIsIlRlcnJhaW5TbGljZUNvbmZpZyA9IHJlcXVpcmUgKFwiLi4vQ29uZmlnLmpzXCIpLlRlcnJhaW5TbGljZTtcclxuXHJcbnZhciBUZXJyYWluU2xpY2VNb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblxyXG5cdHRoaXMuU2xpY2UgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyoqXHJcblx0XHQqIHNsaWNlIFwibW9kZWxcIiB0byBiZSBpbnN0YW50aWF0ZWRcclxuXHRcdCovXHJcblx0XHRcclxuXHRcdFxyXG5cdFx0dGhpcy5udW0gPSBUZXJyYWluU2xpY2VDb25maWcubmV4dF9zbGljZV9pZCsrOyAvLyBhdXRvbWF0aWNhbGwgYXNzaWduIGlkIGFuZCBpbmNyZW1lbnQgXHJcblxyXG5cdFx0dGhpcy5ncmlkX2NvbHVtbnMgPSBUZXJyYWluU2xpY2VDb25maWcuZ3JpZF9jb2x1bW5zO1xyXG5cdFx0dGhpcy5ncmlkX3Jvd3MgPSBUZXJyYWluU2xpY2VDb25maWcuZ3JpZF9yb3dzO1xyXG5cdFx0dGhpcy5jZWxsX3cgPSBUZXJyYWluU2xpY2VDb25maWcuY2VsbF93O1xyXG5cdFx0dGhpcy5jZWxsX2ggPSB0aGlzLmNlbGxfdzs7XHJcblx0XHRcclxuXHRcdC8vIGdyaWRbaV1bal0gaXMgdGhlIGVsZW1lbnQgaW4gdGhlIGkncyBjb2x1bW4gYW5kIGoncyByb3dcclxuXHRcdC8vIHRoZSBncmlkIGlzIG1haWQgdG8gbWF0Y2ggdGhlIHNjcmVlbiBjb29yZGluYXRlcyBhbmQgdGhlIGN1cnJlbnQgYm94MmQgY29vcmRpbmF0ZXNcclxuXHRcdC8vIGkuZS4gZ3JpZFswXVswXSBpcyB0aGUgb25lIGluIHRoZSB0b3AgbGVmdCBjb3JuZXIgb2YgdGhlIHRlcnJhaW4gc2xpY2VcclxuXHRcdC8vIGRvIHdlIHdhbnQgdG8gY2hhbmdlIGl0PyB3b3VsZCBpdCBiZSBlYXNpZXIgdG8gZ2VuZXJhdGUgdGVycmFpbiBpZiB3ZSBzdGFydCBhdCB0aGUgYm90dG9tP1xyXG5cdFx0Ly8gaWYgeWVzLCB0aGVuIHdoYXQgbWFrZXMgbW9yZSBzZW5zZSwgY2hhbmdpbmcgY29vcmRpbmF0ZSBzeXN0ZW1zIG9yIGp1c3Qgc3dpdGNoaW5nIGdlbmVyYXRpb25cclxuXHRcdC8vIGxvb3BzIGFyb3VuZD8gZGlzY3Vzc1xyXG5cdFx0Ly9cclxuXHRcdC8vIG5vdGljZSB0aGF0IHRoZSBncmlkIGlzIGEgdGVycmFpbiBnZW5lcmF0aW9uIGRldmljZSBvbmx5LiBvbmNlIHRlcnJhaW4gc2xpY2UgaXMgbG9hZGVkLFxyXG5cdFx0Ly8gYm94MmQgcGh5c2ljcyBzaW11bGF0aW9uIG1heSAoYW5kIHdpbGwpIGdvIG51dHMgb24gaXQsIGNoYW5naW5nIHdoYXRldmVyIGl0IHdhbnRzLFxyXG5cdFx0Ly8gYW5kIGNoYW5nZXMgd29uJ3QgYW55aG93IGJlIHJlZmxlY3RlZCBpbiB0aGUgZ3JpZC4gdG8ga2VlcCB0cmFjayBvZiBhbGwgdGhlIGJvZGllc1xyXG5cdFx0Ly8gaW4gdGhlIHRlcnJhaW4gc2xpY2UsIGlmIHRoYXQgd2lsbCBiZSBuZWVkZWQsIG90aGVyIG1lY2hhbmlzbXMgc2hvdWxkIGJlIHVzZWQuXHJcblx0XHQvLyBpZGVhOiBoYXZlIGEgY29sbGVjdGlvbnMgb2YgYm9kaWVzIGJ5IHR5cGUsIGFuZCBzZXR1cCBzZW5zb3IgY29sbGlzaW9uIGJlYW1zXHJcblx0XHQvLyBhdCB0aGUgdGVycmFpbiBzbGljZXMnIGJvdW5kYXJpZXMgdG8ga2VlcCB0cmFjayBvZiBib2RpZXMgZmx5aW5nIG92ZXIgZnJvbSBvbmVcclxuXHRcdC8vIHRlcnJhaW4gc2xpY2UgdG8gYW5vdGhlci4gQnR3LCBBbGksIEkgaGF0ZSB5b3UgZm9yIG1ha2luZyBtZSB0byB0eXBlIFwidGVycmFpbiBzbGljZVwiXHJcblx0XHQvLyBpbnN0ZWFkIG9mIHRoZSBcImNodW5rXCIgXHJcblx0XHR0aGlzLmdyaWQgPSBbXTtcclxuXHRcdFxyXG5cdFx0dGhpcy5vcmlnaW4gPSB7eDogbnVsbCwgeTogbnVsbH07XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuQ2VsbCA9IGZ1bmN0aW9uKGtpbmQpe1xyXG5cdFx0dGhpcy5raW5kID0ga2luZDtcclxuXHRcdHRoaXMuYm9keTtcclxuXHR9XHJcblxyXG5cdFxyXG59O1xyXG5cclxuVGVycmFpblNsaWNlTW9kZWwucHJvdG90eXBlLmx2bF9wcm9iID0gW1xyXG5cdFs3LCAyLCAxXSxcclxuXHRbMCwgNywgM10sXHJcblx0WzAsIDEsIDldXHJcbl1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IFRlcnJhaW5TbGljZU1vZGVsO1xyXG4iLCJ2YXIgVGVzdE1vZGVsID0gZnVuY3Rpb24oKXtcclxuXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBUZXN0TW9kZWw7XHJcblxyXG4iLCJ2YXIgV29ybGRNb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblx0XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBXb3JsZE1vZGVsO1xyXG5cclxuIiwidmFyIEFudFJlbmRlcmVyID0gKGZ1bmN0aW9uKCl7XHJcblxyXG5cdHZhciBzcHJpdGVzaGVldHMgPSB7fTtcclxuXHR2YXIgYW50X2FuaW1hdGlvbjtcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogaXMgcmFuIGZyb20gR3JhcGhpY3NDb250cm9sbGVyLmluaXQgb25jZSBkdXJpbmcgZ2FtZSBsb2FkaW5nXHJcblx0XHQgXHR1c2UgdGhpcyBmdW5jdGlvbiB0byBjcmVhdGUgc3ByaXRlc2hlZXRzIGFuZCBzdWNoXHJcblx0XHRcdGxpa2Ugc3ByaXRlc2hlZXRzLmZpcnN0ID0gbmV3IGNyZWF0ZWpzLlNwcml0ZXNoZWV0KC4uLik7XHJcblx0XHQqL1xyXG5cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHMsIEdPRVMgRklSU1RcclxuXHRcdHZhciBnZXRfYXNzZXQgPSBBc3NldENvbnRyb2xsZXIuZ2V0X2Fzc2V0O1xyXG5cclxuXHRcdHNwcml0ZXNoZWV0c1tcImFudFwiXSA9IG5ldyBjcmVhdGVqcy5TcHJpdGVTaGVldCh7XHJcblx0XHRcdFwiZnJhbWVyYXRlXCI6IDEsXHJcblx0XHRcdFwiaW1hZ2VzXCI6IFtnZXRfYXNzZXQoXCJBbnQxXCIpLCBnZXRfYXNzZXQoXCJBbnQyXCIpLCBnZXRfYXNzZXQoXCJBbnQzXCIpXSxcclxuXHRcdFx0XCJmcmFtZXNcIjogeyBcInJlZ1hcIjogMywgXCJyZWdZXCI6IDYsIFwiaGVpZ2h0XCI6IDI1LCBcIndpZHRoXCI6IDUwLCBcImNvdW50XCI6IDZ9LFxyXG5cdFx0XHRcImFuaW1hdGlvbnNcIjoge1xyXG5cdFx0XHRcdFwid2Fsa1wiOiBbMCwgMSwgXCJ3YWxrXCJdLFxyXG5cdFx0XHRcdFwidXBzaWRlX2Rvd25cIjogWzIsIDMsIFwidXBzaWRlX2Rvd25cIl0sXHJcblx0XHRcdFx0XCJkZWF0aFwiOiBbNCwgNSwgXCJkZWF0aFwiXVxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cclxuXHR9O1xyXG5cclxuXHR2YXIgcmVnaXN0ZXIgPSBmdW5jdGlvbihlbnRpdHlfYW50KXtcclxuXHRcdC8qIGlzIHJhbiBmb3IgZXZlcnkgZW50aXR5IG9mIHRoaXMgdHlwZSB0aGF0IHdhcyBqdXN0IGNyZWF0ZWQgYW5kIHNob3VsZFxyXG5cdFx0Z2V0IGdyYXBoaWNzIHJlcHJlc2VudGF0aW9uLiBZb3UgYXJlIGdpdmVuIHRoZSBlbnRpdHkgaW5zdGFuY2UgYW5kIGlzIHN1cHBvc2VkXHJcblx0XHR0byBjcmV0ZSBncmFwaGljcyBpbnN0YW5jZSwgYW5kIEdyYXBoaWNzQ29udHJvbGxlci5yZWdfZm9yX3JlbmRlcihncmFwaGljc19pbnN0YW5jZSwgZW50aXR5X2luc3RhbmNlKTsgaXQgXHJcblx0XHQqL1xyXG5cclxuXHRcdGFudF9hbmltYXRpb24gPSBHcmFwaGljc0NvbnRyb2xsZXIucmVxdWVzdF9hbmltYXRlZChzcHJpdGVzaGVldHNbXCJhbnRcIl0sIFwid2Fsa1wiKTtcclxuXHRcdEdyYXBoaWNzQ29udHJvbGxlci5zZXRfcmVnX3Bvc2l0aW9uKGFudF9hbmltYXRpb24sIDAsIDApOyAvLyBjaGFuZ2UgdGhhdCB0byBhZGp1c3Qgc3ByaXRlIHBvc2l0aW9uIHJlbGF0aXZlIHRvIHRoZSBib2R5XHJcblx0XHRHcmFwaGljc0NvbnRyb2xsZXIucmVnX2Zvcl9yZW5kZXIoYW50X2FuaW1hdGlvbiwgZW50aXR5X2FudCk7IC8vIHNldHMgYW50X2FuaW1hdGlvbidzIHBvc2l0aW9uIHRvIHRyYWNrIHRoZSBhbnQncyBwb3NpdGlvbiAodXBkYXRlcyBlYWNoIHRpY2spXHJcblxyXG5cdFx0XHJcblx0fTtcclxuXHJcblx0dmFyIHJlbmRlciA9IGZ1bmN0aW9uKGFudCl7XHJcblx0XHQvKiBcdGlzIHJhbiBlYWNoIHRpY2sgZnJvbSBHcmFwaGljc0NvbnRyb2xsZXIsIGZvciBldmVyeSByZWdpc3RlcmVkIG9iamVjdCBvZiB0aGlzIHR5cGVcclxuXHRcdFx0aXMgZ2l2ZW4gPmdyYXBoaWNzX2luc3RhbmNlPCBwYXJhbWV0ZXIsIHdoaWNoIGlzIGFsc28gc3VwcG9zZWQgdG8gY29udGFpblxyXG5cdFx0XHRwaHlzaWNhbF9pbnN0YW5jZSBwcm9wZXJ0eSBjb250YWluaW5nIGVudGl0eV9pbnN0YW5jZSwgaWYgaXQgd2FzIGF0dGNoZWQgY29ycmVjdGx5XHJcblx0XHQqL1xyXG5cclxuXHRcdGFudF9hbmltYXRlKGFudCk7IFxyXG5cdH07XHJcblx0dmFyIGFudF9hbmltYXRlID0gZnVuY3Rpb24oYW50KXtcclxuXHRcdC8vc2V0IGdyYXBoaWNhbCByZXByZXNlbnRhdGlvbiBiYXNlZCBvbiB0aGUgYW5pbWF0aW9uIHZhcmlhYmxlIGRldGVybWluZWQgYnkgdGhlIEFJXHJcblx0XHQvL3NldCBhbmltYXRpb25cclxuXHRcdGlmKGFudC5waHlzaWNhbF9pbnN0YW5jZS5uZWVkc19ncmFwaGljc191cGRhdGUpe1xyXG5cdFx0XHR2YXIgYW5pbWF0aW9uID0gYW50LnBoeXNpY2FsX2luc3RhbmNlLmFuaW1hdGlvbjtcclxuXHRcdFx0YW50LmdvdG9BbmRQbGF5KGFuaW1hdGlvbilcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly9zZXQgZGlyZWN0aW9uXHJcblx0XHRpZiAoYW50LnBoeXNpY2FsX2luc3RhbmNlLmRpcmVjdGlvbil7IC8vaWYgZGlyZWN0aW9uID09IHJpZ2h0LCBmbGlwIHJpZ2h0XHJcblx0XHRcdGFudC5zY2FsZVggPSAtMTtcclxuXHRcdH1lbHNleyAvL2Vsc2UgZmxpcCBsZWZ0XHJcblx0XHRcdGFudC5zY2FsZVggPSAxO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vc2V0IGFscGhhIGlmIGJsaW5raW5nXHJcblx0XHRpZihhbnQucGh5c2ljYWxfaW5zdGFuY2UuYmxpbmtpbmcgJiYgYW50LnBoeXNpY2FsX2luc3RhbmNlLmJsaW5rX3RpbWVyJTIgPT0gMSl7XHJcblx0XHRcdGFudC5hbHBoYSA9IDA7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0YW50LmFscGhhID0gMTtcclxuXHRcdH1cclxuXHR9O1xyXG5cdC8qXHJcblx0dmFyIGFudF9zcGVjaWFsX3JlbmRlcl90ZW1wID0gZnVuY3Rpb24oYW50KXtcclxuXHRcdFxyXG5cclxuXHRcdFxyXG5cdFx0aWYoYW50LnBoeXNpY2FsX2luc3RhbmNlLkFJX3N0YXRlID09IFwiZGVhdGhcIiYmIGFudC5waHlzaWNhbF9pbnN0YW5jZS5hbGl2ZWZsYWcpe1xyXG5cdFx0XHRhbnQuZ290b0FuZFBsYXkoXCJkZWF0aFwiKTtcclxuXHRcdFx0YW50LnBoeXNpY2FsX2luc3RhbmNlLmFsaXZlZmxhZyA9IGZhbHNlO1xyXG5cdFx0XHRcclxuXHRcdFx0XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoYW50LnBoeXNpY2FsX2luc3RhbmNlLkFJX3N0YXRlID09IFwidXBzaWRlX2Rvd25cIiAmJiBhbnQucGh5c2ljYWxfaW5zdGFuY2UudW5odXJ0ZmxhZylcclxuXHRcdHtcclxuXHRcdFx0YW50LmdvdG9BbmRQbGF5KFwidXBzaWRlX2Rvd25cIik7XHJcblx0XHRcdGFudC5waHlzaWNhbF9pbnN0YW5jZS51bmh1cnRmbGFnID0gZmFsc2U7XHJcblx0XHRcdFxyXG5cdFx0XHRcclxuXHRcdH1cclxuXHRcdGlmKGFudC5waHlzaWNhbF9pbnN0YW5jZS5BSV9zdGF0ZSA9PSBcIndhbGtcIiAmJiBhbnQucGh5c2ljYWxfaW5zdGFuY2Uuc3RhcnRfd2Fsa2luZylcclxuXHRcdHtcclxuXHRcdFx0YW50LmdvdG9BbmRQbGF5KFwid2Fsa1wiKTtcclxuXHRcdFx0Ly9hbnQucGh5c2ljYWxfaW5zdGFuY2UuaHAgKz0gMTtcclxuXHRcdFx0YW50LnBoeXNpY2FsX2luc3RhbmNlLnN0YXJ0X3dhbGtpbmcgPSBmYWxzZTtcclxuXHRcdFx0XHJcblx0XHRcdFxyXG5cdFx0fVxyXG5cclxuXHR9O1xyXG5cdCovXHJcblxyXG5cdHJldHVybiB7XHJcblx0XHQvLyBkZWNsYXJlIHB1YmxpY1xyXG5cdFx0aW5pdDogaW5pdCwgXHJcblx0XHRyZWdpc3RlcjogcmVnaXN0ZXIsXHJcblx0XHRyZW5kZXI6IHJlbmRlcixcclxuXHR9O1xyXG59KSgpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBBbnRSZW5kZXJlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkFudFJlbmRlcmVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5SRU5ERVJFUl9TUEVDSUZJQ1xyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcbiIsInZhciBCYWNrZ3JvdW5kUmVuZGVyZXIgPSAoZnVuY3Rpb24oKXtcclxuXHJcblx0dmFyIHNlYXNvbl9hcnJheTtcclxuXHR2YXIgc2Vhc29uX2ltYWdlO1xyXG5cdHZhciBzZWFzb25fdGhyZXNob2xkO1xyXG5cdFxyXG5cdHZhciBzZWFzb25fcHJvZ3Jlc3M7XHJcblx0dmFyIHNlYXNvbl9wcm9ncmVzc190b19sZXZlbDtcclxuXHR2YXIgaGVyb19jdXJyZW50X2xldmVsO1xyXG5cdFx0XHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0aW5jbHVkZSgpOyAvL3NldHMgdXAgZGVwZW5kZW5jaWVzIE1VU1QgR08gRklSU1RcclxuXHRcdFxyXG5cdFx0c2Vhc29uX2FycmF5ID0gW107Ly9zdG9yZXMgc2Vhc29uIHNwcml0ZXNcclxuXHRcdHNlYXNvbl9pbWFnZSA9IFtcIldpbnRlclwiLCBcIlNwcmluZ1wiLCBcIlN1bW1lclwiLCBcIkZhbGxcIl07XHJcblx0XHRzZWFzb25fdGhyZXNob2xkID0gMjsgLy9TbyBzZWFzb25zIG9ubHkgdXBkYXRlIG9uY2VcclxuXHRcdFxyXG5cdFx0c2Vhc29uX3Byb2dyZXNzID0gMDtcclxuXHRcdHNlYXNvbl9wcm9ncmVzc190b19sZXZlbCA9IDE5OTsvL3NlYXNvbl9pbWFnZVtjeWNsZV0ud2lkdGgqMiArIENvbmZpZy5TQ1JFRU5fVy8yO1xyXG5cdFx0aGVyb19jdXJyZW50X2xldmVsID0gc2Vhc29uX3Byb2dyZXNzX3RvX2xldmVsO1xyXG5cdFx0XHJcblx0XHRnZW5lcmF0ZV9zZWFzb24oXCJXaW50ZXJcIiwgR3JhcGhpY3NDb250cm9sbGVyLmdldF9zdGFnZSgpLmNhbnZhcy53aWR0aCwgMCk7XHJcblx0fTtcclxuXHRcclxuXHR2YXIgcmVuZGVyID0gZnVuY3Rpb24oKXtcclxuXHJcblx0XHRpZihNYXRoLnJvdW5kKFdvcmxkQ29udHJvbGxlci5nZXRfcHJvZ3Jlc3MoKSkgPiBoZXJvX2N1cnJlbnRfbGV2ZWwpe1xyXG5cdFx0XHRzZWFzb25fcHJvZ3Jlc3MrKztcclxuXHRcdFx0aGVyb19jdXJyZW50X2xldmVsICs9IHNlYXNvbl9wcm9ncmVzc190b19sZXZlbDtcclxuXHRcdFx0V29ybGRDb250cm9sbGVyLmluY3JlYXNlX3Njb3JlKHNlYXNvbl9wcm9ncmVzcyo1MDApO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvL1BvdGVudGlhbGx5IGNoYW5nZSBzZWFzb25zIGJhc2VkIG9uIGhlcm8gcHJvZ3Jlc3NcclxuXHRcdGNoYW5nZV9zZWFzb25zKHNlYXNvbl9wcm9ncmVzcyk7XHJcblx0XHRcclxuXHRcdC8vcGVyZm9ybSBwYXJhbGxheCBlZmZlY3Qgd2l0aCBiYWNrZ3JvdW5kXHJcblx0XHRiYWNrZ3JvdW5kX2xvb3AoV29ybGRDb250cm9sbGVyLmdldF9wcm9ncmVzcygpLHNlYXNvbl9wcm9ncmVzcyk7XHJcblx0fTtcclxuXHRcclxuXHQvL0dlbmVyYXRlcyB0aWxlZCBiYWNrZ3JvdW5kIGZvciBzZWFzb25cclxuXHR2YXIgZ2VuZXJhdGVfc2Vhc29uID0gZnVuY3Rpb24oc2Vhc29uX2ltYWdlLCBjYW52YXNfd2lkdGgsIHN0YXJ0KXtcclxuXHRcdGZvcihpPTA7IGk8MzsgaSsrKXsvL2NyZWF0ZSB0aWxlcyAzIGF0IGEgdGltZVxyXG5cdFx0XHR2YXIgc2Vhc29uID0gR3JhcGhpY3NDb250cm9sbGVyLnJlcXVlc3RfYml0bWFwKHNlYXNvbl9pbWFnZSk7XHJcblx0XHRcdHNlYXNvbi5yZWdZIC09IHNlYXNvbi5pbWFnZS5oZWlnaHQvMjtcclxuXHRcdFx0Ly9jcmVhdGUgYSBuZXcgdGlsZSB3aXRoIG9mZnNldFxyXG5cdFx0XHRzZWFzb24ueCA9IHN0YXJ0ICsgaSpzZWFzb24uaW1hZ2Uud2lkdGg7XHJcblx0XHRcdEdyYXBoaWNzQ29udHJvbGxlci5nZXRfc3RhZ2UoKS5hZGRDaGlsZEF0KHNlYXNvbiwgMCk7XHJcblx0XHRcdHNlYXNvbl9hcnJheS5wdXNoKHNlYXNvbik7XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHQvL2NoZWNrcyBmb3IgYW5kIGhhbmRsZXMgcG90ZW50aWFsIHNlYXNvbiBjaGFuZ2VcclxuXHR2YXIgY2hhbmdlX3NlYXNvbnMgPSBmdW5jdGlvbihwcm9ncmVzcyl7XHJcblx0XHR2YXIgZmxhZyA9IGZhbHNlO1xyXG5cdFx0aWYocHJvZ3Jlc3MgPT0gc2Vhc29uX3RocmVzaG9sZCl7IC8vc2Vhc29ucyB3aWxsIGNoYW5nZSBldmVyeSBldmVuIHByb2dyZXNzIG51bWJlclxyXG5cdFx0XHRzZWFzb25fdGhyZXNob2xkICs9IDI7XHJcblx0XHRcdGZsYWcgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0aWYoZmxhZyl7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiZ2VuZXJhdGluZyBzZWFzb25cIik7XHJcblx0XHRcdGRlbGV0ZV9hbGxfc2Vhc29uKCk7XHJcblx0XHRcdFdvcmxkQ29udHJvbGxlci5zZXRfc2Vhc29uKChXb3JsZENvbnRyb2xsZXIuZ2V0X3NlYXNvbigpKzEpJTQpO1xyXG5cdFx0XHRnZW5lcmF0ZV9zZWFzb24oc2Vhc29uX2ltYWdlW1dvcmxkQ29udHJvbGxlci5nZXRfc2Vhc29uKCldLCBHcmFwaGljc0NvbnRyb2xsZXIuZ2V0X3N0YWdlKCkuY2FudmFzLndpZHRoLCBXb3JsZENvbnRyb2xsZXIuZ2V0X21vdmVtZW50X2VkZ2UoKSAvIDMwKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cdFxyXG5cdC8vc2Nyb2xscyB0aGUgYmFja2dyb3VuZCBhbG9uZyB3aXRoIHRoZSBwbGF5ZXJcclxuXHR2YXIgYmFja2dyb3VuZF9sb29wID0gZnVuY3Rpb24oaGVyb194LCBwcm9ncmVzcyl7XHJcblx0XHRmb3IoaT0wOyBpPHNlYXNvbl9hcnJheS5sZW5ndGg7IGkrKyl7XHJcblx0XHRcdC8vc2Vhc29uX2FycmF5W2ldLnggPSAoaSAqIDc5OSkgKyBHcmFwaGljc01vZGVsLmNhbWVyYS5vZmZzZXQueDtcclxuXHRcdFx0Ly9zZWFzb25fYXJyYXlbaV0ueSA9IEdyYXBoaWNzTW9kZWwuY2FtZXJhLm9mZnNldC55O1xyXG5cdFx0XHRzZWFzb25fYXJyYXlbaV0ueCA9ICgoaSArIHByb2dyZXNzKSAqIDc5OSkgLSAoaGVyb194ICogNCk7XHJcblx0XHRcdHNlYXNvbl9hcnJheVtpXS55ID0gR3JhcGhpY3NDb250cm9sbGVyLmdldF9jYW1lcmEoKS5vZmZzZXQueTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvL2RlbGV0ZXMgYWxsIGJhY2tncm91bmQgb2JqZWN0c1xyXG5cdHZhciBkZWxldGVfYWxsX3NlYXNvbiA9IGZ1bmN0aW9uKCl7XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc2Vhc29uX2FycmF5Lmxlbmd0aDsgaSsrKXtcclxuXHRcdFx0R3JhcGhpY3NDb250cm9sbGVyLmdldF9zdGFnZSgpLnJlbW92ZUNoaWxkKHNlYXNvbl9hcnJheVtpXSk7XHJcblx0XHR9XHJcblx0XHRzZWFzb25fYXJyYXkgPSBbXTtcclxuXHR9O1xyXG5cdFxyXG5cdHZhciByZWdpc3RlciA9IGZ1bmN0aW9uKGJhY2tncm91bmQpe1xyXG5cdFx0LyogaXMgcmFuIGZvciBldmVyeSBlbnRpdHkgb2YgdGhpcyB0eXBlIHRoYXQgd2FzIGp1c3QgY3JlYXRlZCBhbmQgc2hvdWxkXHJcblx0XHRnZXQgZ3JhcGhpY3MgcmVwcmVzZW50YXRpb24uIFlvdSBhcmUgZ2l2ZW4gdGhlIGVudGl0eSBpbnN0YW5jZSBhbmQgaXMgc3VwcG9zZWRcclxuXHRcdHRvIGNyZXRlIGdyYXBoaWNzIGluc3RhbmNlLCBhbmQgR3JhcGhpY3NDb250cm9sbGVyLnJlZ19mb3JfcmVuZGVyKGdyYXBoaWNzX2luc3RhbmNlLCBlbnRpdHlfaW5zdGFuY2UpOyBpdCBcclxuXHRcdCovXHJcblxyXG5cdFx0XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdC8vIGRlY2xhcmUgcHVibGljXHJcblx0XHRpbml0OiBpbml0LCBcclxuXHRcdHJlZ2lzdGVyOiByZWdpc3RlcixcclxuXHRcdHJlbmRlcjogcmVuZGVyLFxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEJhY2tncm91bmRSZW5kZXJlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkJhY2tncm91bmRSZW5kZXJlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuUkVOREVSRVJfU1BFQ0lGSUNcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuXHJcbiIsInZhciBHcmlmZmluUmVuZGVyZXIgPSAoZnVuY3Rpb24oKXtcclxuXHJcblx0dmFyIHNwcml0ZXNoZWV0cyA9IHt9O1xyXG5cdHZhciBHcmlmZmluX2FuaW1hdGlvbjtcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogaXMgcmFuIGZyb20gR3JhcGhpY3NDb250cm9sbGVyLmluaXQgb25jZSBkdXJpbmcgZ2FtZSBsb2FkaW5nXHJcblx0XHQgXHR1c2UgdGhpcyBmdW5jdGlvbiB0byBjcmVhdGUgc3ByaXRlc2hlZXRzIGFuZCBzdWNoXHJcblx0XHRcdGxpa2Ugc3ByaXRlc2hlZXRzLmZpcnN0ID0gbmV3IGNyZWF0ZWpzLlNwcml0ZXNoZWV0KC4uLik7XHJcblx0XHQqL1xyXG5cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHMsIEdPRVMgRklSU1RcclxuXHRcdHZhciBnZXRfYXNzZXQgPSBBc3NldENvbnRyb2xsZXIuZ2V0X2Fzc2V0O1xyXG5cclxuXHRcdHNwcml0ZXNoZWV0c1tcIkdyaWZmaW5cIl0gPSBuZXcgY3JlYXRlanMuU3ByaXRlU2hlZXQoe1xyXG5cdFx0XHRcImZyYW1lcmF0ZVwiOiAxLFxyXG5cdFx0XHRcImltYWdlc1wiOiBbZ2V0X2Fzc2V0KFwiR3JpZmZpbjFcIiksIGdldF9hc3NldChcIkdyaWZmaW4yXCIpLCBnZXRfYXNzZXQoXCJHcmlmZmluM1wiKSwgZ2V0X2Fzc2V0KFwiR3JpZmZpbkRlYXRoXCIpXSwgLy8sIGdldF9hc3NldChcIkdyaWZmaW5EZWF0aDJcIiksIGdldF9hc3NldChcIkdyaWZmaW5EZWF0aDNcIilcclxuXHRcdFx0XHRcImZyYW1lc1wiOiB7IFwicmVnWFwiOiA1LCBcInJlZ1lcIjogMTQsIFwiaGVpZ2h0XCI6IDIwNywgXCJ3aWR0aFwiOiAyMTAsIFwiY291bnRcIjogNn0sXHJcblx0XHRcdFx0XCJhbmltYXRpb25zXCI6IHtcclxuXHRcdFx0XHRcIndhbGtcIjogWzAsIDIsIFwid2Fsa1wiLCAwLjJdLFxyXG5cdFx0XHRcdFwiaW5qdXJ5XCI6IHtcclxuXHRcdFx0XHQgICAgZnJhbWVzOiBbMiwgNCwgLjI1XVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0XCJkZWF0aFwiOiBbMywgNCwgXCJkZWF0aFwiLCAwLjZdLFxyXG4gICAgICAgICAgICAgICAgXCJmbHlcIjogWzEsIDIsIFwiZmx5XCIsIC40XSxcclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIHJlZ2lzdGVyID0gZnVuY3Rpb24oZW50aXR5X0dyaWZmaW4pe1xyXG5cdFx0LyogaXMgcmFuIGZvciBldmVyeSBlbnRpdHkgb2YgdGhpcyB0eXBlIHRoYXQgd2FzIGp1c3QgY3JlYXRlZCBhbmQgc2hvdWxkXHJcblx0XHRnZXQgZ3JhcGhpY3MgcmVwcmVzZW50YXRpb24uIFlvdSBhcmUgZ2l2ZW4gdGhlIGVudGl0eSBpbnN0YW5jZSBhbmQgaXMgc3VwcG9zZWRcclxuXHRcdHRvIGNyZXRlIGdyYXBoaWNzIGluc3RhbmNlLCBhbmQgR3JhcGhpY3NDb250cm9sbGVyLnJlZ19mb3JfcmVuZGVyKGdyYXBoaWNzX2luc3RhbmNlLCBlbnRpdHlfaW5zdGFuY2UpOyBpdCBcclxuXHRcdCovXHJcblxyXG5cdFx0R3JpZmZpbl9hbmltYXRpb24gPSBHcmFwaGljc0NvbnRyb2xsZXIucmVxdWVzdF9hbmltYXRlZChzcHJpdGVzaGVldHNbXCJHcmlmZmluXCJdLCBcIndhbGtcIik7XHJcblx0XHRHcmFwaGljc0NvbnRyb2xsZXIuc2V0X3JlZ19wb3NpdGlvbihHcmlmZmluX2FuaW1hdGlvbiwgMCwgMCk7IC8vIGNoYW5nZSB0aGF0IHRvIGFkanVzdCBzcHJpdGUgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIGJvZHlcclxuXHRcdEdyYXBoaWNzQ29udHJvbGxlci5yZWdfZm9yX3JlbmRlcihHcmlmZmluX2FuaW1hdGlvbiwgZW50aXR5X0dyaWZmaW4pOyAvLyBzZXRzIGdyaWZmaW5fYW5pbWF0aW9uJ3MgcG9zaXRpb24gdG8gdHJhY2sgdGhlIGdyaWZmaW4ncyBwb3NpdGlvbiAodXBkYXRlcyBlYWNoIHRpY2spXHJcblxyXG5cdFx0XHJcblx0fTtcclxuXHJcblx0dmFyIHJlbmRlciA9IGZ1bmN0aW9uKEdyaWZmaW4pe1xyXG5cdFx0LyogXHRpcyByYW4gZWFjaCB0aWNrIGZyb20gR3JhcGhpY3NDb250cm9sbGVyLCBmb3IgZXZlcnkgcmVnaXN0ZXJlZCBvYmplY3Qgb2YgdGhpcyB0eXBlXHJcblx0XHRcdGlzIGdpdmVuID5ncmFwaGljc19pbnN0YW5jZTwgcGFyYW1ldGVyLCB3aGljaCBpcyBhbHNvIHN1cHBvc2VkIHRvIGNvbnRhaW5cclxuXHRcdFx0cGh5c2ljYWxfaW5zdGFuY2UgcHJvcGVydHkgY29udGFpbmluZyBlbnRpdHlfaW5zdGFuY2UsIGlmIGl0IHdhcyBhdHRjaGVkIGNvcnJlY3RseVxyXG5cdFx0Ki9cclxuXHJcblx0XHRHcmlmZmluX3NwZWNpYWxfcmVuZGVyX3RlbXAoR3JpZmZpbik7IFxyXG5cdH07XHJcblxyXG5cdHZhciBHcmlmZmluX3NwZWNpYWxfcmVuZGVyX3RlbXAgPSBmdW5jdGlvbihHcmlmZmluKXtcclxuXHRcdC8qIGhvdyB0byBoYW5kbGUgc3BlY2lhbCByZW5kZXI/IFRFTVBPUkFSWSAqL1xyXG5cclxuXHRcdFxyXG5cdFx0aWYoR3JpZmZpbi5waHlzaWNhbF9pbnN0YW5jZS5BSV9zdGF0ZSA9PSBcImRlYXRoXCImJiBHcmlmZmluLnBoeXNpY2FsX2luc3RhbmNlLmFsaXZlZmxhZyl7XHJcbiBcdFx0XHRHcmlmZmluLmdvdG9BbmRQbGF5KFwiZGVhdGhcIik7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiSSd2ZSBiZWVuIHNxdWFzaGVkIVwiKTtcclxuIFx0XHRcdEdyaWZmaW4ucGh5c2ljYWxfaW5zdGFuY2UuYWxpdmVmbGFnID0gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9pZihHcmlmZmluLnBoeXNpY2FsX2luc3RhbmNlLkFJX3N0YXRlID09IFwidXBzaWRlX2Rvd25cIiAmJiBHcmlmZmluLnBoeXNpY2FsX2luc3RhbmNlLnVuaHVydGZsYWcpXHJcblx0XHQvL3tcclxuXHRcdC8vXHRHcmlmZmluLmdvdG9BbmRQbGF5KFwidXBzaWRlX2Rvd25cIik7XHJcblx0XHQvL1x0R3JpZmZpbi5waHlzaWNhbF9pbnN0YW5jZS51bmh1cnRmbGFnID0gZmFsc2U7XHJcblx0XHRcdFxyXG5cdFx0XHRcclxuXHRcdC8vfVxyXG5cclxuXHR9O1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0cmVnaXN0ZXI6IHJlZ2lzdGVyLFxyXG5cdFx0cmVuZGVyOiByZW5kZXIsXHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR3JpZmZpblJlbmRlcmVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiR3JpZmZpblJlbmRlcmVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5SRU5ERVJFUl9TUEVDSUZJQ1xyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcbiIsInZhciBIZXJvUmVuZGVyZXIgPSAoZnVuY3Rpb24oKXtcclxuXHJcblx0dmFyIHNwcml0ZXNoZWV0cyA9IHt9OyAvLyB0byBzdG9yZSBzcHJpdGVzaGVldHMgdXNlZCBieSB0aGlzIGVudGl0eVxyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiBpcyByYW4gZnJvbSBHcmFwaGljc0NvbnRyb2xsZXIuaW5pdCBvbmNlIGR1cmluZyBnYW1lIGxvYWRpbmdcclxuXHRcdFx0dXNlIHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRlIHNwcml0ZXNoZWV0cyBhbmQgc3VjaFxyXG5cdFx0XHRsaWtlIHNwcml0ZXNoZWV0cy5maXJzdCA9IG5ldyBjcmVhdGVqcy5TcHJpdGVzaGVldCguLi4pO1xyXG5cdFx0Ki9cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHMsIEdPRVMgRklSU1RcclxuXHRcdHZhciBnZXRfYXNzZXQgPSBBc3NldENvbnRyb2xsZXIuZ2V0X2Fzc2V0O1xyXG5cdFx0c3ByaXRlc2hlZXRzW1wiaGVyb1wiXSA9IG5ldyBjcmVhdGVqcy5TcHJpdGVTaGVldCh7XHJcblx0XHRcdFwiZnJhbWVyYXRlXCI6IDEsXHJcblx0XHRcdFwiaW1hZ2VzXCI6IFtnZXRfYXNzZXQoXCJIZXJvXCIpXSwgLy9nZXRfYXNzZXQoXCJIZXJvUlwiKSwgZ2V0X2Fzc2V0KFwiSGVyb1dcIilcclxuXHRcdFx0XCJmcmFtZXNcIjogeyBcInJlZ1hcIjogMjUsIFwicmVnWVwiOiAyNSwgXCJoZWlnaHRcIjogNTAsIFwid2lkdGhcIjogNTAsIFwiY291bnRcIjogMTZ9LFxyXG5cdFx0XHRcImFuaW1hdGlvbnNcIjoge1xyXG5cdFx0XHRcdHN0YW5kOiB7XHJcblx0XHRcdFx0ZnJhbWVzOiBbMF1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGZpbmlzaDoge1xyXG5cdFx0XHRcdFx0ZnJhbWVzOiBbOF1cclxuXHRcdFx0XHR9LFx0XHRcdFx0XHJcblx0XHRcdFx0d2Fsazoge1xyXG5cdFx0XHRcdFx0IGZyYW1lczogWzAsMSwgMl0sXHJcblx0XHRcdFx0XHQgc3BlZWQ6IDAuNFxyXG5cdFx0XHRcdCB9LFxyXG4gICAgICAgICAgICAgICAganVtcDoge1xyXG5cdFx0XHRcdFx0ZnJhbWVzOiBbMywgNCwgNSwgNiwgNywgOF0sXHJcblx0XHRcdFx0XHRzcGVlZDogMC4zXHJcblx0XHRcdFx0fSxcclxuICAgICAgICAgICAgICAgIGRlYXRoOiB7XHJcblx0XHRcdFx0XHRmcmFtZXM6IFs5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1XSxcclxuXHRcdFx0XHRcdHNwZWVkOiAwLjNcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGRlYXRoRmluYWw6IHtcclxuXHRcdFx0XHRcdGZyYW1lczogWzE1XVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0XHQvL1Nwcml0ZVNoZWV0VXRpbHMuYWRkRmxpcHBlZEZyYW1lcyhzcHJpdGVTaGVldHNbXCJIZXJvXCJdLCB0cnVlLCBmYWxzZSwgZmFsc2UpO1xyXG5cdH07XHJcblxyXG5cdHZhciByZWdpc3RlciA9IGZ1bmN0aW9uKGVudGl0eV9oZXJvKXtcclxuXHRcdC8qIGlzIHJhbiBmb3IgZXZlcnkgZW50aXR5IG9mIHRoaXMgdHlwZSB0aGF0IHdhcyBqdXN0IGNyZWF0ZWQgYW5kIHNob3VsZFxyXG5cdFx0Z2V0IGdyYXBoaWNzIHJlcHJlc2VudGF0aW9uLiBZb3UgYXJlIGdpdmVuIHRoZSBlbnRpdHkgaW5zdGFuY2UgYW5kIGlzIHN1cHBvc2VkXHJcblx0XHR0byBjcmV0ZSBncmFwaGljcyBpbnN0YW5jZSwgYW5kIEdyYXBoaWNzQ29udHJvbGxlci5yZWdfZm9yX3JlbmRlcihncmFwaGljc19pbnN0YW5jZSwgZW50aXR5X2luc3RhbmNlKTsgaXQgXHJcblx0XHQqL1xyXG5cclxuXHRcdGhlcm9fYW5pbWF0aW9uID0gR3JhcGhpY3NDb250cm9sbGVyLnJlcXVlc3RfYW5pbWF0ZWQoc3ByaXRlc2hlZXRzW1wiaGVyb1wiXSwgXCJzdGFuZFwiKTtcclxuXHRcdGhlcm9fYW5pbWF0aW9uLmdyYXBoaWNzX2lkID0gXCJoZXJvXCI7XHJcblx0XHRHcmFwaGljc0NvbnRyb2xsZXIuc2V0X3JlZ19wb3NpdGlvbihoZXJvX2FuaW1hdGlvbiwgLTI1LCAtMjUpO1xyXG5cdFx0R3JhcGhpY3NDb250cm9sbGVyLnJlZ19mb3JfcmVuZGVyKGhlcm9fYW5pbWF0aW9uLCBlbnRpdHlfaGVybyk7XHJcblx0XHRHcmFwaGljc0NvbnRyb2xsZXIuZm9sbG93KGVudGl0eV9oZXJvLmlkKTtcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIHJlbmRlciA9IGZ1bmN0aW9uKGhlcm8pe1xyXG5cdFx0LyogXHRpcyByYW4gZWFjaCB0aWNrIGZyb20gR3JhcGhpY3NDb250cm9sbGVyLCBmb3IgZXZlcnkgcmVnaXN0ZXJlZCBvYmplY3Qgb2YgdGhpcyB0eXBlXHJcblx0XHRcdGlzIGdpdmVuID5ncmFwaGljc19pbnN0YW5jZTwgcGFyYW1ldGVyLCB3aGljaCBpcyBhbHNvIHN1cHBvc2VkIHRvIGNvbnRhaW5cclxuXHRcdFx0cGh5c2ljYWxfaW5zdGFuY2UgcHJvcGVydHkgY29udGFpbmluZyBlbnRpdHlfaW5zdGFuY2UsIGlmIGl0IHdhcyBhdHRjaGVkIGNvcnJlY3RseVxyXG5cdFx0Ki9cclxuXHRcdGlmKGhlcm8ucGh5c2ljYWxfaW5zdGFuY2Uuc3RhdGU9PVwid2Fsa1wiJiZoZXJvLnBoeXNpY2FsX2luc3RhbmNlLmlzX3dhbGsgPT0gdHJ1ZSl7XHJcblx0XHRcdGlmKGhlcm8ucGh5c2ljYWxfaW5zdGFuY2Uud2Fsa190aWNrID09MSl7XHJcblx0XHRcdFx0aGVyby5nb3RvQW5kUGxheShcIndhbGtcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0aGVyby5waHlzaWNhbF9pbnN0YW5jZS53YWxrX3RpY2srKztcclxuXHRcdFx0aWYoaGVyby5waHlzaWNhbF9pbnN0YW5jZS53YWxrX3RpY2sgPT0xMCl7XHJcblx0XHRcdFx0aGVyby5waHlzaWNhbF9pbnN0YW5jZS5zdGF0ZT0gXCJzdGFuZFwiO1xyXG5cdFx0XHRcdGhlcm8ucGh5c2ljYWxfaW5zdGFuY2UuaXNfd2FsayA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGlmKGhlcm8ucGh5c2ljYWxfaW5zdGFuY2Uuc3RhdGU9PVwianVtcFwiKXtcclxuXHRcdFx0aWYoaGVyby5waHlzaWNhbF9pbnN0YW5jZS5qdW1wX3RpY2sgPT0xKXtcclxuXHRcdFx0XHRoZXJvLmdvdG9BbmRQbGF5KFwianVtcFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRoZXJvLnBoeXNpY2FsX2luc3RhbmNlLmp1bXBfdGljaysrO1xyXG5cdFx0XHRpZihoZXJvLnBoeXNpY2FsX2luc3RhbmNlLmp1bXBfdGljayA+PSAyMCl7XHJcblx0XHRcdFx0aGVyby5nb3RvQW5kUGxheShcImZpbmlzaFwiKTtcclxuXHRcdFx0XHRpZihoZXJvLnBoeXNpY2FsX2luc3RhbmNlLmp1bXBzPT0wKXtcclxuXHRcdFx0XHRcdGhlcm8ucGh5c2ljYWxfaW5zdGFuY2Uuc3RhdGU9XCJmaW5pc2hcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0aWYoaGVyby5waHlzaWNhbF9pbnN0YW5jZS5zdGF0ZT09XCJmaW5pc2hcIil7XHJcblx0XHRcdGhlcm8uZ290b0FuZFBsYXkoXCJmaW5pc2hcIik7XHJcblx0XHR9XHJcblx0XHRpZihoZXJvLnBoeXNpY2FsX2luc3RhbmNlLnN0YXRlPT1cImRlYXRoRmluYWxcIil7XHJcblx0XHRcdGhlcm8uZ290b0FuZFBsYXkoXCJkZWF0aEZpbmFsXCIpO1xyXG5cdFx0fVxyXG5cdFx0aWYoaGVyby5waHlzaWNhbF9pbnN0YW5jZS5zdGF0ZT09XCJzdGFuZFwiKXtcclxuXHRcdFx0aGVyby5nb3RvQW5kUGxheShcInN0YW5kXCIpO1xyXG5cdFx0fVxyXG5cdFx0Y29uc29sZS5sb2coaGVyby5waHlzaWNhbF9pbnN0YW5jZS5zdGF0ZSk7XHJcblx0XHRpZiAoaGVyby5waHlzaWNhbF9pbnN0YW5jZS5zdGF0ZSA9PSBcImRlYXRoXCIpIHtcclxuXHRcdCAgICBjb25zb2xlLmxvZyhoZXJvLnBoeXNpY2FsX2luc3RhbmNlLmRlYXRoX3RpY2spO1xyXG5cdFx0XHRpZihoZXJvLnBoeXNpY2FsX2luc3RhbmNlLmRlYXRoX3RpY2sgPT0xKXtcclxuXHRcdFx0ICAgIGhlcm8uZ290b0FuZFBsYXkoXCJkZWF0aFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmKGhlcm8ucGh5c2ljYWxfaW5zdGFuY2UuZGVhdGhfdGljayA+PTIwKXtcclxuXHRcdFx0XHRoZXJvLnBoeXNpY2FsX2luc3RhbmNlLnN0YXRlPVwiZGVhdGhGaW5hbFwiO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdC8vc2V0IGRpcmVjdGlvblxyXG5cdFx0aWYgKGhlcm8ucGh5c2ljYWxfaW5zdGFuY2UubGVmdCl7IC8vaWYgZGlyZWN0aW9uID09IHJpZ2h0LCBmbGlwIHJpZ2h0XHJcblx0XHRcdGhlcm8uc2NhbGVYID0gLTE7XHJcblx0XHR9ZWxzZXsgLy9lbHNlIGZsaXAgbGVmdFxyXG5cdFx0XHRoZXJvLnNjYWxlWCA9IDE7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdC8vIGRlY2xhcmUgcHVibGljXHJcblx0XHRpbml0OiBpbml0LCBcclxuXHRcdHJlZ2lzdGVyOiByZWdpc3RlcixcclxuXHRcdHJlbmRlcjogcmVuZGVyLFxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEhlcm9SZW5kZXJlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkhlcm9SZW5kZXJlclwiLCBcclxuXHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuUkVOREVSRVJfU1BFQ0lGSUNcclxufSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG4iLCJ2YXIgSHllbmFSZW5kZXJlciA9IChmdW5jdGlvbigpe1xyXG5cclxuXHR2YXIgc3ByaXRlc2hlZXRzID0ge307XHJcblx0dmFyIEh5ZW5hX2FuaW1hdGlvbjtcclxuXHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0LyogaXMgcmFuIGZyb20gR3JhcGhpY3NDb250cm9sbGVyLmluaXQgb25jZSBkdXJpbmcgZ2FtZSBsb2FkaW5nXHJcblx0XHQgXHR1c2UgdGhpcyBmdW5jdGlvbiB0byBjcmVhdGUgc3ByaXRlc2hlZXRzIGFuZCBzdWNoXHJcblx0XHRcdGxpa2Ugc3ByaXRlc2hlZXRzLmZpcnN0ID0gbmV3IGNyZWF0ZWpzLlNwcml0ZXNoZWV0KC4uLik7XHJcblx0XHQqL1xyXG5cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHMsIEdPRVMgRklSU1RcclxuXHRcdHZhciBnZXRfYXNzZXQgPSBBc3NldENvbnRyb2xsZXIuZ2V0X2Fzc2V0O1xyXG5cclxuXHRcdHNwcml0ZXNoZWV0c1tcIkh5ZW5hXCJdID0gbmV3IGNyZWF0ZWpzLlNwcml0ZVNoZWV0KHtcclxuXHRcdFx0XCJmcmFtZXJhdGVcIjogMSxcclxuXHRcdFx0XCJpbWFnZXNcIjogW2dldF9hc3NldChcIkh5ZW5hU3ByaXRlXCIpXSxcclxuXHRcdFx0XCJmcmFtZXNcIjogeyBcInJlZ1hcIjogMCwgXCJyZWdZXCI6IDgsIFwiaGVpZ2h0XCI6IDY0LCBcIndpZHRoXCI6IDY0LCBcImNvdW50XCI6IDE3fSxcclxuXHRcdFx0XCJhbmltYXRpb25zXCI6IHtcclxuXHRcdFx0XHRcInJ1blwiOiBbMCwzLCBcInJ1blwiLCAwLjVdLFxyXG5cdFx0XHRcdFwic3RhbmRcIjogWzQsNSwgXCJzdGFuZFwiLCAwLjI1XSxcclxuXHRcdFx0XHRcIndhbGtcIjogWzgsMTEsIFwid2Fsa1wiLCAwLjJdLFxyXG5cdFx0XHRcdFwibGVhcFwiOiBbNl0sXHJcblx0XHRcdFx0XCJmYWxsXCI6IFs3XSxcclxuXHRcdFx0XHRcImRlYXRoXCI6IFsxMiwxNCwgXCJkZWNheVwiLCAwLjI1XSxcclxuXHRcdFx0XHRcImRlY2F5XCI6IFsxNSwxNiwgXCJkZWNheVwiLCAwLjI1XSxcclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIHJlZ2lzdGVyID0gZnVuY3Rpb24oZW50aXR5X2h5ZW5hKXtcclxuXHRcdC8qIGlzIHJ1biBmb3IgZXZlcnkgZW50aXR5IG9mIHRoaXMgdHlwZSB0aGF0IHdhcyBqdXN0IGNyZWF0ZWQgYW5kIHNob3VsZFxyXG5cdFx0Z2V0IGdyYXBoaWNzIHJlcHJlc2VudGF0aW9uLiBZb3UgYXJlIGdpdmVuIHRoZSBlbnRpdHkgaW5zdGFuY2UgYW5kIGlzIHN1cHBvc2VkXHJcblx0XHR0byBjcmVhdGUgZ3JhcGhpY3MgaW5zdGFuY2UsIGFuZCBHcmFwaGljc0NvbnRyb2xsZXIucmVnX2Zvcl9yZW5kZXIoZ3JhcGhpY3NfaW5zdGFuY2UsIGVudGl0eV9pbnN0YW5jZSk7IGl0IFxyXG5cdFx0Ki9cclxuXHJcblx0XHRoeWVuYV9hbmltYXRpb24gPSBHcmFwaGljc0NvbnRyb2xsZXIucmVxdWVzdF9hbmltYXRlZChzcHJpdGVzaGVldHNbXCJIeWVuYVwiXSwgXCJ3YWxrXCIpO1xyXG5cdFx0R3JhcGhpY3NDb250cm9sbGVyLnNldF9yZWdfcG9zaXRpb24oaHllbmFfYW5pbWF0aW9uLCAwLCAwKTsgLy8gY2hhbmdlIHRoYXQgdG8gYWRqdXN0IHNwcml0ZSBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGUgYm9keVxyXG5cdFx0R3JhcGhpY3NDb250cm9sbGVyLnJlZ19mb3JfcmVuZGVyKGh5ZW5hX2FuaW1hdGlvbiwgZW50aXR5X2h5ZW5hKTsgLy8gc2V0cyBoeWVuYV9hbmltYXRpb24ncyBwb3NpdGlvbiB0byB0cmFjayB0aGUgaHllbmEncyBwb3NpdGlvbiAodXBkYXRlcyBlYWNoIHRpY2spXHJcblx0XHQvKlxyXG5cdFx0aHllbmFfYW5pbWF0aW9uIGlzIHRoZSBlYXNlbGpzX29iaiBwYXNzZWQgdGhyb3VnaCBncmFwaGljc0NvbnRyb2xsZXJcclxuXHRcdGVudGl0eV9oeWVuYSBpcyB0aGUgcGh5c2ljYWwgb2JqZWN0IHNwYXduZWQgaW4gSHllbmFMb2dpY1xyXG5cdFx0cmVxdWVzdF9hbmltYXRlZCByZXR1cm5zIGFuIGVhc2VsanMgb2JqZWN0IG9mIHR5cGUgU3ByaXRlXHJcblx0XHR0aGlzIFNwcml0ZSBpcyB0aGUgb2JqZWN0IHBhc3NlZCB0byByZW5kZXJcclxuXHRcdCovXHJcblx0XHRcclxuXHR9O1xyXG5cclxuXHR2YXIgcmVuZGVyID0gZnVuY3Rpb24oaHllbmEpe1xyXG5cdFx0LyogXHRpcyBydW4gZWFjaCB0aWNrIGZyb20gR3JhcGhpY3NDb250cm9sbGVyLCBmb3IgZXZlcnkgcmVnaXN0ZXJlZCBvYmplY3Qgb2YgdGhpcyB0eXBlXHJcblx0XHRcdGlzIGdpdmVuID5ncmFwaGljc19pbnN0YW5jZTwgcGFyYW1ldGVyLCB3aGljaCBpcyBhbHNvIHN1cHBvc2VkIHRvIGNvbnRhaW5cclxuXHRcdFx0cGh5c2ljYWxfaW5zdGFuY2UgcHJvcGVydHkgY29udGFpbmluZyBlbnRpdHlfaW5zdGFuY2UsIGlmIGl0IHdhcyBhdHRhY2hlZCBjb3JyZWN0bHlcclxuXHRcdCovXHJcblxyXG5cdFx0aHllbmFfYW5pbWF0ZShoeWVuYSk7IFxyXG5cdH07XHJcblxyXG5cdHZhciBoeWVuYV9hbmltYXRlID0gZnVuY3Rpb24oaHllbmEpe1xyXG5cdFx0Ly9zZXQgZ3JhcGhpY2FsIHJlcHJlc2VudGF0aW9uIGJhc2VkIG9uIHRoZSBhbmltYXRpb24gdmFyaWFibGUgZGV0ZXJtaW5lZCBieSB0aGUgQUlcclxuXHRcdC8vc2V0IGFuaW1hdGlvblxyXG5cdFx0aWYoaHllbmEucGh5c2ljYWxfaW5zdGFuY2UubmVlZHNfZ3JhcGhpY3NfdXBkYXRlKXtcclxuXHRcdFx0dmFyIGFuaW1hdGlvbiA9IGh5ZW5hLnBoeXNpY2FsX2luc3RhbmNlLmFuaW1hdGlvbjtcclxuXHRcdFx0aHllbmEuZ290b0FuZFBsYXkoYW5pbWF0aW9uKVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvL3NldCBkaXJlY3Rpb25cclxuXHRcdGlmIChoeWVuYS5waHlzaWNhbF9pbnN0YW5jZS5kaXJlY3Rpb24peyAvL2lmIGRpcmVjdGlvbiA9PSByaWdodCwgZmxpcCByaWdodFxyXG5cdFx0XHRoeWVuYS5zY2FsZVggPSAtMTtcclxuXHRcdH1lbHNleyAvL2Vsc2UgZmxpcCBsZWZ0XHJcblx0XHRcdGh5ZW5hLnNjYWxlWCA9IDE7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9zZXQgYWxwaGEgaWYgYmxpbmtpbmdcclxuXHRcdGlmKGh5ZW5hLnBoeXNpY2FsX2luc3RhbmNlLmJsaW5raW5nICYmIGh5ZW5hLnBoeXNpY2FsX2luc3RhbmNlLmJsaW5rX3RpbWVyJTIgPT0gMSl7XHJcblx0XHRcdGh5ZW5hLmFscGhhID0gMDtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRoeWVuYS5hbHBoYSA9IDE7XHJcblx0XHR9XHJcblx0fTtcclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0Ly8gZGVjbGFyZSBwdWJsaWNcclxuXHRcdGluaXQ6IGluaXQsIFxyXG5cdFx0cmVnaXN0ZXI6IHJlZ2lzdGVyLFxyXG5cdFx0cmVuZGVyOiByZW5kZXIsXHJcblx0fTtcclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gSHllbmFSZW5kZXJlcjtcclxuXHJcbnZhciBJbmNsdWRlcyA9IHJlcXVpcmUoXCIuLi9JbmNsdWRlcy5qc1wiKTsgdmFyIGluY2x1ZGVfZGF0YSA9IEluY2x1ZGVzLmdldF9pbmNsdWRlX2RhdGEoe1xyXG5cdGN1cnJlbnRfbW9kdWxlOiBcIkh5ZW5hUmVuZGVyZXJcIiwgXHJcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLlJFTkRFUkVSX1NQRUNJRklDXHJcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cclxuIiwidmFyIFRlcnJhaW5DZWxsUmVuZGVyZXIgPSAoZnVuY3Rpb24oKXtcclxuXHJcblx0dmFyIHNwcml0ZXNoZWV0cyA9IHt9OyAvLyB0byBzdG9yZSBzcHJpdGVzaGVldHMgdXNlZCBieSB0aGlzIGVudGl0eVxyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiBpcyByYW4gZnJvbSBHcmFwaGljc0NvbnRyb2xsZXIuaW5pdCBvbmNlIGR1cmluZyBnYW1lIGxvYWRpbmdcclxuXHRcdFx0dXNlIHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRlIHNwcml0ZXNoZWV0cyBhbmQgc3VjaFxyXG5cdFx0XHRsaWtlIHNwcml0ZXNoZWV0cy5maXJzdCA9IG5ldyBjcmVhdGVqcy5TcHJpdGVzaGVldCguLi4pO1xyXG5cdFx0Ki9cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHMsIEdPRVMgRklSU1RcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIHJlZ2lzdGVyID0gZnVuY3Rpb24oZW50aXR5X2NlbGwpe1xyXG5cdFx0LyogaXMgcmFuIGZvciBldmVyeSBlbnRpdHkgb2YgdGhpcyB0eXBlIHRoYXQgd2FzIGp1c3QgY3JlYXRlZCBhbmQgc2hvdWxkXHJcblx0XHRnZXQgZ3JhcGhpY3MgcmVwcmVzZW50YXRpb24uIFlvdSBhcmUgZ2l2ZW4gdGhlIGVudGl0eSBpbnN0YW5jZSBhbmQgaXMgc3VwcG9zZWRcclxuXHRcdHRvIGNyZXRlIGdyYXBoaWNzIGluc3RhbmNlLCBhbmQgR3JhcGhpY3NDb250cm9sbGVyLnJlZ19mb3JfcmVuZGVyKGdyYXBoaWNzX2luc3RhbmNlLCBlbnRpdHlfaW5zdGFuY2UpOyBpdCBcclxuXHRcdCovXHJcblxyXG5cdFx0XHJcblx0fTtcclxuXHJcblx0dmFyIHJlbmRlciA9IGZ1bmN0aW9uKGNlbGwpe1xyXG5cdFx0LyogXHRpcyByYW4gZWFjaCB0aWNrIGZyb20gR3JhcGhpY3NDb250cm9sbGVyLCBmb3IgZXZlcnkgcmVnaXN0ZXJlZCBvYmplY3Qgb2YgdGhpcyB0eXBlXHJcblx0XHRcdGlzIGdpdmVuID5ncmFwaGljc19pbnN0YW5jZTwgcGFyYW1ldGVyLCB3aGljaCBpcyBhbHNvIHN1cHBvc2VkIHRvIGNvbnRhaW5cclxuXHRcdFx0cGh5c2ljYWxfaW5zdGFuY2UgcHJvcGVydHkgY29udGFpbmluZyBlbnRpdHlfaW5zdGFuY2UsIGlmIGl0IHdhcyBhdHRjaGVkIGNvcnJlY3RseVxyXG5cdFx0Ki9cclxuXHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdC8vIGRlY2xhcmUgcHVibGljXHJcblx0XHRpbml0OiBpbml0LCBcclxuXHRcdHJlZ2lzdGVyOiByZWdpc3RlcixcclxuXHRcdHJlbmRlcjogcmVuZGVyLFxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFRlcnJhaW5DZWxsUmVuZGVyZXI7XHJcblxyXG52YXIgSW5jbHVkZXMgPSByZXF1aXJlKFwiLi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRjdXJyZW50X21vZHVsZTogXCJUZXJyYWluQ2VsbFJlbmRlcmVyXCIsIFxyXG5cdGluY2x1ZGVfb3B0aW9uczogSW5jbHVkZXMuY2hvaWNlcy5SRU5ERVJFUl9TUEVDSUZJQ1xyXG59KTsgZXZhbChpbmNsdWRlX2RhdGEubmFtZV9zdGF0ZW1lbnRzKTsgdmFyIGluY2x1ZGUgPSBmdW5jdGlvbigpe2V2YWwoaW5jbHVkZV9kYXRhLm1vZHVsZV9zdGF0ZW1lbnRzKTt9XHJcblxyXG4iLCJ2YXIgVGVycmFpblNsaWNlUmVuZGVyZXIgPSAoZnVuY3Rpb24oKXtcclxuXHJcblx0dmFyIHNwcml0ZXNoZWV0cyA9IHt9OyAvLyB0byBzdG9yZSBzcHJpdGVzaGVldHMgdXNlZCBieSB0aGlzIGVudGl0eVxyXG5cclxuXHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHQvKiBpcyByYW4gZnJvbSBHcmFwaGljc0NvbnRyb2xsZXIuaW5pdCBvbmNlIGR1cmluZyBnYW1lIGxvYWRpbmdcclxuXHRcdFx0dXNlIHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRlIHNwcml0ZXNoZWV0cyBhbmQgc3VjaFxyXG5cdFx0XHRsaWtlIHNwcml0ZXNoZWV0cy5maXJzdCA9IG5ldyBjcmVhdGVqcy5TcHJpdGVzaGVldCguLi4pO1xyXG5cdFx0Ki9cclxuXHRcdGluY2x1ZGUoKTsgLy8gc2F0aXNmeSByZXF1aXJlbWVudHMsIEdPRVMgRklSU1RcclxuXHJcblx0fTtcclxuXHJcblx0dmFyIHJlZ2lzdGVyID0gZnVuY3Rpb24oc2xpY2UsIFByaXZhdGVHcmFwaGljcyl7XHJcblx0XHQvKiBpcyByYW4gZm9yIGV2ZXJ5IGVudGl0eSBvZiB0aGlzIHR5cGUgdGhhdCB3YXMganVzdCBjcmVhdGVkIGFuZCBzaG91bGRcclxuXHRcdGdldCBncmFwaGljcyByZXByZXNlbnRhdGlvbi4gWW91IGFyZSBnaXZlbiB0aGUgZW50aXR5IGluc3RhbmNlIGFuZCBpcyBzdXBwb3NlZFxyXG5cdFx0dG8gY3JldGUgZ3JhcGhpY3MgaW5zdGFuY2UsIGFuZCBHcmFwaGljc0NvbnRyb2xsZXIucmVnX2Zvcl9yZW5kZXIoZ3JhcGhpY3NfaW5zdGFuY2UsIGVudGl0eV9pbnN0YW5jZSk7IGl0IFxyXG5cdFx0Ki9cclxuXHJcblx0XHQvLyBUT0RPOiBjaGFuZ2UgdGhhdCBwcml2YXRlIGNyYXAgdG8gc210aCBtb3JlIHVzZWZ1bFxyXG5cdFx0Ly8gbGlrZSBtYWtlIGdyYXBoaWNzIGNvbnRyb2xsZXIgc3BlY2lhbCBjYXNlIGluIGluY2x1ZGVzLFxyXG5cdFx0Ly8gc28gdGhhdCBvbmx5IGludGVyZXN0ZWQgcGVvcGxlIGNhbiBnZXQgaXRcclxuXHRcdHZhciByZXF1ZXN0X2FuaW1hdGVkID0gUHJpdmF0ZUdyYXBoaWNzLnJlcXVlc3RfYW5pbWF0ZWQ7XHJcblx0XHR2YXIgcmVxdWVzdF9iaXRtYXAgPSBQcml2YXRlR3JhcGhpY3MucmVxdWVzdF9iaXRtYXA7XHJcblx0XHR2YXIgdHJhbnNfeHkgPSBQcml2YXRlR3JhcGhpY3MudHJhbnNfeHk7XHJcblx0XHR2YXIgcmVnX2Zvcl9yZW5kZXIgPSBQcml2YXRlR3JhcGhpY3MucmVnX2Zvcl9yZW5kZXI7XHJcblxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNsaWNlLmdyaWRfcm93czsgaSsrKXtcclxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgc2xpY2UuZ3JpZF9jb2x1bW5zOyBqKyspe1xyXG5cdFx0XHRcdFx0dmFyIGtpbmQgPSBzbGljZS5ncmlkW2ldW2pdLmtpbmQ7XHJcblx0XHRcdFx0XHRpZihraW5kICE9IDApe1xyXG5cdFx0XHRcdFx0XHQvLyBUT0RPOiBzaG91bGQgbWFrZSBwcm9wZXIgdGVycmFpbiBjb2xsZWN0aW9uIHRoaW5nIHRvIHB1bGwgZnJvbVxyXG5cdFx0XHRcdFx0XHQvKlxyXG5cdFx0XHRcdFx0XHR2YXIgdGlsZV90ZXh0dXJlID0gW1wiZ3Jhc3NcIiwgXCJtaWRkbGVfdGVycmFpblwiLCBcImJvdHRvbV90ZXJyYWluXCJdW2tpbmQtMV07XHJcblx0XHRcdFx0XHRcdHZhciB0aWxlID0gcmVxdWVzdF9iaXRtYXAodGlsZV90ZXh0dXJlKTtcclxuXHRcdFx0XHRcdFx0Ki9cclxuXHRcdFx0XHRcdFx0dmFyIHN1cmZhY2VfdGV4dHVyZXMgPSBbXCJncmFzc193aW50ZXJcIixcImdyYXNzX3NwcmluZ1wiLFwiZ3Jhc3Nfc3VtbWVyXCIsXCJncmFzc19mYWxsXCJdO1xyXG5cdFx0XHRcdFx0XHR2YXIgcG9zaXRpb24gPSBzbGljZS5ncmlkW2ldW2pdLnBvc2l0aW9uO1xyXG5cdFx0XHRcdFx0XHRpZiAoa2luZCA9PSAxKXsgLy9pZiB0aWxlIGlzIHBhcnQgb2YgdGhlIGdyb3VuZFxyXG5cdFx0XHRcdFx0XHRcdHN3aXRjaCAocG9zaXRpb24pe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjYXNlIFwic3VyZmFjZVwiOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKFdvcmxkQ29udHJvbGxlci5nZXRfc2Vhc29uKCkpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciB0aWxlX3RleHR1cmUgPSBzdXJmYWNlX3RleHR1cmVzW1dvcmxkQ29udHJvbGxlci5nZXRfc2Vhc29uKCldO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgXCJ1bmRlcmdyb3VuZFwiOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgdGlsZV90ZXh0dXJlID0gXCJib3R0b21fdGVycmFpblwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYgKGtpbmQgPT0gMil7IC8vaWYgdGlsZSBpcyBwYXJ0IG9mIGEgcGxhdGZvcm1cclxuXHRcdFx0XHRcdFx0XHRzd2l0Y2ggKHBvc2l0aW9uKXtcclxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgXCJsZWZ0XCI6XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhciB0aWxlX3RleHR1cmUgPSBcImxlZnRfcGxhdGZvcm1cIjs7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSBcIm1pZGRsZVwiOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgdGlsZV90ZXh0dXJlID0gXCJtaWRkbGVfcGxhdGZvcm1cIjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHRjYXNlIFwicmlnaHRcIjpcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIHRpbGVfdGV4dHVyZSA9IFwicmlnaHRfcGxhdGZvcm1cIjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmIChraW5kID09IDMpey8vaWYgdGlsZSBpcyBhY3R1YWxseSBqdXN0IHNwaWtlc1xyXG5cdFx0XHRcdFx0XHRcdHZhciB0aWxlX3RleHR1cmUgPSBcInBsYXRmb3JtX3NwaWtlc1wiO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHZhciB0aWxlID0gcmVxdWVzdF9iaXRtYXAodGlsZV90ZXh0dXJlKTtcclxuXHRcdFx0XHRcdFx0dmFyIHBoeXNpY2FsX2luc3RhbmNlID0gc2xpY2UuZ3JpZFtpXVtqXTtcclxuXHRcdFx0XHRcdFx0dmFyIGJvZHlfcG9zaXRpb24gPSBwaHlzaWNhbF9pbnN0YW5jZS5ib2R5LkdldFdvcmxkQ2VudGVyKCk7XHJcblx0XHRcdFx0XHRcdHZhciB0cmFuc19wb3MgPSB0cmFuc194eShib2R5X3Bvc2l0aW9uKTtcclxuXHRcdFx0XHRcdFx0dGlsZS54ID0gdHJhbnNfcG9zLng7XHJcblx0XHRcdFx0XHRcdHRpbGUueSA9IHRyYW5zX3Bvcy55O1xyXG5cdFx0XHRcdFx0XHRyZWdfZm9yX3JlbmRlcih0aWxlLCBwaHlzaWNhbF9pbnN0YW5jZSk7XHJcblx0XHRcdFx0XHR9IC8vIGVuZCB0aWxlX3RleHR1cmUgYXNzaWdubWVudFxyXG5cdFx0XHRcdH0gLy8gZW5kIGZvclxyXG5cdFx0XHR9Ly9lbmQgZm9yXHJcblx0XHRcclxuXHR9O1xyXG5cclxuXHR2YXIgcmVuZGVyID0gZnVuY3Rpb24oc2xpY2Upe1xyXG5cdFx0LyogXHRpcyByYW4gZWFjaCB0aWNrIGZyb20gR3JhcGhpY3NDb250cm9sbGVyLCBmb3IgZXZlcnkgcmVnaXN0ZXJlZCBvYmplY3Qgb2YgdGhpcyB0eXBlXHJcblx0XHRcdGlzIGdpdmVuID5ncmFwaGljc19pbnN0YW5jZTwgcGFyYW1ldGVyLCB3aGljaCBpcyBhbHNvIHN1cHBvc2VkIHRvIGNvbnRhaW5cclxuXHRcdFx0cGh5c2ljYWxfaW5zdGFuY2UgcHJvcGVydHkgY29udGFpbmluZyBlbnRpdHlfaW5zdGFuY2UsIGlmIGl0IHdhcyBhdHRjaGVkIGNvcnJlY3RseVxyXG5cdFx0Ki9cclxuXHJcblx0fTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdC8vIGRlY2xhcmUgcHVibGljXHJcblx0XHRpbml0OiBpbml0LCBcclxuXHRcdHJlZ2lzdGVyOiByZWdpc3RlcixcclxuXHRcdHJlbmRlcjogcmVuZGVyLFxyXG5cdH07XHJcbn0pKCk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFRlcnJhaW5TbGljZVJlbmRlcmVyO1xyXG5cclxudmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4uL0luY2x1ZGVzLmpzXCIpOyB2YXIgaW5jbHVkZV9kYXRhID0gSW5jbHVkZXMuZ2V0X2luY2x1ZGVfZGF0YSh7XHJcblx0Y3VycmVudF9tb2R1bGU6IFwiVGVycmFpblNsaWNlUmVuZGVyZXJcIiwgXHJcblx0aW5jbHVkZV9vcHRpb25zOiBJbmNsdWRlcy5jaG9pY2VzLlJFTkRFUkVSX1NQRUNJRklDXHJcbn0pOyBldmFsKGluY2x1ZGVfZGF0YS5uYW1lX3N0YXRlbWVudHMpOyB2YXIgaW5jbHVkZSA9IGZ1bmN0aW9uKCl7ZXZhbChpbmNsdWRlX2RhdGEubW9kdWxlX3N0YXRlbWVudHMpO31cclxuXHJcbiIsIlxyXG4vKlxyXG4gKiBSdWxlcyBmb3Igd29ya2luZyBvbiB0aGUgKGNsaWVudC1zaWRlKSBnYW1lIGNvZGU6XHJcbiAqXHJcbiAqIDEuIElmIHlvdSB0aGluayB0aGF0IG9uZSBvZiB0aGVzZSBydWxlcyBpcyBzdHVwaWQgb3IgdXNlbGVzcywgdGVsbCBtZSwgYWxvbmcgd2l0aCBzb21lIGJldHRlciBzdWdnZXN0aW9ucy5cclxuICpcclxuICogMi4gTW9kZWwgW25hbWVdTW9kZWwgY2FuIG9ubHkgYmUgYWNjZXNzZWQgdGhyb3VnaCBbbmFtZV1Db250cm9sbGVyLiBJZiB5b3UgbmVlZCB0byBkbyBzb21ldGhpbmcgdG8gXHJcbiAqIFx0XHRjaGFuZ2UgW25hbWVdTW9kZWwgZnJvbSBbb3RoZXJfbmFtZV1Db250cm9sbGVyLCB3cml0ZSBmdW5jdGlvbiBpbiB0aGUgW25hbWVdQ29udHJvbGxlciB0aGF0IGRvZXNcclxuICogXHRcdHdoYXQgeW91IG5lZWQsIGFuZCBjYWxsIGl0IGZyb20gdGhlIFtvdGhlcl9uYW1lXUNvbnRyb2xsZXJcclxuICpcclxuICogMy4gQ29udHJvbGxlcnMgYXJlIGFsbG93ZWQgdG8gaGF2ZSBwcml2YXRlIG1ldGhvZHMvZmllbGRzLiBNb2RlbHMgYXJlbid0LiBcclxuICpcclxuICogNC4gQ29udHJvbGxlcnMgYXJlbid0IGFsbG93ZWQgdG8gaGF2ZSBwdWJsaWMgZGF0YSBmaWVsZHMuIFxyXG4gKiBcdFx0VGhvc2UgZGF0YSBmaWVsZHMgdGhhdCBhcmUgcHJlc2VudCBtdXN0IG5vdCByZWZsZWN0IHN0YXRlIG9mIHRoZSBnYW1lLCB0aGV5IG11c3QgYmUgcmVsYXRlZCB0b1xyXG4gKiBcdFx0c29tZSBpbnRlcm5hbCBmdW5jdGlvbmFsaXR5IG9mIHRoZSBjb250cm9sbGVyXHJcbiAqXHJcbiAqIDUuIElmIHlvdSB3cml0ZSBzb21lIGZ1bmN0aW9uIHRoYXQgZG9lc24ndCBsb2dpY2FsbHkgYmVsb25nIHRvIG9uZSBvZiB0aGUgY29udHJvbGxlcnMsXHJcbiAqIFx0XHRwdXQgaXQgaW4gdGhlIFV0aWxpdHlcclxuICpcclxuICogNi4gVmFyaWFibGVzIGFyZSBuYW1lZCBsaWtlIHRoYXQ6IHZhcmlhYmxlX25hbWVcclxuICogXHRcdEV4Y2VwdCAoc2luZ2xldG9uKWNsYXNzIG5hbWVzLCB0aGF0IGFyZSB3cml0dGVuIGxpa2UgdGhhdDogQ2xhc3NOYW1lXHJcbiAqXHJcbiAqIDcuIEFuZCBhbGwgdGhlIG9idmlvdXMgc3R1ZmYgdGhhdCBldmVyeW9uZSBrbm93czpcclxuICogXHRcdGZ1bmN0aW9uIG11c3QgZG8gb25lIHRoaW5nOyBkb24ndCBtYWtlIGZ1bmN0aW9uIHB1YmxpYyB1bmxlc3MgaXQgbmVlZHMgdG8gYmUgdGhhdDsgXHJcbiAqIFx0XHRjb21tZW50IGFtYmlnaW91cyBjb2RlLCBmb3IgbGFyZ2VyIGZ1bmN0aW9ucyBpbmRpY2F0ZSB0aGVpciBwdXJwb3NlICh0aHJvdWdoIGNvbW1lbnRpbmcpO1xyXG4gKi9cclxuXHJcblxyXG4vLyBtYWluIG5hbWVzcGFjZSB0aGF0IGlzIGV4cG9zZWQgdG8gZ2xvYmFsIHNjb3BlICh3aW5kb3cgb2JqZWN0KVxyXG53aW5kb3cuc2lkZXNjcm9sbGVyX2dhbWUgPSAoZnVuY3Rpb24gbmFtZXNwYWNlKCl7XHJcblxyXG5cdFx0dmFyIEluY2x1ZGVzID0gcmVxdWlyZShcIi4vSW5jbHVkZXMuanNcIik7IHZhciBpbmNsdWRlX2RhdGEgPSBJbmNsdWRlcy5nZXRfaW5jbHVkZV9kYXRhKHtcclxuXHRcdGN1cnJlbnRfbW9kdWxlOiBcIk5vbmVcIiwgXHJcblx0XHRpbmNsdWRlX29wdGlvbnM6IEluY2x1ZGVzLmNob2ljZXMuQUxMX0NPTlRST0xMRVJTXHJcblx0fSk7IGV2YWwoaW5jbHVkZV9kYXRhLm5hbWVfc3RhdGVtZW50cyk7IHZhciBpbmNsdWRlID0gZnVuY3Rpb24oKXtldmFsKGluY2x1ZGVfZGF0YS5tb2R1bGVfc3RhdGVtZW50cyk7fVxyXG5cclxuXHQvLyBHYW1lIGluaXRpYXRpb24gc2VjdGlvbjogPj4+XHJcblx0XHRcclxuXHR2YXIgbG9hZF9nYW1lID0gZnVuY3Rpb24obW9kZSlcclxuXHR7XHJcblxyXG5cdFx0SW5jbHVkZXMuaW5pdCgpOyAvLyBmaXJzdFxyXG5cdFx0aW5jbHVkZSgpOyAvLyBzZWNvbmRcclxuXHJcblx0XHRJbml0Q29udHJvbGxlci5pbml0KG1vZGUpOyAvLyBpbml0IGFsbCB0aGUgc3R1ZmZcclxuXHJcblx0XHRpZihtb2RlID09IFwidGVzdFwiKXtcclxuXHRcdFx0VGVzdENvbnRyb2xsZXIudGVzdCgpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cclxuXHR2YXIgcnVuID0gZnVuY3Rpb24obW9kZSlcclxuXHR7XHJcblx0XHQvLyBkb25lIHRoaXMgd2F5IHRvIGVuc3VyZSB0aGF0IGxvYWRfZ2FtZSdzIGludGVybmFscyBhcmVuJ3QgYWNjZXNzaWJsZSB0byB0aGUgd29ybGQ6XHJcblx0XHRsb2FkX2dhbWUobW9kZSk7XHJcblx0fTsgXHJcblx0XHJcblx0cmV0dXJuIHtcclxuXHRcdHJ1bjogcnVuXHJcblx0fTsgLy8gZXhwb3NlIGZ1bmN0aW9uIHJ1biB0byB0aGUgd29ybGRcclxuXHJcbn0pKCk7IFxyXG5cclxuIiwiLypcclxuKiBDb3B5cmlnaHQgKGMpIDIwMDYtMjAwNyBFcmluIENhdHRvIGh0dHA6Ly93d3cuZ3BoeXNpY3MuY29tXHJcbipcclxuKiBUaGlzIHNvZnR3YXJlIGlzIHByb3ZpZGVkICdhcy1pcycsIHdpdGhvdXQgYW55IGV4cHJlc3Mgb3IgaW1wbGllZFxyXG4qIHdhcnJhbnR5LiAgSW4gbm8gZXZlbnQgd2lsbCB0aGUgYXV0aG9ycyBiZSBoZWxkIGxpYWJsZSBmb3IgYW55IGRhbWFnZXNcclxuKiBhcmlzaW5nIGZyb20gdGhlIHVzZSBvZiB0aGlzIHNvZnR3YXJlLlxyXG4qIFBlcm1pc3Npb24gaXMgZ3JhbnRlZCB0byBhbnlvbmUgdG8gdXNlIHRoaXMgc29mdHdhcmUgZm9yIGFueSBwdXJwb3NlLFxyXG4qIGluY2x1ZGluZyBjb21tZXJjaWFsIGFwcGxpY2F0aW9ucywgYW5kIHRvIGFsdGVyIGl0IGFuZCByZWRpc3RyaWJ1dGUgaXRcclxuKiBmcmVlbHksIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyByZXN0cmljdGlvbnM6XHJcbiogMS4gVGhlIG9yaWdpbiBvZiB0aGlzIHNvZnR3YXJlIG11c3Qgbm90IGJlIG1pc3JlcHJlc2VudGVkOyB5b3UgbXVzdCBub3RcclxuKiBjbGFpbSB0aGF0IHlvdSB3cm90ZSB0aGUgb3JpZ2luYWwgc29mdHdhcmUuIElmIHlvdSB1c2UgdGhpcyBzb2Z0d2FyZVxyXG4qIGluIGEgcHJvZHVjdCwgYW4gYWNrbm93bGVkZ21lbnQgaW4gdGhlIHByb2R1Y3QgZG9jdW1lbnRhdGlvbiB3b3VsZCBiZVxyXG4qIGFwcHJlY2lhdGVkIGJ1dCBpcyBub3QgcmVxdWlyZWQuXHJcbiogMi4gQWx0ZXJlZCBzb3VyY2UgdmVyc2lvbnMgbXVzdCBiZSBwbGFpbmx5IG1hcmtlZCBhcyBzdWNoLCBhbmQgbXVzdCBub3QgYmVcclxuKiBtaXNyZXByZXNlbnRlZCBhcyBiZWluZyB0aGUgb3JpZ2luYWwgc29mdHdhcmUuXHJcbiogMy4gVGhpcyBub3RpY2UgbWF5IG5vdCBiZSByZW1vdmVkIG9yIGFsdGVyZWQgZnJvbSBhbnkgc291cmNlIGRpc3RyaWJ1dGlvbi5cclxuKi9cclxuXCJ1c2Ugc3RyaWN0XCJcclxuXHJcbnZhciBCb3gyRCA9IHt9O1xyXG5cclxuKGZ1bmN0aW9uIChhMmosIHVuZGVmaW5lZCkge1xyXG4gICBcclxuICAgZnVuY3Rpb24gZW1wdHlGbigpIHt9O1xyXG4gICBhMmouaW5oZXJpdCA9IGZ1bmN0aW9uKGNscywgYmFzZSkge1xyXG4gICAgICB2YXIgdG1wQ3RyID0gY2xzO1xyXG4gICAgICBlbXB0eUZuLnByb3RvdHlwZSA9IGJhc2UucHJvdG90eXBlO1xyXG4gICAgICBjbHMucHJvdG90eXBlID0gbmV3IGVtcHR5Rm47XHJcbiAgICAgIGNscy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSB0bXBDdHI7XHJcbiAgIH07XHJcbiAgIFxyXG4gICBhMmouZ2VuZXJhdGVDYWxsYmFjayA9IGZ1bmN0aW9uIGdlbmVyYXRlQ2FsbGJhY2soY29udGV4dCwgY2IpIHtcclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgY2IuYXBwbHkoY29udGV4dCwgYXJndW1lbnRzKTtcclxuICAgICAgfTtcclxuICAgfTtcclxuICAgXHJcbiAgIGEyai5OVmVjdG9yID0gZnVuY3Rpb24gTlZlY3RvcihsZW5ndGgpIHtcclxuICAgICAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSBsZW5ndGggPSAwO1xyXG4gICAgICB2YXIgdG1wID0gbmV3IEFycmF5KGxlbmd0aCB8fCAwKTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSlcclxuICAgICAgdG1wW2ldID0gMDtcclxuICAgICAgcmV0dXJuIHRtcDtcclxuICAgfTtcclxuICAgXHJcbiAgIGEyai5pcyA9IGZ1bmN0aW9uIGlzKG8xLCBvMikge1xyXG4gICAgICBpZiAobzEgPT09IG51bGwpIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKChvMiBpbnN0YW5jZW9mIEZ1bmN0aW9uKSAmJiAobzEgaW5zdGFuY2VvZiBvMikpIHJldHVybiB0cnVlO1xyXG4gICAgICBpZiAoKG8xLmNvbnN0cnVjdG9yLl9faW1wbGVtZW50cyAhPSB1bmRlZmluZWQpICYmIChvMS5jb25zdHJ1Y3Rvci5fX2ltcGxlbWVudHNbbzJdKSkgcmV0dXJuIHRydWU7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgfTtcclxuICAgXHJcbiAgIGEyai5wYXJzZVVJbnQgPSBmdW5jdGlvbih2KSB7XHJcbiAgICAgIHJldHVybiBNYXRoLmFicyhwYXJzZUludCh2KSk7XHJcbiAgIH1cclxuICAgXHJcbn0pKEJveDJEKTtcclxuXHJcbi8vI1RPRE8gcmVtb3ZlIGFzc2lnbm1lbnRzIGZyb20gZ2xvYmFsIG5hbWVzcGFjZVxyXG52YXIgVmVjdG9yID0gQXJyYXk7XHJcbnZhciBWZWN0b3JfYTJqX051bWJlciA9IEJveDJELk5WZWN0b3I7XHJcbi8vcGFja2FnZSBzdHJ1Y3R1cmVcclxuaWYgKHR5cGVvZihCb3gyRCkgPT09IFwidW5kZWZpbmVkXCIpIEJveDJEID0ge307XHJcbmlmICh0eXBlb2YoQm94MkQuQ29sbGlzaW9uKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuQ29sbGlzaW9uID0ge307XHJcbmlmICh0eXBlb2YoQm94MkQuQ29sbGlzaW9uLlNoYXBlcykgPT09IFwidW5kZWZpbmVkXCIpIEJveDJELkNvbGxpc2lvbi5TaGFwZXMgPSB7fTtcclxuaWYgKHR5cGVvZihCb3gyRC5Db21tb24pID09PSBcInVuZGVmaW5lZFwiKSBCb3gyRC5Db21tb24gPSB7fTtcclxuaWYgKHR5cGVvZihCb3gyRC5Db21tb24uTWF0aCkgPT09IFwidW5kZWZpbmVkXCIpIEJveDJELkNvbW1vbi5NYXRoID0ge307XHJcbmlmICh0eXBlb2YoQm94MkQuRHluYW1pY3MpID09PSBcInVuZGVmaW5lZFwiKSBCb3gyRC5EeW5hbWljcyA9IHt9O1xyXG5pZiAodHlwZW9mKEJveDJELkR5bmFtaWNzLkNvbnRhY3RzKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuRHluYW1pY3MuQ29udGFjdHMgPSB7fTtcclxuaWYgKHR5cGVvZihCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycykgPT09IFwidW5kZWZpbmVkXCIpIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzID0ge307XHJcbmlmICh0eXBlb2YoQm94MkQuRHluYW1pY3MuSm9pbnRzKSA9PT0gXCJ1bmRlZmluZWRcIikgQm94MkQuRHluYW1pY3MuSm9pbnRzID0ge307XHJcbi8vcHJlLWRlZmluaXRpb25zXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgIEJveDJELkNvbGxpc2lvbi5JQnJvYWRQaGFzZSA9ICdCb3gyRC5Db2xsaXNpb24uSUJyb2FkUGhhc2UnO1xyXG5cclxuICAgZnVuY3Rpb24gYjJBQUJCKCkge1xyXG4gICAgICBiMkFBQkIuYjJBQUJCLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkFBQkIgPSBiMkFBQkI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkJvdW5kKCkge1xyXG4gICAgICBiMkJvdW5kLmIyQm91bmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyQm91bmQgPSBiMkJvdW5kO1xyXG5cclxuICAgZnVuY3Rpb24gYjJCb3VuZFZhbHVlcygpIHtcclxuICAgICAgYjJCb3VuZFZhbHVlcy5iMkJvdW5kVmFsdWVzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkJvdW5kVmFsdWVzKSB0aGlzLmIyQm91bmRWYWx1ZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyQm91bmRWYWx1ZXMgPSBiMkJvdW5kVmFsdWVzO1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb2xsaXNpb24oKSB7XHJcbiAgICAgIGIyQ29sbGlzaW9uLmIyQ29sbGlzaW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbiA9IGIyQ29sbGlzaW9uO1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0SUQoKSB7XHJcbiAgICAgIGIyQ29udGFjdElELmIyQ29udGFjdElELmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkNvbnRhY3RJRCkgdGhpcy5iMkNvbnRhY3RJRC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0SUQgPSBiMkNvbnRhY3RJRDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29udGFjdFBvaW50KCkge1xyXG4gICAgICBiMkNvbnRhY3RQb2ludC5iMkNvbnRhY3RQb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0UG9pbnQgPSBiMkNvbnRhY3RQb2ludDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRGlzdGFuY2UoKSB7XHJcbiAgICAgIGIyRGlzdGFuY2UuYjJEaXN0YW5jZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZSA9IGIyRGlzdGFuY2U7XHJcblxyXG4gICBmdW5jdGlvbiBiMkRpc3RhbmNlSW5wdXQoKSB7XHJcbiAgICAgIGIyRGlzdGFuY2VJbnB1dC5iMkRpc3RhbmNlSW5wdXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VJbnB1dCA9IGIyRGlzdGFuY2VJbnB1dDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRGlzdGFuY2VPdXRwdXQoKSB7XHJcbiAgICAgIGIyRGlzdGFuY2VPdXRwdXQuYjJEaXN0YW5jZU91dHB1dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZU91dHB1dCA9IGIyRGlzdGFuY2VPdXRwdXQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkRpc3RhbmNlUHJveHkoKSB7XHJcbiAgICAgIGIyRGlzdGFuY2VQcm94eS5iMkRpc3RhbmNlUHJveHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VQcm94eSA9IGIyRGlzdGFuY2VQcm94eTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRHluYW1pY1RyZWUoKSB7XHJcbiAgICAgIGIyRHluYW1pY1RyZWUuYjJEeW5hbWljVHJlZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJEeW5hbWljVHJlZSkgdGhpcy5iMkR5bmFtaWNUcmVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlID0gYjJEeW5hbWljVHJlZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlKCkge1xyXG4gICAgICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5iMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UgPSBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRHluYW1pY1RyZWVOb2RlKCkge1xyXG4gICAgICBiMkR5bmFtaWNUcmVlTm9kZS5iMkR5bmFtaWNUcmVlTm9kZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZU5vZGUgPSBiMkR5bmFtaWNUcmVlTm9kZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRHluYW1pY1RyZWVQYWlyKCkge1xyXG4gICAgICBiMkR5bmFtaWNUcmVlUGFpci5iMkR5bmFtaWNUcmVlUGFpci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZVBhaXIgPSBiMkR5bmFtaWNUcmVlUGFpcjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyTWFuaWZvbGQoKSB7XHJcbiAgICAgIGIyTWFuaWZvbGQuYjJNYW5pZm9sZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJNYW5pZm9sZCkgdGhpcy5iMk1hbmlmb2xkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkID0gYjJNYW5pZm9sZDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyTWFuaWZvbGRQb2ludCgpIHtcclxuICAgICAgYjJNYW5pZm9sZFBvaW50LmIyTWFuaWZvbGRQb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJNYW5pZm9sZFBvaW50KSB0aGlzLmIyTWFuaWZvbGRQb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZFBvaW50ID0gYjJNYW5pZm9sZFBvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJQb2ludCgpIHtcclxuICAgICAgYjJQb2ludC5iMlBvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMlBvaW50ID0gYjJQb2ludDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUmF5Q2FzdElucHV0KCkge1xyXG4gICAgICBiMlJheUNhc3RJbnB1dC5iMlJheUNhc3RJbnB1dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJSYXlDYXN0SW5wdXQpIHRoaXMuYjJSYXlDYXN0SW5wdXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdElucHV0ID0gYjJSYXlDYXN0SW5wdXQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMlJheUNhc3RPdXRwdXQoKSB7XHJcbiAgICAgIGIyUmF5Q2FzdE91dHB1dC5iMlJheUNhc3RPdXRwdXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdE91dHB1dCA9IGIyUmF5Q2FzdE91dHB1dDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyU2VnbWVudCgpIHtcclxuICAgICAgYjJTZWdtZW50LmIyU2VnbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJTZWdtZW50ID0gYjJTZWdtZW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJTZXBhcmF0aW9uRnVuY3Rpb24oKSB7XHJcbiAgICAgIGIyU2VwYXJhdGlvbkZ1bmN0aW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMlNlcGFyYXRpb25GdW5jdGlvbiA9IGIyU2VwYXJhdGlvbkZ1bmN0aW9uO1xyXG5cclxuICAgZnVuY3Rpb24gYjJTaW1wbGV4KCkge1xyXG4gICAgICBiMlNpbXBsZXguYjJTaW1wbGV4LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlNpbXBsZXgpIHRoaXMuYjJTaW1wbGV4LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXggPSBiMlNpbXBsZXg7XHJcblxyXG4gICBmdW5jdGlvbiBiMlNpbXBsZXhDYWNoZSgpIHtcclxuICAgICAgYjJTaW1wbGV4Q2FjaGUuYjJTaW1wbGV4Q2FjaGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleENhY2hlID0gYjJTaW1wbGV4Q2FjaGU7XHJcblxyXG4gICBmdW5jdGlvbiBiMlNpbXBsZXhWZXJ0ZXgoKSB7XHJcbiAgICAgIGIyU2ltcGxleFZlcnRleC5iMlNpbXBsZXhWZXJ0ZXguYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleFZlcnRleCA9IGIyU2ltcGxleFZlcnRleDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyVGltZU9mSW1wYWN0KCkge1xyXG4gICAgICBiMlRpbWVPZkltcGFjdC5iMlRpbWVPZkltcGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QgPSBiMlRpbWVPZkltcGFjdDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyVE9JSW5wdXQoKSB7XHJcbiAgICAgIGIyVE9JSW5wdXQuYjJUT0lJbnB1dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uYjJUT0lJbnB1dCA9IGIyVE9JSW5wdXQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMldvcmxkTWFuaWZvbGQoKSB7XHJcbiAgICAgIGIyV29ybGRNYW5pZm9sZC5iMldvcmxkTWFuaWZvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyV29ybGRNYW5pZm9sZCkgdGhpcy5iMldvcmxkTWFuaWZvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLmIyV29ybGRNYW5pZm9sZCA9IGIyV29ybGRNYW5pZm9sZDtcclxuXHJcbiAgIGZ1bmN0aW9uIENsaXBWZXJ0ZXgoKSB7XHJcbiAgICAgIENsaXBWZXJ0ZXguQ2xpcFZlcnRleC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uQ2xpcFZlcnRleCA9IENsaXBWZXJ0ZXg7XHJcblxyXG4gICBmdW5jdGlvbiBGZWF0dXJlcygpIHtcclxuICAgICAgRmVhdHVyZXMuRmVhdHVyZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29sbGlzaW9uLkZlYXR1cmVzID0gRmVhdHVyZXM7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNpcmNsZVNoYXBlKCkge1xyXG4gICAgICBiMkNpcmNsZVNoYXBlLmIyQ2lyY2xlU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQ2lyY2xlU2hhcGUpIHRoaXMuYjJDaXJjbGVTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyQ2lyY2xlU2hhcGUgPSBiMkNpcmNsZVNoYXBlO1xyXG5cclxuICAgZnVuY3Rpb24gYjJFZGdlQ2hhaW5EZWYoKSB7XHJcbiAgICAgIGIyRWRnZUNoYWluRGVmLmIyRWRnZUNoYWluRGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkVkZ2VDaGFpbkRlZikgdGhpcy5iMkVkZ2VDaGFpbkRlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZUNoYWluRGVmID0gYjJFZGdlQ2hhaW5EZWY7XHJcblxyXG4gICBmdW5jdGlvbiBiMkVkZ2VTaGFwZSgpIHtcclxuICAgICAgYjJFZGdlU2hhcGUuYjJFZGdlU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyRWRnZVNoYXBlKSB0aGlzLmIyRWRnZVNoYXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlU2hhcGUgPSBiMkVkZ2VTaGFwZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyTWFzc0RhdGEoKSB7XHJcbiAgICAgIGIyTWFzc0RhdGEuYjJNYXNzRGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyTWFzc0RhdGEgPSBiMk1hc3NEYXRhO1xyXG5cclxuICAgZnVuY3Rpb24gYjJQb2x5Z29uU2hhcGUoKSB7XHJcbiAgICAgIGIyUG9seWdvblNoYXBlLmIyUG9seWdvblNoYXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlBvbHlnb25TaGFwZSkgdGhpcy5iMlBvbHlnb25TaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyUG9seWdvblNoYXBlID0gYjJQb2x5Z29uU2hhcGU7XHJcblxyXG4gICBmdW5jdGlvbiBiMlNoYXBlKCkge1xyXG4gICAgICBiMlNoYXBlLmIyU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyU2hhcGUpIHRoaXMuYjJTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUgPSBiMlNoYXBlO1xyXG4gICBCb3gyRC5Db21tb24uYjJpbnRlcm5hbCA9ICdCb3gyRC5Db21tb24uYjJpbnRlcm5hbCc7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbG9yKCkge1xyXG4gICAgICBiMkNvbG9yLmIyQ29sb3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQ29sb3IpIHRoaXMuYjJDb2xvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db21tb24uYjJDb2xvciA9IGIyQ29sb3I7XHJcblxyXG4gICBmdW5jdGlvbiBiMlNldHRpbmdzKCkge1xyXG4gICAgICBiMlNldHRpbmdzLmIyU2V0dGluZ3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MgPSBiMlNldHRpbmdzO1xyXG5cclxuICAgZnVuY3Rpb24gYjJNYXQyMigpIHtcclxuICAgICAgYjJNYXQyMi5iMk1hdDIyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMk1hdDIyKSB0aGlzLmIyTWF0MjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29tbW9uLk1hdGguYjJNYXQyMiA9IGIyTWF0MjI7XHJcblxyXG4gICBmdW5jdGlvbiBiMk1hdDMzKCkge1xyXG4gICAgICBiMk1hdDMzLmIyTWF0MzMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyTWF0MzMpIHRoaXMuYjJNYXQzMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzID0gYjJNYXQzMztcclxuXHJcbiAgIGZ1bmN0aW9uIGIyTWF0aCgpIHtcclxuICAgICAgYjJNYXRoLmIyTWF0aC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGggPSBiMk1hdGg7XHJcblxyXG4gICBmdW5jdGlvbiBiMlN3ZWVwKCkge1xyXG4gICAgICBiMlN3ZWVwLmIyU3dlZXAuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29tbW9uLk1hdGguYjJTd2VlcCA9IGIyU3dlZXA7XHJcblxyXG4gICBmdW5jdGlvbiBiMlRyYW5zZm9ybSgpIHtcclxuICAgICAgYjJUcmFuc2Zvcm0uYjJUcmFuc2Zvcm0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyVHJhbnNmb3JtKSB0aGlzLmIyVHJhbnNmb3JtLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtID0gYjJUcmFuc2Zvcm07XHJcblxyXG4gICBmdW5jdGlvbiBiMlZlYzIoKSB7XHJcbiAgICAgIGIyVmVjMi5iMlZlYzIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyVmVjMikgdGhpcy5iMlZlYzIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyID0gYjJWZWMyO1xyXG5cclxuICAgZnVuY3Rpb24gYjJWZWMzKCkge1xyXG4gICAgICBiMlZlYzMuYjJWZWMzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMlZlYzMpIHRoaXMuYjJWZWMzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyA9IGIyVmVjMztcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQm9keSgpIHtcclxuICAgICAgYjJCb2R5LmIyQm9keS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJCb2R5KSB0aGlzLmIyQm9keS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMkJvZHkgPSBiMkJvZHk7XHJcblxyXG4gICBmdW5jdGlvbiBiMkJvZHlEZWYoKSB7XHJcbiAgICAgIGIyQm9keURlZi5iMkJvZHlEZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyQm9keURlZikgdGhpcy5iMkJvZHlEZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmID0gYjJCb2R5RGVmO1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0RmlsdGVyKCkge1xyXG4gICAgICBiMkNvbnRhY3RGaWx0ZXIuYjJDb250YWN0RmlsdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEZpbHRlciA9IGIyQ29udGFjdEZpbHRlcjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29udGFjdEltcHVsc2UoKSB7XHJcbiAgICAgIGIyQ29udGFjdEltcHVsc2UuYjJDb250YWN0SW1wdWxzZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RJbXB1bHNlID0gYjJDb250YWN0SW1wdWxzZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29udGFjdExpc3RlbmVyKCkge1xyXG4gICAgICBiMkNvbnRhY3RMaXN0ZW5lci5iMkNvbnRhY3RMaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RMaXN0ZW5lciA9IGIyQ29udGFjdExpc3RlbmVyO1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0TWFuYWdlcigpIHtcclxuICAgICAgYjJDb250YWN0TWFuYWdlci5iMkNvbnRhY3RNYW5hZ2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkNvbnRhY3RNYW5hZ2VyKSB0aGlzLmIyQ29udGFjdE1hbmFnZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuYjJDb250YWN0TWFuYWdlciA9IGIyQ29udGFjdE1hbmFnZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkRlYnVnRHJhdygpIHtcclxuICAgICAgYjJEZWJ1Z0RyYXcuYjJEZWJ1Z0RyYXcuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyRGVidWdEcmF3KSB0aGlzLmIyRGVidWdEcmF3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3ID0gYjJEZWJ1Z0RyYXc7XHJcblxyXG4gICBmdW5jdGlvbiBiMkRlc3RydWN0aW9uTGlzdGVuZXIoKSB7XHJcbiAgICAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lci5iMkRlc3RydWN0aW9uTGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuYjJEZXN0cnVjdGlvbkxpc3RlbmVyID0gYjJEZXN0cnVjdGlvbkxpc3RlbmVyO1xyXG5cclxuICAgZnVuY3Rpb24gYjJGaWx0ZXJEYXRhKCkge1xyXG4gICAgICBiMkZpbHRlckRhdGEuYjJGaWx0ZXJEYXRhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLmIyRmlsdGVyRGF0YSA9IGIyRmlsdGVyRGF0YTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRml4dHVyZSgpIHtcclxuICAgICAgYjJGaXh0dXJlLmIyRml4dHVyZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJGaXh0dXJlKSB0aGlzLmIyRml4dHVyZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMkZpeHR1cmUgPSBiMkZpeHR1cmU7XHJcblxyXG4gICBmdW5jdGlvbiBiMkZpeHR1cmVEZWYoKSB7XHJcbiAgICAgIGIyRml4dHVyZURlZi5iMkZpeHR1cmVEZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyRml4dHVyZURlZikgdGhpcy5iMkZpeHR1cmVEZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmID0gYjJGaXh0dXJlRGVmO1xyXG5cclxuICAgZnVuY3Rpb24gYjJJc2xhbmQoKSB7XHJcbiAgICAgIGIySXNsYW5kLmIySXNsYW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMklzbGFuZCkgdGhpcy5iMklzbGFuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5iMklzbGFuZCA9IGIySXNsYW5kO1xyXG5cclxuICAgZnVuY3Rpb24gYjJUaW1lU3RlcCgpIHtcclxuICAgICAgYjJUaW1lU3RlcC5iMlRpbWVTdGVwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLmIyVGltZVN0ZXAgPSBiMlRpbWVTdGVwO1xyXG5cclxuICAgZnVuY3Rpb24gYjJXb3JsZCgpIHtcclxuICAgICAgYjJXb3JsZC5iMldvcmxkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMldvcmxkKSB0aGlzLmIyV29ybGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZCA9IGIyV29ybGQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNpcmNsZUNvbnRhY3QoKSB7XHJcbiAgICAgIGIyQ2lyY2xlQ29udGFjdC5iMkNpcmNsZUNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDaXJjbGVDb250YWN0ID0gYjJDaXJjbGVDb250YWN0O1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0KCkge1xyXG4gICAgICBiMkNvbnRhY3QuYjJDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkNvbnRhY3QpIHRoaXMuYjJDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdCA9IGIyQ29udGFjdDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29udGFjdENvbnN0cmFpbnQoKSB7XHJcbiAgICAgIGIyQ29udGFjdENvbnN0cmFpbnQuYjJDb250YWN0Q29uc3RyYWludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJDb250YWN0Q29uc3RyYWludCkgdGhpcy5iMkNvbnRhY3RDb25zdHJhaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdENvbnN0cmFpbnQgPSBiMkNvbnRhY3RDb25zdHJhaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0Q29uc3RyYWludFBvaW50KCkge1xyXG4gICAgICBiMkNvbnRhY3RDb25zdHJhaW50UG9pbnQuYjJDb250YWN0Q29uc3RyYWludFBvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdENvbnN0cmFpbnRQb2ludCA9IGIyQ29udGFjdENvbnN0cmFpbnRQb2ludDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29udGFjdEVkZ2UoKSB7XHJcbiAgICAgIGIyQ29udGFjdEVkZ2UuYjJDb250YWN0RWRnZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RFZGdlID0gYjJDb250YWN0RWRnZTtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyQ29udGFjdEZhY3RvcnkoKSB7XHJcbiAgICAgIGIyQ29udGFjdEZhY3RvcnkuYjJDb250YWN0RmFjdG9yeS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJDb250YWN0RmFjdG9yeSkgdGhpcy5iMkNvbnRhY3RGYWN0b3J5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdEZhY3RvcnkgPSBiMkNvbnRhY3RGYWN0b3J5O1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0UmVnaXN0ZXIoKSB7XHJcbiAgICAgIGIyQ29udGFjdFJlZ2lzdGVyLmIyQ29udGFjdFJlZ2lzdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFJlZ2lzdGVyID0gYjJDb250YWN0UmVnaXN0ZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRhY3RSZXN1bHQoKSB7XHJcbiAgICAgIGIyQ29udGFjdFJlc3VsdC5iMkNvbnRhY3RSZXN1bHQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0UmVzdWx0ID0gYjJDb250YWN0UmVzdWx0O1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250YWN0U29sdmVyKCkge1xyXG4gICAgICBiMkNvbnRhY3RTb2x2ZXIuYjJDb250YWN0U29sdmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkNvbnRhY3RTb2x2ZXIpIHRoaXMuYjJDb250YWN0U29sdmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFNvbHZlciA9IGIyQ29udGFjdFNvbHZlcjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QoKSB7XHJcbiAgICAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QuYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkVkZ2VBbmRDaXJjbGVDb250YWN0ID0gYjJFZGdlQW5kQ2lyY2xlQ29udGFjdDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyTnVsbENvbnRhY3QoKSB7XHJcbiAgICAgIGIyTnVsbENvbnRhY3QuYjJOdWxsQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJOdWxsQ29udGFjdCkgdGhpcy5iMk51bGxDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyTnVsbENvbnRhY3QgPSBiMk51bGxDb250YWN0O1xyXG5cclxuICAgZnVuY3Rpb24gYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCgpIHtcclxuICAgICAgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdC5iMlBvbHlBbmRDaXJjbGVDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9seUFuZENpcmNsZUNvbnRhY3QgPSBiMlBvbHlBbmRDaXJjbGVDb250YWN0O1xyXG5cclxuICAgZnVuY3Rpb24gYjJQb2x5QW5kRWRnZUNvbnRhY3QoKSB7XHJcbiAgICAgIGIyUG9seUFuZEVkZ2VDb250YWN0LmIyUG9seUFuZEVkZ2VDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9seUFuZEVkZ2VDb250YWN0ID0gYjJQb2x5QW5kRWRnZUNvbnRhY3Q7XHJcblxyXG4gICBmdW5jdGlvbiBiMlBvbHlnb25Db250YWN0KCkge1xyXG4gICAgICBiMlBvbHlnb25Db250YWN0LmIyUG9seWdvbkNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5Z29uQ29udGFjdCA9IGIyUG9seWdvbkNvbnRhY3Q7XHJcblxyXG4gICBmdW5jdGlvbiBiMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQoKSB7XHJcbiAgICAgIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZC5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZCkgdGhpcy5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkID0gYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkO1xyXG5cclxuICAgZnVuY3Rpb24gYjJCdW95YW5jeUNvbnRyb2xsZXIoKSB7XHJcbiAgICAgIGIyQnVveWFuY3lDb250cm9sbGVyLmIyQnVveWFuY3lDb250cm9sbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQnVveWFuY3lDb250cm9sbGVyID0gYjJCdW95YW5jeUNvbnRyb2xsZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnN0YW50QWNjZWxDb250cm9sbGVyKCkge1xyXG4gICAgICBiMkNvbnN0YW50QWNjZWxDb250cm9sbGVyLmIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb25zdGFudEFjY2VsQ29udHJvbGxlciA9IGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyKCkge1xyXG4gICAgICBiMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyLmIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb25zdGFudEZvcmNlQ29udHJvbGxlciA9IGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXI7XHJcblxyXG4gICBmdW5jdGlvbiBiMkNvbnRyb2xsZXIoKSB7XHJcbiAgICAgIGIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyID0gYjJDb250cm9sbGVyO1xyXG5cclxuICAgZnVuY3Rpb24gYjJDb250cm9sbGVyRWRnZSgpIHtcclxuICAgICAgYjJDb250cm9sbGVyRWRnZS5iMkNvbnRyb2xsZXJFZGdlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlckVkZ2UgPSBiMkNvbnRyb2xsZXJFZGdlO1xyXG5cclxuICAgZnVuY3Rpb24gYjJHcmF2aXR5Q29udHJvbGxlcigpIHtcclxuICAgICAgYjJHcmF2aXR5Q29udHJvbGxlci5iMkdyYXZpdHlDb250cm9sbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyR3Jhdml0eUNvbnRyb2xsZXIgPSBiMkdyYXZpdHlDb250cm9sbGVyO1xyXG5cclxuICAgZnVuY3Rpb24gYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlcigpIHtcclxuICAgICAgYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlci5iMlRlbnNvckRhbXBpbmdDb250cm9sbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXIgPSBiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyO1xyXG5cclxuICAgZnVuY3Rpb24gYjJEaXN0YW5jZUpvaW50KCkge1xyXG4gICAgICBiMkRpc3RhbmNlSm9pbnQuYjJEaXN0YW5jZUpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkRpc3RhbmNlSm9pbnQpIHRoaXMuYjJEaXN0YW5jZUpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkRpc3RhbmNlSm9pbnQgPSBiMkRpc3RhbmNlSm9pbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkRpc3RhbmNlSm9pbnREZWYoKSB7XHJcbiAgICAgIGIyRGlzdGFuY2VKb2ludERlZi5iMkRpc3RhbmNlSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyRGlzdGFuY2VKb2ludERlZikgdGhpcy5iMkRpc3RhbmNlSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRGlzdGFuY2VKb2ludERlZiA9IGIyRGlzdGFuY2VKb2ludERlZjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyRnJpY3Rpb25Kb2ludCgpIHtcclxuICAgICAgYjJGcmljdGlvbkpvaW50LmIyRnJpY3Rpb25Kb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJGcmljdGlvbkpvaW50KSB0aGlzLmIyRnJpY3Rpb25Kb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJGcmljdGlvbkpvaW50ID0gYjJGcmljdGlvbkpvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJGcmljdGlvbkpvaW50RGVmKCkge1xyXG4gICAgICBiMkZyaWN0aW9uSm9pbnREZWYuYjJGcmljdGlvbkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkZyaWN0aW9uSm9pbnREZWYpIHRoaXMuYjJGcmljdGlvbkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkZyaWN0aW9uSm9pbnREZWYgPSBiMkZyaWN0aW9uSm9pbnREZWY7XHJcblxyXG4gICBmdW5jdGlvbiBiMkdlYXJKb2ludCgpIHtcclxuICAgICAgYjJHZWFySm9pbnQuYjJHZWFySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyR2VhckpvaW50KSB0aGlzLmIyR2VhckpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkdlYXJKb2ludCA9IGIyR2VhckpvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJHZWFySm9pbnREZWYoKSB7XHJcbiAgICAgIGIyR2VhckpvaW50RGVmLmIyR2VhckpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkdlYXJKb2ludERlZikgdGhpcy5iMkdlYXJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJHZWFySm9pbnREZWYgPSBiMkdlYXJKb2ludERlZjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIySmFjb2JpYW4oKSB7XHJcbiAgICAgIGIySmFjb2JpYW4uYjJKYWNvYmlhbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKYWNvYmlhbiA9IGIySmFjb2JpYW47XHJcblxyXG4gICBmdW5jdGlvbiBiMkpvaW50KCkge1xyXG4gICAgICBiMkpvaW50LmIySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIySm9pbnQpIHRoaXMuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCA9IGIySm9pbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMkpvaW50RGVmKCkge1xyXG4gICAgICBiMkpvaW50RGVmLmIySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIySm9pbnREZWYpIHRoaXMuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZiA9IGIySm9pbnREZWY7XHJcblxyXG4gICBmdW5jdGlvbiBiMkpvaW50RWRnZSgpIHtcclxuICAgICAgYjJKb2ludEVkZ2UuYjJKb2ludEVkZ2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnRFZGdlID0gYjJKb2ludEVkZ2U7XHJcblxyXG4gICBmdW5jdGlvbiBiMkxpbmVKb2ludCgpIHtcclxuICAgICAgYjJMaW5lSm9pbnQuYjJMaW5lSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyTGluZUpvaW50KSB0aGlzLmIyTGluZUpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkxpbmVKb2ludCA9IGIyTGluZUpvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJMaW5lSm9pbnREZWYoKSB7XHJcbiAgICAgIGIyTGluZUpvaW50RGVmLmIyTGluZUpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMkxpbmVKb2ludERlZikgdGhpcy5iMkxpbmVKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJMaW5lSm9pbnREZWYgPSBiMkxpbmVKb2ludERlZjtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyTW91c2VKb2ludCgpIHtcclxuICAgICAgYjJNb3VzZUpvaW50LmIyTW91c2VKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJNb3VzZUpvaW50KSB0aGlzLmIyTW91c2VKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJNb3VzZUpvaW50ID0gYjJNb3VzZUpvaW50O1xyXG5cclxuICAgZnVuY3Rpb24gYjJNb3VzZUpvaW50RGVmKCkge1xyXG4gICAgICBiMk1vdXNlSm9pbnREZWYuYjJNb3VzZUpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMk1vdXNlSm9pbnREZWYpIHRoaXMuYjJNb3VzZUpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMk1vdXNlSm9pbnREZWYgPSBiMk1vdXNlSm9pbnREZWY7XHJcblxyXG4gICBmdW5jdGlvbiBiMlByaXNtYXRpY0pvaW50KCkge1xyXG4gICAgICBiMlByaXNtYXRpY0pvaW50LmIyUHJpc21hdGljSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyUHJpc21hdGljSm9pbnQpIHRoaXMuYjJQcmlzbWF0aWNKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQcmlzbWF0aWNKb2ludCA9IGIyUHJpc21hdGljSm9pbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMlByaXNtYXRpY0pvaW50RGVmKCkge1xyXG4gICAgICBiMlByaXNtYXRpY0pvaW50RGVmLmIyUHJpc21hdGljSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyUHJpc21hdGljSm9pbnREZWYpIHRoaXMuYjJQcmlzbWF0aWNKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQcmlzbWF0aWNKb2ludERlZiA9IGIyUHJpc21hdGljSm9pbnREZWY7XHJcblxyXG4gICBmdW5jdGlvbiBiMlB1bGxleUpvaW50KCkge1xyXG4gICAgICBiMlB1bGxleUpvaW50LmIyUHVsbGV5Sm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyUHVsbGV5Sm9pbnQpIHRoaXMuYjJQdWxsZXlKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQdWxsZXlKb2ludCA9IGIyUHVsbGV5Sm9pbnQ7XHJcblxyXG4gICBmdW5jdGlvbiBiMlB1bGxleUpvaW50RGVmKCkge1xyXG4gICAgICBiMlB1bGxleUpvaW50RGVmLmIyUHVsbGV5Sm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyUHVsbGV5Sm9pbnREZWYpIHRoaXMuYjJQdWxsZXlKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQdWxsZXlKb2ludERlZiA9IGIyUHVsbGV5Sm9pbnREZWY7XHJcblxyXG4gICBmdW5jdGlvbiBiMlJldm9sdXRlSm9pbnQoKSB7XHJcbiAgICAgIGIyUmV2b2x1dGVKb2ludC5iMlJldm9sdXRlSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IGIyUmV2b2x1dGVKb2ludCkgdGhpcy5iMlJldm9sdXRlSm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUmV2b2x1dGVKb2ludCA9IGIyUmV2b2x1dGVKb2ludDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyUmV2b2x1dGVKb2ludERlZigpIHtcclxuICAgICAgYjJSZXZvbHV0ZUpvaW50RGVmLmIyUmV2b2x1dGVKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJSZXZvbHV0ZUpvaW50RGVmKSB0aGlzLmIyUmV2b2x1dGVKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJSZXZvbHV0ZUpvaW50RGVmID0gYjJSZXZvbHV0ZUpvaW50RGVmO1xyXG5cclxuICAgZnVuY3Rpb24gYjJXZWxkSm9pbnQoKSB7XHJcbiAgICAgIGIyV2VsZEpvaW50LmIyV2VsZEpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yID09PSBiMldlbGRKb2ludCkgdGhpcy5iMldlbGRKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJXZWxkSm9pbnQgPSBiMldlbGRKb2ludDtcclxuXHJcbiAgIGZ1bmN0aW9uIGIyV2VsZEpvaW50RGVmKCkge1xyXG4gICAgICBiMldlbGRKb2ludERlZi5iMldlbGRKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICBpZiAodGhpcy5jb25zdHJ1Y3RvciA9PT0gYjJXZWxkSm9pbnREZWYpIHRoaXMuYjJXZWxkSm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyV2VsZEpvaW50RGVmID0gYjJXZWxkSm9pbnREZWY7XHJcbn0pKCk7IC8vZGVmaW5pdGlvbnNcclxuQm94MkQucG9zdERlZnMgPSBbXTtcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgdmFyIGIyQ2lyY2xlU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyQ2lyY2xlU2hhcGUsXHJcbiAgICAgIGIyRWRnZUNoYWluRGVmID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VDaGFpbkRlZixcclxuICAgICAgYjJFZGdlU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZVNoYXBlLFxyXG4gICAgICBiMk1hc3NEYXRhID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMk1hc3NEYXRhLFxyXG4gICAgICBiMlBvbHlnb25TaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJQb2x5Z29uU2hhcGUsXHJcbiAgICAgIGIyU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUsXHJcbiAgICAgIGIyQ29sb3IgPSBCb3gyRC5Db21tb24uYjJDb2xvcixcclxuICAgICAgYjJpbnRlcm5hbCA9IEJveDJELkNvbW1vbi5iMmludGVybmFsLFxyXG4gICAgICBiMlNldHRpbmdzID0gQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MsXHJcbiAgICAgIGIyTWF0MjIgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDIyLFxyXG4gICAgICBiMk1hdDMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQzMyxcclxuICAgICAgYjJNYXRoID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLFxyXG4gICAgICBiMlN3ZWVwID0gQm94MkQuQ29tbW9uLk1hdGguYjJTd2VlcCxcclxuICAgICAgYjJUcmFuc2Zvcm0gPSBCb3gyRC5Db21tb24uTWF0aC5iMlRyYW5zZm9ybSxcclxuICAgICAgYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyLFxyXG4gICAgICBiMlZlYzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzMsXHJcbiAgICAgIGIyQUFCQiA9IEJveDJELkNvbGxpc2lvbi5iMkFBQkIsXHJcbiAgICAgIGIyQm91bmQgPSBCb3gyRC5Db2xsaXNpb24uYjJCb3VuZCxcclxuICAgICAgYjJCb3VuZFZhbHVlcyA9IEJveDJELkNvbGxpc2lvbi5iMkJvdW5kVmFsdWVzLFxyXG4gICAgICBiMkNvbGxpc2lvbiA9IEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbixcclxuICAgICAgYjJDb250YWN0SUQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0SUQsXHJcbiAgICAgIGIyQ29udGFjdFBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyQ29udGFjdFBvaW50LFxyXG4gICAgICBiMkRpc3RhbmNlID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2UsXHJcbiAgICAgIGIyRGlzdGFuY2VJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlSW5wdXQsXHJcbiAgICAgIGIyRGlzdGFuY2VPdXRwdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZU91dHB1dCxcclxuICAgICAgYjJEaXN0YW5jZVByb3h5ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VQcm94eSxcclxuICAgICAgYjJEeW5hbWljVHJlZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlLFxyXG4gICAgICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSxcclxuICAgICAgYjJEeW5hbWljVHJlZU5vZGUgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZU5vZGUsXHJcbiAgICAgIGIyRHluYW1pY1RyZWVQYWlyID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVQYWlyLFxyXG4gICAgICBiMk1hbmlmb2xkID0gQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGQsXHJcbiAgICAgIGIyTWFuaWZvbGRQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkUG9pbnQsXHJcbiAgICAgIGIyUG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJQb2ludCxcclxuICAgICAgYjJSYXlDYXN0SW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJSYXlDYXN0SW5wdXQsXHJcbiAgICAgIGIyUmF5Q2FzdE91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RPdXRwdXQsXHJcbiAgICAgIGIyU2VnbWVudCA9IEJveDJELkNvbGxpc2lvbi5iMlNlZ21lbnQsXHJcbiAgICAgIGIyU2VwYXJhdGlvbkZ1bmN0aW9uID0gQm94MkQuQ29sbGlzaW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uLFxyXG4gICAgICBiMlNpbXBsZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4LFxyXG4gICAgICBiMlNpbXBsZXhDYWNoZSA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXhDYWNoZSxcclxuICAgICAgYjJTaW1wbGV4VmVydGV4ID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleFZlcnRleCxcclxuICAgICAgYjJUaW1lT2ZJbXBhY3QgPSBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QsXHJcbiAgICAgIGIyVE9JSW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJUT0lJbnB1dCxcclxuICAgICAgYjJXb3JsZE1hbmlmb2xkID0gQm94MkQuQ29sbGlzaW9uLmIyV29ybGRNYW5pZm9sZCxcclxuICAgICAgQ2xpcFZlcnRleCA9IEJveDJELkNvbGxpc2lvbi5DbGlwVmVydGV4LFxyXG4gICAgICBGZWF0dXJlcyA9IEJveDJELkNvbGxpc2lvbi5GZWF0dXJlcyxcclxuICAgICAgSUJyb2FkUGhhc2UgPSBCb3gyRC5Db2xsaXNpb24uSUJyb2FkUGhhc2U7XHJcblxyXG4gICBiMkFBQkIuYjJBQUJCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmxvd2VyQm91bmQgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMudXBwZXJCb3VuZCA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJBQUJCLnByb3RvdHlwZS5Jc1ZhbGlkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgZFggPSB0aGlzLnVwcGVyQm91bmQueCAtIHRoaXMubG93ZXJCb3VuZC54O1xyXG4gICAgICB2YXIgZFkgPSB0aGlzLnVwcGVyQm91bmQueSAtIHRoaXMubG93ZXJCb3VuZC55O1xyXG4gICAgICB2YXIgdmFsaWQgPSBkWCA+PSAwLjAgJiYgZFkgPj0gMC4wO1xyXG4gICAgICB2YWxpZCA9IHZhbGlkICYmIHRoaXMubG93ZXJCb3VuZC5Jc1ZhbGlkKCkgJiYgdGhpcy51cHBlckJvdW5kLklzVmFsaWQoKTtcclxuICAgICAgcmV0dXJuIHZhbGlkO1xyXG4gICB9XHJcbiAgIGIyQUFCQi5wcm90b3R5cGUuR2V0Q2VudGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMigodGhpcy5sb3dlckJvdW5kLnggKyB0aGlzLnVwcGVyQm91bmQueCkgLyAyLCAodGhpcy5sb3dlckJvdW5kLnkgKyB0aGlzLnVwcGVyQm91bmQueSkgLyAyKTtcclxuICAgfVxyXG4gICBiMkFBQkIucHJvdG90eXBlLkdldEV4dGVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKCh0aGlzLnVwcGVyQm91bmQueCAtIHRoaXMubG93ZXJCb3VuZC54KSAvIDIsICh0aGlzLnVwcGVyQm91bmQueSAtIHRoaXMubG93ZXJCb3VuZC55KSAvIDIpO1xyXG4gICB9XHJcbiAgIGIyQUFCQi5wcm90b3R5cGUuQ29udGFpbnMgPSBmdW5jdGlvbiAoYWFiYikge1xyXG4gICAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIHRoaXMubG93ZXJCb3VuZC54IDw9IGFhYmIubG93ZXJCb3VuZC54O1xyXG4gICAgICByZXN1bHQgPSByZXN1bHQgJiYgdGhpcy5sb3dlckJvdW5kLnkgPD0gYWFiYi5sb3dlckJvdW5kLnk7XHJcbiAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBhYWJiLnVwcGVyQm91bmQueCA8PSB0aGlzLnVwcGVyQm91bmQueDtcclxuICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIGFhYmIudXBwZXJCb3VuZC55IDw9IHRoaXMudXBwZXJCb3VuZC55O1xyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICB9XHJcbiAgIGIyQUFCQi5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChvdXRwdXQsIGlucHV0KSB7XHJcbiAgICAgIHZhciB0bWluID0gKC1OdW1iZXIuTUFYX1ZBTFVFKTtcclxuICAgICAgdmFyIHRtYXggPSBOdW1iZXIuTUFYX1ZBTFVFO1xyXG4gICAgICB2YXIgcFggPSBpbnB1dC5wMS54O1xyXG4gICAgICB2YXIgcFkgPSBpbnB1dC5wMS55O1xyXG4gICAgICB2YXIgZFggPSBpbnB1dC5wMi54IC0gaW5wdXQucDEueDtcclxuICAgICAgdmFyIGRZID0gaW5wdXQucDIueSAtIGlucHV0LnAxLnk7XHJcbiAgICAgIHZhciBhYnNEWCA9IE1hdGguYWJzKGRYKTtcclxuICAgICAgdmFyIGFic0RZID0gTWF0aC5hYnMoZFkpO1xyXG4gICAgICB2YXIgbm9ybWFsID0gb3V0cHV0Lm5vcm1hbDtcclxuICAgICAgdmFyIGludl9kID0gMDtcclxuICAgICAgdmFyIHQxID0gMDtcclxuICAgICAgdmFyIHQyID0gMDtcclxuICAgICAgdmFyIHQzID0gMDtcclxuICAgICAgdmFyIHMgPSAwOyB7XHJcbiAgICAgICAgIGlmIChhYnNEWCA8IE51bWJlci5NSU5fVkFMVUUpIHtcclxuICAgICAgICAgICAgaWYgKHBYIDwgdGhpcy5sb3dlckJvdW5kLnggfHwgdGhpcy51cHBlckJvdW5kLnggPCBwWCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpbnZfZCA9IDEuMCAvIGRYO1xyXG4gICAgICAgICAgICB0MSA9ICh0aGlzLmxvd2VyQm91bmQueCAtIHBYKSAqIGludl9kO1xyXG4gICAgICAgICAgICB0MiA9ICh0aGlzLnVwcGVyQm91bmQueCAtIHBYKSAqIGludl9kO1xyXG4gICAgICAgICAgICBzID0gKC0xLjApO1xyXG4gICAgICAgICAgICBpZiAodDEgPiB0Mikge1xyXG4gICAgICAgICAgICAgICB0MyA9IHQxO1xyXG4gICAgICAgICAgICAgICB0MSA9IHQyO1xyXG4gICAgICAgICAgICAgICB0MiA9IHQzO1xyXG4gICAgICAgICAgICAgICBzID0gMS4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0MSA+IHRtaW4pIHtcclxuICAgICAgICAgICAgICAgbm9ybWFsLnggPSBzO1xyXG4gICAgICAgICAgICAgICBub3JtYWwueSA9IDA7XHJcbiAgICAgICAgICAgICAgIHRtaW4gPSB0MTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0bWF4ID0gTWF0aC5taW4odG1heCwgdDIpO1xyXG4gICAgICAgICAgICBpZiAodG1pbiA+IHRtYXgpIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgfVxyXG4gICAgICB9IHtcclxuICAgICAgICAgaWYgKGFic0RZIDwgTnVtYmVyLk1JTl9WQUxVRSkge1xyXG4gICAgICAgICAgICBpZiAocFkgPCB0aGlzLmxvd2VyQm91bmQueSB8fCB0aGlzLnVwcGVyQm91bmQueSA8IHBZKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGludl9kID0gMS4wIC8gZFk7XHJcbiAgICAgICAgICAgIHQxID0gKHRoaXMubG93ZXJCb3VuZC55IC0gcFkpICogaW52X2Q7XHJcbiAgICAgICAgICAgIHQyID0gKHRoaXMudXBwZXJCb3VuZC55IC0gcFkpICogaW52X2Q7XHJcbiAgICAgICAgICAgIHMgPSAoLTEuMCk7XHJcbiAgICAgICAgICAgIGlmICh0MSA+IHQyKSB7XHJcbiAgICAgICAgICAgICAgIHQzID0gdDE7XHJcbiAgICAgICAgICAgICAgIHQxID0gdDI7XHJcbiAgICAgICAgICAgICAgIHQyID0gdDM7XHJcbiAgICAgICAgICAgICAgIHMgPSAxLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQxID4gdG1pbikge1xyXG4gICAgICAgICAgICAgICBub3JtYWwueSA9IHM7XHJcbiAgICAgICAgICAgICAgIG5vcm1hbC54ID0gMDtcclxuICAgICAgICAgICAgICAgdG1pbiA9IHQxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRtYXggPSBNYXRoLm1pbih0bWF4LCB0Mik7XHJcbiAgICAgICAgICAgIGlmICh0bWluID4gdG1heCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgb3V0cHV0LmZyYWN0aW9uID0gdG1pbjtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgYjJBQUJCLnByb3RvdHlwZS5UZXN0T3ZlcmxhcCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICB2YXIgZDFYID0gb3RoZXIubG93ZXJCb3VuZC54IC0gdGhpcy51cHBlckJvdW5kLng7XHJcbiAgICAgIHZhciBkMVkgPSBvdGhlci5sb3dlckJvdW5kLnkgLSB0aGlzLnVwcGVyQm91bmQueTtcclxuICAgICAgdmFyIGQyWCA9IHRoaXMubG93ZXJCb3VuZC54IC0gb3RoZXIudXBwZXJCb3VuZC54O1xyXG4gICAgICB2YXIgZDJZID0gdGhpcy5sb3dlckJvdW5kLnkgLSBvdGhlci51cHBlckJvdW5kLnk7XHJcbiAgICAgIGlmIChkMVggPiAwLjAgfHwgZDFZID4gMC4wKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGlmIChkMlggPiAwLjAgfHwgZDJZID4gMC4wKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICB9XHJcbiAgIGIyQUFCQi5Db21iaW5lID0gZnVuY3Rpb24gKGFhYmIxLCBhYWJiMikge1xyXG4gICAgICB2YXIgYWFiYiA9IG5ldyBiMkFBQkIoKTtcclxuICAgICAgYWFiYi5Db21iaW5lKGFhYmIxLCBhYWJiMik7XHJcbiAgICAgIHJldHVybiBhYWJiO1xyXG4gICB9XHJcbiAgIGIyQUFCQi5wcm90b3R5cGUuQ29tYmluZSA9IGZ1bmN0aW9uIChhYWJiMSwgYWFiYjIpIHtcclxuICAgICAgdGhpcy5sb3dlckJvdW5kLnggPSBNYXRoLm1pbihhYWJiMS5sb3dlckJvdW5kLngsIGFhYmIyLmxvd2VyQm91bmQueCk7XHJcbiAgICAgIHRoaXMubG93ZXJCb3VuZC55ID0gTWF0aC5taW4oYWFiYjEubG93ZXJCb3VuZC55LCBhYWJiMi5sb3dlckJvdW5kLnkpO1xyXG4gICAgICB0aGlzLnVwcGVyQm91bmQueCA9IE1hdGgubWF4KGFhYmIxLnVwcGVyQm91bmQueCwgYWFiYjIudXBwZXJCb3VuZC54KTtcclxuICAgICAgdGhpcy51cHBlckJvdW5kLnkgPSBNYXRoLm1heChhYWJiMS51cHBlckJvdW5kLnksIGFhYmIyLnVwcGVyQm91bmQueSk7XHJcbiAgIH1cclxuICAgYjJCb3VuZC5iMkJvdW5kID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyQm91bmQucHJvdG90eXBlLklzTG93ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy52YWx1ZSAmIDEpID09IDA7XHJcbiAgIH1cclxuICAgYjJCb3VuZC5wcm90b3R5cGUuSXNVcHBlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLnZhbHVlICYgMSkgPT0gMTtcclxuICAgfVxyXG4gICBiMkJvdW5kLnByb3RvdHlwZS5Td2FwID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgdmFyIHRlbXBWYWx1ZSA9IHRoaXMudmFsdWU7XHJcbiAgICAgIHZhciB0ZW1wUHJveHkgPSB0aGlzLnByb3h5O1xyXG4gICAgICB2YXIgdGVtcFN0YWJiaW5nQ291bnQgPSB0aGlzLnN0YWJiaW5nQ291bnQ7XHJcbiAgICAgIHRoaXMudmFsdWUgPSBiLnZhbHVlO1xyXG4gICAgICB0aGlzLnByb3h5ID0gYi5wcm94eTtcclxuICAgICAgdGhpcy5zdGFiYmluZ0NvdW50ID0gYi5zdGFiYmluZ0NvdW50O1xyXG4gICAgICBiLnZhbHVlID0gdGVtcFZhbHVlO1xyXG4gICAgICBiLnByb3h5ID0gdGVtcFByb3h5O1xyXG4gICAgICBiLnN0YWJiaW5nQ291bnQgPSB0ZW1wU3RhYmJpbmdDb3VudDtcclxuICAgfVxyXG4gICBiMkJvdW5kVmFsdWVzLmIyQm91bmRWYWx1ZXMgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJCb3VuZFZhbHVlcy5wcm90b3R5cGUuYjJCb3VuZFZhbHVlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5sb3dlclZhbHVlcyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigpO1xyXG4gICAgICB0aGlzLmxvd2VyVmFsdWVzWzBdID0gMC4wO1xyXG4gICAgICB0aGlzLmxvd2VyVmFsdWVzWzFdID0gMC4wO1xyXG4gICAgICB0aGlzLnVwcGVyVmFsdWVzID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKCk7XHJcbiAgICAgIHRoaXMudXBwZXJWYWx1ZXNbMF0gPSAwLjA7XHJcbiAgICAgIHRoaXMudXBwZXJWYWx1ZXNbMV0gPSAwLjA7XHJcbiAgIH1cclxuICAgYjJDb2xsaXNpb24uYjJDb2xsaXNpb24gPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJDb2xsaXNpb24uQ2xpcFNlZ21lbnRUb0xpbmUgPSBmdW5jdGlvbiAodk91dCwgdkluLCBub3JtYWwsIG9mZnNldCkge1xyXG4gICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7XHJcbiAgICAgIHZhciBjdjtcclxuICAgICAgdmFyIG51bU91dCA9IDA7XHJcbiAgICAgIGN2ID0gdkluWzBdO1xyXG4gICAgICB2YXIgdkluMCA9IGN2LnY7XHJcbiAgICAgIGN2ID0gdkluWzFdO1xyXG4gICAgICB2YXIgdkluMSA9IGN2LnY7XHJcbiAgICAgIHZhciBkaXN0YW5jZTAgPSBub3JtYWwueCAqIHZJbjAueCArIG5vcm1hbC55ICogdkluMC55IC0gb2Zmc2V0O1xyXG4gICAgICB2YXIgZGlzdGFuY2UxID0gbm9ybWFsLnggKiB2SW4xLnggKyBub3JtYWwueSAqIHZJbjEueSAtIG9mZnNldDtcclxuICAgICAgaWYgKGRpc3RhbmNlMCA8PSAwLjApIHZPdXRbbnVtT3V0KytdLlNldCh2SW5bMF0pO1xyXG4gICAgICBpZiAoZGlzdGFuY2UxIDw9IDAuMCkgdk91dFtudW1PdXQrK10uU2V0KHZJblsxXSk7XHJcbiAgICAgIGlmIChkaXN0YW5jZTAgKiBkaXN0YW5jZTEgPCAwLjApIHtcclxuICAgICAgICAgdmFyIGludGVycCA9IGRpc3RhbmNlMCAvIChkaXN0YW5jZTAgLSBkaXN0YW5jZTEpO1xyXG4gICAgICAgICBjdiA9IHZPdXRbbnVtT3V0XTtcclxuICAgICAgICAgdmFyIHRWZWMgPSBjdi52O1xyXG4gICAgICAgICB0VmVjLnggPSB2SW4wLnggKyBpbnRlcnAgKiAodkluMS54IC0gdkluMC54KTtcclxuICAgICAgICAgdFZlYy55ID0gdkluMC55ICsgaW50ZXJwICogKHZJbjEueSAtIHZJbjAueSk7XHJcbiAgICAgICAgIGN2ID0gdk91dFtudW1PdXRdO1xyXG4gICAgICAgICB2YXIgY3YyO1xyXG4gICAgICAgICBpZiAoZGlzdGFuY2UwID4gMC4wKSB7XHJcbiAgICAgICAgICAgIGN2MiA9IHZJblswXTtcclxuICAgICAgICAgICAgY3YuaWQgPSBjdjIuaWQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGN2MiA9IHZJblsxXTtcclxuICAgICAgICAgICAgY3YuaWQgPSBjdjIuaWQ7XHJcbiAgICAgICAgIH0rK251bU91dDtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVtT3V0O1xyXG4gICB9XHJcbiAgIGIyQ29sbGlzaW9uLkVkZ2VTZXBhcmF0aW9uID0gZnVuY3Rpb24gKHBvbHkxLCB4ZjEsIGVkZ2UxLCBwb2x5MiwgeGYyKSB7XHJcbiAgICAgIGlmIChlZGdlMSA9PT0gdW5kZWZpbmVkKSBlZGdlMSA9IDA7XHJcbiAgICAgIHZhciBjb3VudDEgPSBwYXJzZUludChwb2x5MS5tX3ZlcnRleENvdW50KTtcclxuICAgICAgdmFyIHZlcnRpY2VzMSA9IHBvbHkxLm1fdmVydGljZXM7XHJcbiAgICAgIHZhciBub3JtYWxzMSA9IHBvbHkxLm1fbm9ybWFscztcclxuICAgICAgdmFyIGNvdW50MiA9IHBhcnNlSW50KHBvbHkyLm1fdmVydGV4Q291bnQpO1xyXG4gICAgICB2YXIgdmVydGljZXMyID0gcG9seTIubV92ZXJ0aWNlcztcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICB0TWF0ID0geGYxLlI7XHJcbiAgICAgIHRWZWMgPSBub3JtYWxzMVtlZGdlMV07XHJcbiAgICAgIHZhciBub3JtYWwxV29ybGRYID0gKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB2YXIgbm9ybWFsMVdvcmxkWSA9ICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgdE1hdCA9IHhmMi5SO1xyXG4gICAgICB2YXIgbm9ybWFsMVggPSAodE1hdC5jb2wxLnggKiBub3JtYWwxV29ybGRYICsgdE1hdC5jb2wxLnkgKiBub3JtYWwxV29ybGRZKTtcclxuICAgICAgdmFyIG5vcm1hbDFZID0gKHRNYXQuY29sMi54ICogbm9ybWFsMVdvcmxkWCArIHRNYXQuY29sMi55ICogbm9ybWFsMVdvcmxkWSk7XHJcbiAgICAgIHZhciBpbmRleCA9IDA7XHJcbiAgICAgIHZhciBtaW5Eb3QgPSBOdW1iZXIuTUFYX1ZBTFVFO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50MjsgKytpKSB7XHJcbiAgICAgICAgIHRWZWMgPSB2ZXJ0aWNlczJbaV07XHJcbiAgICAgICAgIHZhciBkb3QgPSB0VmVjLnggKiBub3JtYWwxWCArIHRWZWMueSAqIG5vcm1hbDFZO1xyXG4gICAgICAgICBpZiAoZG90IDwgbWluRG90KSB7XHJcbiAgICAgICAgICAgIG1pbkRvdCA9IGRvdDtcclxuICAgICAgICAgICAgaW5kZXggPSBpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdFZlYyA9IHZlcnRpY2VzMVtlZGdlMV07XHJcbiAgICAgIHRNYXQgPSB4ZjEuUjtcclxuICAgICAgdmFyIHYxWCA9IHhmMS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB2YXIgdjFZID0geGYxLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHRWZWMgPSB2ZXJ0aWNlczJbaW5kZXhdO1xyXG4gICAgICB0TWF0ID0geGYyLlI7XHJcbiAgICAgIHZhciB2MlggPSB4ZjIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgdmFyIHYyWSA9IHhmMi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB2MlggLT0gdjFYO1xyXG4gICAgICB2MlkgLT0gdjFZO1xyXG4gICAgICB2YXIgc2VwYXJhdGlvbiA9IHYyWCAqIG5vcm1hbDFXb3JsZFggKyB2MlkgKiBub3JtYWwxV29ybGRZO1xyXG4gICAgICByZXR1cm4gc2VwYXJhdGlvbjtcclxuICAgfVxyXG4gICBiMkNvbGxpc2lvbi5GaW5kTWF4U2VwYXJhdGlvbiA9IGZ1bmN0aW9uIChlZGdlSW5kZXgsIHBvbHkxLCB4ZjEsIHBvbHkyLCB4ZjIpIHtcclxuICAgICAgdmFyIGNvdW50MSA9IHBhcnNlSW50KHBvbHkxLm1fdmVydGV4Q291bnQpO1xyXG4gICAgICB2YXIgbm9ybWFsczEgPSBwb2x5MS5tX25vcm1hbHM7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdE1hdCA9IHhmMi5SO1xyXG4gICAgICB0VmVjID0gcG9seTIubV9jZW50cm9pZDtcclxuICAgICAgdmFyIGRYID0geGYyLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHZhciBkWSA9IHhmMi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB0TWF0ID0geGYxLlI7XHJcbiAgICAgIHRWZWMgPSBwb2x5MS5tX2NlbnRyb2lkO1xyXG4gICAgICBkWCAtPSB4ZjEucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgZFkgLT0geGYxLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHZhciBkTG9jYWwxWCA9IChkWCAqIHhmMS5SLmNvbDEueCArIGRZICogeGYxLlIuY29sMS55KTtcclxuICAgICAgdmFyIGRMb2NhbDFZID0gKGRYICogeGYxLlIuY29sMi54ICsgZFkgKiB4ZjEuUi5jb2wyLnkpO1xyXG4gICAgICB2YXIgZWRnZSA9IDA7XHJcbiAgICAgIHZhciBtYXhEb3QgPSAoLU51bWJlci5NQVhfVkFMVUUpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50MTsgKytpKSB7XHJcbiAgICAgICAgIHRWZWMgPSBub3JtYWxzMVtpXTtcclxuICAgICAgICAgdmFyIGRvdCA9ICh0VmVjLnggKiBkTG9jYWwxWCArIHRWZWMueSAqIGRMb2NhbDFZKTtcclxuICAgICAgICAgaWYgKGRvdCA+IG1heERvdCkge1xyXG4gICAgICAgICAgICBtYXhEb3QgPSBkb3Q7XHJcbiAgICAgICAgICAgIGVkZ2UgPSBpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdmFyIHMgPSBiMkNvbGxpc2lvbi5FZGdlU2VwYXJhdGlvbihwb2x5MSwgeGYxLCBlZGdlLCBwb2x5MiwgeGYyKTtcclxuICAgICAgdmFyIHByZXZFZGdlID0gcGFyc2VJbnQoZWRnZSAtIDEgPj0gMCA/IGVkZ2UgLSAxIDogY291bnQxIC0gMSk7XHJcbiAgICAgIHZhciBzUHJldiA9IGIyQ29sbGlzaW9uLkVkZ2VTZXBhcmF0aW9uKHBvbHkxLCB4ZjEsIHByZXZFZGdlLCBwb2x5MiwgeGYyKTtcclxuICAgICAgdmFyIG5leHRFZGdlID0gcGFyc2VJbnQoZWRnZSArIDEgPCBjb3VudDEgPyBlZGdlICsgMSA6IDApO1xyXG4gICAgICB2YXIgc05leHQgPSBiMkNvbGxpc2lvbi5FZGdlU2VwYXJhdGlvbihwb2x5MSwgeGYxLCBuZXh0RWRnZSwgcG9seTIsIHhmMik7XHJcbiAgICAgIHZhciBiZXN0RWRnZSA9IDA7XHJcbiAgICAgIHZhciBiZXN0U2VwYXJhdGlvbiA9IDA7XHJcbiAgICAgIHZhciBpbmNyZW1lbnQgPSAwO1xyXG4gICAgICBpZiAoc1ByZXYgPiBzICYmIHNQcmV2ID4gc05leHQpIHtcclxuICAgICAgICAgaW5jcmVtZW50ID0gKC0xKTtcclxuICAgICAgICAgYmVzdEVkZ2UgPSBwcmV2RWRnZTtcclxuICAgICAgICAgYmVzdFNlcGFyYXRpb24gPSBzUHJldjtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmIChzTmV4dCA+IHMpIHtcclxuICAgICAgICAgaW5jcmVtZW50ID0gMTtcclxuICAgICAgICAgYmVzdEVkZ2UgPSBuZXh0RWRnZTtcclxuICAgICAgICAgYmVzdFNlcGFyYXRpb24gPSBzTmV4dDtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgZWRnZUluZGV4WzBdID0gZWRnZTtcclxuICAgICAgICAgcmV0dXJuIHM7XHJcbiAgICAgIH1cclxuICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgaWYgKGluY3JlbWVudCA9PSAoLTEpKSBlZGdlID0gYmVzdEVkZ2UgLSAxID49IDAgPyBiZXN0RWRnZSAtIDEgOiBjb3VudDEgLSAxO1xyXG4gICAgICAgICBlbHNlIGVkZ2UgPSBiZXN0RWRnZSArIDEgPCBjb3VudDEgPyBiZXN0RWRnZSArIDEgOiAwO3MgPSBiMkNvbGxpc2lvbi5FZGdlU2VwYXJhdGlvbihwb2x5MSwgeGYxLCBlZGdlLCBwb2x5MiwgeGYyKTtcclxuICAgICAgICAgaWYgKHMgPiBiZXN0U2VwYXJhdGlvbikge1xyXG4gICAgICAgICAgICBiZXN0RWRnZSA9IGVkZ2U7XHJcbiAgICAgICAgICAgIGJlc3RTZXBhcmF0aW9uID0gcztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlZGdlSW5kZXhbMF0gPSBiZXN0RWRnZTtcclxuICAgICAgcmV0dXJuIGJlc3RTZXBhcmF0aW9uO1xyXG4gICB9XHJcbiAgIGIyQ29sbGlzaW9uLkZpbmRJbmNpZGVudEVkZ2UgPSBmdW5jdGlvbiAoYywgcG9seTEsIHhmMSwgZWRnZTEsIHBvbHkyLCB4ZjIpIHtcclxuICAgICAgaWYgKGVkZ2UxID09PSB1bmRlZmluZWQpIGVkZ2UxID0gMDtcclxuICAgICAgdmFyIGNvdW50MSA9IHBhcnNlSW50KHBvbHkxLm1fdmVydGV4Q291bnQpO1xyXG4gICAgICB2YXIgbm9ybWFsczEgPSBwb2x5MS5tX25vcm1hbHM7XHJcbiAgICAgIHZhciBjb3VudDIgPSBwYXJzZUludChwb2x5Mi5tX3ZlcnRleENvdW50KTtcclxuICAgICAgdmFyIHZlcnRpY2VzMiA9IHBvbHkyLm1fdmVydGljZXM7XHJcbiAgICAgIHZhciBub3JtYWxzMiA9IHBvbHkyLm1fbm9ybWFscztcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICB0TWF0ID0geGYxLlI7XHJcbiAgICAgIHRWZWMgPSBub3JtYWxzMVtlZGdlMV07XHJcbiAgICAgIHZhciBub3JtYWwxWCA9ICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgdmFyIG5vcm1hbDFZID0gKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB0TWF0ID0geGYyLlI7XHJcbiAgICAgIHZhciB0WCA9ICh0TWF0LmNvbDEueCAqIG5vcm1hbDFYICsgdE1hdC5jb2wxLnkgKiBub3JtYWwxWSk7XHJcbiAgICAgIG5vcm1hbDFZID0gKHRNYXQuY29sMi54ICogbm9ybWFsMVggKyB0TWF0LmNvbDIueSAqIG5vcm1hbDFZKTtcclxuICAgICAgbm9ybWFsMVggPSB0WDtcclxuICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgdmFyIG1pbkRvdCA9IE51bWJlci5NQVhfVkFMVUU7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQyOyArK2kpIHtcclxuICAgICAgICAgdFZlYyA9IG5vcm1hbHMyW2ldO1xyXG4gICAgICAgICB2YXIgZG90ID0gKG5vcm1hbDFYICogdFZlYy54ICsgbm9ybWFsMVkgKiB0VmVjLnkpO1xyXG4gICAgICAgICBpZiAoZG90IDwgbWluRG90KSB7XHJcbiAgICAgICAgICAgIG1pbkRvdCA9IGRvdDtcclxuICAgICAgICAgICAgaW5kZXggPSBpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdmFyIHRDbGlwO1xyXG4gICAgICB2YXIgaTEgPSBwYXJzZUludChpbmRleCk7XHJcbiAgICAgIHZhciBpMiA9IHBhcnNlSW50KGkxICsgMSA8IGNvdW50MiA/IGkxICsgMSA6IDApO1xyXG4gICAgICB0Q2xpcCA9IGNbMF07XHJcbiAgICAgIHRWZWMgPSB2ZXJ0aWNlczJbaTFdO1xyXG4gICAgICB0TWF0ID0geGYyLlI7XHJcbiAgICAgIHRDbGlwLnYueCA9IHhmMi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB0Q2xpcC52LnkgPSB4ZjIucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgdENsaXAuaWQuZmVhdHVyZXMucmVmZXJlbmNlRWRnZSA9IGVkZ2UxO1xyXG4gICAgICB0Q2xpcC5pZC5mZWF0dXJlcy5pbmNpZGVudEVkZ2UgPSBpMTtcclxuICAgICAgdENsaXAuaWQuZmVhdHVyZXMuaW5jaWRlbnRWZXJ0ZXggPSAwO1xyXG4gICAgICB0Q2xpcCA9IGNbMV07XHJcbiAgICAgIHRWZWMgPSB2ZXJ0aWNlczJbaTJdO1xyXG4gICAgICB0TWF0ID0geGYyLlI7XHJcbiAgICAgIHRDbGlwLnYueCA9IHhmMi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB0Q2xpcC52LnkgPSB4ZjIucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgdENsaXAuaWQuZmVhdHVyZXMucmVmZXJlbmNlRWRnZSA9IGVkZ2UxO1xyXG4gICAgICB0Q2xpcC5pZC5mZWF0dXJlcy5pbmNpZGVudEVkZ2UgPSBpMjtcclxuICAgICAgdENsaXAuaWQuZmVhdHVyZXMuaW5jaWRlbnRWZXJ0ZXggPSAxO1xyXG4gICB9XHJcbiAgIGIyQ29sbGlzaW9uLk1ha2VDbGlwUG9pbnRWZWN0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciByID0gbmV3IFZlY3RvcigyKTtcclxuICAgICAgclswXSA9IG5ldyBDbGlwVmVydGV4KCk7XHJcbiAgICAgIHJbMV0gPSBuZXcgQ2xpcFZlcnRleCgpO1xyXG4gICAgICByZXR1cm4gcjtcclxuICAgfVxyXG4gICBiMkNvbGxpc2lvbi5Db2xsaWRlUG9seWdvbnMgPSBmdW5jdGlvbiAobWFuaWZvbGQsIHBvbHlBLCB4ZkEsIHBvbHlCLCB4ZkIpIHtcclxuICAgICAgdmFyIGN2O1xyXG4gICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSAwO1xyXG4gICAgICB2YXIgdG90YWxSYWRpdXMgPSBwb2x5QS5tX3JhZGl1cyArIHBvbHlCLm1fcmFkaXVzO1xyXG4gICAgICB2YXIgZWRnZUEgPSAwO1xyXG4gICAgICBiMkNvbGxpc2lvbi5zX2VkZ2VBT1swXSA9IGVkZ2VBO1xyXG4gICAgICB2YXIgc2VwYXJhdGlvbkEgPSBiMkNvbGxpc2lvbi5GaW5kTWF4U2VwYXJhdGlvbihiMkNvbGxpc2lvbi5zX2VkZ2VBTywgcG9seUEsIHhmQSwgcG9seUIsIHhmQik7XHJcbiAgICAgIGVkZ2VBID0gYjJDb2xsaXNpb24uc19lZGdlQU9bMF07XHJcbiAgICAgIGlmIChzZXBhcmF0aW9uQSA+IHRvdGFsUmFkaXVzKSByZXR1cm47XHJcbiAgICAgIHZhciBlZGdlQiA9IDA7XHJcbiAgICAgIGIyQ29sbGlzaW9uLnNfZWRnZUJPWzBdID0gZWRnZUI7XHJcbiAgICAgIHZhciBzZXBhcmF0aW9uQiA9IGIyQ29sbGlzaW9uLkZpbmRNYXhTZXBhcmF0aW9uKGIyQ29sbGlzaW9uLnNfZWRnZUJPLCBwb2x5QiwgeGZCLCBwb2x5QSwgeGZBKTtcclxuICAgICAgZWRnZUIgPSBiMkNvbGxpc2lvbi5zX2VkZ2VCT1swXTtcclxuICAgICAgaWYgKHNlcGFyYXRpb25CID4gdG90YWxSYWRpdXMpIHJldHVybjtcclxuICAgICAgdmFyIHBvbHkxO1xyXG4gICAgICB2YXIgcG9seTI7XHJcbiAgICAgIHZhciB4ZjE7XHJcbiAgICAgIHZhciB4ZjI7XHJcbiAgICAgIHZhciBlZGdlMSA9IDA7XHJcbiAgICAgIHZhciBmbGlwID0gMDtcclxuICAgICAgdmFyIGtfcmVsYXRpdmVUb2wgPSAwLjk4O1xyXG4gICAgICB2YXIga19hYnNvbHV0ZVRvbCA9IDAuMDAxO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgaWYgKHNlcGFyYXRpb25CID4ga19yZWxhdGl2ZVRvbCAqIHNlcGFyYXRpb25BICsga19hYnNvbHV0ZVRvbCkge1xyXG4gICAgICAgICBwb2x5MSA9IHBvbHlCO1xyXG4gICAgICAgICBwb2x5MiA9IHBvbHlBO1xyXG4gICAgICAgICB4ZjEgPSB4ZkI7XHJcbiAgICAgICAgIHhmMiA9IHhmQTtcclxuICAgICAgICAgZWRnZTEgPSBlZGdlQjtcclxuICAgICAgICAgbWFuaWZvbGQubV90eXBlID0gYjJNYW5pZm9sZC5lX2ZhY2VCO1xyXG4gICAgICAgICBmbGlwID0gMTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgcG9seTEgPSBwb2x5QTtcclxuICAgICAgICAgcG9seTIgPSBwb2x5QjtcclxuICAgICAgICAgeGYxID0geGZBO1xyXG4gICAgICAgICB4ZjIgPSB4ZkI7XHJcbiAgICAgICAgIGVkZ2UxID0gZWRnZUE7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fdHlwZSA9IGIyTWFuaWZvbGQuZV9mYWNlQTtcclxuICAgICAgICAgZmxpcCA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGluY2lkZW50RWRnZSA9IGIyQ29sbGlzaW9uLnNfaW5jaWRlbnRFZGdlO1xyXG4gICAgICBiMkNvbGxpc2lvbi5GaW5kSW5jaWRlbnRFZGdlKGluY2lkZW50RWRnZSwgcG9seTEsIHhmMSwgZWRnZTEsIHBvbHkyLCB4ZjIpO1xyXG4gICAgICB2YXIgY291bnQxID0gcGFyc2VJbnQocG9seTEubV92ZXJ0ZXhDb3VudCk7XHJcbiAgICAgIHZhciB2ZXJ0aWNlczEgPSBwb2x5MS5tX3ZlcnRpY2VzO1xyXG4gICAgICB2YXIgbG9jYWxfdjExID0gdmVydGljZXMxW2VkZ2UxXTtcclxuICAgICAgdmFyIGxvY2FsX3YxMjtcclxuICAgICAgaWYgKGVkZ2UxICsgMSA8IGNvdW50MSkge1xyXG4gICAgICAgICBsb2NhbF92MTIgPSB2ZXJ0aWNlczFbcGFyc2VJbnQoZWRnZTEgKyAxKV07XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIGxvY2FsX3YxMiA9IHZlcnRpY2VzMVswXTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgbG9jYWxUYW5nZW50ID0gYjJDb2xsaXNpb24uc19sb2NhbFRhbmdlbnQ7XHJcbiAgICAgIGxvY2FsVGFuZ2VudC5TZXQobG9jYWxfdjEyLnggLSBsb2NhbF92MTEueCwgbG9jYWxfdjEyLnkgLSBsb2NhbF92MTEueSk7XHJcbiAgICAgIGxvY2FsVGFuZ2VudC5Ob3JtYWxpemUoKTtcclxuICAgICAgdmFyIGxvY2FsTm9ybWFsID0gYjJDb2xsaXNpb24uc19sb2NhbE5vcm1hbDtcclxuICAgICAgbG9jYWxOb3JtYWwueCA9IGxvY2FsVGFuZ2VudC55O1xyXG4gICAgICBsb2NhbE5vcm1hbC55ID0gKC1sb2NhbFRhbmdlbnQueCk7XHJcbiAgICAgIHZhciBwbGFuZVBvaW50ID0gYjJDb2xsaXNpb24uc19wbGFuZVBvaW50O1xyXG4gICAgICBwbGFuZVBvaW50LlNldCgwLjUgKiAobG9jYWxfdjExLnggKyBsb2NhbF92MTIueCksIDAuNSAqIChsb2NhbF92MTEueSArIGxvY2FsX3YxMi55KSk7XHJcbiAgICAgIHZhciB0YW5nZW50ID0gYjJDb2xsaXNpb24uc190YW5nZW50O1xyXG4gICAgICB0TWF0ID0geGYxLlI7XHJcbiAgICAgIHRhbmdlbnQueCA9ICh0TWF0LmNvbDEueCAqIGxvY2FsVGFuZ2VudC54ICsgdE1hdC5jb2wyLnggKiBsb2NhbFRhbmdlbnQueSk7XHJcbiAgICAgIHRhbmdlbnQueSA9ICh0TWF0LmNvbDEueSAqIGxvY2FsVGFuZ2VudC54ICsgdE1hdC5jb2wyLnkgKiBsb2NhbFRhbmdlbnQueSk7XHJcbiAgICAgIHZhciB0YW5nZW50MiA9IGIyQ29sbGlzaW9uLnNfdGFuZ2VudDI7XHJcbiAgICAgIHRhbmdlbnQyLnggPSAoLXRhbmdlbnQueCk7XHJcbiAgICAgIHRhbmdlbnQyLnkgPSAoLXRhbmdlbnQueSk7XHJcbiAgICAgIHZhciBub3JtYWwgPSBiMkNvbGxpc2lvbi5zX25vcm1hbDtcclxuICAgICAgbm9ybWFsLnggPSB0YW5nZW50Lnk7XHJcbiAgICAgIG5vcm1hbC55ID0gKC10YW5nZW50LngpO1xyXG4gICAgICB2YXIgdjExID0gYjJDb2xsaXNpb24uc192MTE7XHJcbiAgICAgIHZhciB2MTIgPSBiMkNvbGxpc2lvbi5zX3YxMjtcclxuICAgICAgdjExLnggPSB4ZjEucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIGxvY2FsX3YxMS54ICsgdE1hdC5jb2wyLnggKiBsb2NhbF92MTEueSk7XHJcbiAgICAgIHYxMS55ID0geGYxLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiBsb2NhbF92MTEueCArIHRNYXQuY29sMi55ICogbG9jYWxfdjExLnkpO1xyXG4gICAgICB2MTIueCA9IHhmMS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogbG9jYWxfdjEyLnggKyB0TWF0LmNvbDIueCAqIGxvY2FsX3YxMi55KTtcclxuICAgICAgdjEyLnkgPSB4ZjEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIGxvY2FsX3YxMi54ICsgdE1hdC5jb2wyLnkgKiBsb2NhbF92MTIueSk7XHJcbiAgICAgIHZhciBmcm9udE9mZnNldCA9IG5vcm1hbC54ICogdjExLnggKyBub3JtYWwueSAqIHYxMS55O1xyXG4gICAgICB2YXIgc2lkZU9mZnNldDEgPSAoLXRhbmdlbnQueCAqIHYxMS54KSAtIHRhbmdlbnQueSAqIHYxMS55ICsgdG90YWxSYWRpdXM7XHJcbiAgICAgIHZhciBzaWRlT2Zmc2V0MiA9IHRhbmdlbnQueCAqIHYxMi54ICsgdGFuZ2VudC55ICogdjEyLnkgKyB0b3RhbFJhZGl1cztcclxuICAgICAgdmFyIGNsaXBQb2ludHMxID0gYjJDb2xsaXNpb24uc19jbGlwUG9pbnRzMTtcclxuICAgICAgdmFyIGNsaXBQb2ludHMyID0gYjJDb2xsaXNpb24uc19jbGlwUG9pbnRzMjtcclxuICAgICAgdmFyIG5wID0gMDtcclxuICAgICAgbnAgPSBiMkNvbGxpc2lvbi5DbGlwU2VnbWVudFRvTGluZShjbGlwUG9pbnRzMSwgaW5jaWRlbnRFZGdlLCB0YW5nZW50Miwgc2lkZU9mZnNldDEpO1xyXG4gICAgICBpZiAobnAgPCAyKSByZXR1cm47XHJcbiAgICAgIG5wID0gYjJDb2xsaXNpb24uQ2xpcFNlZ21lbnRUb0xpbmUoY2xpcFBvaW50czIsIGNsaXBQb2ludHMxLCB0YW5nZW50LCBzaWRlT2Zmc2V0Mik7XHJcbiAgICAgIGlmIChucCA8IDIpIHJldHVybjtcclxuICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLlNldFYobG9jYWxOb3JtYWwpO1xyXG4gICAgICBtYW5pZm9sZC5tX2xvY2FsUG9pbnQuU2V0VihwbGFuZVBvaW50KTtcclxuICAgICAgdmFyIHBvaW50Q291bnQgPSAwO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7ICsraSkge1xyXG4gICAgICAgICBjdiA9IGNsaXBQb2ludHMyW2ldO1xyXG4gICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IG5vcm1hbC54ICogY3Yudi54ICsgbm9ybWFsLnkgKiBjdi52LnkgLSBmcm9udE9mZnNldDtcclxuICAgICAgICAgaWYgKHNlcGFyYXRpb24gPD0gdG90YWxSYWRpdXMpIHtcclxuICAgICAgICAgICAgdmFyIGNwID0gbWFuaWZvbGQubV9wb2ludHNbcG9pbnRDb3VudF07XHJcbiAgICAgICAgICAgIHRNYXQgPSB4ZjIuUjtcclxuICAgICAgICAgICAgdmFyIHRYID0gY3Yudi54IC0geGYyLnBvc2l0aW9uLng7XHJcbiAgICAgICAgICAgIHZhciB0WSA9IGN2LnYueSAtIHhmMi5wb3NpdGlvbi55O1xyXG4gICAgICAgICAgICBjcC5tX2xvY2FsUG9pbnQueCA9ICh0WCAqIHRNYXQuY29sMS54ICsgdFkgKiB0TWF0LmNvbDEueSk7XHJcbiAgICAgICAgICAgIGNwLm1fbG9jYWxQb2ludC55ID0gKHRYICogdE1hdC5jb2wyLnggKyB0WSAqIHRNYXQuY29sMi55KTtcclxuICAgICAgICAgICAgY3AubV9pZC5TZXQoY3YuaWQpO1xyXG4gICAgICAgICAgICBjcC5tX2lkLmZlYXR1cmVzLmZsaXAgPSBmbGlwO1xyXG4gICAgICAgICAgICArK3BvaW50Q291bnQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSBwb2ludENvdW50O1xyXG4gICB9XHJcbiAgIGIyQ29sbGlzaW9uLkNvbGxpZGVDaXJjbGVzID0gZnVuY3Rpb24gKG1hbmlmb2xkLCBjaXJjbGUxLCB4ZjEsIGNpcmNsZTIsIHhmMikge1xyXG4gICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSAwO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRWZWM7XHJcbiAgICAgIHRNYXQgPSB4ZjEuUjtcclxuICAgICAgdFZlYyA9IGNpcmNsZTEubV9wO1xyXG4gICAgICB2YXIgcDFYID0geGYxLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHZhciBwMVkgPSB4ZjEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgdE1hdCA9IHhmMi5SO1xyXG4gICAgICB0VmVjID0gY2lyY2xlMi5tX3A7XHJcbiAgICAgIHZhciBwMlggPSB4ZjIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgdmFyIHAyWSA9IHhmMi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB2YXIgZFggPSBwMlggLSBwMVg7XHJcbiAgICAgIHZhciBkWSA9IHAyWSAtIHAxWTtcclxuICAgICAgdmFyIGRpc3RTcXIgPSBkWCAqIGRYICsgZFkgKiBkWTtcclxuICAgICAgdmFyIHJhZGl1cyA9IGNpcmNsZTEubV9yYWRpdXMgKyBjaXJjbGUyLm1fcmFkaXVzO1xyXG4gICAgICBpZiAoZGlzdFNxciA+IHJhZGl1cyAqIHJhZGl1cykge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgbWFuaWZvbGQubV90eXBlID0gYjJNYW5pZm9sZC5lX2NpcmNsZXM7XHJcbiAgICAgIG1hbmlmb2xkLm1fbG9jYWxQb2ludC5TZXRWKGNpcmNsZTEubV9wKTtcclxuICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLlNldFplcm8oKTtcclxuICAgICAgbWFuaWZvbGQubV9wb2ludENvdW50ID0gMTtcclxuICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9sb2NhbFBvaW50LlNldFYoY2lyY2xlMi5tX3ApO1xyXG4gICAgICBtYW5pZm9sZC5tX3BvaW50c1swXS5tX2lkLmtleSA9IDA7XHJcbiAgIH1cclxuICAgYjJDb2xsaXNpb24uQ29sbGlkZVBvbHlnb25BbmRDaXJjbGUgPSBmdW5jdGlvbiAobWFuaWZvbGQsIHBvbHlnb24sIHhmMSwgY2lyY2xlLCB4ZjIpIHtcclxuICAgICAgbWFuaWZvbGQubV9wb2ludENvdW50ID0gMDtcclxuICAgICAgdmFyIHRQb2ludDtcclxuICAgICAgdmFyIGRYID0gMDtcclxuICAgICAgdmFyIGRZID0gMDtcclxuICAgICAgdmFyIHBvc2l0aW9uWCA9IDA7XHJcbiAgICAgIHZhciBwb3NpdGlvblkgPSAwO1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHRNYXQgPSB4ZjIuUjtcclxuICAgICAgdFZlYyA9IGNpcmNsZS5tX3A7XHJcbiAgICAgIHZhciBjWCA9IHhmMi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB2YXIgY1kgPSB4ZjIucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgZFggPSBjWCAtIHhmMS5wb3NpdGlvbi54O1xyXG4gICAgICBkWSA9IGNZIC0geGYxLnBvc2l0aW9uLnk7XHJcbiAgICAgIHRNYXQgPSB4ZjEuUjtcclxuICAgICAgdmFyIGNMb2NhbFggPSAoZFggKiB0TWF0LmNvbDEueCArIGRZICogdE1hdC5jb2wxLnkpO1xyXG4gICAgICB2YXIgY0xvY2FsWSA9IChkWCAqIHRNYXQuY29sMi54ICsgZFkgKiB0TWF0LmNvbDIueSk7XHJcbiAgICAgIHZhciBkaXN0ID0gMDtcclxuICAgICAgdmFyIG5vcm1hbEluZGV4ID0gMDtcclxuICAgICAgdmFyIHNlcGFyYXRpb24gPSAoLU51bWJlci5NQVhfVkFMVUUpO1xyXG4gICAgICB2YXIgcmFkaXVzID0gcG9seWdvbi5tX3JhZGl1cyArIGNpcmNsZS5tX3JhZGl1cztcclxuICAgICAgdmFyIHZlcnRleENvdW50ID0gcGFyc2VJbnQocG9seWdvbi5tX3ZlcnRleENvdW50KTtcclxuICAgICAgdmFyIHZlcnRpY2VzID0gcG9seWdvbi5tX3ZlcnRpY2VzO1xyXG4gICAgICB2YXIgbm9ybWFscyA9IHBvbHlnb24ubV9ub3JtYWxzO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZlcnRleENvdW50OyArK2kpIHtcclxuICAgICAgICAgdFZlYyA9IHZlcnRpY2VzW2ldO1xyXG4gICAgICAgICBkWCA9IGNMb2NhbFggLSB0VmVjLng7XHJcbiAgICAgICAgIGRZID0gY0xvY2FsWSAtIHRWZWMueTtcclxuICAgICAgICAgdFZlYyA9IG5vcm1hbHNbaV07XHJcbiAgICAgICAgIHZhciBzID0gdFZlYy54ICogZFggKyB0VmVjLnkgKiBkWTtcclxuICAgICAgICAgaWYgKHMgPiByYWRpdXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChzID4gc2VwYXJhdGlvbikge1xyXG4gICAgICAgICAgICBzZXBhcmF0aW9uID0gcztcclxuICAgICAgICAgICAgbm9ybWFsSW5kZXggPSBpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdmFyIHZlcnRJbmRleDEgPSBwYXJzZUludChub3JtYWxJbmRleCk7XHJcbiAgICAgIHZhciB2ZXJ0SW5kZXgyID0gcGFyc2VJbnQodmVydEluZGV4MSArIDEgPCB2ZXJ0ZXhDb3VudCA/IHZlcnRJbmRleDEgKyAxIDogMCk7XHJcbiAgICAgIHZhciB2MSA9IHZlcnRpY2VzW3ZlcnRJbmRleDFdO1xyXG4gICAgICB2YXIgdjIgPSB2ZXJ0aWNlc1t2ZXJ0SW5kZXgyXTtcclxuICAgICAgaWYgKHNlcGFyYXRpb24gPCBOdW1iZXIuTUlOX1ZBTFVFKSB7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDE7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fdHlwZSA9IGIyTWFuaWZvbGQuZV9mYWNlQTtcclxuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLlNldFYobm9ybWFsc1tub3JtYWxJbmRleF0pO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUG9pbnQueCA9IDAuNSAqICh2MS54ICsgdjIueCk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQb2ludC55ID0gMC41ICogKHYxLnkgKyB2Mi55KTtcclxuICAgICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9sb2NhbFBvaW50LlNldFYoY2lyY2xlLm1fcCk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1faWQua2V5ID0gMDtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciB1MSA9IChjTG9jYWxYIC0gdjEueCkgKiAodjIueCAtIHYxLngpICsgKGNMb2NhbFkgLSB2MS55KSAqICh2Mi55IC0gdjEueSk7XHJcbiAgICAgIHZhciB1MiA9IChjTG9jYWxYIC0gdjIueCkgKiAodjEueCAtIHYyLngpICsgKGNMb2NhbFkgLSB2Mi55KSAqICh2MS55IC0gdjIueSk7XHJcbiAgICAgIGlmICh1MSA8PSAwLjApIHtcclxuICAgICAgICAgaWYgKChjTG9jYWxYIC0gdjEueCkgKiAoY0xvY2FsWCAtIHYxLngpICsgKGNMb2NhbFkgLSB2MS55KSAqIChjTG9jYWxZIC0gdjEueSkgPiByYWRpdXMgKiByYWRpdXMpIHJldHVybjtcclxuICAgICAgICAgbWFuaWZvbGQubV9wb2ludENvdW50ID0gMTtcclxuICAgICAgICAgbWFuaWZvbGQubV90eXBlID0gYjJNYW5pZm9sZC5lX2ZhY2VBO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueCA9IGNMb2NhbFggLSB2MS54O1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueSA9IGNMb2NhbFkgLSB2MS55O1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwuTm9ybWFsaXplKCk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQb2ludC5TZXRWKHYxKTtcclxuICAgICAgICAgbWFuaWZvbGQubV9wb2ludHNbMF0ubV9sb2NhbFBvaW50LlNldFYoY2lyY2xlLm1fcCk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1faWQua2V5ID0gMDtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICh1MiA8PSAwKSB7XHJcbiAgICAgICAgIGlmICgoY0xvY2FsWCAtIHYyLngpICogKGNMb2NhbFggLSB2Mi54KSArIChjTG9jYWxZIC0gdjIueSkgKiAoY0xvY2FsWSAtIHYyLnkpID4gcmFkaXVzICogcmFkaXVzKSByZXR1cm47XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDE7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fdHlwZSA9IGIyTWFuaWZvbGQuZV9mYWNlQTtcclxuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLnggPSBjTG9jYWxYIC0gdjIueDtcclxuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLnkgPSBjTG9jYWxZIC0gdjIueTtcclxuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLk5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUG9pbnQuU2V0Vih2Mik7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1fbG9jYWxQb2ludC5TZXRWKGNpcmNsZS5tX3ApO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX3BvaW50c1swXS5tX2lkLmtleSA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHZhciBmYWNlQ2VudGVyWCA9IDAuNSAqICh2MS54ICsgdjIueCk7XHJcbiAgICAgICAgIHZhciBmYWNlQ2VudGVyWSA9IDAuNSAqICh2MS55ICsgdjIueSk7XHJcbiAgICAgICAgIHNlcGFyYXRpb24gPSAoY0xvY2FsWCAtIGZhY2VDZW50ZXJYKSAqIG5vcm1hbHNbdmVydEluZGV4MV0ueCArIChjTG9jYWxZIC0gZmFjZUNlbnRlclkpICogbm9ybWFsc1t2ZXJ0SW5kZXgxXS55O1xyXG4gICAgICAgICBpZiAoc2VwYXJhdGlvbiA+IHJhZGl1cykgcmV0dXJuO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX3BvaW50Q291bnQgPSAxO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX3R5cGUgPSBiMk1hbmlmb2xkLmVfZmFjZUE7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbC54ID0gbm9ybWFsc1t2ZXJ0SW5kZXgxXS54O1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUGxhbmVOb3JtYWwueSA9IG5vcm1hbHNbdmVydEluZGV4MV0ueTtcclxuICAgICAgICAgbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLk5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX2xvY2FsUG9pbnQuU2V0KGZhY2VDZW50ZXJYLCBmYWNlQ2VudGVyWSk7XHJcbiAgICAgICAgIG1hbmlmb2xkLm1fcG9pbnRzWzBdLm1fbG9jYWxQb2ludC5TZXRWKGNpcmNsZS5tX3ApO1xyXG4gICAgICAgICBtYW5pZm9sZC5tX3BvaW50c1swXS5tX2lkLmtleSA9IDA7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkNvbGxpc2lvbi5UZXN0T3ZlcmxhcCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIHZhciB0MSA9IGIubG93ZXJCb3VuZDtcclxuICAgICAgdmFyIHQyID0gYS51cHBlckJvdW5kO1xyXG4gICAgICB2YXIgZDFYID0gdDEueCAtIHQyLng7XHJcbiAgICAgIHZhciBkMVkgPSB0MS55IC0gdDIueTtcclxuICAgICAgdDEgPSBhLmxvd2VyQm91bmQ7XHJcbiAgICAgIHQyID0gYi51cHBlckJvdW5kO1xyXG4gICAgICB2YXIgZDJYID0gdDEueCAtIHQyLng7XHJcbiAgICAgIHZhciBkMlkgPSB0MS55IC0gdDIueTtcclxuICAgICAgaWYgKGQxWCA+IDAuMCB8fCBkMVkgPiAwLjApIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKGQyWCA+IDAuMCB8fCBkMlkgPiAwLjApIHJldHVybiBmYWxzZTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX2luY2lkZW50RWRnZSA9IGIyQ29sbGlzaW9uLk1ha2VDbGlwUG9pbnRWZWN0b3IoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfY2xpcFBvaW50czEgPSBiMkNvbGxpc2lvbi5NYWtlQ2xpcFBvaW50VmVjdG9yKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX2NsaXBQb2ludHMyID0gYjJDb2xsaXNpb24uTWFrZUNsaXBQb2ludFZlY3RvcigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc19lZGdlQU8gPSBuZXcgVmVjdG9yX2Eyal9OdW1iZXIoMSk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5zX2VkZ2VCTyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigxKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfbG9jYWxUYW5nZW50ID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc19sb2NhbE5vcm1hbCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfcGxhbmVQb2ludCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfbm9ybWFsID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc190YW5nZW50ID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc190YW5nZW50MiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLnNfdjExID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJDb2xsaXNpb24uc192MTIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbi5iMkNvbGxpZGVQb2x5VGVtcFZlYyA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLmIyX251bGxGZWF0dXJlID0gMHgwMDAwMDBmZjtcclxuICAgfSk7XHJcbiAgIGIyQ29udGFjdElELmIyQ29udGFjdElEID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmZlYXR1cmVzID0gbmV3IEZlYXR1cmVzKCk7XHJcbiAgIH07XHJcbiAgIGIyQ29udGFjdElELnByb3RvdHlwZS5iMkNvbnRhY3RJRCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5mZWF0dXJlcy5fbV9pZCA9IHRoaXM7XHJcbiAgIH1cclxuICAgYjJDb250YWN0SUQucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICB0aGlzLmtleSA9IGlkLl9rZXk7XHJcbiAgIH1cclxuICAgYjJDb250YWN0SUQucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBpZCA9IG5ldyBiMkNvbnRhY3RJRCgpO1xyXG4gICAgICBpZC5rZXkgPSB0aGlzLmtleTtcclxuICAgICAgcmV0dXJuIGlkO1xyXG4gICB9XHJcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiMkNvbnRhY3RJRC5wcm90b3R5cGUsICdrZXknLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICByZXR1cm4gdGhpcy5fa2V5O1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYjJDb250YWN0SUQucHJvdG90eXBlLCAna2V5Jywge1xyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgdmFsdWUgPSAwO1xyXG4gICAgICAgICB0aGlzLl9rZXkgPSB2YWx1ZTtcclxuICAgICAgICAgdGhpcy5mZWF0dXJlcy5fcmVmZXJlbmNlRWRnZSA9IHRoaXMuX2tleSAmIDB4MDAwMDAwZmY7XHJcbiAgICAgICAgIHRoaXMuZmVhdHVyZXMuX2luY2lkZW50RWRnZSA9ICgodGhpcy5fa2V5ICYgMHgwMDAwZmYwMCkgPj4gOCkgJiAweDAwMDAwMGZmO1xyXG4gICAgICAgICB0aGlzLmZlYXR1cmVzLl9pbmNpZGVudFZlcnRleCA9ICgodGhpcy5fa2V5ICYgMHgwMGZmMDAwMCkgPj4gMTYpICYgMHgwMDAwMDBmZjtcclxuICAgICAgICAgdGhpcy5mZWF0dXJlcy5fZmxpcCA9ICgodGhpcy5fa2V5ICYgMHhmZjAwMDAwMCkgPj4gMjQpICYgMHgwMDAwMDBmZjtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgYjJDb250YWN0UG9pbnQuYjJDb250YWN0UG9pbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMucG9zaXRpb24gPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMudmVsb2NpdHkgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubm9ybWFsID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmlkID0gbmV3IGIyQ29udGFjdElEKCk7XHJcbiAgIH07XHJcbiAgIGIyRGlzdGFuY2UuYjJEaXN0YW5jZSA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkRpc3RhbmNlLkRpc3RhbmNlID0gZnVuY3Rpb24gKG91dHB1dCwgY2FjaGUsIGlucHV0KSB7XHJcbiAgICAgICsrYjJEaXN0YW5jZS5iMl9namtDYWxscztcclxuICAgICAgdmFyIHByb3h5QSA9IGlucHV0LnByb3h5QTtcclxuICAgICAgdmFyIHByb3h5QiA9IGlucHV0LnByb3h5QjtcclxuICAgICAgdmFyIHRyYW5zZm9ybUEgPSBpbnB1dC50cmFuc2Zvcm1BO1xyXG4gICAgICB2YXIgdHJhbnNmb3JtQiA9IGlucHV0LnRyYW5zZm9ybUI7XHJcbiAgICAgIHZhciBzaW1wbGV4ID0gYjJEaXN0YW5jZS5zX3NpbXBsZXg7XHJcbiAgICAgIHNpbXBsZXguUmVhZENhY2hlKGNhY2hlLCBwcm94eUEsIHRyYW5zZm9ybUEsIHByb3h5QiwgdHJhbnNmb3JtQik7XHJcbiAgICAgIHZhciB2ZXJ0aWNlcyA9IHNpbXBsZXgubV92ZXJ0aWNlcztcclxuICAgICAgdmFyIGtfbWF4SXRlcnMgPSAyMDtcclxuICAgICAgdmFyIHNhdmVBID0gYjJEaXN0YW5jZS5zX3NhdmVBO1xyXG4gICAgICB2YXIgc2F2ZUIgPSBiMkRpc3RhbmNlLnNfc2F2ZUI7XHJcbiAgICAgIHZhciBzYXZlQ291bnQgPSAwO1xyXG4gICAgICB2YXIgY2xvc2VzdFBvaW50ID0gc2ltcGxleC5HZXRDbG9zZXN0UG9pbnQoKTtcclxuICAgICAgdmFyIGRpc3RhbmNlU3FyMSA9IGNsb3Nlc3RQb2ludC5MZW5ndGhTcXVhcmVkKCk7XHJcbiAgICAgIHZhciBkaXN0YW5jZVNxcjIgPSBkaXN0YW5jZVNxcjE7XHJcbiAgICAgIHZhciBpID0gMDtcclxuICAgICAgdmFyIHA7XHJcbiAgICAgIHZhciBpdGVyID0gMDtcclxuICAgICAgd2hpbGUgKGl0ZXIgPCBrX21heEl0ZXJzKSB7XHJcbiAgICAgICAgIHNhdmVDb3VudCA9IHNpbXBsZXgubV9jb3VudDtcclxuICAgICAgICAgZm9yIChpID0gMDtcclxuICAgICAgICAgaSA8IHNhdmVDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHNhdmVBW2ldID0gdmVydGljZXNbaV0uaW5kZXhBO1xyXG4gICAgICAgICAgICBzYXZlQltpXSA9IHZlcnRpY2VzW2ldLmluZGV4QjtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBzd2l0Y2ggKHNpbXBsZXgubV9jb3VudCkge1xyXG4gICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgIHNpbXBsZXguU29sdmUyKCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgIHNpbXBsZXguU29sdmUzKCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAoc2ltcGxleC5tX2NvdW50ID09IDMpIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgcCA9IHNpbXBsZXguR2V0Q2xvc2VzdFBvaW50KCk7XHJcbiAgICAgICAgIGRpc3RhbmNlU3FyMiA9IHAuTGVuZ3RoU3F1YXJlZCgpO1xyXG4gICAgICAgICBpZiAoZGlzdGFuY2VTcXIyID4gZGlzdGFuY2VTcXIxKSB7fVxyXG4gICAgICAgICBkaXN0YW5jZVNxcjEgPSBkaXN0YW5jZVNxcjI7XHJcbiAgICAgICAgIHZhciBkID0gc2ltcGxleC5HZXRTZWFyY2hEaXJlY3Rpb24oKTtcclxuICAgICAgICAgaWYgKGQuTGVuZ3RoU3F1YXJlZCgpIDwgTnVtYmVyLk1JTl9WQUxVRSAqIE51bWJlci5NSU5fVkFMVUUpIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIHZlcnRleCA9IHZlcnRpY2VzW3NpbXBsZXgubV9jb3VudF07XHJcbiAgICAgICAgIHZlcnRleC5pbmRleEEgPSBwcm94eUEuR2V0U3VwcG9ydChiMk1hdGguTXVsVE1WKHRyYW5zZm9ybUEuUiwgZC5HZXROZWdhdGl2ZSgpKSk7XHJcbiAgICAgICAgIHZlcnRleC53QSA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUEsIHByb3h5QS5HZXRWZXJ0ZXgodmVydGV4LmluZGV4QSkpO1xyXG4gICAgICAgICB2ZXJ0ZXguaW5kZXhCID0gcHJveHlCLkdldFN1cHBvcnQoYjJNYXRoLk11bFRNVih0cmFuc2Zvcm1CLlIsIGQpKTtcclxuICAgICAgICAgdmVydGV4LndCID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQiwgcHJveHlCLkdldFZlcnRleCh2ZXJ0ZXguaW5kZXhCKSk7XHJcbiAgICAgICAgIHZlcnRleC53ID0gYjJNYXRoLlN1YnRyYWN0VlYodmVydGV4LndCLCB2ZXJ0ZXgud0EpO1xyXG4gICAgICAgICArK2l0ZXI7XHJcbiAgICAgICAgICsrYjJEaXN0YW5jZS5iMl9namtJdGVycztcclxuICAgICAgICAgdmFyIGR1cGxpY2F0ZSA9IGZhbHNlO1xyXG4gICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICBpIDwgc2F2ZUNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHZlcnRleC5pbmRleEEgPT0gc2F2ZUFbaV0gJiYgdmVydGV4LmluZGV4QiA9PSBzYXZlQltpXSkge1xyXG4gICAgICAgICAgICAgICBkdXBsaWNhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChkdXBsaWNhdGUpIHtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIH0rK3NpbXBsZXgubV9jb3VudDtcclxuICAgICAgfVxyXG4gICAgICBiMkRpc3RhbmNlLmIyX2dqa01heEl0ZXJzID0gYjJNYXRoLk1heChiMkRpc3RhbmNlLmIyX2dqa01heEl0ZXJzLCBpdGVyKTtcclxuICAgICAgc2ltcGxleC5HZXRXaXRuZXNzUG9pbnRzKG91dHB1dC5wb2ludEEsIG91dHB1dC5wb2ludEIpO1xyXG4gICAgICBvdXRwdXQuZGlzdGFuY2UgPSBiMk1hdGguU3VidHJhY3RWVihvdXRwdXQucG9pbnRBLCBvdXRwdXQucG9pbnRCKS5MZW5ndGgoKTtcclxuICAgICAgb3V0cHV0Lml0ZXJhdGlvbnMgPSBpdGVyO1xyXG4gICAgICBzaW1wbGV4LldyaXRlQ2FjaGUoY2FjaGUpO1xyXG4gICAgICBpZiAoaW5wdXQudXNlUmFkaWkpIHtcclxuICAgICAgICAgdmFyIHJBID0gcHJveHlBLm1fcmFkaXVzO1xyXG4gICAgICAgICB2YXIgckIgPSBwcm94eUIubV9yYWRpdXM7XHJcbiAgICAgICAgIGlmIChvdXRwdXQuZGlzdGFuY2UgPiByQSArIHJCICYmIG91dHB1dC5kaXN0YW5jZSA+IE51bWJlci5NSU5fVkFMVUUpIHtcclxuICAgICAgICAgICAgb3V0cHV0LmRpc3RhbmNlIC09IHJBICsgckI7XHJcbiAgICAgICAgICAgIHZhciBub3JtYWwgPSBiMk1hdGguU3VidHJhY3RWVihvdXRwdXQucG9pbnRCLCBvdXRwdXQucG9pbnRBKTtcclxuICAgICAgICAgICAgbm9ybWFsLk5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICBvdXRwdXQucG9pbnRBLnggKz0gckEgKiBub3JtYWwueDtcclxuICAgICAgICAgICAgb3V0cHV0LnBvaW50QS55ICs9IHJBICogbm9ybWFsLnk7XHJcbiAgICAgICAgICAgIG91dHB1dC5wb2ludEIueCAtPSByQiAqIG5vcm1hbC54O1xyXG4gICAgICAgICAgICBvdXRwdXQucG9pbnRCLnkgLT0gckIgKiBub3JtYWwueTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgICAgICAgcC54ID0gLjUgKiAob3V0cHV0LnBvaW50QS54ICsgb3V0cHV0LnBvaW50Qi54KTtcclxuICAgICAgICAgICAgcC55ID0gLjUgKiAob3V0cHV0LnBvaW50QS55ICsgb3V0cHV0LnBvaW50Qi55KTtcclxuICAgICAgICAgICAgb3V0cHV0LnBvaW50QS54ID0gb3V0cHV0LnBvaW50Qi54ID0gcC54O1xyXG4gICAgICAgICAgICBvdXRwdXQucG9pbnRBLnkgPSBvdXRwdXQucG9pbnRCLnkgPSBwLnk7XHJcbiAgICAgICAgICAgIG91dHB1dC5kaXN0YW5jZSA9IDAuMDtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlLnNfc2ltcGxleCA9IG5ldyBiMlNpbXBsZXgoKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2Uuc19zYXZlQSA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigzKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2Uuc19zYXZlQiA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigzKTtcclxuICAgfSk7XHJcbiAgIGIyRGlzdGFuY2VJbnB1dC5iMkRpc3RhbmNlSW5wdXQgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJEaXN0YW5jZU91dHB1dC5iMkRpc3RhbmNlT3V0cHV0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnBvaW50QSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5wb2ludEIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyRGlzdGFuY2VQcm94eS5iMkRpc3RhbmNlUHJveHkgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJEaXN0YW5jZVByb3h5LnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAoc2hhcGUpIHtcclxuICAgICAgc3dpdGNoIChzaGFwZS5HZXRUeXBlKCkpIHtcclxuICAgICAgY2FzZSBiMlNoYXBlLmVfY2lyY2xlU2hhcGU6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGNpcmNsZSA9IChzaGFwZSBpbnN0YW5jZW9mIGIyQ2lyY2xlU2hhcGUgPyBzaGFwZSA6IG51bGwpO1xyXG4gICAgICAgICAgICB0aGlzLm1fdmVydGljZXMgPSBuZXcgVmVjdG9yKDEsIHRydWUpO1xyXG4gICAgICAgICAgICB0aGlzLm1fdmVydGljZXNbMF0gPSBjaXJjbGUubV9wO1xyXG4gICAgICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xyXG4gICAgICAgICAgICB0aGlzLm1fcmFkaXVzID0gY2lyY2xlLm1fcmFkaXVzO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIGIyU2hhcGUuZV9wb2x5Z29uU2hhcGU6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIHBvbHlnb24gPSAoc2hhcGUgaW5zdGFuY2VvZiBiMlBvbHlnb25TaGFwZSA/IHNoYXBlIDogbnVsbCk7XHJcbiAgICAgICAgICAgIHRoaXMubV92ZXJ0aWNlcyA9IHBvbHlnb24ubV92ZXJ0aWNlcztcclxuICAgICAgICAgICAgdGhpcy5tX2NvdW50ID0gcG9seWdvbi5tX3ZlcnRleENvdW50O1xyXG4gICAgICAgICAgICB0aGlzLm1fcmFkaXVzID0gcG9seWdvbi5tX3JhZGl1cztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkRpc3RhbmNlUHJveHkucHJvdG90eXBlLkdldFN1cHBvcnQgPSBmdW5jdGlvbiAoZCkge1xyXG4gICAgICB2YXIgYmVzdEluZGV4ID0gMDtcclxuICAgICAgdmFyIGJlc3RWYWx1ZSA9IHRoaXMubV92ZXJ0aWNlc1swXS54ICogZC54ICsgdGhpcy5tX3ZlcnRpY2VzWzBdLnkgKiBkLnk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzW2ldLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbaV0ueSAqIGQueTtcclxuICAgICAgICAgaWYgKHZhbHVlID4gYmVzdFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGJlc3RJbmRleCA9IGk7XHJcbiAgICAgICAgICAgIGJlc3RWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGJlc3RJbmRleDtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlUHJveHkucHJvdG90eXBlLkdldFN1cHBvcnRWZXJ0ZXggPSBmdW5jdGlvbiAoZCkge1xyXG4gICAgICB2YXIgYmVzdEluZGV4ID0gMDtcclxuICAgICAgdmFyIGJlc3RWYWx1ZSA9IHRoaXMubV92ZXJ0aWNlc1swXS54ICogZC54ICsgdGhpcy5tX3ZlcnRpY2VzWzBdLnkgKiBkLnk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5tX2NvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzW2ldLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbaV0ueSAqIGQueTtcclxuICAgICAgICAgaWYgKHZhbHVlID4gYmVzdFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGJlc3RJbmRleCA9IGk7XHJcbiAgICAgICAgICAgIGJlc3RWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0aWNlc1tiZXN0SW5kZXhdO1xyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VQcm94eS5wcm90b3R5cGUuR2V0VmVydGV4Q291bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fY291bnQ7XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZVByb3h5LnByb3RvdHlwZS5HZXRWZXJ0ZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcclxuICAgICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIGluZGV4ID0gMDtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCgwIDw9IGluZGV4ICYmIGluZGV4IDwgdGhpcy5tX2NvdW50KTtcclxuICAgICAgcmV0dXJuIHRoaXMubV92ZXJ0aWNlc1tpbmRleF07XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZS5iMkR5bmFtaWNUcmVlID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLmIyRHluYW1pY1RyZWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9yb290ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2ZyZWVMaXN0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX3BhdGggPSAwO1xyXG4gICAgICB0aGlzLm1faW5zZXJ0aW9uQ291bnQgPSAwO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLkNyZWF0ZVByb3h5ID0gZnVuY3Rpb24gKGFhYmIsIHVzZXJEYXRhKSB7XHJcbiAgICAgIHZhciBub2RlID0gdGhpcy5BbGxvY2F0ZU5vZGUoKTtcclxuICAgICAgdmFyIGV4dGVuZFggPSBiMlNldHRpbmdzLmIyX2FhYmJFeHRlbnNpb247XHJcbiAgICAgIHZhciBleHRlbmRZID0gYjJTZXR0aW5ncy5iMl9hYWJiRXh0ZW5zaW9uO1xyXG4gICAgICBub2RlLmFhYmIubG93ZXJCb3VuZC54ID0gYWFiYi5sb3dlckJvdW5kLnggLSBleHRlbmRYO1xyXG4gICAgICBub2RlLmFhYmIubG93ZXJCb3VuZC55ID0gYWFiYi5sb3dlckJvdW5kLnkgLSBleHRlbmRZO1xyXG4gICAgICBub2RlLmFhYmIudXBwZXJCb3VuZC54ID0gYWFiYi51cHBlckJvdW5kLnggKyBleHRlbmRYO1xyXG4gICAgICBub2RlLmFhYmIudXBwZXJCb3VuZC55ID0gYWFiYi51cHBlckJvdW5kLnkgKyBleHRlbmRZO1xyXG4gICAgICBub2RlLnVzZXJEYXRhID0gdXNlckRhdGE7XHJcbiAgICAgIHRoaXMuSW5zZXJ0TGVhZihub2RlKTtcclxuICAgICAgcmV0dXJuIG5vZGU7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuRGVzdHJveVByb3h5ID0gZnVuY3Rpb24gKHByb3h5KSB7XHJcbiAgICAgIHRoaXMuUmVtb3ZlTGVhZihwcm94eSk7XHJcbiAgICAgIHRoaXMuRnJlZU5vZGUocHJveHkpO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLk1vdmVQcm94eSA9IGZ1bmN0aW9uIChwcm94eSwgYWFiYiwgZGlzcGxhY2VtZW50KSB7XHJcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQocHJveHkuSXNMZWFmKCkpO1xyXG4gICAgICBpZiAocHJveHkuYWFiYi5Db250YWlucyhhYWJiKSkge1xyXG4gICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5SZW1vdmVMZWFmKHByb3h5KTtcclxuICAgICAgdmFyIGV4dGVuZFggPSBiMlNldHRpbmdzLmIyX2FhYmJFeHRlbnNpb24gKyBiMlNldHRpbmdzLmIyX2FhYmJNdWx0aXBsaWVyICogKGRpc3BsYWNlbWVudC54ID4gMCA/IGRpc3BsYWNlbWVudC54IDogKC1kaXNwbGFjZW1lbnQueCkpO1xyXG4gICAgICB2YXIgZXh0ZW5kWSA9IGIyU2V0dGluZ3MuYjJfYWFiYkV4dGVuc2lvbiArIGIyU2V0dGluZ3MuYjJfYWFiYk11bHRpcGxpZXIgKiAoZGlzcGxhY2VtZW50LnkgPiAwID8gZGlzcGxhY2VtZW50LnkgOiAoLWRpc3BsYWNlbWVudC55KSk7XHJcbiAgICAgIHByb3h5LmFhYmIubG93ZXJCb3VuZC54ID0gYWFiYi5sb3dlckJvdW5kLnggLSBleHRlbmRYO1xyXG4gICAgICBwcm94eS5hYWJiLmxvd2VyQm91bmQueSA9IGFhYmIubG93ZXJCb3VuZC55IC0gZXh0ZW5kWTtcclxuICAgICAgcHJveHkuYWFiYi51cHBlckJvdW5kLnggPSBhYWJiLnVwcGVyQm91bmQueCArIGV4dGVuZFg7XHJcbiAgICAgIHByb3h5LmFhYmIudXBwZXJCb3VuZC55ID0gYWFiYi51cHBlckJvdW5kLnkgKyBleHRlbmRZO1xyXG4gICAgICB0aGlzLkluc2VydExlYWYocHJveHkpO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5SZWJhbGFuY2UgPSBmdW5jdGlvbiAoaXRlcmF0aW9ucykge1xyXG4gICAgICBpZiAoaXRlcmF0aW9ucyA9PT0gdW5kZWZpbmVkKSBpdGVyYXRpb25zID0gMDtcclxuICAgICAgaWYgKHRoaXMubV9yb290ID09IG51bGwpIHJldHVybjtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVyYXRpb25zOyBpKyspIHtcclxuICAgICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fcm9vdDtcclxuICAgICAgICAgdmFyIGJpdCA9IDA7XHJcbiAgICAgICAgIHdoaWxlIChub2RlLklzTGVhZigpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIG5vZGUgPSAodGhpcy5tX3BhdGggPj4gYml0KSAmIDEgPyBub2RlLmNoaWxkMiA6IG5vZGUuY2hpbGQxO1xyXG4gICAgICAgICAgICBiaXQgPSAoYml0ICsgMSkgJiAzMTtcclxuICAgICAgICAgfSsrdGhpcy5tX3BhdGg7XHJcbiAgICAgICAgIHRoaXMuUmVtb3ZlTGVhZihub2RlKTtcclxuICAgICAgICAgdGhpcy5JbnNlcnRMZWFmKG5vZGUpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuR2V0RmF0QUFCQiA9IGZ1bmN0aW9uIChwcm94eSkge1xyXG4gICAgICByZXR1cm4gcHJveHkuYWFiYjtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5HZXRVc2VyRGF0YSA9IGZ1bmN0aW9uIChwcm94eSkge1xyXG4gICAgICByZXR1cm4gcHJveHkudXNlckRhdGE7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuUXVlcnkgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIGFhYmIpIHtcclxuICAgICAgaWYgKHRoaXMubV9yb290ID09IG51bGwpIHJldHVybjtcclxuICAgICAgdmFyIHN0YWNrID0gbmV3IFZlY3RvcigpO1xyXG4gICAgICB2YXIgY291bnQgPSAwO1xyXG4gICAgICBzdGFja1tjb3VudCsrXSA9IHRoaXMubV9yb290O1xyXG4gICAgICB3aGlsZSAoY291bnQgPiAwKSB7XHJcbiAgICAgICAgIHZhciBub2RlID0gc3RhY2tbLS1jb3VudF07XHJcbiAgICAgICAgIGlmIChub2RlLmFhYmIuVGVzdE92ZXJsYXAoYWFiYikpIHtcclxuICAgICAgICAgICAgaWYgKG5vZGUuSXNMZWFmKCkpIHtcclxuICAgICAgICAgICAgICAgdmFyIHByb2NlZWQgPSBjYWxsYmFjayhub2RlKTtcclxuICAgICAgICAgICAgICAgaWYgKCFwcm9jZWVkKSByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gbm9kZS5jaGlsZDE7XHJcbiAgICAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gbm9kZS5jaGlsZDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZS5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgaW5wdXQpIHtcclxuICAgICAgaWYgKHRoaXMubV9yb290ID09IG51bGwpIHJldHVybjtcclxuICAgICAgdmFyIHAxID0gaW5wdXQucDE7XHJcbiAgICAgIHZhciBwMiA9IGlucHV0LnAyO1xyXG4gICAgICB2YXIgciA9IGIyTWF0aC5TdWJ0cmFjdFZWKHAxLCBwMik7XHJcbiAgICAgIHIuTm9ybWFsaXplKCk7XHJcbiAgICAgIHZhciB2ID0gYjJNYXRoLkNyb3NzRlYoMS4wLCByKTtcclxuICAgICAgdmFyIGFic192ID0gYjJNYXRoLkFic1Yodik7XHJcbiAgICAgIHZhciBtYXhGcmFjdGlvbiA9IGlucHV0Lm1heEZyYWN0aW9uO1xyXG4gICAgICB2YXIgc2VnbWVudEFBQkIgPSBuZXcgYjJBQUJCKCk7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciB0WSA9IDA7IHtcclxuICAgICAgICAgdFggPSBwMS54ICsgbWF4RnJhY3Rpb24gKiAocDIueCAtIHAxLngpO1xyXG4gICAgICAgICB0WSA9IHAxLnkgKyBtYXhGcmFjdGlvbiAqIChwMi55IC0gcDEueSk7XHJcbiAgICAgICAgIHNlZ21lbnRBQUJCLmxvd2VyQm91bmQueCA9IE1hdGgubWluKHAxLngsIHRYKTtcclxuICAgICAgICAgc2VnbWVudEFBQkIubG93ZXJCb3VuZC55ID0gTWF0aC5taW4ocDEueSwgdFkpO1xyXG4gICAgICAgICBzZWdtZW50QUFCQi51cHBlckJvdW5kLnggPSBNYXRoLm1heChwMS54LCB0WCk7XHJcbiAgICAgICAgIHNlZ21lbnRBQUJCLnVwcGVyQm91bmQueSA9IE1hdGgubWF4KHAxLnksIHRZKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgc3RhY2sgPSBuZXcgVmVjdG9yKCk7XHJcbiAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgIHN0YWNrW2NvdW50KytdID0gdGhpcy5tX3Jvb3Q7XHJcbiAgICAgIHdoaWxlIChjb3VudCA+IDApIHtcclxuICAgICAgICAgdmFyIG5vZGUgPSBzdGFja1stLWNvdW50XTtcclxuICAgICAgICAgaWYgKG5vZGUuYWFiYi5UZXN0T3ZlcmxhcChzZWdtZW50QUFCQikgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIGMgPSBub2RlLmFhYmIuR2V0Q2VudGVyKCk7XHJcbiAgICAgICAgIHZhciBoID0gbm9kZS5hYWJiLkdldEV4dGVudHMoKTtcclxuICAgICAgICAgdmFyIHNlcGFyYXRpb24gPSBNYXRoLmFicyh2LnggKiAocDEueCAtIGMueCkgKyB2LnkgKiAocDEueSAtIGMueSkpIC0gYWJzX3YueCAqIGgueCAtIGFic192LnkgKiBoLnk7XHJcbiAgICAgICAgIGlmIChzZXBhcmF0aW9uID4gMC4wKSBjb250aW51ZTtcclxuICAgICAgICAgaWYgKG5vZGUuSXNMZWFmKCkpIHtcclxuICAgICAgICAgICAgdmFyIHN1YklucHV0ID0gbmV3IGIyUmF5Q2FzdElucHV0KCk7XHJcbiAgICAgICAgICAgIHN1YklucHV0LnAxID0gaW5wdXQucDE7XHJcbiAgICAgICAgICAgIHN1YklucHV0LnAyID0gaW5wdXQucDI7XHJcbiAgICAgICAgICAgIHN1YklucHV0Lm1heEZyYWN0aW9uID0gaW5wdXQubWF4RnJhY3Rpb247XHJcbiAgICAgICAgICAgIG1heEZyYWN0aW9uID0gY2FsbGJhY2soc3ViSW5wdXQsIG5vZGUpO1xyXG4gICAgICAgICAgICBpZiAobWF4RnJhY3Rpb24gPT0gMC4wKSByZXR1cm47XHJcbiAgICAgICAgICAgIGlmIChtYXhGcmFjdGlvbiA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICB0WCA9IHAxLnggKyBtYXhGcmFjdGlvbiAqIChwMi54IC0gcDEueCk7XHJcbiAgICAgICAgICAgICAgIHRZID0gcDEueSArIG1heEZyYWN0aW9uICogKHAyLnkgLSBwMS55KTtcclxuICAgICAgICAgICAgICAgc2VnbWVudEFBQkIubG93ZXJCb3VuZC54ID0gTWF0aC5taW4ocDEueCwgdFgpO1xyXG4gICAgICAgICAgICAgICBzZWdtZW50QUFCQi5sb3dlckJvdW5kLnkgPSBNYXRoLm1pbihwMS55LCB0WSk7XHJcbiAgICAgICAgICAgICAgIHNlZ21lbnRBQUJCLnVwcGVyQm91bmQueCA9IE1hdGgubWF4KHAxLngsIHRYKTtcclxuICAgICAgICAgICAgICAgc2VnbWVudEFBQkIudXBwZXJCb3VuZC55ID0gTWF0aC5tYXgocDEueSwgdFkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gbm9kZS5jaGlsZDE7XHJcbiAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gbm9kZS5jaGlsZDI7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLkFsbG9jYXRlTm9kZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgaWYgKHRoaXMubV9mcmVlTGlzdCkge1xyXG4gICAgICAgICB2YXIgbm9kZSA9IHRoaXMubV9mcmVlTGlzdDtcclxuICAgICAgICAgdGhpcy5tX2ZyZWVMaXN0ID0gbm9kZS5wYXJlbnQ7XHJcbiAgICAgICAgIG5vZGUucGFyZW50ID0gbnVsbDtcclxuICAgICAgICAgbm9kZS5jaGlsZDEgPSBudWxsO1xyXG4gICAgICAgICBub2RlLmNoaWxkMiA9IG51bGw7XHJcbiAgICAgICAgIHJldHVybiBub2RlO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBuZXcgYjJEeW5hbWljVHJlZU5vZGUoKTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5GcmVlTm9kZSA9IGZ1bmN0aW9uIChub2RlKSB7XHJcbiAgICAgIG5vZGUucGFyZW50ID0gdGhpcy5tX2ZyZWVMaXN0O1xyXG4gICAgICB0aGlzLm1fZnJlZUxpc3QgPSBub2RlO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWUucHJvdG90eXBlLkluc2VydExlYWYgPSBmdW5jdGlvbiAobGVhZikge1xyXG4gICAgICArK3RoaXMubV9pbnNlcnRpb25Db3VudDtcclxuICAgICAgaWYgKHRoaXMubV9yb290ID09IG51bGwpIHtcclxuICAgICAgICAgdGhpcy5tX3Jvb3QgPSBsZWFmO1xyXG4gICAgICAgICB0aGlzLm1fcm9vdC5wYXJlbnQgPSBudWxsO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGNlbnRlciA9IGxlYWYuYWFiYi5HZXRDZW50ZXIoKTtcclxuICAgICAgdmFyIHNpYmxpbmcgPSB0aGlzLm1fcm9vdDtcclxuICAgICAgaWYgKHNpYmxpbmcuSXNMZWFmKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICB2YXIgY2hpbGQxID0gc2libGluZy5jaGlsZDE7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZDIgPSBzaWJsaW5nLmNoaWxkMjtcclxuICAgICAgICAgICAgdmFyIG5vcm0xID0gTWF0aC5hYnMoKGNoaWxkMS5hYWJiLmxvd2VyQm91bmQueCArIGNoaWxkMS5hYWJiLnVwcGVyQm91bmQueCkgLyAyIC0gY2VudGVyLngpICsgTWF0aC5hYnMoKGNoaWxkMS5hYWJiLmxvd2VyQm91bmQueSArIGNoaWxkMS5hYWJiLnVwcGVyQm91bmQueSkgLyAyIC0gY2VudGVyLnkpO1xyXG4gICAgICAgICAgICB2YXIgbm9ybTIgPSBNYXRoLmFicygoY2hpbGQyLmFhYmIubG93ZXJCb3VuZC54ICsgY2hpbGQyLmFhYmIudXBwZXJCb3VuZC54KSAvIDIgLSBjZW50ZXIueCkgKyBNYXRoLmFicygoY2hpbGQyLmFhYmIubG93ZXJCb3VuZC55ICsgY2hpbGQyLmFhYmIudXBwZXJCb3VuZC55KSAvIDIgLSBjZW50ZXIueSk7XHJcbiAgICAgICAgICAgIGlmIChub3JtMSA8IG5vcm0yKSB7XHJcbiAgICAgICAgICAgICAgIHNpYmxpbmcgPSBjaGlsZDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIHNpYmxpbmcgPSBjaGlsZDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICB3aGlsZSAoc2libGluZy5Jc0xlYWYoKSA9PSBmYWxzZSlcclxuICAgICAgfVxyXG4gICAgICB2YXIgbm9kZTEgPSBzaWJsaW5nLnBhcmVudDtcclxuICAgICAgdmFyIG5vZGUyID0gdGhpcy5BbGxvY2F0ZU5vZGUoKTtcclxuICAgICAgbm9kZTIucGFyZW50ID0gbm9kZTE7XHJcbiAgICAgIG5vZGUyLnVzZXJEYXRhID0gbnVsbDtcclxuICAgICAgbm9kZTIuYWFiYi5Db21iaW5lKGxlYWYuYWFiYiwgc2libGluZy5hYWJiKTtcclxuICAgICAgaWYgKG5vZGUxKSB7XHJcbiAgICAgICAgIGlmIChzaWJsaW5nLnBhcmVudC5jaGlsZDEgPT0gc2libGluZykge1xyXG4gICAgICAgICAgICBub2RlMS5jaGlsZDEgPSBub2RlMjtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbm9kZTEuY2hpbGQyID0gbm9kZTI7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgbm9kZTIuY2hpbGQxID0gc2libGluZztcclxuICAgICAgICAgbm9kZTIuY2hpbGQyID0gbGVhZjtcclxuICAgICAgICAgc2libGluZy5wYXJlbnQgPSBub2RlMjtcclxuICAgICAgICAgbGVhZi5wYXJlbnQgPSBub2RlMjtcclxuICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICBpZiAobm9kZTEuYWFiYi5Db250YWlucyhub2RlMi5hYWJiKSkgYnJlYWs7XHJcbiAgICAgICAgICAgIG5vZGUxLmFhYmIuQ29tYmluZShub2RlMS5jaGlsZDEuYWFiYiwgbm9kZTEuY2hpbGQyLmFhYmIpO1xyXG4gICAgICAgICAgICBub2RlMiA9IG5vZGUxO1xyXG4gICAgICAgICAgICBub2RlMSA9IG5vZGUxLnBhcmVudDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB3aGlsZSAobm9kZTEpXHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIG5vZGUyLmNoaWxkMSA9IHNpYmxpbmc7XHJcbiAgICAgICAgIG5vZGUyLmNoaWxkMiA9IGxlYWY7XHJcbiAgICAgICAgIHNpYmxpbmcucGFyZW50ID0gbm9kZTI7XHJcbiAgICAgICAgIGxlYWYucGFyZW50ID0gbm9kZTI7XHJcbiAgICAgICAgIHRoaXMubV9yb290ID0gbm9kZTI7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlLnByb3RvdHlwZS5SZW1vdmVMZWFmID0gZnVuY3Rpb24gKGxlYWYpIHtcclxuICAgICAgaWYgKGxlYWYgPT0gdGhpcy5tX3Jvb3QpIHtcclxuICAgICAgICAgdGhpcy5tX3Jvb3QgPSBudWxsO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIG5vZGUyID0gbGVhZi5wYXJlbnQ7XHJcbiAgICAgIHZhciBub2RlMSA9IG5vZGUyLnBhcmVudDtcclxuICAgICAgdmFyIHNpYmxpbmc7XHJcbiAgICAgIGlmIChub2RlMi5jaGlsZDEgPT0gbGVhZikge1xyXG4gICAgICAgICBzaWJsaW5nID0gbm9kZTIuY2hpbGQyO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBzaWJsaW5nID0gbm9kZTIuY2hpbGQxO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChub2RlMSkge1xyXG4gICAgICAgICBpZiAobm9kZTEuY2hpbGQxID09IG5vZGUyKSB7XHJcbiAgICAgICAgICAgIG5vZGUxLmNoaWxkMSA9IHNpYmxpbmc7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG5vZGUxLmNoaWxkMiA9IHNpYmxpbmc7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgc2libGluZy5wYXJlbnQgPSBub2RlMTtcclxuICAgICAgICAgdGhpcy5GcmVlTm9kZShub2RlMik7XHJcbiAgICAgICAgIHdoaWxlIChub2RlMSkge1xyXG4gICAgICAgICAgICB2YXIgb2xkQUFCQiA9IG5vZGUxLmFhYmI7XHJcbiAgICAgICAgICAgIG5vZGUxLmFhYmIgPSBiMkFBQkIuQ29tYmluZShub2RlMS5jaGlsZDEuYWFiYiwgbm9kZTEuY2hpbGQyLmFhYmIpO1xyXG4gICAgICAgICAgICBpZiAob2xkQUFCQi5Db250YWlucyhub2RlMS5hYWJiKSkgYnJlYWs7XHJcbiAgICAgICAgICAgIG5vZGUxID0gbm9kZTEucGFyZW50O1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9yb290ID0gc2libGluZztcclxuICAgICAgICAgc2libGluZy5wYXJlbnQgPSBudWxsO1xyXG4gICAgICAgICB0aGlzLkZyZWVOb2RlKG5vZGUyKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLmIyRHluYW1pY1RyZWVCcm9hZFBoYXNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fdHJlZSA9IG5ldyBiMkR5bmFtaWNUcmVlKCk7XHJcbiAgICAgIHRoaXMubV9tb3ZlQnVmZmVyID0gbmV3IFZlY3RvcigpO1xyXG4gICAgICB0aGlzLm1fcGFpckJ1ZmZlciA9IG5ldyBWZWN0b3IoKTtcclxuICAgICAgdGhpcy5tX3BhaXJDb3VudCA9IDA7XHJcbiAgIH07XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5DcmVhdGVQcm94eSA9IGZ1bmN0aW9uIChhYWJiLCB1c2VyRGF0YSkge1xyXG4gICAgICB2YXIgcHJveHkgPSB0aGlzLm1fdHJlZS5DcmVhdGVQcm94eShhYWJiLCB1c2VyRGF0YSk7XHJcbiAgICAgICsrdGhpcy5tX3Byb3h5Q291bnQ7XHJcbiAgICAgIHRoaXMuQnVmZmVyTW92ZShwcm94eSk7XHJcbiAgICAgIHJldHVybiBwcm94eTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuRGVzdHJveVByb3h5ID0gZnVuY3Rpb24gKHByb3h5KSB7XHJcbiAgICAgIHRoaXMuVW5CdWZmZXJNb3ZlKHByb3h5KTtcclxuICAgICAgLS10aGlzLm1fcHJveHlDb3VudDtcclxuICAgICAgdGhpcy5tX3RyZWUuRGVzdHJveVByb3h5KHByb3h5KTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuTW92ZVByb3h5ID0gZnVuY3Rpb24gKHByb3h5LCBhYWJiLCBkaXNwbGFjZW1lbnQpIHtcclxuICAgICAgdmFyIGJ1ZmZlciA9IHRoaXMubV90cmVlLk1vdmVQcm94eShwcm94eSwgYWFiYiwgZGlzcGxhY2VtZW50KTtcclxuICAgICAgaWYgKGJ1ZmZlcikge1xyXG4gICAgICAgICB0aGlzLkJ1ZmZlck1vdmUocHJveHkpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLlRlc3RPdmVybGFwID0gZnVuY3Rpb24gKHByb3h5QSwgcHJveHlCKSB7XHJcbiAgICAgIHZhciBhYWJiQSA9IHRoaXMubV90cmVlLkdldEZhdEFBQkIocHJveHlBKTtcclxuICAgICAgdmFyIGFhYmJCID0gdGhpcy5tX3RyZWUuR2V0RmF0QUFCQihwcm94eUIpO1xyXG4gICAgICByZXR1cm4gYWFiYkEuVGVzdE92ZXJsYXAoYWFiYkIpO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5HZXRVc2VyRGF0YSA9IGZ1bmN0aW9uIChwcm94eSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3RyZWUuR2V0VXNlckRhdGEocHJveHkpO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5HZXRGYXRBQUJCID0gZnVuY3Rpb24gKHByb3h5KSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdHJlZS5HZXRGYXRBQUJCKHByb3h5KTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuR2V0UHJveHlDb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9wcm94eUNvdW50O1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5VcGRhdGVQYWlycyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICB2YXIgX190aGlzID0gdGhpcztcclxuICAgICAgX190aGlzLm1fcGFpckNvdW50ID0gMDtcclxuICAgICAgdmFyIGkgPSAwLFxyXG4gICAgICAgICBxdWVyeVByb3h5O1xyXG4gICAgICAgZnVuY3Rpb24gUXVlcnlDYWxsYmFjayhwcm94eSkge1xyXG4gICAgICAgICAgaWYgKHByb3h5ID09IHF1ZXJ5UHJveHkpIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgaWYgKF9fdGhpcy5tX3BhaXJDb3VudCA9PSBfX3RoaXMubV9wYWlyQnVmZmVyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgX190aGlzLm1fcGFpckJ1ZmZlcltfX3RoaXMubV9wYWlyQ291bnRdID0gbmV3IGIyRHluYW1pY1RyZWVQYWlyKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2YXIgcGFpciA9IF9fdGhpcy5tX3BhaXJCdWZmZXJbX190aGlzLm1fcGFpckNvdW50XTtcclxuICAgICAgICAgIHBhaXIucHJveHlBID0gcHJveHkgPCBxdWVyeVByb3h5ID8gcHJveHkgOiBxdWVyeVByb3h5O1xyXG4gICAgICAgICAgcGFpci5wcm94eUIgPSBwcm94eSA+PSBxdWVyeVByb3h5ID8gcHJveHkgOiBxdWVyeVByb3h5OysrX190aGlzLm1fcGFpckNvdW50O1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICB9O1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgX190aGlzLm1fbW92ZUJ1ZmZlci5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICBxdWVyeVByb3h5ID0gX190aGlzLm1fbW92ZUJ1ZmZlcltpXTtcclxuICAgICAgICAgdmFyIGZhdEFBQkIgPSBfX3RoaXMubV90cmVlLkdldEZhdEFBQkIocXVlcnlQcm94eSk7XHJcbiAgICAgICAgIF9fdGhpcy5tX3RyZWUuUXVlcnkoUXVlcnlDYWxsYmFjaywgZmF0QUFCQik7XHJcbiAgICAgIH1cclxuICAgICAgX190aGlzLm1fbW92ZUJ1ZmZlci5sZW5ndGggPSAwO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9fdGhpcy5tX3BhaXJDb3VudDspIHtcclxuICAgICAgICAgdmFyIHByaW1hcnlQYWlyID0gX190aGlzLm1fcGFpckJ1ZmZlcltpXTtcclxuICAgICAgICAgdmFyIHVzZXJEYXRhQSA9IF9fdGhpcy5tX3RyZWUuR2V0VXNlckRhdGEocHJpbWFyeVBhaXIucHJveHlBKTtcclxuICAgICAgICAgdmFyIHVzZXJEYXRhQiA9IF9fdGhpcy5tX3RyZWUuR2V0VXNlckRhdGEocHJpbWFyeVBhaXIucHJveHlCKTtcclxuICAgICAgICAgY2FsbGJhY2sodXNlckRhdGFBLCB1c2VyRGF0YUIpO1xyXG4gICAgICAgICArK2k7XHJcbiAgICAgICAgIHdoaWxlIChpIDwgX190aGlzLm1fcGFpckNvdW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwYWlyID0gX190aGlzLm1fcGFpckJ1ZmZlcltpXTtcclxuICAgICAgICAgICAgaWYgKHBhaXIucHJveHlBICE9IHByaW1hcnlQYWlyLnByb3h5QSB8fCBwYWlyLnByb3h5QiAhPSBwcmltYXJ5UGFpci5wcm94eUIpIHtcclxuICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH0rK2k7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5RdWVyeSA9IGZ1bmN0aW9uIChjYWxsYmFjaywgYWFiYikge1xyXG4gICAgICB0aGlzLm1fdHJlZS5RdWVyeShjYWxsYmFjaywgYWFiYik7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLlJheUNhc3QgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIGlucHV0KSB7XHJcbiAgICAgIHRoaXMubV90cmVlLlJheUNhc3QoY2FsbGJhY2ssIGlucHV0KTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuVmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuUmViYWxhbmNlID0gZnVuY3Rpb24gKGl0ZXJhdGlvbnMpIHtcclxuICAgICAgaWYgKGl0ZXJhdGlvbnMgPT09IHVuZGVmaW5lZCkgaXRlcmF0aW9ucyA9IDA7XHJcbiAgICAgIHRoaXMubV90cmVlLlJlYmFsYW5jZShpdGVyYXRpb25zKTtcclxuICAgfVxyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5wcm90b3R5cGUuQnVmZmVyTW92ZSA9IGZ1bmN0aW9uIChwcm94eSkge1xyXG4gICAgICB0aGlzLm1fbW92ZUJ1ZmZlclt0aGlzLm1fbW92ZUJ1ZmZlci5sZW5ndGhdID0gcHJveHk7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZUJyb2FkUGhhc2UucHJvdG90eXBlLlVuQnVmZmVyTW92ZSA9IGZ1bmN0aW9uIChwcm94eSkge1xyXG4gICAgICB2YXIgaSA9IHBhcnNlSW50KHRoaXMubV9tb3ZlQnVmZmVyLmluZGV4T2YocHJveHkpKTtcclxuICAgICAgdGhpcy5tX21vdmVCdWZmZXIuc3BsaWNlKGksIDEpO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLnByb3RvdHlwZS5Db21wYXJlUGFpcnMgPSBmdW5jdGlvbiAocGFpcjEsIHBhaXIyKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICB9XHJcbiAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLl9faW1wbGVtZW50cyA9IHt9O1xyXG4gICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZS5fX2ltcGxlbWVudHNbSUJyb2FkUGhhc2VdID0gdHJ1ZTtcclxuICAgYjJEeW5hbWljVHJlZU5vZGUuYjJEeW5hbWljVHJlZU5vZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuYWFiYiA9IG5ldyBiMkFBQkIoKTtcclxuICAgfTtcclxuICAgYjJEeW5hbWljVHJlZU5vZGUucHJvdG90eXBlLklzTGVhZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuY2hpbGQxID09IG51bGw7XHJcbiAgIH1cclxuICAgYjJEeW5hbWljVHJlZVBhaXIuYjJEeW5hbWljVHJlZVBhaXIgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJNYW5pZm9sZC5iMk1hbmlmb2xkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fcG9pbnRDb3VudCA9IDA7XHJcbiAgIH07XHJcbiAgIGIyTWFuaWZvbGQucHJvdG90eXBlLmIyTWFuaWZvbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9wb2ludHMgPSBuZXcgVmVjdG9yKGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHMpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7IGkrKykge1xyXG4gICAgICAgICB0aGlzLm1fcG9pbnRzW2ldID0gbmV3IGIyTWFuaWZvbGRQb2ludCgpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9sb2NhbFBsYW5lTm9ybWFsID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxQb2ludCA9IG5ldyBiMlZlYzIoKTtcclxuICAgfVxyXG4gICBiMk1hbmlmb2xkLnByb3RvdHlwZS5SZXNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzOyBpKyspIHtcclxuICAgICAgICAgKCh0aGlzLm1fcG9pbnRzW2ldIGluc3RhbmNlb2YgYjJNYW5pZm9sZFBvaW50ID8gdGhpcy5tX3BvaW50c1tpXSA6IG51bGwpKS5SZXNldCgpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9sb2NhbFBsYW5lTm9ybWFsLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX2xvY2FsUG9pbnQuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fdHlwZSA9IDA7XHJcbiAgICAgIHRoaXMubV9wb2ludENvdW50ID0gMDtcclxuICAgfVxyXG4gICBiMk1hbmlmb2xkLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAobSkge1xyXG4gICAgICB0aGlzLm1fcG9pbnRDb3VudCA9IG0ubV9wb2ludENvdW50O1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7IGkrKykge1xyXG4gICAgICAgICAoKHRoaXMubV9wb2ludHNbaV0gaW5zdGFuY2VvZiBiMk1hbmlmb2xkUG9pbnQgPyB0aGlzLm1fcG9pbnRzW2ldIDogbnVsbCkpLlNldChtLm1fcG9pbnRzW2ldKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fbG9jYWxQbGFuZU5vcm1hbC5TZXRWKG0ubV9sb2NhbFBsYW5lTm9ybWFsKTtcclxuICAgICAgdGhpcy5tX2xvY2FsUG9pbnQuU2V0VihtLm1fbG9jYWxQb2ludCk7XHJcbiAgICAgIHRoaXMubV90eXBlID0gbS5tX3R5cGU7XHJcbiAgIH1cclxuICAgYjJNYW5pZm9sZC5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGNvcHkgPSBuZXcgYjJNYW5pZm9sZCgpO1xyXG4gICAgICBjb3B5LlNldCh0aGlzKTtcclxuICAgICAgcmV0dXJuIGNvcHk7XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkLmVfY2lyY2xlcyA9IDB4MDAwMTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGQuZV9mYWNlQSA9IDB4MDAwMjtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGQuZV9mYWNlQiA9IDB4MDAwNDtcclxuICAgfSk7XHJcbiAgIGIyTWFuaWZvbGRQb2ludC5iMk1hbmlmb2xkUG9pbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9sb2NhbFBvaW50ID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1faWQgPSBuZXcgYjJDb250YWN0SUQoKTtcclxuICAgfTtcclxuICAgYjJNYW5pZm9sZFBvaW50LnByb3RvdHlwZS5iMk1hbmlmb2xkUG9pbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuUmVzZXQoKTtcclxuICAgfVxyXG4gICBiMk1hbmlmb2xkUG9pbnQucHJvdG90eXBlLlJlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fbG9jYWxQb2ludC5TZXRaZXJvKCk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWxJbXB1bHNlID0gMC4wO1xyXG4gICAgICB0aGlzLm1fdGFuZ2VudEltcHVsc2UgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9pZC5rZXkgPSAwO1xyXG4gICB9XHJcbiAgIGIyTWFuaWZvbGRQb2ludC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKG0pIHtcclxuICAgICAgdGhpcy5tX2xvY2FsUG9pbnQuU2V0VihtLm1fbG9jYWxQb2ludCk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWxJbXB1bHNlID0gbS5tX25vcm1hbEltcHVsc2U7XHJcbiAgICAgIHRoaXMubV90YW5nZW50SW1wdWxzZSA9IG0ubV90YW5nZW50SW1wdWxzZTtcclxuICAgICAgdGhpcy5tX2lkLlNldChtLm1faWQpO1xyXG4gICB9XHJcbiAgIGIyUG9pbnQuYjJQb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5wID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMlBvaW50LnByb3RvdHlwZS5TdXBwb3J0ID0gZnVuY3Rpb24gKHhmLCB2WCwgdlkpIHtcclxuICAgICAgaWYgKHZYID09PSB1bmRlZmluZWQpIHZYID0gMDtcclxuICAgICAgaWYgKHZZID09PSB1bmRlZmluZWQpIHZZID0gMDtcclxuICAgICAgcmV0dXJuIHRoaXMucDtcclxuICAgfVxyXG4gICBiMlBvaW50LnByb3RvdHlwZS5HZXRGaXJzdFZlcnRleCA9IGZ1bmN0aW9uICh4Zikge1xyXG4gICAgICByZXR1cm4gdGhpcy5wO1xyXG4gICB9XHJcbiAgIGIyUmF5Q2FzdElucHV0LmIyUmF5Q2FzdElucHV0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnAxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLnAyID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMlJheUNhc3RJbnB1dC5wcm90b3R5cGUuYjJSYXlDYXN0SW5wdXQgPSBmdW5jdGlvbiAocDEsIHAyLCBtYXhGcmFjdGlvbikge1xyXG4gICAgICBpZiAocDEgPT09IHVuZGVmaW5lZCkgcDEgPSBudWxsO1xyXG4gICAgICBpZiAocDIgPT09IHVuZGVmaW5lZCkgcDIgPSBudWxsO1xyXG4gICAgICBpZiAobWF4RnJhY3Rpb24gPT09IHVuZGVmaW5lZCkgbWF4RnJhY3Rpb24gPSAxO1xyXG4gICAgICBpZiAocDEpIHRoaXMucDEuU2V0VihwMSk7XHJcbiAgICAgIGlmIChwMikgdGhpcy5wMi5TZXRWKHAyKTtcclxuICAgICAgdGhpcy5tYXhGcmFjdGlvbiA9IG1heEZyYWN0aW9uO1xyXG4gICB9XHJcbiAgIGIyUmF5Q2FzdE91dHB1dC5iMlJheUNhc3RPdXRwdXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubm9ybWFsID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMlNlZ21lbnQuYjJTZWdtZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnAxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLnAyID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMlNlZ21lbnQucHJvdG90eXBlLlRlc3RTZWdtZW50ID0gZnVuY3Rpb24gKGxhbWJkYSwgbm9ybWFsLCBzZWdtZW50LCBtYXhMYW1iZGEpIHtcclxuICAgICAgaWYgKG1heExhbWJkYSA9PT0gdW5kZWZpbmVkKSBtYXhMYW1iZGEgPSAwO1xyXG4gICAgICB2YXIgcyA9IHNlZ21lbnQucDE7XHJcbiAgICAgIHZhciByWCA9IHNlZ21lbnQucDIueCAtIHMueDtcclxuICAgICAgdmFyIHJZID0gc2VnbWVudC5wMi55IC0gcy55O1xyXG4gICAgICB2YXIgZFggPSB0aGlzLnAyLnggLSB0aGlzLnAxLng7XHJcbiAgICAgIHZhciBkWSA9IHRoaXMucDIueSAtIHRoaXMucDEueTtcclxuICAgICAgdmFyIG5YID0gZFk7XHJcbiAgICAgIHZhciBuWSA9ICgtZFgpO1xyXG4gICAgICB2YXIga19zbG9wID0gMTAwLjAgKiBOdW1iZXIuTUlOX1ZBTFVFO1xyXG4gICAgICB2YXIgZGVub20gPSAoLShyWCAqIG5YICsgclkgKiBuWSkpO1xyXG4gICAgICBpZiAoZGVub20gPiBrX3Nsb3ApIHtcclxuICAgICAgICAgdmFyIGJYID0gcy54IC0gdGhpcy5wMS54O1xyXG4gICAgICAgICB2YXIgYlkgPSBzLnkgLSB0aGlzLnAxLnk7XHJcbiAgICAgICAgIHZhciBhID0gKGJYICogblggKyBiWSAqIG5ZKTtcclxuICAgICAgICAgaWYgKDAuMCA8PSBhICYmIGEgPD0gbWF4TGFtYmRhICogZGVub20pIHtcclxuICAgICAgICAgICAgdmFyIG11MiA9ICgtclggKiBiWSkgKyByWSAqIGJYO1xyXG4gICAgICAgICAgICBpZiAoKC1rX3Nsb3AgKiBkZW5vbSkgPD0gbXUyICYmIG11MiA8PSBkZW5vbSAqICgxLjAgKyBrX3Nsb3ApKSB7XHJcbiAgICAgICAgICAgICAgIGEgLz0gZGVub207XHJcbiAgICAgICAgICAgICAgIHZhciBuTGVuID0gTWF0aC5zcXJ0KG5YICogblggKyBuWSAqIG5ZKTtcclxuICAgICAgICAgICAgICAgblggLz0gbkxlbjtcclxuICAgICAgICAgICAgICAgblkgLz0gbkxlbjtcclxuICAgICAgICAgICAgICAgbGFtYmRhWzBdID0gYTtcclxuICAgICAgICAgICAgICAgbm9ybWFsLlNldChuWCwgblkpO1xyXG4gICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICB9XHJcbiAgIGIyU2VnbWVudC5wcm90b3R5cGUuRXh0ZW5kID0gZnVuY3Rpb24gKGFhYmIpIHtcclxuICAgICAgdGhpcy5FeHRlbmRGb3J3YXJkKGFhYmIpO1xyXG4gICAgICB0aGlzLkV4dGVuZEJhY2t3YXJkKGFhYmIpO1xyXG4gICB9XHJcbiAgIGIyU2VnbWVudC5wcm90b3R5cGUuRXh0ZW5kRm9yd2FyZCA9IGZ1bmN0aW9uIChhYWJiKSB7XHJcbiAgICAgIHZhciBkWCA9IHRoaXMucDIueCAtIHRoaXMucDEueDtcclxuICAgICAgdmFyIGRZID0gdGhpcy5wMi55IC0gdGhpcy5wMS55O1xyXG4gICAgICB2YXIgbGFtYmRhID0gTWF0aC5taW4oZFggPiAwID8gKGFhYmIudXBwZXJCb3VuZC54IC0gdGhpcy5wMS54KSAvIGRYIDogZFggPCAwID8gKGFhYmIubG93ZXJCb3VuZC54IC0gdGhpcy5wMS54KSAvIGRYIDogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLFxyXG4gICAgICBkWSA+IDAgPyAoYWFiYi51cHBlckJvdW5kLnkgLSB0aGlzLnAxLnkpIC8gZFkgOiBkWSA8IDAgPyAoYWFiYi5sb3dlckJvdW5kLnkgLSB0aGlzLnAxLnkpIC8gZFkgOiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpO1xyXG4gICAgICB0aGlzLnAyLnggPSB0aGlzLnAxLnggKyBkWCAqIGxhbWJkYTtcclxuICAgICAgdGhpcy5wMi55ID0gdGhpcy5wMS55ICsgZFkgKiBsYW1iZGE7XHJcbiAgIH1cclxuICAgYjJTZWdtZW50LnByb3RvdHlwZS5FeHRlbmRCYWNrd2FyZCA9IGZ1bmN0aW9uIChhYWJiKSB7XHJcbiAgICAgIHZhciBkWCA9ICgtdGhpcy5wMi54KSArIHRoaXMucDEueDtcclxuICAgICAgdmFyIGRZID0gKC10aGlzLnAyLnkpICsgdGhpcy5wMS55O1xyXG4gICAgICB2YXIgbGFtYmRhID0gTWF0aC5taW4oZFggPiAwID8gKGFhYmIudXBwZXJCb3VuZC54IC0gdGhpcy5wMi54KSAvIGRYIDogZFggPCAwID8gKGFhYmIubG93ZXJCb3VuZC54IC0gdGhpcy5wMi54KSAvIGRYIDogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLFxyXG4gICAgICBkWSA+IDAgPyAoYWFiYi51cHBlckJvdW5kLnkgLSB0aGlzLnAyLnkpIC8gZFkgOiBkWSA8IDAgPyAoYWFiYi5sb3dlckJvdW5kLnkgLSB0aGlzLnAyLnkpIC8gZFkgOiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpO1xyXG4gICAgICB0aGlzLnAxLnggPSB0aGlzLnAyLnggKyBkWCAqIGxhbWJkYTtcclxuICAgICAgdGhpcy5wMS55ID0gdGhpcy5wMi55ICsgZFkgKiBsYW1iZGE7XHJcbiAgIH1cclxuICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24uYjJTZXBhcmF0aW9uRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9sb2NhbFBvaW50ID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fYXhpcyA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24ucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoY2FjaGUsIHByb3h5QSwgdHJhbnNmb3JtQSwgcHJveHlCLCB0cmFuc2Zvcm1CKSB7XHJcbiAgICAgIHRoaXMubV9wcm94eUEgPSBwcm94eUE7XHJcbiAgICAgIHRoaXMubV9wcm94eUIgPSBwcm94eUI7XHJcbiAgICAgIHZhciBjb3VudCA9IHBhcnNlSW50KGNhY2hlLmNvdW50KTtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCgwIDwgY291bnQgJiYgY291bnQgPCAzKTtcclxuICAgICAgdmFyIGxvY2FsUG9pbnRBO1xyXG4gICAgICB2YXIgbG9jYWxQb2ludEExO1xyXG4gICAgICB2YXIgbG9jYWxQb2ludEEyO1xyXG4gICAgICB2YXIgbG9jYWxQb2ludEI7XHJcbiAgICAgIHZhciBsb2NhbFBvaW50QjE7XHJcbiAgICAgIHZhciBsb2NhbFBvaW50QjI7XHJcbiAgICAgIHZhciBwb2ludEFYID0gMDtcclxuICAgICAgdmFyIHBvaW50QVkgPSAwO1xyXG4gICAgICB2YXIgcG9pbnRCWCA9IDA7XHJcbiAgICAgIHZhciBwb2ludEJZID0gMDtcclxuICAgICAgdmFyIG5vcm1hbFggPSAwO1xyXG4gICAgICB2YXIgbm9ybWFsWSA9IDA7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgdmFyIHMgPSAwO1xyXG4gICAgICB2YXIgc2duID0gMDtcclxuICAgICAgaWYgKGNvdW50ID09IDEpIHtcclxuICAgICAgICAgdGhpcy5tX3R5cGUgPSBiMlNlcGFyYXRpb25GdW5jdGlvbi5lX3BvaW50cztcclxuICAgICAgICAgbG9jYWxQb2ludEEgPSB0aGlzLm1fcHJveHlBLkdldFZlcnRleChjYWNoZS5pbmRleEFbMF0pO1xyXG4gICAgICAgICBsb2NhbFBvaW50QiA9IHRoaXMubV9wcm94eUIuR2V0VmVydGV4KGNhY2hlLmluZGV4QlswXSk7XHJcbiAgICAgICAgIHRWZWMgPSBsb2NhbFBvaW50QTtcclxuICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUEuUjtcclxuICAgICAgICAgcG9pbnRBWCA9IHRyYW5zZm9ybUEucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgcG9pbnRBWSA9IHRyYW5zZm9ybUEucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgdFZlYyA9IGxvY2FsUG9pbnRCO1xyXG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQi5SO1xyXG4gICAgICAgICBwb2ludEJYID0gdHJhbnNmb3JtQi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICBwb2ludEJZID0gdHJhbnNmb3JtQi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICB0aGlzLm1fYXhpcy54ID0gcG9pbnRCWCAtIHBvaW50QVg7XHJcbiAgICAgICAgIHRoaXMubV9heGlzLnkgPSBwb2ludEJZIC0gcG9pbnRBWTtcclxuICAgICAgICAgdGhpcy5tX2F4aXMuTm9ybWFsaXplKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAoY2FjaGUuaW5kZXhCWzBdID09IGNhY2hlLmluZGV4QlsxXSkge1xyXG4gICAgICAgICB0aGlzLm1fdHlwZSA9IGIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfZmFjZUE7XHJcbiAgICAgICAgIGxvY2FsUG9pbnRBMSA9IHRoaXMubV9wcm94eUEuR2V0VmVydGV4KGNhY2hlLmluZGV4QVswXSk7XHJcbiAgICAgICAgIGxvY2FsUG9pbnRBMiA9IHRoaXMubV9wcm94eUEuR2V0VmVydGV4KGNhY2hlLmluZGV4QVsxXSk7XHJcbiAgICAgICAgIGxvY2FsUG9pbnRCID0gdGhpcy5tX3Byb3h5Qi5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhCWzBdKTtcclxuICAgICAgICAgdGhpcy5tX2xvY2FsUG9pbnQueCA9IDAuNSAqIChsb2NhbFBvaW50QTEueCArIGxvY2FsUG9pbnRBMi54KTtcclxuICAgICAgICAgdGhpcy5tX2xvY2FsUG9pbnQueSA9IDAuNSAqIChsb2NhbFBvaW50QTEueSArIGxvY2FsUG9pbnRBMi55KTtcclxuICAgICAgICAgdGhpcy5tX2F4aXMgPSBiMk1hdGguQ3Jvc3NWRihiMk1hdGguU3VidHJhY3RWVihsb2NhbFBvaW50QTIsIGxvY2FsUG9pbnRBMSksIDEuMCk7XHJcbiAgICAgICAgIHRoaXMubV9heGlzLk5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICB0VmVjID0gdGhpcy5tX2F4aXM7XHJcbiAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1BLlI7XHJcbiAgICAgICAgIG5vcm1hbFggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICBub3JtYWxZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgdFZlYyA9IHRoaXMubV9sb2NhbFBvaW50O1xyXG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQS5SO1xyXG4gICAgICAgICBwb2ludEFYID0gdHJhbnNmb3JtQS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICBwb2ludEFZID0gdHJhbnNmb3JtQS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICB0VmVjID0gbG9jYWxQb2ludEI7XHJcbiAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1CLlI7XHJcbiAgICAgICAgIHBvaW50QlggPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgIHBvaW50QlkgPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgIHMgPSAocG9pbnRCWCAtIHBvaW50QVgpICogbm9ybWFsWCArIChwb2ludEJZIC0gcG9pbnRBWSkgKiBub3JtYWxZO1xyXG4gICAgICAgICBpZiAocyA8IDAuMCkge1xyXG4gICAgICAgICAgICB0aGlzLm1fYXhpcy5OZWdhdGl2ZVNlbGYoKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKGNhY2hlLmluZGV4QVswXSA9PSBjYWNoZS5pbmRleEFbMF0pIHtcclxuICAgICAgICAgdGhpcy5tX3R5cGUgPSBiMlNlcGFyYXRpb25GdW5jdGlvbi5lX2ZhY2VCO1xyXG4gICAgICAgICBsb2NhbFBvaW50QjEgPSB0aGlzLm1fcHJveHlCLkdldFZlcnRleChjYWNoZS5pbmRleEJbMF0pO1xyXG4gICAgICAgICBsb2NhbFBvaW50QjIgPSB0aGlzLm1fcHJveHlCLkdldFZlcnRleChjYWNoZS5pbmRleEJbMV0pO1xyXG4gICAgICAgICBsb2NhbFBvaW50QSA9IHRoaXMubV9wcm94eUEuR2V0VmVydGV4KGNhY2hlLmluZGV4QVswXSk7XHJcbiAgICAgICAgIHRoaXMubV9sb2NhbFBvaW50LnggPSAwLjUgKiAobG9jYWxQb2ludEIxLnggKyBsb2NhbFBvaW50QjIueCk7XHJcbiAgICAgICAgIHRoaXMubV9sb2NhbFBvaW50LnkgPSAwLjUgKiAobG9jYWxQb2ludEIxLnkgKyBsb2NhbFBvaW50QjIueSk7XHJcbiAgICAgICAgIHRoaXMubV9heGlzID0gYjJNYXRoLkNyb3NzVkYoYjJNYXRoLlN1YnRyYWN0VlYobG9jYWxQb2ludEIyLCBsb2NhbFBvaW50QjEpLCAxLjApO1xyXG4gICAgICAgICB0aGlzLm1fYXhpcy5Ob3JtYWxpemUoKTtcclxuICAgICAgICAgdFZlYyA9IHRoaXMubV9heGlzO1xyXG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQi5SO1xyXG4gICAgICAgICBub3JtYWxYID0gdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgbm9ybWFsWSA9IHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XHJcbiAgICAgICAgIHRWZWMgPSB0aGlzLm1fbG9jYWxQb2ludDtcclxuICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUIuUjtcclxuICAgICAgICAgcG9pbnRCWCA9IHRyYW5zZm9ybUIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgcG9pbnRCWSA9IHRyYW5zZm9ybUIucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgdFZlYyA9IGxvY2FsUG9pbnRBO1xyXG4gICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQS5SO1xyXG4gICAgICAgICBwb2ludEFYID0gdHJhbnNmb3JtQS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICBwb2ludEFZID0gdHJhbnNmb3JtQS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICBzID0gKHBvaW50QVggLSBwb2ludEJYKSAqIG5vcm1hbFggKyAocG9pbnRBWSAtIHBvaW50QlkpICogbm9ybWFsWTtcclxuICAgICAgICAgaWYgKHMgPCAwLjApIHtcclxuICAgICAgICAgICAgdGhpcy5tX2F4aXMuTmVnYXRpdmVTZWxmKCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgbG9jYWxQb2ludEExID0gdGhpcy5tX3Byb3h5QS5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhBWzBdKTtcclxuICAgICAgICAgbG9jYWxQb2ludEEyID0gdGhpcy5tX3Byb3h5QS5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhBWzFdKTtcclxuICAgICAgICAgbG9jYWxQb2ludEIxID0gdGhpcy5tX3Byb3h5Qi5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhCWzBdKTtcclxuICAgICAgICAgbG9jYWxQb2ludEIyID0gdGhpcy5tX3Byb3h5Qi5HZXRWZXJ0ZXgoY2FjaGUuaW5kZXhCWzFdKTtcclxuICAgICAgICAgdmFyIHBBID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQSwgbG9jYWxQb2ludEEpO1xyXG4gICAgICAgICB2YXIgZEEgPSBiMk1hdGguTXVsTVYodHJhbnNmb3JtQS5SLCBiMk1hdGguU3VidHJhY3RWVihsb2NhbFBvaW50QTIsIGxvY2FsUG9pbnRBMSkpO1xyXG4gICAgICAgICB2YXIgcEIgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1CLCBsb2NhbFBvaW50Qik7XHJcbiAgICAgICAgIHZhciBkQiA9IGIyTWF0aC5NdWxNVih0cmFuc2Zvcm1CLlIsIGIyTWF0aC5TdWJ0cmFjdFZWKGxvY2FsUG9pbnRCMiwgbG9jYWxQb2ludEIxKSk7XHJcbiAgICAgICAgIHZhciBhID0gZEEueCAqIGRBLnggKyBkQS55ICogZEEueTtcclxuICAgICAgICAgdmFyIGUgPSBkQi54ICogZEIueCArIGRCLnkgKiBkQi55O1xyXG4gICAgICAgICB2YXIgciA9IGIyTWF0aC5TdWJ0cmFjdFZWKGRCLCBkQSk7XHJcbiAgICAgICAgIHZhciBjID0gZEEueCAqIHIueCArIGRBLnkgKiByLnk7XHJcbiAgICAgICAgIHZhciBmID0gZEIueCAqIHIueCArIGRCLnkgKiByLnk7XHJcbiAgICAgICAgIHZhciBiID0gZEEueCAqIGRCLnggKyBkQS55ICogZEIueTtcclxuICAgICAgICAgdmFyIGRlbm9tID0gYSAqIGUgLSBiICogYjtcclxuICAgICAgICAgcyA9IDAuMDtcclxuICAgICAgICAgaWYgKGRlbm9tICE9IDAuMCkge1xyXG4gICAgICAgICAgICBzID0gYjJNYXRoLkNsYW1wKChiICogZiAtIGMgKiBlKSAvIGRlbm9tLCAwLjAsIDEuMCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIHQgPSAoYiAqIHMgKyBmKSAvIGU7XHJcbiAgICAgICAgIGlmICh0IDwgMC4wKSB7XHJcbiAgICAgICAgICAgIHQgPSAwLjA7XHJcbiAgICAgICAgICAgIHMgPSBiMk1hdGguQ2xhbXAoKGIgLSBjKSAvIGEsIDAuMCwgMS4wKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBsb2NhbFBvaW50QSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgICAgbG9jYWxQb2ludEEueCA9IGxvY2FsUG9pbnRBMS54ICsgcyAqIChsb2NhbFBvaW50QTIueCAtIGxvY2FsUG9pbnRBMS54KTtcclxuICAgICAgICAgbG9jYWxQb2ludEEueSA9IGxvY2FsUG9pbnRBMS55ICsgcyAqIChsb2NhbFBvaW50QTIueSAtIGxvY2FsUG9pbnRBMS55KTtcclxuICAgICAgICAgbG9jYWxQb2ludEIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgICAgIGxvY2FsUG9pbnRCLnggPSBsb2NhbFBvaW50QjEueCArIHMgKiAobG9jYWxQb2ludEIyLnggLSBsb2NhbFBvaW50QjEueCk7XHJcbiAgICAgICAgIGxvY2FsUG9pbnRCLnkgPSBsb2NhbFBvaW50QjEueSArIHMgKiAobG9jYWxQb2ludEIyLnkgLSBsb2NhbFBvaW50QjEueSk7XHJcbiAgICAgICAgIGlmIChzID09IDAuMCB8fCBzID09IDEuMCkge1xyXG4gICAgICAgICAgICB0aGlzLm1fdHlwZSA9IGIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfZmFjZUI7XHJcbiAgICAgICAgICAgIHRoaXMubV9heGlzID0gYjJNYXRoLkNyb3NzVkYoYjJNYXRoLlN1YnRyYWN0VlYobG9jYWxQb2ludEIyLCBsb2NhbFBvaW50QjEpLCAxLjApO1xyXG4gICAgICAgICAgICB0aGlzLm1fYXhpcy5Ob3JtYWxpemUoKTtcclxuICAgICAgICAgICAgdGhpcy5tX2xvY2FsUG9pbnQgPSBsb2NhbFBvaW50QjtcclxuICAgICAgICAgICAgdFZlYyA9IHRoaXMubV9heGlzO1xyXG4gICAgICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQi5SO1xyXG4gICAgICAgICAgICBub3JtYWxYID0gdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgICAgbm9ybWFsWSA9IHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHRWZWMgPSB0aGlzLm1fbG9jYWxQb2ludDtcclxuICAgICAgICAgICAgdE1hdCA9IHRyYW5zZm9ybUIuUjtcclxuICAgICAgICAgICAgcG9pbnRCWCA9IHRyYW5zZm9ybUIucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgICAgcG9pbnRCWSA9IHRyYW5zZm9ybUIucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgICAgdFZlYyA9IGxvY2FsUG9pbnRBO1xyXG4gICAgICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQS5SO1xyXG4gICAgICAgICAgICBwb2ludEFYID0gdHJhbnNmb3JtQS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICBwb2ludEFZID0gdHJhbnNmb3JtQS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICBzZ24gPSAocG9pbnRBWCAtIHBvaW50QlgpICogbm9ybWFsWCArIChwb2ludEFZIC0gcG9pbnRCWSkgKiBub3JtYWxZO1xyXG4gICAgICAgICAgICBpZiAocyA8IDAuMCkge1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fYXhpcy5OZWdhdGl2ZVNlbGYoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1fdHlwZSA9IGIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfZmFjZUE7XHJcbiAgICAgICAgICAgIHRoaXMubV9heGlzID0gYjJNYXRoLkNyb3NzVkYoYjJNYXRoLlN1YnRyYWN0VlYobG9jYWxQb2ludEEyLCBsb2NhbFBvaW50QTEpLCAxLjApO1xyXG4gICAgICAgICAgICB0aGlzLm1fbG9jYWxQb2ludCA9IGxvY2FsUG9pbnRBO1xyXG4gICAgICAgICAgICB0VmVjID0gdGhpcy5tX2F4aXM7XHJcbiAgICAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1BLlI7XHJcbiAgICAgICAgICAgIG5vcm1hbFggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICBub3JtYWxZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgICAgdFZlYyA9IHRoaXMubV9sb2NhbFBvaW50O1xyXG4gICAgICAgICAgICB0TWF0ID0gdHJhbnNmb3JtQS5SO1xyXG4gICAgICAgICAgICBwb2ludEFYID0gdHJhbnNmb3JtQS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICBwb2ludEFZID0gdHJhbnNmb3JtQS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICB0VmVjID0gbG9jYWxQb2ludEI7XHJcbiAgICAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm1CLlI7XHJcbiAgICAgICAgICAgIHBvaW50QlggPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHBvaW50QlkgPSB0cmFuc2Zvcm1CLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHNnbiA9IChwb2ludEJYIC0gcG9pbnRBWCkgKiBub3JtYWxYICsgKHBvaW50QlkgLSBwb2ludEFZKSAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgIGlmIChzIDwgMC4wKSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9heGlzLk5lZ2F0aXZlU2VsZigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyU2VwYXJhdGlvbkZ1bmN0aW9uLnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICh0cmFuc2Zvcm1BLCB0cmFuc2Zvcm1CKSB7XHJcbiAgICAgIHZhciBheGlzQTtcclxuICAgICAgdmFyIGF4aXNCO1xyXG4gICAgICB2YXIgbG9jYWxQb2ludEE7XHJcbiAgICAgIHZhciBsb2NhbFBvaW50QjtcclxuICAgICAgdmFyIHBvaW50QTtcclxuICAgICAgdmFyIHBvaW50QjtcclxuICAgICAgdmFyIHNlcGVyYXRpb24gPSAwO1xyXG4gICAgICB2YXIgbm9ybWFsO1xyXG4gICAgICBzd2l0Y2ggKHRoaXMubV90eXBlKSB7XHJcbiAgICAgIGNhc2UgYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9wb2ludHM6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgYXhpc0EgPSBiMk1hdGguTXVsVE1WKHRyYW5zZm9ybUEuUiwgdGhpcy5tX2F4aXMpO1xyXG4gICAgICAgICAgICBheGlzQiA9IGIyTWF0aC5NdWxUTVYodHJhbnNmb3JtQi5SLCB0aGlzLm1fYXhpcy5HZXROZWdhdGl2ZSgpKTtcclxuICAgICAgICAgICAgbG9jYWxQb2ludEEgPSB0aGlzLm1fcHJveHlBLkdldFN1cHBvcnRWZXJ0ZXgoYXhpc0EpO1xyXG4gICAgICAgICAgICBsb2NhbFBvaW50QiA9IHRoaXMubV9wcm94eUIuR2V0U3VwcG9ydFZlcnRleChheGlzQik7XHJcbiAgICAgICAgICAgIHBvaW50QSA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUEsIGxvY2FsUG9pbnRBKTtcclxuICAgICAgICAgICAgcG9pbnRCID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQiwgbG9jYWxQb2ludEIpO1xyXG4gICAgICAgICAgICBzZXBlcmF0aW9uID0gKHBvaW50Qi54IC0gcG9pbnRBLngpICogdGhpcy5tX2F4aXMueCArIChwb2ludEIueSAtIHBvaW50QS55KSAqIHRoaXMubV9heGlzLnk7XHJcbiAgICAgICAgICAgIHJldHVybiBzZXBlcmF0aW9uO1xyXG4gICAgICAgICB9XHJcbiAgICAgIGNhc2UgYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQTpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBub3JtYWwgPSBiMk1hdGguTXVsTVYodHJhbnNmb3JtQS5SLCB0aGlzLm1fYXhpcyk7XHJcbiAgICAgICAgICAgIHBvaW50QSA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUEsIHRoaXMubV9sb2NhbFBvaW50KTtcclxuICAgICAgICAgICAgYXhpc0IgPSBiMk1hdGguTXVsVE1WKHRyYW5zZm9ybUIuUiwgbm9ybWFsLkdldE5lZ2F0aXZlKCkpO1xyXG4gICAgICAgICAgICBsb2NhbFBvaW50QiA9IHRoaXMubV9wcm94eUIuR2V0U3VwcG9ydFZlcnRleChheGlzQik7XHJcbiAgICAgICAgICAgIHBvaW50QiA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUIsIGxvY2FsUG9pbnRCKTtcclxuICAgICAgICAgICAgc2VwZXJhdGlvbiA9IChwb2ludEIueCAtIHBvaW50QS54KSAqIG5vcm1hbC54ICsgKHBvaW50Qi55IC0gcG9pbnRBLnkpICogbm9ybWFsLnk7XHJcbiAgICAgICAgICAgIHJldHVybiBzZXBlcmF0aW9uO1xyXG4gICAgICAgICB9XHJcbiAgICAgIGNhc2UgYjJTZXBhcmF0aW9uRnVuY3Rpb24uZV9mYWNlQjpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBub3JtYWwgPSBiMk1hdGguTXVsTVYodHJhbnNmb3JtQi5SLCB0aGlzLm1fYXhpcyk7XHJcbiAgICAgICAgICAgIHBvaW50QiA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUIsIHRoaXMubV9sb2NhbFBvaW50KTtcclxuICAgICAgICAgICAgYXhpc0EgPSBiMk1hdGguTXVsVE1WKHRyYW5zZm9ybUEuUiwgbm9ybWFsLkdldE5lZ2F0aXZlKCkpO1xyXG4gICAgICAgICAgICBsb2NhbFBvaW50QSA9IHRoaXMubV9wcm94eUEuR2V0U3VwcG9ydFZlcnRleChheGlzQSk7XHJcbiAgICAgICAgICAgIHBvaW50QSA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUEsIGxvY2FsUG9pbnRBKTtcclxuICAgICAgICAgICAgc2VwZXJhdGlvbiA9IChwb2ludEEueCAtIHBvaW50Qi54KSAqIG5vcm1hbC54ICsgKHBvaW50QS55IC0gcG9pbnRCLnkpICogbm9ybWFsLnk7XHJcbiAgICAgICAgICAgIHJldHVybiBzZXBlcmF0aW9uO1xyXG4gICAgICAgICB9XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZmFsc2UpO1xyXG4gICAgICAgICByZXR1cm4gMC4wO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlNlcGFyYXRpb25GdW5jdGlvbi5lX3BvaW50cyA9IDB4MDE7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlNlcGFyYXRpb25GdW5jdGlvbi5lX2ZhY2VBID0gMHgwMjtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uLmVfZmFjZUIgPSAweDA0O1xyXG4gICB9KTtcclxuICAgYjJTaW1wbGV4LmIyU2ltcGxleCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3YxID0gbmV3IGIyU2ltcGxleFZlcnRleCgpO1xyXG4gICAgICB0aGlzLm1fdjIgPSBuZXcgYjJTaW1wbGV4VmVydGV4KCk7XHJcbiAgICAgIHRoaXMubV92MyA9IG5ldyBiMlNpbXBsZXhWZXJ0ZXgoKTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gbmV3IFZlY3RvcigzKTtcclxuICAgfTtcclxuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5iMlNpbXBsZXggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1swXSA9IHRoaXMubV92MTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzFdID0gdGhpcy5tX3YyO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXNbMl0gPSB0aGlzLm1fdjM7XHJcbiAgIH1cclxuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5SZWFkQ2FjaGUgPSBmdW5jdGlvbiAoY2FjaGUsIHByb3h5QSwgdHJhbnNmb3JtQSwgcHJveHlCLCB0cmFuc2Zvcm1CKSB7XHJcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoMCA8PSBjYWNoZS5jb3VudCAmJiBjYWNoZS5jb3VudCA8PSAzKTtcclxuICAgICAgdmFyIHdBTG9jYWw7XHJcbiAgICAgIHZhciB3QkxvY2FsO1xyXG4gICAgICB0aGlzLm1fY291bnQgPSBjYWNoZS5jb3VudDtcclxuICAgICAgdmFyIHZlcnRpY2VzID0gdGhpcy5tX3ZlcnRpY2VzO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb3VudDsgaSsrKSB7XHJcbiAgICAgICAgIHZhciB2ID0gdmVydGljZXNbaV07XHJcbiAgICAgICAgIHYuaW5kZXhBID0gY2FjaGUuaW5kZXhBW2ldO1xyXG4gICAgICAgICB2LmluZGV4QiA9IGNhY2hlLmluZGV4QltpXTtcclxuICAgICAgICAgd0FMb2NhbCA9IHByb3h5QS5HZXRWZXJ0ZXgodi5pbmRleEEpO1xyXG4gICAgICAgICB3QkxvY2FsID0gcHJveHlCLkdldFZlcnRleCh2LmluZGV4Qik7XHJcbiAgICAgICAgIHYud0EgPSBiMk1hdGguTXVsWCh0cmFuc2Zvcm1BLCB3QUxvY2FsKTtcclxuICAgICAgICAgdi53QiA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUIsIHdCTG9jYWwpO1xyXG4gICAgICAgICB2LncgPSBiMk1hdGguU3VidHJhY3RWVih2LndCLCB2LndBKTtcclxuICAgICAgICAgdi5hID0gMDtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2NvdW50ID4gMSkge1xyXG4gICAgICAgICB2YXIgbWV0cmljMSA9IGNhY2hlLm1ldHJpYztcclxuICAgICAgICAgdmFyIG1ldHJpYzIgPSB0aGlzLkdldE1ldHJpYygpO1xyXG4gICAgICAgICBpZiAobWV0cmljMiA8IC41ICogbWV0cmljMSB8fCAyLjAgKiBtZXRyaWMxIDwgbWV0cmljMiB8fCBtZXRyaWMyIDwgTnVtYmVyLk1JTl9WQUxVRSkge1xyXG4gICAgICAgICAgICB0aGlzLm1fY291bnQgPSAwO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubV9jb3VudCA9PSAwKSB7XHJcbiAgICAgICAgIHYgPSB2ZXJ0aWNlc1swXTtcclxuICAgICAgICAgdi5pbmRleEEgPSAwO1xyXG4gICAgICAgICB2LmluZGV4QiA9IDA7XHJcbiAgICAgICAgIHdBTG9jYWwgPSBwcm94eUEuR2V0VmVydGV4KDApO1xyXG4gICAgICAgICB3QkxvY2FsID0gcHJveHlCLkdldFZlcnRleCgwKTtcclxuICAgICAgICAgdi53QSA9IGIyTWF0aC5NdWxYKHRyYW5zZm9ybUEsIHdBTG9jYWwpO1xyXG4gICAgICAgICB2LndCID0gYjJNYXRoLk11bFgodHJhbnNmb3JtQiwgd0JMb2NhbCk7XHJcbiAgICAgICAgIHYudyA9IGIyTWF0aC5TdWJ0cmFjdFZWKHYud0IsIHYud0EpO1xyXG4gICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5Xcml0ZUNhY2hlID0gZnVuY3Rpb24gKGNhY2hlKSB7XHJcbiAgICAgIGNhY2hlLm1ldHJpYyA9IHRoaXMuR2V0TWV0cmljKCk7XHJcbiAgICAgIGNhY2hlLmNvdW50ID0gQm94MkQucGFyc2VVSW50KHRoaXMubV9jb3VudCk7XHJcbiAgICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMubV92ZXJ0aWNlcztcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY291bnQ7IGkrKykge1xyXG4gICAgICAgICBjYWNoZS5pbmRleEFbaV0gPSBCb3gyRC5wYXJzZVVJbnQodmVydGljZXNbaV0uaW5kZXhBKTtcclxuICAgICAgICAgY2FjaGUuaW5kZXhCW2ldID0gQm94MkQucGFyc2VVSW50KHZlcnRpY2VzW2ldLmluZGV4Qik7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlNpbXBsZXgucHJvdG90eXBlLkdldFNlYXJjaERpcmVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcclxuICAgICAgY2FzZSAxOlxyXG4gICAgICAgICByZXR1cm4gdGhpcy5tX3YxLncuR2V0TmVnYXRpdmUoKTtcclxuICAgICAgY2FzZSAyOlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBlMTIgPSBiMk1hdGguU3VidHJhY3RWVih0aGlzLm1fdjIudywgdGhpcy5tX3YxLncpO1xyXG4gICAgICAgICAgICB2YXIgc2duID0gYjJNYXRoLkNyb3NzVlYoZTEyLCB0aGlzLm1fdjEudy5HZXROZWdhdGl2ZSgpKTtcclxuICAgICAgICAgICAgaWYgKHNnbiA+IDAuMCkge1xyXG4gICAgICAgICAgICAgICByZXR1cm4gYjJNYXRoLkNyb3NzRlYoMS4wLCBlMTIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICByZXR1cm4gYjJNYXRoLkNyb3NzVkYoZTEyLCAxLjApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XHJcbiAgICAgICAgIHJldHVybiBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlNpbXBsZXgucHJvdG90eXBlLkdldENsb3Nlc3RQb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcclxuICAgICAgY2FzZSAwOlxyXG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoKTtcclxuICAgICAgY2FzZSAxOlxyXG4gICAgICAgICByZXR1cm4gdGhpcy5tX3YxLnc7XHJcbiAgICAgIGNhc2UgMjpcclxuICAgICAgICAgcmV0dXJuIG5ldyBiMlZlYzIodGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEudy54ICsgdGhpcy5tX3YyLmEgKiB0aGlzLm1fdjIudy54LCB0aGlzLm1fdjEuYSAqIHRoaXMubV92MS53LnkgKyB0aGlzLm1fdjIuYSAqIHRoaXMubV92Mi53LnkpO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyU2ltcGxleC5wcm90b3R5cGUuR2V0V2l0bmVzc1BvaW50cyA9IGZ1bmN0aW9uIChwQSwgcEIpIHtcclxuICAgICAgc3dpdGNoICh0aGlzLm1fY291bnQpIHtcclxuICAgICAgY2FzZSAwOlxyXG4gICAgICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgMTpcclxuICAgICAgICAgcEEuU2V0Vih0aGlzLm1fdjEud0EpO1xyXG4gICAgICAgICBwQi5TZXRWKHRoaXMubV92MS53Qik7XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIDI6XHJcbiAgICAgICAgIHBBLnggPSB0aGlzLm1fdjEuYSAqIHRoaXMubV92MS53QS54ICsgdGhpcy5tX3YyLmEgKiB0aGlzLm1fdjIud0EueDtcclxuICAgICAgICAgcEEueSA9IHRoaXMubV92MS5hICogdGhpcy5tX3YxLndBLnkgKyB0aGlzLm1fdjIuYSAqIHRoaXMubV92Mi53QS55O1xyXG4gICAgICAgICBwQi54ID0gdGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEud0IueCArIHRoaXMubV92Mi5hICogdGhpcy5tX3YyLndCLng7XHJcbiAgICAgICAgIHBCLnkgPSB0aGlzLm1fdjEuYSAqIHRoaXMubV92MS53Qi55ICsgdGhpcy5tX3YyLmEgKiB0aGlzLm1fdjIud0IueTtcclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgMzpcclxuICAgICAgICAgcEIueCA9IHBBLnggPSB0aGlzLm1fdjEuYSAqIHRoaXMubV92MS53QS54ICsgdGhpcy5tX3YyLmEgKiB0aGlzLm1fdjIud0EueCArIHRoaXMubV92My5hICogdGhpcy5tX3YzLndBLng7XHJcbiAgICAgICAgIHBCLnkgPSBwQS55ID0gdGhpcy5tX3YxLmEgKiB0aGlzLm1fdjEud0EueSArIHRoaXMubV92Mi5hICogdGhpcy5tX3YyLndBLnkgKyB0aGlzLm1fdjMuYSAqIHRoaXMubV92My53QS55O1xyXG4gICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5HZXRNZXRyaWMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHN3aXRjaCAodGhpcy5tX2NvdW50KSB7XHJcbiAgICAgIGNhc2UgMDpcclxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmYWxzZSk7XHJcbiAgICAgICAgIHJldHVybiAwLjA7XHJcbiAgICAgIGNhc2UgMTpcclxuICAgICAgICAgcmV0dXJuIDAuMDtcclxuICAgICAgY2FzZSAyOlxyXG4gICAgICAgICByZXR1cm4gYjJNYXRoLlN1YnRyYWN0VlYodGhpcy5tX3YxLncsIHRoaXMubV92Mi53KS5MZW5ndGgoKTtcclxuICAgICAgY2FzZSAzOlxyXG4gICAgICAgICByZXR1cm4gYjJNYXRoLkNyb3NzVlYoYjJNYXRoLlN1YnRyYWN0VlYodGhpcy5tX3YyLncsIHRoaXMubV92MS53KSwgYjJNYXRoLlN1YnRyYWN0VlYodGhpcy5tX3YzLncsIHRoaXMubV92MS53KSk7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZmFsc2UpO1xyXG4gICAgICAgICByZXR1cm4gMC4wO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5Tb2x2ZTIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciB3MSA9IHRoaXMubV92MS53O1xyXG4gICAgICB2YXIgdzIgPSB0aGlzLm1fdjIudztcclxuICAgICAgdmFyIGUxMiA9IGIyTWF0aC5TdWJ0cmFjdFZWKHcyLCB3MSk7XHJcbiAgICAgIHZhciBkMTJfMiA9ICgtKHcxLnggKiBlMTIueCArIHcxLnkgKiBlMTIueSkpO1xyXG4gICAgICBpZiAoZDEyXzIgPD0gMC4wKSB7XHJcbiAgICAgICAgIHRoaXMubV92MS5hID0gMS4wO1xyXG4gICAgICAgICB0aGlzLm1fY291bnQgPSAxO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGQxMl8xID0gKHcyLnggKiBlMTIueCArIHcyLnkgKiBlMTIueSk7XHJcbiAgICAgIGlmIChkMTJfMSA8PSAwLjApIHtcclxuICAgICAgICAgdGhpcy5tX3YyLmEgPSAxLjA7XHJcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XHJcbiAgICAgICAgIHRoaXMubV92MS5TZXQodGhpcy5tX3YyKTtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBpbnZfZDEyID0gMS4wIC8gKGQxMl8xICsgZDEyXzIpO1xyXG4gICAgICB0aGlzLm1fdjEuYSA9IGQxMl8xICogaW52X2QxMjtcclxuICAgICAgdGhpcy5tX3YyLmEgPSBkMTJfMiAqIGludl9kMTI7XHJcbiAgICAgIHRoaXMubV9jb3VudCA9IDI7XHJcbiAgIH1cclxuICAgYjJTaW1wbGV4LnByb3RvdHlwZS5Tb2x2ZTMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciB3MSA9IHRoaXMubV92MS53O1xyXG4gICAgICB2YXIgdzIgPSB0aGlzLm1fdjIudztcclxuICAgICAgdmFyIHczID0gdGhpcy5tX3YzLnc7XHJcbiAgICAgIHZhciBlMTIgPSBiMk1hdGguU3VidHJhY3RWVih3MiwgdzEpO1xyXG4gICAgICB2YXIgdzFlMTIgPSBiMk1hdGguRG90KHcxLCBlMTIpO1xyXG4gICAgICB2YXIgdzJlMTIgPSBiMk1hdGguRG90KHcyLCBlMTIpO1xyXG4gICAgICB2YXIgZDEyXzEgPSB3MmUxMjtcclxuICAgICAgdmFyIGQxMl8yID0gKC13MWUxMik7XHJcbiAgICAgIHZhciBlMTMgPSBiMk1hdGguU3VidHJhY3RWVih3MywgdzEpO1xyXG4gICAgICB2YXIgdzFlMTMgPSBiMk1hdGguRG90KHcxLCBlMTMpO1xyXG4gICAgICB2YXIgdzNlMTMgPSBiMk1hdGguRG90KHczLCBlMTMpO1xyXG4gICAgICB2YXIgZDEzXzEgPSB3M2UxMztcclxuICAgICAgdmFyIGQxM18yID0gKC13MWUxMyk7XHJcbiAgICAgIHZhciBlMjMgPSBiMk1hdGguU3VidHJhY3RWVih3MywgdzIpO1xyXG4gICAgICB2YXIgdzJlMjMgPSBiMk1hdGguRG90KHcyLCBlMjMpO1xyXG4gICAgICB2YXIgdzNlMjMgPSBiMk1hdGguRG90KHczLCBlMjMpO1xyXG4gICAgICB2YXIgZDIzXzEgPSB3M2UyMztcclxuICAgICAgdmFyIGQyM18yID0gKC13MmUyMyk7XHJcbiAgICAgIHZhciBuMTIzID0gYjJNYXRoLkNyb3NzVlYoZTEyLCBlMTMpO1xyXG4gICAgICB2YXIgZDEyM18xID0gbjEyMyAqIGIyTWF0aC5Dcm9zc1ZWKHcyLCB3Myk7XHJcbiAgICAgIHZhciBkMTIzXzIgPSBuMTIzICogYjJNYXRoLkNyb3NzVlYodzMsIHcxKTtcclxuICAgICAgdmFyIGQxMjNfMyA9IG4xMjMgKiBiMk1hdGguQ3Jvc3NWVih3MSwgdzIpO1xyXG4gICAgICBpZiAoZDEyXzIgPD0gMC4wICYmIGQxM18yIDw9IDAuMCkge1xyXG4gICAgICAgICB0aGlzLm1fdjEuYSA9IDEuMDtcclxuICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkMTJfMSA+IDAuMCAmJiBkMTJfMiA+IDAuMCAmJiBkMTIzXzMgPD0gMC4wKSB7XHJcbiAgICAgICAgIHZhciBpbnZfZDEyID0gMS4wIC8gKGQxMl8xICsgZDEyXzIpO1xyXG4gICAgICAgICB0aGlzLm1fdjEuYSA9IGQxMl8xICogaW52X2QxMjtcclxuICAgICAgICAgdGhpcy5tX3YyLmEgPSBkMTJfMiAqIGludl9kMTI7XHJcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDI7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZDEzXzEgPiAwLjAgJiYgZDEzXzIgPiAwLjAgJiYgZDEyM18yIDw9IDAuMCkge1xyXG4gICAgICAgICB2YXIgaW52X2QxMyA9IDEuMCAvIChkMTNfMSArIGQxM18yKTtcclxuICAgICAgICAgdGhpcy5tX3YxLmEgPSBkMTNfMSAqIGludl9kMTM7XHJcbiAgICAgICAgIHRoaXMubV92My5hID0gZDEzXzIgKiBpbnZfZDEzO1xyXG4gICAgICAgICB0aGlzLm1fY291bnQgPSAyO1xyXG4gICAgICAgICB0aGlzLm1fdjIuU2V0KHRoaXMubV92Myk7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZDEyXzEgPD0gMC4wICYmIGQyM18yIDw9IDAuMCkge1xyXG4gICAgICAgICB0aGlzLm1fdjIuYSA9IDEuMDtcclxuICAgICAgICAgdGhpcy5tX2NvdW50ID0gMTtcclxuICAgICAgICAgdGhpcy5tX3YxLlNldCh0aGlzLm1fdjIpO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGQxM18xIDw9IDAuMCAmJiBkMjNfMSA8PSAwLjApIHtcclxuICAgICAgICAgdGhpcy5tX3YzLmEgPSAxLjA7XHJcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDE7XHJcbiAgICAgICAgIHRoaXMubV92MS5TZXQodGhpcy5tX3YzKTtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkMjNfMSA+IDAuMCAmJiBkMjNfMiA+IDAuMCAmJiBkMTIzXzEgPD0gMC4wKSB7XHJcbiAgICAgICAgIHZhciBpbnZfZDIzID0gMS4wIC8gKGQyM18xICsgZDIzXzIpO1xyXG4gICAgICAgICB0aGlzLm1fdjIuYSA9IGQyM18xICogaW52X2QyMztcclxuICAgICAgICAgdGhpcy5tX3YzLmEgPSBkMjNfMiAqIGludl9kMjM7XHJcbiAgICAgICAgIHRoaXMubV9jb3VudCA9IDI7XHJcbiAgICAgICAgIHRoaXMubV92MS5TZXQodGhpcy5tX3YzKTtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBpbnZfZDEyMyA9IDEuMCAvIChkMTIzXzEgKyBkMTIzXzIgKyBkMTIzXzMpO1xyXG4gICAgICB0aGlzLm1fdjEuYSA9IGQxMjNfMSAqIGludl9kMTIzO1xyXG4gICAgICB0aGlzLm1fdjIuYSA9IGQxMjNfMiAqIGludl9kMTIzO1xyXG4gICAgICB0aGlzLm1fdjMuYSA9IGQxMjNfMyAqIGludl9kMTIzO1xyXG4gICAgICB0aGlzLm1fY291bnQgPSAzO1xyXG4gICB9XHJcbiAgIGIyU2ltcGxleENhY2hlLmIyU2ltcGxleENhY2hlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmluZGV4QSA9IG5ldyBWZWN0b3JfYTJqX051bWJlcigzKTtcclxuICAgICAgdGhpcy5pbmRleEIgPSBuZXcgVmVjdG9yX2Eyal9OdW1iZXIoMyk7XHJcbiAgIH07XHJcbiAgIGIyU2ltcGxleFZlcnRleC5iMlNpbXBsZXhWZXJ0ZXggPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJTaW1wbGV4VmVydGV4LnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgdGhpcy53QS5TZXRWKG90aGVyLndBKTtcclxuICAgICAgdGhpcy53Qi5TZXRWKG90aGVyLndCKTtcclxuICAgICAgdGhpcy53LlNldFYob3RoZXIudyk7XHJcbiAgICAgIHRoaXMuYSA9IG90aGVyLmE7XHJcbiAgICAgIHRoaXMuaW5kZXhBID0gb3RoZXIuaW5kZXhBO1xyXG4gICAgICB0aGlzLmluZGV4QiA9IG90aGVyLmluZGV4QjtcclxuICAgfVxyXG4gICBiMlRpbWVPZkltcGFjdC5iMlRpbWVPZkltcGFjdCA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMlRpbWVPZkltcGFjdC5UaW1lT2ZJbXBhY3QgPSBmdW5jdGlvbiAoaW5wdXQpIHtcclxuICAgICAgKytiMlRpbWVPZkltcGFjdC5iMl90b2lDYWxscztcclxuICAgICAgdmFyIHByb3h5QSA9IGlucHV0LnByb3h5QTtcclxuICAgICAgdmFyIHByb3h5QiA9IGlucHV0LnByb3h5QjtcclxuICAgICAgdmFyIHN3ZWVwQSA9IGlucHV0LnN3ZWVwQTtcclxuICAgICAgdmFyIHN3ZWVwQiA9IGlucHV0LnN3ZWVwQjtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChzd2VlcEEudDAgPT0gc3dlZXBCLnQwKTtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCgxLjAgLSBzd2VlcEEudDAgPiBOdW1iZXIuTUlOX1ZBTFVFKTtcclxuICAgICAgdmFyIHJhZGl1cyA9IHByb3h5QS5tX3JhZGl1cyArIHByb3h5Qi5tX3JhZGl1cztcclxuICAgICAgdmFyIHRvbGVyYW5jZSA9IGlucHV0LnRvbGVyYW5jZTtcclxuICAgICAgdmFyIGFscGhhID0gMC4wO1xyXG4gICAgICB2YXIga19tYXhJdGVyYXRpb25zID0gMTAwMDtcclxuICAgICAgdmFyIGl0ZXIgPSAwO1xyXG4gICAgICB2YXIgdGFyZ2V0ID0gMC4wO1xyXG4gICAgICBiMlRpbWVPZkltcGFjdC5zX2NhY2hlLmNvdW50ID0gMDtcclxuICAgICAgYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0LnVzZVJhZGlpID0gZmFsc2U7XHJcbiAgICAgIGZvciAoOzspIHtcclxuICAgICAgICAgc3dlZXBBLkdldFRyYW5zZm9ybShiMlRpbWVPZkltcGFjdC5zX3hmQSwgYWxwaGEpO1xyXG4gICAgICAgICBzd2VlcEIuR2V0VHJhbnNmb3JtKGIyVGltZU9mSW1wYWN0LnNfeGZCLCBhbHBoYSk7XHJcbiAgICAgICAgIGIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VJbnB1dC5wcm94eUEgPSBwcm94eUE7XHJcbiAgICAgICAgIGIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VJbnB1dC5wcm94eUIgPSBwcm94eUI7XHJcbiAgICAgICAgIGIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VJbnB1dC50cmFuc2Zvcm1BID0gYjJUaW1lT2ZJbXBhY3Quc194ZkE7XHJcbiAgICAgICAgIGIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VJbnB1dC50cmFuc2Zvcm1CID0gYjJUaW1lT2ZJbXBhY3Quc194ZkI7XHJcbiAgICAgICAgIGIyRGlzdGFuY2UuRGlzdGFuY2UoYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZU91dHB1dCwgYjJUaW1lT2ZJbXBhY3Quc19jYWNoZSwgYjJUaW1lT2ZJbXBhY3Quc19kaXN0YW5jZUlucHV0KTtcclxuICAgICAgICAgaWYgKGIyVGltZU9mSW1wYWN0LnNfZGlzdGFuY2VPdXRwdXQuZGlzdGFuY2UgPD0gMC4wKSB7XHJcbiAgICAgICAgICAgIGFscGhhID0gMS4wO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBiMlRpbWVPZkltcGFjdC5zX2Zjbi5Jbml0aWFsaXplKGIyVGltZU9mSW1wYWN0LnNfY2FjaGUsIHByb3h5QSwgYjJUaW1lT2ZJbXBhY3Quc194ZkEsIHByb3h5QiwgYjJUaW1lT2ZJbXBhY3Quc194ZkIpO1xyXG4gICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IGIyVGltZU9mSW1wYWN0LnNfZmNuLkV2YWx1YXRlKGIyVGltZU9mSW1wYWN0LnNfeGZBLCBiMlRpbWVPZkltcGFjdC5zX3hmQik7XHJcbiAgICAgICAgIGlmIChzZXBhcmF0aW9uIDw9IDAuMCkge1xyXG4gICAgICAgICAgICBhbHBoYSA9IDEuMDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKGl0ZXIgPT0gMCkge1xyXG4gICAgICAgICAgICBpZiAoc2VwYXJhdGlvbiA+IHJhZGl1cykge1xyXG4gICAgICAgICAgICAgICB0YXJnZXQgPSBiMk1hdGguTWF4KHJhZGl1cyAtIHRvbGVyYW5jZSwgMC43NSAqIHJhZGl1cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIHRhcmdldCA9IGIyTWF0aC5NYXgoc2VwYXJhdGlvbiAtIHRvbGVyYW5jZSwgMC4wMiAqIHJhZGl1cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAoc2VwYXJhdGlvbiAtIHRhcmdldCA8IDAuNSAqIHRvbGVyYW5jZSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlciA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgIGFscGhhID0gMS4wO1xyXG4gICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgbmV3QWxwaGEgPSBhbHBoYTsge1xyXG4gICAgICAgICAgICB2YXIgeDEgPSBhbHBoYTtcclxuICAgICAgICAgICAgdmFyIHgyID0gMS4wO1xyXG4gICAgICAgICAgICB2YXIgZjEgPSBzZXBhcmF0aW9uO1xyXG4gICAgICAgICAgICBzd2VlcEEuR2V0VHJhbnNmb3JtKGIyVGltZU9mSW1wYWN0LnNfeGZBLCB4Mik7XHJcbiAgICAgICAgICAgIHN3ZWVwQi5HZXRUcmFuc2Zvcm0oYjJUaW1lT2ZJbXBhY3Quc194ZkIsIHgyKTtcclxuICAgICAgICAgICAgdmFyIGYyID0gYjJUaW1lT2ZJbXBhY3Quc19mY24uRXZhbHVhdGUoYjJUaW1lT2ZJbXBhY3Quc194ZkEsIGIyVGltZU9mSW1wYWN0LnNfeGZCKTtcclxuICAgICAgICAgICAgaWYgKGYyID49IHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICBhbHBoYSA9IDEuMDtcclxuICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHJvb3RJdGVyQ291bnQgPSAwO1xyXG4gICAgICAgICAgICBmb3IgKDs7KSB7XHJcbiAgICAgICAgICAgICAgIHZhciB4ID0gMDtcclxuICAgICAgICAgICAgICAgaWYgKHJvb3RJdGVyQ291bnQgJiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgIHggPSB4MSArICh0YXJnZXQgLSBmMSkgKiAoeDIgLSB4MSkgLyAoZjIgLSBmMSk7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIHggPSAwLjUgKiAoeDEgKyB4Mik7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgc3dlZXBBLkdldFRyYW5zZm9ybShiMlRpbWVPZkltcGFjdC5zX3hmQSwgeCk7XHJcbiAgICAgICAgICAgICAgIHN3ZWVwQi5HZXRUcmFuc2Zvcm0oYjJUaW1lT2ZJbXBhY3Quc194ZkIsIHgpO1xyXG4gICAgICAgICAgICAgICB2YXIgZiA9IGIyVGltZU9mSW1wYWN0LnNfZmNuLkV2YWx1YXRlKGIyVGltZU9mSW1wYWN0LnNfeGZBLCBiMlRpbWVPZkltcGFjdC5zX3hmQik7XHJcbiAgICAgICAgICAgICAgIGlmIChiMk1hdGguQWJzKGYgLSB0YXJnZXQpIDwgMC4wMjUgKiB0b2xlcmFuY2UpIHtcclxuICAgICAgICAgICAgICAgICAgbmV3QWxwaGEgPSB4O1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBpZiAoZiA+IHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgICB4MSA9IHg7XHJcbiAgICAgICAgICAgICAgICAgIGYxID0gZjtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgeDIgPSB4O1xyXG4gICAgICAgICAgICAgICAgICBmMiA9IGY7XHJcbiAgICAgICAgICAgICAgIH0rK3Jvb3RJdGVyQ291bnQ7XHJcbiAgICAgICAgICAgICAgICsrYjJUaW1lT2ZJbXBhY3QuYjJfdG9pUm9vdEl0ZXJzO1xyXG4gICAgICAgICAgICAgICBpZiAocm9vdEl0ZXJDb3VudCA9PSA1MCkge1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGIyVGltZU9mSW1wYWN0LmIyX3RvaU1heFJvb3RJdGVycyA9IGIyTWF0aC5NYXgoYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4Um9vdEl0ZXJzLCByb290SXRlckNvdW50KTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAobmV3QWxwaGEgPCAoMS4wICsgMTAwLjAgKiBOdW1iZXIuTUlOX1ZBTFVFKSAqIGFscGhhKSB7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGFscGhhID0gbmV3QWxwaGE7XHJcbiAgICAgICAgIGl0ZXIrKztcclxuICAgICAgICAgKytiMlRpbWVPZkltcGFjdC5iMl90b2lJdGVycztcclxuICAgICAgICAgaWYgKGl0ZXIgPT0ga19tYXhJdGVyYXRpb25zKSB7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4SXRlcnMgPSBiMk1hdGguTWF4KGIyVGltZU9mSW1wYWN0LmIyX3RvaU1heEl0ZXJzLCBpdGVyKTtcclxuICAgICAgcmV0dXJuIGFscGhhO1xyXG4gICB9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QuYjJfdG9pQ2FsbHMgPSAwO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QuYjJfdG9pSXRlcnMgPSAwO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QuYjJfdG9pTWF4SXRlcnMgPSAwO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QuYjJfdG9pUm9vdEl0ZXJzID0gMDtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LmIyX3RvaU1heFJvb3RJdGVycyA9IDA7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5zX2NhY2hlID0gbmV3IGIyU2ltcGxleENhY2hlKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5zX2Rpc3RhbmNlSW5wdXQgPSBuZXcgYjJEaXN0YW5jZUlucHV0KCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5zX3hmQSA9IG5ldyBiMlRyYW5zZm9ybSgpO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3Quc194ZkIgPSBuZXcgYjJUcmFuc2Zvcm0oKTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLmIyVGltZU9mSW1wYWN0LnNfZmNuID0gbmV3IGIyU2VwYXJhdGlvbkZ1bmN0aW9uKCk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdC5zX2Rpc3RhbmNlT3V0cHV0ID0gbmV3IGIyRGlzdGFuY2VPdXRwdXQoKTtcclxuICAgfSk7XHJcbiAgIGIyVE9JSW5wdXQuYjJUT0lJbnB1dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5wcm94eUEgPSBuZXcgYjJEaXN0YW5jZVByb3h5KCk7XHJcbiAgICAgIHRoaXMucHJveHlCID0gbmV3IGIyRGlzdGFuY2VQcm94eSgpO1xyXG4gICAgICB0aGlzLnN3ZWVwQSA9IG5ldyBiMlN3ZWVwKCk7XHJcbiAgICAgIHRoaXMuc3dlZXBCID0gbmV3IGIyU3dlZXAoKTtcclxuICAgfTtcclxuICAgYjJXb3JsZE1hbmlmb2xkLmIyV29ybGRNYW5pZm9sZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX25vcm1hbCA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJXb3JsZE1hbmlmb2xkLnByb3RvdHlwZS5iMldvcmxkTWFuaWZvbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9wb2ludHMgPSBuZXcgVmVjdG9yKGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHMpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHM7IGkrKykge1xyXG4gICAgICAgICB0aGlzLm1fcG9pbnRzW2ldID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJXb3JsZE1hbmlmb2xkLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKG1hbmlmb2xkLCB4ZkEsIHJhZGl1c0EsIHhmQiwgcmFkaXVzQikge1xyXG4gICAgICBpZiAocmFkaXVzQSA9PT0gdW5kZWZpbmVkKSByYWRpdXNBID0gMDtcclxuICAgICAgaWYgKHJhZGl1c0IgPT09IHVuZGVmaW5lZCkgcmFkaXVzQiA9IDA7XHJcbiAgICAgIGlmIChtYW5pZm9sZC5tX3BvaW50Q291bnQgPT0gMCkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciBub3JtYWxYID0gMDtcclxuICAgICAgdmFyIG5vcm1hbFkgPSAwO1xyXG4gICAgICB2YXIgcGxhbmVQb2ludFggPSAwO1xyXG4gICAgICB2YXIgcGxhbmVQb2ludFkgPSAwO1xyXG4gICAgICB2YXIgY2xpcFBvaW50WCA9IDA7XHJcbiAgICAgIHZhciBjbGlwUG9pbnRZID0gMDtcclxuICAgICAgc3dpdGNoIChtYW5pZm9sZC5tX3R5cGUpIHtcclxuICAgICAgY2FzZSBiMk1hbmlmb2xkLmVfY2lyY2xlczpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICB0TWF0ID0geGZBLlI7XHJcbiAgICAgICAgICAgIHRWZWMgPSBtYW5pZm9sZC5tX2xvY2FsUG9pbnQ7XHJcbiAgICAgICAgICAgIHZhciBwb2ludEFYID0geGZBLnBvc2l0aW9uLnggKyB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRBWSA9IHhmQS5wb3NpdGlvbi55ICsgdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgICAgdE1hdCA9IHhmQi5SO1xyXG4gICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9wb2ludHNbMF0ubV9sb2NhbFBvaW50O1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRCWCA9IHhmQi5wb3NpdGlvbi54ICsgdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgICAgdmFyIHBvaW50QlkgPSB4ZkIucG9zaXRpb24ueSArIHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHZhciBkWCA9IHBvaW50QlggLSBwb2ludEFYO1xyXG4gICAgICAgICAgICB2YXIgZFkgPSBwb2ludEJZIC0gcG9pbnRBWTtcclxuICAgICAgICAgICAgdmFyIGQyID0gZFggKiBkWCArIGRZICogZFk7XHJcbiAgICAgICAgICAgIGlmIChkMiA+IE51bWJlci5NSU5fVkFMVUUgKiBOdW1iZXIuTUlOX1ZBTFVFKSB7XHJcbiAgICAgICAgICAgICAgIHZhciBkID0gTWF0aC5zcXJ0KGQyKTtcclxuICAgICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ID0gZFggLyBkO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSBkWSAvIGQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueCA9IDE7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGNBWCA9IHBvaW50QVggKyByYWRpdXNBICogdGhpcy5tX25vcm1hbC54O1xyXG4gICAgICAgICAgICB2YXIgY0FZID0gcG9pbnRBWSArIHJhZGl1c0EgKiB0aGlzLm1fbm9ybWFsLnk7XHJcbiAgICAgICAgICAgIHZhciBjQlggPSBwb2ludEJYIC0gcmFkaXVzQiAqIHRoaXMubV9ub3JtYWwueDtcclxuICAgICAgICAgICAgdmFyIGNCWSA9IHBvaW50QlkgLSByYWRpdXNCICogdGhpcy5tX25vcm1hbC55O1xyXG4gICAgICAgICAgICB0aGlzLm1fcG9pbnRzWzBdLnggPSAwLjUgKiAoY0FYICsgY0JYKTtcclxuICAgICAgICAgICAgdGhpcy5tX3BvaW50c1swXS55ID0gMC41ICogKGNBWSArIGNCWSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJNYW5pZm9sZC5lX2ZhY2VBOlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIHRNYXQgPSB4ZkEuUjtcclxuICAgICAgICAgICAgdFZlYyA9IG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbDtcclxuICAgICAgICAgICAgbm9ybWFsWCA9IHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIG5vcm1hbFkgPSB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICAgICB0TWF0ID0geGZBLlI7XHJcbiAgICAgICAgICAgIHRWZWMgPSBtYW5pZm9sZC5tX2xvY2FsUG9pbnQ7XHJcbiAgICAgICAgICAgIHBsYW5lUG9pbnRYID0geGZBLnBvc2l0aW9uLnggKyB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICBwbGFuZVBvaW50WSA9IHhmQS5wb3NpdGlvbi55ICsgdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ID0gbm9ybWFsWDtcclxuICAgICAgICAgICAgdGhpcy5tX25vcm1hbC55ID0gbm9ybWFsWTtcclxuICAgICAgICAgICAgZm9yIChpID0gMDtcclxuICAgICAgICAgICAgaSA8IG1hbmlmb2xkLm1fcG9pbnRDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgIHRNYXQgPSB4ZkIuUjtcclxuICAgICAgICAgICAgICAgdFZlYyA9IG1hbmlmb2xkLm1fcG9pbnRzW2ldLm1fbG9jYWxQb2ludDtcclxuICAgICAgICAgICAgICAgY2xpcFBvaW50WCA9IHhmQi5wb3NpdGlvbi54ICsgdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgICAgICAgY2xpcFBvaW50WSA9IHhmQi5wb3NpdGlvbi55ICsgdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgICAgICAgdGhpcy5tX3BvaW50c1tpXS54ID0gY2xpcFBvaW50WCArIDAuNSAqIChyYWRpdXNBIC0gKGNsaXBQb2ludFggLSBwbGFuZVBvaW50WCkgKiBub3JtYWxYIC0gKGNsaXBQb2ludFkgLSBwbGFuZVBvaW50WSkgKiBub3JtYWxZIC0gcmFkaXVzQikgKiBub3JtYWxYO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fcG9pbnRzW2ldLnkgPSBjbGlwUG9pbnRZICsgMC41ICogKHJhZGl1c0EgLSAoY2xpcFBvaW50WCAtIHBsYW5lUG9pbnRYKSAqIG5vcm1hbFggLSAoY2xpcFBvaW50WSAtIHBsYW5lUG9pbnRZKSAqIG5vcm1hbFkgLSByYWRpdXNCKSAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBiMk1hbmlmb2xkLmVfZmFjZUI6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgdE1hdCA9IHhmQi5SO1xyXG4gICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsO1xyXG4gICAgICAgICAgICBub3JtYWxYID0gdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgICAgbm9ybWFsWSA9IHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHRNYXQgPSB4ZkIuUjtcclxuICAgICAgICAgICAgdFZlYyA9IG1hbmlmb2xkLm1fbG9jYWxQb2ludDtcclxuICAgICAgICAgICAgcGxhbmVQb2ludFggPSB4ZkIucG9zaXRpb24ueCArIHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnk7XHJcbiAgICAgICAgICAgIHBsYW5lUG9pbnRZID0geGZCLnBvc2l0aW9uLnkgKyB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnggPSAoLW5vcm1hbFgpO1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSAoLW5vcm1hbFkpO1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICAgICBpIDwgbWFuaWZvbGQubV9wb2ludENvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgdE1hdCA9IHhmQS5SO1xyXG4gICAgICAgICAgICAgICB0VmVjID0gbWFuaWZvbGQubV9wb2ludHNbaV0ubV9sb2NhbFBvaW50O1xyXG4gICAgICAgICAgICAgICBjbGlwUG9pbnRYID0geGZBLnBvc2l0aW9uLnggKyB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICAgICBjbGlwUG9pbnRZID0geGZBLnBvc2l0aW9uLnkgKyB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fcG9pbnRzW2ldLnggPSBjbGlwUG9pbnRYICsgMC41ICogKHJhZGl1c0IgLSAoY2xpcFBvaW50WCAtIHBsYW5lUG9pbnRYKSAqIG5vcm1hbFggLSAoY2xpcFBvaW50WSAtIHBsYW5lUG9pbnRZKSAqIG5vcm1hbFkgLSByYWRpdXNBKSAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9wb2ludHNbaV0ueSA9IGNsaXBQb2ludFkgKyAwLjUgKiAocmFkaXVzQiAtIChjbGlwUG9pbnRYIC0gcGxhbmVQb2ludFgpICogbm9ybWFsWCAtIChjbGlwUG9pbnRZIC0gcGxhbmVQb2ludFkpICogbm9ybWFsWSAtIHJhZGl1c0EpICogbm9ybWFsWTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQ2xpcFZlcnRleC5DbGlwVmVydGV4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnYgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMuaWQgPSBuZXcgYjJDb250YWN0SUQoKTtcclxuICAgfTtcclxuICAgQ2xpcFZlcnRleC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgIHRoaXMudi5TZXRWKG90aGVyLnYpO1xyXG4gICAgICB0aGlzLmlkLlNldChvdGhlci5pZCk7XHJcbiAgIH1cclxuICAgRmVhdHVyZXMuRmVhdHVyZXMgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ3JlZmVyZW5jZUVkZ2UnLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICByZXR1cm4gdGhpcy5fcmVmZXJlbmNlRWRnZTtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ3JlZmVyZW5jZUVkZ2UnLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB2YWx1ZSA9IDA7XHJcbiAgICAgICAgIHRoaXMuX3JlZmVyZW5jZUVkZ2UgPSB2YWx1ZTtcclxuICAgICAgICAgdGhpcy5fbV9pZC5fa2V5ID0gKHRoaXMuX21faWQuX2tleSAmIDB4ZmZmZmZmMDApIHwgKHRoaXMuX3JlZmVyZW5jZUVkZ2UgJiAweDAwMDAwMGZmKTtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ2luY2lkZW50RWRnZScsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgIHJldHVybiB0aGlzLl9pbmNpZGVudEVkZ2U7XHJcbiAgICAgIH1cclxuICAgfSk7XHJcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGZWF0dXJlcy5wcm90b3R5cGUsICdpbmNpZGVudEVkZ2UnLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB2YWx1ZSA9IDA7XHJcbiAgICAgICAgIHRoaXMuX2luY2lkZW50RWRnZSA9IHZhbHVlO1xyXG4gICAgICAgICB0aGlzLl9tX2lkLl9rZXkgPSAodGhpcy5fbV9pZC5fa2V5ICYgMHhmZmZmMDBmZikgfCAoKHRoaXMuX2luY2lkZW50RWRnZSA8PCA4KSAmIDB4MDAwMGZmMDApO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmVhdHVyZXMucHJvdG90eXBlLCAnaW5jaWRlbnRWZXJ0ZXgnLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICByZXR1cm4gdGhpcy5faW5jaWRlbnRWZXJ0ZXg7XHJcbiAgICAgIH1cclxuICAgfSk7XHJcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGZWF0dXJlcy5wcm90b3R5cGUsICdpbmNpZGVudFZlcnRleCcsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0gMDtcclxuICAgICAgICAgdGhpcy5faW5jaWRlbnRWZXJ0ZXggPSB2YWx1ZTtcclxuICAgICAgICAgdGhpcy5fbV9pZC5fa2V5ID0gKHRoaXMuX21faWQuX2tleSAmIDB4ZmYwMGZmZmYpIHwgKCh0aGlzLl9pbmNpZGVudFZlcnRleCA8PCAxNikgJiAweDAwZmYwMDAwKTtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ2ZsaXAnLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICByZXR1cm4gdGhpcy5fZmxpcDtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZlYXR1cmVzLnByb3RvdHlwZSwgJ2ZsaXAnLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB2YWx1ZSA9IDA7XHJcbiAgICAgICAgIHRoaXMuX2ZsaXAgPSB2YWx1ZTtcclxuICAgICAgICAgdGhpcy5fbV9pZC5fa2V5ID0gKHRoaXMuX21faWQuX2tleSAmIDB4MDBmZmZmZmYpIHwgKCh0aGlzLl9mbGlwIDw8IDI0KSAmIDB4ZmYwMDAwMDApO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG59KSgpO1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxyXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXHJcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcclxuICAgICAgYjJDaXJjbGVTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZSxcclxuICAgICAgYjJFZGdlQ2hhaW5EZWYgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZUNoYWluRGVmLFxyXG4gICAgICBiMkVkZ2VTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlU2hhcGUsXHJcbiAgICAgIGIyTWFzc0RhdGEgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyTWFzc0RhdGEsXHJcbiAgICAgIGIyUG9seWdvblNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlBvbHlnb25TaGFwZSxcclxuICAgICAgYjJTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSxcclxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXHJcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxyXG4gICAgICBiMk1hdGggPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGgsXHJcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxyXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxyXG4gICAgICBiMlZlYzIgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIsXHJcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyxcclxuICAgICAgYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5LFxyXG4gICAgICBiMkJvZHlEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkJvZHlEZWYsXHJcbiAgICAgIGIyQ29udGFjdEZpbHRlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEZpbHRlcixcclxuICAgICAgYjJDb250YWN0SW1wdWxzZSA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEltcHVsc2UsXHJcbiAgICAgIGIyQ29udGFjdExpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0TGlzdGVuZXIsXHJcbiAgICAgIGIyQ29udGFjdE1hbmFnZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RNYW5hZ2VyLFxyXG4gICAgICBiMkRlYnVnRHJhdyA9IEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LFxyXG4gICAgICBiMkRlc3RydWN0aW9uTGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkRlc3RydWN0aW9uTGlzdGVuZXIsXHJcbiAgICAgIGIyRmlsdGVyRGF0YSA9IEJveDJELkR5bmFtaWNzLmIyRmlsdGVyRGF0YSxcclxuICAgICAgYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlLFxyXG4gICAgICBiMkZpeHR1cmVEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkZpeHR1cmVEZWYsXHJcbiAgICAgIGIySXNsYW5kID0gQm94MkQuRHluYW1pY3MuYjJJc2xhbmQsXHJcbiAgICAgIGIyVGltZVN0ZXAgPSBCb3gyRC5EeW5hbWljcy5iMlRpbWVTdGVwLFxyXG4gICAgICBiMldvcmxkID0gQm94MkQuRHluYW1pY3MuYjJXb3JsZCxcclxuICAgICAgYjJBQUJCID0gQm94MkQuQ29sbGlzaW9uLmIyQUFCQixcclxuICAgICAgYjJCb3VuZCA9IEJveDJELkNvbGxpc2lvbi5iMkJvdW5kLFxyXG4gICAgICBiMkJvdW5kVmFsdWVzID0gQm94MkQuQ29sbGlzaW9uLmIyQm91bmRWYWx1ZXMsXHJcbiAgICAgIGIyQ29sbGlzaW9uID0gQm94MkQuQ29sbGlzaW9uLmIyQ29sbGlzaW9uLFxyXG4gICAgICBiMkNvbnRhY3RJRCA9IEJveDJELkNvbGxpc2lvbi5iMkNvbnRhY3RJRCxcclxuICAgICAgYjJDb250YWN0UG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0UG9pbnQsXHJcbiAgICAgIGIyRGlzdGFuY2UgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZSxcclxuICAgICAgYjJEaXN0YW5jZUlucHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VJbnB1dCxcclxuICAgICAgYjJEaXN0YW5jZU91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlT3V0cHV0LFxyXG4gICAgICBiMkRpc3RhbmNlUHJveHkgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZVByb3h5LFxyXG4gICAgICBiMkR5bmFtaWNUcmVlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWUsXHJcbiAgICAgIGIyRHluYW1pY1RyZWVCcm9hZFBoYXNlID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVCcm9hZFBoYXNlLFxyXG4gICAgICBiMkR5bmFtaWNUcmVlTm9kZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlTm9kZSxcclxuICAgICAgYjJEeW5hbWljVHJlZVBhaXIgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZVBhaXIsXHJcbiAgICAgIGIyTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJNYW5pZm9sZCxcclxuICAgICAgYjJNYW5pZm9sZFBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGRQb2ludCxcclxuICAgICAgYjJQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMlBvaW50LFxyXG4gICAgICBiMlJheUNhc3RJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RJbnB1dCxcclxuICAgICAgYjJSYXlDYXN0T3V0cHV0ID0gQm94MkQuQ29sbGlzaW9uLmIyUmF5Q2FzdE91dHB1dCxcclxuICAgICAgYjJTZWdtZW50ID0gQm94MkQuQ29sbGlzaW9uLmIyU2VnbWVudCxcclxuICAgICAgYjJTZXBhcmF0aW9uRnVuY3Rpb24gPSBCb3gyRC5Db2xsaXNpb24uYjJTZXBhcmF0aW9uRnVuY3Rpb24sXHJcbiAgICAgIGIyU2ltcGxleCA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXgsXHJcbiAgICAgIGIyU2ltcGxleENhY2hlID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleENhY2hlLFxyXG4gICAgICBiMlNpbXBsZXhWZXJ0ZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4VmVydGV4LFxyXG4gICAgICBiMlRpbWVPZkltcGFjdCA9IEJveDJELkNvbGxpc2lvbi5iMlRpbWVPZkltcGFjdCxcclxuICAgICAgYjJUT0lJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlRPSUlucHV0LFxyXG4gICAgICBiMldvcmxkTWFuaWZvbGQgPSBCb3gyRC5Db2xsaXNpb24uYjJXb3JsZE1hbmlmb2xkLFxyXG4gICAgICBDbGlwVmVydGV4ID0gQm94MkQuQ29sbGlzaW9uLkNsaXBWZXJ0ZXgsXHJcbiAgICAgIEZlYXR1cmVzID0gQm94MkQuQ29sbGlzaW9uLkZlYXR1cmVzLFxyXG4gICAgICBJQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5JQnJvYWRQaGFzZTtcclxuXHJcbiAgIEJveDJELmluaGVyaXQoYjJDaXJjbGVTaGFwZSwgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlKTtcclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5wcm90b3R5cGU7XHJcbiAgIGIyQ2lyY2xlU2hhcGUuYjJDaXJjbGVTaGFwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmIyU2hhcGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5tX3AgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBzID0gbmV3IGIyQ2lyY2xlU2hhcGUoKTtcclxuICAgICAgcy5TZXQodGhpcyk7XHJcbiAgICAgIHJldHVybiBzO1xyXG4gICB9XHJcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuU2V0LmNhbGwodGhpcywgb3RoZXIpO1xyXG4gICAgICBpZiAoQm94MkQuaXMob3RoZXIsIGIyQ2lyY2xlU2hhcGUpKSB7XHJcbiAgICAgICAgIHZhciBvdGhlcjIgPSAob3RoZXIgaW5zdGFuY2VvZiBiMkNpcmNsZVNoYXBlID8gb3RoZXIgOiBudWxsKTtcclxuICAgICAgICAgdGhpcy5tX3AuU2V0VihvdGhlcjIubV9wKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLlRlc3RQb2ludCA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0sIHApIHtcclxuICAgICAgdmFyIHRNYXQgPSB0cmFuc2Zvcm0uUjtcclxuICAgICAgdmFyIGRYID0gdHJhbnNmb3JtLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fcC54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fcC55KTtcclxuICAgICAgdmFyIGRZID0gdHJhbnNmb3JtLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0aGlzLm1fcC54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fcC55KTtcclxuICAgICAgZFggPSBwLnggLSBkWDtcclxuICAgICAgZFkgPSBwLnkgLSBkWTtcclxuICAgICAgcmV0dXJuIChkWCAqIGRYICsgZFkgKiBkWSkgPD0gdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XHJcbiAgIH1cclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChvdXRwdXQsIGlucHV0LCB0cmFuc2Zvcm0pIHtcclxuICAgICAgdmFyIHRNYXQgPSB0cmFuc2Zvcm0uUjtcclxuICAgICAgdmFyIHBvc2l0aW9uWCA9IHRyYW5zZm9ybS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX3AueCArIHRNYXQuY29sMi54ICogdGhpcy5tX3AueSk7XHJcbiAgICAgIHZhciBwb3NpdGlvblkgPSB0cmFuc2Zvcm0ucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV9wLnggKyB0TWF0LmNvbDIueSAqIHRoaXMubV9wLnkpO1xyXG4gICAgICB2YXIgc1ggPSBpbnB1dC5wMS54IC0gcG9zaXRpb25YO1xyXG4gICAgICB2YXIgc1kgPSBpbnB1dC5wMS55IC0gcG9zaXRpb25ZO1xyXG4gICAgICB2YXIgYiA9IChzWCAqIHNYICsgc1kgKiBzWSkgLSB0aGlzLm1fcmFkaXVzICogdGhpcy5tX3JhZGl1cztcclxuICAgICAgdmFyIHJYID0gaW5wdXQucDIueCAtIGlucHV0LnAxLng7XHJcbiAgICAgIHZhciByWSA9IGlucHV0LnAyLnkgLSBpbnB1dC5wMS55O1xyXG4gICAgICB2YXIgYyA9IChzWCAqIHJYICsgc1kgKiByWSk7XHJcbiAgICAgIHZhciByciA9IChyWCAqIHJYICsgclkgKiByWSk7XHJcbiAgICAgIHZhciBzaWdtYSA9IGMgKiBjIC0gcnIgKiBiO1xyXG4gICAgICBpZiAoc2lnbWEgPCAwLjAgfHwgcnIgPCBOdW1iZXIuTUlOX1ZBTFVFKSB7XHJcbiAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgYSA9ICgtKGMgKyBNYXRoLnNxcnQoc2lnbWEpKSk7XHJcbiAgICAgIGlmICgwLjAgPD0gYSAmJiBhIDw9IGlucHV0Lm1heEZyYWN0aW9uICogcnIpIHtcclxuICAgICAgICAgYSAvPSBycjtcclxuICAgICAgICAgb3V0cHV0LmZyYWN0aW9uID0gYTtcclxuICAgICAgICAgb3V0cHV0Lm5vcm1hbC54ID0gc1ggKyBhICogclg7XHJcbiAgICAgICAgIG91dHB1dC5ub3JtYWwueSA9IHNZICsgYSAqIHJZO1xyXG4gICAgICAgICBvdXRwdXQubm9ybWFsLk5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgIH1cclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuQ29tcHV0ZUFBQkIgPSBmdW5jdGlvbiAoYWFiYiwgdHJhbnNmb3JtKSB7XHJcbiAgICAgIHZhciB0TWF0ID0gdHJhbnNmb3JtLlI7XHJcbiAgICAgIHZhciBwWCA9IHRyYW5zZm9ybS5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX3AueCArIHRNYXQuY29sMi54ICogdGhpcy5tX3AueSk7XHJcbiAgICAgIHZhciBwWSA9IHRyYW5zZm9ybS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX3AueCArIHRNYXQuY29sMi55ICogdGhpcy5tX3AueSk7XHJcbiAgICAgIGFhYmIubG93ZXJCb3VuZC5TZXQocFggLSB0aGlzLm1fcmFkaXVzLCBwWSAtIHRoaXMubV9yYWRpdXMpO1xyXG4gICAgICBhYWJiLnVwcGVyQm91bmQuU2V0KHBYICsgdGhpcy5tX3JhZGl1cywgcFkgKyB0aGlzLm1fcmFkaXVzKTtcclxuICAgfVxyXG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5Db21wdXRlTWFzcyA9IGZ1bmN0aW9uIChtYXNzRGF0YSwgZGVuc2l0eSkge1xyXG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMDtcclxuICAgICAgbWFzc0RhdGEubWFzcyA9IGRlbnNpdHkgKiBiMlNldHRpbmdzLmIyX3BpICogdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXM7XHJcbiAgICAgIG1hc3NEYXRhLmNlbnRlci5TZXRWKHRoaXMubV9wKTtcclxuICAgICAgbWFzc0RhdGEuSSA9IG1hc3NEYXRhLm1hc3MgKiAoMC41ICogdGhpcy5tX3JhZGl1cyAqIHRoaXMubV9yYWRpdXMgKyAodGhpcy5tX3AueCAqIHRoaXMubV9wLnggKyB0aGlzLm1fcC55ICogdGhpcy5tX3AueSkpO1xyXG4gICB9XHJcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLkNvbXB1dGVTdWJtZXJnZWRBcmVhID0gZnVuY3Rpb24gKG5vcm1hbCwgb2Zmc2V0LCB4ZiwgYykge1xyXG4gICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7XHJcbiAgICAgIHZhciBwID0gYjJNYXRoLk11bFgoeGYsIHRoaXMubV9wKTtcclxuICAgICAgdmFyIGwgPSAoLShiMk1hdGguRG90KG5vcm1hbCwgcCkgLSBvZmZzZXQpKTtcclxuICAgICAgaWYgKGwgPCAoLXRoaXMubV9yYWRpdXMpICsgTnVtYmVyLk1JTl9WQUxVRSkge1xyXG4gICAgICAgICByZXR1cm4gMDtcclxuICAgICAgfVxyXG4gICAgICBpZiAobCA+IHRoaXMubV9yYWRpdXMpIHtcclxuICAgICAgICAgYy5TZXRWKHApO1xyXG4gICAgICAgICByZXR1cm4gTWF0aC5QSSAqIHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciByMiA9IHRoaXMubV9yYWRpdXMgKiB0aGlzLm1fcmFkaXVzO1xyXG4gICAgICB2YXIgbDIgPSBsICogbDtcclxuICAgICAgdmFyIGFyZWEgPSByMiAqIChNYXRoLmFzaW4obCAvIHRoaXMubV9yYWRpdXMpICsgTWF0aC5QSSAvIDIpICsgbCAqIE1hdGguc3FydChyMiAtIGwyKTtcclxuICAgICAgdmFyIGNvbSA9ICgtMiAvIDMgKiBNYXRoLnBvdyhyMiAtIGwyLCAxLjUpIC8gYXJlYSk7XHJcbiAgICAgIGMueCA9IHAueCArIG5vcm1hbC54ICogY29tO1xyXG4gICAgICBjLnkgPSBwLnkgKyBub3JtYWwueSAqIGNvbTtcclxuICAgICAgcmV0dXJuIGFyZWE7XHJcbiAgIH1cclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuR2V0TG9jYWxQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9wO1xyXG4gICB9XHJcbiAgIGIyQ2lyY2xlU2hhcGUucHJvdG90eXBlLlNldExvY2FsUG9zaXRpb24gPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcclxuICAgICAgdGhpcy5tX3AuU2V0Vihwb3NpdGlvbik7XHJcbiAgIH1cclxuICAgYjJDaXJjbGVTaGFwZS5wcm90b3R5cGUuR2V0UmFkaXVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3JhZGl1cztcclxuICAgfVxyXG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5TZXRSYWRpdXMgPSBmdW5jdGlvbiAocmFkaXVzKSB7XHJcbiAgICAgIGlmIChyYWRpdXMgPT09IHVuZGVmaW5lZCkgcmFkaXVzID0gMDtcclxuICAgICAgdGhpcy5tX3JhZGl1cyA9IHJhZGl1cztcclxuICAgfVxyXG4gICBiMkNpcmNsZVNoYXBlLnByb3RvdHlwZS5iMkNpcmNsZVNoYXBlID0gZnVuY3Rpb24gKHJhZGl1cykge1xyXG4gICAgICBpZiAocmFkaXVzID09PSB1bmRlZmluZWQpIHJhZGl1cyA9IDA7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMlNoYXBlLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMubV90eXBlID0gYjJTaGFwZS5lX2NpcmNsZVNoYXBlO1xyXG4gICAgICB0aGlzLm1fcmFkaXVzID0gcmFkaXVzO1xyXG4gICB9XHJcbiAgIGIyRWRnZUNoYWluRGVmLmIyRWRnZUNoYWluRGVmID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyRWRnZUNoYWluRGVmLnByb3RvdHlwZS5iMkVkZ2VDaGFpbkRlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy52ZXJ0ZXhDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMuaXNBTG9vcCA9IHRydWU7XHJcbiAgICAgIHRoaXMudmVydGljZXMgPSBbXTtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyRWRnZVNoYXBlLCBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUpO1xyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5wcm90b3R5cGU7XHJcbiAgIGIyRWRnZVNoYXBlLmIyRWRnZVNoYXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuYjJTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLnNfc3VwcG9ydFZlYyA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX3YxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fdjIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9jb3JlVjEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9jb3JlVjIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWwgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9kaXJlY3Rpb24gPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fY29ybmVyRGlyMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLlRlc3RQb2ludCA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0sIHApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5SYXlDYXN0ID0gZnVuY3Rpb24gKG91dHB1dCwgaW5wdXQsIHRyYW5zZm9ybSkge1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHJYID0gaW5wdXQucDIueCAtIGlucHV0LnAxLng7XHJcbiAgICAgIHZhciByWSA9IGlucHV0LnAyLnkgLSBpbnB1dC5wMS55O1xyXG4gICAgICB0TWF0ID0gdHJhbnNmb3JtLlI7XHJcbiAgICAgIHZhciB2MVggPSB0cmFuc2Zvcm0ucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV92MS54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fdjEueSk7XHJcbiAgICAgIHZhciB2MVkgPSB0cmFuc2Zvcm0ucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV92MS54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fdjEueSk7XHJcbiAgICAgIHZhciBuWCA9IHRyYW5zZm9ybS5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX3YyLnggKyB0TWF0LmNvbDIueSAqIHRoaXMubV92Mi55KSAtIHYxWTtcclxuICAgICAgdmFyIG5ZID0gKC0odHJhbnNmb3JtLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fdjIueCArIHRNYXQuY29sMi54ICogdGhpcy5tX3YyLnkpIC0gdjFYKSk7XHJcbiAgICAgIHZhciBrX3Nsb3AgPSAxMDAuMCAqIE51bWJlci5NSU5fVkFMVUU7XHJcbiAgICAgIHZhciBkZW5vbSA9ICgtKHJYICogblggKyByWSAqIG5ZKSk7XHJcbiAgICAgIGlmIChkZW5vbSA+IGtfc2xvcCkge1xyXG4gICAgICAgICB2YXIgYlggPSBpbnB1dC5wMS54IC0gdjFYO1xyXG4gICAgICAgICB2YXIgYlkgPSBpbnB1dC5wMS55IC0gdjFZO1xyXG4gICAgICAgICB2YXIgYSA9IChiWCAqIG5YICsgYlkgKiBuWSk7XHJcbiAgICAgICAgIGlmICgwLjAgPD0gYSAmJiBhIDw9IGlucHV0Lm1heEZyYWN0aW9uICogZGVub20pIHtcclxuICAgICAgICAgICAgdmFyIG11MiA9ICgtclggKiBiWSkgKyByWSAqIGJYO1xyXG4gICAgICAgICAgICBpZiAoKC1rX3Nsb3AgKiBkZW5vbSkgPD0gbXUyICYmIG11MiA8PSBkZW5vbSAqICgxLjAgKyBrX3Nsb3ApKSB7XHJcbiAgICAgICAgICAgICAgIGEgLz0gZGVub207XHJcbiAgICAgICAgICAgICAgIG91dHB1dC5mcmFjdGlvbiA9IGE7XHJcbiAgICAgICAgICAgICAgIHZhciBuTGVuID0gTWF0aC5zcXJ0KG5YICogblggKyBuWSAqIG5ZKTtcclxuICAgICAgICAgICAgICAgb3V0cHV0Lm5vcm1hbC54ID0gblggLyBuTGVuO1xyXG4gICAgICAgICAgICAgICBvdXRwdXQubm9ybWFsLnkgPSBuWSAvIG5MZW47XHJcbiAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkNvbXB1dGVBQUJCID0gZnVuY3Rpb24gKGFhYmIsIHRyYW5zZm9ybSkge1xyXG4gICAgICB2YXIgdE1hdCA9IHRyYW5zZm9ybS5SO1xyXG4gICAgICB2YXIgdjFYID0gdHJhbnNmb3JtLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fdjEueCArIHRNYXQuY29sMi54ICogdGhpcy5tX3YxLnkpO1xyXG4gICAgICB2YXIgdjFZID0gdHJhbnNmb3JtLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0aGlzLm1fdjEueCArIHRNYXQuY29sMi55ICogdGhpcy5tX3YxLnkpO1xyXG4gICAgICB2YXIgdjJYID0gdHJhbnNmb3JtLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0aGlzLm1fdjIueCArIHRNYXQuY29sMi54ICogdGhpcy5tX3YyLnkpO1xyXG4gICAgICB2YXIgdjJZID0gdHJhbnNmb3JtLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0aGlzLm1fdjIueCArIHRNYXQuY29sMi55ICogdGhpcy5tX3YyLnkpO1xyXG4gICAgICBpZiAodjFYIDwgdjJYKSB7XHJcbiAgICAgICAgIGFhYmIubG93ZXJCb3VuZC54ID0gdjFYO1xyXG4gICAgICAgICBhYWJiLnVwcGVyQm91bmQueCA9IHYyWDtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgYWFiYi5sb3dlckJvdW5kLnggPSB2Mlg7XHJcbiAgICAgICAgIGFhYmIudXBwZXJCb3VuZC54ID0gdjFYO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh2MVkgPCB2MlkpIHtcclxuICAgICAgICAgYWFiYi5sb3dlckJvdW5kLnkgPSB2MVk7XHJcbiAgICAgICAgIGFhYmIudXBwZXJCb3VuZC55ID0gdjJZO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBhYWJiLmxvd2VyQm91bmQueSA9IHYyWTtcclxuICAgICAgICAgYWFiYi51cHBlckJvdW5kLnkgPSB2MVk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuQ29tcHV0ZU1hc3MgPSBmdW5jdGlvbiAobWFzc0RhdGEsIGRlbnNpdHkpIHtcclxuICAgICAgaWYgKGRlbnNpdHkgPT09IHVuZGVmaW5lZCkgZGVuc2l0eSA9IDA7XHJcbiAgICAgIG1hc3NEYXRhLm1hc3MgPSAwO1xyXG4gICAgICBtYXNzRGF0YS5jZW50ZXIuU2V0Vih0aGlzLm1fdjEpO1xyXG4gICAgICBtYXNzRGF0YS5JID0gMDtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuQ29tcHV0ZVN1Ym1lcmdlZEFyZWEgPSBmdW5jdGlvbiAobm9ybWFsLCBvZmZzZXQsIHhmLCBjKSB7XHJcbiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDtcclxuICAgICAgdmFyIHYwID0gbmV3IGIyVmVjMihub3JtYWwueCAqIG9mZnNldCwgbm9ybWFsLnkgKiBvZmZzZXQpO1xyXG4gICAgICB2YXIgdjEgPSBiMk1hdGguTXVsWCh4ZiwgdGhpcy5tX3YxKTtcclxuICAgICAgdmFyIHYyID0gYjJNYXRoLk11bFgoeGYsIHRoaXMubV92Mik7XHJcbiAgICAgIHZhciBkMSA9IGIyTWF0aC5Eb3Qobm9ybWFsLCB2MSkgLSBvZmZzZXQ7XHJcbiAgICAgIHZhciBkMiA9IGIyTWF0aC5Eb3Qobm9ybWFsLCB2MikgLSBvZmZzZXQ7XHJcbiAgICAgIGlmIChkMSA+IDApIHtcclxuICAgICAgICAgaWYgKGQyID4gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdjEueCA9ICgtZDIgLyAoZDEgLSBkMikgKiB2MS54KSArIGQxIC8gKGQxIC0gZDIpICogdjIueDtcclxuICAgICAgICAgICAgdjEueSA9ICgtZDIgLyAoZDEgLSBkMikgKiB2MS55KSArIGQxIC8gKGQxIC0gZDIpICogdjIueTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBpZiAoZDIgPiAwKSB7XHJcbiAgICAgICAgICAgIHYyLnggPSAoLWQyIC8gKGQxIC0gZDIpICogdjEueCkgKyBkMSAvIChkMSAtIGQyKSAqIHYyLng7XHJcbiAgICAgICAgICAgIHYyLnkgPSAoLWQyIC8gKGQxIC0gZDIpICogdjEueSkgKyBkMSAvIChkMSAtIGQyKSAqIHYyLnk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7fVxyXG4gICAgICB9XHJcbiAgICAgIGMueCA9ICh2MC54ICsgdjEueCArIHYyLngpIC8gMztcclxuICAgICAgYy55ID0gKHYwLnkgKyB2MS55ICsgdjIueSkgLyAzO1xyXG4gICAgICByZXR1cm4gMC41ICogKCh2MS54IC0gdjAueCkgKiAodjIueSAtIHYwLnkpIC0gKHYxLnkgLSB2MC55KSAqICh2Mi54IC0gdjAueCkpO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXRMZW5ndGggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbGVuZ3RoO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXRWZXJ0ZXgxID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3YxO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXRWZXJ0ZXgyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3YyO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXRDb3JlVmVydGV4MSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jb3JlVjE7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldENvcmVWZXJ0ZXgyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2NvcmVWMjtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0Tm9ybWFsVmVjdG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX25vcm1hbDtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0RGlyZWN0aW9uVmVjdG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2RpcmVjdGlvbjtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0Q29ybmVyMVZlY3RvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jb3JuZXJEaXIxO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5HZXRDb3JuZXIyVmVjdG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2Nvcm5lckRpcjI7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkNvcm5lcjFJc0NvbnZleCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jb3JuZXJDb252ZXgxO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5Db3JuZXIySXNDb252ZXggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fY29ybmVyQ29udmV4MjtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0Rmlyc3RWZXJ0ZXggPSBmdW5jdGlvbiAoeGYpIHtcclxuICAgICAgdmFyIHRNYXQgPSB4Zi5SO1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMih4Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX2NvcmVWMS54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fY29yZVYxLnkpLCB4Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdGhpcy5tX2NvcmVWMS54ICsgdE1hdC5jb2wyLnkgKiB0aGlzLm1fY29yZVYxLnkpKTtcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuR2V0TmV4dEVkZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbmV4dEVkZ2U7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLkdldFByZXZFZGdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3ByZXZFZGdlO1xyXG4gICB9XHJcbiAgIGIyRWRnZVNoYXBlLnByb3RvdHlwZS5TdXBwb3J0ID0gZnVuY3Rpb24gKHhmLCBkWCwgZFkpIHtcclxuICAgICAgaWYgKGRYID09PSB1bmRlZmluZWQpIGRYID0gMDtcclxuICAgICAgaWYgKGRZID09PSB1bmRlZmluZWQpIGRZID0gMDtcclxuICAgICAgdmFyIHRNYXQgPSB4Zi5SO1xyXG4gICAgICB2YXIgdjFYID0geGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRoaXMubV9jb3JlVjEueCArIHRNYXQuY29sMi54ICogdGhpcy5tX2NvcmVWMS55KTtcclxuICAgICAgdmFyIHYxWSA9IHhmLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0aGlzLm1fY29yZVYxLnggKyB0TWF0LmNvbDIueSAqIHRoaXMubV9jb3JlVjEueSk7XHJcbiAgICAgIHZhciB2MlggPSB4Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdGhpcy5tX2NvcmVWMi54ICsgdE1hdC5jb2wyLnggKiB0aGlzLm1fY29yZVYyLnkpO1xyXG4gICAgICB2YXIgdjJZID0geGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRoaXMubV9jb3JlVjIueCArIHRNYXQuY29sMi55ICogdGhpcy5tX2NvcmVWMi55KTtcclxuICAgICAgaWYgKCh2MVggKiBkWCArIHYxWSAqIGRZKSA+ICh2MlggKiBkWCArIHYyWSAqIGRZKSkge1xyXG4gICAgICAgICB0aGlzLnNfc3VwcG9ydFZlYy54ID0gdjFYO1xyXG4gICAgICAgICB0aGlzLnNfc3VwcG9ydFZlYy55ID0gdjFZO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLnNfc3VwcG9ydFZlYy54ID0gdjJYO1xyXG4gICAgICAgICB0aGlzLnNfc3VwcG9ydFZlYy55ID0gdjJZO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLnNfc3VwcG9ydFZlYztcclxuICAgfVxyXG4gICBiMkVkZ2VTaGFwZS5wcm90b3R5cGUuYjJFZGdlU2hhcGUgPSBmdW5jdGlvbiAodjEsIHYyKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMlNoYXBlLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMubV90eXBlID0gYjJTaGFwZS5lX2VkZ2VTaGFwZTtcclxuICAgICAgdGhpcy5tX3ByZXZFZGdlID0gbnVsbDtcclxuICAgICAgdGhpcy5tX25leHRFZGdlID0gbnVsbDtcclxuICAgICAgdGhpcy5tX3YxID0gdjE7XHJcbiAgICAgIHRoaXMubV92MiA9IHYyO1xyXG4gICAgICB0aGlzLm1fZGlyZWN0aW9uLlNldCh0aGlzLm1fdjIueCAtIHRoaXMubV92MS54LCB0aGlzLm1fdjIueSAtIHRoaXMubV92MS55KTtcclxuICAgICAgdGhpcy5tX2xlbmd0aCA9IHRoaXMubV9kaXJlY3Rpb24uTm9ybWFsaXplKCk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWwuU2V0KHRoaXMubV9kaXJlY3Rpb24ueSwgKC10aGlzLm1fZGlyZWN0aW9uLngpKTtcclxuICAgICAgdGhpcy5tX2NvcmVWMS5TZXQoKC1iMlNldHRpbmdzLmIyX3RvaVNsb3AgKiAodGhpcy5tX25vcm1hbC54IC0gdGhpcy5tX2RpcmVjdGlvbi54KSkgKyB0aGlzLm1fdjEueCwgKC1iMlNldHRpbmdzLmIyX3RvaVNsb3AgKiAodGhpcy5tX25vcm1hbC55IC0gdGhpcy5tX2RpcmVjdGlvbi55KSkgKyB0aGlzLm1fdjEueSk7XHJcbiAgICAgIHRoaXMubV9jb3JlVjIuU2V0KCgtYjJTZXR0aW5ncy5iMl90b2lTbG9wICogKHRoaXMubV9ub3JtYWwueCArIHRoaXMubV9kaXJlY3Rpb24ueCkpICsgdGhpcy5tX3YyLngsICgtYjJTZXR0aW5ncy5iMl90b2lTbG9wICogKHRoaXMubV9ub3JtYWwueSArIHRoaXMubV9kaXJlY3Rpb24ueSkpICsgdGhpcy5tX3YyLnkpO1xyXG4gICAgICB0aGlzLm1fY29ybmVyRGlyMSA9IHRoaXMubV9ub3JtYWw7XHJcbiAgICAgIHRoaXMubV9jb3JuZXJEaXIyLlNldCgoLXRoaXMubV9ub3JtYWwueCksICgtdGhpcy5tX25vcm1hbC55KSk7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLlNldFByZXZFZGdlID0gZnVuY3Rpb24gKGVkZ2UsIGNvcmUsIGNvcm5lckRpciwgY29udmV4KSB7XHJcbiAgICAgIHRoaXMubV9wcmV2RWRnZSA9IGVkZ2U7XHJcbiAgICAgIHRoaXMubV9jb3JlVjEgPSBjb3JlO1xyXG4gICAgICB0aGlzLm1fY29ybmVyRGlyMSA9IGNvcm5lckRpcjtcclxuICAgICAgdGhpcy5tX2Nvcm5lckNvbnZleDEgPSBjb252ZXg7XHJcbiAgIH1cclxuICAgYjJFZGdlU2hhcGUucHJvdG90eXBlLlNldE5leHRFZGdlID0gZnVuY3Rpb24gKGVkZ2UsIGNvcmUsIGNvcm5lckRpciwgY29udmV4KSB7XHJcbiAgICAgIHRoaXMubV9uZXh0RWRnZSA9IGVkZ2U7XHJcbiAgICAgIHRoaXMubV9jb3JlVjIgPSBjb3JlO1xyXG4gICAgICB0aGlzLm1fY29ybmVyRGlyMiA9IGNvcm5lckRpcjtcclxuICAgICAgdGhpcy5tX2Nvcm5lckNvbnZleDIgPSBjb252ZXg7XHJcbiAgIH1cclxuICAgYjJNYXNzRGF0YS5iMk1hc3NEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1hc3MgPSAwLjA7XHJcbiAgICAgIHRoaXMuY2VudGVyID0gbmV3IGIyVmVjMigwLCAwKTtcclxuICAgICAgdGhpcy5JID0gMC4wO1xyXG4gICB9O1xyXG4gICBCb3gyRC5pbmhlcml0KGIyUG9seWdvblNoYXBlLCBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUpO1xyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5wcm90b3R5cGU7XHJcbiAgIGIyUG9seWdvblNoYXBlLmIyUG9seWdvblNoYXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuYjJTaGFwZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHMgPSBuZXcgYjJQb2x5Z29uU2hhcGUoKTtcclxuICAgICAgcy5TZXQodGhpcyk7XHJcbiAgICAgIHJldHVybiBzO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLlNldC5jYWxsKHRoaXMsIG90aGVyKTtcclxuICAgICAgaWYgKEJveDJELmlzKG90aGVyLCBiMlBvbHlnb25TaGFwZSkpIHtcclxuICAgICAgICAgdmFyIG90aGVyMiA9IChvdGhlciBpbnN0YW5jZW9mIGIyUG9seWdvblNoYXBlID8gb3RoZXIgOiBudWxsKTtcclxuICAgICAgICAgdGhpcy5tX2NlbnRyb2lkLlNldFYob3RoZXIyLm1fY2VudHJvaWQpO1xyXG4gICAgICAgICB0aGlzLm1fdmVydGV4Q291bnQgPSBvdGhlcjIubV92ZXJ0ZXhDb3VudDtcclxuICAgICAgICAgdGhpcy5SZXNlcnZlKHRoaXMubV92ZXJ0ZXhDb3VudCk7XHJcbiAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5tX3ZlcnRpY2VzW2ldLlNldFYob3RoZXIyLm1fdmVydGljZXNbaV0pO1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXS5TZXRWKG90aGVyMi5tX25vcm1hbHNbaV0pO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuU2V0QXNBcnJheSA9IGZ1bmN0aW9uICh2ZXJ0aWNlcywgdmVydGV4Q291bnQpIHtcclxuICAgICAgaWYgKHZlcnRleENvdW50ID09PSB1bmRlZmluZWQpIHZlcnRleENvdW50ID0gMDtcclxuICAgICAgdmFyIHYgPSBuZXcgVmVjdG9yKCk7XHJcbiAgICAgIHZhciBpID0gMCxcclxuICAgICAgICAgdFZlYztcclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHZlcnRpY2VzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgIHRWZWMgPSB2ZXJ0aWNlc1tpXTtcclxuICAgICAgICAgdi5wdXNoKHRWZWMpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuU2V0QXNWZWN0b3IodiwgdmVydGV4Q291bnQpO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLkFzQXJyYXkgPSBmdW5jdGlvbiAodmVydGljZXMsIHZlcnRleENvdW50KSB7XHJcbiAgICAgIGlmICh2ZXJ0ZXhDb3VudCA9PT0gdW5kZWZpbmVkKSB2ZXJ0ZXhDb3VudCA9IDA7XHJcbiAgICAgIHZhciBwb2x5Z29uU2hhcGUgPSBuZXcgYjJQb2x5Z29uU2hhcGUoKTtcclxuICAgICAgcG9seWdvblNoYXBlLlNldEFzQXJyYXkodmVydGljZXMsIHZlcnRleENvdW50KTtcclxuICAgICAgcmV0dXJuIHBvbHlnb25TaGFwZTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuU2V0QXNWZWN0b3IgPSBmdW5jdGlvbiAodmVydGljZXMsIHZlcnRleENvdW50KSB7XHJcbiAgICAgIGlmICh2ZXJ0ZXhDb3VudCA9PT0gdW5kZWZpbmVkKSB2ZXJ0ZXhDb3VudCA9IDA7XHJcbiAgICAgIGlmICh2ZXJ0ZXhDb3VudCA9PSAwKSB2ZXJ0ZXhDb3VudCA9IHZlcnRpY2VzLmxlbmd0aDtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCgyIDw9IHZlcnRleENvdW50KTtcclxuICAgICAgdGhpcy5tX3ZlcnRleENvdW50ID0gdmVydGV4Q291bnQ7XHJcbiAgICAgIHRoaXMuUmVzZXJ2ZSh2ZXJ0ZXhDb3VudCk7XHJcbiAgICAgIHZhciBpID0gMDtcclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHRoaXMubV92ZXJ0ZXhDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXS5TZXRWKHZlcnRpY2VzW2ldKTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIGkxID0gcGFyc2VJbnQoaSk7XHJcbiAgICAgICAgIHZhciBpMiA9IHBhcnNlSW50KGkgKyAxIDwgdGhpcy5tX3ZlcnRleENvdW50ID8gaSArIDEgOiAwKTtcclxuICAgICAgICAgdmFyIGVkZ2UgPSBiMk1hdGguU3VidHJhY3RWVih0aGlzLm1fdmVydGljZXNbaTJdLCB0aGlzLm1fdmVydGljZXNbaTFdKTtcclxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChlZGdlLkxlbmd0aFNxdWFyZWQoKSA+IE51bWJlci5NSU5fVkFMVUUpO1xyXG4gICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXS5TZXRWKGIyTWF0aC5Dcm9zc1ZGKGVkZ2UsIDEuMCkpO1xyXG4gICAgICAgICB0aGlzLm1fbm9ybWFsc1tpXS5Ob3JtYWxpemUoKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fY2VudHJvaWQgPSBiMlBvbHlnb25TaGFwZS5Db21wdXRlQ2VudHJvaWQodGhpcy5tX3ZlcnRpY2VzLCB0aGlzLm1fdmVydGV4Q291bnQpO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLkFzVmVjdG9yID0gZnVuY3Rpb24gKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCkge1xyXG4gICAgICBpZiAodmVydGV4Q291bnQgPT09IHVuZGVmaW5lZCkgdmVydGV4Q291bnQgPSAwO1xyXG4gICAgICB2YXIgcG9seWdvblNoYXBlID0gbmV3IGIyUG9seWdvblNoYXBlKCk7XHJcbiAgICAgIHBvbHlnb25TaGFwZS5TZXRBc1ZlY3Rvcih2ZXJ0aWNlcywgdmVydGV4Q291bnQpO1xyXG4gICAgICByZXR1cm4gcG9seWdvblNoYXBlO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5TZXRBc0JveCA9IGZ1bmN0aW9uIChoeCwgaHkpIHtcclxuICAgICAgaWYgKGh4ID09PSB1bmRlZmluZWQpIGh4ID0gMDtcclxuICAgICAgaWYgKGh5ID09PSB1bmRlZmluZWQpIGh5ID0gMDtcclxuICAgICAgdGhpcy5tX3ZlcnRleENvdW50ID0gNDtcclxuICAgICAgdGhpcy5SZXNlcnZlKDQpO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXNbMF0uU2V0KCgtaHgpLCAoLWh5KSk7XHJcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1sxXS5TZXQoaHgsICgtaHkpKTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzJdLlNldChoeCwgaHkpO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXNbM10uU2V0KCgtaHgpLCBoeSk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWxzWzBdLlNldCgwLjAsICgtMS4wKSk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWxzWzFdLlNldCgxLjAsIDAuMCk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWxzWzJdLlNldCgwLjAsIDEuMCk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWxzWzNdLlNldCgoLTEuMCksIDAuMCk7XHJcbiAgICAgIHRoaXMubV9jZW50cm9pZC5TZXRaZXJvKCk7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUuQXNCb3ggPSBmdW5jdGlvbiAoaHgsIGh5KSB7XHJcbiAgICAgIGlmIChoeCA9PT0gdW5kZWZpbmVkKSBoeCA9IDA7XHJcbiAgICAgIGlmIChoeSA9PT0gdW5kZWZpbmVkKSBoeSA9IDA7XHJcbiAgICAgIHZhciBwb2x5Z29uU2hhcGUgPSBuZXcgYjJQb2x5Z29uU2hhcGUoKTtcclxuICAgICAgcG9seWdvblNoYXBlLlNldEFzQm94KGh4LCBoeSk7XHJcbiAgICAgIHJldHVybiBwb2x5Z29uU2hhcGU7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLlNldEFzT3JpZW50ZWRCb3ggPSBmdW5jdGlvbiAoaHgsIGh5LCBjZW50ZXIsIGFuZ2xlKSB7XHJcbiAgICAgIGlmIChoeCA9PT0gdW5kZWZpbmVkKSBoeCA9IDA7XHJcbiAgICAgIGlmIChoeSA9PT0gdW5kZWZpbmVkKSBoeSA9IDA7XHJcbiAgICAgIGlmIChjZW50ZXIgPT09IHVuZGVmaW5lZCkgY2VudGVyID0gbnVsbDtcclxuICAgICAgaWYgKGFuZ2xlID09PSB1bmRlZmluZWQpIGFuZ2xlID0gMC4wO1xyXG4gICAgICB0aGlzLm1fdmVydGV4Q291bnQgPSA0O1xyXG4gICAgICB0aGlzLlJlc2VydmUoNCk7XHJcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1swXS5TZXQoKC1oeCksICgtaHkpKTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzFdLlNldChoeCwgKC1oeSkpO1xyXG4gICAgICB0aGlzLm1fdmVydGljZXNbMl0uU2V0KGh4LCBoeSk7XHJcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1szXS5TZXQoKC1oeCksIGh5KTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbMF0uU2V0KDAuMCwgKC0xLjApKTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbMV0uU2V0KDEuMCwgMC4wKTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbMl0uU2V0KDAuMCwgMS4wKTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbM10uU2V0KCgtMS4wKSwgMC4wKTtcclxuICAgICAgdGhpcy5tX2NlbnRyb2lkID0gY2VudGVyO1xyXG4gICAgICB2YXIgeGYgPSBuZXcgYjJUcmFuc2Zvcm0oKTtcclxuICAgICAgeGYucG9zaXRpb24gPSBjZW50ZXI7XHJcbiAgICAgIHhmLlIuU2V0KGFuZ2xlKTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB0aGlzLm1fdmVydGljZXNbaV0gPSBiMk1hdGguTXVsWCh4ZiwgdGhpcy5tX3ZlcnRpY2VzW2ldKTtcclxuICAgICAgICAgdGhpcy5tX25vcm1hbHNbaV0gPSBiMk1hdGguTXVsTVYoeGYuUiwgdGhpcy5tX25vcm1hbHNbaV0pO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUuQXNPcmllbnRlZEJveCA9IGZ1bmN0aW9uIChoeCwgaHksIGNlbnRlciwgYW5nbGUpIHtcclxuICAgICAgaWYgKGh4ID09PSB1bmRlZmluZWQpIGh4ID0gMDtcclxuICAgICAgaWYgKGh5ID09PSB1bmRlZmluZWQpIGh5ID0gMDtcclxuICAgICAgaWYgKGNlbnRlciA9PT0gdW5kZWZpbmVkKSBjZW50ZXIgPSBudWxsO1xyXG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwLjA7XHJcbiAgICAgIHZhciBwb2x5Z29uU2hhcGUgPSBuZXcgYjJQb2x5Z29uU2hhcGUoKTtcclxuICAgICAgcG9seWdvblNoYXBlLlNldEFzT3JpZW50ZWRCb3goaHgsIGh5LCBjZW50ZXIsIGFuZ2xlKTtcclxuICAgICAgcmV0dXJuIHBvbHlnb25TaGFwZTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuU2V0QXNFZGdlID0gZnVuY3Rpb24gKHYxLCB2Mikge1xyXG4gICAgICB0aGlzLm1fdmVydGV4Q291bnQgPSAyO1xyXG4gICAgICB0aGlzLlJlc2VydmUoMik7XHJcbiAgICAgIHRoaXMubV92ZXJ0aWNlc1swXS5TZXRWKHYxKTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzWzFdLlNldFYodjIpO1xyXG4gICAgICB0aGlzLm1fY2VudHJvaWQueCA9IDAuNSAqICh2MS54ICsgdjIueCk7XHJcbiAgICAgIHRoaXMubV9jZW50cm9pZC55ID0gMC41ICogKHYxLnkgKyB2Mi55KTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbMF0gPSBiMk1hdGguQ3Jvc3NWRihiMk1hdGguU3VidHJhY3RWVih2MiwgdjEpLCAxLjApO1xyXG4gICAgICB0aGlzLm1fbm9ybWFsc1swXS5Ob3JtYWxpemUoKTtcclxuICAgICAgdGhpcy5tX25vcm1hbHNbMV0ueCA9ICgtdGhpcy5tX25vcm1hbHNbMF0ueCk7XHJcbiAgICAgIHRoaXMubV9ub3JtYWxzWzFdLnkgPSAoLXRoaXMubV9ub3JtYWxzWzBdLnkpO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLkFzRWRnZSA9IGZ1bmN0aW9uICh2MSwgdjIpIHtcclxuICAgICAgdmFyIHBvbHlnb25TaGFwZSA9IG5ldyBiMlBvbHlnb25TaGFwZSgpO1xyXG4gICAgICBwb2x5Z29uU2hhcGUuU2V0QXNFZGdlKHYxLCB2Mik7XHJcbiAgICAgIHJldHVybiBwb2x5Z29uU2hhcGU7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLlRlc3RQb2ludCA9IGZ1bmN0aW9uICh4ZiwgcCkge1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgdmFyIHRNYXQgPSB4Zi5SO1xyXG4gICAgICB2YXIgdFggPSBwLnggLSB4Zi5wb3NpdGlvbi54O1xyXG4gICAgICB2YXIgdFkgPSBwLnkgLSB4Zi5wb3NpdGlvbi55O1xyXG4gICAgICB2YXIgcExvY2FsWCA9ICh0WCAqIHRNYXQuY29sMS54ICsgdFkgKiB0TWF0LmNvbDEueSk7XHJcbiAgICAgIHZhciBwTG9jYWxZID0gKHRYICogdE1hdC5jb2wyLnggKyB0WSAqIHRNYXQuY29sMi55KTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB0VmVjID0gdGhpcy5tX3ZlcnRpY2VzW2ldO1xyXG4gICAgICAgICB0WCA9IHBMb2NhbFggLSB0VmVjLng7XHJcbiAgICAgICAgIHRZID0gcExvY2FsWSAtIHRWZWMueTtcclxuICAgICAgICAgdFZlYyA9IHRoaXMubV9ub3JtYWxzW2ldO1xyXG4gICAgICAgICB2YXIgZG90ID0gKHRWZWMueCAqIHRYICsgdFZlYy55ICogdFkpO1xyXG4gICAgICAgICBpZiAoZG90ID4gMC4wKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5SYXlDYXN0ID0gZnVuY3Rpb24gKG91dHB1dCwgaW5wdXQsIHRyYW5zZm9ybSkge1xyXG4gICAgICB2YXIgbG93ZXIgPSAwLjA7XHJcbiAgICAgIHZhciB1cHBlciA9IGlucHV0Lm1heEZyYWN0aW9uO1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgdFkgPSAwO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRWZWM7XHJcbiAgICAgIHRYID0gaW5wdXQucDEueCAtIHRyYW5zZm9ybS5wb3NpdGlvbi54O1xyXG4gICAgICB0WSA9IGlucHV0LnAxLnkgLSB0cmFuc2Zvcm0ucG9zaXRpb24ueTtcclxuICAgICAgdE1hdCA9IHRyYW5zZm9ybS5SO1xyXG4gICAgICB2YXIgcDFYID0gKHRYICogdE1hdC5jb2wxLnggKyB0WSAqIHRNYXQuY29sMS55KTtcclxuICAgICAgdmFyIHAxWSA9ICh0WCAqIHRNYXQuY29sMi54ICsgdFkgKiB0TWF0LmNvbDIueSk7XHJcbiAgICAgIHRYID0gaW5wdXQucDIueCAtIHRyYW5zZm9ybS5wb3NpdGlvbi54O1xyXG4gICAgICB0WSA9IGlucHV0LnAyLnkgLSB0cmFuc2Zvcm0ucG9zaXRpb24ueTtcclxuICAgICAgdE1hdCA9IHRyYW5zZm9ybS5SO1xyXG4gICAgICB2YXIgcDJYID0gKHRYICogdE1hdC5jb2wxLnggKyB0WSAqIHRNYXQuY29sMS55KTtcclxuICAgICAgdmFyIHAyWSA9ICh0WCAqIHRNYXQuY29sMi54ICsgdFkgKiB0TWF0LmNvbDIueSk7XHJcbiAgICAgIHZhciBkWCA9IHAyWCAtIHAxWDtcclxuICAgICAgdmFyIGRZID0gcDJZIC0gcDFZO1xyXG4gICAgICB2YXIgaW5kZXggPSBwYXJzZUludCgoLTEpKTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB0VmVjID0gdGhpcy5tX3ZlcnRpY2VzW2ldO1xyXG4gICAgICAgICB0WCA9IHRWZWMueCAtIHAxWDtcclxuICAgICAgICAgdFkgPSB0VmVjLnkgLSBwMVk7XHJcbiAgICAgICAgIHRWZWMgPSB0aGlzLm1fbm9ybWFsc1tpXTtcclxuICAgICAgICAgdmFyIG51bWVyYXRvciA9ICh0VmVjLnggKiB0WCArIHRWZWMueSAqIHRZKTtcclxuICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gKHRWZWMueCAqIGRYICsgdFZlYy55ICogZFkpO1xyXG4gICAgICAgICBpZiAoZGVub21pbmF0b3IgPT0gMC4wKSB7XHJcbiAgICAgICAgICAgIGlmIChudW1lcmF0b3IgPCAwLjApIHtcclxuICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChkZW5vbWluYXRvciA8IDAuMCAmJiBudW1lcmF0b3IgPCBsb3dlciAqIGRlbm9taW5hdG9yKSB7XHJcbiAgICAgICAgICAgICAgIGxvd2VyID0gbnVtZXJhdG9yIC8gZGVub21pbmF0b3I7XHJcbiAgICAgICAgICAgICAgIGluZGV4ID0gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChkZW5vbWluYXRvciA+IDAuMCAmJiBudW1lcmF0b3IgPCB1cHBlciAqIGRlbm9taW5hdG9yKSB7XHJcbiAgICAgICAgICAgICAgIHVwcGVyID0gbnVtZXJhdG9yIC8gZGVub21pbmF0b3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAodXBwZXIgPCBsb3dlciAtIE51bWJlci5NSU5fVkFMVUUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICAgb3V0cHV0LmZyYWN0aW9uID0gbG93ZXI7XHJcbiAgICAgICAgIHRNYXQgPSB0cmFuc2Zvcm0uUjtcclxuICAgICAgICAgdFZlYyA9IHRoaXMubV9ub3JtYWxzW2luZGV4XTtcclxuICAgICAgICAgb3V0cHV0Lm5vcm1hbC54ID0gKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICBvdXRwdXQubm9ybWFsLnkgPSAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuQ29tcHV0ZUFBQkIgPSBmdW5jdGlvbiAoYWFiYiwgeGYpIHtcclxuICAgICAgdmFyIHRNYXQgPSB4Zi5SO1xyXG4gICAgICB2YXIgdFZlYyA9IHRoaXMubV92ZXJ0aWNlc1swXTtcclxuICAgICAgdmFyIGxvd2VyWCA9IHhmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHZhciBsb3dlclkgPSB4Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB2YXIgdXBwZXJYID0gbG93ZXJYO1xyXG4gICAgICB2YXIgdXBwZXJZID0gbG93ZXJZO1xyXG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRoaXMubV92ZXJ0ZXhDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIHRWZWMgPSB0aGlzLm1fdmVydGljZXNbaV07XHJcbiAgICAgICAgIHZhciB2WCA9IHhmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgIHZhciB2WSA9IHhmLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgIGxvd2VyWCA9IGxvd2VyWCA8IHZYID8gbG93ZXJYIDogdlg7XHJcbiAgICAgICAgIGxvd2VyWSA9IGxvd2VyWSA8IHZZID8gbG93ZXJZIDogdlk7XHJcbiAgICAgICAgIHVwcGVyWCA9IHVwcGVyWCA+IHZYID8gdXBwZXJYIDogdlg7XHJcbiAgICAgICAgIHVwcGVyWSA9IHVwcGVyWSA+IHZZID8gdXBwZXJZIDogdlk7XHJcbiAgICAgIH1cclxuICAgICAgYWFiYi5sb3dlckJvdW5kLnggPSBsb3dlclggLSB0aGlzLm1fcmFkaXVzO1xyXG4gICAgICBhYWJiLmxvd2VyQm91bmQueSA9IGxvd2VyWSAtIHRoaXMubV9yYWRpdXM7XHJcbiAgICAgIGFhYmIudXBwZXJCb3VuZC54ID0gdXBwZXJYICsgdGhpcy5tX3JhZGl1cztcclxuICAgICAgYWFiYi51cHBlckJvdW5kLnkgPSB1cHBlclkgKyB0aGlzLm1fcmFkaXVzO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5Db21wdXRlTWFzcyA9IGZ1bmN0aW9uIChtYXNzRGF0YSwgZGVuc2l0eSkge1xyXG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMDtcclxuICAgICAgaWYgKHRoaXMubV92ZXJ0ZXhDb3VudCA9PSAyKSB7XHJcbiAgICAgICAgIG1hc3NEYXRhLmNlbnRlci54ID0gMC41ICogKHRoaXMubV92ZXJ0aWNlc1swXS54ICsgdGhpcy5tX3ZlcnRpY2VzWzFdLngpO1xyXG4gICAgICAgICBtYXNzRGF0YS5jZW50ZXIueSA9IDAuNSAqICh0aGlzLm1fdmVydGljZXNbMF0ueSArIHRoaXMubV92ZXJ0aWNlc1sxXS55KTtcclxuICAgICAgICAgbWFzc0RhdGEubWFzcyA9IDAuMDtcclxuICAgICAgICAgbWFzc0RhdGEuSSA9IDAuMDtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBjZW50ZXJYID0gMC4wO1xyXG4gICAgICB2YXIgY2VudGVyWSA9IDAuMDtcclxuICAgICAgdmFyIGFyZWEgPSAwLjA7XHJcbiAgICAgIHZhciBJID0gMC4wO1xyXG4gICAgICB2YXIgcDFYID0gMC4wO1xyXG4gICAgICB2YXIgcDFZID0gMC4wO1xyXG4gICAgICB2YXIga19pbnYzID0gMS4wIC8gMy4wO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV92ZXJ0ZXhDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIHZhciBwMiA9IHRoaXMubV92ZXJ0aWNlc1tpXTtcclxuICAgICAgICAgdmFyIHAzID0gaSArIDEgPCB0aGlzLm1fdmVydGV4Q291bnQgPyB0aGlzLm1fdmVydGljZXNbcGFyc2VJbnQoaSArIDEpXSA6IHRoaXMubV92ZXJ0aWNlc1swXTtcclxuICAgICAgICAgdmFyIGUxWCA9IHAyLnggLSBwMVg7XHJcbiAgICAgICAgIHZhciBlMVkgPSBwMi55IC0gcDFZO1xyXG4gICAgICAgICB2YXIgZTJYID0gcDMueCAtIHAxWDtcclxuICAgICAgICAgdmFyIGUyWSA9IHAzLnkgLSBwMVk7XHJcbiAgICAgICAgIHZhciBEID0gZTFYICogZTJZIC0gZTFZICogZTJYO1xyXG4gICAgICAgICB2YXIgdHJpYW5nbGVBcmVhID0gMC41ICogRDthcmVhICs9IHRyaWFuZ2xlQXJlYTtcclxuICAgICAgICAgY2VudGVyWCArPSB0cmlhbmdsZUFyZWEgKiBrX2ludjMgKiAocDFYICsgcDIueCArIHAzLngpO1xyXG4gICAgICAgICBjZW50ZXJZICs9IHRyaWFuZ2xlQXJlYSAqIGtfaW52MyAqIChwMVkgKyBwMi55ICsgcDMueSk7XHJcbiAgICAgICAgIHZhciBweCA9IHAxWDtcclxuICAgICAgICAgdmFyIHB5ID0gcDFZO1xyXG4gICAgICAgICB2YXIgZXgxID0gZTFYO1xyXG4gICAgICAgICB2YXIgZXkxID0gZTFZO1xyXG4gICAgICAgICB2YXIgZXgyID0gZTJYO1xyXG4gICAgICAgICB2YXIgZXkyID0gZTJZO1xyXG4gICAgICAgICB2YXIgaW50eDIgPSBrX2ludjMgKiAoMC4yNSAqIChleDEgKiBleDEgKyBleDIgKiBleDEgKyBleDIgKiBleDIpICsgKHB4ICogZXgxICsgcHggKiBleDIpKSArIDAuNSAqIHB4ICogcHg7XHJcbiAgICAgICAgIHZhciBpbnR5MiA9IGtfaW52MyAqICgwLjI1ICogKGV5MSAqIGV5MSArIGV5MiAqIGV5MSArIGV5MiAqIGV5MikgKyAocHkgKiBleTEgKyBweSAqIGV5MikpICsgMC41ICogcHkgKiBweTtJICs9IEQgKiAoaW50eDIgKyBpbnR5Mik7XHJcbiAgICAgIH1cclxuICAgICAgbWFzc0RhdGEubWFzcyA9IGRlbnNpdHkgKiBhcmVhO1xyXG4gICAgICBjZW50ZXJYICo9IDEuMCAvIGFyZWE7XHJcbiAgICAgIGNlbnRlclkgKj0gMS4wIC8gYXJlYTtcclxuICAgICAgbWFzc0RhdGEuY2VudGVyLlNldChjZW50ZXJYLCBjZW50ZXJZKTtcclxuICAgICAgbWFzc0RhdGEuSSA9IGRlbnNpdHkgKiBJO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5Db21wdXRlU3VibWVyZ2VkQXJlYSA9IGZ1bmN0aW9uIChub3JtYWwsIG9mZnNldCwgeGYsIGMpIHtcclxuICAgICAgaWYgKG9mZnNldCA9PT0gdW5kZWZpbmVkKSBvZmZzZXQgPSAwO1xyXG4gICAgICB2YXIgbm9ybWFsTCA9IGIyTWF0aC5NdWxUTVYoeGYuUiwgbm9ybWFsKTtcclxuICAgICAgdmFyIG9mZnNldEwgPSBvZmZzZXQgLSBiMk1hdGguRG90KG5vcm1hbCwgeGYucG9zaXRpb24pO1xyXG4gICAgICB2YXIgZGVwdGhzID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKCk7XHJcbiAgICAgIHZhciBkaXZlQ291bnQgPSAwO1xyXG4gICAgICB2YXIgaW50b0luZGV4ID0gcGFyc2VJbnQoKC0xKSk7XHJcbiAgICAgIHZhciBvdXRvSW5kZXggPSBwYXJzZUludCgoLTEpKTtcclxuICAgICAgdmFyIGxhc3RTdWJtZXJnZWQgPSBmYWxzZTtcclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyArK2kpIHtcclxuICAgICAgICAgZGVwdGhzW2ldID0gYjJNYXRoLkRvdChub3JtYWxMLCB0aGlzLm1fdmVydGljZXNbaV0pIC0gb2Zmc2V0TDtcclxuICAgICAgICAgdmFyIGlzU3VibWVyZ2VkID0gZGVwdGhzW2ldIDwgKC1OdW1iZXIuTUlOX1ZBTFVFKTtcclxuICAgICAgICAgaWYgKGkgPiAwKSB7XHJcbiAgICAgICAgICAgIGlmIChpc1N1Ym1lcmdlZCkge1xyXG4gICAgICAgICAgICAgICBpZiAoIWxhc3RTdWJtZXJnZWQpIHtcclxuICAgICAgICAgICAgICAgICAgaW50b0luZGV4ID0gaSAtIDE7XHJcbiAgICAgICAgICAgICAgICAgIGRpdmVDb3VudCsrO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIGlmIChsYXN0U3VibWVyZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgIG91dG9JbmRleCA9IGkgLSAxO1xyXG4gICAgICAgICAgICAgICAgICBkaXZlQ291bnQrKztcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgbGFzdFN1Ym1lcmdlZCA9IGlzU3VibWVyZ2VkO1xyXG4gICAgICB9XHJcbiAgICAgIHN3aXRjaCAoZGl2ZUNvdW50KSB7XHJcbiAgICAgIGNhc2UgMDpcclxuICAgICAgICAgaWYgKGxhc3RTdWJtZXJnZWQpIHtcclxuICAgICAgICAgICAgdmFyIG1kID0gbmV3IGIyTWFzc0RhdGEoKTtcclxuICAgICAgICAgICAgdGhpcy5Db21wdXRlTWFzcyhtZCwgMSk7XHJcbiAgICAgICAgICAgIGMuU2V0VihiMk1hdGguTXVsWCh4ZiwgbWQuY2VudGVyKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBtZC5tYXNzO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAxOlxyXG4gICAgICAgICBpZiAoaW50b0luZGV4ID09ICgtMSkpIHtcclxuICAgICAgICAgICAgaW50b0luZGV4ID0gdGhpcy5tX3ZlcnRleENvdW50IC0gMTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3V0b0luZGV4ID0gdGhpcy5tX3ZlcnRleENvdW50IC0gMTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICB2YXIgaW50b0luZGV4MiA9IHBhcnNlSW50KChpbnRvSW5kZXggKyAxKSAlIHRoaXMubV92ZXJ0ZXhDb3VudCk7XHJcbiAgICAgIHZhciBvdXRvSW5kZXgyID0gcGFyc2VJbnQoKG91dG9JbmRleCArIDEpICUgdGhpcy5tX3ZlcnRleENvdW50KTtcclxuICAgICAgdmFyIGludG9MYW1kZGEgPSAoMCAtIGRlcHRoc1tpbnRvSW5kZXhdKSAvIChkZXB0aHNbaW50b0luZGV4Ml0gLSBkZXB0aHNbaW50b0luZGV4XSk7XHJcbiAgICAgIHZhciBvdXRvTGFtZGRhID0gKDAgLSBkZXB0aHNbb3V0b0luZGV4XSkgLyAoZGVwdGhzW291dG9JbmRleDJdIC0gZGVwdGhzW291dG9JbmRleF0pO1xyXG4gICAgICB2YXIgaW50b1ZlYyA9IG5ldyBiMlZlYzIodGhpcy5tX3ZlcnRpY2VzW2ludG9JbmRleF0ueCAqICgxIC0gaW50b0xhbWRkYSkgKyB0aGlzLm1fdmVydGljZXNbaW50b0luZGV4Ml0ueCAqIGludG9MYW1kZGEsIHRoaXMubV92ZXJ0aWNlc1tpbnRvSW5kZXhdLnkgKiAoMSAtIGludG9MYW1kZGEpICsgdGhpcy5tX3ZlcnRpY2VzW2ludG9JbmRleDJdLnkgKiBpbnRvTGFtZGRhKTtcclxuICAgICAgdmFyIG91dG9WZWMgPSBuZXcgYjJWZWMyKHRoaXMubV92ZXJ0aWNlc1tvdXRvSW5kZXhdLnggKiAoMSAtIG91dG9MYW1kZGEpICsgdGhpcy5tX3ZlcnRpY2VzW291dG9JbmRleDJdLnggKiBvdXRvTGFtZGRhLCB0aGlzLm1fdmVydGljZXNbb3V0b0luZGV4XS55ICogKDEgLSBvdXRvTGFtZGRhKSArIHRoaXMubV92ZXJ0aWNlc1tvdXRvSW5kZXgyXS55ICogb3V0b0xhbWRkYSk7XHJcbiAgICAgIHZhciBhcmVhID0gMDtcclxuICAgICAgdmFyIGNlbnRlciA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdmFyIHAyID0gdGhpcy5tX3ZlcnRpY2VzW2ludG9JbmRleDJdO1xyXG4gICAgICB2YXIgcDM7XHJcbiAgICAgIGkgPSBpbnRvSW5kZXgyO1xyXG4gICAgICB3aGlsZSAoaSAhPSBvdXRvSW5kZXgyKSB7XHJcbiAgICAgICAgIGkgPSAoaSArIDEpICUgdGhpcy5tX3ZlcnRleENvdW50O1xyXG4gICAgICAgICBpZiAoaSA9PSBvdXRvSW5kZXgyKSBwMyA9IG91dG9WZWM7XHJcbiAgICAgICAgIGVsc2UgcDMgPSB0aGlzLm1fdmVydGljZXNbaV07XHJcbiAgICAgICAgIHZhciB0cmlhbmdsZUFyZWEgPSAwLjUgKiAoKHAyLnggLSBpbnRvVmVjLngpICogKHAzLnkgLSBpbnRvVmVjLnkpIC0gKHAyLnkgLSBpbnRvVmVjLnkpICogKHAzLnggLSBpbnRvVmVjLngpKTtcclxuICAgICAgICAgYXJlYSArPSB0cmlhbmdsZUFyZWE7XHJcbiAgICAgICAgIGNlbnRlci54ICs9IHRyaWFuZ2xlQXJlYSAqIChpbnRvVmVjLnggKyBwMi54ICsgcDMueCkgLyAzO1xyXG4gICAgICAgICBjZW50ZXIueSArPSB0cmlhbmdsZUFyZWEgKiAoaW50b1ZlYy55ICsgcDIueSArIHAzLnkpIC8gMztcclxuICAgICAgICAgcDIgPSBwMztcclxuICAgICAgfVxyXG4gICAgICBjZW50ZXIuTXVsdGlwbHkoMSAvIGFyZWEpO1xyXG4gICAgICBjLlNldFYoYjJNYXRoLk11bFgoeGYsIGNlbnRlcikpO1xyXG4gICAgICByZXR1cm4gYXJlYTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuR2V0VmVydGV4Q291bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdmVydGV4Q291bnQ7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLkdldFZlcnRpY2VzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLnByb3RvdHlwZS5HZXROb3JtYWxzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX25vcm1hbHM7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLkdldFN1cHBvcnQgPSBmdW5jdGlvbiAoZCkge1xyXG4gICAgICB2YXIgYmVzdEluZGV4ID0gMDtcclxuICAgICAgdmFyIGJlc3RWYWx1ZSA9IHRoaXMubV92ZXJ0aWNlc1swXS54ICogZC54ICsgdGhpcy5tX3ZlcnRpY2VzWzBdLnkgKiBkLnk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5tX3ZlcnRleENvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzW2ldLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbaV0ueSAqIGQueTtcclxuICAgICAgICAgaWYgKHZhbHVlID4gYmVzdFZhbHVlKSB7XHJcbiAgICAgICAgICAgIGJlc3RJbmRleCA9IGk7XHJcbiAgICAgICAgICAgIGJlc3RWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGJlc3RJbmRleDtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuR2V0U3VwcG9ydFZlcnRleCA9IGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgIHZhciBiZXN0SW5kZXggPSAwO1xyXG4gICAgICB2YXIgYmVzdFZhbHVlID0gdGhpcy5tX3ZlcnRpY2VzWzBdLnggKiBkLnggKyB0aGlzLm1fdmVydGljZXNbMF0ueSAqIGQueTtcclxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB0aGlzLm1fdmVydGV4Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLm1fdmVydGljZXNbaV0ueCAqIGQueCArIHRoaXMubV92ZXJ0aWNlc1tpXS55ICogZC55O1xyXG4gICAgICAgICBpZiAodmFsdWUgPiBiZXN0VmFsdWUpIHtcclxuICAgICAgICAgICAgYmVzdEluZGV4ID0gaTtcclxuICAgICAgICAgICAgYmVzdFZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdGhpcy5tX3ZlcnRpY2VzW2Jlc3RJbmRleF07XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLlZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgIH1cclxuICAgYjJQb2x5Z29uU2hhcGUucHJvdG90eXBlLmIyUG9seWdvblNoYXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJTaGFwZS5jYWxsKHRoaXMpO1xyXG4gICAgICB0aGlzLm1fdHlwZSA9IGIyU2hhcGUuZV9wb2x5Z29uU2hhcGU7XHJcbiAgICAgIHRoaXMubV9jZW50cm9pZCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX3ZlcnRpY2VzID0gbmV3IFZlY3RvcigpO1xyXG4gICAgICB0aGlzLm1fbm9ybWFscyA9IG5ldyBWZWN0b3IoKTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5wcm90b3R5cGUuUmVzZXJ2ZSA9IGZ1bmN0aW9uIChjb3VudCkge1xyXG4gICAgICBpZiAoY291bnQgPT09IHVuZGVmaW5lZCkgY291bnQgPSAwO1xyXG4gICAgICBmb3IgKHZhciBpID0gcGFyc2VJbnQodGhpcy5tX3ZlcnRpY2VzLmxlbmd0aCk7IGkgPCBjb3VudDsgaSsrKSB7XHJcbiAgICAgICAgIHRoaXMubV92ZXJ0aWNlc1tpXSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgICAgdGhpcy5tX25vcm1hbHNbaV0gPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlBvbHlnb25TaGFwZS5Db21wdXRlQ2VudHJvaWQgPSBmdW5jdGlvbiAodnMsIGNvdW50KSB7XHJcbiAgICAgIGlmIChjb3VudCA9PT0gdW5kZWZpbmVkKSBjb3VudCA9IDA7XHJcbiAgICAgIHZhciBjID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB2YXIgYXJlYSA9IDAuMDtcclxuICAgICAgdmFyIHAxWCA9IDAuMDtcclxuICAgICAgdmFyIHAxWSA9IDAuMDtcclxuICAgICAgdmFyIGludjMgPSAxLjAgLyAzLjA7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgcDIgPSB2c1tpXTtcclxuICAgICAgICAgdmFyIHAzID0gaSArIDEgPCBjb3VudCA/IHZzW3BhcnNlSW50KGkgKyAxKV0gOiB2c1swXTtcclxuICAgICAgICAgdmFyIGUxWCA9IHAyLnggLSBwMVg7XHJcbiAgICAgICAgIHZhciBlMVkgPSBwMi55IC0gcDFZO1xyXG4gICAgICAgICB2YXIgZTJYID0gcDMueCAtIHAxWDtcclxuICAgICAgICAgdmFyIGUyWSA9IHAzLnkgLSBwMVk7XHJcbiAgICAgICAgIHZhciBEID0gKGUxWCAqIGUyWSAtIGUxWSAqIGUyWCk7XHJcbiAgICAgICAgIHZhciB0cmlhbmdsZUFyZWEgPSAwLjUgKiBEO2FyZWEgKz0gdHJpYW5nbGVBcmVhO1xyXG4gICAgICAgICBjLnggKz0gdHJpYW5nbGVBcmVhICogaW52MyAqIChwMVggKyBwMi54ICsgcDMueCk7XHJcbiAgICAgICAgIGMueSArPSB0cmlhbmdsZUFyZWEgKiBpbnYzICogKHAxWSArIHAyLnkgKyBwMy55KTtcclxuICAgICAgfVxyXG4gICAgICBjLnggKj0gMS4wIC8gYXJlYTtcclxuICAgICAgYy55ICo9IDEuMCAvIGFyZWE7XHJcbiAgICAgIHJldHVybiBjO1xyXG4gICB9XHJcbiAgIGIyUG9seWdvblNoYXBlLkNvbXB1dGVPQkIgPSBmdW5jdGlvbiAob2JiLCB2cywgY291bnQpIHtcclxuICAgICAgaWYgKGNvdW50ID09PSB1bmRlZmluZWQpIGNvdW50ID0gMDtcclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICB2YXIgcCA9IG5ldyBWZWN0b3IoY291bnQgKyAxKTtcclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IGNvdW50OyArK2kpIHtcclxuICAgICAgICAgcFtpXSA9IHZzW2ldO1xyXG4gICAgICB9XHJcbiAgICAgIHBbY291bnRdID0gcFswXTtcclxuICAgICAgdmFyIG1pbkFyZWEgPSBOdW1iZXIuTUFYX1ZBTFVFO1xyXG4gICAgICBmb3IgKGkgPSAxO1xyXG4gICAgICBpIDw9IGNvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIHJvb3QgPSBwW3BhcnNlSW50KGkgLSAxKV07XHJcbiAgICAgICAgIHZhciB1eFggPSBwW2ldLnggLSByb290Lng7XHJcbiAgICAgICAgIHZhciB1eFkgPSBwW2ldLnkgLSByb290Lnk7XHJcbiAgICAgICAgIHZhciBsZW5ndGggPSBNYXRoLnNxcnQodXhYICogdXhYICsgdXhZICogdXhZKTtcclxuICAgICAgICAgdXhYIC89IGxlbmd0aDtcclxuICAgICAgICAgdXhZIC89IGxlbmd0aDtcclxuICAgICAgICAgdmFyIHV5WCA9ICgtdXhZKTtcclxuICAgICAgICAgdmFyIHV5WSA9IHV4WDtcclxuICAgICAgICAgdmFyIGxvd2VyWCA9IE51bWJlci5NQVhfVkFMVUU7XHJcbiAgICAgICAgIHZhciBsb3dlclkgPSBOdW1iZXIuTUFYX1ZBTFVFO1xyXG4gICAgICAgICB2YXIgdXBwZXJYID0gKC1OdW1iZXIuTUFYX1ZBTFVFKTtcclxuICAgICAgICAgdmFyIHVwcGVyWSA9ICgtTnVtYmVyLk1BWF9WQUxVRSk7XHJcbiAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY291bnQ7ICsraikge1xyXG4gICAgICAgICAgICB2YXIgZFggPSBwW2pdLnggLSByb290Lng7XHJcbiAgICAgICAgICAgIHZhciBkWSA9IHBbal0ueSAtIHJvb3QueTtcclxuICAgICAgICAgICAgdmFyIHJYID0gKHV4WCAqIGRYICsgdXhZICogZFkpO1xyXG4gICAgICAgICAgICB2YXIgclkgPSAodXlYICogZFggKyB1eVkgKiBkWSk7XHJcbiAgICAgICAgICAgIGlmIChyWCA8IGxvd2VyWCkgbG93ZXJYID0gclg7XHJcbiAgICAgICAgICAgIGlmIChyWSA8IGxvd2VyWSkgbG93ZXJZID0gclk7XHJcbiAgICAgICAgICAgIGlmIChyWCA+IHVwcGVyWCkgdXBwZXJYID0gclg7XHJcbiAgICAgICAgICAgIGlmIChyWSA+IHVwcGVyWSkgdXBwZXJZID0gclk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIGFyZWEgPSAodXBwZXJYIC0gbG93ZXJYKSAqICh1cHBlclkgLSBsb3dlclkpO1xyXG4gICAgICAgICBpZiAoYXJlYSA8IDAuOTUgKiBtaW5BcmVhKSB7XHJcbiAgICAgICAgICAgIG1pbkFyZWEgPSBhcmVhO1xyXG4gICAgICAgICAgICBvYmIuUi5jb2wxLnggPSB1eFg7XHJcbiAgICAgICAgICAgIG9iYi5SLmNvbDEueSA9IHV4WTtcclxuICAgICAgICAgICAgb2JiLlIuY29sMi54ID0gdXlYO1xyXG4gICAgICAgICAgICBvYmIuUi5jb2wyLnkgPSB1eVk7XHJcbiAgICAgICAgICAgIHZhciBjZW50ZXJYID0gMC41ICogKGxvd2VyWCArIHVwcGVyWCk7XHJcbiAgICAgICAgICAgIHZhciBjZW50ZXJZID0gMC41ICogKGxvd2VyWSArIHVwcGVyWSk7XHJcbiAgICAgICAgICAgIHZhciB0TWF0ID0gb2JiLlI7XHJcbiAgICAgICAgICAgIG9iYi5jZW50ZXIueCA9IHJvb3QueCArICh0TWF0LmNvbDEueCAqIGNlbnRlclggKyB0TWF0LmNvbDIueCAqIGNlbnRlclkpO1xyXG4gICAgICAgICAgICBvYmIuY2VudGVyLnkgPSByb290LnkgKyAodE1hdC5jb2wxLnkgKiBjZW50ZXJYICsgdE1hdC5jb2wyLnkgKiBjZW50ZXJZKTtcclxuICAgICAgICAgICAgb2JiLmV4dGVudHMueCA9IDAuNSAqICh1cHBlclggLSBsb3dlclgpO1xyXG4gICAgICAgICAgICBvYmIuZXh0ZW50cy55ID0gMC41ICogKHVwcGVyWSAtIGxvd2VyWSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyUG9seWdvblNoYXBlLnNfbWF0ID0gbmV3IGIyTWF0MjIoKTtcclxuICAgfSk7XHJcbiAgIGIyU2hhcGUuYjJTaGFwZSA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMlNoYXBlLnByb3RvdHlwZS5Db3B5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgfVxyXG4gICBiMlNoYXBlLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgdGhpcy5tX3JhZGl1cyA9IG90aGVyLm1fcmFkaXVzO1xyXG4gICB9XHJcbiAgIGIyU2hhcGUucHJvdG90eXBlLkdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdHlwZTtcclxuICAgfVxyXG4gICBiMlNoYXBlLnByb3RvdHlwZS5UZXN0UG9pbnQgPSBmdW5jdGlvbiAoeGYsIHApIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICB9XHJcbiAgIGIyU2hhcGUucHJvdG90eXBlLlJheUNhc3QgPSBmdW5jdGlvbiAob3V0cHV0LCBpbnB1dCwgdHJhbnNmb3JtKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgfVxyXG4gICBiMlNoYXBlLnByb3RvdHlwZS5Db21wdXRlQUFCQiA9IGZ1bmN0aW9uIChhYWJiLCB4Zikge31cclxuICAgYjJTaGFwZS5wcm90b3R5cGUuQ29tcHV0ZU1hc3MgPSBmdW5jdGlvbiAobWFzc0RhdGEsIGRlbnNpdHkpIHtcclxuICAgICAgaWYgKGRlbnNpdHkgPT09IHVuZGVmaW5lZCkgZGVuc2l0eSA9IDA7XHJcbiAgIH1cclxuICAgYjJTaGFwZS5wcm90b3R5cGUuQ29tcHV0ZVN1Ym1lcmdlZEFyZWEgPSBmdW5jdGlvbiAobm9ybWFsLCBvZmZzZXQsIHhmLCBjKSB7XHJcbiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDtcclxuICAgICAgcmV0dXJuIDA7XHJcbiAgIH1cclxuICAgYjJTaGFwZS5UZXN0T3ZlcmxhcCA9IGZ1bmN0aW9uIChzaGFwZTEsIHRyYW5zZm9ybTEsIHNoYXBlMiwgdHJhbnNmb3JtMikge1xyXG4gICAgICB2YXIgaW5wdXQgPSBuZXcgYjJEaXN0YW5jZUlucHV0KCk7XHJcbiAgICAgIGlucHV0LnByb3h5QSA9IG5ldyBiMkRpc3RhbmNlUHJveHkoKTtcclxuICAgICAgaW5wdXQucHJveHlBLlNldChzaGFwZTEpO1xyXG4gICAgICBpbnB1dC5wcm94eUIgPSBuZXcgYjJEaXN0YW5jZVByb3h5KCk7XHJcbiAgICAgIGlucHV0LnByb3h5Qi5TZXQoc2hhcGUyKTtcclxuICAgICAgaW5wdXQudHJhbnNmb3JtQSA9IHRyYW5zZm9ybTE7XHJcbiAgICAgIGlucHV0LnRyYW5zZm9ybUIgPSB0cmFuc2Zvcm0yO1xyXG4gICAgICBpbnB1dC51c2VSYWRpaSA9IHRydWU7XHJcbiAgICAgIHZhciBzaW1wbGV4Q2FjaGUgPSBuZXcgYjJTaW1wbGV4Q2FjaGUoKTtcclxuICAgICAgc2ltcGxleENhY2hlLmNvdW50ID0gMDtcclxuICAgICAgdmFyIG91dHB1dCA9IG5ldyBiMkRpc3RhbmNlT3V0cHV0KCk7XHJcbiAgICAgIGIyRGlzdGFuY2UuRGlzdGFuY2Uob3V0cHV0LCBzaW1wbGV4Q2FjaGUsIGlucHV0KTtcclxuICAgICAgcmV0dXJuIG91dHB1dC5kaXN0YW5jZSA8IDEwLjAgKiBOdW1iZXIuTUlOX1ZBTFVFO1xyXG4gICB9XHJcbiAgIGIyU2hhcGUucHJvdG90eXBlLmIyU2hhcGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV90eXBlID0gYjJTaGFwZS5lX3Vua25vd25TaGFwZTtcclxuICAgICAgdGhpcy5tX3JhZGl1cyA9IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmVfdW5rbm93blNoYXBlID0gcGFyc2VJbnQoKC0xKSk7XHJcbiAgICAgIEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZS5lX2NpcmNsZVNoYXBlID0gMDtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmVfcG9seWdvblNoYXBlID0gMTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmVfZWRnZVNoYXBlID0gMjtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmVfc2hhcGVUeXBlQ291bnQgPSAzO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuZV9oaXRDb2xsaWRlID0gMTtcclxuICAgICAgQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlNoYXBlLmVfbWlzc0NvbGxpZGUgPSAwO1xyXG4gICAgICBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUuZV9zdGFydHNJbnNpZGVDb2xsaWRlID0gcGFyc2VJbnQoKC0xKSk7XHJcbiAgIH0pO1xyXG59KSgpO1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxyXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXHJcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcclxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXHJcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxyXG4gICAgICBiMk1hdGggPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGgsXHJcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxyXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxyXG4gICAgICBiMlZlYzIgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIsXHJcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMztcclxuXHJcbiAgIGIyQ29sb3IuYjJDb2xvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fciA9IDA7XHJcbiAgICAgIHRoaXMuX2cgPSAwO1xyXG4gICAgICB0aGlzLl9iID0gMDtcclxuICAgfTtcclxuICAgYjJDb2xvci5wcm90b3R5cGUuYjJDb2xvciA9IGZ1bmN0aW9uIChyciwgZ2csIGJiKSB7XHJcbiAgICAgIGlmIChyciA9PT0gdW5kZWZpbmVkKSByciA9IDA7XHJcbiAgICAgIGlmIChnZyA9PT0gdW5kZWZpbmVkKSBnZyA9IDA7XHJcbiAgICAgIGlmIChiYiA9PT0gdW5kZWZpbmVkKSBiYiA9IDA7XHJcbiAgICAgIHRoaXMuX3IgPSBCb3gyRC5wYXJzZVVJbnQoMjU1ICogYjJNYXRoLkNsYW1wKHJyLCAwLjAsIDEuMCkpO1xyXG4gICAgICB0aGlzLl9nID0gQm94MkQucGFyc2VVSW50KDI1NSAqIGIyTWF0aC5DbGFtcChnZywgMC4wLCAxLjApKTtcclxuICAgICAgdGhpcy5fYiA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAoYmIsIDAuMCwgMS4wKSk7XHJcbiAgIH1cclxuICAgYjJDb2xvci5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHJyLCBnZywgYmIpIHtcclxuICAgICAgaWYgKHJyID09PSB1bmRlZmluZWQpIHJyID0gMDtcclxuICAgICAgaWYgKGdnID09PSB1bmRlZmluZWQpIGdnID0gMDtcclxuICAgICAgaWYgKGJiID09PSB1bmRlZmluZWQpIGJiID0gMDtcclxuICAgICAgdGhpcy5fciA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAocnIsIDAuMCwgMS4wKSk7XHJcbiAgICAgIHRoaXMuX2cgPSBCb3gyRC5wYXJzZVVJbnQoMjU1ICogYjJNYXRoLkNsYW1wKGdnLCAwLjAsIDEuMCkpO1xyXG4gICAgICB0aGlzLl9iID0gQm94MkQucGFyc2VVSW50KDI1NSAqIGIyTWF0aC5DbGFtcChiYiwgMC4wLCAxLjApKTtcclxuICAgfVxyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYjJDb2xvci5wcm90b3R5cGUsICdyJywge1xyXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICBzZXQ6IGZ1bmN0aW9uIChycikge1xyXG4gICAgICAgICBpZiAocnIgPT09IHVuZGVmaW5lZCkgcnIgPSAwO1xyXG4gICAgICAgICB0aGlzLl9yID0gQm94MkQucGFyc2VVSW50KDI1NSAqIGIyTWF0aC5DbGFtcChyciwgMC4wLCAxLjApKTtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGIyQ29sb3IucHJvdG90eXBlLCAnZycsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgc2V0OiBmdW5jdGlvbiAoZ2cpIHtcclxuICAgICAgICAgaWYgKGdnID09PSB1bmRlZmluZWQpIGdnID0gMDtcclxuICAgICAgICAgdGhpcy5fZyA9IEJveDJELnBhcnNlVUludCgyNTUgKiBiMk1hdGguQ2xhbXAoZ2csIDAuMCwgMS4wKSk7XHJcbiAgICAgIH1cclxuICAgfSk7XHJcbiAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShiMkNvbG9yLnByb3RvdHlwZSwgJ2InLCB7XHJcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgIHNldDogZnVuY3Rpb24gKGJiKSB7XHJcbiAgICAgICAgIGlmIChiYiA9PT0gdW5kZWZpbmVkKSBiYiA9IDA7XHJcbiAgICAgICAgIHRoaXMuX2IgPSBCb3gyRC5wYXJzZVVJbnQoMjU1ICogYjJNYXRoLkNsYW1wKGJiLCAwLjAsIDEuMCkpO1xyXG4gICAgICB9XHJcbiAgIH0pO1xyXG4gICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYjJDb2xvci5wcm90b3R5cGUsICdjb2xvcicsIHtcclxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgIHJldHVybiAodGhpcy5fciA8PCAxNikgfCAodGhpcy5fZyA8PCA4KSB8ICh0aGlzLl9iKTtcclxuICAgICAgfVxyXG4gICB9KTtcclxuICAgYjJTZXR0aW5ncy5iMlNldHRpbmdzID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyU2V0dGluZ3MuYjJNaXhGcmljdGlvbiA9IGZ1bmN0aW9uIChmcmljdGlvbjEsIGZyaWN0aW9uMikge1xyXG4gICAgICBpZiAoZnJpY3Rpb24xID09PSB1bmRlZmluZWQpIGZyaWN0aW9uMSA9IDA7XHJcbiAgICAgIGlmIChmcmljdGlvbjIgPT09IHVuZGVmaW5lZCkgZnJpY3Rpb24yID0gMDtcclxuICAgICAgcmV0dXJuIE1hdGguc3FydChmcmljdGlvbjEgKiBmcmljdGlvbjIpO1xyXG4gICB9XHJcbiAgIGIyU2V0dGluZ3MuYjJNaXhSZXN0aXR1dGlvbiA9IGZ1bmN0aW9uIChyZXN0aXR1dGlvbjEsIHJlc3RpdHV0aW9uMikge1xyXG4gICAgICBpZiAocmVzdGl0dXRpb24xID09PSB1bmRlZmluZWQpIHJlc3RpdHV0aW9uMSA9IDA7XHJcbiAgICAgIGlmIChyZXN0aXR1dGlvbjIgPT09IHVuZGVmaW5lZCkgcmVzdGl0dXRpb24yID0gMDtcclxuICAgICAgcmV0dXJuIHJlc3RpdHV0aW9uMSA+IHJlc3RpdHV0aW9uMiA/IHJlc3RpdHV0aW9uMSA6IHJlc3RpdHV0aW9uMjtcclxuICAgfVxyXG4gICBiMlNldHRpbmdzLmIyQXNzZXJ0ID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgaWYgKCFhKSB7XHJcbiAgICAgICAgIHRocm93IFwiQXNzZXJ0aW9uIEZhaWxlZFwiO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLlZFUlNJT04gPSBcIjIuMWFscGhhXCI7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLlVTSFJUX01BWCA9IDB4MDAwMGZmZmY7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX3BpID0gTWF0aC5QSTtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHMgPSAyO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9hYWJiRXh0ZW5zaW9uID0gMC4xO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9hYWJiTXVsdGlwbGllciA9IDIuMDtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfcG9seWdvblJhZGl1cyA9IDIuMCAqIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCA9IDAuMDA1O1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcCA9IDIuMCAvIDE4MC4wICogYjJTZXR0aW5ncy5iMl9waTtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfdG9pU2xvcCA9IDguMCAqIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4VE9JQ29udGFjdHNQZXJJc2xhbmQgPSAzMjtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4VE9JSm9pbnRzUGVySXNsYW5kID0gMzI7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX3ZlbG9jaXR5VGhyZXNob2xkID0gMS4wO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uID0gMC4yO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhBbmd1bGFyQ29ycmVjdGlvbiA9IDguMCAvIDE4MC4wICogYjJTZXR0aW5ncy5iMl9waTtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gPSAyLjA7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX21heFRyYW5zbGF0aW9uU3F1YXJlZCA9IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gKiBiMlNldHRpbmdzLmIyX21heFRyYW5zbGF0aW9uO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9tYXhSb3RhdGlvbiA9IDAuNSAqIGIyU2V0dGluZ3MuYjJfcGk7XHJcbiAgICAgIEJveDJELkNvbW1vbi5iMlNldHRpbmdzLmIyX21heFJvdGF0aW9uU3F1YXJlZCA9IGIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb24gKiBiMlNldHRpbmdzLmIyX21heFJvdGF0aW9uO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9jb250YWN0QmF1bWdhcnRlID0gMC4yO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl90aW1lVG9TbGVlcCA9IDAuNTtcclxuICAgICAgQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MuYjJfbGluZWFyU2xlZXBUb2xlcmFuY2UgPSAwLjAxO1xyXG4gICAgICBCb3gyRC5Db21tb24uYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xlZXBUb2xlcmFuY2UgPSAyLjAgLyAxODAuMCAqIGIyU2V0dGluZ3MuYjJfcGk7XHJcbiAgIH0pO1xyXG59KSgpO1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYjJBQUJCID0gQm94MkQuQ29sbGlzaW9uLmIyQUFCQixcclxuICAgICAgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxyXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXHJcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcclxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXHJcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxyXG4gICAgICBiMk1hdGggPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGgsXHJcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxyXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxyXG4gICAgICBiMlZlYzIgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIsXHJcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMztcclxuXHJcbiAgIGIyTWF0MjIuYjJNYXQyMiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jb2wxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmNvbDIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyTWF0MjIucHJvdG90eXBlLmIyTWF0MjIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuU2V0SWRlbnRpdHkoKTtcclxuICAgfVxyXG4gICBiMk1hdDIyLkZyb21BbmdsZSA9IGZ1bmN0aW9uIChhbmdsZSkge1xyXG4gICAgICBpZiAoYW5nbGUgPT09IHVuZGVmaW5lZCkgYW5nbGUgPSAwO1xyXG4gICAgICB2YXIgbWF0ID0gbmV3IGIyTWF0MjIoKTtcclxuICAgICAgbWF0LlNldChhbmdsZSk7XHJcbiAgICAgIHJldHVybiBtYXQ7XHJcbiAgIH1cclxuICAgYjJNYXQyMi5Gcm9tVlYgPSBmdW5jdGlvbiAoYzEsIGMyKSB7XHJcbiAgICAgIHZhciBtYXQgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICBtYXQuU2V0VlYoYzEsIGMyKTtcclxuICAgICAgcmV0dXJuIG1hdDtcclxuICAgfVxyXG4gICBiMk1hdDIyLnByb3RvdHlwZS5TZXQgPSBmdW5jdGlvbiAoYW5nbGUpIHtcclxuICAgICAgaWYgKGFuZ2xlID09PSB1bmRlZmluZWQpIGFuZ2xlID0gMDtcclxuICAgICAgdmFyIGMgPSBNYXRoLmNvcyhhbmdsZSk7XHJcbiAgICAgIHZhciBzID0gTWF0aC5zaW4oYW5nbGUpO1xyXG4gICAgICB0aGlzLmNvbDEueCA9IGM7XHJcbiAgICAgIHRoaXMuY29sMi54ID0gKC1zKTtcclxuICAgICAgdGhpcy5jb2wxLnkgPSBzO1xyXG4gICAgICB0aGlzLmNvbDIueSA9IGM7XHJcbiAgIH1cclxuICAgYjJNYXQyMi5wcm90b3R5cGUuU2V0VlYgPSBmdW5jdGlvbiAoYzEsIGMyKSB7XHJcbiAgICAgIHRoaXMuY29sMS5TZXRWKGMxKTtcclxuICAgICAgdGhpcy5jb2wyLlNldFYoYzIpO1xyXG4gICB9XHJcbiAgIGIyTWF0MjIucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBtYXQgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICBtYXQuU2V0TSh0aGlzKTtcclxuICAgICAgcmV0dXJuIG1hdDtcclxuICAgfVxyXG4gICBiMk1hdDIyLnByb3RvdHlwZS5TZXRNID0gZnVuY3Rpb24gKG0pIHtcclxuICAgICAgdGhpcy5jb2wxLlNldFYobS5jb2wxKTtcclxuICAgICAgdGhpcy5jb2wyLlNldFYobS5jb2wyKTtcclxuICAgfVxyXG4gICBiMk1hdDIyLnByb3RvdHlwZS5BZGRNID0gZnVuY3Rpb24gKG0pIHtcclxuICAgICAgdGhpcy5jb2wxLnggKz0gbS5jb2wxLng7XHJcbiAgICAgIHRoaXMuY29sMS55ICs9IG0uY29sMS55O1xyXG4gICAgICB0aGlzLmNvbDIueCArPSBtLmNvbDIueDtcclxuICAgICAgdGhpcy5jb2wyLnkgKz0gbS5jb2wyLnk7XHJcbiAgIH1cclxuICAgYjJNYXQyMi5wcm90b3R5cGUuU2V0SWRlbnRpdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuY29sMS54ID0gMS4wO1xyXG4gICAgICB0aGlzLmNvbDIueCA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wxLnkgPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMi55ID0gMS4wO1xyXG4gICB9XHJcbiAgIGIyTWF0MjIucHJvdG90eXBlLlNldFplcm8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuY29sMS54ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDIueCA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wxLnkgPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMi55ID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyTWF0MjIucHJvdG90eXBlLkdldEFuZ2xlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gTWF0aC5hdGFuMih0aGlzLmNvbDEueSwgdGhpcy5jb2wxLngpO1xyXG4gICB9XHJcbiAgIGIyTWF0MjIucHJvdG90eXBlLkdldEludmVyc2UgPSBmdW5jdGlvbiAob3V0KSB7XHJcbiAgICAgIHZhciBhID0gdGhpcy5jb2wxLng7XHJcbiAgICAgIHZhciBiID0gdGhpcy5jb2wyLng7XHJcbiAgICAgIHZhciBjID0gdGhpcy5jb2wxLnk7XHJcbiAgICAgIHZhciBkID0gdGhpcy5jb2wyLnk7XHJcbiAgICAgIHZhciBkZXQgPSBhICogZCAtIGIgKiBjO1xyXG4gICAgICBpZiAoZGV0ICE9IDAuMCkge1xyXG4gICAgICAgICBkZXQgPSAxLjAgLyBkZXQ7XHJcbiAgICAgIH1cclxuICAgICAgb3V0LmNvbDEueCA9IGRldCAqIGQ7XHJcbiAgICAgIG91dC5jb2wyLnggPSAoLWRldCAqIGIpO1xyXG4gICAgICBvdXQuY29sMS55ID0gKC1kZXQgKiBjKTtcclxuICAgICAgb3V0LmNvbDIueSA9IGRldCAqIGE7XHJcbiAgICAgIHJldHVybiBvdXQ7XHJcbiAgIH1cclxuICAgYjJNYXQyMi5wcm90b3R5cGUuU29sdmUgPSBmdW5jdGlvbiAob3V0LCBiWCwgYlkpIHtcclxuICAgICAgaWYgKGJYID09PSB1bmRlZmluZWQpIGJYID0gMDtcclxuICAgICAgaWYgKGJZID09PSB1bmRlZmluZWQpIGJZID0gMDtcclxuICAgICAgdmFyIGExMSA9IHRoaXMuY29sMS54O1xyXG4gICAgICB2YXIgYTEyID0gdGhpcy5jb2wyLng7XHJcbiAgICAgIHZhciBhMjEgPSB0aGlzLmNvbDEueTtcclxuICAgICAgdmFyIGEyMiA9IHRoaXMuY29sMi55O1xyXG4gICAgICB2YXIgZGV0ID0gYTExICogYTIyIC0gYTEyICogYTIxO1xyXG4gICAgICBpZiAoZGV0ICE9IDAuMCkge1xyXG4gICAgICAgICBkZXQgPSAxLjAgLyBkZXQ7XHJcbiAgICAgIH1cclxuICAgICAgb3V0LnggPSBkZXQgKiAoYTIyICogYlggLSBhMTIgKiBiWSk7XHJcbiAgICAgIG91dC55ID0gZGV0ICogKGExMSAqIGJZIC0gYTIxICogYlgpO1xyXG4gICAgICByZXR1cm4gb3V0O1xyXG4gICB9XHJcbiAgIGIyTWF0MjIucHJvdG90eXBlLkFicyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jb2wxLkFicygpO1xyXG4gICAgICB0aGlzLmNvbDIuQWJzKCk7XHJcbiAgIH1cclxuICAgYjJNYXQzMy5iMk1hdDMzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNvbDEgPSBuZXcgYjJWZWMzKCk7XHJcbiAgICAgIHRoaXMuY29sMiA9IG5ldyBiMlZlYzMoKTtcclxuICAgICAgdGhpcy5jb2wzID0gbmV3IGIyVmVjMygpO1xyXG4gICB9O1xyXG4gICBiMk1hdDMzLnByb3RvdHlwZS5iMk1hdDMzID0gZnVuY3Rpb24gKGMxLCBjMiwgYzMpIHtcclxuICAgICAgaWYgKGMxID09PSB1bmRlZmluZWQpIGMxID0gbnVsbDtcclxuICAgICAgaWYgKGMyID09PSB1bmRlZmluZWQpIGMyID0gbnVsbDtcclxuICAgICAgaWYgKGMzID09PSB1bmRlZmluZWQpIGMzID0gbnVsbDtcclxuICAgICAgaWYgKCFjMSAmJiAhYzIgJiYgIWMzKSB7XHJcbiAgICAgICAgIHRoaXMuY29sMS5TZXRaZXJvKCk7XHJcbiAgICAgICAgIHRoaXMuY29sMi5TZXRaZXJvKCk7XHJcbiAgICAgICAgIHRoaXMuY29sMy5TZXRaZXJvKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMuY29sMS5TZXRWKGMxKTtcclxuICAgICAgICAgdGhpcy5jb2wyLlNldFYoYzIpO1xyXG4gICAgICAgICB0aGlzLmNvbDMuU2V0VihjMyk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMk1hdDMzLnByb3RvdHlwZS5TZXRWVlYgPSBmdW5jdGlvbiAoYzEsIGMyLCBjMykge1xyXG4gICAgICB0aGlzLmNvbDEuU2V0VihjMSk7XHJcbiAgICAgIHRoaXMuY29sMi5TZXRWKGMyKTtcclxuICAgICAgdGhpcy5jb2wzLlNldFYoYzMpO1xyXG4gICB9XHJcbiAgIGIyTWF0MzMucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBuZXcgYjJNYXQzMyh0aGlzLmNvbDEsIHRoaXMuY29sMiwgdGhpcy5jb2wzKTtcclxuICAgfVxyXG4gICBiMk1hdDMzLnByb3RvdHlwZS5TZXRNID0gZnVuY3Rpb24gKG0pIHtcclxuICAgICAgdGhpcy5jb2wxLlNldFYobS5jb2wxKTtcclxuICAgICAgdGhpcy5jb2wyLlNldFYobS5jb2wyKTtcclxuICAgICAgdGhpcy5jb2wzLlNldFYobS5jb2wzKTtcclxuICAgfVxyXG4gICBiMk1hdDMzLnByb3RvdHlwZS5BZGRNID0gZnVuY3Rpb24gKG0pIHtcclxuICAgICAgdGhpcy5jb2wxLnggKz0gbS5jb2wxLng7XHJcbiAgICAgIHRoaXMuY29sMS55ICs9IG0uY29sMS55O1xyXG4gICAgICB0aGlzLmNvbDEueiArPSBtLmNvbDEuejtcclxuICAgICAgdGhpcy5jb2wyLnggKz0gbS5jb2wyLng7XHJcbiAgICAgIHRoaXMuY29sMi55ICs9IG0uY29sMi55O1xyXG4gICAgICB0aGlzLmNvbDIueiArPSBtLmNvbDIuejtcclxuICAgICAgdGhpcy5jb2wzLnggKz0gbS5jb2wzLng7XHJcbiAgICAgIHRoaXMuY29sMy55ICs9IG0uY29sMy55O1xyXG4gICAgICB0aGlzLmNvbDMueiArPSBtLmNvbDMuejtcclxuICAgfVxyXG4gICBiMk1hdDMzLnByb3RvdHlwZS5TZXRJZGVudGl0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5jb2wxLnggPSAxLjA7XHJcbiAgICAgIHRoaXMuY29sMi54ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDMueCA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wxLnkgPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMi55ID0gMS4wO1xyXG4gICAgICB0aGlzLmNvbDMueSA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wxLnogPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMi56ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDMueiA9IDEuMDtcclxuICAgfVxyXG4gICBiMk1hdDMzLnByb3RvdHlwZS5TZXRaZXJvID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmNvbDEueCA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wyLnggPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMy54ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDEueSA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wyLnkgPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMy55ID0gMC4wO1xyXG4gICAgICB0aGlzLmNvbDEueiA9IDAuMDtcclxuICAgICAgdGhpcy5jb2wyLnogPSAwLjA7XHJcbiAgICAgIHRoaXMuY29sMy56ID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyTWF0MzMucHJvdG90eXBlLlNvbHZlMjIgPSBmdW5jdGlvbiAob3V0LCBiWCwgYlkpIHtcclxuICAgICAgaWYgKGJYID09PSB1bmRlZmluZWQpIGJYID0gMDtcclxuICAgICAgaWYgKGJZID09PSB1bmRlZmluZWQpIGJZID0gMDtcclxuICAgICAgdmFyIGExMSA9IHRoaXMuY29sMS54O1xyXG4gICAgICB2YXIgYTEyID0gdGhpcy5jb2wyLng7XHJcbiAgICAgIHZhciBhMjEgPSB0aGlzLmNvbDEueTtcclxuICAgICAgdmFyIGEyMiA9IHRoaXMuY29sMi55O1xyXG4gICAgICB2YXIgZGV0ID0gYTExICogYTIyIC0gYTEyICogYTIxO1xyXG4gICAgICBpZiAoZGV0ICE9IDAuMCkge1xyXG4gICAgICAgICBkZXQgPSAxLjAgLyBkZXQ7XHJcbiAgICAgIH1cclxuICAgICAgb3V0LnggPSBkZXQgKiAoYTIyICogYlggLSBhMTIgKiBiWSk7XHJcbiAgICAgIG91dC55ID0gZGV0ICogKGExMSAqIGJZIC0gYTIxICogYlgpO1xyXG4gICAgICByZXR1cm4gb3V0O1xyXG4gICB9XHJcbiAgIGIyTWF0MzMucHJvdG90eXBlLlNvbHZlMzMgPSBmdW5jdGlvbiAob3V0LCBiWCwgYlksIGJaKSB7XHJcbiAgICAgIGlmIChiWCA9PT0gdW5kZWZpbmVkKSBiWCA9IDA7XHJcbiAgICAgIGlmIChiWSA9PT0gdW5kZWZpbmVkKSBiWSA9IDA7XHJcbiAgICAgIGlmIChiWiA9PT0gdW5kZWZpbmVkKSBiWiA9IDA7XHJcbiAgICAgIHZhciBhMTEgPSB0aGlzLmNvbDEueDtcclxuICAgICAgdmFyIGEyMSA9IHRoaXMuY29sMS55O1xyXG4gICAgICB2YXIgYTMxID0gdGhpcy5jb2wxLno7XHJcbiAgICAgIHZhciBhMTIgPSB0aGlzLmNvbDIueDtcclxuICAgICAgdmFyIGEyMiA9IHRoaXMuY29sMi55O1xyXG4gICAgICB2YXIgYTMyID0gdGhpcy5jb2wyLno7XHJcbiAgICAgIHZhciBhMTMgPSB0aGlzLmNvbDMueDtcclxuICAgICAgdmFyIGEyMyA9IHRoaXMuY29sMy55O1xyXG4gICAgICB2YXIgYTMzID0gdGhpcy5jb2wzLno7XHJcbiAgICAgIHZhciBkZXQgPSBhMTEgKiAoYTIyICogYTMzIC0gYTMyICogYTIzKSArIGEyMSAqIChhMzIgKiBhMTMgLSBhMTIgKiBhMzMpICsgYTMxICogKGExMiAqIGEyMyAtIGEyMiAqIGExMyk7XHJcbiAgICAgIGlmIChkZXQgIT0gMC4wKSB7XHJcbiAgICAgICAgIGRldCA9IDEuMCAvIGRldDtcclxuICAgICAgfVxyXG4gICAgICBvdXQueCA9IGRldCAqIChiWCAqIChhMjIgKiBhMzMgLSBhMzIgKiBhMjMpICsgYlkgKiAoYTMyICogYTEzIC0gYTEyICogYTMzKSArIGJaICogKGExMiAqIGEyMyAtIGEyMiAqIGExMykpO1xyXG4gICAgICBvdXQueSA9IGRldCAqIChhMTEgKiAoYlkgKiBhMzMgLSBiWiAqIGEyMykgKyBhMjEgKiAoYlogKiBhMTMgLSBiWCAqIGEzMykgKyBhMzEgKiAoYlggKiBhMjMgLSBiWSAqIGExMykpO1xyXG4gICAgICBvdXQueiA9IGRldCAqIChhMTEgKiAoYTIyICogYlogLSBhMzIgKiBiWSkgKyBhMjEgKiAoYTMyICogYlggLSBhMTIgKiBiWikgKyBhMzEgKiAoYTEyICogYlkgLSBhMjIgKiBiWCkpO1xyXG4gICAgICByZXR1cm4gb3V0O1xyXG4gICB9XHJcbiAgIGIyTWF0aC5iMk1hdGggPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJNYXRoLklzVmFsaWQgPSBmdW5jdGlvbiAoeCkge1xyXG4gICAgICBpZiAoeCA9PT0gdW5kZWZpbmVkKSB4ID0gMDtcclxuICAgICAgcmV0dXJuIGlzRmluaXRlKHgpO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5Eb3QgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICByZXR1cm4gYS54ICogYi54ICsgYS55ICogYi55O1xyXG4gICB9XHJcbiAgIGIyTWF0aC5Dcm9zc1ZWID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgcmV0dXJuIGEueCAqIGIueSAtIGEueSAqIGIueDtcclxuICAgfVxyXG4gICBiMk1hdGguQ3Jvc3NWRiA9IGZ1bmN0aW9uIChhLCBzKSB7XHJcbiAgICAgIGlmIChzID09PSB1bmRlZmluZWQpIHMgPSAwO1xyXG4gICAgICB2YXIgdiA9IG5ldyBiMlZlYzIocyAqIGEueSwgKC1zICogYS54KSk7XHJcbiAgICAgIHJldHVybiB2O1xyXG4gICB9XHJcbiAgIGIyTWF0aC5Dcm9zc0ZWID0gZnVuY3Rpb24gKHMsIGEpIHtcclxuICAgICAgaWYgKHMgPT09IHVuZGVmaW5lZCkgcyA9IDA7XHJcbiAgICAgIHZhciB2ID0gbmV3IGIyVmVjMigoLXMgKiBhLnkpLCBzICogYS54KTtcclxuICAgICAgcmV0dXJuIHY7XHJcbiAgIH1cclxuICAgYjJNYXRoLk11bE1WID0gZnVuY3Rpb24gKEEsIHYpIHtcclxuICAgICAgdmFyIHUgPSBuZXcgYjJWZWMyKEEuY29sMS54ICogdi54ICsgQS5jb2wyLnggKiB2LnksIEEuY29sMS55ICogdi54ICsgQS5jb2wyLnkgKiB2LnkpO1xyXG4gICAgICByZXR1cm4gdTtcclxuICAgfVxyXG4gICBiMk1hdGguTXVsVE1WID0gZnVuY3Rpb24gKEEsIHYpIHtcclxuICAgICAgdmFyIHUgPSBuZXcgYjJWZWMyKGIyTWF0aC5Eb3QodiwgQS5jb2wxKSwgYjJNYXRoLkRvdCh2LCBBLmNvbDIpKTtcclxuICAgICAgcmV0dXJuIHU7XHJcbiAgIH1cclxuICAgYjJNYXRoLk11bFggPSBmdW5jdGlvbiAoVCwgdikge1xyXG4gICAgICB2YXIgYSA9IGIyTWF0aC5NdWxNVihULlIsIHYpO1xyXG4gICAgICBhLnggKz0gVC5wb3NpdGlvbi54O1xyXG4gICAgICBhLnkgKz0gVC5wb3NpdGlvbi55O1xyXG4gICAgICByZXR1cm4gYTtcclxuICAgfVxyXG4gICBiMk1hdGguTXVsWFQgPSBmdW5jdGlvbiAoVCwgdikge1xyXG4gICAgICB2YXIgYSA9IGIyTWF0aC5TdWJ0cmFjdFZWKHYsIFQucG9zaXRpb24pO1xyXG4gICAgICB2YXIgdFggPSAoYS54ICogVC5SLmNvbDEueCArIGEueSAqIFQuUi5jb2wxLnkpO1xyXG4gICAgICBhLnkgPSAoYS54ICogVC5SLmNvbDIueCArIGEueSAqIFQuUi5jb2wyLnkpO1xyXG4gICAgICBhLnggPSB0WDtcclxuICAgICAgcmV0dXJuIGE7XHJcbiAgIH1cclxuICAgYjJNYXRoLkFkZFZWID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgdmFyIHYgPSBuZXcgYjJWZWMyKGEueCArIGIueCwgYS55ICsgYi55KTtcclxuICAgICAgcmV0dXJuIHY7XHJcbiAgIH1cclxuICAgYjJNYXRoLlN1YnRyYWN0VlYgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICB2YXIgdiA9IG5ldyBiMlZlYzIoYS54IC0gYi54LCBhLnkgLSBiLnkpO1xyXG4gICAgICByZXR1cm4gdjtcclxuICAgfVxyXG4gICBiMk1hdGguRGlzdGFuY2UgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICB2YXIgY1ggPSBhLnggLSBiLng7XHJcbiAgICAgIHZhciBjWSA9IGEueSAtIGIueTtcclxuICAgICAgcmV0dXJuIE1hdGguc3FydChjWCAqIGNYICsgY1kgKiBjWSk7XHJcbiAgIH1cclxuICAgYjJNYXRoLkRpc3RhbmNlU3F1YXJlZCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgIHZhciBjWCA9IGEueCAtIGIueDtcclxuICAgICAgdmFyIGNZID0gYS55IC0gYi55O1xyXG4gICAgICByZXR1cm4gKGNYICogY1ggKyBjWSAqIGNZKTtcclxuICAgfVxyXG4gICBiMk1hdGguTXVsRlYgPSBmdW5jdGlvbiAocywgYSkge1xyXG4gICAgICBpZiAocyA9PT0gdW5kZWZpbmVkKSBzID0gMDtcclxuICAgICAgdmFyIHYgPSBuZXcgYjJWZWMyKHMgKiBhLngsIHMgKiBhLnkpO1xyXG4gICAgICByZXR1cm4gdjtcclxuICAgfVxyXG4gICBiMk1hdGguQWRkTU0gPSBmdW5jdGlvbiAoQSwgQikge1xyXG4gICAgICB2YXIgQyA9IGIyTWF0MjIuRnJvbVZWKGIyTWF0aC5BZGRWVihBLmNvbDEsIEIuY29sMSksIGIyTWF0aC5BZGRWVihBLmNvbDIsIEIuY29sMikpO1xyXG4gICAgICByZXR1cm4gQztcclxuICAgfVxyXG4gICBiMk1hdGguTXVsTU0gPSBmdW5jdGlvbiAoQSwgQikge1xyXG4gICAgICB2YXIgQyA9IGIyTWF0MjIuRnJvbVZWKGIyTWF0aC5NdWxNVihBLCBCLmNvbDEpLCBiMk1hdGguTXVsTVYoQSwgQi5jb2wyKSk7XHJcbiAgICAgIHJldHVybiBDO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5NdWxUTU0gPSBmdW5jdGlvbiAoQSwgQikge1xyXG4gICAgICB2YXIgYzEgPSBuZXcgYjJWZWMyKGIyTWF0aC5Eb3QoQS5jb2wxLCBCLmNvbDEpLCBiMk1hdGguRG90KEEuY29sMiwgQi5jb2wxKSk7XHJcbiAgICAgIHZhciBjMiA9IG5ldyBiMlZlYzIoYjJNYXRoLkRvdChBLmNvbDEsIEIuY29sMiksIGIyTWF0aC5Eb3QoQS5jb2wyLCBCLmNvbDIpKTtcclxuICAgICAgdmFyIEMgPSBiMk1hdDIyLkZyb21WVihjMSwgYzIpO1xyXG4gICAgICByZXR1cm4gQztcclxuICAgfVxyXG4gICBiMk1hdGguQWJzID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgaWYgKGEgPT09IHVuZGVmaW5lZCkgYSA9IDA7XHJcbiAgICAgIHJldHVybiBhID4gMC4wID8gYSA6ICgtYSk7XHJcbiAgIH1cclxuICAgYjJNYXRoLkFic1YgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICB2YXIgYiA9IG5ldyBiMlZlYzIoYjJNYXRoLkFicyhhLngpLCBiMk1hdGguQWJzKGEueSkpO1xyXG4gICAgICByZXR1cm4gYjtcclxuICAgfVxyXG4gICBiMk1hdGguQWJzTSA9IGZ1bmN0aW9uIChBKSB7XHJcbiAgICAgIHZhciBCID0gYjJNYXQyMi5Gcm9tVlYoYjJNYXRoLkFic1YoQS5jb2wxKSwgYjJNYXRoLkFic1YoQS5jb2wyKSk7XHJcbiAgICAgIHJldHVybiBCO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5NaW4gPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSBhID0gMDtcclxuICAgICAgaWYgKGIgPT09IHVuZGVmaW5lZCkgYiA9IDA7XHJcbiAgICAgIHJldHVybiBhIDwgYiA/IGEgOiBiO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5NaW5WID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgdmFyIGMgPSBuZXcgYjJWZWMyKGIyTWF0aC5NaW4oYS54LCBiLngpLCBiMk1hdGguTWluKGEueSwgYi55KSk7XHJcbiAgICAgIHJldHVybiBjO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5NYXggPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSBhID0gMDtcclxuICAgICAgaWYgKGIgPT09IHVuZGVmaW5lZCkgYiA9IDA7XHJcbiAgICAgIHJldHVybiBhID4gYiA/IGEgOiBiO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5NYXhWID0gZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgdmFyIGMgPSBuZXcgYjJWZWMyKGIyTWF0aC5NYXgoYS54LCBiLngpLCBiMk1hdGguTWF4KGEueSwgYi55KSk7XHJcbiAgICAgIHJldHVybiBjO1xyXG4gICB9XHJcbiAgIGIyTWF0aC5DbGFtcCA9IGZ1bmN0aW9uIChhLCBsb3csIGhpZ2gpIHtcclxuICAgICAgaWYgKGEgPT09IHVuZGVmaW5lZCkgYSA9IDA7XHJcbiAgICAgIGlmIChsb3cgPT09IHVuZGVmaW5lZCkgbG93ID0gMDtcclxuICAgICAgaWYgKGhpZ2ggPT09IHVuZGVmaW5lZCkgaGlnaCA9IDA7XHJcbiAgICAgIHJldHVybiBhIDwgbG93ID8gbG93IDogYSA+IGhpZ2ggPyBoaWdoIDogYTtcclxuICAgfVxyXG4gICBiMk1hdGguQ2xhbXBWID0gZnVuY3Rpb24gKGEsIGxvdywgaGlnaCkge1xyXG4gICAgICByZXR1cm4gYjJNYXRoLk1heFYobG93LCBiMk1hdGguTWluVihhLCBoaWdoKSk7XHJcbiAgIH1cclxuICAgYjJNYXRoLlN3YXAgPSBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICB2YXIgdG1wID0gYVswXTtcclxuICAgICAgYVswXSA9IGJbMF07XHJcbiAgICAgIGJbMF0gPSB0bXA7XHJcbiAgIH1cclxuICAgYjJNYXRoLlJhbmRvbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiAyIC0gMTtcclxuICAgfVxyXG4gICBiMk1hdGguUmFuZG9tUmFuZ2UgPSBmdW5jdGlvbiAobG8sIGhpKSB7XHJcbiAgICAgIGlmIChsbyA9PT0gdW5kZWZpbmVkKSBsbyA9IDA7XHJcbiAgICAgIGlmIChoaSA9PT0gdW5kZWZpbmVkKSBoaSA9IDA7XHJcbiAgICAgIHZhciByID0gTWF0aC5yYW5kb20oKTtcclxuICAgICAgciA9IChoaSAtIGxvKSAqIHIgKyBsbztcclxuICAgICAgcmV0dXJuIHI7XHJcbiAgIH1cclxuICAgYjJNYXRoLk5leHRQb3dlck9mVHdvID0gZnVuY3Rpb24gKHgpIHtcclxuICAgICAgaWYgKHggPT09IHVuZGVmaW5lZCkgeCA9IDA7XHJcbiAgICAgIHggfD0gKHggPj4gMSkgJiAweDdGRkZGRkZGO1xyXG4gICAgICB4IHw9ICh4ID4+IDIpICYgMHgzRkZGRkZGRjtcclxuICAgICAgeCB8PSAoeCA+PiA0KSAmIDB4MEZGRkZGRkY7XHJcbiAgICAgIHggfD0gKHggPj4gOCkgJiAweDAwRkZGRkZGO1xyXG4gICAgICB4IHw9ICh4ID4+IDE2KSAmIDB4MDAwMEZGRkY7XHJcbiAgICAgIHJldHVybiB4ICsgMTtcclxuICAgfVxyXG4gICBiMk1hdGguSXNQb3dlck9mVHdvID0gZnVuY3Rpb24gKHgpIHtcclxuICAgICAgaWYgKHggPT09IHVuZGVmaW5lZCkgeCA9IDA7XHJcbiAgICAgIHZhciByZXN1bHQgPSB4ID4gMCAmJiAoeCAmICh4IC0gMSkpID09IDA7XHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aC5iMlZlYzJfemVybyA9IG5ldyBiMlZlYzIoMC4wLCAwLjApO1xyXG4gICAgICBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGguYjJNYXQyMl9pZGVudGl0eSA9IGIyTWF0MjIuRnJvbVZWKG5ldyBiMlZlYzIoMS4wLCAwLjApLCBuZXcgYjJWZWMyKDAuMCwgMS4wKSk7XHJcbiAgICAgIEJveDJELkNvbW1vbi5NYXRoLmIyTWF0aC5iMlRyYW5zZm9ybV9pZGVudGl0eSA9IG5ldyBiMlRyYW5zZm9ybShiMk1hdGguYjJWZWMyX3plcm8sIGIyTWF0aC5iMk1hdDIyX2lkZW50aXR5KTtcclxuICAgfSk7XHJcbiAgIGIyU3dlZXAuYjJTd2VlcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5sb2NhbENlbnRlciA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5jMCA9IG5ldyBiMlZlYzI7XHJcbiAgICAgIHRoaXMuYyA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJTd2VlcC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgIHRoaXMubG9jYWxDZW50ZXIuU2V0VihvdGhlci5sb2NhbENlbnRlcik7XHJcbiAgICAgIHRoaXMuYzAuU2V0VihvdGhlci5jMCk7XHJcbiAgICAgIHRoaXMuYy5TZXRWKG90aGVyLmMpO1xyXG4gICAgICB0aGlzLmEwID0gb3RoZXIuYTA7XHJcbiAgICAgIHRoaXMuYSA9IG90aGVyLmE7XHJcbiAgICAgIHRoaXMudDAgPSBvdGhlci50MDtcclxuICAgfVxyXG4gICBiMlN3ZWVwLnByb3RvdHlwZS5Db3B5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgY29weSA9IG5ldyBiMlN3ZWVwKCk7XHJcbiAgICAgIGNvcHkubG9jYWxDZW50ZXIuU2V0Vih0aGlzLmxvY2FsQ2VudGVyKTtcclxuICAgICAgY29weS5jMC5TZXRWKHRoaXMuYzApO1xyXG4gICAgICBjb3B5LmMuU2V0Vih0aGlzLmMpO1xyXG4gICAgICBjb3B5LmEwID0gdGhpcy5hMDtcclxuICAgICAgY29weS5hID0gdGhpcy5hO1xyXG4gICAgICBjb3B5LnQwID0gdGhpcy50MDtcclxuICAgICAgcmV0dXJuIGNvcHk7XHJcbiAgIH1cclxuICAgYjJTd2VlcC5wcm90b3R5cGUuR2V0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHhmLCBhbHBoYSkge1xyXG4gICAgICBpZiAoYWxwaGEgPT09IHVuZGVmaW5lZCkgYWxwaGEgPSAwO1xyXG4gICAgICB4Zi5wb3NpdGlvbi54ID0gKDEuMCAtIGFscGhhKSAqIHRoaXMuYzAueCArIGFscGhhICogdGhpcy5jLng7XHJcbiAgICAgIHhmLnBvc2l0aW9uLnkgPSAoMS4wIC0gYWxwaGEpICogdGhpcy5jMC55ICsgYWxwaGEgKiB0aGlzLmMueTtcclxuICAgICAgdmFyIGFuZ2xlID0gKDEuMCAtIGFscGhhKSAqIHRoaXMuYTAgKyBhbHBoYSAqIHRoaXMuYTtcclxuICAgICAgeGYuUi5TZXQoYW5nbGUpO1xyXG4gICAgICB2YXIgdE1hdCA9IHhmLlI7XHJcbiAgICAgIHhmLnBvc2l0aW9uLnggLT0gKHRNYXQuY29sMS54ICogdGhpcy5sb2NhbENlbnRlci54ICsgdE1hdC5jb2wyLnggKiB0aGlzLmxvY2FsQ2VudGVyLnkpO1xyXG4gICAgICB4Zi5wb3NpdGlvbi55IC09ICh0TWF0LmNvbDEueSAqIHRoaXMubG9jYWxDZW50ZXIueCArIHRNYXQuY29sMi55ICogdGhpcy5sb2NhbENlbnRlci55KTtcclxuICAgfVxyXG4gICBiMlN3ZWVwLnByb3RvdHlwZS5BZHZhbmNlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgaWYgKHQgPT09IHVuZGVmaW5lZCkgdCA9IDA7XHJcbiAgICAgIGlmICh0aGlzLnQwIDwgdCAmJiAxLjAgLSB0aGlzLnQwID4gTnVtYmVyLk1JTl9WQUxVRSkge1xyXG4gICAgICAgICB2YXIgYWxwaGEgPSAodCAtIHRoaXMudDApIC8gKDEuMCAtIHRoaXMudDApO1xyXG4gICAgICAgICB0aGlzLmMwLnggPSAoMS4wIC0gYWxwaGEpICogdGhpcy5jMC54ICsgYWxwaGEgKiB0aGlzLmMueDtcclxuICAgICAgICAgdGhpcy5jMC55ID0gKDEuMCAtIGFscGhhKSAqIHRoaXMuYzAueSArIGFscGhhICogdGhpcy5jLnk7XHJcbiAgICAgICAgIHRoaXMuYTAgPSAoMS4wIC0gYWxwaGEpICogdGhpcy5hMCArIGFscGhhICogdGhpcy5hO1xyXG4gICAgICAgICB0aGlzLnQwID0gdDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyVHJhbnNmb3JtLmIyVHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnBvc2l0aW9uID0gbmV3IGIyVmVjMjtcclxuICAgICAgdGhpcy5SID0gbmV3IGIyTWF0MjIoKTtcclxuICAgfTtcclxuICAgYjJUcmFuc2Zvcm0ucHJvdG90eXBlLmIyVHJhbnNmb3JtID0gZnVuY3Rpb24gKHBvcywgcikge1xyXG4gICAgICBpZiAocG9zID09PSB1bmRlZmluZWQpIHBvcyA9IG51bGw7XHJcbiAgICAgIGlmIChyID09PSB1bmRlZmluZWQpIHIgPSBudWxsO1xyXG4gICAgICBpZiAocG9zKSB7XHJcbiAgICAgICAgIHRoaXMucG9zaXRpb24uU2V0Vihwb3MpO1xyXG4gICAgICAgICB0aGlzLlIuU2V0TShyKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyVHJhbnNmb3JtLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKHBvcywgcikge1xyXG4gICAgICB0aGlzLnBvc2l0aW9uLlNldFYocG9zKTtcclxuICAgICAgdGhpcy5SLlNldE0ocik7XHJcbiAgIH1cclxuICAgYjJUcmFuc2Zvcm0ucHJvdG90eXBlLlNldElkZW50aXR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnBvc2l0aW9uLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5SLlNldElkZW50aXR5KCk7XHJcbiAgIH1cclxuICAgYjJUcmFuc2Zvcm0ucHJvdG90eXBlLlNldCA9IGZ1bmN0aW9uICh4KSB7XHJcbiAgICAgIHRoaXMucG9zaXRpb24uU2V0Vih4LnBvc2l0aW9uKTtcclxuICAgICAgdGhpcy5SLlNldE0oeC5SKTtcclxuICAgfVxyXG4gICBiMlRyYW5zZm9ybS5wcm90b3R5cGUuR2V0QW5nbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBNYXRoLmF0YW4yKHRoaXMuUi5jb2wxLnksIHRoaXMuUi5jb2wxLngpO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5iMlZlYzIgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJWZWMyLnByb3RvdHlwZS5iMlZlYzIgPSBmdW5jdGlvbiAoeF8sIHlfKSB7XHJcbiAgICAgIGlmICh4XyA9PT0gdW5kZWZpbmVkKSB4XyA9IDA7XHJcbiAgICAgIGlmICh5XyA9PT0gdW5kZWZpbmVkKSB5XyA9IDA7XHJcbiAgICAgIHRoaXMueCA9IHhfO1xyXG4gICAgICB0aGlzLnkgPSB5XztcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLlNldFplcm8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMueCA9IDAuMDtcclxuICAgICAgdGhpcy55ID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHhfLCB5Xykge1xyXG4gICAgICBpZiAoeF8gPT09IHVuZGVmaW5lZCkgeF8gPSAwO1xyXG4gICAgICBpZiAoeV8gPT09IHVuZGVmaW5lZCkgeV8gPSAwO1xyXG4gICAgICB0aGlzLnggPSB4XztcclxuICAgICAgdGhpcy55ID0geV87XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5TZXRWID0gZnVuY3Rpb24gKHYpIHtcclxuICAgICAgdGhpcy54ID0gdi54O1xyXG4gICAgICB0aGlzLnkgPSB2Lnk7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5HZXROZWdhdGl2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoKC10aGlzLngpLCAoLXRoaXMueSkpO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuTmVnYXRpdmVTZWxmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnggPSAoLXRoaXMueCk7XHJcbiAgICAgIHRoaXMueSA9ICgtdGhpcy55KTtcclxuICAgfVxyXG4gICBiMlZlYzIuTWFrZSA9IGZ1bmN0aW9uICh4XywgeV8pIHtcclxuICAgICAgaWYgKHhfID09PSB1bmRlZmluZWQpIHhfID0gMDtcclxuICAgICAgaWYgKHlfID09PSB1bmRlZmluZWQpIHlfID0gMDtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzIoeF8sIHlfKTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKHRoaXMueCwgdGhpcy55KTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLkFkZCA9IGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgIHRoaXMueCArPSB2Lng7XHJcbiAgICAgIHRoaXMueSArPSB2Lnk7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5TdWJ0cmFjdCA9IGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgIHRoaXMueCAtPSB2Lng7XHJcbiAgICAgIHRoaXMueSAtPSB2Lnk7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5NdWx0aXBseSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgIGlmIChhID09PSB1bmRlZmluZWQpIGEgPSAwO1xyXG4gICAgICB0aGlzLnggKj0gYTtcclxuICAgICAgdGhpcy55ICo9IGE7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5NdWxNID0gZnVuY3Rpb24gKEEpIHtcclxuICAgICAgdmFyIHRYID0gdGhpcy54O1xyXG4gICAgICB0aGlzLnggPSBBLmNvbDEueCAqIHRYICsgQS5jb2wyLnggKiB0aGlzLnk7XHJcbiAgICAgIHRoaXMueSA9IEEuY29sMS55ICogdFggKyBBLmNvbDIueSAqIHRoaXMueTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLk11bFRNID0gZnVuY3Rpb24gKEEpIHtcclxuICAgICAgdmFyIHRYID0gYjJNYXRoLkRvdCh0aGlzLCBBLmNvbDEpO1xyXG4gICAgICB0aGlzLnkgPSBiMk1hdGguRG90KHRoaXMsIEEuY29sMik7XHJcbiAgICAgIHRoaXMueCA9IHRYO1xyXG4gICB9XHJcbiAgIGIyVmVjMi5wcm90b3R5cGUuQ3Jvc3NWRiA9IGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgIGlmIChzID09PSB1bmRlZmluZWQpIHMgPSAwO1xyXG4gICAgICB2YXIgdFggPSB0aGlzLng7XHJcbiAgICAgIHRoaXMueCA9IHMgKiB0aGlzLnk7XHJcbiAgICAgIHRoaXMueSA9ICgtcyAqIHRYKTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLkNyb3NzRlYgPSBmdW5jdGlvbiAocykge1xyXG4gICAgICBpZiAocyA9PT0gdW5kZWZpbmVkKSBzID0gMDtcclxuICAgICAgdmFyIHRYID0gdGhpcy54O1xyXG4gICAgICB0aGlzLnggPSAoLXMgKiB0aGlzLnkpO1xyXG4gICAgICB0aGlzLnkgPSBzICogdFg7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5NaW5WID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgdGhpcy54ID0gdGhpcy54IDwgYi54ID8gdGhpcy54IDogYi54O1xyXG4gICAgICB0aGlzLnkgPSB0aGlzLnkgPCBiLnkgPyB0aGlzLnkgOiBiLnk7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5NYXhWID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgdGhpcy54ID0gdGhpcy54ID4gYi54ID8gdGhpcy54IDogYi54O1xyXG4gICAgICB0aGlzLnkgPSB0aGlzLnkgPiBiLnkgPyB0aGlzLnkgOiBiLnk7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5BYnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGlmICh0aGlzLnggPCAwKSB0aGlzLnggPSAoLXRoaXMueCk7XHJcbiAgICAgIGlmICh0aGlzLnkgPCAwKSB0aGlzLnkgPSAoLXRoaXMueSk7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5MZW5ndGggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55KTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLkxlbmd0aFNxdWFyZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55KTtcclxuICAgfVxyXG4gICBiMlZlYzIucHJvdG90eXBlLk5vcm1hbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGxlbmd0aCA9IE1hdGguc3FydCh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkpO1xyXG4gICAgICBpZiAobGVuZ3RoIDwgTnVtYmVyLk1JTl9WQUxVRSkge1xyXG4gICAgICAgICByZXR1cm4gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBpbnZMZW5ndGggPSAxLjAgLyBsZW5ndGg7XHJcbiAgICAgIHRoaXMueCAqPSBpbnZMZW5ndGg7XHJcbiAgICAgIHRoaXMueSAqPSBpbnZMZW5ndGg7XHJcbiAgICAgIHJldHVybiBsZW5ndGg7XHJcbiAgIH1cclxuICAgYjJWZWMyLnByb3RvdHlwZS5Jc1ZhbGlkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gYjJNYXRoLklzVmFsaWQodGhpcy54KSAmJiBiMk1hdGguSXNWYWxpZCh0aGlzLnkpO1xyXG4gICB9XHJcbiAgIGIyVmVjMy5iMlZlYzMgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJWZWMzLnByb3RvdHlwZS5iMlZlYzMgPSBmdW5jdGlvbiAoeCwgeSwgeikge1xyXG4gICAgICBpZiAoeCA9PT0gdW5kZWZpbmVkKSB4ID0gMDtcclxuICAgICAgaWYgKHkgPT09IHVuZGVmaW5lZCkgeSA9IDA7XHJcbiAgICAgIGlmICh6ID09PSB1bmRlZmluZWQpIHogPSAwO1xyXG4gICAgICB0aGlzLnggPSB4O1xyXG4gICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICB0aGlzLnogPSB6O1xyXG4gICB9XHJcbiAgIGIyVmVjMy5wcm90b3R5cGUuU2V0WmVybyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy54ID0gdGhpcy55ID0gdGhpcy56ID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyVmVjMy5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHgsIHksIHopIHtcclxuICAgICAgaWYgKHggPT09IHVuZGVmaW5lZCkgeCA9IDA7XHJcbiAgICAgIGlmICh5ID09PSB1bmRlZmluZWQpIHkgPSAwO1xyXG4gICAgICBpZiAoeiA9PT0gdW5kZWZpbmVkKSB6ID0gMDtcclxuICAgICAgdGhpcy54ID0geDtcclxuICAgICAgdGhpcy55ID0geTtcclxuICAgICAgdGhpcy56ID0gejtcclxuICAgfVxyXG4gICBiMlZlYzMucHJvdG90eXBlLlNldFYgPSBmdW5jdGlvbiAodikge1xyXG4gICAgICB0aGlzLnggPSB2Lng7XHJcbiAgICAgIHRoaXMueSA9IHYueTtcclxuICAgICAgdGhpcy56ID0gdi56O1xyXG4gICB9XHJcbiAgIGIyVmVjMy5wcm90b3R5cGUuR2V0TmVnYXRpdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMzKCgtdGhpcy54KSwgKC10aGlzLnkpLCAoLXRoaXMueikpO1xyXG4gICB9XHJcbiAgIGIyVmVjMy5wcm90b3R5cGUuTmVnYXRpdmVTZWxmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnggPSAoLXRoaXMueCk7XHJcbiAgICAgIHRoaXMueSA9ICgtdGhpcy55KTtcclxuICAgICAgdGhpcy56ID0gKC10aGlzLnopO1xyXG4gICB9XHJcbiAgIGIyVmVjMy5wcm90b3R5cGUuQ29weSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMlZlYzModGhpcy54LCB0aGlzLnksIHRoaXMueik7XHJcbiAgIH1cclxuICAgYjJWZWMzLnByb3RvdHlwZS5BZGQgPSBmdW5jdGlvbiAodikge1xyXG4gICAgICB0aGlzLnggKz0gdi54O1xyXG4gICAgICB0aGlzLnkgKz0gdi55O1xyXG4gICAgICB0aGlzLnogKz0gdi56O1xyXG4gICB9XHJcbiAgIGIyVmVjMy5wcm90b3R5cGUuU3VidHJhY3QgPSBmdW5jdGlvbiAodikge1xyXG4gICAgICB0aGlzLnggLT0gdi54O1xyXG4gICAgICB0aGlzLnkgLT0gdi55O1xyXG4gICAgICB0aGlzLnogLT0gdi56O1xyXG4gICB9XHJcbiAgIGIyVmVjMy5wcm90b3R5cGUuTXVsdGlwbHkgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkKSBhID0gMDtcclxuICAgICAgdGhpcy54ICo9IGE7XHJcbiAgICAgIHRoaXMueSAqPSBhO1xyXG4gICAgICB0aGlzLnogKj0gYTtcclxuICAgfVxyXG59KSgpO1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYjJDb250cm9sbGVyRWRnZSA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlckVkZ2UsXHJcbiAgICAgIGIyTWF0MjIgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDIyLFxyXG4gICAgICBiMk1hdDMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQzMyxcclxuICAgICAgYjJNYXRoID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLFxyXG4gICAgICBiMlN3ZWVwID0gQm94MkQuQ29tbW9uLk1hdGguYjJTd2VlcCxcclxuICAgICAgYjJUcmFuc2Zvcm0gPSBCb3gyRC5Db21tb24uTWF0aC5iMlRyYW5zZm9ybSxcclxuICAgICAgYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyLFxyXG4gICAgICBiMlZlYzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzMsXHJcbiAgICAgIGIyQ29sb3IgPSBCb3gyRC5Db21tb24uYjJDb2xvcixcclxuICAgICAgYjJpbnRlcm5hbCA9IEJveDJELkNvbW1vbi5iMmludGVybmFsLFxyXG4gICAgICBiMlNldHRpbmdzID0gQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MsXHJcbiAgICAgIGIyQUFCQiA9IEJveDJELkNvbGxpc2lvbi5iMkFBQkIsXHJcbiAgICAgIGIyQm91bmQgPSBCb3gyRC5Db2xsaXNpb24uYjJCb3VuZCxcclxuICAgICAgYjJCb3VuZFZhbHVlcyA9IEJveDJELkNvbGxpc2lvbi5iMkJvdW5kVmFsdWVzLFxyXG4gICAgICBiMkNvbGxpc2lvbiA9IEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbixcclxuICAgICAgYjJDb250YWN0SUQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0SUQsXHJcbiAgICAgIGIyQ29udGFjdFBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyQ29udGFjdFBvaW50LFxyXG4gICAgICBiMkRpc3RhbmNlID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2UsXHJcbiAgICAgIGIyRGlzdGFuY2VJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlSW5wdXQsXHJcbiAgICAgIGIyRGlzdGFuY2VPdXRwdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZU91dHB1dCxcclxuICAgICAgYjJEaXN0YW5jZVByb3h5ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VQcm94eSxcclxuICAgICAgYjJEeW5hbWljVHJlZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlLFxyXG4gICAgICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSxcclxuICAgICAgYjJEeW5hbWljVHJlZU5vZGUgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZU5vZGUsXHJcbiAgICAgIGIyRHluYW1pY1RyZWVQYWlyID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVQYWlyLFxyXG4gICAgICBiMk1hbmlmb2xkID0gQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGQsXHJcbiAgICAgIGIyTWFuaWZvbGRQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkUG9pbnQsXHJcbiAgICAgIGIyUG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJQb2ludCxcclxuICAgICAgYjJSYXlDYXN0SW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJSYXlDYXN0SW5wdXQsXHJcbiAgICAgIGIyUmF5Q2FzdE91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RPdXRwdXQsXHJcbiAgICAgIGIyU2VnbWVudCA9IEJveDJELkNvbGxpc2lvbi5iMlNlZ21lbnQsXHJcbiAgICAgIGIyU2VwYXJhdGlvbkZ1bmN0aW9uID0gQm94MkQuQ29sbGlzaW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uLFxyXG4gICAgICBiMlNpbXBsZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4LFxyXG4gICAgICBiMlNpbXBsZXhDYWNoZSA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXhDYWNoZSxcclxuICAgICAgYjJTaW1wbGV4VmVydGV4ID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleFZlcnRleCxcclxuICAgICAgYjJUaW1lT2ZJbXBhY3QgPSBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QsXHJcbiAgICAgIGIyVE9JSW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJUT0lJbnB1dCxcclxuICAgICAgYjJXb3JsZE1hbmlmb2xkID0gQm94MkQuQ29sbGlzaW9uLmIyV29ybGRNYW5pZm9sZCxcclxuICAgICAgQ2xpcFZlcnRleCA9IEJveDJELkNvbGxpc2lvbi5DbGlwVmVydGV4LFxyXG4gICAgICBGZWF0dXJlcyA9IEJveDJELkNvbGxpc2lvbi5GZWF0dXJlcyxcclxuICAgICAgSUJyb2FkUGhhc2UgPSBCb3gyRC5Db2xsaXNpb24uSUJyb2FkUGhhc2UsXHJcbiAgICAgIGIyQ2lyY2xlU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyQ2lyY2xlU2hhcGUsXHJcbiAgICAgIGIyRWRnZUNoYWluRGVmID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VDaGFpbkRlZixcclxuICAgICAgYjJFZGdlU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZVNoYXBlLFxyXG4gICAgICBiMk1hc3NEYXRhID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMk1hc3NEYXRhLFxyXG4gICAgICBiMlBvbHlnb25TaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJQb2x5Z29uU2hhcGUsXHJcbiAgICAgIGIyU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUsXHJcbiAgICAgIGIyQm9keSA9IEJveDJELkR5bmFtaWNzLmIyQm9keSxcclxuICAgICAgYjJCb2R5RGVmID0gQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmLFxyXG4gICAgICBiMkNvbnRhY3RGaWx0ZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RGaWx0ZXIsXHJcbiAgICAgIGIyQ29udGFjdEltcHVsc2UgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RJbXB1bHNlLFxyXG4gICAgICBiMkNvbnRhY3RMaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdExpc3RlbmVyLFxyXG4gICAgICBiMkNvbnRhY3RNYW5hZ2VyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0TWFuYWdlcixcclxuICAgICAgYjJEZWJ1Z0RyYXcgPSBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdyxcclxuICAgICAgYjJEZXN0cnVjdGlvbkxpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJEZXN0cnVjdGlvbkxpc3RlbmVyLFxyXG4gICAgICBiMkZpbHRlckRhdGEgPSBCb3gyRC5EeW5hbWljcy5iMkZpbHRlckRhdGEsXHJcbiAgICAgIGIyRml4dHVyZSA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZSxcclxuICAgICAgYjJGaXh0dXJlRGVmID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmLFxyXG4gICAgICBiMklzbGFuZCA9IEJveDJELkR5bmFtaWNzLmIySXNsYW5kLFxyXG4gICAgICBiMlRpbWVTdGVwID0gQm94MkQuRHluYW1pY3MuYjJUaW1lU3RlcCxcclxuICAgICAgYjJXb3JsZCA9IEJveDJELkR5bmFtaWNzLmIyV29ybGQsXHJcbiAgICAgIGIyQ2lyY2xlQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ2lyY2xlQ29udGFjdCxcclxuICAgICAgYjJDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LFxyXG4gICAgICBiMkNvbnRhY3RDb25zdHJhaW50ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0Q29uc3RyYWludCxcclxuICAgICAgYjJDb250YWN0Q29uc3RyYWludFBvaW50ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0Q29uc3RyYWludFBvaW50LFxyXG4gICAgICBiMkNvbnRhY3RFZGdlID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0RWRnZSxcclxuICAgICAgYjJDb250YWN0RmFjdG9yeSA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdEZhY3RvcnksXHJcbiAgICAgIGIyQ29udGFjdFJlZ2lzdGVyID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0UmVnaXN0ZXIsXHJcbiAgICAgIGIyQ29udGFjdFJlc3VsdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFJlc3VsdCxcclxuICAgICAgYjJDb250YWN0U29sdmVyID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0U29sdmVyLFxyXG4gICAgICBiMkVkZ2VBbmRDaXJjbGVDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJFZGdlQW5kQ2lyY2xlQ29udGFjdCxcclxuICAgICAgYjJOdWxsQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyTnVsbENvbnRhY3QsXHJcbiAgICAgIGIyUG9seUFuZENpcmNsZUNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvbHlBbmRDaXJjbGVDb250YWN0LFxyXG4gICAgICBiMlBvbHlBbmRFZGdlQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9seUFuZEVkZ2VDb250YWN0LFxyXG4gICAgICBiMlBvbHlnb25Db250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5Z29uQ29udGFjdCxcclxuICAgICAgYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkLFxyXG4gICAgICBiMkNvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIsXHJcbiAgICAgIGIyRGlzdGFuY2VKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkRpc3RhbmNlSm9pbnQsXHJcbiAgICAgIGIyRGlzdGFuY2VKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkRpc3RhbmNlSm9pbnREZWYsXHJcbiAgICAgIGIyRnJpY3Rpb25Kb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkZyaWN0aW9uSm9pbnQsXHJcbiAgICAgIGIyRnJpY3Rpb25Kb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkZyaWN0aW9uSm9pbnREZWYsXHJcbiAgICAgIGIyR2VhckpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyR2VhckpvaW50LFxyXG4gICAgICBiMkdlYXJKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkdlYXJKb2ludERlZixcclxuICAgICAgYjJKYWNvYmlhbiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkphY29iaWFuLFxyXG4gICAgICBiMkpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQsXHJcbiAgICAgIGIySm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZixcclxuICAgICAgYjJKb2ludEVkZ2UgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludEVkZ2UsXHJcbiAgICAgIGIyTGluZUpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyTGluZUpvaW50LFxyXG4gICAgICBiMkxpbmVKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkxpbmVKb2ludERlZixcclxuICAgICAgYjJNb3VzZUpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyTW91c2VKb2ludCxcclxuICAgICAgYjJNb3VzZUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyTW91c2VKb2ludERlZixcclxuICAgICAgYjJQcmlzbWF0aWNKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlByaXNtYXRpY0pvaW50LFxyXG4gICAgICBiMlByaXNtYXRpY0pvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHJpc21hdGljSm9pbnREZWYsXHJcbiAgICAgIGIyUHVsbGV5Sm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQdWxsZXlKb2ludCxcclxuICAgICAgYjJQdWxsZXlKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlB1bGxleUpvaW50RGVmLFxyXG4gICAgICBiMlJldm9sdXRlSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJSZXZvbHV0ZUpvaW50LFxyXG4gICAgICBiMlJldm9sdXRlSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJSZXZvbHV0ZUpvaW50RGVmLFxyXG4gICAgICBiMldlbGRKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMldlbGRKb2ludCxcclxuICAgICAgYjJXZWxkSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJXZWxkSm9pbnREZWY7XHJcblxyXG4gICBiMkJvZHkuYjJCb2R5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1feGYgPSBuZXcgYjJUcmFuc2Zvcm0oKTtcclxuICAgICAgdGhpcy5tX3N3ZWVwID0gbmV3IGIyU3dlZXAoKTtcclxuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5ID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fZm9yY2UgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuY29ubmVjdEVkZ2VzID0gZnVuY3Rpb24gKHMxLCBzMiwgYW5nbGUxKSB7XHJcbiAgICAgIGlmIChhbmdsZTEgPT09IHVuZGVmaW5lZCkgYW5nbGUxID0gMDtcclxuICAgICAgdmFyIGFuZ2xlMiA9IE1hdGguYXRhbjIoczIuR2V0RGlyZWN0aW9uVmVjdG9yKCkueSwgczIuR2V0RGlyZWN0aW9uVmVjdG9yKCkueCk7XHJcbiAgICAgIHZhciBjb3JlT2Zmc2V0ID0gTWF0aC50YW4oKGFuZ2xlMiAtIGFuZ2xlMSkgKiAwLjUpO1xyXG4gICAgICB2YXIgY29yZSA9IGIyTWF0aC5NdWxGVihjb3JlT2Zmc2V0LCBzMi5HZXREaXJlY3Rpb25WZWN0b3IoKSk7XHJcbiAgICAgIGNvcmUgPSBiMk1hdGguU3VidHJhY3RWVihjb3JlLCBzMi5HZXROb3JtYWxWZWN0b3IoKSk7XHJcbiAgICAgIGNvcmUgPSBiMk1hdGguTXVsRlYoYjJTZXR0aW5ncy5iMl90b2lTbG9wLCBjb3JlKTtcclxuICAgICAgY29yZSA9IGIyTWF0aC5BZGRWVihjb3JlLCBzMi5HZXRWZXJ0ZXgxKCkpO1xyXG4gICAgICB2YXIgY29ybmVyRGlyID0gYjJNYXRoLkFkZFZWKHMxLkdldERpcmVjdGlvblZlY3RvcigpLCBzMi5HZXREaXJlY3Rpb25WZWN0b3IoKSk7XHJcbiAgICAgIGNvcm5lckRpci5Ob3JtYWxpemUoKTtcclxuICAgICAgdmFyIGNvbnZleCA9IGIyTWF0aC5Eb3QoczEuR2V0RGlyZWN0aW9uVmVjdG9yKCksIHMyLkdldE5vcm1hbFZlY3RvcigpKSA+IDAuMDtcclxuICAgICAgczEuU2V0TmV4dEVkZ2UoczIsIGNvcmUsIGNvcm5lckRpciwgY29udmV4KTtcclxuICAgICAgczIuU2V0UHJldkVkZ2UoczEsIGNvcmUsIGNvcm5lckRpciwgY29udmV4KTtcclxuICAgICAgcmV0dXJuIGFuZ2xlMjtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkNyZWF0ZUZpeHR1cmUgPSBmdW5jdGlvbiAoZGVmKSB7XHJcbiAgICAgIGlmICh0aGlzLm1fd29ybGQuSXNMb2NrZWQoKSA9PSB0cnVlKSB7XHJcbiAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBmaXh0dXJlID0gbmV3IGIyRml4dHVyZSgpO1xyXG4gICAgICBmaXh0dXJlLkNyZWF0ZSh0aGlzLCB0aGlzLm1feGYsIGRlZik7XHJcbiAgICAgIGlmICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9hY3RpdmVGbGFnKSB7XHJcbiAgICAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlO1xyXG4gICAgICAgICBmaXh0dXJlLkNyZWF0ZVByb3h5KGJyb2FkUGhhc2UsIHRoaXMubV94Zik7XHJcbiAgICAgIH1cclxuICAgICAgZml4dHVyZS5tX25leHQgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XHJcbiAgICAgIHRoaXMubV9maXh0dXJlTGlzdCA9IGZpeHR1cmU7XHJcbiAgICAgICsrdGhpcy5tX2ZpeHR1cmVDb3VudDtcclxuICAgICAgZml4dHVyZS5tX2JvZHkgPSB0aGlzO1xyXG4gICAgICBpZiAoZml4dHVyZS5tX2RlbnNpdHkgPiAwLjApIHtcclxuICAgICAgICAgdGhpcy5SZXNldE1hc3NEYXRhKCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX3dvcmxkLm1fZmxhZ3MgfD0gYjJXb3JsZC5lX25ld0ZpeHR1cmU7XHJcbiAgICAgIHJldHVybiBmaXh0dXJlO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuQ3JlYXRlRml4dHVyZTIgPSBmdW5jdGlvbiAoc2hhcGUsIGRlbnNpdHkpIHtcclxuICAgICAgaWYgKGRlbnNpdHkgPT09IHVuZGVmaW5lZCkgZGVuc2l0eSA9IDAuMDtcclxuICAgICAgdmFyIGRlZiA9IG5ldyBiMkZpeHR1cmVEZWYoKTtcclxuICAgICAgZGVmLnNoYXBlID0gc2hhcGU7XHJcbiAgICAgIGRlZi5kZW5zaXR5ID0gZGVuc2l0eTtcclxuICAgICAgcmV0dXJuIHRoaXMuQ3JlYXRlRml4dHVyZShkZWYpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuRGVzdHJveUZpeHR1cmUgPSBmdW5jdGlvbiAoZml4dHVyZSkge1xyXG4gICAgICBpZiAodGhpcy5tX3dvcmxkLklzTG9ja2VkKCkgPT0gdHJ1ZSkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIG5vZGUgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XHJcbiAgICAgIHZhciBwcEYgPSBudWxsO1xyXG4gICAgICB2YXIgZm91bmQgPSBmYWxzZTtcclxuICAgICAgd2hpbGUgKG5vZGUgIT0gbnVsbCkge1xyXG4gICAgICAgICBpZiAobm9kZSA9PSBmaXh0dXJlKSB7XHJcbiAgICAgICAgICAgIGlmIChwcEYpIHBwRi5tX25leHQgPSBmaXh0dXJlLm1fbmV4dDtcclxuICAgICAgICAgICAgZWxzZSB0aGlzLm1fZml4dHVyZUxpc3QgPSBmaXh0dXJlLm1fbmV4dDtcclxuICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBwcEYgPSBub2RlO1xyXG4gICAgICAgICBub2RlID0gbm9kZS5tX25leHQ7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGVkZ2UgPSB0aGlzLm1fY29udGFjdExpc3Q7XHJcbiAgICAgIHdoaWxlIChlZGdlKSB7XHJcbiAgICAgICAgIHZhciBjID0gZWRnZS5jb250YWN0O1xyXG4gICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xyXG4gICAgICAgICB2YXIgZml4dHVyZUEgPSBjLkdldEZpeHR1cmVBKCk7XHJcbiAgICAgICAgIHZhciBmaXh0dXJlQiA9IGMuR2V0Rml4dHVyZUIoKTtcclxuICAgICAgICAgaWYgKGZpeHR1cmUgPT0gZml4dHVyZUEgfHwgZml4dHVyZSA9PSBmaXh0dXJlQikge1xyXG4gICAgICAgICAgICB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5EZXN0cm95KGMpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2FjdGl2ZUZsYWcpIHtcclxuICAgICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcbiAgICAgICAgIGZpeHR1cmUuRGVzdHJveVByb3h5KGJyb2FkUGhhc2UpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge31cclxuICAgICAgZml4dHVyZS5EZXN0cm95KCk7XHJcbiAgICAgIGZpeHR1cmUubV9ib2R5ID0gbnVsbDtcclxuICAgICAgZml4dHVyZS5tX25leHQgPSBudWxsO1xyXG4gICAgICAtLXRoaXMubV9maXh0dXJlQ291bnQ7XHJcbiAgICAgIHRoaXMuUmVzZXRNYXNzRGF0YSgpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0UG9zaXRpb25BbmRBbmdsZSA9IGZ1bmN0aW9uIChwb3NpdGlvbiwgYW5nbGUpIHtcclxuICAgICAgaWYgKGFuZ2xlID09PSB1bmRlZmluZWQpIGFuZ2xlID0gMDtcclxuICAgICAgdmFyIGY7XHJcbiAgICAgIGlmICh0aGlzLm1fd29ybGQuSXNMb2NrZWQoKSA9PSB0cnVlKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1feGYuUi5TZXQoYW5nbGUpO1xyXG4gICAgICB0aGlzLm1feGYucG9zaXRpb24uU2V0Vihwb3NpdGlvbik7XHJcbiAgICAgIHZhciB0TWF0ID0gdGhpcy5tX3hmLlI7XHJcbiAgICAgIHZhciB0VmVjID0gdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYy54ID0gKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYy55ID0gKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYy54ICs9IHRoaXMubV94Zi5wb3NpdGlvbi54O1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYy55ICs9IHRoaXMubV94Zi5wb3NpdGlvbi55O1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYzAuU2V0Vih0aGlzLm1fc3dlZXAuYyk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5hMCA9IHRoaXMubV9zd2VlcC5hID0gYW5nbGU7XHJcbiAgICAgIHZhciBicm9hZFBoYXNlID0gdGhpcy5tX3dvcmxkLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlO1xyXG4gICAgICBmb3IgKGYgPSB0aGlzLm1fZml4dHVyZUxpc3Q7XHJcbiAgICAgIGY7IGYgPSBmLm1fbmV4dCkge1xyXG4gICAgICAgICBmLlN5bmNocm9uaXplKGJyb2FkUGhhc2UsIHRoaXMubV94ZiwgdGhpcy5tX3hmKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5GaW5kTmV3Q29udGFjdHMoKTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlNldFRyYW5zZm9ybSA9IGZ1bmN0aW9uICh4Zikge1xyXG4gICAgICB0aGlzLlNldFBvc2l0aW9uQW5kQW5nbGUoeGYucG9zaXRpb24sIHhmLkdldEFuZ2xlKCkpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0VHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3hmO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1feGYucG9zaXRpb247XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xyXG4gICAgICB0aGlzLlNldFBvc2l0aW9uQW5kQW5nbGUocG9zaXRpb24sIHRoaXMuR2V0QW5nbGUoKSk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRBbmdsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9zd2VlcC5hO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0QW5nbGUgPSBmdW5jdGlvbiAoYW5nbGUpIHtcclxuICAgICAgaWYgKGFuZ2xlID09PSB1bmRlZmluZWQpIGFuZ2xlID0gMDtcclxuICAgICAgdGhpcy5TZXRQb3NpdGlvbkFuZEFuZ2xlKHRoaXMuR2V0UG9zaXRpb24oKSwgYW5nbGUpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0V29ybGRDZW50ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fc3dlZXAuYztcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldExvY2FsQ2VudGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0TGluZWFyVmVsb2NpdHkgPSBmdW5jdGlvbiAodikge1xyXG4gICAgICBpZiAodGhpcy5tX3R5cGUgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS5TZXRWKHYpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0TGluZWFyVmVsb2NpdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRBbmd1bGFyVmVsb2NpdHkgPSBmdW5jdGlvbiAob21lZ2EpIHtcclxuICAgICAgaWYgKG9tZWdhID09PSB1bmRlZmluZWQpIG9tZWdhID0gMDtcclxuICAgICAgaWYgKHRoaXMubV90eXBlID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gb21lZ2E7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRBbmd1bGFyVmVsb2NpdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0RGVmaW5pdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGJkID0gbmV3IGIyQm9keURlZigpO1xyXG4gICAgICBiZC50eXBlID0gdGhpcy5HZXRUeXBlKCk7XHJcbiAgICAgIGJkLmFsbG93U2xlZXAgPSAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWcpID09IGIyQm9keS5lX2FsbG93U2xlZXBGbGFnO1xyXG4gICAgICBiZC5hbmdsZSA9IHRoaXMuR2V0QW5nbGUoKTtcclxuICAgICAgYmQuYW5ndWxhckRhbXBpbmcgPSB0aGlzLm1fYW5ndWxhckRhbXBpbmc7XHJcbiAgICAgIGJkLmFuZ3VsYXJWZWxvY2l0eSA9IHRoaXMubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIGJkLmZpeGVkUm90YXRpb24gPSAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfZml4ZWRSb3RhdGlvbkZsYWcpID09IGIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnO1xyXG4gICAgICBiZC5idWxsZXQgPSAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfYnVsbGV0RmxhZykgPT0gYjJCb2R5LmVfYnVsbGV0RmxhZztcclxuICAgICAgYmQuYXdha2UgPSAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfYXdha2VGbGFnKSA9PSBiMkJvZHkuZV9hd2FrZUZsYWc7XHJcbiAgICAgIGJkLmxpbmVhckRhbXBpbmcgPSB0aGlzLm1fbGluZWFyRGFtcGluZztcclxuICAgICAgYmQubGluZWFyVmVsb2NpdHkuU2V0Vih0aGlzLkdldExpbmVhclZlbG9jaXR5KCkpO1xyXG4gICAgICBiZC5wb3NpdGlvbiA9IHRoaXMuR2V0UG9zaXRpb24oKTtcclxuICAgICAgYmQudXNlckRhdGEgPSB0aGlzLkdldFVzZXJEYXRhKCk7XHJcbiAgICAgIHJldHVybiBiZDtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkFwcGx5Rm9yY2UgPSBmdW5jdGlvbiAoZm9yY2UsIHBvaW50KSB7XHJcbiAgICAgIGlmICh0aGlzLm1fdHlwZSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLklzQXdha2UoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICB0aGlzLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9mb3JjZS54ICs9IGZvcmNlLng7XHJcbiAgICAgIHRoaXMubV9mb3JjZS55ICs9IGZvcmNlLnk7XHJcbiAgICAgIHRoaXMubV90b3JxdWUgKz0gKChwb2ludC54IC0gdGhpcy5tX3N3ZWVwLmMueCkgKiBmb3JjZS55IC0gKHBvaW50LnkgLSB0aGlzLm1fc3dlZXAuYy55KSAqIGZvcmNlLngpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuQXBwbHlUb3JxdWUgPSBmdW5jdGlvbiAodG9ycXVlKSB7XHJcbiAgICAgIGlmICh0b3JxdWUgPT09IHVuZGVmaW5lZCkgdG9ycXVlID0gMDtcclxuICAgICAgaWYgKHRoaXMubV90eXBlICE9IGIyQm9keS5iMl9keW5hbWljQm9keSkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuSXNBd2FrZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHRoaXMuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX3RvcnF1ZSArPSB0b3JxdWU7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5BcHBseUltcHVsc2UgPSBmdW5jdGlvbiAoaW1wdWxzZSwgcG9pbnQpIHtcclxuICAgICAgaWYgKHRoaXMubV90eXBlICE9IGIyQm9keS5iMl9keW5hbWljQm9keSkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuSXNBd2FrZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHRoaXMuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnggKz0gdGhpcy5tX2ludk1hc3MgKiBpbXB1bHNlLng7XHJcbiAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS55ICs9IHRoaXMubV9pbnZNYXNzICogaW1wdWxzZS55O1xyXG4gICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICs9IHRoaXMubV9pbnZJICogKChwb2ludC54IC0gdGhpcy5tX3N3ZWVwLmMueCkgKiBpbXB1bHNlLnkgLSAocG9pbnQueSAtIHRoaXMubV9zd2VlcC5jLnkpICogaW1wdWxzZS54KTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlNwbGl0ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgIHZhciBsaW5lYXJWZWxvY2l0eSA9IHRoaXMuR2V0TGluZWFyVmVsb2NpdHkoKS5Db3B5KCk7XHJcbiAgICAgIHZhciBhbmd1bGFyVmVsb2NpdHkgPSB0aGlzLkdldEFuZ3VsYXJWZWxvY2l0eSgpO1xyXG4gICAgICB2YXIgY2VudGVyID0gdGhpcy5HZXRXb3JsZENlbnRlcigpO1xyXG4gICAgICB2YXIgYm9keTEgPSB0aGlzO1xyXG4gICAgICB2YXIgYm9keTIgPSB0aGlzLm1fd29ybGQuQ3JlYXRlQm9keSh0aGlzLkdldERlZmluaXRpb24oKSk7XHJcbiAgICAgIHZhciBwcmV2O1xyXG4gICAgICBmb3IgKHZhciBmID0gYm9keTEubV9maXh0dXJlTGlzdDsgZjspIHtcclxuICAgICAgICAgaWYgKGNhbGxiYWNrKGYpKSB7XHJcbiAgICAgICAgICAgIHZhciBuZXh0ID0gZi5tX25leHQ7XHJcbiAgICAgICAgICAgIGlmIChwcmV2KSB7XHJcbiAgICAgICAgICAgICAgIHByZXYubV9uZXh0ID0gbmV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgYm9keTEubV9maXh0dXJlTGlzdCA9IG5leHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYm9keTEubV9maXh0dXJlQ291bnQtLTtcclxuICAgICAgICAgICAgZi5tX25leHQgPSBib2R5Mi5tX2ZpeHR1cmVMaXN0O1xyXG4gICAgICAgICAgICBib2R5Mi5tX2ZpeHR1cmVMaXN0ID0gZjtcclxuICAgICAgICAgICAgYm9keTIubV9maXh0dXJlQ291bnQrKztcclxuICAgICAgICAgICAgZi5tX2JvZHkgPSBib2R5MjtcclxuICAgICAgICAgICAgZiA9IG5leHQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHByZXYgPSBmO1xyXG4gICAgICAgICAgICBmID0gZi5tX25leHQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBib2R5MS5SZXNldE1hc3NEYXRhKCk7XHJcbiAgICAgIGJvZHkyLlJlc2V0TWFzc0RhdGEoKTtcclxuICAgICAgdmFyIGNlbnRlcjEgPSBib2R5MS5HZXRXb3JsZENlbnRlcigpO1xyXG4gICAgICB2YXIgY2VudGVyMiA9IGJvZHkyLkdldFdvcmxkQ2VudGVyKCk7XHJcbiAgICAgIHZhciB2ZWxvY2l0eTEgPSBiMk1hdGguQWRkVlYobGluZWFyVmVsb2NpdHksIGIyTWF0aC5Dcm9zc0ZWKGFuZ3VsYXJWZWxvY2l0eSwgYjJNYXRoLlN1YnRyYWN0VlYoY2VudGVyMSwgY2VudGVyKSkpO1xyXG4gICAgICB2YXIgdmVsb2NpdHkyID0gYjJNYXRoLkFkZFZWKGxpbmVhclZlbG9jaXR5LCBiMk1hdGguQ3Jvc3NGVihhbmd1bGFyVmVsb2NpdHksIGIyTWF0aC5TdWJ0cmFjdFZWKGNlbnRlcjIsIGNlbnRlcikpKTtcclxuICAgICAgYm9keTEuU2V0TGluZWFyVmVsb2NpdHkodmVsb2NpdHkxKTtcclxuICAgICAgYm9keTIuU2V0TGluZWFyVmVsb2NpdHkodmVsb2NpdHkyKTtcclxuICAgICAgYm9keTEuU2V0QW5ndWxhclZlbG9jaXR5KGFuZ3VsYXJWZWxvY2l0eSk7XHJcbiAgICAgIGJvZHkyLlNldEFuZ3VsYXJWZWxvY2l0eShhbmd1bGFyVmVsb2NpdHkpO1xyXG4gICAgICBib2R5MS5TeW5jaHJvbml6ZUZpeHR1cmVzKCk7XHJcbiAgICAgIGJvZHkyLlN5bmNocm9uaXplRml4dHVyZXMoKTtcclxuICAgICAgcmV0dXJuIGJvZHkyO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuTWVyZ2UgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgdmFyIGY7XHJcbiAgICAgIGZvciAoZiA9IG90aGVyLm1fZml4dHVyZUxpc3Q7XHJcbiAgICAgIGY7KSB7XHJcbiAgICAgICAgIHZhciBuZXh0ID0gZi5tX25leHQ7XHJcbiAgICAgICAgIG90aGVyLm1fZml4dHVyZUNvdW50LS07XHJcbiAgICAgICAgIGYubV9uZXh0ID0gdGhpcy5tX2ZpeHR1cmVMaXN0O1xyXG4gICAgICAgICB0aGlzLm1fZml4dHVyZUxpc3QgPSBmO1xyXG4gICAgICAgICB0aGlzLm1fZml4dHVyZUNvdW50Kys7XHJcbiAgICAgICAgIGYubV9ib2R5ID0gYm9keTI7XHJcbiAgICAgICAgIGYgPSBuZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGJvZHkxLm1fZml4dHVyZUNvdW50ID0gMDtcclxuICAgICAgdmFyIGJvZHkxID0gdGhpcztcclxuICAgICAgdmFyIGJvZHkyID0gb3RoZXI7XHJcbiAgICAgIHZhciBjZW50ZXIxID0gYm9keTEuR2V0V29ybGRDZW50ZXIoKTtcclxuICAgICAgdmFyIGNlbnRlcjIgPSBib2R5Mi5HZXRXb3JsZENlbnRlcigpO1xyXG4gICAgICB2YXIgdmVsb2NpdHkxID0gYm9keTEuR2V0TGluZWFyVmVsb2NpdHkoKS5Db3B5KCk7XHJcbiAgICAgIHZhciB2ZWxvY2l0eTIgPSBib2R5Mi5HZXRMaW5lYXJWZWxvY2l0eSgpLkNvcHkoKTtcclxuICAgICAgdmFyIGFuZ3VsYXIxID0gYm9keTEuR2V0QW5ndWxhclZlbG9jaXR5KCk7XHJcbiAgICAgIHZhciBhbmd1bGFyID0gYm9keTIuR2V0QW5ndWxhclZlbG9jaXR5KCk7XHJcbiAgICAgIGJvZHkxLlJlc2V0TWFzc0RhdGEoKTtcclxuICAgICAgdGhpcy5TeW5jaHJvbml6ZUZpeHR1cmVzKCk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRNYXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX21hc3M7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRJbmVydGlhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX0k7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRNYXNzRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgIGRhdGEubWFzcyA9IHRoaXMubV9tYXNzO1xyXG4gICAgICBkYXRhLkkgPSB0aGlzLm1fSTtcclxuICAgICAgZGF0YS5jZW50ZXIuU2V0Vih0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0TWFzc0RhdGEgPSBmdW5jdGlvbiAobWFzc0RhdGEpIHtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCh0aGlzLm1fd29ybGQuSXNMb2NrZWQoKSA9PSBmYWxzZSk7XHJcbiAgICAgIGlmICh0aGlzLm1fd29ybGQuSXNMb2NrZWQoKSA9PSB0cnVlKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX3R5cGUgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1faW52TWFzcyA9IDAuMDtcclxuICAgICAgdGhpcy5tX0kgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9pbnZJID0gMC4wO1xyXG4gICAgICB0aGlzLm1fbWFzcyA9IG1hc3NEYXRhLm1hc3M7XHJcbiAgICAgIGlmICh0aGlzLm1fbWFzcyA8PSAwLjApIHtcclxuICAgICAgICAgdGhpcy5tX21hc3MgPSAxLjA7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2ludk1hc3MgPSAxLjAgLyB0aGlzLm1fbWFzcztcclxuICAgICAgaWYgKG1hc3NEYXRhLkkgPiAwLjAgJiYgKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnKSA9PSAwKSB7XHJcbiAgICAgICAgIHRoaXMubV9JID0gbWFzc0RhdGEuSSAtIHRoaXMubV9tYXNzICogKG1hc3NEYXRhLmNlbnRlci54ICogbWFzc0RhdGEuY2VudGVyLnggKyBtYXNzRGF0YS5jZW50ZXIueSAqIG1hc3NEYXRhLmNlbnRlci55KTtcclxuICAgICAgICAgdGhpcy5tX2ludkkgPSAxLjAgLyB0aGlzLm1fSTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgb2xkQ2VudGVyID0gdGhpcy5tX3N3ZWVwLmMuQ29weSgpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIuU2V0VihtYXNzRGF0YS5jZW50ZXIpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYzAuU2V0VihiMk1hdGguTXVsWCh0aGlzLm1feGYsIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlcikpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYy5TZXRWKHRoaXMubV9zd2VlcC5jMCk7XHJcbiAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS54ICs9IHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKiAoLSh0aGlzLm1fc3dlZXAuYy55IC0gb2xkQ2VudGVyLnkpKTtcclxuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnkgKz0gdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSAqICgrKHRoaXMubV9zd2VlcC5jLnggLSBvbGRDZW50ZXIueCkpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuUmVzZXRNYXNzRGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX21hc3MgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9pbnZNYXNzID0gMC4wO1xyXG4gICAgICB0aGlzLm1fSSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2ludkkgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlci5TZXRaZXJvKCk7XHJcbiAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSB8fCB0aGlzLm1fdHlwZSA9PSBiMkJvZHkuYjJfa2luZW1hdGljQm9keSkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGNlbnRlciA9IGIyVmVjMi5NYWtlKDAsIDApO1xyXG4gICAgICBmb3IgKHZhciBmID0gdGhpcy5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcclxuICAgICAgICAgaWYgKGYubV9kZW5zaXR5ID09IDAuMCkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgbWFzc0RhdGEgPSBmLkdldE1hc3NEYXRhKCk7XHJcbiAgICAgICAgIHRoaXMubV9tYXNzICs9IG1hc3NEYXRhLm1hc3M7XHJcbiAgICAgICAgIGNlbnRlci54ICs9IG1hc3NEYXRhLmNlbnRlci54ICogbWFzc0RhdGEubWFzcztcclxuICAgICAgICAgY2VudGVyLnkgKz0gbWFzc0RhdGEuY2VudGVyLnkgKiBtYXNzRGF0YS5tYXNzO1xyXG4gICAgICAgICB0aGlzLm1fSSArPSBtYXNzRGF0YS5JO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fbWFzcyA+IDAuMCkge1xyXG4gICAgICAgICB0aGlzLm1faW52TWFzcyA9IDEuMCAvIHRoaXMubV9tYXNzO1xyXG4gICAgICAgICBjZW50ZXIueCAqPSB0aGlzLm1faW52TWFzcztcclxuICAgICAgICAgY2VudGVyLnkgKj0gdGhpcy5tX2ludk1hc3M7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9tYXNzID0gMS4wO1xyXG4gICAgICAgICB0aGlzLm1faW52TWFzcyA9IDEuMDtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX0kgPiAwLjAgJiYgKHRoaXMubV9mbGFncyAmIGIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnKSA9PSAwKSB7XHJcbiAgICAgICAgIHRoaXMubV9JIC09IHRoaXMubV9tYXNzICogKGNlbnRlci54ICogY2VudGVyLnggKyBjZW50ZXIueSAqIGNlbnRlci55KTtcclxuICAgICAgICAgdGhpcy5tX0kgKj0gdGhpcy5tX2luZXJ0aWFTY2FsZTtcclxuICAgICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydCh0aGlzLm1fSSA+IDApO1xyXG4gICAgICAgICB0aGlzLm1faW52SSA9IDEuMCAvIHRoaXMubV9JO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fSSA9IDAuMDtcclxuICAgICAgICAgdGhpcy5tX2ludkkgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIG9sZENlbnRlciA9IHRoaXMubV9zd2VlcC5jLkNvcHkoKTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyLlNldFYoY2VudGVyKTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmMwLlNldFYoYjJNYXRoLk11bFgodGhpcy5tX3hmLCB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXIpKTtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmMuU2V0Vih0aGlzLm1fc3dlZXAuYzApO1xyXG4gICAgICB0aGlzLm1fbGluZWFyVmVsb2NpdHkueCArPSB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICogKC0odGhpcy5tX3N3ZWVwLmMueSAtIG9sZENlbnRlci55KSk7XHJcbiAgICAgIHRoaXMubV9saW5lYXJWZWxvY2l0eS55ICs9IHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKiAoKyh0aGlzLm1fc3dlZXAuYy54IC0gb2xkQ2VudGVyLngpKTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldFdvcmxkUG9pbnQgPSBmdW5jdGlvbiAobG9jYWxQb2ludCkge1xyXG4gICAgICB2YXIgQSA9IHRoaXMubV94Zi5SO1xyXG4gICAgICB2YXIgdSA9IG5ldyBiMlZlYzIoQS5jb2wxLnggKiBsb2NhbFBvaW50LnggKyBBLmNvbDIueCAqIGxvY2FsUG9pbnQueSwgQS5jb2wxLnkgKiBsb2NhbFBvaW50LnggKyBBLmNvbDIueSAqIGxvY2FsUG9pbnQueSk7XHJcbiAgICAgIHUueCArPSB0aGlzLm1feGYucG9zaXRpb24ueDtcclxuICAgICAgdS55ICs9IHRoaXMubV94Zi5wb3NpdGlvbi55O1xyXG4gICAgICByZXR1cm4gdTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldFdvcmxkVmVjdG9yID0gZnVuY3Rpb24gKGxvY2FsVmVjdG9yKSB7XHJcbiAgICAgIHJldHVybiBiMk1hdGguTXVsTVYodGhpcy5tX3hmLlIsIGxvY2FsVmVjdG9yKTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldExvY2FsUG9pbnQgPSBmdW5jdGlvbiAod29ybGRQb2ludCkge1xyXG4gICAgICByZXR1cm4gYjJNYXRoLk11bFhUKHRoaXMubV94Ziwgd29ybGRQb2ludCk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRMb2NhbFZlY3RvciA9IGZ1bmN0aW9uICh3b3JsZFZlY3Rvcikge1xyXG4gICAgICByZXR1cm4gYjJNYXRoLk11bFRNVih0aGlzLm1feGYuUiwgd29ybGRWZWN0b3IpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0TGluZWFyVmVsb2NpdHlGcm9tV29ybGRQb2ludCA9IGZ1bmN0aW9uICh3b3JsZFBvaW50KSB7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKHRoaXMubV9saW5lYXJWZWxvY2l0eS54IC0gdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSAqICh3b3JsZFBvaW50LnkgLSB0aGlzLm1fc3dlZXAuYy55KSwgdGhpcy5tX2xpbmVhclZlbG9jaXR5LnkgKyB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ICogKHdvcmxkUG9pbnQueCAtIHRoaXMubV9zd2VlcC5jLngpKTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldExpbmVhclZlbG9jaXR5RnJvbUxvY2FsUG9pbnQgPSBmdW5jdGlvbiAobG9jYWxQb2ludCkge1xyXG4gICAgICB2YXIgQSA9IHRoaXMubV94Zi5SO1xyXG4gICAgICB2YXIgd29ybGRQb2ludCA9IG5ldyBiMlZlYzIoQS5jb2wxLnggKiBsb2NhbFBvaW50LnggKyBBLmNvbDIueCAqIGxvY2FsUG9pbnQueSwgQS5jb2wxLnkgKiBsb2NhbFBvaW50LnggKyBBLmNvbDIueSAqIGxvY2FsUG9pbnQueSk7XHJcbiAgICAgIHdvcmxkUG9pbnQueCArPSB0aGlzLm1feGYucG9zaXRpb24ueDtcclxuICAgICAgd29ybGRQb2ludC55ICs9IHRoaXMubV94Zi5wb3NpdGlvbi55O1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMih0aGlzLm1fbGluZWFyVmVsb2NpdHkueCAtIHRoaXMubV9hbmd1bGFyVmVsb2NpdHkgKiAod29ybGRQb2ludC55IC0gdGhpcy5tX3N3ZWVwLmMueSksIHRoaXMubV9saW5lYXJWZWxvY2l0eS55ICsgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSAqICh3b3JsZFBvaW50LnggLSB0aGlzLm1fc3dlZXAuYy54KSk7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRMaW5lYXJEYW1waW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2xpbmVhckRhbXBpbmc7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRMaW5lYXJEYW1waW5nID0gZnVuY3Rpb24gKGxpbmVhckRhbXBpbmcpIHtcclxuICAgICAgaWYgKGxpbmVhckRhbXBpbmcgPT09IHVuZGVmaW5lZCkgbGluZWFyRGFtcGluZyA9IDA7XHJcbiAgICAgIHRoaXMubV9saW5lYXJEYW1waW5nID0gbGluZWFyRGFtcGluZztcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldEFuZ3VsYXJEYW1waW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2FuZ3VsYXJEYW1waW5nO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0QW5ndWxhckRhbXBpbmcgPSBmdW5jdGlvbiAoYW5ndWxhckRhbXBpbmcpIHtcclxuICAgICAgaWYgKGFuZ3VsYXJEYW1waW5nID09PSB1bmRlZmluZWQpIGFuZ3VsYXJEYW1waW5nID0gMDtcclxuICAgICAgdGhpcy5tX2FuZ3VsYXJEYW1waW5nID0gYW5ndWxhckRhbXBpbmc7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRUeXBlID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgICAgaWYgKHR5cGUgPT09IHVuZGVmaW5lZCkgdHlwZSA9IDA7XHJcbiAgICAgIGlmICh0aGlzLm1fdHlwZSA9PSB0eXBlKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fdHlwZSA9IHR5cGU7XHJcbiAgICAgIHRoaXMuUmVzZXRNYXNzRGF0YSgpO1xyXG4gICAgICBpZiAodGhpcy5tX3R5cGUgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcclxuICAgICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LlNldFplcm8oKTtcclxuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IDAuMDtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fZm9yY2UuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fdG9ycXVlID0gMC4wO1xyXG4gICAgICBmb3IgKHZhciBjZSA9IHRoaXMubV9jb250YWN0TGlzdDsgY2U7IGNlID0gY2UubmV4dCkge1xyXG4gICAgICAgICBjZS5jb250YWN0LkZsYWdGb3JGaWx0ZXJpbmcoKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV90eXBlO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0QnVsbGV0ID0gZnVuY3Rpb24gKGZsYWcpIHtcclxuICAgICAgaWYgKGZsYWcpIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2J1bGxldEZsYWc7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyAmPSB+YjJCb2R5LmVfYnVsbGV0RmxhZztcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuSXNCdWxsZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfYnVsbGV0RmxhZykgPT0gYjJCb2R5LmVfYnVsbGV0RmxhZztcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlNldFNsZWVwaW5nQWxsb3dlZCA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgIGlmIChmbGFnKSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkJvZHkuZV9hbGxvd1NsZWVwRmxhZztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkJvZHkuZV9hbGxvd1NsZWVwRmxhZztcclxuICAgICAgICAgdGhpcy5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0QXdha2UgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICBpZiAoZmxhZykge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJCb2R5LmVfYXdha2VGbGFnO1xyXG4gICAgICAgICB0aGlzLm1fc2xlZXBUaW1lID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyQm9keS5lX2F3YWtlRmxhZztcclxuICAgICAgICAgdGhpcy5tX3NsZWVwVGltZSA9IDAuMDtcclxuICAgICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LlNldFplcm8oKTtcclxuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJWZWxvY2l0eSA9IDAuMDtcclxuICAgICAgICAgdGhpcy5tX2ZvcmNlLlNldFplcm8oKTtcclxuICAgICAgICAgdGhpcy5tX3RvcnF1ZSA9IDAuMDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuSXNBd2FrZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9hd2FrZUZsYWcpID09IGIyQm9keS5lX2F3YWtlRmxhZztcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLlNldEZpeGVkUm90YXRpb24gPSBmdW5jdGlvbiAoZml4ZWQpIHtcclxuICAgICAgaWYgKGZpeGVkKSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZztcclxuICAgICAgfVxyXG4gICAgICB0aGlzLlJlc2V0TWFzc0RhdGEoKTtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLklzRml4ZWRSb3RhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZykgPT0gYjJCb2R5LmVfZml4ZWRSb3RhdGlvbkZsYWc7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TZXRBY3RpdmUgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICBpZiAoZmxhZyA9PSB0aGlzLklzQWN0aXZlKCkpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBicm9hZFBoYXNlO1xyXG4gICAgICB2YXIgZjtcclxuICAgICAgaWYgKGZsYWcpIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2FjdGl2ZUZsYWc7XHJcbiAgICAgICAgIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcbiAgICAgICAgIGZvciAoZiA9IHRoaXMubV9maXh0dXJlTGlzdDtcclxuICAgICAgICAgZjsgZiA9IGYubV9uZXh0KSB7XHJcbiAgICAgICAgICAgIGYuQ3JlYXRlUHJveHkoYnJvYWRQaGFzZSwgdGhpcy5tX3hmKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyQm9keS5lX2FjdGl2ZUZsYWc7XHJcbiAgICAgICAgIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcbiAgICAgICAgIGZvciAoZiA9IHRoaXMubV9maXh0dXJlTGlzdDtcclxuICAgICAgICAgZjsgZiA9IGYubV9uZXh0KSB7XHJcbiAgICAgICAgICAgIGYuRGVzdHJveVByb3h5KGJyb2FkUGhhc2UpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciBjZSA9IHRoaXMubV9jb250YWN0TGlzdDtcclxuICAgICAgICAgd2hpbGUgKGNlKSB7XHJcbiAgICAgICAgICAgIHZhciBjZTAgPSBjZTtcclxuICAgICAgICAgICAgY2UgPSBjZS5uZXh0O1xyXG4gICAgICAgICAgICB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5EZXN0cm95KGNlMC5jb250YWN0KTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5Jc0FjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLm1fZmxhZ3MgJiBiMkJvZHkuZV9hY3RpdmVGbGFnKSA9PSBiMkJvZHkuZV9hY3RpdmVGbGFnO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuSXNTbGVlcGluZ0FsbG93ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy5tX2ZsYWdzICYgYjJCb2R5LmVfYWxsb3dTbGVlcEZsYWcpID09IGIyQm9keS5lX2FsbG93U2xlZXBGbGFnO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0Rml4dHVyZUxpc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZml4dHVyZUxpc3Q7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRKb2ludExpc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fam9pbnRMaXN0O1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0Q29udHJvbGxlckxpc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fY29udHJvbGxlckxpc3Q7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5HZXRDb250YWN0TGlzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jb250YWN0TGlzdDtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldE5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcclxuICAgfVxyXG4gICBiMkJvZHkucHJvdG90eXBlLkdldFVzZXJEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3VzZXJEYXRhO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2V0VXNlckRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBkYXRhO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuR2V0V29ybGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fd29ybGQ7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5iMkJvZHkgPSBmdW5jdGlvbiAoYmQsIHdvcmxkKSB7XHJcbiAgICAgIHRoaXMubV9mbGFncyA9IDA7XHJcbiAgICAgIGlmIChiZC5idWxsZXQpIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2J1bGxldEZsYWc7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGJkLmZpeGVkUm90YXRpb24pIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2ZpeGVkUm90YXRpb25GbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiZC5hbGxvd1NsZWVwKSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkJvZHkuZV9hbGxvd1NsZWVwRmxhZztcclxuICAgICAgfVxyXG4gICAgICBpZiAoYmQuYXdha2UpIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQm9keS5lX2F3YWtlRmxhZztcclxuICAgICAgfVxyXG4gICAgICBpZiAoYmQuYWN0aXZlKSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkJvZHkuZV9hY3RpdmVGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV93b3JsZCA9IHdvcmxkO1xyXG4gICAgICB0aGlzLm1feGYucG9zaXRpb24uU2V0VihiZC5wb3NpdGlvbik7XHJcbiAgICAgIHRoaXMubV94Zi5SLlNldChiZC5hbmdsZSk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5sb2NhbENlbnRlci5TZXRaZXJvKCk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC50MCA9IDEuMDtcclxuICAgICAgdGhpcy5tX3N3ZWVwLmEwID0gdGhpcy5tX3N3ZWVwLmEgPSBiZC5hbmdsZTtcclxuICAgICAgdmFyIHRNYXQgPSB0aGlzLm1feGYuUjtcclxuICAgICAgdmFyIHRWZWMgPSB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXI7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLnggPSAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLnkgPSAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLnggKz0gdGhpcy5tX3hmLnBvc2l0aW9uLng7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jLnkgKz0gdGhpcy5tX3hmLnBvc2l0aW9uLnk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5jMC5TZXRWKHRoaXMubV9zd2VlcC5jKTtcclxuICAgICAgdGhpcy5tX2pvaW50TGlzdCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9jb250cm9sbGVyTGlzdCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9jb250YWN0TGlzdCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9jb250cm9sbGVyQ291bnQgPSAwO1xyXG4gICAgICB0aGlzLm1fcHJldiA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2xpbmVhclZlbG9jaXR5LlNldFYoYmQubGluZWFyVmVsb2NpdHkpO1xyXG4gICAgICB0aGlzLm1fYW5ndWxhclZlbG9jaXR5ID0gYmQuYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB0aGlzLm1fbGluZWFyRGFtcGluZyA9IGJkLmxpbmVhckRhbXBpbmc7XHJcbiAgICAgIHRoaXMubV9hbmd1bGFyRGFtcGluZyA9IGJkLmFuZ3VsYXJEYW1waW5nO1xyXG4gICAgICB0aGlzLm1fZm9yY2UuU2V0KDAuMCwgMC4wKTtcclxuICAgICAgdGhpcy5tX3RvcnF1ZSA9IDAuMDtcclxuICAgICAgdGhpcy5tX3NsZWVwVGltZSA9IDAuMDtcclxuICAgICAgdGhpcy5tX3R5cGUgPSBiZC50eXBlO1xyXG4gICAgICBpZiAodGhpcy5tX3R5cGUgPT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSB7XHJcbiAgICAgICAgIHRoaXMubV9tYXNzID0gMS4wO1xyXG4gICAgICAgICB0aGlzLm1faW52TWFzcyA9IDEuMDtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX21hc3MgPSAwLjA7XHJcbiAgICAgICAgIHRoaXMubV9pbnZNYXNzID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9JID0gMC4wO1xyXG4gICAgICB0aGlzLm1faW52SSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2luZXJ0aWFTY2FsZSA9IGJkLmluZXJ0aWFTY2FsZTtcclxuICAgICAgdGhpcy5tX3VzZXJEYXRhID0gYmQudXNlckRhdGE7XHJcbiAgICAgIHRoaXMubV9maXh0dXJlTGlzdCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9maXh0dXJlQ291bnQgPSAwO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU3luY2hyb25pemVGaXh0dXJlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHhmMSA9IGIyQm9keS5zX3hmMTtcclxuICAgICAgeGYxLlIuU2V0KHRoaXMubV9zd2VlcC5hMCk7XHJcbiAgICAgIHZhciB0TWF0ID0geGYxLlI7XHJcbiAgICAgIHZhciB0VmVjID0gdGhpcy5tX3N3ZWVwLmxvY2FsQ2VudGVyO1xyXG4gICAgICB4ZjEucG9zaXRpb24ueCA9IHRoaXMubV9zd2VlcC5jMC54IC0gKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICB4ZjEucG9zaXRpb24ueSA9IHRoaXMubV9zd2VlcC5jMC55IC0gKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICB2YXIgZjtcclxuICAgICAgdmFyIGJyb2FkUGhhc2UgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcbiAgICAgIGZvciAoZiA9IHRoaXMubV9maXh0dXJlTGlzdDtcclxuICAgICAgZjsgZiA9IGYubV9uZXh0KSB7XHJcbiAgICAgICAgIGYuU3luY2hyb25pemUoYnJvYWRQaGFzZSwgeGYxLCB0aGlzLm1feGYpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5TeW5jaHJvbml6ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3hmLlIuU2V0KHRoaXMubV9zd2VlcC5hKTtcclxuICAgICAgdmFyIHRNYXQgPSB0aGlzLm1feGYuUjtcclxuICAgICAgdmFyIHRWZWMgPSB0aGlzLm1fc3dlZXAubG9jYWxDZW50ZXI7XHJcbiAgICAgIHRoaXMubV94Zi5wb3NpdGlvbi54ID0gdGhpcy5tX3N3ZWVwLmMueCAtICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgdGhpcy5tX3hmLnBvc2l0aW9uLnkgPSB0aGlzLm1fc3dlZXAuYy55IC0gKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICB9XHJcbiAgIGIyQm9keS5wcm90b3R5cGUuU2hvdWxkQ29sbGlkZSA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICBpZiAodGhpcy5tX3R5cGUgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5ICYmIG90aGVyLm1fdHlwZSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIHtcclxuICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAodmFyIGpuID0gdGhpcy5tX2pvaW50TGlzdDsgam47IGpuID0gam4ubmV4dCkge1xyXG4gICAgICAgICBpZiAoam4ub3RoZXIgPT0gb3RoZXIpIGlmIChqbi5qb2ludC5tX2NvbGxpZGVDb25uZWN0ZWQgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgYjJCb2R5LnByb3RvdHlwZS5BZHZhbmNlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgaWYgKHQgPT09IHVuZGVmaW5lZCkgdCA9IDA7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5BZHZhbmNlKHQpO1xyXG4gICAgICB0aGlzLm1fc3dlZXAuYy5TZXRWKHRoaXMubV9zd2VlcC5jMCk7XHJcbiAgICAgIHRoaXMubV9zd2VlcC5hID0gdGhpcy5tX3N3ZWVwLmEwO1xyXG4gICAgICB0aGlzLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5zX3hmMSA9IG5ldyBiMlRyYW5zZm9ybSgpO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuZV9pc2xhbmRGbGFnID0gMHgwMDAxO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuZV9hd2FrZUZsYWcgPSAweDAwMDI7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5lX2FsbG93U2xlZXBGbGFnID0gMHgwMDA0O1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuZV9idWxsZXRGbGFnID0gMHgwMDA4O1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuZV9maXhlZFJvdGF0aW9uRmxhZyA9IDB4MDAxMDtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJCb2R5LmVfYWN0aXZlRmxhZyA9IDB4MDAyMDtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJCb2R5LmIyX3N0YXRpY0JvZHkgPSAwO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkJvZHkuYjJfa2luZW1hdGljQm9keSA9IDE7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyQm9keS5iMl9keW5hbWljQm9keSA9IDI7XHJcbiAgIH0pO1xyXG4gICBiMkJvZHlEZWYuYjJCb2R5RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnBvc2l0aW9uID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxpbmVhclZlbG9jaXR5ID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkJvZHlEZWYucHJvdG90eXBlLmIyQm9keURlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy51c2VyRGF0YSA9IG51bGw7XHJcbiAgICAgIHRoaXMucG9zaXRpb24uU2V0KDAuMCwgMC4wKTtcclxuICAgICAgdGhpcy5hbmdsZSA9IDAuMDtcclxuICAgICAgdGhpcy5saW5lYXJWZWxvY2l0eS5TZXQoMCwgMCk7XHJcbiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5ID0gMC4wO1xyXG4gICAgICB0aGlzLmxpbmVhckRhbXBpbmcgPSAwLjA7XHJcbiAgICAgIHRoaXMuYW5ndWxhckRhbXBpbmcgPSAwLjA7XHJcbiAgICAgIHRoaXMuYWxsb3dTbGVlcCA9IHRydWU7XHJcbiAgICAgIHRoaXMuYXdha2UgPSB0cnVlO1xyXG4gICAgICB0aGlzLmZpeGVkUm90YXRpb24gPSBmYWxzZTtcclxuICAgICAgdGhpcy5idWxsZXQgPSBmYWxzZTtcclxuICAgICAgdGhpcy50eXBlID0gYjJCb2R5LmIyX3N0YXRpY0JvZHk7XHJcbiAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgdGhpcy5pbmVydGlhU2NhbGUgPSAxLjA7XHJcbiAgIH1cclxuICAgYjJDb250YWN0RmlsdGVyLmIyQ29udGFjdEZpbHRlciA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkNvbnRhY3RGaWx0ZXIucHJvdG90eXBlLlNob3VsZENvbGxpZGUgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XHJcbiAgICAgIHZhciBmaWx0ZXIxID0gZml4dHVyZUEuR2V0RmlsdGVyRGF0YSgpO1xyXG4gICAgICB2YXIgZmlsdGVyMiA9IGZpeHR1cmVCLkdldEZpbHRlckRhdGEoKTtcclxuICAgICAgaWYgKGZpbHRlcjEuZ3JvdXBJbmRleCA9PSBmaWx0ZXIyLmdyb3VwSW5kZXggJiYgZmlsdGVyMS5ncm91cEluZGV4ICE9IDApIHtcclxuICAgICAgICAgcmV0dXJuIGZpbHRlcjEuZ3JvdXBJbmRleCA+IDA7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGNvbGxpZGUgPSAoZmlsdGVyMS5tYXNrQml0cyAmIGZpbHRlcjIuY2F0ZWdvcnlCaXRzKSAhPSAwICYmIChmaWx0ZXIxLmNhdGVnb3J5Qml0cyAmIGZpbHRlcjIubWFza0JpdHMpICE9IDA7XHJcbiAgICAgIHJldHVybiBjb2xsaWRlO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdEZpbHRlci5wcm90b3R5cGUuUmF5Q29sbGlkZSA9IGZ1bmN0aW9uICh1c2VyRGF0YSwgZml4dHVyZSkge1xyXG4gICAgICBpZiAoIXVzZXJEYXRhKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgcmV0dXJuIHRoaXMuU2hvdWxkQ29sbGlkZSgodXNlckRhdGEgaW5zdGFuY2VvZiBiMkZpeHR1cmUgPyB1c2VyRGF0YSA6IG51bGwpLCBmaXh0dXJlKTtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJDb250YWN0RmlsdGVyLmIyX2RlZmF1bHRGaWx0ZXIgPSBuZXcgYjJDb250YWN0RmlsdGVyKCk7XHJcbiAgIH0pO1xyXG4gICBiMkNvbnRhY3RJbXB1bHNlLmIyQ29udGFjdEltcHVsc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubm9ybWFsSW1wdWxzZXMgPSBuZXcgVmVjdG9yX2Eyal9OdW1iZXIoYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyk7XHJcbiAgICAgIHRoaXMudGFuZ2VudEltcHVsc2VzID0gbmV3IFZlY3Rvcl9hMmpfTnVtYmVyKGIyU2V0dGluZ3MuYjJfbWF4TWFuaWZvbGRQb2ludHMpO1xyXG4gICB9O1xyXG4gICBiMkNvbnRhY3RMaXN0ZW5lci5iMkNvbnRhY3RMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkNvbnRhY3RMaXN0ZW5lci5wcm90b3R5cGUuQmVnaW5Db250YWN0ID0gZnVuY3Rpb24gKGNvbnRhY3QpIHt9XHJcbiAgIGIyQ29udGFjdExpc3RlbmVyLnByb3RvdHlwZS5FbmRDb250YWN0ID0gZnVuY3Rpb24gKGNvbnRhY3QpIHt9XHJcbiAgIGIyQ29udGFjdExpc3RlbmVyLnByb3RvdHlwZS5QcmVTb2x2ZSA9IGZ1bmN0aW9uIChjb250YWN0LCBvbGRNYW5pZm9sZCkge31cclxuICAgYjJDb250YWN0TGlzdGVuZXIucHJvdG90eXBlLlBvc3RTb2x2ZSA9IGZ1bmN0aW9uIChjb250YWN0LCBpbXB1bHNlKSB7fVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJDb250YWN0TGlzdGVuZXIuYjJfZGVmYXVsdExpc3RlbmVyID0gbmV3IGIyQ29udGFjdExpc3RlbmVyKCk7XHJcbiAgIH0pO1xyXG4gICBiMkNvbnRhY3RNYW5hZ2VyLmIyQ29udGFjdE1hbmFnZXIgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJDb250YWN0TWFuYWdlci5wcm90b3R5cGUuYjJDb250YWN0TWFuYWdlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3dvcmxkID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9jb250YWN0RmlsdGVyID0gYjJDb250YWN0RmlsdGVyLmIyX2RlZmF1bHRGaWx0ZXI7XHJcbiAgICAgIHRoaXMubV9jb250YWN0TGlzdGVuZXIgPSBiMkNvbnRhY3RMaXN0ZW5lci5iMl9kZWZhdWx0TGlzdGVuZXI7XHJcbiAgICAgIHRoaXMubV9jb250YWN0RmFjdG9yeSA9IG5ldyBiMkNvbnRhY3RGYWN0b3J5KHRoaXMubV9hbGxvY2F0b3IpO1xyXG4gICAgICB0aGlzLm1fYnJvYWRQaGFzZSA9IG5ldyBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSgpO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdE1hbmFnZXIucHJvdG90eXBlLkFkZFBhaXIgPSBmdW5jdGlvbiAocHJveHlVc2VyRGF0YUEsIHByb3h5VXNlckRhdGFCKSB7XHJcbiAgICAgIHZhciBmaXh0dXJlQSA9IChwcm94eVVzZXJEYXRhQSBpbnN0YW5jZW9mIGIyRml4dHVyZSA/IHByb3h5VXNlckRhdGFBIDogbnVsbCk7XHJcbiAgICAgIHZhciBmaXh0dXJlQiA9IChwcm94eVVzZXJEYXRhQiBpbnN0YW5jZW9mIGIyRml4dHVyZSA/IHByb3h5VXNlckRhdGFCIDogbnVsbCk7XHJcbiAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLkdldEJvZHkoKTtcclxuICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIuR2V0Qm9keSgpO1xyXG4gICAgICBpZiAoYm9keUEgPT0gYm9keUIpIHJldHVybjtcclxuICAgICAgdmFyIGVkZ2UgPSBib2R5Qi5HZXRDb250YWN0TGlzdCgpO1xyXG4gICAgICB3aGlsZSAoZWRnZSkge1xyXG4gICAgICAgICBpZiAoZWRnZS5vdGhlciA9PSBib2R5QSkge1xyXG4gICAgICAgICAgICB2YXIgZkEgPSBlZGdlLmNvbnRhY3QuR2V0Rml4dHVyZUEoKTtcclxuICAgICAgICAgICAgdmFyIGZCID0gZWRnZS5jb250YWN0LkdldEZpeHR1cmVCKCk7XHJcbiAgICAgICAgICAgIGlmIChmQSA9PSBmaXh0dXJlQSAmJiBmQiA9PSBmaXh0dXJlQikgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiAoZkEgPT0gZml4dHVyZUIgJiYgZkIgPT0gZml4dHVyZUEpIHJldHVybjtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlZGdlID0gZWRnZS5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChib2R5Qi5TaG91bGRDb2xsaWRlKGJvZHlBKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubV9jb250YWN0RmlsdGVyLlNob3VsZENvbGxpZGUoZml4dHVyZUEsIGZpeHR1cmVCKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGMgPSB0aGlzLm1fY29udGFjdEZhY3RvcnkuQ3JlYXRlKGZpeHR1cmVBLCBmaXh0dXJlQik7XHJcbiAgICAgIGZpeHR1cmVBID0gYy5HZXRGaXh0dXJlQSgpO1xyXG4gICAgICBmaXh0dXJlQiA9IGMuR2V0Rml4dHVyZUIoKTtcclxuICAgICAgYm9keUEgPSBmaXh0dXJlQS5tX2JvZHk7XHJcbiAgICAgIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xyXG4gICAgICBjLm1fcHJldiA9IG51bGw7XHJcbiAgICAgIGMubV9uZXh0ID0gdGhpcy5tX3dvcmxkLm1fY29udGFjdExpc3Q7XHJcbiAgICAgIGlmICh0aGlzLm1fd29ybGQubV9jb250YWN0TGlzdCAhPSBudWxsKSB7XHJcbiAgICAgICAgIHRoaXMubV93b3JsZC5tX2NvbnRhY3RMaXN0Lm1fcHJldiA9IGM7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX3dvcmxkLm1fY29udGFjdExpc3QgPSBjO1xyXG4gICAgICBjLm1fbm9kZUEuY29udGFjdCA9IGM7XHJcbiAgICAgIGMubV9ub2RlQS5vdGhlciA9IGJvZHlCO1xyXG4gICAgICBjLm1fbm9kZUEucHJldiA9IG51bGw7XHJcbiAgICAgIGMubV9ub2RlQS5uZXh0ID0gYm9keUEubV9jb250YWN0TGlzdDtcclxuICAgICAgaWYgKGJvZHlBLm1fY29udGFjdExpc3QgIT0gbnVsbCkge1xyXG4gICAgICAgICBib2R5QS5tX2NvbnRhY3RMaXN0LnByZXYgPSBjLm1fbm9kZUE7XHJcbiAgICAgIH1cclxuICAgICAgYm9keUEubV9jb250YWN0TGlzdCA9IGMubV9ub2RlQTtcclxuICAgICAgYy5tX25vZGVCLmNvbnRhY3QgPSBjO1xyXG4gICAgICBjLm1fbm9kZUIub3RoZXIgPSBib2R5QTtcclxuICAgICAgYy5tX25vZGVCLnByZXYgPSBudWxsO1xyXG4gICAgICBjLm1fbm9kZUIubmV4dCA9IGJvZHlCLm1fY29udGFjdExpc3Q7XHJcbiAgICAgIGlmIChib2R5Qi5tX2NvbnRhY3RMaXN0ICE9IG51bGwpIHtcclxuICAgICAgICAgYm9keUIubV9jb250YWN0TGlzdC5wcmV2ID0gYy5tX25vZGVCO1xyXG4gICAgICB9XHJcbiAgICAgIGJvZHlCLm1fY29udGFjdExpc3QgPSBjLm1fbm9kZUI7XHJcbiAgICAgICsrdGhpcy5tX3dvcmxkLm1fY29udGFjdENvdW50O1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgYjJDb250YWN0TWFuYWdlci5wcm90b3R5cGUuRmluZE5ld0NvbnRhY3RzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fYnJvYWRQaGFzZS5VcGRhdGVQYWlycyhCb3gyRC5nZW5lcmF0ZUNhbGxiYWNrKHRoaXMsIHRoaXMuQWRkUGFpcikpO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdE1hbmFnZXIucHJvdG90eXBlLkRlc3Ryb3kgPSBmdW5jdGlvbiAoYykge1xyXG4gICAgICB2YXIgZml4dHVyZUEgPSBjLkdldEZpeHR1cmVBKCk7XHJcbiAgICAgIHZhciBmaXh0dXJlQiA9IGMuR2V0Rml4dHVyZUIoKTtcclxuICAgICAgdmFyIGJvZHlBID0gZml4dHVyZUEuR2V0Qm9keSgpO1xyXG4gICAgICB2YXIgYm9keUIgPSBmaXh0dXJlQi5HZXRCb2R5KCk7XHJcbiAgICAgIGlmIChjLklzVG91Y2hpbmcoKSkge1xyXG4gICAgICAgICB0aGlzLm1fY29udGFjdExpc3RlbmVyLkVuZENvbnRhY3QoYyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGMubV9wcmV2KSB7XHJcbiAgICAgICAgIGMubV9wcmV2Lm1fbmV4dCA9IGMubV9uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChjLm1fbmV4dCkge1xyXG4gICAgICAgICBjLm1fbmV4dC5tX3ByZXYgPSBjLm1fcHJldjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYyA9PSB0aGlzLm1fd29ybGQubV9jb250YWN0TGlzdCkge1xyXG4gICAgICAgICB0aGlzLm1fd29ybGQubV9jb250YWN0TGlzdCA9IGMubV9uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChjLm1fbm9kZUEucHJldikge1xyXG4gICAgICAgICBjLm1fbm9kZUEucHJldi5uZXh0ID0gYy5tX25vZGVBLm5leHQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGMubV9ub2RlQS5uZXh0KSB7XHJcbiAgICAgICAgIGMubV9ub2RlQS5uZXh0LnByZXYgPSBjLm1fbm9kZUEucHJldjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYy5tX25vZGVBID09IGJvZHlBLm1fY29udGFjdExpc3QpIHtcclxuICAgICAgICAgYm9keUEubV9jb250YWN0TGlzdCA9IGMubV9ub2RlQS5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChjLm1fbm9kZUIucHJldikge1xyXG4gICAgICAgICBjLm1fbm9kZUIucHJldi5uZXh0ID0gYy5tX25vZGVCLm5leHQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGMubV9ub2RlQi5uZXh0KSB7XHJcbiAgICAgICAgIGMubV9ub2RlQi5uZXh0LnByZXYgPSBjLm1fbm9kZUIucHJldjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoYy5tX25vZGVCID09IGJvZHlCLm1fY29udGFjdExpc3QpIHtcclxuICAgICAgICAgYm9keUIubV9jb250YWN0TGlzdCA9IGMubV9ub2RlQi5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9jb250YWN0RmFjdG9yeS5EZXN0cm95KGMpO1xyXG4gICAgICAtLXRoaXMubV9jb250YWN0Q291bnQ7XHJcbiAgIH1cclxuICAgYjJDb250YWN0TWFuYWdlci5wcm90b3R5cGUuQ29sbGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGMgPSB0aGlzLm1fd29ybGQubV9jb250YWN0TGlzdDtcclxuICAgICAgd2hpbGUgKGMpIHtcclxuICAgICAgICAgdmFyIGZpeHR1cmVBID0gYy5HZXRGaXh0dXJlQSgpO1xyXG4gICAgICAgICB2YXIgZml4dHVyZUIgPSBjLkdldEZpeHR1cmVCKCk7XHJcbiAgICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLkdldEJvZHkoKTtcclxuICAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIuR2V0Qm9keSgpO1xyXG4gICAgICAgICBpZiAoYm9keUEuSXNBd2FrZSgpID09IGZhbHNlICYmIGJvZHlCLklzQXdha2UoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBjID0gYy5HZXROZXh0KCk7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChjLm1fZmxhZ3MgJiBiMkNvbnRhY3QuZV9maWx0ZXJGbGFnKSB7XHJcbiAgICAgICAgICAgIGlmIChib2R5Qi5TaG91bGRDb2xsaWRlKGJvZHlBKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICB2YXIgY051a2UgPSBjO1xyXG4gICAgICAgICAgICAgICBjID0gY051a2UuR2V0TmV4dCgpO1xyXG4gICAgICAgICAgICAgICB0aGlzLkRlc3Ryb3koY051a2UpO1xyXG4gICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5tX2NvbnRhY3RGaWx0ZXIuU2hvdWxkQ29sbGlkZShmaXh0dXJlQSwgZml4dHVyZUIpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgIGNOdWtlID0gYztcclxuICAgICAgICAgICAgICAgYyA9IGNOdWtlLkdldE5leHQoKTtcclxuICAgICAgICAgICAgICAgdGhpcy5EZXN0cm95KGNOdWtlKTtcclxuICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYy5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV9maWx0ZXJGbGFnO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciBwcm94eUEgPSBmaXh0dXJlQS5tX3Byb3h5O1xyXG4gICAgICAgICB2YXIgcHJveHlCID0gZml4dHVyZUIubV9wcm94eTtcclxuICAgICAgICAgdmFyIG92ZXJsYXAgPSB0aGlzLm1fYnJvYWRQaGFzZS5UZXN0T3ZlcmxhcChwcm94eUEsIHByb3h5Qik7XHJcbiAgICAgICAgIGlmIChvdmVybGFwID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGNOdWtlID0gYztcclxuICAgICAgICAgICAgYyA9IGNOdWtlLkdldE5leHQoKTtcclxuICAgICAgICAgICAgdGhpcy5EZXN0cm95KGNOdWtlKTtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYy5VcGRhdGUodGhpcy5tX2NvbnRhY3RMaXN0ZW5lcik7XHJcbiAgICAgICAgIGMgPSBjLkdldE5leHQoKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RNYW5hZ2VyLnNfZXZhbENQID0gbmV3IGIyQ29udGFjdFBvaW50KCk7XHJcbiAgIH0pO1xyXG4gICBiMkRlYnVnRHJhdy5iMkRlYnVnRHJhdyA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuYjJEZWJ1Z0RyYXcgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0RmxhZ3MgPSBmdW5jdGlvbiAoZmxhZ3MpIHtcclxuICAgICAgaWYgKGZsYWdzID09PSB1bmRlZmluZWQpIGZsYWdzID0gMDtcclxuICAgfVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0RmxhZ3MgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuQXBwZW5kRmxhZ3MgPSBmdW5jdGlvbiAoZmxhZ3MpIHtcclxuICAgICAgaWYgKGZsYWdzID09PSB1bmRlZmluZWQpIGZsYWdzID0gMDtcclxuICAgfVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuQ2xlYXJGbGFncyA9IGZ1bmN0aW9uIChmbGFncykge1xyXG4gICAgICBpZiAoZmxhZ3MgPT09IHVuZGVmaW5lZCkgZmxhZ3MgPSAwO1xyXG4gICB9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRTcHJpdGUgPSBmdW5jdGlvbiAoc3ByaXRlKSB7fVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0U3ByaXRlID0gZnVuY3Rpb24gKCkge31cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldERyYXdTY2FsZSA9IGZ1bmN0aW9uIChkcmF3U2NhbGUpIHtcclxuICAgICAgaWYgKGRyYXdTY2FsZSA9PT0gdW5kZWZpbmVkKSBkcmF3U2NhbGUgPSAwO1xyXG4gICB9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXREcmF3U2NhbGUgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0TGluZVRoaWNrbmVzcyA9IGZ1bmN0aW9uIChsaW5lVGhpY2tuZXNzKSB7XHJcbiAgICAgIGlmIChsaW5lVGhpY2tuZXNzID09PSB1bmRlZmluZWQpIGxpbmVUaGlja25lc3MgPSAwO1xyXG4gICB9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRMaW5lVGhpY2tuZXNzID0gZnVuY3Rpb24gKCkge31cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldEFscGhhID0gZnVuY3Rpb24gKGFscGhhKSB7XHJcbiAgICAgIGlmIChhbHBoYSA9PT0gdW5kZWZpbmVkKSBhbHBoYSA9IDA7XHJcbiAgIH1cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkdldEFscGhhID0gZnVuY3Rpb24gKCkge31cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldEZpbGxBbHBoYSA9IGZ1bmN0aW9uIChhbHBoYSkge1xyXG4gICAgICBpZiAoYWxwaGEgPT09IHVuZGVmaW5lZCkgYWxwaGEgPSAwO1xyXG4gICB9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRGaWxsQWxwaGEgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0WEZvcm1TY2FsZSA9IGZ1bmN0aW9uICh4Zm9ybVNjYWxlKSB7XHJcbiAgICAgIGlmICh4Zm9ybVNjYWxlID09PSB1bmRlZmluZWQpIHhmb3JtU2NhbGUgPSAwO1xyXG4gICB9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRYRm9ybVNjYWxlID0gZnVuY3Rpb24gKCkge31cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdQb2x5Z29uID0gZnVuY3Rpb24gKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCwgY29sb3IpIHtcclxuICAgICAgaWYgKHZlcnRleENvdW50ID09PSB1bmRlZmluZWQpIHZlcnRleENvdW50ID0gMDtcclxuICAgfVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1NvbGlkUG9seWdvbiA9IGZ1bmN0aW9uICh2ZXJ0aWNlcywgdmVydGV4Q291bnQsIGNvbG9yKSB7XHJcbiAgICAgIGlmICh2ZXJ0ZXhDb3VudCA9PT0gdW5kZWZpbmVkKSB2ZXJ0ZXhDb3VudCA9IDA7XHJcbiAgIH1cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdDaXJjbGUgPSBmdW5jdGlvbiAoY2VudGVyLCByYWRpdXMsIGNvbG9yKSB7XHJcbiAgICAgIGlmIChyYWRpdXMgPT09IHVuZGVmaW5lZCkgcmFkaXVzID0gMDtcclxuICAgfVxyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1NvbGlkQ2lyY2xlID0gZnVuY3Rpb24gKGNlbnRlciwgcmFkaXVzLCBheGlzLCBjb2xvcikge1xyXG4gICAgICBpZiAocmFkaXVzID09PSB1bmRlZmluZWQpIHJhZGl1cyA9IDA7XHJcbiAgIH1cclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdTZWdtZW50ID0gZnVuY3Rpb24gKHAxLCBwMiwgY29sb3IpIHt9XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3VHJhbnNmb3JtID0gZnVuY3Rpb24gKHhmKSB7fVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXcuZV9zaGFwZUJpdCA9IDB4MDAwMTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXcuZV9qb2ludEJpdCA9IDB4MDAwMjtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXcuZV9hYWJiQml0ID0gMHgwMDA0O1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdy5lX3BhaXJCaXQgPSAweDAwMDg7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LmVfY2VudGVyT2ZNYXNzQml0ID0gMHgwMDEwO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdy5lX2NvbnRyb2xsZXJCaXQgPSAweDAwMjA7XHJcbiAgIH0pO1xyXG4gICBiMkRlc3RydWN0aW9uTGlzdGVuZXIuYjJEZXN0cnVjdGlvbkxpc3RlbmVyID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyRGVzdHJ1Y3Rpb25MaXN0ZW5lci5wcm90b3R5cGUuU2F5R29vZGJ5ZUpvaW50ID0gZnVuY3Rpb24gKGpvaW50KSB7fVxyXG4gICBiMkRlc3RydWN0aW9uTGlzdGVuZXIucHJvdG90eXBlLlNheUdvb2RieWVGaXh0dXJlID0gZnVuY3Rpb24gKGZpeHR1cmUpIHt9XHJcbiAgIGIyRmlsdGVyRGF0YS5iMkZpbHRlckRhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuY2F0ZWdvcnlCaXRzID0gMHgwMDAxO1xyXG4gICAgICB0aGlzLm1hc2tCaXRzID0gMHhGRkZGO1xyXG4gICAgICB0aGlzLmdyb3VwSW5kZXggPSAwO1xyXG4gICB9O1xyXG4gICBiMkZpbHRlckRhdGEucHJvdG90eXBlLkNvcHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBjb3B5ID0gbmV3IGIyRmlsdGVyRGF0YSgpO1xyXG4gICAgICBjb3B5LmNhdGVnb3J5Qml0cyA9IHRoaXMuY2F0ZWdvcnlCaXRzO1xyXG4gICAgICBjb3B5Lm1hc2tCaXRzID0gdGhpcy5tYXNrQml0cztcclxuICAgICAgY29weS5ncm91cEluZGV4ID0gdGhpcy5ncm91cEluZGV4O1xyXG4gICAgICByZXR1cm4gY29weTtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUuYjJGaXh0dXJlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fZmlsdGVyID0gbmV3IGIyRmlsdGVyRGF0YSgpO1xyXG4gICB9O1xyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fc2hhcGUuR2V0VHlwZSgpO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0U2hhcGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fc2hhcGU7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5TZXRTZW5zb3IgPSBmdW5jdGlvbiAoc2Vuc29yKSB7XHJcbiAgICAgIGlmICh0aGlzLm1faXNTZW5zb3IgPT0gc2Vuc29yKSByZXR1cm47XHJcbiAgICAgIHRoaXMubV9pc1NlbnNvciA9IHNlbnNvcjtcclxuICAgICAgaWYgKHRoaXMubV9ib2R5ID09IG51bGwpIHJldHVybjtcclxuICAgICAgdmFyIGVkZ2UgPSB0aGlzLm1fYm9keS5HZXRDb250YWN0TGlzdCgpO1xyXG4gICAgICB3aGlsZSAoZWRnZSkge1xyXG4gICAgICAgICB2YXIgY29udGFjdCA9IGVkZ2UuY29udGFjdDtcclxuICAgICAgICAgdmFyIGZpeHR1cmVBID0gY29udGFjdC5HZXRGaXh0dXJlQSgpO1xyXG4gICAgICAgICB2YXIgZml4dHVyZUIgPSBjb250YWN0LkdldEZpeHR1cmVCKCk7XHJcbiAgICAgICAgIGlmIChmaXh0dXJlQSA9PSB0aGlzIHx8IGZpeHR1cmVCID09IHRoaXMpIGNvbnRhY3QuU2V0U2Vuc29yKGZpeHR1cmVBLklzU2Vuc29yKCkgfHwgZml4dHVyZUIuSXNTZW5zb3IoKSk7XHJcbiAgICAgICAgIGVkZ2UgPSBlZGdlLm5leHQ7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLklzU2Vuc29yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2lzU2Vuc29yO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuU2V0RmlsdGVyRGF0YSA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgdGhpcy5tX2ZpbHRlciA9IGZpbHRlci5Db3B5KCk7XHJcbiAgICAgIGlmICh0aGlzLm1fYm9keSkgcmV0dXJuO1xyXG4gICAgICB2YXIgZWRnZSA9IHRoaXMubV9ib2R5LkdldENvbnRhY3RMaXN0KCk7XHJcbiAgICAgIHdoaWxlIChlZGdlKSB7XHJcbiAgICAgICAgIHZhciBjb250YWN0ID0gZWRnZS5jb250YWN0O1xyXG4gICAgICAgICB2YXIgZml4dHVyZUEgPSBjb250YWN0LkdldEZpeHR1cmVBKCk7XHJcbiAgICAgICAgIHZhciBmaXh0dXJlQiA9IGNvbnRhY3QuR2V0Rml4dHVyZUIoKTtcclxuICAgICAgICAgaWYgKGZpeHR1cmVBID09IHRoaXMgfHwgZml4dHVyZUIgPT0gdGhpcykgY29udGFjdC5GbGFnRm9yRmlsdGVyaW5nKCk7XHJcbiAgICAgICAgIGVkZ2UgPSBlZGdlLm5leHQ7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldEZpbHRlckRhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZmlsdGVyLkNvcHkoKTtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldEJvZHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keTtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldE5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldFVzZXJEYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3VzZXJEYXRhO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuU2V0VXNlckRhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBkYXRhO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuVGVzdFBvaW50ID0gZnVuY3Rpb24gKHApIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9zaGFwZS5UZXN0UG9pbnQodGhpcy5tX2JvZHkuR2V0VHJhbnNmb3JtKCksIHApO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuUmF5Q2FzdCA9IGZ1bmN0aW9uIChvdXRwdXQsIGlucHV0KSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fc2hhcGUuUmF5Q2FzdChvdXRwdXQsIGlucHV0LCB0aGlzLm1fYm9keS5HZXRUcmFuc2Zvcm0oKSk7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXRNYXNzRGF0YSA9IGZ1bmN0aW9uIChtYXNzRGF0YSkge1xyXG4gICAgICBpZiAobWFzc0RhdGEgPT09IHVuZGVmaW5lZCkgbWFzc0RhdGEgPSBudWxsO1xyXG4gICAgICBpZiAobWFzc0RhdGEgPT0gbnVsbCkge1xyXG4gICAgICAgICBtYXNzRGF0YSA9IG5ldyBiMk1hc3NEYXRhKCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX3NoYXBlLkNvbXB1dGVNYXNzKG1hc3NEYXRhLCB0aGlzLm1fZGVuc2l0eSk7XHJcbiAgICAgIHJldHVybiBtYXNzRGF0YTtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLlNldERlbnNpdHkgPSBmdW5jdGlvbiAoZGVuc2l0eSkge1xyXG4gICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSBkZW5zaXR5ID0gMDtcclxuICAgICAgdGhpcy5tX2RlbnNpdHkgPSBkZW5zaXR5O1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0RGVuc2l0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9kZW5zaXR5O1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuR2V0RnJpY3Rpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZnJpY3Rpb247XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5TZXRGcmljdGlvbiA9IGZ1bmN0aW9uIChmcmljdGlvbikge1xyXG4gICAgICBpZiAoZnJpY3Rpb24gPT09IHVuZGVmaW5lZCkgZnJpY3Rpb24gPSAwO1xyXG4gICAgICB0aGlzLm1fZnJpY3Rpb24gPSBmcmljdGlvbjtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkdldFJlc3RpdHV0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3Jlc3RpdHV0aW9uO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuU2V0UmVzdGl0dXRpb24gPSBmdW5jdGlvbiAocmVzdGl0dXRpb24pIHtcclxuICAgICAgaWYgKHJlc3RpdHV0aW9uID09PSB1bmRlZmluZWQpIHJlc3RpdHV0aW9uID0gMDtcclxuICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gcmVzdGl0dXRpb247XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5HZXRBQUJCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2FhYmI7XHJcbiAgIH1cclxuICAgYjJGaXh0dXJlLnByb3RvdHlwZS5iMkZpeHR1cmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9hYWJiID0gbmV3IGIyQUFCQigpO1xyXG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fYm9keSA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9uZXh0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX3NoYXBlID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2RlbnNpdHkgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9mcmljdGlvbiA9IDAuMDtcclxuICAgICAgdGhpcy5tX3Jlc3RpdHV0aW9uID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuQ3JlYXRlID0gZnVuY3Rpb24gKGJvZHksIHhmLCBkZWYpIHtcclxuICAgICAgdGhpcy5tX3VzZXJEYXRhID0gZGVmLnVzZXJEYXRhO1xyXG4gICAgICB0aGlzLm1fZnJpY3Rpb24gPSBkZWYuZnJpY3Rpb247XHJcbiAgICAgIHRoaXMubV9yZXN0aXR1dGlvbiA9IGRlZi5yZXN0aXR1dGlvbjtcclxuICAgICAgdGhpcy5tX2JvZHkgPSBib2R5O1xyXG4gICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9maWx0ZXIgPSBkZWYuZmlsdGVyLkNvcHkoKTtcclxuICAgICAgdGhpcy5tX2lzU2Vuc29yID0gZGVmLmlzU2Vuc29yO1xyXG4gICAgICB0aGlzLm1fc2hhcGUgPSBkZWYuc2hhcGUuQ29weSgpO1xyXG4gICAgICB0aGlzLm1fZGVuc2l0eSA9IGRlZi5kZW5zaXR5O1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZS5wcm90b3R5cGUuRGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3NoYXBlID0gbnVsbDtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkNyZWF0ZVByb3h5ID0gZnVuY3Rpb24gKGJyb2FkUGhhc2UsIHhmKSB7XHJcbiAgICAgIHRoaXMubV9zaGFwZS5Db21wdXRlQUFCQih0aGlzLm1fYWFiYiwgeGYpO1xyXG4gICAgICB0aGlzLm1fcHJveHkgPSBicm9hZFBoYXNlLkNyZWF0ZVByb3h5KHRoaXMubV9hYWJiLCB0aGlzKTtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLkRlc3Ryb3lQcm94eSA9IGZ1bmN0aW9uIChicm9hZFBoYXNlKSB7XHJcbiAgICAgIGlmICh0aGlzLm1fcHJveHkgPT0gbnVsbCkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgYnJvYWRQaGFzZS5EZXN0cm95UHJveHkodGhpcy5tX3Byb3h5KTtcclxuICAgICAgdGhpcy5tX3Byb3h5ID0gbnVsbDtcclxuICAgfVxyXG4gICBiMkZpeHR1cmUucHJvdG90eXBlLlN5bmNocm9uaXplID0gZnVuY3Rpb24gKGJyb2FkUGhhc2UsIHRyYW5zZm9ybTEsIHRyYW5zZm9ybTIpIHtcclxuICAgICAgaWYgKCF0aGlzLm1fcHJveHkpIHJldHVybjtcclxuICAgICAgdmFyIGFhYmIxID0gbmV3IGIyQUFCQigpO1xyXG4gICAgICB2YXIgYWFiYjIgPSBuZXcgYjJBQUJCKCk7XHJcbiAgICAgIHRoaXMubV9zaGFwZS5Db21wdXRlQUFCQihhYWJiMSwgdHJhbnNmb3JtMSk7XHJcbiAgICAgIHRoaXMubV9zaGFwZS5Db21wdXRlQUFCQihhYWJiMiwgdHJhbnNmb3JtMik7XHJcbiAgICAgIHRoaXMubV9hYWJiLkNvbWJpbmUoYWFiYjEsIGFhYmIyKTtcclxuICAgICAgdmFyIGRpc3BsYWNlbWVudCA9IGIyTWF0aC5TdWJ0cmFjdFZWKHRyYW5zZm9ybTIucG9zaXRpb24sIHRyYW5zZm9ybTEucG9zaXRpb24pO1xyXG4gICAgICBicm9hZFBoYXNlLk1vdmVQcm94eSh0aGlzLm1fcHJveHksIHRoaXMubV9hYWJiLCBkaXNwbGFjZW1lbnQpO1xyXG4gICB9XHJcbiAgIGIyRml4dHVyZURlZi5iMkZpeHR1cmVEZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuZmlsdGVyID0gbmV3IGIyRmlsdGVyRGF0YSgpO1xyXG4gICB9O1xyXG4gICBiMkZpeHR1cmVEZWYucHJvdG90eXBlLmIyRml4dHVyZURlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5zaGFwZSA9IG51bGw7XHJcbiAgICAgIHRoaXMudXNlckRhdGEgPSBudWxsO1xyXG4gICAgICB0aGlzLmZyaWN0aW9uID0gMC4yO1xyXG4gICAgICB0aGlzLnJlc3RpdHV0aW9uID0gMC4wO1xyXG4gICAgICB0aGlzLmRlbnNpdHkgPSAwLjA7XHJcbiAgICAgIHRoaXMuZmlsdGVyLmNhdGVnb3J5Qml0cyA9IDB4MDAwMTtcclxuICAgICAgdGhpcy5maWx0ZXIubWFza0JpdHMgPSAweEZGRkY7XHJcbiAgICAgIHRoaXMuZmlsdGVyLmdyb3VwSW5kZXggPSAwO1xyXG4gICAgICB0aGlzLmlzU2Vuc29yID0gZmFsc2U7XHJcbiAgIH1cclxuICAgYjJJc2xhbmQuYjJJc2xhbmQgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJJc2xhbmQucHJvdG90eXBlLmIySXNsYW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fYm9kaWVzID0gbmV3IFZlY3RvcigpO1xyXG4gICAgICB0aGlzLm1fY29udGFjdHMgPSBuZXcgVmVjdG9yKCk7XHJcbiAgICAgIHRoaXMubV9qb2ludHMgPSBuZXcgVmVjdG9yKCk7XHJcbiAgIH1cclxuICAgYjJJc2xhbmQucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoYm9keUNhcGFjaXR5LCBjb250YWN0Q2FwYWNpdHksIGpvaW50Q2FwYWNpdHksIGFsbG9jYXRvciwgbGlzdGVuZXIsIGNvbnRhY3RTb2x2ZXIpIHtcclxuICAgICAgaWYgKGJvZHlDYXBhY2l0eSA9PT0gdW5kZWZpbmVkKSBib2R5Q2FwYWNpdHkgPSAwO1xyXG4gICAgICBpZiAoY29udGFjdENhcGFjaXR5ID09PSB1bmRlZmluZWQpIGNvbnRhY3RDYXBhY2l0eSA9IDA7XHJcbiAgICAgIGlmIChqb2ludENhcGFjaXR5ID09PSB1bmRlZmluZWQpIGpvaW50Q2FwYWNpdHkgPSAwO1xyXG4gICAgICB2YXIgaSA9IDA7XHJcbiAgICAgIHRoaXMubV9ib2R5Q2FwYWNpdHkgPSBib2R5Q2FwYWNpdHk7XHJcbiAgICAgIHRoaXMubV9jb250YWN0Q2FwYWNpdHkgPSBjb250YWN0Q2FwYWNpdHk7XHJcbiAgICAgIHRoaXMubV9qb2ludENhcGFjaXR5ID0gam9pbnRDYXBhY2l0eTtcclxuICAgICAgdGhpcy5tX2JvZHlDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9jb250YWN0Q291bnQgPSAwO1xyXG4gICAgICB0aGlzLm1fam9pbnRDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9hbGxvY2F0b3IgPSBhbGxvY2F0b3I7XHJcbiAgICAgIHRoaXMubV9saXN0ZW5lciA9IGxpc3RlbmVyO1xyXG4gICAgICB0aGlzLm1fY29udGFjdFNvbHZlciA9IGNvbnRhY3RTb2x2ZXI7XHJcbiAgICAgIGZvciAoaSA9IHRoaXMubV9ib2RpZXMubGVuZ3RoO1xyXG4gICAgICBpIDwgYm9keUNhcGFjaXR5OyBpKyspXHJcbiAgICAgIHRoaXMubV9ib2RpZXNbaV0gPSBudWxsO1xyXG4gICAgICBmb3IgKGkgPSB0aGlzLm1fY29udGFjdHMubGVuZ3RoO1xyXG4gICAgICBpIDwgY29udGFjdENhcGFjaXR5OyBpKyspXHJcbiAgICAgIHRoaXMubV9jb250YWN0c1tpXSA9IG51bGw7XHJcbiAgICAgIGZvciAoaSA9IHRoaXMubV9qb2ludHMubGVuZ3RoO1xyXG4gICAgICBpIDwgam9pbnRDYXBhY2l0eTsgaSsrKVxyXG4gICAgICB0aGlzLm1fam9pbnRzW2ldID0gbnVsbDtcclxuICAgfVxyXG4gICBiMklzbGFuZC5wcm90b3R5cGUuQ2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9ib2R5Q291bnQgPSAwO1xyXG4gICAgICB0aGlzLm1fY29udGFjdENvdW50ID0gMDtcclxuICAgICAgdGhpcy5tX2pvaW50Q291bnQgPSAwO1xyXG4gICB9XHJcbiAgIGIySXNsYW5kLnByb3RvdHlwZS5Tb2x2ZSA9IGZ1bmN0aW9uIChzdGVwLCBncmF2aXR5LCBhbGxvd1NsZWVwKSB7XHJcbiAgICAgIHZhciBpID0gMDtcclxuICAgICAgdmFyIGogPSAwO1xyXG4gICAgICB2YXIgYjtcclxuICAgICAgdmFyIGpvaW50O1xyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgdGhpcy5tX2JvZHlDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIGIgPSB0aGlzLm1fYm9kaWVzW2ldO1xyXG4gICAgICAgICBpZiAoYi5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5KSBjb250aW51ZTtcclxuICAgICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnggKz0gc3RlcC5kdCAqIChncmF2aXR5LnggKyBiLm1faW52TWFzcyAqIGIubV9mb3JjZS54KTtcclxuICAgICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gc3RlcC5kdCAqIChncmF2aXR5LnkgKyBiLm1faW52TWFzcyAqIGIubV9mb3JjZS55KTtcclxuICAgICAgICAgYi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBzdGVwLmR0ICogYi5tX2ludkkgKiBiLm1fdG9ycXVlO1xyXG4gICAgICAgICBiLm1fbGluZWFyVmVsb2NpdHkuTXVsdGlwbHkoYjJNYXRoLkNsYW1wKDEuMCAtIHN0ZXAuZHQgKiBiLm1fbGluZWFyRGFtcGluZywgMC4wLCAxLjApKTtcclxuICAgICAgICAgYi5tX2FuZ3VsYXJWZWxvY2l0eSAqPSBiMk1hdGguQ2xhbXAoMS4wIC0gc3RlcC5kdCAqIGIubV9hbmd1bGFyRGFtcGluZywgMC4wLCAxLjApO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9jb250YWN0U29sdmVyLkluaXRpYWxpemUoc3RlcCwgdGhpcy5tX2NvbnRhY3RzLCB0aGlzLm1fY29udGFjdENvdW50LCB0aGlzLm1fYWxsb2NhdG9yKTtcclxuICAgICAgdmFyIGNvbnRhY3RTb2x2ZXIgPSB0aGlzLm1fY29udGFjdFNvbHZlcjtcclxuICAgICAgY29udGFjdFNvbHZlci5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyhzdGVwKTtcclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHRoaXMubV9qb2ludENvdW50OyArK2kpIHtcclxuICAgICAgICAgam9pbnQgPSB0aGlzLm1fam9pbnRzW2ldO1xyXG4gICAgICAgICBqb2ludC5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyhzdGVwKTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgc3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7ICsraSkge1xyXG4gICAgICAgICBmb3IgKGogPSAwO1xyXG4gICAgICAgICBqIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraikge1xyXG4gICAgICAgICAgICBqb2ludCA9IHRoaXMubV9qb2ludHNbal07XHJcbiAgICAgICAgICAgIGpvaW50LlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyhzdGVwKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBjb250YWN0U29sdmVyLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cygpO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCB0aGlzLm1fam9pbnRDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIGpvaW50ID0gdGhpcy5tX2pvaW50c1tpXTtcclxuICAgICAgICAgam9pbnQuRmluYWxpemVWZWxvY2l0eUNvbnN0cmFpbnRzKCk7XHJcbiAgICAgIH1cclxuICAgICAgY29udGFjdFNvbHZlci5GaW5hbGl6ZVZlbG9jaXR5Q29uc3RyYWludHMoKTtcclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHRoaXMubV9ib2R5Q291bnQ7ICsraSkge1xyXG4gICAgICAgICBiID0gdGhpcy5tX2JvZGllc1tpXTtcclxuICAgICAgICAgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSBjb250aW51ZTtcclxuICAgICAgICAgdmFyIHRyYW5zbGF0aW9uWCA9IHN0ZXAuZHQgKiBiLm1fbGluZWFyVmVsb2NpdHkueDtcclxuICAgICAgICAgdmFyIHRyYW5zbGF0aW9uWSA9IHN0ZXAuZHQgKiBiLm1fbGluZWFyVmVsb2NpdHkueTtcclxuICAgICAgICAgaWYgKCh0cmFuc2xhdGlvblggKiB0cmFuc2xhdGlvblggKyB0cmFuc2xhdGlvblkgKiB0cmFuc2xhdGlvblkpID4gYjJTZXR0aW5ncy5iMl9tYXhUcmFuc2xhdGlvblNxdWFyZWQpIHtcclxuICAgICAgICAgICAgYi5tX2xpbmVhclZlbG9jaXR5Lk5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICBiLm1fbGluZWFyVmVsb2NpdHkueCAqPSBiMlNldHRpbmdzLmIyX21heFRyYW5zbGF0aW9uICogc3RlcC5pbnZfZHQ7XHJcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS55ICo9IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gKiBzdGVwLmludl9kdDtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgcm90YXRpb24gPSBzdGVwLmR0ICogYi5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgICAgaWYgKHJvdGF0aW9uICogcm90YXRpb24gPiBiMlNldHRpbmdzLmIyX21heFJvdGF0aW9uU3F1YXJlZCkge1xyXG4gICAgICAgICAgICBpZiAoYi5tX2FuZ3VsYXJWZWxvY2l0eSA8IDAuMCkge1xyXG4gICAgICAgICAgICAgICBiLm1fYW5ndWxhclZlbG9jaXR5ID0gKC1iMlNldHRpbmdzLmIyX21heFJvdGF0aW9uICogc3RlcC5pbnZfZHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICBiLm1fYW5ndWxhclZlbG9jaXR5ID0gYjJTZXR0aW5ncy5iMl9tYXhSb3RhdGlvbiAqIHN0ZXAuaW52X2R0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYi5tX3N3ZWVwLmMwLlNldFYoYi5tX3N3ZWVwLmMpO1xyXG4gICAgICAgICBiLm1fc3dlZXAuYTAgPSBiLm1fc3dlZXAuYTtcclxuICAgICAgICAgYi5tX3N3ZWVwLmMueCArPSBzdGVwLmR0ICogYi5tX2xpbmVhclZlbG9jaXR5Lng7XHJcbiAgICAgICAgIGIubV9zd2VlcC5jLnkgKz0gc3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS55O1xyXG4gICAgICAgICBiLm1fc3dlZXAuYSArPSBzdGVwLmR0ICogYi5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgICAgYi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCBzdGVwLnBvc2l0aW9uSXRlcmF0aW9uczsgKytpKSB7XHJcbiAgICAgICAgIHZhciBjb250YWN0c09rYXkgPSBjb250YWN0U29sdmVyLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyhiMlNldHRpbmdzLmIyX2NvbnRhY3RCYXVtZ2FydGUpO1xyXG4gICAgICAgICB2YXIgam9pbnRzT2theSA9IHRydWU7XHJcbiAgICAgICAgIGZvciAoaiA9IDA7XHJcbiAgICAgICAgIGogPCB0aGlzLm1fam9pbnRDb3VudDsgKytqKSB7XHJcbiAgICAgICAgICAgIGpvaW50ID0gdGhpcy5tX2pvaW50c1tqXTtcclxuICAgICAgICAgICAgdmFyIGpvaW50T2theSA9IGpvaW50LlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyhiMlNldHRpbmdzLmIyX2NvbnRhY3RCYXVtZ2FydGUpO1xyXG4gICAgICAgICAgICBqb2ludHNPa2F5ID0gam9pbnRzT2theSAmJiBqb2ludE9rYXk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKGNvbnRhY3RzT2theSAmJiBqb2ludHNPa2F5KSB7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5SZXBvcnQoY29udGFjdFNvbHZlci5tX2NvbnN0cmFpbnRzKTtcclxuICAgICAgaWYgKGFsbG93U2xlZXApIHtcclxuICAgICAgICAgdmFyIG1pblNsZWVwVGltZSA9IE51bWJlci5NQVhfVkFMVUU7XHJcbiAgICAgICAgIHZhciBsaW5Ub2xTcXIgPSBiMlNldHRpbmdzLmIyX2xpbmVhclNsZWVwVG9sZXJhbmNlICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbGVlcFRvbGVyYW5jZTtcclxuICAgICAgICAgdmFyIGFuZ1RvbFNxciA9IGIyU2V0dGluZ3MuYjJfYW5ndWxhclNsZWVwVG9sZXJhbmNlICogYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xlZXBUb2xlcmFuY2U7XHJcbiAgICAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgICAgIGkgPCB0aGlzLm1fYm9keUNvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgYiA9IHRoaXMubV9ib2RpZXNbaV07XHJcbiAgICAgICAgICAgIGlmIChiLkdldFR5cGUoKSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xyXG4gICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoKGIubV9mbGFncyAmIGIyQm9keS5lX2FsbG93U2xlZXBGbGFnKSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgIGIubV9zbGVlcFRpbWUgPSAwLjA7XHJcbiAgICAgICAgICAgICAgIG1pblNsZWVwVGltZSA9IDAuMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoKGIubV9mbGFncyAmIGIyQm9keS5lX2FsbG93U2xlZXBGbGFnKSA9PSAwIHx8IGIubV9hbmd1bGFyVmVsb2NpdHkgKiBiLm1fYW5ndWxhclZlbG9jaXR5ID4gYW5nVG9sU3FyIHx8IGIyTWF0aC5Eb3QoYi5tX2xpbmVhclZlbG9jaXR5LCBiLm1fbGluZWFyVmVsb2NpdHkpID4gbGluVG9sU3FyKSB7XHJcbiAgICAgICAgICAgICAgIGIubV9zbGVlcFRpbWUgPSAwLjA7XHJcbiAgICAgICAgICAgICAgIG1pblNsZWVwVGltZSA9IDAuMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgYi5tX3NsZWVwVGltZSArPSBzdGVwLmR0O1xyXG4gICAgICAgICAgICAgICBtaW5TbGVlcFRpbWUgPSBiMk1hdGguTWluKG1pblNsZWVwVGltZSwgYi5tX3NsZWVwVGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAobWluU2xlZXBUaW1lID49IGIyU2V0dGluZ3MuYjJfdGltZVRvU2xlZXApIHtcclxuICAgICAgICAgICAgZm9yIChpID0gMDtcclxuICAgICAgICAgICAgaSA8IHRoaXMubV9ib2R5Q291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICBiID0gdGhpcy5tX2JvZGllc1tpXTtcclxuICAgICAgICAgICAgICAgYi5TZXRBd2FrZShmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJJc2xhbmQucHJvdG90eXBlLlNvbHZlVE9JID0gZnVuY3Rpb24gKHN1YlN0ZXApIHtcclxuICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICB2YXIgaiA9IDA7XHJcbiAgICAgIHRoaXMubV9jb250YWN0U29sdmVyLkluaXRpYWxpemUoc3ViU3RlcCwgdGhpcy5tX2NvbnRhY3RzLCB0aGlzLm1fY29udGFjdENvdW50LCB0aGlzLm1fYWxsb2NhdG9yKTtcclxuICAgICAgdmFyIGNvbnRhY3RTb2x2ZXIgPSB0aGlzLm1fY29udGFjdFNvbHZlcjtcclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHRoaXMubV9qb2ludENvdW50OyArK2kpIHtcclxuICAgICAgICAgdGhpcy5tX2pvaW50c1tpXS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyhzdWJTdGVwKTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgc3ViU3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7ICsraSkge1xyXG4gICAgICAgICBjb250YWN0U29sdmVyLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cygpO1xyXG4gICAgICAgICBmb3IgKGogPSAwO1xyXG4gICAgICAgICBqIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraikge1xyXG4gICAgICAgICAgICB0aGlzLm1fam9pbnRzW2pdLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyhzdWJTdGVwKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGZvciAoaSA9IDA7XHJcbiAgICAgIGkgPCB0aGlzLm1fYm9keUNvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIGIgPSB0aGlzLm1fYm9kaWVzW2ldO1xyXG4gICAgICAgICBpZiAoYi5HZXRUeXBlKCkgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIGNvbnRpbnVlO1xyXG4gICAgICAgICB2YXIgdHJhbnNsYXRpb25YID0gc3ViU3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS54O1xyXG4gICAgICAgICB2YXIgdHJhbnNsYXRpb25ZID0gc3ViU3RlcC5kdCAqIGIubV9saW5lYXJWZWxvY2l0eS55O1xyXG4gICAgICAgICBpZiAoKHRyYW5zbGF0aW9uWCAqIHRyYW5zbGF0aW9uWCArIHRyYW5zbGF0aW9uWSAqIHRyYW5zbGF0aW9uWSkgPiBiMlNldHRpbmdzLmIyX21heFRyYW5zbGF0aW9uU3F1YXJlZCkge1xyXG4gICAgICAgICAgICBiLm1fbGluZWFyVmVsb2NpdHkuTm9ybWFsaXplKCk7XHJcbiAgICAgICAgICAgIGIubV9saW5lYXJWZWxvY2l0eS54ICo9IGIyU2V0dGluZ3MuYjJfbWF4VHJhbnNsYXRpb24gKiBzdWJTdGVwLmludl9kdDtcclxuICAgICAgICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnkgKj0gYjJTZXR0aW5ncy5iMl9tYXhUcmFuc2xhdGlvbiAqIHN1YlN0ZXAuaW52X2R0O1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciByb3RhdGlvbiA9IHN1YlN0ZXAuZHQgKiBiLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICAgICBpZiAocm90YXRpb24gKiByb3RhdGlvbiA+IGIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb25TcXVhcmVkKSB7XHJcbiAgICAgICAgICAgIGlmIChiLm1fYW5ndWxhclZlbG9jaXR5IDwgMC4wKSB7XHJcbiAgICAgICAgICAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgPSAoLWIyU2V0dGluZ3MuYjJfbWF4Um90YXRpb24gKiBzdWJTdGVwLmludl9kdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgPSBiMlNldHRpbmdzLmIyX21heFJvdGF0aW9uICogc3ViU3RlcC5pbnZfZHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBiLm1fc3dlZXAuYzAuU2V0VihiLm1fc3dlZXAuYyk7XHJcbiAgICAgICAgIGIubV9zd2VlcC5hMCA9IGIubV9zd2VlcC5hO1xyXG4gICAgICAgICBiLm1fc3dlZXAuYy54ICs9IHN1YlN0ZXAuZHQgKiBiLm1fbGluZWFyVmVsb2NpdHkueDtcclxuICAgICAgICAgYi5tX3N3ZWVwLmMueSArPSBzdWJTdGVwLmR0ICogYi5tX2xpbmVhclZlbG9jaXR5Lnk7XHJcbiAgICAgICAgIGIubV9zd2VlcC5hICs9IHN1YlN0ZXAuZHQgKiBiLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICAgICBiLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGtfdG9pQmF1bWdhcnRlID0gMC43NTtcclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHN1YlN0ZXAucG9zaXRpb25JdGVyYXRpb25zOyArK2kpIHtcclxuICAgICAgICAgdmFyIGNvbnRhY3RzT2theSA9IGNvbnRhY3RTb2x2ZXIuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzKGtfdG9pQmF1bWdhcnRlKTtcclxuICAgICAgICAgdmFyIGpvaW50c09rYXkgPSB0cnVlO1xyXG4gICAgICAgICBmb3IgKGogPSAwO1xyXG4gICAgICAgICBqIDwgdGhpcy5tX2pvaW50Q291bnQ7ICsraikge1xyXG4gICAgICAgICAgICB2YXIgam9pbnRPa2F5ID0gdGhpcy5tX2pvaW50c1tqXS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMoYjJTZXR0aW5ncy5iMl9jb250YWN0QmF1bWdhcnRlKTtcclxuICAgICAgICAgICAgam9pbnRzT2theSA9IGpvaW50c09rYXkgJiYgam9pbnRPa2F5O1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChjb250YWN0c09rYXkgJiYgam9pbnRzT2theSkge1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuUmVwb3J0KGNvbnRhY3RTb2x2ZXIubV9jb25zdHJhaW50cyk7XHJcbiAgIH1cclxuICAgYjJJc2xhbmQucHJvdG90eXBlLlJlcG9ydCA9IGZ1bmN0aW9uIChjb25zdHJhaW50cykge1xyXG4gICAgICBpZiAodGhpcy5tX2xpc3RlbmVyID09IG51bGwpIHtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tX2NvbnRhY3RDb3VudDsgKytpKSB7XHJcbiAgICAgICAgIHZhciBjID0gdGhpcy5tX2NvbnRhY3RzW2ldO1xyXG4gICAgICAgICB2YXIgY2MgPSBjb25zdHJhaW50c1tpXTtcclxuICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjYy5wb2ludENvdW50OyArK2opIHtcclxuICAgICAgICAgICAgYjJJc2xhbmQuc19pbXB1bHNlLm5vcm1hbEltcHVsc2VzW2pdID0gY2MucG9pbnRzW2pdLm5vcm1hbEltcHVsc2U7XHJcbiAgICAgICAgICAgIGIySXNsYW5kLnNfaW1wdWxzZS50YW5nZW50SW1wdWxzZXNbal0gPSBjYy5wb2ludHNbal0udGFuZ2VudEltcHVsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdGhpcy5tX2xpc3RlbmVyLlBvc3RTb2x2ZShjLCBiMklzbGFuZC5zX2ltcHVsc2UpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJJc2xhbmQucHJvdG90eXBlLkFkZEJvZHkgPSBmdW5jdGlvbiAoYm9keSkge1xyXG4gICAgICBib2R5Lm1faXNsYW5kSW5kZXggPSB0aGlzLm1fYm9keUNvdW50O1xyXG4gICAgICB0aGlzLm1fYm9kaWVzW3RoaXMubV9ib2R5Q291bnQrK10gPSBib2R5O1xyXG4gICB9XHJcbiAgIGIySXNsYW5kLnByb3RvdHlwZS5BZGRDb250YWN0ID0gZnVuY3Rpb24gKGNvbnRhY3QpIHtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RzW3RoaXMubV9jb250YWN0Q291bnQrK10gPSBjb250YWN0O1xyXG4gICB9XHJcbiAgIGIySXNsYW5kLnByb3RvdHlwZS5BZGRKb2ludCA9IGZ1bmN0aW9uIChqb2ludCkge1xyXG4gICAgICB0aGlzLm1fam9pbnRzW3RoaXMubV9qb2ludENvdW50KytdID0gam9pbnQ7XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIySXNsYW5kLnNfaW1wdWxzZSA9IG5ldyBiMkNvbnRhY3RJbXB1bHNlKCk7XHJcbiAgIH0pO1xyXG4gICBiMlRpbWVTdGVwLmIyVGltZVN0ZXAgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJUaW1lU3RlcC5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdGhpcy5kdCA9IHN0ZXAuZHQ7XHJcbiAgICAgIHRoaXMuaW52X2R0ID0gc3RlcC5pbnZfZHQ7XHJcbiAgICAgIHRoaXMucG9zaXRpb25JdGVyYXRpb25zID0gc3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnM7XHJcbiAgICAgIHRoaXMudmVsb2NpdHlJdGVyYXRpb25zID0gc3RlcC52ZWxvY2l0eUl0ZXJhdGlvbnM7XHJcbiAgICAgIHRoaXMud2FybVN0YXJ0aW5nID0gc3RlcC53YXJtU3RhcnRpbmc7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5iMldvcmxkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnNfc3RhY2sgPSBuZXcgVmVjdG9yKCk7XHJcbiAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlciA9IG5ldyBiMkNvbnRhY3RNYW5hZ2VyKCk7XHJcbiAgICAgIHRoaXMubV9jb250YWN0U29sdmVyID0gbmV3IGIyQ29udGFjdFNvbHZlcigpO1xyXG4gICAgICB0aGlzLm1faXNsYW5kID0gbmV3IGIySXNsYW5kKCk7XHJcbiAgIH07XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLmIyV29ybGQgPSBmdW5jdGlvbiAoZ3Jhdml0eSwgZG9TbGVlcCkge1xyXG4gICAgICB0aGlzLm1fZGVzdHJ1Y3Rpb25MaXN0ZW5lciA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9kZWJ1Z0RyYXcgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fYm9keUxpc3QgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fY29udGFjdExpc3QgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fam9pbnRMaXN0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2NvbnRyb2xsZXJMaXN0ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX2JvZHlDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9jb250YWN0Q291bnQgPSAwO1xyXG4gICAgICB0aGlzLm1fam9pbnRDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9jb250cm9sbGVyQ291bnQgPSAwO1xyXG4gICAgICBiMldvcmxkLm1fd2FybVN0YXJ0aW5nID0gdHJ1ZTtcclxuICAgICAgYjJXb3JsZC5tX2NvbnRpbnVvdXNQaHlzaWNzID0gdHJ1ZTtcclxuICAgICAgdGhpcy5tX2FsbG93U2xlZXAgPSBkb1NsZWVwO1xyXG4gICAgICB0aGlzLm1fZ3Jhdml0eSA9IGdyYXZpdHk7XHJcbiAgICAgIHRoaXMubV9pbnZfZHQwID0gMC4wO1xyXG4gICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIubV93b3JsZCA9IHRoaXM7XHJcbiAgICAgIHZhciBiZCA9IG5ldyBiMkJvZHlEZWYoKTtcclxuICAgICAgdGhpcy5tX2dyb3VuZEJvZHkgPSB0aGlzLkNyZWF0ZUJvZHkoYmQpO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlNldERlc3RydWN0aW9uTGlzdGVuZXIgPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcclxuICAgICAgdGhpcy5tX2Rlc3RydWN0aW9uTGlzdGVuZXIgPSBsaXN0ZW5lcjtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5TZXRDb250YWN0RmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIubV9jb250YWN0RmlsdGVyID0gZmlsdGVyO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlNldENvbnRhY3RMaXN0ZW5lciA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xyXG4gICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIubV9jb250YWN0TGlzdGVuZXIgPSBsaXN0ZW5lcjtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5TZXREZWJ1Z0RyYXcgPSBmdW5jdGlvbiAoZGVidWdEcmF3KSB7XHJcbiAgICAgIHRoaXMubV9kZWJ1Z0RyYXcgPSBkZWJ1Z0RyYXc7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuU2V0QnJvYWRQaGFzZSA9IGZ1bmN0aW9uIChicm9hZFBoYXNlKSB7XHJcbiAgICAgIHZhciBvbGRCcm9hZFBoYXNlID0gdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcclxuICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZSA9IGJyb2FkUGhhc2U7XHJcbiAgICAgIGZvciAodmFyIGIgPSB0aGlzLm1fYm9keUxpc3Q7IGI7IGIgPSBiLm1fbmV4dCkge1xyXG4gICAgICAgICBmb3IgKHZhciBmID0gYi5tX2ZpeHR1cmVMaXN0OyBmOyBmID0gZi5tX25leHQpIHtcclxuICAgICAgICAgICAgZi5tX3Byb3h5ID0gYnJvYWRQaGFzZS5DcmVhdGVQcm94eShvbGRCcm9hZFBoYXNlLkdldEZhdEFBQkIoZi5tX3Byb3h5KSwgZik7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlLlZhbGlkYXRlKCk7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0UHJveHlDb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2UuR2V0UHJveHlDb3VudCgpO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkNyZWF0ZUJvZHkgPSBmdW5jdGlvbiAoZGVmKSB7XHJcbiAgICAgIGlmICh0aGlzLklzTG9ja2VkKCkgPT0gdHJ1ZSkge1xyXG4gICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgYiA9IG5ldyBiMkJvZHkoZGVmLCB0aGlzKTtcclxuICAgICAgYi5tX3ByZXYgPSBudWxsO1xyXG4gICAgICBiLm1fbmV4dCA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgaWYgKHRoaXMubV9ib2R5TGlzdCkge1xyXG4gICAgICAgICB0aGlzLm1fYm9keUxpc3QubV9wcmV2ID0gYjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fYm9keUxpc3QgPSBiO1xyXG4gICAgICArK3RoaXMubV9ib2R5Q291bnQ7XHJcbiAgICAgIHJldHVybiBiO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkRlc3Ryb3lCb2R5ID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgaWYgKHRoaXMuSXNMb2NrZWQoKSA9PSB0cnVlKSB7XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgam4gPSBiLm1fam9pbnRMaXN0O1xyXG4gICAgICB3aGlsZSAoam4pIHtcclxuICAgICAgICAgdmFyIGpuMCA9IGpuO1xyXG4gICAgICAgICBqbiA9IGpuLm5leHQ7XHJcbiAgICAgICAgIGlmICh0aGlzLm1fZGVzdHJ1Y3Rpb25MaXN0ZW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLm1fZGVzdHJ1Y3Rpb25MaXN0ZW5lci5TYXlHb29kYnllSm9pbnQoam4wLmpvaW50KTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB0aGlzLkRlc3Ryb3lKb2ludChqbjAuam9pbnQpO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBjb2UgPSBiLm1fY29udHJvbGxlckxpc3Q7XHJcbiAgICAgIHdoaWxlIChjb2UpIHtcclxuICAgICAgICAgdmFyIGNvZTAgPSBjb2U7XHJcbiAgICAgICAgIGNvZSA9IGNvZS5uZXh0Q29udHJvbGxlcjtcclxuICAgICAgICAgY29lMC5jb250cm9sbGVyLlJlbW92ZUJvZHkoYik7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGNlID0gYi5tX2NvbnRhY3RMaXN0O1xyXG4gICAgICB3aGlsZSAoY2UpIHtcclxuICAgICAgICAgdmFyIGNlMCA9IGNlO1xyXG4gICAgICAgICBjZSA9IGNlLm5leHQ7XHJcbiAgICAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlci5EZXN0cm95KGNlMC5jb250YWN0KTtcclxuICAgICAgfVxyXG4gICAgICBiLm1fY29udGFjdExpc3QgPSBudWxsO1xyXG4gICAgICB2YXIgZiA9IGIubV9maXh0dXJlTGlzdDtcclxuICAgICAgd2hpbGUgKGYpIHtcclxuICAgICAgICAgdmFyIGYwID0gZjtcclxuICAgICAgICAgZiA9IGYubV9uZXh0O1xyXG4gICAgICAgICBpZiAodGhpcy5tX2Rlc3RydWN0aW9uTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5tX2Rlc3RydWN0aW9uTGlzdGVuZXIuU2F5R29vZGJ5ZUZpeHR1cmUoZjApO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGYwLkRlc3Ryb3lQcm94eSh0aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlKTtcclxuICAgICAgICAgZjAuRGVzdHJveSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGIubV9maXh0dXJlTGlzdCA9IG51bGw7XHJcbiAgICAgIGIubV9maXh0dXJlQ291bnQgPSAwO1xyXG4gICAgICBpZiAoYi5tX3ByZXYpIHtcclxuICAgICAgICAgYi5tX3ByZXYubV9uZXh0ID0gYi5tX25leHQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGIubV9uZXh0KSB7XHJcbiAgICAgICAgIGIubV9uZXh0Lm1fcHJldiA9IGIubV9wcmV2O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChiID09IHRoaXMubV9ib2R5TGlzdCkge1xyXG4gICAgICAgICB0aGlzLm1fYm9keUxpc3QgPSBiLm1fbmV4dDtcclxuICAgICAgfS0tdGhpcy5tX2JvZHlDb3VudDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5DcmVhdGVKb2ludCA9IGZ1bmN0aW9uIChkZWYpIHtcclxuICAgICAgdmFyIGogPSBiMkpvaW50LkNyZWF0ZShkZWYsIG51bGwpO1xyXG4gICAgICBqLm1fcHJldiA9IG51bGw7XHJcbiAgICAgIGoubV9uZXh0ID0gdGhpcy5tX2pvaW50TGlzdDtcclxuICAgICAgaWYgKHRoaXMubV9qb2ludExpc3QpIHtcclxuICAgICAgICAgdGhpcy5tX2pvaW50TGlzdC5tX3ByZXYgPSBqO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9qb2ludExpc3QgPSBqO1xyXG4gICAgICArK3RoaXMubV9qb2ludENvdW50O1xyXG4gICAgICBqLm1fZWRnZUEuam9pbnQgPSBqO1xyXG4gICAgICBqLm1fZWRnZUEub3RoZXIgPSBqLm1fYm9keUI7XHJcbiAgICAgIGoubV9lZGdlQS5wcmV2ID0gbnVsbDtcclxuICAgICAgai5tX2VkZ2VBLm5leHQgPSBqLm1fYm9keUEubV9qb2ludExpc3Q7XHJcbiAgICAgIGlmIChqLm1fYm9keUEubV9qb2ludExpc3QpIGoubV9ib2R5QS5tX2pvaW50TGlzdC5wcmV2ID0gai5tX2VkZ2VBO1xyXG4gICAgICBqLm1fYm9keUEubV9qb2ludExpc3QgPSBqLm1fZWRnZUE7XHJcbiAgICAgIGoubV9lZGdlQi5qb2ludCA9IGo7XHJcbiAgICAgIGoubV9lZGdlQi5vdGhlciA9IGoubV9ib2R5QTtcclxuICAgICAgai5tX2VkZ2VCLnByZXYgPSBudWxsO1xyXG4gICAgICBqLm1fZWRnZUIubmV4dCA9IGoubV9ib2R5Qi5tX2pvaW50TGlzdDtcclxuICAgICAgaWYgKGoubV9ib2R5Qi5tX2pvaW50TGlzdCkgai5tX2JvZHlCLm1fam9pbnRMaXN0LnByZXYgPSBqLm1fZWRnZUI7XHJcbiAgICAgIGoubV9ib2R5Qi5tX2pvaW50TGlzdCA9IGoubV9lZGdlQjtcclxuICAgICAgdmFyIGJvZHlBID0gZGVmLmJvZHlBO1xyXG4gICAgICB2YXIgYm9keUIgPSBkZWYuYm9keUI7XHJcbiAgICAgIGlmIChkZWYuY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZSkge1xyXG4gICAgICAgICB2YXIgZWRnZSA9IGJvZHlCLkdldENvbnRhY3RMaXN0KCk7XHJcbiAgICAgICAgIHdoaWxlIChlZGdlKSB7XHJcbiAgICAgICAgICAgIGlmIChlZGdlLm90aGVyID09IGJvZHlBKSB7XHJcbiAgICAgICAgICAgICAgIGVkZ2UuY29udGFjdC5GbGFnRm9yRmlsdGVyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBqO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkRlc3Ryb3lKb2ludCA9IGZ1bmN0aW9uIChqKSB7XHJcbiAgICAgIHZhciBjb2xsaWRlQ29ubmVjdGVkID0gai5tX2NvbGxpZGVDb25uZWN0ZWQ7XHJcbiAgICAgIGlmIChqLm1fcHJldikge1xyXG4gICAgICAgICBqLm1fcHJldi5tX25leHQgPSBqLm1fbmV4dDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoai5tX25leHQpIHtcclxuICAgICAgICAgai5tX25leHQubV9wcmV2ID0gai5tX3ByZXY7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGogPT0gdGhpcy5tX2pvaW50TGlzdCkge1xyXG4gICAgICAgICB0aGlzLm1fam9pbnRMaXN0ID0gai5tX25leHQ7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGJvZHlBID0gai5tX2JvZHlBO1xyXG4gICAgICB2YXIgYm9keUIgPSBqLm1fYm9keUI7XHJcbiAgICAgIGJvZHlBLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICBib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgaWYgKGoubV9lZGdlQS5wcmV2KSB7XHJcbiAgICAgICAgIGoubV9lZGdlQS5wcmV2Lm5leHQgPSBqLm1fZWRnZUEubmV4dDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoai5tX2VkZ2VBLm5leHQpIHtcclxuICAgICAgICAgai5tX2VkZ2VBLm5leHQucHJldiA9IGoubV9lZGdlQS5wcmV2O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChqLm1fZWRnZUEgPT0gYm9keUEubV9qb2ludExpc3QpIHtcclxuICAgICAgICAgYm9keUEubV9qb2ludExpc3QgPSBqLm1fZWRnZUEubmV4dDtcclxuICAgICAgfVxyXG4gICAgICBqLm1fZWRnZUEucHJldiA9IG51bGw7XHJcbiAgICAgIGoubV9lZGdlQS5uZXh0ID0gbnVsbDtcclxuICAgICAgaWYgKGoubV9lZGdlQi5wcmV2KSB7XHJcbiAgICAgICAgIGoubV9lZGdlQi5wcmV2Lm5leHQgPSBqLm1fZWRnZUIubmV4dDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoai5tX2VkZ2VCLm5leHQpIHtcclxuICAgICAgICAgai5tX2VkZ2VCLm5leHQucHJldiA9IGoubV9lZGdlQi5wcmV2O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChqLm1fZWRnZUIgPT0gYm9keUIubV9qb2ludExpc3QpIHtcclxuICAgICAgICAgYm9keUIubV9qb2ludExpc3QgPSBqLm1fZWRnZUIubmV4dDtcclxuICAgICAgfVxyXG4gICAgICBqLm1fZWRnZUIucHJldiA9IG51bGw7XHJcbiAgICAgIGoubV9lZGdlQi5uZXh0ID0gbnVsbDtcclxuICAgICAgYjJKb2ludC5EZXN0cm95KGosIG51bGwpO1xyXG4gICAgICAtLXRoaXMubV9qb2ludENvdW50O1xyXG4gICAgICBpZiAoY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZSkge1xyXG4gICAgICAgICB2YXIgZWRnZSA9IGJvZHlCLkdldENvbnRhY3RMaXN0KCk7XHJcbiAgICAgICAgIHdoaWxlIChlZGdlKSB7XHJcbiAgICAgICAgICAgIGlmIChlZGdlLm90aGVyID09IGJvZHlBKSB7XHJcbiAgICAgICAgICAgICAgIGVkZ2UuY29udGFjdC5GbGFnRm9yRmlsdGVyaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWRnZSA9IGVkZ2UubmV4dDtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuQWRkQ29udHJvbGxlciA9IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgIGMubV9uZXh0ID0gdGhpcy5tX2NvbnRyb2xsZXJMaXN0O1xyXG4gICAgICBjLm1fcHJldiA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9jb250cm9sbGVyTGlzdCA9IGM7XHJcbiAgICAgIGMubV93b3JsZCA9IHRoaXM7XHJcbiAgICAgIHRoaXMubV9jb250cm9sbGVyQ291bnQrKztcclxuICAgICAgcmV0dXJuIGM7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuUmVtb3ZlQ29udHJvbGxlciA9IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgIGlmIChjLm1fcHJldikgYy5tX3ByZXYubV9uZXh0ID0gYy5tX25leHQ7XHJcbiAgICAgIGlmIChjLm1fbmV4dCkgYy5tX25leHQubV9wcmV2ID0gYy5tX3ByZXY7XHJcbiAgICAgIGlmICh0aGlzLm1fY29udHJvbGxlckxpc3QgPT0gYykgdGhpcy5tX2NvbnRyb2xsZXJMaXN0ID0gYy5tX25leHQ7XHJcbiAgICAgIHRoaXMubV9jb250cm9sbGVyQ291bnQtLTtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5DcmVhdGVDb250cm9sbGVyID0gZnVuY3Rpb24gKGNvbnRyb2xsZXIpIHtcclxuICAgICAgaWYgKGNvbnRyb2xsZXIubV93b3JsZCAhPSB0aGlzKSB0aHJvdyBuZXcgRXJyb3IoXCJDb250cm9sbGVyIGNhbiBvbmx5IGJlIGEgbWVtYmVyIG9mIG9uZSB3b3JsZFwiKTtcclxuICAgICAgY29udHJvbGxlci5tX25leHQgPSB0aGlzLm1fY29udHJvbGxlckxpc3Q7XHJcbiAgICAgIGNvbnRyb2xsZXIubV9wcmV2ID0gbnVsbDtcclxuICAgICAgaWYgKHRoaXMubV9jb250cm9sbGVyTGlzdCkgdGhpcy5tX2NvbnRyb2xsZXJMaXN0Lm1fcHJldiA9IGNvbnRyb2xsZXI7XHJcbiAgICAgIHRoaXMubV9jb250cm9sbGVyTGlzdCA9IGNvbnRyb2xsZXI7XHJcbiAgICAgICsrdGhpcy5tX2NvbnRyb2xsZXJDb3VudDtcclxuICAgICAgY29udHJvbGxlci5tX3dvcmxkID0gdGhpcztcclxuICAgICAgcmV0dXJuIGNvbnRyb2xsZXI7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuRGVzdHJveUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoY29udHJvbGxlcikge1xyXG4gICAgICBjb250cm9sbGVyLkNsZWFyKCk7XHJcbiAgICAgIGlmIChjb250cm9sbGVyLm1fbmV4dCkgY29udHJvbGxlci5tX25leHQubV9wcmV2ID0gY29udHJvbGxlci5tX3ByZXY7XHJcbiAgICAgIGlmIChjb250cm9sbGVyLm1fcHJldikgY29udHJvbGxlci5tX3ByZXYubV9uZXh0ID0gY29udHJvbGxlci5tX25leHQ7XHJcbiAgICAgIGlmIChjb250cm9sbGVyID09IHRoaXMubV9jb250cm9sbGVyTGlzdCkgdGhpcy5tX2NvbnRyb2xsZXJMaXN0ID0gY29udHJvbGxlci5tX25leHQ7XHJcbiAgICAgIC0tdGhpcy5tX2NvbnRyb2xsZXJDb3VudDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5TZXRXYXJtU3RhcnRpbmcgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICBiMldvcmxkLm1fd2FybVN0YXJ0aW5nID0gZmxhZztcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5TZXRDb250aW51b3VzUGh5c2ljcyA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgIGIyV29ybGQubV9jb250aW51b3VzUGh5c2ljcyA9IGZsYWc7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0Qm9keUNvdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlDb3VudDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRKb2ludENvdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2pvaW50Q291bnQ7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0Q29udGFjdENvdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2NvbnRhY3RDb3VudDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5TZXRHcmF2aXR5ID0gZnVuY3Rpb24gKGdyYXZpdHkpIHtcclxuICAgICAgdGhpcy5tX2dyYXZpdHkgPSBncmF2aXR5O1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLkdldEdyYXZpdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZ3Jhdml0eTtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRHcm91bmRCb2R5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2dyb3VuZEJvZHk7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChkdCwgdmVsb2NpdHlJdGVyYXRpb25zLCBwb3NpdGlvbkl0ZXJhdGlvbnMpIHtcclxuICAgICAgaWYgKGR0ID09PSB1bmRlZmluZWQpIGR0ID0gMDtcclxuICAgICAgaWYgKHZlbG9jaXR5SXRlcmF0aW9ucyA9PT0gdW5kZWZpbmVkKSB2ZWxvY2l0eUl0ZXJhdGlvbnMgPSAwO1xyXG4gICAgICBpZiAocG9zaXRpb25JdGVyYXRpb25zID09PSB1bmRlZmluZWQpIHBvc2l0aW9uSXRlcmF0aW9ucyA9IDA7XHJcbiAgICAgIGlmICh0aGlzLm1fZmxhZ3MgJiBiMldvcmxkLmVfbmV3Rml4dHVyZSkge1xyXG4gICAgICAgICB0aGlzLm1fY29udGFjdE1hbmFnZXIuRmluZE5ld0NvbnRhY3RzKCk7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyAmPSB+YjJXb3JsZC5lX25ld0ZpeHR1cmU7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyV29ybGQuZV9sb2NrZWQ7XHJcbiAgICAgIHZhciBzdGVwID0gYjJXb3JsZC5zX3RpbWVzdGVwMjtcclxuICAgICAgc3RlcC5kdCA9IGR0O1xyXG4gICAgICBzdGVwLnZlbG9jaXR5SXRlcmF0aW9ucyA9IHZlbG9jaXR5SXRlcmF0aW9ucztcclxuICAgICAgc3RlcC5wb3NpdGlvbkl0ZXJhdGlvbnMgPSBwb3NpdGlvbkl0ZXJhdGlvbnM7XHJcbiAgICAgIGlmIChkdCA+IDAuMCkge1xyXG4gICAgICAgICBzdGVwLmludl9kdCA9IDEuMCAvIGR0O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBzdGVwLmludl9kdCA9IDAuMDtcclxuICAgICAgfVxyXG4gICAgICBzdGVwLmR0UmF0aW8gPSB0aGlzLm1faW52X2R0MCAqIGR0O1xyXG4gICAgICBzdGVwLndhcm1TdGFydGluZyA9IGIyV29ybGQubV93YXJtU3RhcnRpbmc7XHJcbiAgICAgIHRoaXMubV9jb250YWN0TWFuYWdlci5Db2xsaWRlKCk7XHJcbiAgICAgIGlmIChzdGVwLmR0ID4gMC4wKSB7XHJcbiAgICAgICAgIHRoaXMuU29sdmUoc3RlcCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGIyV29ybGQubV9jb250aW51b3VzUGh5c2ljcyAmJiBzdGVwLmR0ID4gMC4wKSB7XHJcbiAgICAgICAgIHRoaXMuU29sdmVUT0koc3RlcCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHN0ZXAuZHQgPiAwLjApIHtcclxuICAgICAgICAgdGhpcy5tX2ludl9kdDAgPSBzdGVwLmludl9kdDtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyV29ybGQuZV9sb2NrZWQ7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuQ2xlYXJGb3JjZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGZvciAodmFyIGJvZHkgPSB0aGlzLm1fYm9keUxpc3Q7IGJvZHk7IGJvZHkgPSBib2R5Lm1fbmV4dCkge1xyXG4gICAgICAgICBib2R5Lm1fZm9yY2UuU2V0WmVybygpO1xyXG4gICAgICAgICBib2R5Lm1fdG9ycXVlID0gMC4wO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuRHJhd0RlYnVnRGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgaWYgKHRoaXMubV9kZWJ1Z0RyYXcgPT0gbnVsbCkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2RlYnVnRHJhdy5tX3Nwcml0ZS5ncmFwaGljcy5jbGVhcigpO1xyXG4gICAgICB2YXIgZmxhZ3MgPSB0aGlzLm1fZGVidWdEcmF3LkdldEZsYWdzKCk7XHJcbiAgICAgIHZhciBpID0gMDtcclxuICAgICAgdmFyIGI7XHJcbiAgICAgIHZhciBmO1xyXG4gICAgICB2YXIgcztcclxuICAgICAgdmFyIGo7XHJcbiAgICAgIHZhciBicDtcclxuICAgICAgdmFyIGludlEgPSBuZXcgYjJWZWMyO1xyXG4gICAgICB2YXIgeDEgPSBuZXcgYjJWZWMyO1xyXG4gICAgICB2YXIgeDIgPSBuZXcgYjJWZWMyO1xyXG4gICAgICB2YXIgeGY7XHJcbiAgICAgIHZhciBiMSA9IG5ldyBiMkFBQkIoKTtcclxuICAgICAgdmFyIGIyID0gbmV3IGIyQUFCQigpO1xyXG4gICAgICB2YXIgdnMgPSBbbmV3IGIyVmVjMigpLCBuZXcgYjJWZWMyKCksIG5ldyBiMlZlYzIoKSwgbmV3IGIyVmVjMigpXTtcclxuICAgICAgdmFyIGNvbG9yID0gbmV3IGIyQ29sb3IoMCwgMCwgMCk7XHJcbiAgICAgIGlmIChmbGFncyAmIGIyRGVidWdEcmF3LmVfc2hhcGVCaXQpIHtcclxuICAgICAgICAgZm9yIChiID0gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICAgICAgICBiOyBiID0gYi5tX25leHQpIHtcclxuICAgICAgICAgICAgeGYgPSBiLm1feGY7XHJcbiAgICAgICAgICAgIGZvciAoZiA9IGIuR2V0Rml4dHVyZUxpc3QoKTtcclxuICAgICAgICAgICAgZjsgZiA9IGYubV9uZXh0KSB7XHJcbiAgICAgICAgICAgICAgIHMgPSBmLkdldFNoYXBlKCk7XHJcbiAgICAgICAgICAgICAgIGlmIChiLklzQWN0aXZlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgY29sb3IuU2V0KDAuNSwgMC41LCAwLjMpO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLkRyYXdTaGFwZShzLCB4ZiwgY29sb3IpO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGVsc2UgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbG9yLlNldCgwLjUsIDAuOSwgMC41KTtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5EcmF3U2hhcGUocywgeGYsIGNvbG9yKTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBlbHNlIGlmIChiLkdldFR5cGUoKSA9PSBiMkJvZHkuYjJfa2luZW1hdGljQm9keSkge1xyXG4gICAgICAgICAgICAgICAgICBjb2xvci5TZXQoMC41LCAwLjUsIDAuOSk7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuRHJhd1NoYXBlKHMsIHhmLCBjb2xvcik7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgZWxzZSBpZiAoYi5Jc0F3YWtlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgY29sb3IuU2V0KDAuNiwgMC42LCAwLjYpO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLkRyYXdTaGFwZShzLCB4ZiwgY29sb3IpO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBjb2xvci5TZXQoMC45LCAwLjcsIDAuNyk7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuRHJhd1NoYXBlKHMsIHhmLCBjb2xvcik7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGZsYWdzICYgYjJEZWJ1Z0RyYXcuZV9qb2ludEJpdCkge1xyXG4gICAgICAgICBmb3IgKGogPSB0aGlzLm1fam9pbnRMaXN0O1xyXG4gICAgICAgICBqOyBqID0gai5tX25leHQpIHtcclxuICAgICAgICAgICAgdGhpcy5EcmF3Sm9pbnQoaik7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAoZmxhZ3MgJiBiMkRlYnVnRHJhdy5lX2NvbnRyb2xsZXJCaXQpIHtcclxuICAgICAgICAgZm9yICh2YXIgYyA9IHRoaXMubV9jb250cm9sbGVyTGlzdDsgYzsgYyA9IGMubV9uZXh0KSB7XHJcbiAgICAgICAgICAgIGMuRHJhdyh0aGlzLm1fZGVidWdEcmF3KTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChmbGFncyAmIGIyRGVidWdEcmF3LmVfcGFpckJpdCkge1xyXG4gICAgICAgICBjb2xvci5TZXQoMC4zLCAwLjksIDAuOSk7XHJcbiAgICAgICAgIGZvciAodmFyIGNvbnRhY3QgPSB0aGlzLm1fY29udGFjdE1hbmFnZXIubV9jb250YWN0TGlzdDsgY29udGFjdDsgY29udGFjdCA9IGNvbnRhY3QuR2V0TmV4dCgpKSB7XHJcbiAgICAgICAgICAgIHZhciBmaXh0dXJlQSA9IGNvbnRhY3QuR2V0Rml4dHVyZUEoKTtcclxuICAgICAgICAgICAgdmFyIGZpeHR1cmVCID0gY29udGFjdC5HZXRGaXh0dXJlQigpO1xyXG4gICAgICAgICAgICB2YXIgY0EgPSBmaXh0dXJlQS5HZXRBQUJCKCkuR2V0Q2VudGVyKCk7XHJcbiAgICAgICAgICAgIHZhciBjQiA9IGZpeHR1cmVCLkdldEFBQkIoKS5HZXRDZW50ZXIoKTtcclxuICAgICAgICAgICAgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U2VnbWVudChjQSwgY0IsIGNvbG9yKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChmbGFncyAmIGIyRGVidWdEcmF3LmVfYWFiYkJpdCkge1xyXG4gICAgICAgICBicCA9IHRoaXMubV9jb250YWN0TWFuYWdlci5tX2Jyb2FkUGhhc2U7XHJcbiAgICAgICAgIHZzID0gW25ldyBiMlZlYzIoKSwgbmV3IGIyVmVjMigpLCBuZXcgYjJWZWMyKCksIG5ldyBiMlZlYzIoKV07XHJcbiAgICAgICAgIGZvciAoYiA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgICAgYjsgYiA9IGIuR2V0TmV4dCgpKSB7XHJcbiAgICAgICAgICAgIGlmIChiLklzQWN0aXZlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChmID0gYi5HZXRGaXh0dXJlTGlzdCgpO1xyXG4gICAgICAgICAgICBmOyBmID0gZi5HZXROZXh0KCkpIHtcclxuICAgICAgICAgICAgICAgdmFyIGFhYmIgPSBicC5HZXRGYXRBQUJCKGYubV9wcm94eSk7XHJcbiAgICAgICAgICAgICAgIHZzWzBdLlNldChhYWJiLmxvd2VyQm91bmQueCwgYWFiYi5sb3dlckJvdW5kLnkpO1xyXG4gICAgICAgICAgICAgICB2c1sxXS5TZXQoYWFiYi51cHBlckJvdW5kLngsIGFhYmIubG93ZXJCb3VuZC55KTtcclxuICAgICAgICAgICAgICAgdnNbMl0uU2V0KGFhYmIudXBwZXJCb3VuZC54LCBhYWJiLnVwcGVyQm91bmQueSk7XHJcbiAgICAgICAgICAgICAgIHZzWzNdLlNldChhYWJiLmxvd2VyQm91bmQueCwgYWFiYi51cHBlckJvdW5kLnkpO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdQb2x5Z29uKHZzLCA0LCBjb2xvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChmbGFncyAmIGIyRGVidWdEcmF3LmVfY2VudGVyT2ZNYXNzQml0KSB7XHJcbiAgICAgICAgIGZvciAoYiA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgICAgYjsgYiA9IGIubV9uZXh0KSB7XHJcbiAgICAgICAgICAgIHhmID0gYjJXb3JsZC5zX3hmO1xyXG4gICAgICAgICAgICB4Zi5SID0gYi5tX3hmLlI7XHJcbiAgICAgICAgICAgIHhmLnBvc2l0aW9uID0gYi5HZXRXb3JsZENlbnRlcigpO1xyXG4gICAgICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdUcmFuc2Zvcm0oeGYpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5RdWVyeUFBQkIgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIGFhYmIpIHtcclxuICAgICAgdmFyIF9fdGhpcyA9IHRoaXM7XHJcbiAgICAgIHZhciBicm9hZFBoYXNlID0gX190aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlO1xyXG5cclxuICAgICAgZnVuY3Rpb24gV29ybGRRdWVyeVdyYXBwZXIocHJveHkpIHtcclxuICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGJyb2FkUGhhc2UuR2V0VXNlckRhdGEocHJveHkpKTtcclxuICAgICAgfTtcclxuICAgICAgYnJvYWRQaGFzZS5RdWVyeShXb3JsZFF1ZXJ5V3JhcHBlciwgYWFiYik7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuUXVlcnlTaGFwZSA9IGZ1bmN0aW9uIChjYWxsYmFjaywgc2hhcGUsIHRyYW5zZm9ybSkge1xyXG4gICAgICB2YXIgX190aGlzID0gdGhpcztcclxuICAgICAgaWYgKHRyYW5zZm9ybSA9PT0gdW5kZWZpbmVkKSB0cmFuc2Zvcm0gPSBudWxsO1xyXG4gICAgICBpZiAodHJhbnNmb3JtID09IG51bGwpIHtcclxuICAgICAgICAgdHJhbnNmb3JtID0gbmV3IGIyVHJhbnNmb3JtKCk7XHJcbiAgICAgICAgIHRyYW5zZm9ybS5TZXRJZGVudGl0eSgpO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBicm9hZFBoYXNlID0gX190aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlO1xyXG5cclxuICAgICAgZnVuY3Rpb24gV29ybGRRdWVyeVdyYXBwZXIocHJveHkpIHtcclxuICAgICAgICAgdmFyIGZpeHR1cmUgPSAoYnJvYWRQaGFzZS5HZXRVc2VyRGF0YShwcm94eSkgaW5zdGFuY2VvZiBiMkZpeHR1cmUgPyBicm9hZFBoYXNlLkdldFVzZXJEYXRhKHByb3h5KSA6IG51bGwpO1xyXG4gICAgICAgICBpZiAoYjJTaGFwZS5UZXN0T3ZlcmxhcChzaGFwZSwgdHJhbnNmb3JtLCBmaXh0dXJlLkdldFNoYXBlKCksIGZpeHR1cmUuR2V0Qm9keSgpLkdldFRyYW5zZm9ybSgpKSkgcmV0dXJuIGNhbGxiYWNrKGZpeHR1cmUpO1xyXG4gICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfTtcclxuICAgICAgdmFyIGFhYmIgPSBuZXcgYjJBQUJCKCk7XHJcbiAgICAgIHNoYXBlLkNvbXB1dGVBQUJCKGFhYmIsIHRyYW5zZm9ybSk7XHJcbiAgICAgIGJyb2FkUGhhc2UuUXVlcnkoV29ybGRRdWVyeVdyYXBwZXIsIGFhYmIpO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlF1ZXJ5UG9pbnQgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHApIHtcclxuICAgICAgdmFyIF9fdGhpcyA9IHRoaXM7XHJcbiAgICAgIHZhciBicm9hZFBoYXNlID0gX190aGlzLm1fY29udGFjdE1hbmFnZXIubV9icm9hZFBoYXNlO1xyXG5cclxuICAgICAgZnVuY3Rpb24gV29ybGRRdWVyeVdyYXBwZXIocHJveHkpIHtcclxuICAgICAgICAgdmFyIGZpeHR1cmUgPSAoYnJvYWRQaGFzZS5HZXRVc2VyRGF0YShwcm94eSkgaW5zdGFuY2VvZiBiMkZpeHR1cmUgPyBicm9hZFBoYXNlLkdldFVzZXJEYXRhKHByb3h5KSA6IG51bGwpO1xyXG4gICAgICAgICBpZiAoZml4dHVyZS5UZXN0UG9pbnQocCkpIHJldHVybiBjYWxsYmFjayhmaXh0dXJlKTtcclxuICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH07XHJcbiAgICAgIHZhciBhYWJiID0gbmV3IGIyQUFCQigpO1xyXG4gICAgICBhYWJiLmxvd2VyQm91bmQuU2V0KHAueCAtIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgcC55IC0gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKTtcclxuICAgICAgYWFiYi51cHBlckJvdW5kLlNldChwLnggKyBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AsIHAueSArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCk7XHJcbiAgICAgIGJyb2FkUGhhc2UuUXVlcnkoV29ybGRRdWVyeVdyYXBwZXIsIGFhYmIpO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlJheUNhc3QgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHBvaW50MSwgcG9pbnQyKSB7XHJcbiAgICAgIHZhciBfX3RoaXMgPSB0aGlzO1xyXG4gICAgICB2YXIgYnJvYWRQaGFzZSA9IF9fdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLm1fYnJvYWRQaGFzZTtcclxuICAgICAgdmFyIG91dHB1dCA9IG5ldyBiMlJheUNhc3RPdXRwdXQ7XHJcblxyXG4gICAgICBmdW5jdGlvbiBSYXlDYXN0V3JhcHBlcihpbnB1dCwgcHJveHkpIHtcclxuICAgICAgICAgdmFyIHVzZXJEYXRhID0gYnJvYWRQaGFzZS5HZXRVc2VyRGF0YShwcm94eSk7XHJcbiAgICAgICAgIHZhciBmaXh0dXJlID0gKHVzZXJEYXRhIGluc3RhbmNlb2YgYjJGaXh0dXJlID8gdXNlckRhdGEgOiBudWxsKTtcclxuICAgICAgICAgdmFyIGhpdCA9IGZpeHR1cmUuUmF5Q2FzdChvdXRwdXQsIGlucHV0KTtcclxuICAgICAgICAgaWYgKGhpdCkge1xyXG4gICAgICAgICAgICB2YXIgZnJhY3Rpb24gPSBvdXRwdXQuZnJhY3Rpb247XHJcbiAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBiMlZlYzIoKDEuMCAtIGZyYWN0aW9uKSAqIHBvaW50MS54ICsgZnJhY3Rpb24gKiBwb2ludDIueCwgKDEuMCAtIGZyYWN0aW9uKSAqIHBvaW50MS55ICsgZnJhY3Rpb24gKiBwb2ludDIueSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhmaXh0dXJlLCBwb2ludCwgb3V0cHV0Lm5vcm1hbCwgZnJhY3Rpb24pO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHJldHVybiBpbnB1dC5tYXhGcmFjdGlvbjtcclxuICAgICAgfTtcclxuICAgICAgdmFyIGlucHV0ID0gbmV3IGIyUmF5Q2FzdElucHV0KHBvaW50MSwgcG9pbnQyKTtcclxuICAgICAgYnJvYWRQaGFzZS5SYXlDYXN0KFJheUNhc3RXcmFwcGVyLCBpbnB1dCk7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuUmF5Q2FzdE9uZSA9IGZ1bmN0aW9uIChwb2ludDEsIHBvaW50Mikge1xyXG4gICAgICB2YXIgX190aGlzID0gdGhpcztcclxuICAgICAgdmFyIHJlc3VsdDtcclxuXHJcbiAgICAgIGZ1bmN0aW9uIFJheUNhc3RPbmVXcmFwcGVyKGZpeHR1cmUsIHBvaW50LCBub3JtYWwsIGZyYWN0aW9uKSB7XHJcbiAgICAgICAgIGlmIChmcmFjdGlvbiA9PT0gdW5kZWZpbmVkKSBmcmFjdGlvbiA9IDA7XHJcbiAgICAgICAgIHJlc3VsdCA9IGZpeHR1cmU7XHJcbiAgICAgICAgIHJldHVybiBmcmFjdGlvbjtcclxuICAgICAgfTtcclxuICAgICAgX190aGlzLlJheUNhc3QoUmF5Q2FzdE9uZVdyYXBwZXIsIHBvaW50MSwgcG9pbnQyKTtcclxuICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5SYXlDYXN0QWxsID0gZnVuY3Rpb24gKHBvaW50MSwgcG9pbnQyKSB7XHJcbiAgICAgIHZhciBfX3RoaXMgPSB0aGlzO1xyXG4gICAgICB2YXIgcmVzdWx0ID0gbmV3IFZlY3RvcigpO1xyXG5cclxuICAgICAgZnVuY3Rpb24gUmF5Q2FzdEFsbFdyYXBwZXIoZml4dHVyZSwgcG9pbnQsIG5vcm1hbCwgZnJhY3Rpb24pIHtcclxuICAgICAgICAgaWYgKGZyYWN0aW9uID09PSB1bmRlZmluZWQpIGZyYWN0aW9uID0gMDtcclxuICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gZml4dHVyZTtcclxuICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgIH07XHJcbiAgICAgIF9fdGhpcy5SYXlDYXN0KFJheUNhc3RBbGxXcmFwcGVyLCBwb2ludDEsIHBvaW50Mik7XHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0Qm9keUxpc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUxpc3Q7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuR2V0Sm9pbnRMaXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2pvaW50TGlzdDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5HZXRDb250YWN0TGlzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9jb250YWN0TGlzdDtcclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5Jc0xvY2tlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLm1fZmxhZ3MgJiBiMldvcmxkLmVfbG9ja2VkKSA+IDA7XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuU29sdmUgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgYjtcclxuICAgICAgZm9yICh2YXIgY29udHJvbGxlciA9IHRoaXMubV9jb250cm9sbGVyTGlzdDsgY29udHJvbGxlcjsgY29udHJvbGxlciA9IGNvbnRyb2xsZXIubV9uZXh0KSB7XHJcbiAgICAgICAgIGNvbnRyb2xsZXIuU3RlcChzdGVwKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgaXNsYW5kID0gdGhpcy5tX2lzbGFuZDtcclxuICAgICAgaXNsYW5kLkluaXRpYWxpemUodGhpcy5tX2JvZHlDb3VudCwgdGhpcy5tX2NvbnRhY3RDb3VudCwgdGhpcy5tX2pvaW50Q291bnQsIG51bGwsIHRoaXMubV9jb250YWN0TWFuYWdlci5tX2NvbnRhY3RMaXN0ZW5lciwgdGhpcy5tX2NvbnRhY3RTb2x2ZXIpO1xyXG4gICAgICBmb3IgKGIgPSB0aGlzLm1fYm9keUxpc3Q7XHJcbiAgICAgIGI7IGIgPSBiLm1fbmV4dCkge1xyXG4gICAgICAgICBiLm1fZmxhZ3MgJj0gfmIyQm9keS5lX2lzbGFuZEZsYWc7XHJcbiAgICAgIH1cclxuICAgICAgZm9yICh2YXIgYyA9IHRoaXMubV9jb250YWN0TGlzdDsgYzsgYyA9IGMubV9uZXh0KSB7XHJcbiAgICAgICAgIGMubV9mbGFncyAmPSB+YjJDb250YWN0LmVfaXNsYW5kRmxhZztcclxuICAgICAgfVxyXG4gICAgICBmb3IgKHZhciBqID0gdGhpcy5tX2pvaW50TGlzdDsgajsgaiA9IGoubV9uZXh0KSB7XHJcbiAgICAgICAgIGoubV9pc2xhbmRGbGFnID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIHN0YWNrU2l6ZSA9IHBhcnNlSW50KHRoaXMubV9ib2R5Q291bnQpO1xyXG4gICAgICB2YXIgc3RhY2sgPSB0aGlzLnNfc3RhY2s7XHJcbiAgICAgIGZvciAodmFyIHNlZWQgPSB0aGlzLm1fYm9keUxpc3Q7IHNlZWQ7IHNlZWQgPSBzZWVkLm1fbmV4dCkge1xyXG4gICAgICAgICBpZiAoc2VlZC5tX2ZsYWdzICYgYjJCb2R5LmVfaXNsYW5kRmxhZykge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAoc2VlZC5Jc0F3YWtlKCkgPT0gZmFsc2UgfHwgc2VlZC5Jc0FjdGl2ZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChzZWVkLkdldFR5cGUoKSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpc2xhbmQuQ2xlYXIoKTtcclxuICAgICAgICAgdmFyIHN0YWNrQ291bnQgPSAwO1xyXG4gICAgICAgICBzdGFja1tzdGFja0NvdW50KytdID0gc2VlZDtcclxuICAgICAgICAgc2VlZC5tX2ZsYWdzIHw9IGIyQm9keS5lX2lzbGFuZEZsYWc7XHJcbiAgICAgICAgIHdoaWxlIChzdGFja0NvdW50ID4gMCkge1xyXG4gICAgICAgICAgICBiID0gc3RhY2tbLS1zdGFja0NvdW50XTtcclxuICAgICAgICAgICAgaXNsYW5kLkFkZEJvZHkoYik7XHJcbiAgICAgICAgICAgIGlmIChiLklzQXdha2UoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICBiLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChiLkdldFR5cGUoKSA9PSBiMkJvZHkuYjJfc3RhdGljQm9keSkge1xyXG4gICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgb3RoZXI7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGNlID0gYi5tX2NvbnRhY3RMaXN0OyBjZTsgY2UgPSBjZS5uZXh0KSB7XHJcbiAgICAgICAgICAgICAgIGlmIChjZS5jb250YWN0Lm1fZmxhZ3MgJiBiMkNvbnRhY3QuZV9pc2xhbmRGbGFnKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGlmIChjZS5jb250YWN0LklzU2Vuc29yKCkgPT0gdHJ1ZSB8fCBjZS5jb250YWN0LklzRW5hYmxlZCgpID09IGZhbHNlIHx8IGNlLmNvbnRhY3QuSXNUb3VjaGluZygpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGlzbGFuZC5BZGRDb250YWN0KGNlLmNvbnRhY3QpO1xyXG4gICAgICAgICAgICAgICBjZS5jb250YWN0Lm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfaXNsYW5kRmxhZztcclxuICAgICAgICAgICAgICAgb3RoZXIgPSBjZS5vdGhlcjtcclxuICAgICAgICAgICAgICAgaWYgKG90aGVyLm1fZmxhZ3MgJiBiMkJvZHkuZV9pc2xhbmRGbGFnKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIHN0YWNrW3N0YWNrQ291bnQrK10gPSBvdGhlcjtcclxuICAgICAgICAgICAgICAgb3RoZXIubV9mbGFncyB8PSBiMkJvZHkuZV9pc2xhbmRGbGFnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAodmFyIGpuID0gYi5tX2pvaW50TGlzdDsgam47IGpuID0gam4ubmV4dCkge1xyXG4gICAgICAgICAgICAgICBpZiAoam4uam9pbnQubV9pc2xhbmRGbGFnID09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgb3RoZXIgPSBqbi5vdGhlcjtcclxuICAgICAgICAgICAgICAgaWYgKG90aGVyLklzQWN0aXZlKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgaXNsYW5kLkFkZEpvaW50KGpuLmpvaW50KTtcclxuICAgICAgICAgICAgICAgam4uam9pbnQubV9pc2xhbmRGbGFnID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgaWYgKG90aGVyLm1fZmxhZ3MgJiBiMkJvZHkuZV9pc2xhbmRGbGFnKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIHN0YWNrW3N0YWNrQ291bnQrK10gPSBvdGhlcjtcclxuICAgICAgICAgICAgICAgb3RoZXIubV9mbGFncyB8PSBiMkJvZHkuZV9pc2xhbmRGbGFnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaXNsYW5kLlNvbHZlKHN0ZXAsIHRoaXMubV9ncmF2aXR5LCB0aGlzLm1fYWxsb3dTbGVlcCk7XHJcbiAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXNsYW5kLm1fYm9keUNvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgYiA9IGlzbGFuZC5tX2JvZGllc1tpXTtcclxuICAgICAgICAgICAgaWYgKGIuR2V0VHlwZSgpID09IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgIGIubV9mbGFncyAmPSB+YjJCb2R5LmVfaXNsYW5kRmxhZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChpID0gMDtcclxuICAgICAgaSA8IHN0YWNrLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgIGlmICghc3RhY2tbaV0pIGJyZWFrO1xyXG4gICAgICAgICBzdGFja1tpXSA9IG51bGw7XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChiID0gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICAgICBiOyBiID0gYi5tX25leHQpIHtcclxuICAgICAgICAgaWYgKGIuSXNBd2FrZSgpID09IGZhbHNlIHx8IGIuSXNBY3RpdmUoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAoYi5HZXRUeXBlKCkgPT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYi5TeW5jaHJvbml6ZUZpeHR1cmVzKCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLkZpbmROZXdDb250YWN0cygpO1xyXG4gICB9XHJcbiAgIGIyV29ybGQucHJvdG90eXBlLlNvbHZlVE9JID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGI7XHJcbiAgICAgIHZhciBmQTtcclxuICAgICAgdmFyIGZCO1xyXG4gICAgICB2YXIgYkE7XHJcbiAgICAgIHZhciBiQjtcclxuICAgICAgdmFyIGNFZGdlO1xyXG4gICAgICB2YXIgajtcclxuICAgICAgdmFyIGlzbGFuZCA9IHRoaXMubV9pc2xhbmQ7XHJcbiAgICAgIGlzbGFuZC5Jbml0aWFsaXplKHRoaXMubV9ib2R5Q291bnQsIGIyU2V0dGluZ3MuYjJfbWF4VE9JQ29udGFjdHNQZXJJc2xhbmQsIGIyU2V0dGluZ3MuYjJfbWF4VE9JSm9pbnRzUGVySXNsYW5kLCBudWxsLCB0aGlzLm1fY29udGFjdE1hbmFnZXIubV9jb250YWN0TGlzdGVuZXIsIHRoaXMubV9jb250YWN0U29sdmVyKTtcclxuICAgICAgdmFyIHF1ZXVlID0gYjJXb3JsZC5zX3F1ZXVlO1xyXG4gICAgICBmb3IgKGIgPSB0aGlzLm1fYm9keUxpc3Q7XHJcbiAgICAgIGI7IGIgPSBiLm1fbmV4dCkge1xyXG4gICAgICAgICBiLm1fZmxhZ3MgJj0gfmIyQm9keS5lX2lzbGFuZEZsYWc7XHJcbiAgICAgICAgIGIubV9zd2VlcC50MCA9IDAuMDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgYztcclxuICAgICAgZm9yIChjID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xyXG4gICAgICBjOyBjID0gYy5tX25leHQpIHtcclxuICAgICAgICAgYy5tX2ZsYWdzICY9IH4gKGIyQ29udGFjdC5lX3RvaUZsYWcgfCBiMkNvbnRhY3QuZV9pc2xhbmRGbGFnKTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGogPSB0aGlzLm1fam9pbnRMaXN0O1xyXG4gICAgICBqOyBqID0gai5tX25leHQpIHtcclxuICAgICAgICAgai5tX2lzbGFuZEZsYWcgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKDs7KSB7XHJcbiAgICAgICAgIHZhciBtaW5Db250YWN0ID0gbnVsbDtcclxuICAgICAgICAgdmFyIG1pblRPSSA9IDEuMDtcclxuICAgICAgICAgZm9yIChjID0gdGhpcy5tX2NvbnRhY3RMaXN0O1xyXG4gICAgICAgICBjOyBjID0gYy5tX25leHQpIHtcclxuICAgICAgICAgICAgaWYgKGMuSXNTZW5zb3IoKSA9PSB0cnVlIHx8IGMuSXNFbmFibGVkKCkgPT0gZmFsc2UgfHwgYy5Jc0NvbnRpbnVvdXMoKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdG9pID0gMS4wO1xyXG4gICAgICAgICAgICBpZiAoYy5tX2ZsYWdzICYgYjJDb250YWN0LmVfdG9pRmxhZykge1xyXG4gICAgICAgICAgICAgICB0b2kgPSBjLm1fdG9pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICBmQSA9IGMubV9maXh0dXJlQTtcclxuICAgICAgICAgICAgICAgZkIgPSBjLm1fZml4dHVyZUI7XHJcbiAgICAgICAgICAgICAgIGJBID0gZkEubV9ib2R5O1xyXG4gICAgICAgICAgICAgICBiQiA9IGZCLm1fYm9keTtcclxuICAgICAgICAgICAgICAgaWYgKChiQS5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5IHx8IGJBLklzQXdha2UoKSA9PSBmYWxzZSkgJiYgKGJCLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkgfHwgYkIuSXNBd2FrZSgpID09IGZhbHNlKSkge1xyXG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICB2YXIgdDAgPSBiQS5tX3N3ZWVwLnQwO1xyXG4gICAgICAgICAgICAgICBpZiAoYkEubV9zd2VlcC50MCA8IGJCLm1fc3dlZXAudDApIHtcclxuICAgICAgICAgICAgICAgICAgdDAgPSBiQi5tX3N3ZWVwLnQwO1xyXG4gICAgICAgICAgICAgICAgICBiQS5tX3N3ZWVwLkFkdmFuY2UodDApO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGVsc2UgaWYgKGJCLm1fc3dlZXAudDAgPCBiQS5tX3N3ZWVwLnQwKSB7XHJcbiAgICAgICAgICAgICAgICAgIHQwID0gYkEubV9zd2VlcC50MDtcclxuICAgICAgICAgICAgICAgICAgYkIubV9zd2VlcC5BZHZhbmNlKHQwKTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICB0b2kgPSBjLkNvbXB1dGVUT0koYkEubV9zd2VlcCwgYkIubV9zd2VlcCk7XHJcbiAgICAgICAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoMC4wIDw9IHRvaSAmJiB0b2kgPD0gMS4wKTtcclxuICAgICAgICAgICAgICAgaWYgKHRvaSA+IDAuMCAmJiB0b2kgPCAxLjApIHtcclxuICAgICAgICAgICAgICAgICAgdG9pID0gKDEuMCAtIHRvaSkgKiB0MCArIHRvaTtcclxuICAgICAgICAgICAgICAgICAgaWYgKHRvaSA+IDEpIHRvaSA9IDE7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgYy5tX3RvaSA9IHRvaTtcclxuICAgICAgICAgICAgICAgYy5tX2ZsYWdzIHw9IGIyQ29udGFjdC5lX3RvaUZsYWc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKE51bWJlci5NSU5fVkFMVUUgPCB0b2kgJiYgdG9pIDwgbWluVE9JKSB7XHJcbiAgICAgICAgICAgICAgIG1pbkNvbnRhY3QgPSBjO1xyXG4gICAgICAgICAgICAgICBtaW5UT0kgPSB0b2k7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAobWluQ29udGFjdCA9PSBudWxsIHx8IDEuMCAtIDEwMC4wICogTnVtYmVyLk1JTl9WQUxVRSA8IG1pblRPSSkge1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBmQSA9IG1pbkNvbnRhY3QubV9maXh0dXJlQTtcclxuICAgICAgICAgZkIgPSBtaW5Db250YWN0Lm1fZml4dHVyZUI7XHJcbiAgICAgICAgIGJBID0gZkEubV9ib2R5O1xyXG4gICAgICAgICBiQiA9IGZCLm1fYm9keTtcclxuICAgICAgICAgYjJXb3JsZC5zX2JhY2t1cEEuU2V0KGJBLm1fc3dlZXApO1xyXG4gICAgICAgICBiMldvcmxkLnNfYmFja3VwQi5TZXQoYkIubV9zd2VlcCk7XHJcbiAgICAgICAgIGJBLkFkdmFuY2UobWluVE9JKTtcclxuICAgICAgICAgYkIuQWR2YW5jZShtaW5UT0kpO1xyXG4gICAgICAgICBtaW5Db250YWN0LlVwZGF0ZSh0aGlzLm1fY29udGFjdE1hbmFnZXIubV9jb250YWN0TGlzdGVuZXIpO1xyXG4gICAgICAgICBtaW5Db250YWN0Lm1fZmxhZ3MgJj0gfmIyQ29udGFjdC5lX3RvaUZsYWc7XHJcbiAgICAgICAgIGlmIChtaW5Db250YWN0LklzU2Vuc29yKCkgPT0gdHJ1ZSB8fCBtaW5Db250YWN0LklzRW5hYmxlZCgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGJBLm1fc3dlZXAuU2V0KGIyV29ybGQuc19iYWNrdXBBKTtcclxuICAgICAgICAgICAgYkIubV9zd2VlcC5TZXQoYjJXb3JsZC5zX2JhY2t1cEIpO1xyXG4gICAgICAgICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICAgICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBpZiAobWluQ29udGFjdC5Jc1RvdWNoaW5nKCkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIHNlZWQgPSBiQTtcclxuICAgICAgICAgaWYgKHNlZWQuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9keW5hbWljQm9keSkge1xyXG4gICAgICAgICAgICBzZWVkID0gYkI7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaXNsYW5kLkNsZWFyKCk7XHJcbiAgICAgICAgIHZhciBxdWV1ZVN0YXJ0ID0gMDtcclxuICAgICAgICAgdmFyIHF1ZXVlU2l6ZSA9IDA7XHJcbiAgICAgICAgIHF1ZXVlW3F1ZXVlU3RhcnQgKyBxdWV1ZVNpemUrK10gPSBzZWVkO1xyXG4gICAgICAgICBzZWVkLm1fZmxhZ3MgfD0gYjJCb2R5LmVfaXNsYW5kRmxhZztcclxuICAgICAgICAgd2hpbGUgKHF1ZXVlU2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgYiA9IHF1ZXVlW3F1ZXVlU3RhcnQrK107XHJcbiAgICAgICAgICAgIC0tcXVldWVTaXplO1xyXG4gICAgICAgICAgICBpc2xhbmQuQWRkQm9keShiKTtcclxuICAgICAgICAgICAgaWYgKGIuSXNBd2FrZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgIGIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGIuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9keW5hbWljQm9keSkge1xyXG4gICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGNFZGdlID0gYi5tX2NvbnRhY3RMaXN0O1xyXG4gICAgICAgICAgICBjRWRnZTsgY0VkZ2UgPSBjRWRnZS5uZXh0KSB7XHJcbiAgICAgICAgICAgICAgIGlmIChpc2xhbmQubV9jb250YWN0Q291bnQgPT0gaXNsYW5kLm1fY29udGFjdENhcGFjaXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGlmIChjRWRnZS5jb250YWN0Lm1fZmxhZ3MgJiBiMkNvbnRhY3QuZV9pc2xhbmRGbGFnKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGlmIChjRWRnZS5jb250YWN0LklzU2Vuc29yKCkgPT0gdHJ1ZSB8fCBjRWRnZS5jb250YWN0LklzRW5hYmxlZCgpID09IGZhbHNlIHx8IGNFZGdlLmNvbnRhY3QuSXNUb3VjaGluZygpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGlzbGFuZC5BZGRDb250YWN0KGNFZGdlLmNvbnRhY3QpO1xyXG4gICAgICAgICAgICAgICBjRWRnZS5jb250YWN0Lm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfaXNsYW5kRmxhZztcclxuICAgICAgICAgICAgICAgdmFyIG90aGVyID0gY0VkZ2Uub3RoZXI7XHJcbiAgICAgICAgICAgICAgIGlmIChvdGhlci5tX2ZsYWdzICYgYjJCb2R5LmVfaXNsYW5kRmxhZykge1xyXG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBpZiAob3RoZXIuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9zdGF0aWNCb2R5KSB7XHJcbiAgICAgICAgICAgICAgICAgIG90aGVyLkFkdmFuY2UobWluVE9JKTtcclxuICAgICAgICAgICAgICAgICAgb3RoZXIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgcXVldWVbcXVldWVTdGFydCArIHF1ZXVlU2l6ZV0gPSBvdGhlcjtcclxuICAgICAgICAgICAgICAgKytxdWV1ZVNpemU7XHJcbiAgICAgICAgICAgICAgIG90aGVyLm1fZmxhZ3MgfD0gYjJCb2R5LmVfaXNsYW5kRmxhZztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBqRWRnZSA9IGIubV9qb2ludExpc3Q7IGpFZGdlOyBqRWRnZSA9IGpFZGdlLm5leHQpIHtcclxuICAgICAgICAgICAgICAgaWYgKGlzbGFuZC5tX2pvaW50Q291bnQgPT0gaXNsYW5kLm1fam9pbnRDYXBhY2l0eSkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIGlmIChqRWRnZS5qb2ludC5tX2lzbGFuZEZsYWcgPT0gdHJ1ZSkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIG90aGVyID0gakVkZ2Uub3RoZXI7XHJcbiAgICAgICAgICAgICAgIGlmIChvdGhlci5Jc0FjdGl2ZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIGlzbGFuZC5BZGRKb2ludChqRWRnZS5qb2ludCk7XHJcbiAgICAgICAgICAgICAgIGpFZGdlLmpvaW50Lm1faXNsYW5kRmxhZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgIGlmIChvdGhlci5tX2ZsYWdzICYgYjJCb2R5LmVfaXNsYW5kRmxhZykgY29udGludWU7XHJcbiAgICAgICAgICAgICAgIGlmIChvdGhlci5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX3N0YXRpY0JvZHkpIHtcclxuICAgICAgICAgICAgICAgICAgb3RoZXIuQWR2YW5jZShtaW5UT0kpO1xyXG4gICAgICAgICAgICAgICAgICBvdGhlci5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBxdWV1ZVtxdWV1ZVN0YXJ0ICsgcXVldWVTaXplXSA9IG90aGVyO1xyXG4gICAgICAgICAgICAgICArK3F1ZXVlU2l6ZTtcclxuICAgICAgICAgICAgICAgb3RoZXIubV9mbGFncyB8PSBiMkJvZHkuZV9pc2xhbmRGbGFnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIHN1YlN0ZXAgPSBiMldvcmxkLnNfdGltZXN0ZXA7XHJcbiAgICAgICAgIHN1YlN0ZXAud2FybVN0YXJ0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgIHN1YlN0ZXAuZHQgPSAoMS4wIC0gbWluVE9JKSAqIHN0ZXAuZHQ7XHJcbiAgICAgICAgIHN1YlN0ZXAuaW52X2R0ID0gMS4wIC8gc3ViU3RlcC5kdDtcclxuICAgICAgICAgc3ViU3RlcC5kdFJhdGlvID0gMC4wO1xyXG4gICAgICAgICBzdWJTdGVwLnZlbG9jaXR5SXRlcmF0aW9ucyA9IHN0ZXAudmVsb2NpdHlJdGVyYXRpb25zO1xyXG4gICAgICAgICBzdWJTdGVwLnBvc2l0aW9uSXRlcmF0aW9ucyA9IHN0ZXAucG9zaXRpb25JdGVyYXRpb25zO1xyXG4gICAgICAgICBpc2xhbmQuU29sdmVUT0koc3ViU3RlcCk7XHJcbiAgICAgICAgIHZhciBpID0gMDtcclxuICAgICAgICAgZm9yIChpID0gMDtcclxuICAgICAgICAgaSA8IGlzbGFuZC5tX2JvZHlDb3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgIGIgPSBpc2xhbmQubV9ib2RpZXNbaV07XHJcbiAgICAgICAgICAgIGIubV9mbGFncyAmPSB+YjJCb2R5LmVfaXNsYW5kRmxhZztcclxuICAgICAgICAgICAgaWYgKGIuSXNBd2FrZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChiLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkpIHtcclxuICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYi5TeW5jaHJvbml6ZUZpeHR1cmVzKCk7XHJcbiAgICAgICAgICAgIGZvciAoY0VkZ2UgPSBiLm1fY29udGFjdExpc3Q7XHJcbiAgICAgICAgICAgIGNFZGdlOyBjRWRnZSA9IGNFZGdlLm5leHQpIHtcclxuICAgICAgICAgICAgICAgY0VkZ2UuY29udGFjdC5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV90b2lGbGFnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZm9yIChpID0gMDtcclxuICAgICAgICAgaSA8IGlzbGFuZC5tX2NvbnRhY3RDb3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgIGMgPSBpc2xhbmQubV9jb250YWN0c1tpXTtcclxuICAgICAgICAgICAgYy5tX2ZsYWdzICY9IH4gKGIyQ29udGFjdC5lX3RvaUZsYWcgfCBiMkNvbnRhY3QuZV9pc2xhbmRGbGFnKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICBpIDwgaXNsYW5kLm1fam9pbnRDb3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgIGogPSBpc2xhbmQubV9qb2ludHNbaV07XHJcbiAgICAgICAgICAgIGoubV9pc2xhbmRGbGFnID0gZmFsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdGhpcy5tX2NvbnRhY3RNYW5hZ2VyLkZpbmROZXdDb250YWN0cygpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJXb3JsZC5wcm90b3R5cGUuRHJhd0pvaW50ID0gZnVuY3Rpb24gKGpvaW50KSB7XHJcbiAgICAgIHZhciBiMSA9IGpvaW50LkdldEJvZHlBKCk7XHJcbiAgICAgIHZhciBiMiA9IGpvaW50LkdldEJvZHlCKCk7XHJcbiAgICAgIHZhciB4ZjEgPSBiMS5tX3hmO1xyXG4gICAgICB2YXIgeGYyID0gYjIubV94ZjtcclxuICAgICAgdmFyIHgxID0geGYxLnBvc2l0aW9uO1xyXG4gICAgICB2YXIgeDIgPSB4ZjIucG9zaXRpb247XHJcbiAgICAgIHZhciBwMSA9IGpvaW50LkdldEFuY2hvckEoKTtcclxuICAgICAgdmFyIHAyID0gam9pbnQuR2V0QW5jaG9yQigpO1xyXG4gICAgICB2YXIgY29sb3IgPSBiMldvcmxkLnNfam9pbnRDb2xvcjtcclxuICAgICAgc3dpdGNoIChqb2ludC5tX3R5cGUpIHtcclxuICAgICAgY2FzZSBiMkpvaW50LmVfZGlzdGFuY2VKb2ludDpcclxuICAgICAgICAgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U2VnbWVudChwMSwgcDIsIGNvbG9yKTtcclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX3B1bGxleUpvaW50OlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBwdWxsZXkgPSAoKGpvaW50IGluc3RhbmNlb2YgYjJQdWxsZXlKb2ludCA/IGpvaW50IDogbnVsbCkpO1xyXG4gICAgICAgICAgICB2YXIgczEgPSBwdWxsZXkuR2V0R3JvdW5kQW5jaG9yQSgpO1xyXG4gICAgICAgICAgICB2YXIgczIgPSBwdWxsZXkuR2V0R3JvdW5kQW5jaG9yQigpO1xyXG4gICAgICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHMxLCBwMSwgY29sb3IpO1xyXG4gICAgICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHMyLCBwMiwgY29sb3IpO1xyXG4gICAgICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHMxLCBzMiwgY29sb3IpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIGIySm9pbnQuZV9tb3VzZUpvaW50OlxyXG4gICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHAxLCBwMiwgY29sb3IpO1xyXG4gICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgaWYgKGIxICE9IHRoaXMubV9ncm91bmRCb2R5KSB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHgxLCBwMSwgY29sb3IpO1xyXG4gICAgICAgICB0aGlzLm1fZGVidWdEcmF3LkRyYXdTZWdtZW50KHAxLCBwMiwgY29sb3IpO1xyXG4gICAgICAgICBpZiAoYjIgIT0gdGhpcy5tX2dyb3VuZEJvZHkpIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQoeDIsIHAyLCBjb2xvcik7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMldvcmxkLnByb3RvdHlwZS5EcmF3U2hhcGUgPSBmdW5jdGlvbiAoc2hhcGUsIHhmLCBjb2xvcikge1xyXG4gICAgICBzd2l0Y2ggKHNoYXBlLm1fdHlwZSkge1xyXG4gICAgICBjYXNlIGIyU2hhcGUuZV9jaXJjbGVTaGFwZTpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgY2lyY2xlID0gKChzaGFwZSBpbnN0YW5jZW9mIGIyQ2lyY2xlU2hhcGUgPyBzaGFwZSA6IG51bGwpKTtcclxuICAgICAgICAgICAgdmFyIGNlbnRlciA9IGIyTWF0aC5NdWxYKHhmLCBjaXJjbGUubV9wKTtcclxuICAgICAgICAgICAgdmFyIHJhZGl1cyA9IGNpcmNsZS5tX3JhZGl1cztcclxuICAgICAgICAgICAgdmFyIGF4aXMgPSB4Zi5SLmNvbDE7XHJcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NvbGlkQ2lyY2xlKGNlbnRlciwgcmFkaXVzLCBheGlzLCBjb2xvcik7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJTaGFwZS5lX3BvbHlnb25TaGFwZTpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgaSA9IDA7XHJcbiAgICAgICAgICAgIHZhciBwb2x5ID0gKChzaGFwZSBpbnN0YW5jZW9mIGIyUG9seWdvblNoYXBlID8gc2hhcGUgOiBudWxsKSk7XHJcbiAgICAgICAgICAgIHZhciB2ZXJ0ZXhDb3VudCA9IHBhcnNlSW50KHBvbHkuR2V0VmVydGV4Q291bnQoKSk7XHJcbiAgICAgICAgICAgIHZhciBsb2NhbFZlcnRpY2VzID0gcG9seS5HZXRWZXJ0aWNlcygpO1xyXG4gICAgICAgICAgICB2YXIgdmVydGljZXMgPSBuZXcgVmVjdG9yKHZlcnRleENvdW50KTtcclxuICAgICAgICAgICAgZm9yIChpID0gMDtcclxuICAgICAgICAgICAgaSA8IHZlcnRleENvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgICAgdmVydGljZXNbaV0gPSBiMk1hdGguTXVsWCh4ZiwgbG9jYWxWZXJ0aWNlc1tpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tX2RlYnVnRHJhdy5EcmF3U29saWRQb2x5Z29uKHZlcnRpY2VzLCB2ZXJ0ZXhDb3VudCwgY29sb3IpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIGIyU2hhcGUuZV9lZGdlU2hhcGU6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGVkZ2UgPSAoc2hhcGUgaW5zdGFuY2VvZiBiMkVkZ2VTaGFwZSA/IHNoYXBlIDogbnVsbCk7XHJcbiAgICAgICAgICAgIHRoaXMubV9kZWJ1Z0RyYXcuRHJhd1NlZ21lbnQoYjJNYXRoLk11bFgoeGYsIGVkZ2UuR2V0VmVydGV4MSgpKSwgYjJNYXRoLk11bFgoeGYsIGVkZ2UuR2V0VmVydGV4MigpKSwgY29sb3IpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyV29ybGQuc190aW1lc3RlcDIgPSBuZXcgYjJUaW1lU3RlcCgpO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMldvcmxkLnNfeGYgPSBuZXcgYjJUcmFuc2Zvcm0oKTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5zX2JhY2t1cEEgPSBuZXcgYjJTd2VlcCgpO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5iMldvcmxkLnNfYmFja3VwQiA9IG5ldyBiMlN3ZWVwKCk7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyV29ybGQuc190aW1lc3RlcCA9IG5ldyBiMlRpbWVTdGVwKCk7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyV29ybGQuc19xdWV1ZSA9IG5ldyBWZWN0b3IoKTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5zX2pvaW50Q29sb3IgPSBuZXcgYjJDb2xvcigwLjUsIDAuOCwgMC44KTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuYjJXb3JsZC5lX25ld0ZpeHR1cmUgPSAweDAwMDE7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLmIyV29ybGQuZV9sb2NrZWQgPSAweDAwMDI7XHJcbiAgIH0pO1xyXG59KSgpO1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYjJDaXJjbGVTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJDaXJjbGVTaGFwZSxcclxuICAgICAgYjJFZGdlQ2hhaW5EZWYgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZUNoYWluRGVmLFxyXG4gICAgICBiMkVkZ2VTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJFZGdlU2hhcGUsXHJcbiAgICAgIGIyTWFzc0RhdGEgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyTWFzc0RhdGEsXHJcbiAgICAgIGIyUG9seWdvblNoYXBlID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMlBvbHlnb25TaGFwZSxcclxuICAgICAgYjJTaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJTaGFwZSxcclxuICAgICAgYjJDaXJjbGVDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDaXJjbGVDb250YWN0LFxyXG4gICAgICBiMkNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QsXHJcbiAgICAgIGIyQ29udGFjdENvbnN0cmFpbnQgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RDb25zdHJhaW50LFxyXG4gICAgICBiMkNvbnRhY3RDb25zdHJhaW50UG9pbnQgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RDb25zdHJhaW50UG9pbnQsXHJcbiAgICAgIGIyQ29udGFjdEVkZ2UgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RFZGdlLFxyXG4gICAgICBiMkNvbnRhY3RGYWN0b3J5ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0RmFjdG9yeSxcclxuICAgICAgYjJDb250YWN0UmVnaXN0ZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RSZWdpc3RlcixcclxuICAgICAgYjJDb250YWN0UmVzdWx0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0UmVzdWx0LFxyXG4gICAgICBiMkNvbnRhY3RTb2x2ZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3RTb2x2ZXIsXHJcbiAgICAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkVkZ2VBbmRDaXJjbGVDb250YWN0LFxyXG4gICAgICBiMk51bGxDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJOdWxsQ29udGFjdCxcclxuICAgICAgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyUG9seUFuZENpcmNsZUNvbnRhY3QsXHJcbiAgICAgIGIyUG9seUFuZEVkZ2VDb250YWN0ID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJQb2x5QW5kRWRnZUNvbnRhY3QsXHJcbiAgICAgIGIyUG9seWdvbkNvbnRhY3QgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvbHlnb25Db250YWN0LFxyXG4gICAgICBiMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQsXHJcbiAgICAgIGIyQm9keSA9IEJveDJELkR5bmFtaWNzLmIyQm9keSxcclxuICAgICAgYjJCb2R5RGVmID0gQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmLFxyXG4gICAgICBiMkNvbnRhY3RGaWx0ZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RGaWx0ZXIsXHJcbiAgICAgIGIyQ29udGFjdEltcHVsc2UgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RJbXB1bHNlLFxyXG4gICAgICBiMkNvbnRhY3RMaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdExpc3RlbmVyLFxyXG4gICAgICBiMkNvbnRhY3RNYW5hZ2VyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0TWFuYWdlcixcclxuICAgICAgYjJEZWJ1Z0RyYXcgPSBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdyxcclxuICAgICAgYjJEZXN0cnVjdGlvbkxpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJEZXN0cnVjdGlvbkxpc3RlbmVyLFxyXG4gICAgICBiMkZpbHRlckRhdGEgPSBCb3gyRC5EeW5hbWljcy5iMkZpbHRlckRhdGEsXHJcbiAgICAgIGIyRml4dHVyZSA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZSxcclxuICAgICAgYjJGaXh0dXJlRGVmID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmLFxyXG4gICAgICBiMklzbGFuZCA9IEJveDJELkR5bmFtaWNzLmIySXNsYW5kLFxyXG4gICAgICBiMlRpbWVTdGVwID0gQm94MkQuRHluYW1pY3MuYjJUaW1lU3RlcCxcclxuICAgICAgYjJXb3JsZCA9IEJveDJELkR5bmFtaWNzLmIyV29ybGQsXHJcbiAgICAgIGIyQ29sb3IgPSBCb3gyRC5Db21tb24uYjJDb2xvcixcclxuICAgICAgYjJpbnRlcm5hbCA9IEJveDJELkNvbW1vbi5iMmludGVybmFsLFxyXG4gICAgICBiMlNldHRpbmdzID0gQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MsXHJcbiAgICAgIGIyTWF0MjIgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDIyLFxyXG4gICAgICBiMk1hdDMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQzMyxcclxuICAgICAgYjJNYXRoID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLFxyXG4gICAgICBiMlN3ZWVwID0gQm94MkQuQ29tbW9uLk1hdGguYjJTd2VlcCxcclxuICAgICAgYjJUcmFuc2Zvcm0gPSBCb3gyRC5Db21tb24uTWF0aC5iMlRyYW5zZm9ybSxcclxuICAgICAgYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyLFxyXG4gICAgICBiMlZlYzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzMsXHJcbiAgICAgIGIyQUFCQiA9IEJveDJELkNvbGxpc2lvbi5iMkFBQkIsXHJcbiAgICAgIGIyQm91bmQgPSBCb3gyRC5Db2xsaXNpb24uYjJCb3VuZCxcclxuICAgICAgYjJCb3VuZFZhbHVlcyA9IEJveDJELkNvbGxpc2lvbi5iMkJvdW5kVmFsdWVzLFxyXG4gICAgICBiMkNvbGxpc2lvbiA9IEJveDJELkNvbGxpc2lvbi5iMkNvbGxpc2lvbixcclxuICAgICAgYjJDb250YWN0SUQgPSBCb3gyRC5Db2xsaXNpb24uYjJDb250YWN0SUQsXHJcbiAgICAgIGIyQ29udGFjdFBvaW50ID0gQm94MkQuQ29sbGlzaW9uLmIyQ29udGFjdFBvaW50LFxyXG4gICAgICBiMkRpc3RhbmNlID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2UsXHJcbiAgICAgIGIyRGlzdGFuY2VJbnB1dCA9IEJveDJELkNvbGxpc2lvbi5iMkRpc3RhbmNlSW5wdXQsXHJcbiAgICAgIGIyRGlzdGFuY2VPdXRwdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJEaXN0YW5jZU91dHB1dCxcclxuICAgICAgYjJEaXN0YW5jZVByb3h5ID0gQm94MkQuQ29sbGlzaW9uLmIyRGlzdGFuY2VQcm94eSxcclxuICAgICAgYjJEeW5hbWljVHJlZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlLFxyXG4gICAgICBiMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSA9IEJveDJELkNvbGxpc2lvbi5iMkR5bmFtaWNUcmVlQnJvYWRQaGFzZSxcclxuICAgICAgYjJEeW5hbWljVHJlZU5vZGUgPSBCb3gyRC5Db2xsaXNpb24uYjJEeW5hbWljVHJlZU5vZGUsXHJcbiAgICAgIGIyRHluYW1pY1RyZWVQYWlyID0gQm94MkQuQ29sbGlzaW9uLmIyRHluYW1pY1RyZWVQYWlyLFxyXG4gICAgICBiMk1hbmlmb2xkID0gQm94MkQuQ29sbGlzaW9uLmIyTWFuaWZvbGQsXHJcbiAgICAgIGIyTWFuaWZvbGRQb2ludCA9IEJveDJELkNvbGxpc2lvbi5iMk1hbmlmb2xkUG9pbnQsXHJcbiAgICAgIGIyUG9pbnQgPSBCb3gyRC5Db2xsaXNpb24uYjJQb2ludCxcclxuICAgICAgYjJSYXlDYXN0SW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJSYXlDYXN0SW5wdXQsXHJcbiAgICAgIGIyUmF5Q2FzdE91dHB1dCA9IEJveDJELkNvbGxpc2lvbi5iMlJheUNhc3RPdXRwdXQsXHJcbiAgICAgIGIyU2VnbWVudCA9IEJveDJELkNvbGxpc2lvbi5iMlNlZ21lbnQsXHJcbiAgICAgIGIyU2VwYXJhdGlvbkZ1bmN0aW9uID0gQm94MkQuQ29sbGlzaW9uLmIyU2VwYXJhdGlvbkZ1bmN0aW9uLFxyXG4gICAgICBiMlNpbXBsZXggPSBCb3gyRC5Db2xsaXNpb24uYjJTaW1wbGV4LFxyXG4gICAgICBiMlNpbXBsZXhDYWNoZSA9IEJveDJELkNvbGxpc2lvbi5iMlNpbXBsZXhDYWNoZSxcclxuICAgICAgYjJTaW1wbGV4VmVydGV4ID0gQm94MkQuQ29sbGlzaW9uLmIyU2ltcGxleFZlcnRleCxcclxuICAgICAgYjJUaW1lT2ZJbXBhY3QgPSBCb3gyRC5Db2xsaXNpb24uYjJUaW1lT2ZJbXBhY3QsXHJcbiAgICAgIGIyVE9JSW5wdXQgPSBCb3gyRC5Db2xsaXNpb24uYjJUT0lJbnB1dCxcclxuICAgICAgYjJXb3JsZE1hbmlmb2xkID0gQm94MkQuQ29sbGlzaW9uLmIyV29ybGRNYW5pZm9sZCxcclxuICAgICAgQ2xpcFZlcnRleCA9IEJveDJELkNvbGxpc2lvbi5DbGlwVmVydGV4LFxyXG4gICAgICBGZWF0dXJlcyA9IEJveDJELkNvbGxpc2lvbi5GZWF0dXJlcyxcclxuICAgICAgSUJyb2FkUGhhc2UgPSBCb3gyRC5Db2xsaXNpb24uSUJyb2FkUGhhc2U7XHJcblxyXG4gICBCb3gyRC5pbmhlcml0KGIyQ2lyY2xlQ29udGFjdCwgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0KTtcclxuICAgYjJDaXJjbGVDb250YWN0LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LnByb3RvdHlwZTtcclxuICAgYjJDaXJjbGVDb250YWN0LmIyQ2lyY2xlQ29udGFjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmIyQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBiMkNpcmNsZUNvbnRhY3QuQ3JlYXRlID0gZnVuY3Rpb24gKGFsbG9jYXRvcikge1xyXG4gICAgICByZXR1cm4gbmV3IGIyQ2lyY2xlQ29udGFjdCgpO1xyXG4gICB9XHJcbiAgIGIyQ2lyY2xlQ29udGFjdC5EZXN0cm95ID0gZnVuY3Rpb24gKGNvbnRhY3QsIGFsbG9jYXRvcikge31cclxuICAgYjJDaXJjbGVDb250YWN0LnByb3RvdHlwZS5SZXNldCA9IGZ1bmN0aW9uIChmaXh0dXJlQSwgZml4dHVyZUIpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLlJlc2V0LmNhbGwodGhpcywgZml4dHVyZUEsIGZpeHR1cmVCKTtcclxuICAgfVxyXG4gICBiMkNpcmNsZUNvbnRhY3QucHJvdG90eXBlLkV2YWx1YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fZml4dHVyZUEuR2V0Qm9keSgpO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fZml4dHVyZUIuR2V0Qm9keSgpO1xyXG4gICAgICBiMkNvbGxpc2lvbi5Db2xsaWRlQ2lyY2xlcyh0aGlzLm1fbWFuaWZvbGQsICh0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyQ2lyY2xlU2hhcGUgPyB0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSA6IG51bGwpLCBiQS5tX3hmLCAodGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkgaW5zdGFuY2VvZiBiMkNpcmNsZVNoYXBlID8gdGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkgOiBudWxsKSwgYkIubV94Zik7XHJcbiAgIH1cclxuICAgYjJDb250YWN0LmIyQ29udGFjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX25vZGVBID0gbmV3IGIyQ29udGFjdEVkZ2UoKTtcclxuICAgICAgdGhpcy5tX25vZGVCID0gbmV3IGIyQ29udGFjdEVkZ2UoKTtcclxuICAgICAgdGhpcy5tX21hbmlmb2xkID0gbmV3IGIyTWFuaWZvbGQoKTtcclxuICAgICAgdGhpcy5tX29sZE1hbmlmb2xkID0gbmV3IGIyTWFuaWZvbGQoKTtcclxuICAgfTtcclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5HZXRNYW5pZm9sZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9tYW5pZm9sZDtcclxuICAgfVxyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLkdldFdvcmxkTWFuaWZvbGQgPSBmdW5jdGlvbiAod29ybGRNYW5pZm9sZCkge1xyXG4gICAgICB2YXIgYm9keUEgPSB0aGlzLm1fZml4dHVyZUEuR2V0Qm9keSgpO1xyXG4gICAgICB2YXIgYm9keUIgPSB0aGlzLm1fZml4dHVyZUIuR2V0Qm9keSgpO1xyXG4gICAgICB2YXIgc2hhcGVBID0gdGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCk7XHJcbiAgICAgIHZhciBzaGFwZUIgPSB0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKTtcclxuICAgICAgd29ybGRNYW5pZm9sZC5Jbml0aWFsaXplKHRoaXMubV9tYW5pZm9sZCwgYm9keUEuR2V0VHJhbnNmb3JtKCksIHNoYXBlQS5tX3JhZGl1cywgYm9keUIuR2V0VHJhbnNmb3JtKCksIHNoYXBlQi5tX3JhZGl1cyk7XHJcbiAgIH1cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5Jc1RvdWNoaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX3RvdWNoaW5nRmxhZykgPT0gYjJDb250YWN0LmVfdG91Y2hpbmdGbGFnO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuSXNDb250aW51b3VzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX2NvbnRpbnVvdXNGbGFnKSA9PSBiMkNvbnRhY3QuZV9jb250aW51b3VzRmxhZztcclxuICAgfVxyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLlNldFNlbnNvciA9IGZ1bmN0aW9uIChzZW5zb3IpIHtcclxuICAgICAgaWYgKHNlbnNvcikge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfc2Vuc29yRmxhZztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV9zZW5zb3JGbGFnO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5Jc1NlbnNvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLm1fZmxhZ3MgJiBiMkNvbnRhY3QuZV9zZW5zb3JGbGFnKSA9PSBiMkNvbnRhY3QuZV9zZW5zb3JGbGFnO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuU2V0RW5hYmxlZCA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgIGlmIChmbGFnKSB7XHJcbiAgICAgICAgIHRoaXMubV9mbGFncyB8PSBiMkNvbnRhY3QuZV9lbmFibGVkRmxhZztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzICY9IH5iMkNvbnRhY3QuZV9lbmFibGVkRmxhZztcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuSXNFbmFibGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX2VuYWJsZWRGbGFnKSA9PSBiMkNvbnRhY3QuZV9lbmFibGVkRmxhZztcclxuICAgfVxyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLkdldE5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcclxuICAgfVxyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLkdldEZpeHR1cmVBID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2ZpeHR1cmVBO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuR2V0Rml4dHVyZUIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZml4dHVyZUI7XHJcbiAgIH1cclxuICAgYjJDb250YWN0LnByb3RvdHlwZS5GbGFnRm9yRmlsdGVyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfZmlsdGVyRmxhZztcclxuICAgfVxyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLmIyQ29udGFjdCA9IGZ1bmN0aW9uICgpIHt9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuUmVzZXQgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XHJcbiAgICAgIGlmIChmaXh0dXJlQSA9PT0gdW5kZWZpbmVkKSBmaXh0dXJlQSA9IG51bGw7XHJcbiAgICAgIGlmIChmaXh0dXJlQiA9PT0gdW5kZWZpbmVkKSBmaXh0dXJlQiA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9mbGFncyA9IGIyQ29udGFjdC5lX2VuYWJsZWRGbGFnO1xyXG4gICAgICBpZiAoIWZpeHR1cmVBIHx8ICFmaXh0dXJlQikge1xyXG4gICAgICAgICB0aGlzLm1fZml4dHVyZUEgPSBudWxsO1xyXG4gICAgICAgICB0aGlzLm1fZml4dHVyZUIgPSBudWxsO1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGZpeHR1cmVBLklzU2Vuc29yKCkgfHwgZml4dHVyZUIuSXNTZW5zb3IoKSkge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfc2Vuc29yRmxhZztcclxuICAgICAgfVxyXG4gICAgICB2YXIgYm9keUEgPSBmaXh0dXJlQS5HZXRCb2R5KCk7XHJcbiAgICAgIHZhciBib2R5QiA9IGZpeHR1cmVCLkdldEJvZHkoKTtcclxuICAgICAgaWYgKGJvZHlBLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkgfHwgYm9keUEuSXNCdWxsZXQoKSB8fCBib2R5Qi5HZXRUeXBlKCkgIT0gYjJCb2R5LmIyX2R5bmFtaWNCb2R5IHx8IGJvZHlCLklzQnVsbGV0KCkpIHtcclxuICAgICAgICAgdGhpcy5tX2ZsYWdzIHw9IGIyQ29udGFjdC5lX2NvbnRpbnVvdXNGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9maXh0dXJlQSA9IGZpeHR1cmVBO1xyXG4gICAgICB0aGlzLm1fZml4dHVyZUIgPSBmaXh0dXJlQjtcclxuICAgICAgdGhpcy5tX21hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDA7XHJcbiAgICAgIHRoaXMubV9wcmV2ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX25leHQgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbm9kZUEuY29udGFjdCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ub2RlQS5wcmV2ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX25vZGVBLm5leHQgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbm9kZUEub3RoZXIgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbm9kZUIuY29udGFjdCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ub2RlQi5wcmV2ID0gbnVsbDtcclxuICAgICAgdGhpcy5tX25vZGVCLm5leHQgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbm9kZUIub3RoZXIgPSBudWxsO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuVXBkYXRlID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XHJcbiAgICAgIHZhciB0TWFuaWZvbGQgPSB0aGlzLm1fb2xkTWFuaWZvbGQ7XHJcbiAgICAgIHRoaXMubV9vbGRNYW5pZm9sZCA9IHRoaXMubV9tYW5pZm9sZDtcclxuICAgICAgdGhpcy5tX21hbmlmb2xkID0gdE1hbmlmb2xkO1xyXG4gICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfZW5hYmxlZEZsYWc7XHJcbiAgICAgIHZhciB0b3VjaGluZyA9IGZhbHNlO1xyXG4gICAgICB2YXIgd2FzVG91Y2hpbmcgPSAodGhpcy5tX2ZsYWdzICYgYjJDb250YWN0LmVfdG91Y2hpbmdGbGFnKSA9PSBiMkNvbnRhY3QuZV90b3VjaGluZ0ZsYWc7XHJcbiAgICAgIHZhciBib2R5QSA9IHRoaXMubV9maXh0dXJlQS5tX2JvZHk7XHJcbiAgICAgIHZhciBib2R5QiA9IHRoaXMubV9maXh0dXJlQi5tX2JvZHk7XHJcbiAgICAgIHZhciBhYWJiT3ZlcmxhcCA9IHRoaXMubV9maXh0dXJlQS5tX2FhYmIuVGVzdE92ZXJsYXAodGhpcy5tX2ZpeHR1cmVCLm1fYWFiYik7XHJcbiAgICAgIGlmICh0aGlzLm1fZmxhZ3MgJiBiMkNvbnRhY3QuZV9zZW5zb3JGbGFnKSB7XHJcbiAgICAgICAgIGlmIChhYWJiT3ZlcmxhcCkge1xyXG4gICAgICAgICAgICB2YXIgc2hhcGVBID0gdGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCk7XHJcbiAgICAgICAgICAgIHZhciBzaGFwZUIgPSB0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKTtcclxuICAgICAgICAgICAgdmFyIHhmQSA9IGJvZHlBLkdldFRyYW5zZm9ybSgpO1xyXG4gICAgICAgICAgICB2YXIgeGZCID0gYm9keUIuR2V0VHJhbnNmb3JtKCk7XHJcbiAgICAgICAgICAgIHRvdWNoaW5nID0gYjJTaGFwZS5UZXN0T3ZlcmxhcChzaGFwZUEsIHhmQSwgc2hhcGVCLCB4ZkIpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHRoaXMubV9tYW5pZm9sZC5tX3BvaW50Q291bnQgPSAwO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBpZiAoYm9keUEuR2V0VHlwZSgpICE9IGIyQm9keS5iMl9keW5hbWljQm9keSB8fCBib2R5QS5Jc0J1bGxldCgpIHx8IGJvZHlCLkdldFR5cGUoKSAhPSBiMkJvZHkuYjJfZHluYW1pY0JvZHkgfHwgYm9keUIuSXNCdWxsZXQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfY29udGludW91c0ZsYWc7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9mbGFncyAmPSB+YjJDb250YWN0LmVfY29udGludW91c0ZsYWc7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKGFhYmJPdmVybGFwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuRXZhbHVhdGUoKTtcclxuICAgICAgICAgICAgdG91Y2hpbmcgPSB0aGlzLm1fbWFuaWZvbGQubV9wb2ludENvdW50ID4gMDtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fbWFuaWZvbGQubV9wb2ludENvdW50OyArK2kpIHtcclxuICAgICAgICAgICAgICAgdmFyIG1wMiA9IHRoaXMubV9tYW5pZm9sZC5tX3BvaW50c1tpXTtcclxuICAgICAgICAgICAgICAgbXAyLm1fbm9ybWFsSW1wdWxzZSA9IDAuMDtcclxuICAgICAgICAgICAgICAgbXAyLm1fdGFuZ2VudEltcHVsc2UgPSAwLjA7XHJcbiAgICAgICAgICAgICAgIHZhciBpZDIgPSBtcDIubV9pZDtcclxuICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLm1fb2xkTWFuaWZvbGQubV9wb2ludENvdW50OyArK2opIHtcclxuICAgICAgICAgICAgICAgICAgdmFyIG1wMSA9IHRoaXMubV9vbGRNYW5pZm9sZC5tX3BvaW50c1tqXTtcclxuICAgICAgICAgICAgICAgICAgaWYgKG1wMS5tX2lkLmtleSA9PSBpZDIua2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgIG1wMi5tX25vcm1hbEltcHVsc2UgPSBtcDEubV9ub3JtYWxJbXB1bHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICBtcDIubV90YW5nZW50SW1wdWxzZSA9IG1wMS5tX3RhbmdlbnRJbXB1bHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tX21hbmlmb2xkLm1fcG9pbnRDb3VudCA9IDA7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaWYgKHRvdWNoaW5nICE9IHdhc1RvdWNoaW5nKSB7XHJcbiAgICAgICAgICAgIGJvZHlBLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICAgICAgICBib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmICh0b3VjaGluZykge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgfD0gYjJDb250YWN0LmVfdG91Y2hpbmdGbGFnO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fZmxhZ3MgJj0gfmIyQ29udGFjdC5lX3RvdWNoaW5nRmxhZztcclxuICAgICAgfVxyXG4gICAgICBpZiAod2FzVG91Y2hpbmcgPT0gZmFsc2UgJiYgdG91Y2hpbmcgPT0gdHJ1ZSkge1xyXG4gICAgICAgICBsaXN0ZW5lci5CZWdpbkNvbnRhY3QodGhpcyk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHdhc1RvdWNoaW5nID09IHRydWUgJiYgdG91Y2hpbmcgPT0gZmFsc2UpIHtcclxuICAgICAgICAgbGlzdGVuZXIuRW5kQ29udGFjdCh0aGlzKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoKHRoaXMubV9mbGFncyAmIGIyQ29udGFjdC5lX3NlbnNvckZsYWcpID09IDApIHtcclxuICAgICAgICAgbGlzdGVuZXIuUHJlU29sdmUodGhpcywgdGhpcy5tX29sZE1hbmlmb2xkKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQ29udGFjdC5wcm90b3R5cGUuRXZhbHVhdGUgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBiMkNvbnRhY3QucHJvdG90eXBlLkNvbXB1dGVUT0kgPSBmdW5jdGlvbiAoc3dlZXBBLCBzd2VlcEIpIHtcclxuICAgICAgYjJDb250YWN0LnNfaW5wdXQucHJveHlBLlNldCh0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSk7XHJcbiAgICAgIGIyQ29udGFjdC5zX2lucHV0LnByb3h5Qi5TZXQodGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkpO1xyXG4gICAgICBiMkNvbnRhY3Quc19pbnB1dC5zd2VlcEEgPSBzd2VlcEE7XHJcbiAgICAgIGIyQ29udGFjdC5zX2lucHV0LnN3ZWVwQiA9IHN3ZWVwQjtcclxuICAgICAgYjJDb250YWN0LnNfaW5wdXQudG9sZXJhbmNlID0gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xyXG4gICAgICByZXR1cm4gYjJUaW1lT2ZJbXBhY3QuVGltZU9mSW1wYWN0KGIyQ29udGFjdC5zX2lucHV0KTtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfc2Vuc29yRmxhZyA9IDB4MDAwMTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfY29udGludW91c0ZsYWcgPSAweDAwMDI7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5lX2lzbGFuZEZsYWcgPSAweDAwMDQ7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5lX3RvaUZsYWcgPSAweDAwMDg7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5lX3RvdWNoaW5nRmxhZyA9IDB4MDAxMDtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmVfZW5hYmxlZEZsYWcgPSAweDAwMjA7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5lX2ZpbHRlckZsYWcgPSAweDAwNDA7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5zX2lucHV0ID0gbmV3IGIyVE9JSW5wdXQoKTtcclxuICAgfSk7XHJcbiAgIGIyQ29udGFjdENvbnN0cmFpbnQuYjJDb250YWN0Q29uc3RyYWludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5sb2NhbFBsYW5lTm9ybWFsID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxvY2FsUG9pbnQgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubm9ybWFsID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm5vcm1hbE1hc3MgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICB0aGlzLksgPSBuZXcgYjJNYXQyMigpO1xyXG4gICB9O1xyXG4gICBiMkNvbnRhY3RDb25zdHJhaW50LnByb3RvdHlwZS5iMkNvbnRhY3RDb25zdHJhaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLnBvaW50cyA9IG5ldyBWZWN0b3IoYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50czsgaSsrKSB7XHJcbiAgICAgICAgIHRoaXMucG9pbnRzW2ldID0gbmV3IGIyQ29udGFjdENvbnN0cmFpbnRQb2ludCgpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJDb250YWN0Q29uc3RyYWludFBvaW50LmIyQ29udGFjdENvbnN0cmFpbnRQb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5sb2NhbFBvaW50ID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLnJBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLnJCID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkNvbnRhY3RFZGdlLmIyQ29udGFjdEVkZ2UgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJDb250YWN0RmFjdG9yeS5iMkNvbnRhY3RGYWN0b3J5ID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyQ29udGFjdEZhY3RvcnkucHJvdG90eXBlLmIyQ29udGFjdEZhY3RvcnkgPSBmdW5jdGlvbiAoYWxsb2NhdG9yKSB7XHJcbiAgICAgIHRoaXMubV9hbGxvY2F0b3IgPSBhbGxvY2F0b3I7XHJcbiAgICAgIHRoaXMuSW5pdGlhbGl6ZVJlZ2lzdGVycygpO1xyXG4gICB9XHJcbiAgIGIyQ29udGFjdEZhY3RvcnkucHJvdG90eXBlLkFkZFR5cGUgPSBmdW5jdGlvbiAoY3JlYXRlRmNuLCBkZXN0cm95RmNuLCB0eXBlMSwgdHlwZTIpIHtcclxuICAgICAgaWYgKHR5cGUxID09PSB1bmRlZmluZWQpIHR5cGUxID0gMDtcclxuICAgICAgaWYgKHR5cGUyID09PSB1bmRlZmluZWQpIHR5cGUyID0gMDtcclxuICAgICAgdGhpcy5tX3JlZ2lzdGVyc1t0eXBlMV1bdHlwZTJdLmNyZWF0ZUZjbiA9IGNyZWF0ZUZjbjtcclxuICAgICAgdGhpcy5tX3JlZ2lzdGVyc1t0eXBlMV1bdHlwZTJdLmRlc3Ryb3lGY24gPSBkZXN0cm95RmNuO1xyXG4gICAgICB0aGlzLm1fcmVnaXN0ZXJzW3R5cGUxXVt0eXBlMl0ucHJpbWFyeSA9IHRydWU7XHJcbiAgICAgIGlmICh0eXBlMSAhPSB0eXBlMikge1xyXG4gICAgICAgICB0aGlzLm1fcmVnaXN0ZXJzW3R5cGUyXVt0eXBlMV0uY3JlYXRlRmNuID0gY3JlYXRlRmNuO1xyXG4gICAgICAgICB0aGlzLm1fcmVnaXN0ZXJzW3R5cGUyXVt0eXBlMV0uZGVzdHJveUZjbiA9IGRlc3Ryb3lGY247XHJcbiAgICAgICAgIHRoaXMubV9yZWdpc3RlcnNbdHlwZTJdW3R5cGUxXS5wcmltYXJ5ID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkNvbnRhY3RGYWN0b3J5LnByb3RvdHlwZS5Jbml0aWFsaXplUmVnaXN0ZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fcmVnaXN0ZXJzID0gbmV3IFZlY3RvcihiMlNoYXBlLmVfc2hhcGVUeXBlQ291bnQpO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGIyU2hhcGUuZV9zaGFwZVR5cGVDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgIHRoaXMubV9yZWdpc3RlcnNbaV0gPSBuZXcgVmVjdG9yKGIyU2hhcGUuZV9zaGFwZVR5cGVDb3VudCk7XHJcbiAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgYjJTaGFwZS5lX3NoYXBlVHlwZUNvdW50OyBqKyspIHtcclxuICAgICAgICAgICAgdGhpcy5tX3JlZ2lzdGVyc1tpXVtqXSA9IG5ldyBiMkNvbnRhY3RSZWdpc3RlcigpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5BZGRUeXBlKGIyQ2lyY2xlQ29udGFjdC5DcmVhdGUsIGIyQ2lyY2xlQ29udGFjdC5EZXN0cm95LCBiMlNoYXBlLmVfY2lyY2xlU2hhcGUsIGIyU2hhcGUuZV9jaXJjbGVTaGFwZSk7XHJcbiAgICAgIHRoaXMuQWRkVHlwZShiMlBvbHlBbmRDaXJjbGVDb250YWN0LkNyZWF0ZSwgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdC5EZXN0cm95LCBiMlNoYXBlLmVfcG9seWdvblNoYXBlLCBiMlNoYXBlLmVfY2lyY2xlU2hhcGUpO1xyXG4gICAgICB0aGlzLkFkZFR5cGUoYjJQb2x5Z29uQ29udGFjdC5DcmVhdGUsIGIyUG9seWdvbkNvbnRhY3QuRGVzdHJveSwgYjJTaGFwZS5lX3BvbHlnb25TaGFwZSwgYjJTaGFwZS5lX3BvbHlnb25TaGFwZSk7XHJcbiAgICAgIHRoaXMuQWRkVHlwZShiMkVkZ2VBbmRDaXJjbGVDb250YWN0LkNyZWF0ZSwgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5EZXN0cm95LCBiMlNoYXBlLmVfZWRnZVNoYXBlLCBiMlNoYXBlLmVfY2lyY2xlU2hhcGUpO1xyXG4gICAgICB0aGlzLkFkZFR5cGUoYjJQb2x5QW5kRWRnZUNvbnRhY3QuQ3JlYXRlLCBiMlBvbHlBbmRFZGdlQ29udGFjdC5EZXN0cm95LCBiMlNoYXBlLmVfcG9seWdvblNoYXBlLCBiMlNoYXBlLmVfZWRnZVNoYXBlKTtcclxuICAgfVxyXG4gICBiMkNvbnRhY3RGYWN0b3J5LnByb3RvdHlwZS5DcmVhdGUgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XHJcbiAgICAgIHZhciB0eXBlMSA9IHBhcnNlSW50KGZpeHR1cmVBLkdldFR5cGUoKSk7XHJcbiAgICAgIHZhciB0eXBlMiA9IHBhcnNlSW50KGZpeHR1cmVCLkdldFR5cGUoKSk7XHJcbiAgICAgIHZhciByZWcgPSB0aGlzLm1fcmVnaXN0ZXJzW3R5cGUxXVt0eXBlMl07XHJcbiAgICAgIHZhciBjO1xyXG4gICAgICBpZiAocmVnLnBvb2wpIHtcclxuICAgICAgICAgYyA9IHJlZy5wb29sO1xyXG4gICAgICAgICByZWcucG9vbCA9IGMubV9uZXh0O1xyXG4gICAgICAgICByZWcucG9vbENvdW50LS07XHJcbiAgICAgICAgIGMuUmVzZXQoZml4dHVyZUEsIGZpeHR1cmVCKTtcclxuICAgICAgICAgcmV0dXJuIGM7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGNyZWF0ZUZjbiA9IHJlZy5jcmVhdGVGY247XHJcbiAgICAgIGlmIChjcmVhdGVGY24gIT0gbnVsbCkge1xyXG4gICAgICAgICBpZiAocmVnLnByaW1hcnkpIHtcclxuICAgICAgICAgICAgYyA9IGNyZWF0ZUZjbih0aGlzLm1fYWxsb2NhdG9yKTtcclxuICAgICAgICAgICAgYy5SZXNldChmaXh0dXJlQSwgZml4dHVyZUIpO1xyXG4gICAgICAgICAgICByZXR1cm4gYztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgYyA9IGNyZWF0ZUZjbih0aGlzLm1fYWxsb2NhdG9yKTtcclxuICAgICAgICAgICAgYy5SZXNldChmaXh0dXJlQiwgZml4dHVyZUEpO1xyXG4gICAgICAgICAgICByZXR1cm4gYztcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyQ29udGFjdEZhY3RvcnkucHJvdG90eXBlLkRlc3Ryb3kgPSBmdW5jdGlvbiAoY29udGFjdCkge1xyXG4gICAgICBpZiAoY29udGFjdC5tX21hbmlmb2xkLm1fcG9pbnRDb3VudCA+IDApIHtcclxuICAgICAgICAgY29udGFjdC5tX2ZpeHR1cmVBLm1fYm9keS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgICAgY29udGFjdC5tX2ZpeHR1cmVCLm1fYm9keS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgdHlwZTEgPSBwYXJzZUludChjb250YWN0Lm1fZml4dHVyZUEuR2V0VHlwZSgpKTtcclxuICAgICAgdmFyIHR5cGUyID0gcGFyc2VJbnQoY29udGFjdC5tX2ZpeHR1cmVCLkdldFR5cGUoKSk7XHJcbiAgICAgIHZhciByZWcgPSB0aGlzLm1fcmVnaXN0ZXJzW3R5cGUxXVt0eXBlMl07XHJcbiAgICAgIGlmICh0cnVlKSB7XHJcbiAgICAgICAgIHJlZy5wb29sQ291bnQrKztcclxuICAgICAgICAgY29udGFjdC5tX25leHQgPSByZWcucG9vbDtcclxuICAgICAgICAgcmVnLnBvb2wgPSBjb250YWN0O1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBkZXN0cm95RmNuID0gcmVnLmRlc3Ryb3lGY247XHJcbiAgICAgIGRlc3Ryb3lGY24oY29udGFjdCwgdGhpcy5tX2FsbG9jYXRvcik7XHJcbiAgIH1cclxuICAgYjJDb250YWN0UmVnaXN0ZXIuYjJDb250YWN0UmVnaXN0ZXIgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJDb250YWN0UmVzdWx0LmIyQ29udGFjdFJlc3VsdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5ub3JtYWwgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMuaWQgPSBuZXcgYjJDb250YWN0SUQoKTtcclxuICAgfTtcclxuICAgYjJDb250YWN0U29sdmVyLmIyQ29udGFjdFNvbHZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX3N0ZXAgPSBuZXcgYjJUaW1lU3RlcCgpO1xyXG4gICAgICB0aGlzLm1fY29uc3RyYWludHMgPSBuZXcgVmVjdG9yKCk7XHJcbiAgIH07XHJcbiAgIGIyQ29udGFjdFNvbHZlci5wcm90b3R5cGUuYjJDb250YWN0U29sdmVyID0gZnVuY3Rpb24gKCkge31cclxuICAgYjJDb250YWN0U29sdmVyLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKHN0ZXAsIGNvbnRhY3RzLCBjb250YWN0Q291bnQsIGFsbG9jYXRvcikge1xyXG4gICAgICBpZiAoY29udGFjdENvdW50ID09PSB1bmRlZmluZWQpIGNvbnRhY3RDb3VudCA9IDA7XHJcbiAgICAgIHZhciBjb250YWN0O1xyXG4gICAgICB0aGlzLm1fc3RlcC5TZXQoc3RlcCk7XHJcbiAgICAgIHRoaXMubV9hbGxvY2F0b3IgPSBhbGxvY2F0b3I7XHJcbiAgICAgIHZhciBpID0gMDtcclxuICAgICAgdmFyIHRWZWM7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB0aGlzLm1fY29uc3RyYWludENvdW50ID0gY29udGFjdENvdW50O1xyXG4gICAgICB3aGlsZSAodGhpcy5tX2NvbnN0cmFpbnRzLmxlbmd0aCA8IHRoaXMubV9jb25zdHJhaW50Q291bnQpIHtcclxuICAgICAgICAgdGhpcy5tX2NvbnN0cmFpbnRzW3RoaXMubV9jb25zdHJhaW50cy5sZW5ndGhdID0gbmV3IGIyQ29udGFjdENvbnN0cmFpbnQoKTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICBpIDwgY29udGFjdENvdW50OyArK2kpIHtcclxuICAgICAgICAgY29udGFjdCA9IGNvbnRhY3RzW2ldO1xyXG4gICAgICAgICB2YXIgZml4dHVyZUEgPSBjb250YWN0Lm1fZml4dHVyZUE7XHJcbiAgICAgICAgIHZhciBmaXh0dXJlQiA9IGNvbnRhY3QubV9maXh0dXJlQjtcclxuICAgICAgICAgdmFyIHNoYXBlQSA9IGZpeHR1cmVBLm1fc2hhcGU7XHJcbiAgICAgICAgIHZhciBzaGFwZUIgPSBmaXh0dXJlQi5tX3NoYXBlO1xyXG4gICAgICAgICB2YXIgcmFkaXVzQSA9IHNoYXBlQS5tX3JhZGl1cztcclxuICAgICAgICAgdmFyIHJhZGl1c0IgPSBzaGFwZUIubV9yYWRpdXM7XHJcbiAgICAgICAgIHZhciBib2R5QSA9IGZpeHR1cmVBLm1fYm9keTtcclxuICAgICAgICAgdmFyIGJvZHlCID0gZml4dHVyZUIubV9ib2R5O1xyXG4gICAgICAgICB2YXIgbWFuaWZvbGQgPSBjb250YWN0LkdldE1hbmlmb2xkKCk7XHJcbiAgICAgICAgIHZhciBmcmljdGlvbiA9IGIyU2V0dGluZ3MuYjJNaXhGcmljdGlvbihmaXh0dXJlQS5HZXRGcmljdGlvbigpLCBmaXh0dXJlQi5HZXRGcmljdGlvbigpKTtcclxuICAgICAgICAgdmFyIHJlc3RpdHV0aW9uID0gYjJTZXR0aW5ncy5iMk1peFJlc3RpdHV0aW9uKGZpeHR1cmVBLkdldFJlc3RpdHV0aW9uKCksIGZpeHR1cmVCLkdldFJlc3RpdHV0aW9uKCkpO1xyXG4gICAgICAgICB2YXIgdkFYID0gYm9keUEubV9saW5lYXJWZWxvY2l0eS54O1xyXG4gICAgICAgICB2YXIgdkFZID0gYm9keUEubV9saW5lYXJWZWxvY2l0eS55O1xyXG4gICAgICAgICB2YXIgdkJYID0gYm9keUIubV9saW5lYXJWZWxvY2l0eS54O1xyXG4gICAgICAgICB2YXIgdkJZID0gYm9keUIubV9saW5lYXJWZWxvY2l0eS55O1xyXG4gICAgICAgICB2YXIgd0EgPSBib2R5QS5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgICAgdmFyIHdCID0gYm9keUIubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQobWFuaWZvbGQubV9wb2ludENvdW50ID4gMCk7XHJcbiAgICAgICAgIGIyQ29udGFjdFNvbHZlci5zX3dvcmxkTWFuaWZvbGQuSW5pdGlhbGl6ZShtYW5pZm9sZCwgYm9keUEubV94ZiwgcmFkaXVzQSwgYm9keUIubV94ZiwgcmFkaXVzQik7XHJcbiAgICAgICAgIHZhciBub3JtYWxYID0gYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZC5tX25vcm1hbC54O1xyXG4gICAgICAgICB2YXIgbm9ybWFsWSA9IGIyQ29udGFjdFNvbHZlci5zX3dvcmxkTWFuaWZvbGQubV9ub3JtYWwueTtcclxuICAgICAgICAgdmFyIGNjID0gdGhpcy5tX2NvbnN0cmFpbnRzW2ldO1xyXG4gICAgICAgICBjYy5ib2R5QSA9IGJvZHlBO1xyXG4gICAgICAgICBjYy5ib2R5QiA9IGJvZHlCO1xyXG4gICAgICAgICBjYy5tYW5pZm9sZCA9IG1hbmlmb2xkO1xyXG4gICAgICAgICBjYy5ub3JtYWwueCA9IG5vcm1hbFg7XHJcbiAgICAgICAgIGNjLm5vcm1hbC55ID0gbm9ybWFsWTtcclxuICAgICAgICAgY2MucG9pbnRDb3VudCA9IG1hbmlmb2xkLm1fcG9pbnRDb3VudDtcclxuICAgICAgICAgY2MuZnJpY3Rpb24gPSBmcmljdGlvbjtcclxuICAgICAgICAgY2MucmVzdGl0dXRpb24gPSByZXN0aXR1dGlvbjtcclxuICAgICAgICAgY2MubG9jYWxQbGFuZU5vcm1hbC54ID0gbWFuaWZvbGQubV9sb2NhbFBsYW5lTm9ybWFsLng7XHJcbiAgICAgICAgIGNjLmxvY2FsUGxhbmVOb3JtYWwueSA9IG1hbmlmb2xkLm1fbG9jYWxQbGFuZU5vcm1hbC55O1xyXG4gICAgICAgICBjYy5sb2NhbFBvaW50LnggPSBtYW5pZm9sZC5tX2xvY2FsUG9pbnQueDtcclxuICAgICAgICAgY2MubG9jYWxQb2ludC55ID0gbWFuaWZvbGQubV9sb2NhbFBvaW50Lnk7XHJcbiAgICAgICAgIGNjLnJhZGl1cyA9IHJhZGl1c0EgKyByYWRpdXNCO1xyXG4gICAgICAgICBjYy50eXBlID0gbWFuaWZvbGQubV90eXBlO1xyXG4gICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGNjLnBvaW50Q291bnQ7ICsraykge1xyXG4gICAgICAgICAgICB2YXIgY3AgPSBtYW5pZm9sZC5tX3BvaW50c1trXTtcclxuICAgICAgICAgICAgdmFyIGNjcCA9IGNjLnBvaW50c1trXTtcclxuICAgICAgICAgICAgY2NwLm5vcm1hbEltcHVsc2UgPSBjcC5tX25vcm1hbEltcHVsc2U7XHJcbiAgICAgICAgICAgIGNjcC50YW5nZW50SW1wdWxzZSA9IGNwLm1fdGFuZ2VudEltcHVsc2U7XHJcbiAgICAgICAgICAgIGNjcC5sb2NhbFBvaW50LlNldFYoY3AubV9sb2NhbFBvaW50KTtcclxuICAgICAgICAgICAgdmFyIHJBWCA9IGNjcC5yQS54ID0gYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZC5tX3BvaW50c1trXS54IC0gYm9keUEubV9zd2VlcC5jLng7XHJcbiAgICAgICAgICAgIHZhciByQVkgPSBjY3AuckEueSA9IGIyQ29udGFjdFNvbHZlci5zX3dvcmxkTWFuaWZvbGQubV9wb2ludHNba10ueSAtIGJvZHlBLm1fc3dlZXAuYy55O1xyXG4gICAgICAgICAgICB2YXIgckJYID0gY2NwLnJCLnggPSBiMkNvbnRhY3RTb2x2ZXIuc193b3JsZE1hbmlmb2xkLm1fcG9pbnRzW2tdLnggLSBib2R5Qi5tX3N3ZWVwLmMueDtcclxuICAgICAgICAgICAgdmFyIHJCWSA9IGNjcC5yQi55ID0gYjJDb250YWN0U29sdmVyLnNfd29ybGRNYW5pZm9sZC5tX3BvaW50c1trXS55IC0gYm9keUIubV9zd2VlcC5jLnk7XHJcbiAgICAgICAgICAgIHZhciBybkEgPSByQVggKiBub3JtYWxZIC0gckFZICogbm9ybWFsWDtcclxuICAgICAgICAgICAgdmFyIHJuQiA9IHJCWCAqIG5vcm1hbFkgLSByQlkgKiBub3JtYWxYO1xyXG4gICAgICAgICAgICBybkEgKj0gcm5BO1xyXG4gICAgICAgICAgICBybkIgKj0gcm5CO1xyXG4gICAgICAgICAgICB2YXIga05vcm1hbCA9IGJvZHlBLm1faW52TWFzcyArIGJvZHlCLm1faW52TWFzcyArIGJvZHlBLm1faW52SSAqIHJuQSArIGJvZHlCLm1faW52SSAqIHJuQjtcclxuICAgICAgICAgICAgY2NwLm5vcm1hbE1hc3MgPSAxLjAgLyBrTm9ybWFsO1xyXG4gICAgICAgICAgICB2YXIga0VxdWFsaXplZCA9IGJvZHlBLm1fbWFzcyAqIGJvZHlBLm1faW52TWFzcyArIGJvZHlCLm1fbWFzcyAqIGJvZHlCLm1faW52TWFzcztcclxuICAgICAgICAgICAga0VxdWFsaXplZCArPSBib2R5QS5tX21hc3MgKiBib2R5QS5tX2ludkkgKiBybkEgKyBib2R5Qi5tX21hc3MgKiBib2R5Qi5tX2ludkkgKiBybkI7XHJcbiAgICAgICAgICAgIGNjcC5lcXVhbGl6ZWRNYXNzID0gMS4wIC8ga0VxdWFsaXplZDtcclxuICAgICAgICAgICAgdmFyIHRhbmdlbnRYID0gbm9ybWFsWTtcclxuICAgICAgICAgICAgdmFyIHRhbmdlbnRZID0gKC1ub3JtYWxYKTtcclxuICAgICAgICAgICAgdmFyIHJ0QSA9IHJBWCAqIHRhbmdlbnRZIC0gckFZICogdGFuZ2VudFg7XHJcbiAgICAgICAgICAgIHZhciBydEIgPSByQlggKiB0YW5nZW50WSAtIHJCWSAqIHRhbmdlbnRYO1xyXG4gICAgICAgICAgICBydEEgKj0gcnRBO1xyXG4gICAgICAgICAgICBydEIgKj0gcnRCO1xyXG4gICAgICAgICAgICB2YXIga1RhbmdlbnQgPSBib2R5QS5tX2ludk1hc3MgKyBib2R5Qi5tX2ludk1hc3MgKyBib2R5QS5tX2ludkkgKiBydEEgKyBib2R5Qi5tX2ludkkgKiBydEI7XHJcbiAgICAgICAgICAgIGNjcC50YW5nZW50TWFzcyA9IDEuMCAvIGtUYW5nZW50O1xyXG4gICAgICAgICAgICBjY3AudmVsb2NpdHlCaWFzID0gMC4wO1xyXG4gICAgICAgICAgICB2YXIgdFggPSB2QlggKyAoKC13QiAqIHJCWSkpIC0gdkFYIC0gKCgtd0EgKiByQVkpKTtcclxuICAgICAgICAgICAgdmFyIHRZID0gdkJZICsgKHdCICogckJYKSAtIHZBWSAtICh3QSAqIHJBWCk7XHJcbiAgICAgICAgICAgIHZhciB2UmVsID0gY2Mubm9ybWFsLnggKiB0WCArIGNjLm5vcm1hbC55ICogdFk7XHJcbiAgICAgICAgICAgIGlmICh2UmVsIDwgKC1iMlNldHRpbmdzLmIyX3ZlbG9jaXR5VGhyZXNob2xkKSkge1xyXG4gICAgICAgICAgICAgICBjY3AudmVsb2NpdHlCaWFzICs9ICgtY2MucmVzdGl0dXRpb24gKiB2UmVsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChjYy5wb2ludENvdW50ID09IDIpIHtcclxuICAgICAgICAgICAgdmFyIGNjcDEgPSBjYy5wb2ludHNbMF07XHJcbiAgICAgICAgICAgIHZhciBjY3AyID0gY2MucG9pbnRzWzFdO1xyXG4gICAgICAgICAgICB2YXIgaW52TWFzc0EgPSBib2R5QS5tX2ludk1hc3M7XHJcbiAgICAgICAgICAgIHZhciBpbnZJQSA9IGJvZHlBLm1faW52STtcclxuICAgICAgICAgICAgdmFyIGludk1hc3NCID0gYm9keUIubV9pbnZNYXNzO1xyXG4gICAgICAgICAgICB2YXIgaW52SUIgPSBib2R5Qi5tX2ludkk7XHJcbiAgICAgICAgICAgIHZhciBybjFBID0gY2NwMS5yQS54ICogbm9ybWFsWSAtIGNjcDEuckEueSAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgIHZhciBybjFCID0gY2NwMS5yQi54ICogbm9ybWFsWSAtIGNjcDEuckIueSAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgIHZhciBybjJBID0gY2NwMi5yQS54ICogbm9ybWFsWSAtIGNjcDIuckEueSAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgIHZhciBybjJCID0gY2NwMi5yQi54ICogbm9ybWFsWSAtIGNjcDIuckIueSAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgIHZhciBrMTEgPSBpbnZNYXNzQSArIGludk1hc3NCICsgaW52SUEgKiBybjFBICogcm4xQSArIGludklCICogcm4xQiAqIHJuMUI7XHJcbiAgICAgICAgICAgIHZhciBrMjIgPSBpbnZNYXNzQSArIGludk1hc3NCICsgaW52SUEgKiBybjJBICogcm4yQSArIGludklCICogcm4yQiAqIHJuMkI7XHJcbiAgICAgICAgICAgIHZhciBrMTIgPSBpbnZNYXNzQSArIGludk1hc3NCICsgaW52SUEgKiBybjFBICogcm4yQSArIGludklCICogcm4xQiAqIHJuMkI7XHJcbiAgICAgICAgICAgIHZhciBrX21heENvbmRpdGlvbk51bWJlciA9IDEwMC4wO1xyXG4gICAgICAgICAgICBpZiAoazExICogazExIDwga19tYXhDb25kaXRpb25OdW1iZXIgKiAoazExICogazIyIC0gazEyICogazEyKSkge1xyXG4gICAgICAgICAgICAgICBjYy5LLmNvbDEuU2V0KGsxMSwgazEyKTtcclxuICAgICAgICAgICAgICAgY2MuSy5jb2wyLlNldChrMTIsIGsyMik7XHJcbiAgICAgICAgICAgICAgIGNjLksuR2V0SW52ZXJzZShjYy5ub3JtYWxNYXNzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgY2MucG9pbnRDb3VudCA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJDb250YWN0U29sdmVyLnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciB0VmVjO1xyXG4gICAgICB2YXIgdFZlYzI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubV9jb25zdHJhaW50Q291bnQ7ICsraSkge1xyXG4gICAgICAgICB2YXIgYyA9IHRoaXMubV9jb25zdHJhaW50c1tpXTtcclxuICAgICAgICAgdmFyIGJvZHlBID0gYy5ib2R5QTtcclxuICAgICAgICAgdmFyIGJvZHlCID0gYy5ib2R5QjtcclxuICAgICAgICAgdmFyIGludk1hc3NBID0gYm9keUEubV9pbnZNYXNzO1xyXG4gICAgICAgICB2YXIgaW52SUEgPSBib2R5QS5tX2ludkk7XHJcbiAgICAgICAgIHZhciBpbnZNYXNzQiA9IGJvZHlCLm1faW52TWFzcztcclxuICAgICAgICAgdmFyIGludklCID0gYm9keUIubV9pbnZJO1xyXG4gICAgICAgICB2YXIgbm9ybWFsWCA9IGMubm9ybWFsLng7XHJcbiAgICAgICAgIHZhciBub3JtYWxZID0gYy5ub3JtYWwueTtcclxuICAgICAgICAgdmFyIHRhbmdlbnRYID0gbm9ybWFsWTtcclxuICAgICAgICAgdmFyIHRhbmdlbnRZID0gKC1ub3JtYWxYKTtcclxuICAgICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgICAgdmFyIGogPSAwO1xyXG4gICAgICAgICB2YXIgdENvdW50ID0gMDtcclxuICAgICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XHJcbiAgICAgICAgICAgIHRDb3VudCA9IGMucG9pbnRDb3VudDtcclxuICAgICAgICAgICAgZm9yIChqID0gMDtcclxuICAgICAgICAgICAgaiA8IHRDb3VudDsgKytqKSB7XHJcbiAgICAgICAgICAgICAgIHZhciBjY3AgPSBjLnBvaW50c1tqXTtcclxuICAgICAgICAgICAgICAgY2NwLm5vcm1hbEltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICAgICAgICBjY3AudGFuZ2VudEltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICAgICAgICB2YXIgUFggPSBjY3Aubm9ybWFsSW1wdWxzZSAqIG5vcm1hbFggKyBjY3AudGFuZ2VudEltcHVsc2UgKiB0YW5nZW50WDtcclxuICAgICAgICAgICAgICAgdmFyIFBZID0gY2NwLm5vcm1hbEltcHVsc2UgKiBub3JtYWxZICsgY2NwLnRhbmdlbnRJbXB1bHNlICogdGFuZ2VudFk7XHJcbiAgICAgICAgICAgICAgIGJvZHlBLm1fYW5ndWxhclZlbG9jaXR5IC09IGludklBICogKGNjcC5yQS54ICogUFkgLSBjY3AuckEueSAqIFBYKTtcclxuICAgICAgICAgICAgICAgYm9keUEubV9saW5lYXJWZWxvY2l0eS54IC09IGludk1hc3NBICogUFg7XHJcbiAgICAgICAgICAgICAgIGJvZHlBLm1fbGluZWFyVmVsb2NpdHkueSAtPSBpbnZNYXNzQSAqIFBZO1xyXG4gICAgICAgICAgICAgICBib2R5Qi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBpbnZJQiAqIChjY3AuckIueCAqIFBZIC0gY2NwLnJCLnkgKiBQWCk7XHJcbiAgICAgICAgICAgICAgIGJvZHlCLm1fbGluZWFyVmVsb2NpdHkueCArPSBpbnZNYXNzQiAqIFBYO1xyXG4gICAgICAgICAgICAgICBib2R5Qi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gaW52TWFzc0IgKiBQWTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0Q291bnQgPSBjLnBvaW50Q291bnQ7XHJcbiAgICAgICAgICAgIGZvciAoaiA9IDA7XHJcbiAgICAgICAgICAgIGogPCB0Q291bnQ7ICsraikge1xyXG4gICAgICAgICAgICAgICB2YXIgY2NwMiA9IGMucG9pbnRzW2pdO1xyXG4gICAgICAgICAgICAgICBjY3AyLm5vcm1hbEltcHVsc2UgPSAwLjA7XHJcbiAgICAgICAgICAgICAgIGNjcDIudGFuZ2VudEltcHVsc2UgPSAwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJDb250YWN0U29sdmVyLnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBqID0gMDtcclxuICAgICAgdmFyIGNjcDtcclxuICAgICAgdmFyIHJBWCA9IDA7XHJcbiAgICAgIHZhciByQVkgPSAwO1xyXG4gICAgICB2YXIgckJYID0gMDtcclxuICAgICAgdmFyIHJCWSA9IDA7XHJcbiAgICAgIHZhciBkdlggPSAwO1xyXG4gICAgICB2YXIgZHZZID0gMDtcclxuICAgICAgdmFyIHZuID0gMDtcclxuICAgICAgdmFyIHZ0ID0gMDtcclxuICAgICAgdmFyIGxhbWJkYSA9IDA7XHJcbiAgICAgIHZhciBtYXhGcmljdGlvbiA9IDA7XHJcbiAgICAgIHZhciBuZXdJbXB1bHNlID0gMDtcclxuICAgICAgdmFyIFBYID0gMDtcclxuICAgICAgdmFyIFBZID0gMDtcclxuICAgICAgdmFyIGRYID0gMDtcclxuICAgICAgdmFyIGRZID0gMDtcclxuICAgICAgdmFyIFAxWCA9IDA7XHJcbiAgICAgIHZhciBQMVkgPSAwO1xyXG4gICAgICB2YXIgUDJYID0gMDtcclxuICAgICAgdmFyIFAyWSA9IDA7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29uc3RyYWludENvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIGMgPSB0aGlzLm1fY29uc3RyYWludHNbaV07XHJcbiAgICAgICAgIHZhciBib2R5QSA9IGMuYm9keUE7XHJcbiAgICAgICAgIHZhciBib2R5QiA9IGMuYm9keUI7XHJcbiAgICAgICAgIHZhciB3QSA9IGJvZHlBLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICAgICB2YXIgd0IgPSBib2R5Qi5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgICAgdmFyIHZBID0gYm9keUEubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgICAgdmFyIHZCID0gYm9keUIubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgICAgdmFyIGludk1hc3NBID0gYm9keUEubV9pbnZNYXNzO1xyXG4gICAgICAgICB2YXIgaW52SUEgPSBib2R5QS5tX2ludkk7XHJcbiAgICAgICAgIHZhciBpbnZNYXNzQiA9IGJvZHlCLm1faW52TWFzcztcclxuICAgICAgICAgdmFyIGludklCID0gYm9keUIubV9pbnZJO1xyXG4gICAgICAgICB2YXIgbm9ybWFsWCA9IGMubm9ybWFsLng7XHJcbiAgICAgICAgIHZhciBub3JtYWxZID0gYy5ub3JtYWwueTtcclxuICAgICAgICAgdmFyIHRhbmdlbnRYID0gbm9ybWFsWTtcclxuICAgICAgICAgdmFyIHRhbmdlbnRZID0gKC1ub3JtYWxYKTtcclxuICAgICAgICAgdmFyIGZyaWN0aW9uID0gYy5mcmljdGlvbjtcclxuICAgICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgICAgZm9yIChqID0gMDtcclxuICAgICAgICAgaiA8IGMucG9pbnRDb3VudDsgaisrKSB7XHJcbiAgICAgICAgICAgIGNjcCA9IGMucG9pbnRzW2pdO1xyXG4gICAgICAgICAgICBkdlggPSB2Qi54IC0gd0IgKiBjY3AuckIueSAtIHZBLnggKyB3QSAqIGNjcC5yQS55O1xyXG4gICAgICAgICAgICBkdlkgPSB2Qi55ICsgd0IgKiBjY3AuckIueCAtIHZBLnkgLSB3QSAqIGNjcC5yQS54O1xyXG4gICAgICAgICAgICB2dCA9IGR2WCAqIHRhbmdlbnRYICsgZHZZICogdGFuZ2VudFk7XHJcbiAgICAgICAgICAgIGxhbWJkYSA9IGNjcC50YW5nZW50TWFzcyAqICgtdnQpO1xyXG4gICAgICAgICAgICBtYXhGcmljdGlvbiA9IGZyaWN0aW9uICogY2NwLm5vcm1hbEltcHVsc2U7XHJcbiAgICAgICAgICAgIG5ld0ltcHVsc2UgPSBiMk1hdGguQ2xhbXAoY2NwLnRhbmdlbnRJbXB1bHNlICsgbGFtYmRhLCAoLW1heEZyaWN0aW9uKSwgbWF4RnJpY3Rpb24pO1xyXG4gICAgICAgICAgICBsYW1iZGEgPSBuZXdJbXB1bHNlIC0gY2NwLnRhbmdlbnRJbXB1bHNlO1xyXG4gICAgICAgICAgICBQWCA9IGxhbWJkYSAqIHRhbmdlbnRYO1xyXG4gICAgICAgICAgICBQWSA9IGxhbWJkYSAqIHRhbmdlbnRZO1xyXG4gICAgICAgICAgICB2QS54IC09IGludk1hc3NBICogUFg7XHJcbiAgICAgICAgICAgIHZBLnkgLT0gaW52TWFzc0EgKiBQWTtcclxuICAgICAgICAgICAgd0EgLT0gaW52SUEgKiAoY2NwLnJBLnggKiBQWSAtIGNjcC5yQS55ICogUFgpO1xyXG4gICAgICAgICAgICB2Qi54ICs9IGludk1hc3NCICogUFg7XHJcbiAgICAgICAgICAgIHZCLnkgKz0gaW52TWFzc0IgKiBQWTtcclxuICAgICAgICAgICAgd0IgKz0gaW52SUIgKiAoY2NwLnJCLnggKiBQWSAtIGNjcC5yQi55ICogUFgpO1xyXG4gICAgICAgICAgICBjY3AudGFuZ2VudEltcHVsc2UgPSBuZXdJbXB1bHNlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciB0Q291bnQgPSBwYXJzZUludChjLnBvaW50Q291bnQpO1xyXG4gICAgICAgICBpZiAoYy5wb2ludENvdW50ID09IDEpIHtcclxuICAgICAgICAgICAgY2NwID0gYy5wb2ludHNbMF07XHJcbiAgICAgICAgICAgIGR2WCA9IHZCLnggKyAoKC13QiAqIGNjcC5yQi55KSkgLSB2QS54IC0gKCgtd0EgKiBjY3AuckEueSkpO1xyXG4gICAgICAgICAgICBkdlkgPSB2Qi55ICsgKHdCICogY2NwLnJCLngpIC0gdkEueSAtICh3QSAqIGNjcC5yQS54KTtcclxuICAgICAgICAgICAgdm4gPSBkdlggKiBub3JtYWxYICsgZHZZICogbm9ybWFsWTtcclxuICAgICAgICAgICAgbGFtYmRhID0gKC1jY3Aubm9ybWFsTWFzcyAqICh2biAtIGNjcC52ZWxvY2l0eUJpYXMpKTtcclxuICAgICAgICAgICAgbmV3SW1wdWxzZSA9IGNjcC5ub3JtYWxJbXB1bHNlICsgbGFtYmRhO1xyXG4gICAgICAgICAgICBuZXdJbXB1bHNlID0gbmV3SW1wdWxzZSA+IDAgPyBuZXdJbXB1bHNlIDogMC4wO1xyXG4gICAgICAgICAgICBsYW1iZGEgPSBuZXdJbXB1bHNlIC0gY2NwLm5vcm1hbEltcHVsc2U7XHJcbiAgICAgICAgICAgIFBYID0gbGFtYmRhICogbm9ybWFsWDtcclxuICAgICAgICAgICAgUFkgPSBsYW1iZGEgKiBub3JtYWxZO1xyXG4gICAgICAgICAgICB2QS54IC09IGludk1hc3NBICogUFg7XHJcbiAgICAgICAgICAgIHZBLnkgLT0gaW52TWFzc0EgKiBQWTtcclxuICAgICAgICAgICAgd0EgLT0gaW52SUEgKiAoY2NwLnJBLnggKiBQWSAtIGNjcC5yQS55ICogUFgpO1xyXG4gICAgICAgICAgICB2Qi54ICs9IGludk1hc3NCICogUFg7XHJcbiAgICAgICAgICAgIHZCLnkgKz0gaW52TWFzc0IgKiBQWTtcclxuICAgICAgICAgICAgd0IgKz0gaW52SUIgKiAoY2NwLnJCLnggKiBQWSAtIGNjcC5yQi55ICogUFgpO1xyXG4gICAgICAgICAgICBjY3Aubm9ybWFsSW1wdWxzZSA9IG5ld0ltcHVsc2U7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBjcDEgPSBjLnBvaW50c1swXTtcclxuICAgICAgICAgICAgdmFyIGNwMiA9IGMucG9pbnRzWzFdO1xyXG4gICAgICAgICAgICB2YXIgYVggPSBjcDEubm9ybWFsSW1wdWxzZTtcclxuICAgICAgICAgICAgdmFyIGFZID0gY3AyLm5vcm1hbEltcHVsc2U7XHJcbiAgICAgICAgICAgIHZhciBkdjFYID0gdkIueCAtIHdCICogY3AxLnJCLnkgLSB2QS54ICsgd0EgKiBjcDEuckEueTtcclxuICAgICAgICAgICAgdmFyIGR2MVkgPSB2Qi55ICsgd0IgKiBjcDEuckIueCAtIHZBLnkgLSB3QSAqIGNwMS5yQS54O1xyXG4gICAgICAgICAgICB2YXIgZHYyWCA9IHZCLnggLSB3QiAqIGNwMi5yQi55IC0gdkEueCArIHdBICogY3AyLnJBLnk7XHJcbiAgICAgICAgICAgIHZhciBkdjJZID0gdkIueSArIHdCICogY3AyLnJCLnggLSB2QS55IC0gd0EgKiBjcDIuckEueDtcclxuICAgICAgICAgICAgdmFyIHZuMSA9IGR2MVggKiBub3JtYWxYICsgZHYxWSAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgIHZhciB2bjIgPSBkdjJYICogbm9ybWFsWCArIGR2MlkgKiBub3JtYWxZO1xyXG4gICAgICAgICAgICB2YXIgYlggPSB2bjEgLSBjcDEudmVsb2NpdHlCaWFzO1xyXG4gICAgICAgICAgICB2YXIgYlkgPSB2bjIgLSBjcDIudmVsb2NpdHlCaWFzO1xyXG4gICAgICAgICAgICB0TWF0ID0gYy5LO1xyXG4gICAgICAgICAgICBiWCAtPSB0TWF0LmNvbDEueCAqIGFYICsgdE1hdC5jb2wyLnggKiBhWTtcclxuICAgICAgICAgICAgYlkgLT0gdE1hdC5jb2wxLnkgKiBhWCArIHRNYXQuY29sMi55ICogYVk7XHJcbiAgICAgICAgICAgIHZhciBrX2Vycm9yVG9sID0gMC4wMDE7XHJcbiAgICAgICAgICAgIGZvciAoOzspIHtcclxuICAgICAgICAgICAgICAgdE1hdCA9IGMubm9ybWFsTWFzcztcclxuICAgICAgICAgICAgICAgdmFyIHhYID0gKC0odE1hdC5jb2wxLnggKiBiWCArIHRNYXQuY29sMi54ICogYlkpKTtcclxuICAgICAgICAgICAgICAgdmFyIHhZID0gKC0odE1hdC5jb2wxLnkgKiBiWCArIHRNYXQuY29sMi55ICogYlkpKTtcclxuICAgICAgICAgICAgICAgaWYgKHhYID49IDAuMCAmJiB4WSA+PSAwLjApIHtcclxuICAgICAgICAgICAgICAgICAgZFggPSB4WCAtIGFYO1xyXG4gICAgICAgICAgICAgICAgICBkWSA9IHhZIC0gYVk7XHJcbiAgICAgICAgICAgICAgICAgIFAxWCA9IGRYICogbm9ybWFsWDtcclxuICAgICAgICAgICAgICAgICAgUDFZID0gZFggKiBub3JtYWxZO1xyXG4gICAgICAgICAgICAgICAgICBQMlggPSBkWSAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgICAgICAgIFAyWSA9IGRZICogbm9ybWFsWTtcclxuICAgICAgICAgICAgICAgICAgdkEueCAtPSBpbnZNYXNzQSAqIChQMVggKyBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICB2QS55IC09IGludk1hc3NBICogKFAxWSArIFAyWSk7XHJcbiAgICAgICAgICAgICAgICAgIHdBIC09IGludklBICogKGNwMS5yQS54ICogUDFZIC0gY3AxLnJBLnkgKiBQMVggKyBjcDIuckEueCAqIFAyWSAtIGNwMi5yQS55ICogUDJYKTtcclxuICAgICAgICAgICAgICAgICAgdkIueCArPSBpbnZNYXNzQiAqIChQMVggKyBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICB2Qi55ICs9IGludk1hc3NCICogKFAxWSArIFAyWSk7XHJcbiAgICAgICAgICAgICAgICAgIHdCICs9IGludklCICogKGNwMS5yQi54ICogUDFZIC0gY3AxLnJCLnkgKiBQMVggKyBjcDIuckIueCAqIFAyWSAtIGNwMi5yQi55ICogUDJYKTtcclxuICAgICAgICAgICAgICAgICAgY3AxLm5vcm1hbEltcHVsc2UgPSB4WDtcclxuICAgICAgICAgICAgICAgICAgY3AyLm5vcm1hbEltcHVsc2UgPSB4WTtcclxuICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgeFggPSAoLWNwMS5ub3JtYWxNYXNzICogYlgpO1xyXG4gICAgICAgICAgICAgICB4WSA9IDAuMDtcclxuICAgICAgICAgICAgICAgdm4xID0gMC4wO1xyXG4gICAgICAgICAgICAgICB2bjIgPSBjLksuY29sMS55ICogeFggKyBiWTtcclxuICAgICAgICAgICAgICAgaWYgKHhYID49IDAuMCAmJiB2bjIgPj0gMC4wKSB7XHJcbiAgICAgICAgICAgICAgICAgIGRYID0geFggLSBhWDtcclxuICAgICAgICAgICAgICAgICAgZFkgPSB4WSAtIGFZO1xyXG4gICAgICAgICAgICAgICAgICBQMVggPSBkWCAqIG5vcm1hbFg7XHJcbiAgICAgICAgICAgICAgICAgIFAxWSA9IGRYICogbm9ybWFsWTtcclxuICAgICAgICAgICAgICAgICAgUDJYID0gZFkgKiBub3JtYWxYO1xyXG4gICAgICAgICAgICAgICAgICBQMlkgPSBkWSAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgICAgICAgIHZBLnggLT0gaW52TWFzc0EgKiAoUDFYICsgUDJYKTtcclxuICAgICAgICAgICAgICAgICAgdkEueSAtPSBpbnZNYXNzQSAqIChQMVkgKyBQMlkpO1xyXG4gICAgICAgICAgICAgICAgICB3QSAtPSBpbnZJQSAqIChjcDEuckEueCAqIFAxWSAtIGNwMS5yQS55ICogUDFYICsgY3AyLnJBLnggKiBQMlkgLSBjcDIuckEueSAqIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIHZCLnggKz0gaW52TWFzc0IgKiAoUDFYICsgUDJYKTtcclxuICAgICAgICAgICAgICAgICAgdkIueSArPSBpbnZNYXNzQiAqIChQMVkgKyBQMlkpO1xyXG4gICAgICAgICAgICAgICAgICB3QiArPSBpbnZJQiAqIChjcDEuckIueCAqIFAxWSAtIGNwMS5yQi55ICogUDFYICsgY3AyLnJCLnggKiBQMlkgLSBjcDIuckIueSAqIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIGNwMS5ub3JtYWxJbXB1bHNlID0geFg7XHJcbiAgICAgICAgICAgICAgICAgIGNwMi5ub3JtYWxJbXB1bHNlID0geFk7XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIHhYID0gMC4wO1xyXG4gICAgICAgICAgICAgICB4WSA9ICgtY3AyLm5vcm1hbE1hc3MgKiBiWSk7XHJcbiAgICAgICAgICAgICAgIHZuMSA9IGMuSy5jb2wyLnggKiB4WSArIGJYO1xyXG4gICAgICAgICAgICAgICB2bjIgPSAwLjA7XHJcbiAgICAgICAgICAgICAgIGlmICh4WSA+PSAwLjAgJiYgdm4xID49IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICBkWCA9IHhYIC0gYVg7XHJcbiAgICAgICAgICAgICAgICAgIGRZID0geFkgLSBhWTtcclxuICAgICAgICAgICAgICAgICAgUDFYID0gZFggKiBub3JtYWxYO1xyXG4gICAgICAgICAgICAgICAgICBQMVkgPSBkWCAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgICAgICAgIFAyWCA9IGRZICogbm9ybWFsWDtcclxuICAgICAgICAgICAgICAgICAgUDJZID0gZFkgKiBub3JtYWxZO1xyXG4gICAgICAgICAgICAgICAgICB2QS54IC09IGludk1hc3NBICogKFAxWCArIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIHZBLnkgLT0gaW52TWFzc0EgKiAoUDFZICsgUDJZKTtcclxuICAgICAgICAgICAgICAgICAgd0EgLT0gaW52SUEgKiAoY3AxLnJBLnggKiBQMVkgLSBjcDEuckEueSAqIFAxWCArIGNwMi5yQS54ICogUDJZIC0gY3AyLnJBLnkgKiBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICB2Qi54ICs9IGludk1hc3NCICogKFAxWCArIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIHZCLnkgKz0gaW52TWFzc0IgKiAoUDFZICsgUDJZKTtcclxuICAgICAgICAgICAgICAgICAgd0IgKz0gaW52SUIgKiAoY3AxLnJCLnggKiBQMVkgLSBjcDEuckIueSAqIFAxWCArIGNwMi5yQi54ICogUDJZIC0gY3AyLnJCLnkgKiBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICBjcDEubm9ybWFsSW1wdWxzZSA9IHhYO1xyXG4gICAgICAgICAgICAgICAgICBjcDIubm9ybWFsSW1wdWxzZSA9IHhZO1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICB4WCA9IDAuMDtcclxuICAgICAgICAgICAgICAgeFkgPSAwLjA7XHJcbiAgICAgICAgICAgICAgIHZuMSA9IGJYO1xyXG4gICAgICAgICAgICAgICB2bjIgPSBiWTtcclxuICAgICAgICAgICAgICAgaWYgKHZuMSA+PSAwLjAgJiYgdm4yID49IDAuMCkge1xyXG4gICAgICAgICAgICAgICAgICBkWCA9IHhYIC0gYVg7XHJcbiAgICAgICAgICAgICAgICAgIGRZID0geFkgLSBhWTtcclxuICAgICAgICAgICAgICAgICAgUDFYID0gZFggKiBub3JtYWxYO1xyXG4gICAgICAgICAgICAgICAgICBQMVkgPSBkWCAqIG5vcm1hbFk7XHJcbiAgICAgICAgICAgICAgICAgIFAyWCA9IGRZICogbm9ybWFsWDtcclxuICAgICAgICAgICAgICAgICAgUDJZID0gZFkgKiBub3JtYWxZO1xyXG4gICAgICAgICAgICAgICAgICB2QS54IC09IGludk1hc3NBICogKFAxWCArIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIHZBLnkgLT0gaW52TWFzc0EgKiAoUDFZICsgUDJZKTtcclxuICAgICAgICAgICAgICAgICAgd0EgLT0gaW52SUEgKiAoY3AxLnJBLnggKiBQMVkgLSBjcDEuckEueSAqIFAxWCArIGNwMi5yQS54ICogUDJZIC0gY3AyLnJBLnkgKiBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICB2Qi54ICs9IGludk1hc3NCICogKFAxWCArIFAyWCk7XHJcbiAgICAgICAgICAgICAgICAgIHZCLnkgKz0gaW52TWFzc0IgKiAoUDFZICsgUDJZKTtcclxuICAgICAgICAgICAgICAgICAgd0IgKz0gaW52SUIgKiAoY3AxLnJCLnggKiBQMVkgLSBjcDEuckIueSAqIFAxWCArIGNwMi5yQi54ICogUDJZIC0gY3AyLnJCLnkgKiBQMlgpO1xyXG4gICAgICAgICAgICAgICAgICBjcDEubm9ybWFsSW1wdWxzZSA9IHhYO1xyXG4gICAgICAgICAgICAgICAgICBjcDIubm9ybWFsSW1wdWxzZSA9IHhZO1xyXG4gICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJvZHlBLm1fYW5ndWxhclZlbG9jaXR5ID0gd0E7XHJcbiAgICAgICAgIGJvZHlCLm1fYW5ndWxhclZlbG9jaXR5ID0gd0I7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkNvbnRhY3RTb2x2ZXIucHJvdG90eXBlLkZpbmFsaXplVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29uc3RyYWludENvdW50OyArK2kpIHtcclxuICAgICAgICAgdmFyIGMgPSB0aGlzLm1fY29uc3RyYWludHNbaV07XHJcbiAgICAgICAgIHZhciBtID0gYy5tYW5pZm9sZDtcclxuICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBjLnBvaW50Q291bnQ7ICsraikge1xyXG4gICAgICAgICAgICB2YXIgcG9pbnQxID0gbS5tX3BvaW50c1tqXTtcclxuICAgICAgICAgICAgdmFyIHBvaW50MiA9IGMucG9pbnRzW2pdO1xyXG4gICAgICAgICAgICBwb2ludDEubV9ub3JtYWxJbXB1bHNlID0gcG9pbnQyLm5vcm1hbEltcHVsc2U7XHJcbiAgICAgICAgICAgIHBvaW50MS5tX3RhbmdlbnRJbXB1bHNlID0gcG9pbnQyLnRhbmdlbnRJbXB1bHNlO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkNvbnRhY3RTb2x2ZXIucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcclxuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xyXG4gICAgICB2YXIgbWluU2VwYXJhdGlvbiA9IDAuMDtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1fY29uc3RyYWludENvdW50OyBpKyspIHtcclxuICAgICAgICAgdmFyIGMgPSB0aGlzLm1fY29uc3RyYWludHNbaV07XHJcbiAgICAgICAgIHZhciBib2R5QSA9IGMuYm9keUE7XHJcbiAgICAgICAgIHZhciBib2R5QiA9IGMuYm9keUI7XHJcbiAgICAgICAgIHZhciBpbnZNYXNzQSA9IGJvZHlBLm1fbWFzcyAqIGJvZHlBLm1faW52TWFzcztcclxuICAgICAgICAgdmFyIGludklBID0gYm9keUEubV9tYXNzICogYm9keUEubV9pbnZJO1xyXG4gICAgICAgICB2YXIgaW52TWFzc0IgPSBib2R5Qi5tX21hc3MgKiBib2R5Qi5tX2ludk1hc3M7XHJcbiAgICAgICAgIHZhciBpbnZJQiA9IGJvZHlCLm1fbWFzcyAqIGJvZHlCLm1faW52STtcclxuICAgICAgICAgYjJDb250YWN0U29sdmVyLnNfcHNtLkluaXRpYWxpemUoYyk7XHJcbiAgICAgICAgIHZhciBub3JtYWwgPSBiMkNvbnRhY3RTb2x2ZXIuc19wc20ubV9ub3JtYWw7XHJcbiAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgYy5wb2ludENvdW50OyBqKyspIHtcclxuICAgICAgICAgICAgdmFyIGNjcCA9IGMucG9pbnRzW2pdO1xyXG4gICAgICAgICAgICB2YXIgcG9pbnQgPSBiMkNvbnRhY3RTb2x2ZXIuc19wc20ubV9wb2ludHNbal07XHJcbiAgICAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gYjJDb250YWN0U29sdmVyLnNfcHNtLm1fc2VwYXJhdGlvbnNbal07XHJcbiAgICAgICAgICAgIHZhciByQVggPSBwb2ludC54IC0gYm9keUEubV9zd2VlcC5jLng7XHJcbiAgICAgICAgICAgIHZhciByQVkgPSBwb2ludC55IC0gYm9keUEubV9zd2VlcC5jLnk7XHJcbiAgICAgICAgICAgIHZhciByQlggPSBwb2ludC54IC0gYm9keUIubV9zd2VlcC5jLng7XHJcbiAgICAgICAgICAgIHZhciByQlkgPSBwb2ludC55IC0gYm9keUIubV9zd2VlcC5jLnk7XHJcbiAgICAgICAgICAgIG1pblNlcGFyYXRpb24gPSBtaW5TZXBhcmF0aW9uIDwgc2VwYXJhdGlvbiA/IG1pblNlcGFyYXRpb24gOiBzZXBhcmF0aW9uO1xyXG4gICAgICAgICAgICB2YXIgQyA9IGIyTWF0aC5DbGFtcChiYXVtZ2FydGUgKiAoc2VwYXJhdGlvbiArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCksICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgMC4wKTtcclxuICAgICAgICAgICAgdmFyIGltcHVsc2UgPSAoLWNjcC5lcXVhbGl6ZWRNYXNzICogQyk7XHJcbiAgICAgICAgICAgIHZhciBQWCA9IGltcHVsc2UgKiBub3JtYWwueDtcclxuICAgICAgICAgICAgdmFyIFBZID0gaW1wdWxzZSAqIG5vcm1hbC55O2JvZHlBLm1fc3dlZXAuYy54IC09IGludk1hc3NBICogUFg7XHJcbiAgICAgICAgICAgIGJvZHlBLm1fc3dlZXAuYy55IC09IGludk1hc3NBICogUFk7XHJcbiAgICAgICAgICAgIGJvZHlBLm1fc3dlZXAuYSAtPSBpbnZJQSAqIChyQVggKiBQWSAtIHJBWSAqIFBYKTtcclxuICAgICAgICAgICAgYm9keUEuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgICAgICAgYm9keUIubV9zd2VlcC5jLnggKz0gaW52TWFzc0IgKiBQWDtcclxuICAgICAgICAgICAgYm9keUIubV9zd2VlcC5jLnkgKz0gaW52TWFzc0IgKiBQWTtcclxuICAgICAgICAgICAgYm9keUIubV9zd2VlcC5hICs9IGludklCICogKHJCWCAqIFBZIC0gckJZICogUFgpO1xyXG4gICAgICAgICAgICBib2R5Qi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG1pblNlcGFyYXRpb24gPiAoLTEuNSAqIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCk7XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFNvbHZlci5zX3dvcmxkTWFuaWZvbGQgPSBuZXcgYjJXb3JsZE1hbmlmb2xkKCk7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdFNvbHZlci5zX3BzbSA9IG5ldyBiMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQoKTtcclxuICAgfSk7XHJcbiAgIEJveDJELmluaGVyaXQoYjJFZGdlQW5kQ2lyY2xlQ29udGFjdCwgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0KTtcclxuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5wcm90b3R5cGU7XHJcbiAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QuYjJFZGdlQW5kQ2lyY2xlQ29udGFjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmIyQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBiMkVkZ2VBbmRDaXJjbGVDb250YWN0LkNyZWF0ZSA9IGZ1bmN0aW9uIChhbGxvY2F0b3IpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMkVkZ2VBbmRDaXJjbGVDb250YWN0KCk7XHJcbiAgIH1cclxuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5EZXN0cm95ID0gZnVuY3Rpb24gKGNvbnRhY3QsIGFsbG9jYXRvcikge31cclxuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuUmVzZXQgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5SZXNldC5jYWxsKHRoaXMsIGZpeHR1cmVBLCBmaXh0dXJlQik7XHJcbiAgIH1cclxuICAgYjJFZGdlQW5kQ2lyY2xlQ29udGFjdC5wcm90b3R5cGUuRXZhbHVhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9maXh0dXJlQS5HZXRCb2R5KCk7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9maXh0dXJlQi5HZXRCb2R5KCk7XHJcbiAgICAgIHRoaXMuYjJDb2xsaWRlRWRnZUFuZENpcmNsZSh0aGlzLm1fbWFuaWZvbGQsICh0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyRWRnZVNoYXBlID8gdGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgOiBudWxsKSwgYkEubV94ZiwgKHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJDaXJjbGVTaGFwZSA/IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIDogbnVsbCksIGJCLm1feGYpO1xyXG4gICB9XHJcbiAgIGIyRWRnZUFuZENpcmNsZUNvbnRhY3QucHJvdG90eXBlLmIyQ29sbGlkZUVkZ2VBbmRDaXJjbGUgPSBmdW5jdGlvbiAobWFuaWZvbGQsIGVkZ2UsIHhmMSwgY2lyY2xlLCB4ZjIpIHt9XHJcbiAgIEJveDJELmluaGVyaXQoYjJOdWxsQ29udGFjdCwgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0KTtcclxuICAgYjJOdWxsQ29udGFjdC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5wcm90b3R5cGU7XHJcbiAgIGIyTnVsbENvbnRhY3QuYjJOdWxsQ29udGFjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LmIyQ29udGFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBiMk51bGxDb250YWN0LnByb3RvdHlwZS5iMk51bGxDb250YWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJDb250YWN0LmNhbGwodGhpcyk7XHJcbiAgIH1cclxuICAgYjJOdWxsQ29udGFjdC5wcm90b3R5cGUuRXZhbHVhdGUgPSBmdW5jdGlvbiAoKSB7fVxyXG4gICBCb3gyRC5pbmhlcml0KGIyUG9seUFuZENpcmNsZUNvbnRhY3QsIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdCk7XHJcbiAgIGIyUG9seUFuZENpcmNsZUNvbnRhY3QucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QucHJvdG90eXBlO1xyXG4gICBiMlBvbHlBbmRDaXJjbGVDb250YWN0LmIyUG9seUFuZENpcmNsZUNvbnRhY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5iMkNvbnRhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgfTtcclxuICAgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdC5DcmVhdGUgPSBmdW5jdGlvbiAoYWxsb2NhdG9yKSB7XHJcbiAgICAgIHJldHVybiBuZXcgYjJQb2x5QW5kQ2lyY2xlQ29udGFjdCgpO1xyXG4gICB9XHJcbiAgIGIyUG9seUFuZENpcmNsZUNvbnRhY3QuRGVzdHJveSA9IGZ1bmN0aW9uIChjb250YWN0LCBhbGxvY2F0b3IpIHt9XHJcbiAgIGIyUG9seUFuZENpcmNsZUNvbnRhY3QucHJvdG90eXBlLlJlc2V0ID0gZnVuY3Rpb24gKGZpeHR1cmVBLCBmaXh0dXJlQikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuUmVzZXQuY2FsbCh0aGlzLCBmaXh0dXJlQSwgZml4dHVyZUIpO1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZpeHR1cmVBLkdldFR5cGUoKSA9PSBiMlNoYXBlLmVfcG9seWdvblNoYXBlKTtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChmaXh0dXJlQi5HZXRUeXBlKCkgPT0gYjJTaGFwZS5lX2NpcmNsZVNoYXBlKTtcclxuICAgfVxyXG4gICBiMlBvbHlBbmRDaXJjbGVDb250YWN0LnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2ZpeHR1cmVBLm1fYm9keTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2ZpeHR1cmVCLm1fYm9keTtcclxuICAgICAgYjJDb2xsaXNpb24uQ29sbGlkZVBvbHlnb25BbmRDaXJjbGUodGhpcy5tX21hbmlmb2xkLCAodGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgaW5zdGFuY2VvZiBiMlBvbHlnb25TaGFwZSA/IHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpIDogbnVsbCksIGJBLm1feGYsICh0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyQ2lyY2xlU2hhcGUgPyB0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKSA6IG51bGwpLCBiQi5tX3hmKTtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyUG9seUFuZEVkZ2VDb250YWN0LCBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QpO1xyXG4gICBiMlBvbHlBbmRFZGdlQ29udGFjdC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRhY3RzLmIyQ29udGFjdC5wcm90b3R5cGU7XHJcbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LmIyUG9seUFuZEVkZ2VDb250YWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuYjJDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LkNyZWF0ZSA9IGZ1bmN0aW9uIChhbGxvY2F0b3IpIHtcclxuICAgICAgcmV0dXJuIG5ldyBiMlBvbHlBbmRFZGdlQ29udGFjdCgpO1xyXG4gICB9XHJcbiAgIGIyUG9seUFuZEVkZ2VDb250YWN0LkRlc3Ryb3kgPSBmdW5jdGlvbiAoY29udGFjdCwgYWxsb2NhdG9yKSB7fVxyXG4gICBiMlBvbHlBbmRFZGdlQ29udGFjdC5wcm90b3R5cGUuUmVzZXQgPSBmdW5jdGlvbiAoZml4dHVyZUEsIGZpeHR1cmVCKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5SZXNldC5jYWxsKHRoaXMsIGZpeHR1cmVBLCBmaXh0dXJlQik7XHJcbiAgICAgIGIyU2V0dGluZ3MuYjJBc3NlcnQoZml4dHVyZUEuR2V0VHlwZSgpID09IGIyU2hhcGUuZV9wb2x5Z29uU2hhcGUpO1xyXG4gICAgICBiMlNldHRpbmdzLmIyQXNzZXJ0KGZpeHR1cmVCLkdldFR5cGUoKSA9PSBiMlNoYXBlLmVfZWRnZVNoYXBlKTtcclxuICAgfVxyXG4gICBiMlBvbHlBbmRFZGdlQ29udGFjdC5wcm90b3R5cGUuRXZhbHVhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9maXh0dXJlQS5HZXRCb2R5KCk7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9maXh0dXJlQi5HZXRCb2R5KCk7XHJcbiAgICAgIHRoaXMuYjJDb2xsaWRlUG9seUFuZEVkZ2UodGhpcy5tX21hbmlmb2xkLCAodGhpcy5tX2ZpeHR1cmVBLkdldFNoYXBlKCkgaW5zdGFuY2VvZiBiMlBvbHlnb25TaGFwZSA/IHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpIDogbnVsbCksIGJBLm1feGYsICh0aGlzLm1fZml4dHVyZUIuR2V0U2hhcGUoKSBpbnN0YW5jZW9mIGIyRWRnZVNoYXBlID8gdGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkgOiBudWxsKSwgYkIubV94Zik7XHJcbiAgIH1cclxuICAgYjJQb2x5QW5kRWRnZUNvbnRhY3QucHJvdG90eXBlLmIyQ29sbGlkZVBvbHlBbmRFZGdlID0gZnVuY3Rpb24gKG1hbmlmb2xkLCBwb2x5Z29uLCB4ZjEsIGVkZ2UsIHhmMikge31cclxuICAgQm94MkQuaW5oZXJpdChiMlBvbHlnb25Db250YWN0LCBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QpO1xyXG4gICBiMlBvbHlnb25Db250YWN0LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udGFjdHMuYjJDb250YWN0LnByb3RvdHlwZTtcclxuICAgYjJQb2x5Z29uQ29udGFjdC5iMlBvbHlnb25Db250YWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMkNvbnRhY3QuYjJDb250YWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgIH07XHJcbiAgIGIyUG9seWdvbkNvbnRhY3QuQ3JlYXRlID0gZnVuY3Rpb24gKGFsbG9jYXRvcikge1xyXG4gICAgICByZXR1cm4gbmV3IGIyUG9seWdvbkNvbnRhY3QoKTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25Db250YWN0LkRlc3Ryb3kgPSBmdW5jdGlvbiAoY29udGFjdCwgYWxsb2NhdG9yKSB7fVxyXG4gICBiMlBvbHlnb25Db250YWN0LnByb3RvdHlwZS5SZXNldCA9IGZ1bmN0aW9uIChmaXh0dXJlQSwgZml4dHVyZUIpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLlJlc2V0LmNhbGwodGhpcywgZml4dHVyZUEsIGZpeHR1cmVCKTtcclxuICAgfVxyXG4gICBiMlBvbHlnb25Db250YWN0LnByb3RvdHlwZS5FdmFsdWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2ZpeHR1cmVBLkdldEJvZHkoKTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2ZpeHR1cmVCLkdldEJvZHkoKTtcclxuICAgICAgYjJDb2xsaXNpb24uQ29sbGlkZVBvbHlnb25zKHRoaXMubV9tYW5pZm9sZCwgKHRoaXMubV9maXh0dXJlQS5HZXRTaGFwZSgpIGluc3RhbmNlb2YgYjJQb2x5Z29uU2hhcGUgPyB0aGlzLm1fZml4dHVyZUEuR2V0U2hhcGUoKSA6IG51bGwpLCBiQS5tX3hmLCAodGhpcy5tX2ZpeHR1cmVCLkdldFNoYXBlKCkgaW5zdGFuY2VvZiBiMlBvbHlnb25TaGFwZSA/IHRoaXMubV9maXh0dXJlQi5HZXRTaGFwZSgpIDogbnVsbCksIGJCLm1feGYpO1xyXG4gICB9XHJcbiAgIGIyUG9zaXRpb25Tb2x2ZXJNYW5pZm9sZC5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJQb3NpdGlvblNvbHZlck1hbmlmb2xkLnByb3RvdHlwZS5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9ub3JtYWwgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9zZXBhcmF0aW9ucyA9IG5ldyBWZWN0b3JfYTJqX051bWJlcihiMlNldHRpbmdzLmIyX21heE1hbmlmb2xkUG9pbnRzKTtcclxuICAgICAgdGhpcy5tX3BvaW50cyA9IG5ldyBWZWN0b3IoYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50cyk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYjJTZXR0aW5ncy5iMl9tYXhNYW5pZm9sZFBvaW50czsgaSsrKSB7XHJcbiAgICAgICAgIHRoaXMubV9wb2ludHNbaV0gPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoY2MpIHtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChjYy5wb2ludENvdW50ID4gMCk7XHJcbiAgICAgIHZhciBpID0gMDtcclxuICAgICAgdmFyIGNsaXBQb2ludFggPSAwO1xyXG4gICAgICB2YXIgY2xpcFBvaW50WSA9IDA7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFZlYztcclxuICAgICAgdmFyIHBsYW5lUG9pbnRYID0gMDtcclxuICAgICAgdmFyIHBsYW5lUG9pbnRZID0gMDtcclxuICAgICAgc3dpdGNoIChjYy50eXBlKSB7XHJcbiAgICAgIGNhc2UgYjJNYW5pZm9sZC5lX2NpcmNsZXM6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgdE1hdCA9IGNjLmJvZHlBLm1feGYuUjtcclxuICAgICAgICAgICAgdFZlYyA9IGNjLmxvY2FsUG9pbnQ7XHJcbiAgICAgICAgICAgIHZhciBwb2ludEFYID0gY2MuYm9keUEubV94Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRBWSA9IGNjLmJvZHlBLm1feGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgICAgdE1hdCA9IGNjLmJvZHlCLm1feGYuUjtcclxuICAgICAgICAgICAgdFZlYyA9IGNjLnBvaW50c1swXS5sb2NhbFBvaW50O1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRCWCA9IGNjLmJvZHlCLm1feGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgICAgdmFyIHBvaW50QlkgPSBjYy5ib2R5Qi5tX3hmLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHZhciBkWCA9IHBvaW50QlggLSBwb2ludEFYO1xyXG4gICAgICAgICAgICB2YXIgZFkgPSBwb2ludEJZIC0gcG9pbnRBWTtcclxuICAgICAgICAgICAgdmFyIGQyID0gZFggKiBkWCArIGRZICogZFk7XHJcbiAgICAgICAgICAgIGlmIChkMiA+IE51bWJlci5NSU5fVkFMVUUgKiBOdW1iZXIuTUlOX1ZBTFVFKSB7XHJcbiAgICAgICAgICAgICAgIHZhciBkID0gTWF0aC5zcXJ0KGQyKTtcclxuICAgICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ID0gZFggLyBkO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSBkWSAvIGQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueCA9IDEuMDtcclxuICAgICAgICAgICAgICAgdGhpcy5tX25vcm1hbC55ID0gMC4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubV9wb2ludHNbMF0ueCA9IDAuNSAqIChwb2ludEFYICsgcG9pbnRCWCk7XHJcbiAgICAgICAgICAgIHRoaXMubV9wb2ludHNbMF0ueSA9IDAuNSAqIChwb2ludEFZICsgcG9pbnRCWSk7XHJcbiAgICAgICAgICAgIHRoaXMubV9zZXBhcmF0aW9uc1swXSA9IGRYICogdGhpcy5tX25vcm1hbC54ICsgZFkgKiB0aGlzLm1fbm9ybWFsLnkgLSBjYy5yYWRpdXM7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJNYW5pZm9sZC5lX2ZhY2VBOlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIHRNYXQgPSBjYy5ib2R5QS5tX3hmLlI7XHJcbiAgICAgICAgICAgIHRWZWMgPSBjYy5sb2NhbFBsYW5lTm9ybWFsO1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnggPSB0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55O1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgPSB0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55O1xyXG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUEubV94Zi5SO1xyXG4gICAgICAgICAgICB0VmVjID0gY2MubG9jYWxQb2ludDtcclxuICAgICAgICAgICAgcGxhbmVQb2ludFggPSBjYy5ib2R5QS5tX3hmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgIHBsYW5lUG9pbnRZID0gY2MuYm9keUEubV94Zi5wb3NpdGlvbi55ICsgKHRNYXQuY29sMS55ICogdFZlYy54ICsgdE1hdC5jb2wyLnkgKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUIubV94Zi5SO1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwO1xyXG4gICAgICAgICAgICBpIDwgY2MucG9pbnRDb3VudDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgIHRWZWMgPSBjYy5wb2ludHNbaV0ubG9jYWxQb2ludDtcclxuICAgICAgICAgICAgICAgY2xpcFBvaW50WCA9IGNjLmJvZHlCLm1feGYucG9zaXRpb24ueCArICh0TWF0LmNvbDEueCAqIHRWZWMueCArIHRNYXQuY29sMi54ICogdFZlYy55KTtcclxuICAgICAgICAgICAgICAgY2xpcFBvaW50WSA9IGNjLmJvZHlCLm1feGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgICAgICAgdGhpcy5tX3NlcGFyYXRpb25zW2ldID0gKGNsaXBQb2ludFggLSBwbGFuZVBvaW50WCkgKiB0aGlzLm1fbm9ybWFsLnggKyAoY2xpcFBvaW50WSAtIHBsYW5lUG9pbnRZKSAqIHRoaXMubV9ub3JtYWwueSAtIGNjLnJhZGl1cztcclxuICAgICAgICAgICAgICAgdGhpcy5tX3BvaW50c1tpXS54ID0gY2xpcFBvaW50WDtcclxuICAgICAgICAgICAgICAgdGhpcy5tX3BvaW50c1tpXS55ID0gY2xpcFBvaW50WTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIGIyTWFuaWZvbGQuZV9mYWNlQjpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICB0TWF0ID0gY2MuYm9keUIubV94Zi5SO1xyXG4gICAgICAgICAgICB0VmVjID0gY2MubG9jYWxQbGFuZU5vcm1hbDtcclxuICAgICAgICAgICAgdGhpcy5tX25vcm1hbC54ID0gdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgICAgdGhpcy5tX25vcm1hbC55ID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgICAgdE1hdCA9IGNjLmJvZHlCLm1feGYuUjtcclxuICAgICAgICAgICAgdFZlYyA9IGNjLmxvY2FsUG9pbnQ7XHJcbiAgICAgICAgICAgIHBsYW5lUG9pbnRYID0gY2MuYm9keUIubV94Zi5wb3NpdGlvbi54ICsgKHRNYXQuY29sMS54ICogdFZlYy54ICsgdE1hdC5jb2wyLnggKiB0VmVjLnkpO1xyXG4gICAgICAgICAgICBwbGFuZVBvaW50WSA9IGNjLmJvZHlCLm1feGYucG9zaXRpb24ueSArICh0TWF0LmNvbDEueSAqIHRWZWMueCArIHRNYXQuY29sMi55ICogdFZlYy55KTtcclxuICAgICAgICAgICAgdE1hdCA9IGNjLmJvZHlBLm1feGYuUjtcclxuICAgICAgICAgICAgZm9yIChpID0gMDtcclxuICAgICAgICAgICAgaSA8IGNjLnBvaW50Q291bnQ7ICsraSkge1xyXG4gICAgICAgICAgICAgICB0VmVjID0gY2MucG9pbnRzW2ldLmxvY2FsUG9pbnQ7XHJcbiAgICAgICAgICAgICAgIGNsaXBQb2ludFggPSBjYy5ib2R5QS5tX3hmLnBvc2l0aW9uLnggKyAodE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgICAgIGNsaXBQb2ludFkgPSBjYy5ib2R5QS5tX3hmLnBvc2l0aW9uLnkgKyAodE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueSk7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9zZXBhcmF0aW9uc1tpXSA9IChjbGlwUG9pbnRYIC0gcGxhbmVQb2ludFgpICogdGhpcy5tX25vcm1hbC54ICsgKGNsaXBQb2ludFkgLSBwbGFuZVBvaW50WSkgKiB0aGlzLm1fbm9ybWFsLnkgLSBjYy5yYWRpdXM7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9wb2ludHNbaV0uU2V0KGNsaXBQb2ludFgsIGNsaXBQb2ludFkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubV9ub3JtYWwueCAqPSAoLTEpO1xyXG4gICAgICAgICAgICB0aGlzLm1fbm9ybWFsLnkgKj0gKC0xKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQuY2lyY2xlUG9pbnRBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250YWN0cy5iMlBvc2l0aW9uU29sdmVyTWFuaWZvbGQuY2lyY2xlUG9pbnRCID0gbmV3IGIyVmVjMigpO1xyXG4gICB9KTtcclxufSkoKTtcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgdmFyIGIyQm9keSA9IEJveDJELkR5bmFtaWNzLmIyQm9keSxcclxuICAgICAgYjJCb2R5RGVmID0gQm94MkQuRHluYW1pY3MuYjJCb2R5RGVmLFxyXG4gICAgICBiMkNvbnRhY3RGaWx0ZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RGaWx0ZXIsXHJcbiAgICAgIGIyQ29udGFjdEltcHVsc2UgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RJbXB1bHNlLFxyXG4gICAgICBiMkNvbnRhY3RMaXN0ZW5lciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdExpc3RlbmVyLFxyXG4gICAgICBiMkNvbnRhY3RNYW5hZ2VyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0TWFuYWdlcixcclxuICAgICAgYjJEZWJ1Z0RyYXcgPSBCb3gyRC5EeW5hbWljcy5iMkRlYnVnRHJhdyxcclxuICAgICAgYjJEZXN0cnVjdGlvbkxpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJEZXN0cnVjdGlvbkxpc3RlbmVyLFxyXG4gICAgICBiMkZpbHRlckRhdGEgPSBCb3gyRC5EeW5hbWljcy5iMkZpbHRlckRhdGEsXHJcbiAgICAgIGIyRml4dHVyZSA9IEJveDJELkR5bmFtaWNzLmIyRml4dHVyZSxcclxuICAgICAgYjJGaXh0dXJlRGVmID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlRGVmLFxyXG4gICAgICBiMklzbGFuZCA9IEJveDJELkR5bmFtaWNzLmIySXNsYW5kLFxyXG4gICAgICBiMlRpbWVTdGVwID0gQm94MkQuRHluYW1pY3MuYjJUaW1lU3RlcCxcclxuICAgICAgYjJXb3JsZCA9IEJveDJELkR5bmFtaWNzLmIyV29ybGQsXHJcbiAgICAgIGIyTWF0MjIgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDIyLFxyXG4gICAgICBiMk1hdDMzID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXQzMyxcclxuICAgICAgYjJNYXRoID0gQm94MkQuQ29tbW9uLk1hdGguYjJNYXRoLFxyXG4gICAgICBiMlN3ZWVwID0gQm94MkQuQ29tbW9uLk1hdGguYjJTd2VlcCxcclxuICAgICAgYjJUcmFuc2Zvcm0gPSBCb3gyRC5Db21tb24uTWF0aC5iMlRyYW5zZm9ybSxcclxuICAgICAgYjJWZWMyID0gQm94MkQuQ29tbW9uLk1hdGguYjJWZWMyLFxyXG4gICAgICBiMlZlYzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzMsXHJcbiAgICAgIGIyQ29sb3IgPSBCb3gyRC5Db21tb24uYjJDb2xvcixcclxuICAgICAgYjJpbnRlcm5hbCA9IEJveDJELkNvbW1vbi5iMmludGVybmFsLFxyXG4gICAgICBiMlNldHRpbmdzID0gQm94MkQuQ29tbW9uLmIyU2V0dGluZ3MsXHJcbiAgICAgIGIyQ2lyY2xlU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyQ2lyY2xlU2hhcGUsXHJcbiAgICAgIGIyRWRnZUNoYWluRGVmID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMkVkZ2VDaGFpbkRlZixcclxuICAgICAgYjJFZGdlU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyRWRnZVNoYXBlLFxyXG4gICAgICBiMk1hc3NEYXRhID0gQm94MkQuQ29sbGlzaW9uLlNoYXBlcy5iMk1hc3NEYXRhLFxyXG4gICAgICBiMlBvbHlnb25TaGFwZSA9IEJveDJELkNvbGxpc2lvbi5TaGFwZXMuYjJQb2x5Z29uU2hhcGUsXHJcbiAgICAgIGIyU2hhcGUgPSBCb3gyRC5Db2xsaXNpb24uU2hhcGVzLmIyU2hhcGUsXHJcbiAgICAgIGIyQnVveWFuY3lDb250cm9sbGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJCdW95YW5jeUNvbnRyb2xsZXIsXHJcbiAgICAgIGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnN0YW50QWNjZWxDb250cm9sbGVyLFxyXG4gICAgICBiMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb25zdGFudEZvcmNlQ29udHJvbGxlcixcclxuICAgICAgYjJDb250cm9sbGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLFxyXG4gICAgICBiMkNvbnRyb2xsZXJFZGdlID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyRWRnZSxcclxuICAgICAgYjJHcmF2aXR5Q29udHJvbGxlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyR3Jhdml0eUNvbnRyb2xsZXIsXHJcbiAgICAgIGIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMlRlbnNvckRhbXBpbmdDb250cm9sbGVyO1xyXG5cclxuICAgQm94MkQuaW5oZXJpdChiMkJ1b3lhbmN5Q29udHJvbGxlciwgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyKTtcclxuICAgYjJCdW95YW5jeUNvbnRyb2xsZXIucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIucHJvdG90eXBlO1xyXG4gICBiMkJ1b3lhbmN5Q29udHJvbGxlci5iMkJ1b3lhbmN5Q29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLmIyQ29udHJvbGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLm5vcm1hbCA9IG5ldyBiMlZlYzIoMCwgKC0xKSk7XHJcbiAgICAgIHRoaXMub2Zmc2V0ID0gMDtcclxuICAgICAgdGhpcy5kZW5zaXR5ID0gMDtcclxuICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBiMlZlYzIoMCwgMCk7XHJcbiAgICAgIHRoaXMubGluZWFyRHJhZyA9IDI7XHJcbiAgICAgIHRoaXMuYW5ndWxhckRyYWcgPSAxO1xyXG4gICAgICB0aGlzLnVzZURlbnNpdHkgPSBmYWxzZTtcclxuICAgICAgdGhpcy51c2VXb3JsZEdyYXZpdHkgPSB0cnVlO1xyXG4gICAgICB0aGlzLmdyYXZpdHkgPSBudWxsO1xyXG4gICB9O1xyXG4gICBiMkJ1b3lhbmN5Q29udHJvbGxlci5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIGlmICghdGhpcy5tX2JvZHlMaXN0KSByZXR1cm47XHJcbiAgICAgIGlmICh0aGlzLnVzZVdvcmxkR3Jhdml0eSkge1xyXG4gICAgICAgICB0aGlzLmdyYXZpdHkgPSB0aGlzLkdldFdvcmxkKCkuR2V0R3Jhdml0eSgpLkNvcHkoKTtcclxuICAgICAgfVxyXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy5tX2JvZHlMaXN0OyBpOyBpID0gaS5uZXh0Qm9keSkge1xyXG4gICAgICAgICB2YXIgYm9keSA9IGkuYm9keTtcclxuICAgICAgICAgaWYgKGJvZHkuSXNBd2FrZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciBhcmVhYyA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgICAgdmFyIG1hc3NjID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICAgICB2YXIgYXJlYSA9IDAuMDtcclxuICAgICAgICAgdmFyIG1hc3MgPSAwLjA7XHJcbiAgICAgICAgIGZvciAodmFyIGZpeHR1cmUgPSBib2R5LkdldEZpeHR1cmVMaXN0KCk7IGZpeHR1cmU7IGZpeHR1cmUgPSBmaXh0dXJlLkdldE5leHQoKSkge1xyXG4gICAgICAgICAgICB2YXIgc2MgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgICAgICAgIHZhciBzYXJlYSA9IGZpeHR1cmUuR2V0U2hhcGUoKS5Db21wdXRlU3VibWVyZ2VkQXJlYSh0aGlzLm5vcm1hbCwgdGhpcy5vZmZzZXQsIGJvZHkuR2V0VHJhbnNmb3JtKCksIHNjKTtcclxuICAgICAgICAgICAgYXJlYSArPSBzYXJlYTtcclxuICAgICAgICAgICAgYXJlYWMueCArPSBzYXJlYSAqIHNjLng7XHJcbiAgICAgICAgICAgIGFyZWFjLnkgKz0gc2FyZWEgKiBzYy55O1xyXG4gICAgICAgICAgICB2YXIgc2hhcGVEZW5zaXR5ID0gMDtcclxuICAgICAgICAgICAgaWYgKHRoaXMudXNlRGVuc2l0eSkge1xyXG4gICAgICAgICAgICAgICBzaGFwZURlbnNpdHkgPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICBzaGFwZURlbnNpdHkgPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG1hc3MgKz0gc2FyZWEgKiBzaGFwZURlbnNpdHk7XHJcbiAgICAgICAgICAgIG1hc3NjLnggKz0gc2FyZWEgKiBzYy54ICogc2hhcGVEZW5zaXR5O1xyXG4gICAgICAgICAgICBtYXNzYy55ICs9IHNhcmVhICogc2MueSAqIHNoYXBlRGVuc2l0eTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBhcmVhYy54IC89IGFyZWE7XHJcbiAgICAgICAgIGFyZWFjLnkgLz0gYXJlYTtcclxuICAgICAgICAgbWFzc2MueCAvPSBtYXNzO1xyXG4gICAgICAgICBtYXNzYy55IC89IG1hc3M7XHJcbiAgICAgICAgIGlmIChhcmVhIDwgTnVtYmVyLk1JTl9WQUxVRSkgY29udGludWU7XHJcbiAgICAgICAgIHZhciBidW95YW5jeUZvcmNlID0gdGhpcy5ncmF2aXR5LkdldE5lZ2F0aXZlKCk7XHJcbiAgICAgICAgIGJ1b3lhbmN5Rm9yY2UuTXVsdGlwbHkodGhpcy5kZW5zaXR5ICogYXJlYSk7XHJcbiAgICAgICAgIGJvZHkuQXBwbHlGb3JjZShidW95YW5jeUZvcmNlLCBtYXNzYyk7XHJcbiAgICAgICAgIHZhciBkcmFnRm9yY2UgPSBib2R5LkdldExpbmVhclZlbG9jaXR5RnJvbVdvcmxkUG9pbnQoYXJlYWMpO1xyXG4gICAgICAgICBkcmFnRm9yY2UuU3VidHJhY3QodGhpcy52ZWxvY2l0eSk7XHJcbiAgICAgICAgIGRyYWdGb3JjZS5NdWx0aXBseSgoLXRoaXMubGluZWFyRHJhZyAqIGFyZWEpKTtcclxuICAgICAgICAgYm9keS5BcHBseUZvcmNlKGRyYWdGb3JjZSwgYXJlYWMpO1xyXG4gICAgICAgICBib2R5LkFwcGx5VG9ycXVlKCgtYm9keS5HZXRJbmVydGlhKCkgLyBib2R5LkdldE1hc3MoKSAqIGFyZWEgKiBib2R5LkdldEFuZ3VsYXJWZWxvY2l0eSgpICogdGhpcy5hbmd1bGFyRHJhZykpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJCdW95YW5jeUNvbnRyb2xsZXIucHJvdG90eXBlLkRyYXcgPSBmdW5jdGlvbiAoZGVidWdEcmF3KSB7XHJcbiAgICAgIHZhciByID0gMTAwMDtcclxuICAgICAgdmFyIHAxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB2YXIgcDIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHAxLnggPSB0aGlzLm5vcm1hbC54ICogdGhpcy5vZmZzZXQgKyB0aGlzLm5vcm1hbC55ICogcjtcclxuICAgICAgcDEueSA9IHRoaXMubm9ybWFsLnkgKiB0aGlzLm9mZnNldCAtIHRoaXMubm9ybWFsLnggKiByO1xyXG4gICAgICBwMi54ID0gdGhpcy5ub3JtYWwueCAqIHRoaXMub2Zmc2V0IC0gdGhpcy5ub3JtYWwueSAqIHI7XHJcbiAgICAgIHAyLnkgPSB0aGlzLm5vcm1hbC55ICogdGhpcy5vZmZzZXQgKyB0aGlzLm5vcm1hbC54ICogcjtcclxuICAgICAgdmFyIGNvbG9yID0gbmV3IGIyQ29sb3IoMCwgMCwgMSk7XHJcbiAgICAgIGRlYnVnRHJhdy5EcmF3U2VnbWVudChwMSwgcDIsIGNvbG9yKTtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIsIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcik7XHJcbiAgIGIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIucHJvdG90eXBlO1xyXG4gICBiMkNvbnN0YW50QWNjZWxDb250cm9sbGVyLmIyQ29uc3RhbnRBY2NlbENvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5BID0gbmV3IGIyVmVjMigwLCAwKTtcclxuICAgfTtcclxuICAgYjJDb25zdGFudEFjY2VsQ29udHJvbGxlci5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciBzbWFsbEEgPSBuZXcgYjJWZWMyKHRoaXMuQS54ICogc3RlcC5kdCwgdGhpcy5BLnkgKiBzdGVwLmR0KTtcclxuICAgICAgZm9yICh2YXIgaSA9IHRoaXMubV9ib2R5TGlzdDsgaTsgaSA9IGkubmV4dEJvZHkpIHtcclxuICAgICAgICAgdmFyIGJvZHkgPSBpLmJvZHk7XHJcbiAgICAgICAgIGlmICghYm9keS5Jc0F3YWtlKCkpIGNvbnRpbnVlO1xyXG4gICAgICAgICBib2R5LlNldExpbmVhclZlbG9jaXR5KG5ldyBiMlZlYzIoYm9keS5HZXRMaW5lYXJWZWxvY2l0eSgpLnggKyBzbWFsbEEueCwgYm9keS5HZXRMaW5lYXJWZWxvY2l0eSgpLnkgKyBzbWFsbEEueSkpO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgQm94MkQuaW5oZXJpdChiMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyLCBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIpO1xyXG4gICBiMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLnByb3RvdHlwZTtcclxuICAgYjJDb25zdGFudEZvcmNlQ29udHJvbGxlci5iMkNvbnN0YW50Rm9yY2VDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIuYjJDb250cm9sbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMuRiA9IG5ldyBiMlZlYzIoMCwgMCk7XHJcbiAgIH07XHJcbiAgIGIyQ29uc3RhbnRGb3JjZUNvbnRyb2xsZXIucHJvdG90eXBlLlN0ZXAgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy5tX2JvZHlMaXN0OyBpOyBpID0gaS5uZXh0Qm9keSkge1xyXG4gICAgICAgICB2YXIgYm9keSA9IGkuYm9keTtcclxuICAgICAgICAgaWYgKCFib2R5LklzQXdha2UoKSkgY29udGludWU7XHJcbiAgICAgICAgIGJvZHkuQXBwbHlGb3JjZSh0aGlzLkYsIGJvZHkuR2V0V29ybGRDZW50ZXIoKSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkNvbnRyb2xsZXIuYjJDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge307XHJcbiAgIGIyQ29udHJvbGxlci5wcm90b3R5cGUuU3RlcCA9IGZ1bmN0aW9uIChzdGVwKSB7fVxyXG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLkRyYXcgPSBmdW5jdGlvbiAoZGVidWdEcmF3KSB7fVxyXG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLkFkZEJvZHkgPSBmdW5jdGlvbiAoYm9keSkge1xyXG4gICAgICB2YXIgZWRnZSA9IG5ldyBiMkNvbnRyb2xsZXJFZGdlKCk7XHJcbiAgICAgIGVkZ2UuY29udHJvbGxlciA9IHRoaXM7XHJcbiAgICAgIGVkZ2UuYm9keSA9IGJvZHk7XHJcbiAgICAgIGVkZ2UubmV4dEJvZHkgPSB0aGlzLm1fYm9keUxpc3Q7XHJcbiAgICAgIGVkZ2UucHJldkJvZHkgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fYm9keUxpc3QgPSBlZGdlO1xyXG4gICAgICBpZiAoZWRnZS5uZXh0Qm9keSkgZWRnZS5uZXh0Qm9keS5wcmV2Qm9keSA9IGVkZ2U7XHJcbiAgICAgIHRoaXMubV9ib2R5Q291bnQrKztcclxuICAgICAgZWRnZS5uZXh0Q29udHJvbGxlciA9IGJvZHkubV9jb250cm9sbGVyTGlzdDtcclxuICAgICAgZWRnZS5wcmV2Q29udHJvbGxlciA9IG51bGw7XHJcbiAgICAgIGJvZHkubV9jb250cm9sbGVyTGlzdCA9IGVkZ2U7XHJcbiAgICAgIGlmIChlZGdlLm5leHRDb250cm9sbGVyKSBlZGdlLm5leHRDb250cm9sbGVyLnByZXZDb250cm9sbGVyID0gZWRnZTtcclxuICAgICAgYm9keS5tX2NvbnRyb2xsZXJDb3VudCsrO1xyXG4gICB9XHJcbiAgIGIyQ29udHJvbGxlci5wcm90b3R5cGUuUmVtb3ZlQm9keSA9IGZ1bmN0aW9uIChib2R5KSB7XHJcbiAgICAgIHZhciBlZGdlID0gYm9keS5tX2NvbnRyb2xsZXJMaXN0O1xyXG4gICAgICB3aGlsZSAoZWRnZSAmJiBlZGdlLmNvbnRyb2xsZXIgIT0gdGhpcylcclxuICAgICAgZWRnZSA9IGVkZ2UubmV4dENvbnRyb2xsZXI7XHJcbiAgICAgIGlmIChlZGdlLnByZXZCb2R5KSBlZGdlLnByZXZCb2R5Lm5leHRCb2R5ID0gZWRnZS5uZXh0Qm9keTtcclxuICAgICAgaWYgKGVkZ2UubmV4dEJvZHkpIGVkZ2UubmV4dEJvZHkucHJldkJvZHkgPSBlZGdlLnByZXZCb2R5O1xyXG4gICAgICBpZiAoZWRnZS5uZXh0Q29udHJvbGxlcikgZWRnZS5uZXh0Q29udHJvbGxlci5wcmV2Q29udHJvbGxlciA9IGVkZ2UucHJldkNvbnRyb2xsZXI7XHJcbiAgICAgIGlmIChlZGdlLnByZXZDb250cm9sbGVyKSBlZGdlLnByZXZDb250cm9sbGVyLm5leHRDb250cm9sbGVyID0gZWRnZS5uZXh0Q29udHJvbGxlcjtcclxuICAgICAgaWYgKHRoaXMubV9ib2R5TGlzdCA9PSBlZGdlKSB0aGlzLm1fYm9keUxpc3QgPSBlZGdlLm5leHRCb2R5O1xyXG4gICAgICBpZiAoYm9keS5tX2NvbnRyb2xsZXJMaXN0ID09IGVkZ2UpIGJvZHkubV9jb250cm9sbGVyTGlzdCA9IGVkZ2UubmV4dENvbnRyb2xsZXI7XHJcbiAgICAgIGJvZHkubV9jb250cm9sbGVyQ291bnQtLTtcclxuICAgICAgdGhpcy5tX2JvZHlDb3VudC0tO1xyXG4gICB9XHJcbiAgIGIyQ29udHJvbGxlci5wcm90b3R5cGUuQ2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHdoaWxlICh0aGlzLm1fYm9keUxpc3QpXHJcbiAgICAgIHRoaXMuUmVtb3ZlQm9keSh0aGlzLm1fYm9keUxpc3QuYm9keSk7XHJcbiAgIH1cclxuICAgYjJDb250cm9sbGVyLnByb3RvdHlwZS5HZXROZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX25leHQ7XHJcbiAgIH1cclxuICAgYjJDb250cm9sbGVyLnByb3RvdHlwZS5HZXRXb3JsZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV93b3JsZDtcclxuICAgfVxyXG4gICBiMkNvbnRyb2xsZXIucHJvdG90eXBlLkdldEJvZHlMaXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlMaXN0O1xyXG4gICB9XHJcbiAgIGIyQ29udHJvbGxlckVkZ2UuYjJDb250cm9sbGVyRWRnZSA9IGZ1bmN0aW9uICgpIHt9O1xyXG4gICBCb3gyRC5pbmhlcml0KGIyR3Jhdml0eUNvbnRyb2xsZXIsIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlcik7XHJcbiAgIGIyR3Jhdml0eUNvbnRyb2xsZXIucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Db250cm9sbGVycy5iMkNvbnRyb2xsZXIucHJvdG90eXBlO1xyXG4gICBiMkdyYXZpdHlDb250cm9sbGVyLmIyR3Jhdml0eUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5iMkNvbnRyb2xsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5HID0gMTtcclxuICAgICAgdGhpcy5pbnZTcXIgPSB0cnVlO1xyXG4gICB9O1xyXG4gICBiMkdyYXZpdHlDb250cm9sbGVyLnByb3RvdHlwZS5TdGVwID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGkgPSBudWxsO1xyXG4gICAgICB2YXIgYm9keTEgPSBudWxsO1xyXG4gICAgICB2YXIgcDEgPSBudWxsO1xyXG4gICAgICB2YXIgbWFzczEgPSAwO1xyXG4gICAgICB2YXIgaiA9IG51bGw7XHJcbiAgICAgIHZhciBib2R5MiA9IG51bGw7XHJcbiAgICAgIHZhciBwMiA9IG51bGw7XHJcbiAgICAgIHZhciBkeCA9IDA7XHJcbiAgICAgIHZhciBkeSA9IDA7XHJcbiAgICAgIHZhciByMiA9IDA7XHJcbiAgICAgIHZhciBmID0gbnVsbDtcclxuICAgICAgaWYgKHRoaXMuaW52U3FyKSB7XHJcbiAgICAgICAgIGZvciAoaSA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgICAgaTsgaSA9IGkubmV4dEJvZHkpIHtcclxuICAgICAgICAgICAgYm9keTEgPSBpLmJvZHk7XHJcbiAgICAgICAgICAgIHAxID0gYm9keTEuR2V0V29ybGRDZW50ZXIoKTtcclxuICAgICAgICAgICAgbWFzczEgPSBib2R5MS5HZXRNYXNzKCk7XHJcbiAgICAgICAgICAgIGZvciAoaiA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgICAgICAgaiAhPSBpOyBqID0gai5uZXh0Qm9keSkge1xyXG4gICAgICAgICAgICAgICBib2R5MiA9IGouYm9keTtcclxuICAgICAgICAgICAgICAgcDIgPSBib2R5Mi5HZXRXb3JsZENlbnRlcigpO1xyXG4gICAgICAgICAgICAgICBkeCA9IHAyLnggLSBwMS54O1xyXG4gICAgICAgICAgICAgICBkeSA9IHAyLnkgLSBwMS55O1xyXG4gICAgICAgICAgICAgICByMiA9IGR4ICogZHggKyBkeSAqIGR5O1xyXG4gICAgICAgICAgICAgICBpZiAocjIgPCBOdW1iZXIuTUlOX1ZBTFVFKSBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgZiA9IG5ldyBiMlZlYzIoZHgsIGR5KTtcclxuICAgICAgICAgICAgICAgZi5NdWx0aXBseSh0aGlzLkcgLyByMiAvIE1hdGguc3FydChyMikgKiBtYXNzMSAqIGJvZHkyLkdldE1hc3MoKSk7XHJcbiAgICAgICAgICAgICAgIGlmIChib2R5MS5Jc0F3YWtlKCkpIGJvZHkxLkFwcGx5Rm9yY2UoZiwgcDEpO1xyXG4gICAgICAgICAgICAgICBmLk11bHRpcGx5KCgtMSkpO1xyXG4gICAgICAgICAgICAgICBpZiAoYm9keTIuSXNBd2FrZSgpKSBib2R5Mi5BcHBseUZvcmNlKGYsIHAyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIGZvciAoaSA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgICAgaTsgaSA9IGkubmV4dEJvZHkpIHtcclxuICAgICAgICAgICAgYm9keTEgPSBpLmJvZHk7XHJcbiAgICAgICAgICAgIHAxID0gYm9keTEuR2V0V29ybGRDZW50ZXIoKTtcclxuICAgICAgICAgICAgbWFzczEgPSBib2R5MS5HZXRNYXNzKCk7XHJcbiAgICAgICAgICAgIGZvciAoaiA9IHRoaXMubV9ib2R5TGlzdDtcclxuICAgICAgICAgICAgaiAhPSBpOyBqID0gai5uZXh0Qm9keSkge1xyXG4gICAgICAgICAgICAgICBib2R5MiA9IGouYm9keTtcclxuICAgICAgICAgICAgICAgcDIgPSBib2R5Mi5HZXRXb3JsZENlbnRlcigpO1xyXG4gICAgICAgICAgICAgICBkeCA9IHAyLnggLSBwMS54O1xyXG4gICAgICAgICAgICAgICBkeSA9IHAyLnkgLSBwMS55O1xyXG4gICAgICAgICAgICAgICByMiA9IGR4ICogZHggKyBkeSAqIGR5O1xyXG4gICAgICAgICAgICAgICBpZiAocjIgPCBOdW1iZXIuTUlOX1ZBTFVFKSBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgZiA9IG5ldyBiMlZlYzIoZHgsIGR5KTtcclxuICAgICAgICAgICAgICAgZi5NdWx0aXBseSh0aGlzLkcgLyByMiAqIG1hc3MxICogYm9keTIuR2V0TWFzcygpKTtcclxuICAgICAgICAgICAgICAgaWYgKGJvZHkxLklzQXdha2UoKSkgYm9keTEuQXBwbHlGb3JjZShmLCBwMSk7XHJcbiAgICAgICAgICAgICAgIGYuTXVsdGlwbHkoKC0xKSk7XHJcbiAgICAgICAgICAgICAgIGlmIChib2R5Mi5Jc0F3YWtlKCkpIGJvZHkyLkFwcGx5Rm9yY2UoZiwgcDIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlciwgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyKTtcclxuICAgYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlci5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkNvbnRyb2xsZXJzLmIyQ29udHJvbGxlci5wcm90b3R5cGU7XHJcbiAgIGIyVGVuc29yRGFtcGluZ0NvbnRyb2xsZXIuYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuQ29udHJvbGxlcnMuYjJDb250cm9sbGVyLmIyQ29udHJvbGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLlQgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICB0aGlzLm1heFRpbWVzdGVwID0gMDtcclxuICAgfTtcclxuICAgYjJUZW5zb3JEYW1waW5nQ29udHJvbGxlci5wcm90b3R5cGUuU2V0QXhpc0FsaWduZWQgPSBmdW5jdGlvbiAoeERhbXBpbmcsIHlEYW1waW5nKSB7XHJcbiAgICAgIGlmICh4RGFtcGluZyA9PT0gdW5kZWZpbmVkKSB4RGFtcGluZyA9IDA7XHJcbiAgICAgIGlmICh5RGFtcGluZyA9PT0gdW5kZWZpbmVkKSB5RGFtcGluZyA9IDA7XHJcbiAgICAgIHRoaXMuVC5jb2wxLnggPSAoLXhEYW1waW5nKTtcclxuICAgICAgdGhpcy5ULmNvbDEueSA9IDA7XHJcbiAgICAgIHRoaXMuVC5jb2wyLnggPSAwO1xyXG4gICAgICB0aGlzLlQuY29sMi55ID0gKC15RGFtcGluZyk7XHJcbiAgICAgIGlmICh4RGFtcGluZyA+IDAgfHwgeURhbXBpbmcgPiAwKSB7XHJcbiAgICAgICAgIHRoaXMubWF4VGltZXN0ZXAgPSAxIC8gTWF0aC5tYXgoeERhbXBpbmcsIHlEYW1waW5nKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tYXhUaW1lc3RlcCA9IDA7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlRlbnNvckRhbXBpbmdDb250cm9sbGVyLnByb3RvdHlwZS5TdGVwID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIHRpbWVzdGVwID0gc3RlcC5kdDtcclxuICAgICAgaWYgKHRpbWVzdGVwIDw9IE51bWJlci5NSU5fVkFMVUUpIHJldHVybjtcclxuICAgICAgaWYgKHRpbWVzdGVwID4gdGhpcy5tYXhUaW1lc3RlcCAmJiB0aGlzLm1heFRpbWVzdGVwID4gMCkgdGltZXN0ZXAgPSB0aGlzLm1heFRpbWVzdGVwO1xyXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy5tX2JvZHlMaXN0OyBpOyBpID0gaS5uZXh0Qm9keSkge1xyXG4gICAgICAgICB2YXIgYm9keSA9IGkuYm9keTtcclxuICAgICAgICAgaWYgKCFib2R5LklzQXdha2UoKSkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICB2YXIgZGFtcGluZyA9IGJvZHkuR2V0V29ybGRWZWN0b3IoYjJNYXRoLk11bE1WKHRoaXMuVCwgYm9keS5HZXRMb2NhbFZlY3Rvcihib2R5LkdldExpbmVhclZlbG9jaXR5KCkpKSk7XHJcbiAgICAgICAgIGJvZHkuU2V0TGluZWFyVmVsb2NpdHkobmV3IGIyVmVjMihib2R5LkdldExpbmVhclZlbG9jaXR5KCkueCArIGRhbXBpbmcueCAqIHRpbWVzdGVwLCBib2R5LkdldExpbmVhclZlbG9jaXR5KCkueSArIGRhbXBpbmcueSAqIHRpbWVzdGVwKSk7XHJcbiAgICAgIH1cclxuICAgfVxyXG59KSgpO1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICB2YXIgYjJDb2xvciA9IEJveDJELkNvbW1vbi5iMkNvbG9yLFxyXG4gICAgICBiMmludGVybmFsID0gQm94MkQuQ29tbW9uLmIyaW50ZXJuYWwsXHJcbiAgICAgIGIyU2V0dGluZ3MgPSBCb3gyRC5Db21tb24uYjJTZXR0aW5ncyxcclxuICAgICAgYjJNYXQyMiA9IEJveDJELkNvbW1vbi5NYXRoLmIyTWF0MjIsXHJcbiAgICAgIGIyTWF0MzMgPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdDMzLFxyXG4gICAgICBiMk1hdGggPSBCb3gyRC5Db21tb24uTWF0aC5iMk1hdGgsXHJcbiAgICAgIGIyU3dlZXAgPSBCb3gyRC5Db21tb24uTWF0aC5iMlN3ZWVwLFxyXG4gICAgICBiMlRyYW5zZm9ybSA9IEJveDJELkNvbW1vbi5NYXRoLmIyVHJhbnNmb3JtLFxyXG4gICAgICBiMlZlYzIgPSBCb3gyRC5Db21tb24uTWF0aC5iMlZlYzIsXHJcbiAgICAgIGIyVmVjMyA9IEJveDJELkNvbW1vbi5NYXRoLmIyVmVjMyxcclxuICAgICAgYjJEaXN0YW5jZUpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRGlzdGFuY2VKb2ludCxcclxuICAgICAgYjJEaXN0YW5jZUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRGlzdGFuY2VKb2ludERlZixcclxuICAgICAgYjJGcmljdGlvbkpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRnJpY3Rpb25Kb2ludCxcclxuICAgICAgYjJGcmljdGlvbkpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyRnJpY3Rpb25Kb2ludERlZixcclxuICAgICAgYjJHZWFySm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJHZWFySm9pbnQsXHJcbiAgICAgIGIyR2VhckpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyR2VhckpvaW50RGVmLFxyXG4gICAgICBiMkphY29iaWFuID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySmFjb2JpYW4sXHJcbiAgICAgIGIySm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCxcclxuICAgICAgYjJKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLFxyXG4gICAgICBiMkpvaW50RWRnZSA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RWRnZSxcclxuICAgICAgYjJMaW5lSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJMaW5lSm9pbnQsXHJcbiAgICAgIGIyTGluZUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyTGluZUpvaW50RGVmLFxyXG4gICAgICBiMk1vdXNlSm9pbnQgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJNb3VzZUpvaW50LFxyXG4gICAgICBiMk1vdXNlSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJNb3VzZUpvaW50RGVmLFxyXG4gICAgICBiMlByaXNtYXRpY0pvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHJpc21hdGljSm9pbnQsXHJcbiAgICAgIGIyUHJpc21hdGljSm9pbnREZWYgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQcmlzbWF0aWNKb2ludERlZixcclxuICAgICAgYjJQdWxsZXlKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlB1bGxleUpvaW50LFxyXG4gICAgICBiMlB1bGxleUpvaW50RGVmID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUHVsbGV5Sm9pbnREZWYsXHJcbiAgICAgIGIyUmV2b2x1dGVKb2ludCA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlJldm9sdXRlSm9pbnQsXHJcbiAgICAgIGIyUmV2b2x1dGVKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMlJldm9sdXRlSm9pbnREZWYsXHJcbiAgICAgIGIyV2VsZEpvaW50ID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyV2VsZEpvaW50LFxyXG4gICAgICBiMldlbGRKb2ludERlZiA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMldlbGRKb2ludERlZixcclxuICAgICAgYjJCb2R5ID0gQm94MkQuRHluYW1pY3MuYjJCb2R5LFxyXG4gICAgICBiMkJvZHlEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkJvZHlEZWYsXHJcbiAgICAgIGIyQ29udGFjdEZpbHRlciA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEZpbHRlcixcclxuICAgICAgYjJDb250YWN0SW1wdWxzZSA9IEJveDJELkR5bmFtaWNzLmIyQ29udGFjdEltcHVsc2UsXHJcbiAgICAgIGIyQ29udGFjdExpc3RlbmVyID0gQm94MkQuRHluYW1pY3MuYjJDb250YWN0TGlzdGVuZXIsXHJcbiAgICAgIGIyQ29udGFjdE1hbmFnZXIgPSBCb3gyRC5EeW5hbWljcy5iMkNvbnRhY3RNYW5hZ2VyLFxyXG4gICAgICBiMkRlYnVnRHJhdyA9IEJveDJELkR5bmFtaWNzLmIyRGVidWdEcmF3LFxyXG4gICAgICBiMkRlc3RydWN0aW9uTGlzdGVuZXIgPSBCb3gyRC5EeW5hbWljcy5iMkRlc3RydWN0aW9uTGlzdGVuZXIsXHJcbiAgICAgIGIyRmlsdGVyRGF0YSA9IEJveDJELkR5bmFtaWNzLmIyRmlsdGVyRGF0YSxcclxuICAgICAgYjJGaXh0dXJlID0gQm94MkQuRHluYW1pY3MuYjJGaXh0dXJlLFxyXG4gICAgICBiMkZpeHR1cmVEZWYgPSBCb3gyRC5EeW5hbWljcy5iMkZpeHR1cmVEZWYsXHJcbiAgICAgIGIySXNsYW5kID0gQm94MkQuRHluYW1pY3MuYjJJc2xhbmQsXHJcbiAgICAgIGIyVGltZVN0ZXAgPSBCb3gyRC5EeW5hbWljcy5iMlRpbWVTdGVwLFxyXG4gICAgICBiMldvcmxkID0gQm94MkQuRHluYW1pY3MuYjJXb3JsZDtcclxuXHJcbiAgIEJveDJELmluaGVyaXQoYjJEaXN0YW5jZUpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XHJcbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LnByb3RvdHlwZTtcclxuICAgYjJEaXN0YW5jZUpvaW50LmIyRGlzdGFuY2VKb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fdSA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JBID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMSk7XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3UueCwgaW52X2R0ICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fdS55KTtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiAwLjA7XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5HZXRMZW5ndGggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbGVuZ3RoO1xyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuU2V0TGVuZ3RoID0gZnVuY3Rpb24gKGxlbmd0aCkge1xyXG4gICAgICBpZiAobGVuZ3RoID09PSB1bmRlZmluZWQpIGxlbmd0aCA9IDA7XHJcbiAgICAgIHRoaXMubV9sZW5ndGggPSBsZW5ndGg7XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5HZXRGcmVxdWVuY3kgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZnJlcXVlbmN5SHo7XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5TZXRGcmVxdWVuY3kgPSBmdW5jdGlvbiAoaHopIHtcclxuICAgICAgaWYgKGh6ID09PSB1bmRlZmluZWQpIGh6ID0gMDtcclxuICAgICAgdGhpcy5tX2ZyZXF1ZW5jeUh6ID0gaHo7XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5HZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZGFtcGluZ1JhdGlvO1xyXG4gICB9XHJcbiAgIGIyRGlzdGFuY2VKb2ludC5wcm90b3R5cGUuU2V0RGFtcGluZ1JhdGlvID0gZnVuY3Rpb24gKHJhdGlvKSB7XHJcbiAgICAgIGlmIChyYXRpbyA9PT0gdW5kZWZpbmVkKSByYXRpbyA9IDA7XHJcbiAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSByYXRpbztcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLmIyRGlzdGFuY2VKb2ludCA9IGZ1bmN0aW9uIChkZWYpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnQuY2FsbCh0aGlzLCBkZWYpO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIHRZID0gMDtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMS5TZXRWKGRlZi5sb2NhbEFuY2hvckEpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyLlNldFYoZGVmLmxvY2FsQW5jaG9yQik7XHJcbiAgICAgIHRoaXMubV9sZW5ndGggPSBkZWYubGVuZ3RoO1xyXG4gICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBkZWYuZnJlcXVlbmN5SHo7XHJcbiAgICAgIHRoaXMubV9kYW1waW5nUmF0aW8gPSBkZWYuZGFtcGluZ1JhdGlvO1xyXG4gICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2dhbW1hID0gMC4wO1xyXG4gICAgICB0aGlzLm1fYmlhcyA9IDAuMDtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICByMVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgcjJYID0gdFg7XHJcbiAgICAgIHRoaXMubV91LnggPSBiQi5tX3N3ZWVwLmMueCArIHIyWCAtIGJBLm1fc3dlZXAuYy54IC0gcjFYO1xyXG4gICAgICB0aGlzLm1fdS55ID0gYkIubV9zd2VlcC5jLnkgKyByMlkgLSBiQS5tX3N3ZWVwLmMueSAtIHIxWTtcclxuICAgICAgdmFyIGxlbmd0aCA9IE1hdGguc3FydCh0aGlzLm1fdS54ICogdGhpcy5tX3UueCArIHRoaXMubV91LnkgKiB0aGlzLm1fdS55KTtcclxuICAgICAgaWYgKGxlbmd0aCA+IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xyXG4gICAgICAgICB0aGlzLm1fdS5NdWx0aXBseSgxLjAgLyBsZW5ndGgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fdS5TZXRaZXJvKCk7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGNyMXUgPSAocjFYICogdGhpcy5tX3UueSAtIHIxWSAqIHRoaXMubV91LngpO1xyXG4gICAgICB2YXIgY3IydSA9IChyMlggKiB0aGlzLm1fdS55IC0gcjJZICogdGhpcy5tX3UueCk7XHJcbiAgICAgIHZhciBpbnZNYXNzID0gYkEubV9pbnZNYXNzICsgYkEubV9pbnZJICogY3IxdSAqIGNyMXUgKyBiQi5tX2ludk1hc3MgKyBiQi5tX2ludkkgKiBjcjJ1ICogY3IydTtcclxuICAgICAgdGhpcy5tX21hc3MgPSBpbnZNYXNzICE9IDAuMCA/IDEuMCAvIGludk1hc3MgOiAwLjA7XHJcbiAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwLjApIHtcclxuICAgICAgICAgdmFyIEMgPSBsZW5ndGggLSB0aGlzLm1fbGVuZ3RoO1xyXG4gICAgICAgICB2YXIgb21lZ2EgPSAyLjAgKiBNYXRoLlBJICogdGhpcy5tX2ZyZXF1ZW5jeUh6O1xyXG4gICAgICAgICB2YXIgZCA9IDIuMCAqIHRoaXMubV9tYXNzICogdGhpcy5tX2RhbXBpbmdSYXRpbyAqIG9tZWdhO1xyXG4gICAgICAgICB2YXIgayA9IHRoaXMubV9tYXNzICogb21lZ2EgKiBvbWVnYTtcclxuICAgICAgICAgdGhpcy5tX2dhbW1hID0gc3RlcC5kdCAqIChkICsgc3RlcC5kdCAqIGspO1xyXG4gICAgICAgICB0aGlzLm1fZ2FtbWEgPSB0aGlzLm1fZ2FtbWEgIT0gMC4wID8gMSAvIHRoaXMubV9nYW1tYSA6IDAuMDtcclxuICAgICAgICAgdGhpcy5tX2JpYXMgPSBDICogc3RlcC5kdCAqIGsgKiB0aGlzLm1fZ2FtbWE7XHJcbiAgICAgICAgIHRoaXMubV9tYXNzID0gaW52TWFzcyArIHRoaXMubV9nYW1tYTtcclxuICAgICAgICAgdGhpcy5tX21hc3MgPSB0aGlzLm1fbWFzcyAhPSAwLjAgPyAxLjAgLyB0aGlzLm1fbWFzcyA6IDAuMDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB2YXIgUFggPSB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV91Lng7XHJcbiAgICAgICAgIHZhciBQWSA9IHRoaXMubV9pbXB1bHNlICogdGhpcy5tX3UueTtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54IC09IGJBLm1faW52TWFzcyAqIFBYO1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgLT0gYkEubV9pbnZNYXNzICogUFk7XHJcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5IC09IGJBLm1faW52SSAqIChyMVggKiBQWSAtIHIxWSAqIFBYKTtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IGJCLm1faW52TWFzcyAqIFBYO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkIubV9pbnZNYXNzICogUFk7XHJcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJCLm1faW52SSAqIChyMlggKiBQWSAtIHIyWSAqIFBYKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnQucHJvdG90eXBlLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdmFyIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgIHIxWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICByMlggPSB0WDtcclxuICAgICAgdmFyIHYxWCA9IGJBLm1fbGluZWFyVmVsb2NpdHkueCArICgoLWJBLm1fYW5ndWxhclZlbG9jaXR5ICogcjFZKSk7XHJcbiAgICAgIHZhciB2MVkgPSBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKyAoYkEubV9hbmd1bGFyVmVsb2NpdHkgKiByMVgpO1xyXG4gICAgICB2YXIgdjJYID0gYkIubV9saW5lYXJWZWxvY2l0eS54ICsgKCgtYkIubV9hbmd1bGFyVmVsb2NpdHkgKiByMlkpKTtcclxuICAgICAgdmFyIHYyWSA9IGJCLm1fbGluZWFyVmVsb2NpdHkueSArIChiQi5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIyWCk7XHJcbiAgICAgIHZhciBDZG90ID0gKHRoaXMubV91LnggKiAodjJYIC0gdjFYKSArIHRoaXMubV91LnkgKiAodjJZIC0gdjFZKSk7XHJcbiAgICAgIHZhciBpbXB1bHNlID0gKC10aGlzLm1fbWFzcyAqIChDZG90ICsgdGhpcy5tX2JpYXMgKyB0aGlzLm1fZ2FtbWEgKiB0aGlzLm1faW1wdWxzZSkpO1xyXG4gICAgICB0aGlzLm1faW1wdWxzZSArPSBpbXB1bHNlO1xyXG4gICAgICB2YXIgUFggPSBpbXB1bHNlICogdGhpcy5tX3UueDtcclxuICAgICAgdmFyIFBZID0gaW1wdWxzZSAqIHRoaXMubV91Lnk7XHJcbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCAtPSBiQS5tX2ludk1hc3MgKiBQWDtcclxuICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55IC09IGJBLm1faW52TWFzcyAqIFBZO1xyXG4gICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSAtPSBiQS5tX2ludkkgKiAocjFYICogUFkgLSByMVkgKiBQWCk7XHJcbiAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQi5tX2ludk1hc3MgKiBQWDtcclxuICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IGJCLm1faW52TWFzcyAqIFBZO1xyXG4gICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiQi5tX2ludkkgKiAocjJYICogUFkgLSByMlkgKiBQWCk7XHJcbiAgIH1cclxuICAgYjJEaXN0YW5jZUpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XHJcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIGlmICh0aGlzLm1fZnJlcXVlbmN5SHogPiAwLjApIHtcclxuICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHZhciB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICByMVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgcjJYID0gdFg7XHJcbiAgICAgIHZhciBkWCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYIC0gYkEubV9zd2VlcC5jLnggLSByMVg7XHJcbiAgICAgIHZhciBkWSA9IGJCLm1fc3dlZXAuYy55ICsgcjJZIC0gYkEubV9zd2VlcC5jLnkgLSByMVk7XHJcbiAgICAgIHZhciBsZW5ndGggPSBNYXRoLnNxcnQoZFggKiBkWCArIGRZICogZFkpO1xyXG4gICAgICBkWCAvPSBsZW5ndGg7XHJcbiAgICAgIGRZIC89IGxlbmd0aDtcclxuICAgICAgdmFyIEMgPSBsZW5ndGggLSB0aGlzLm1fbGVuZ3RoO1xyXG4gICAgICBDID0gYjJNYXRoLkNsYW1wKEMsICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKTtcclxuICAgICAgdmFyIGltcHVsc2UgPSAoLXRoaXMubV9tYXNzICogQyk7XHJcbiAgICAgIHRoaXMubV91LlNldChkWCwgZFkpO1xyXG4gICAgICB2YXIgUFggPSBpbXB1bHNlICogdGhpcy5tX3UueDtcclxuICAgICAgdmFyIFBZID0gaW1wdWxzZSAqIHRoaXMubV91Lnk7XHJcbiAgICAgIGJBLm1fc3dlZXAuYy54IC09IGJBLm1faW52TWFzcyAqIFBYO1xyXG4gICAgICBiQS5tX3N3ZWVwLmMueSAtPSBiQS5tX2ludk1hc3MgKiBQWTtcclxuICAgICAgYkEubV9zd2VlcC5hIC09IGJBLm1faW52SSAqIChyMVggKiBQWSAtIHIxWSAqIFBYKTtcclxuICAgICAgYkIubV9zd2VlcC5jLnggKz0gYkIubV9pbnZNYXNzICogUFg7XHJcbiAgICAgIGJCLm1fc3dlZXAuYy55ICs9IGJCLm1faW52TWFzcyAqIFBZO1xyXG4gICAgICBiQi5tX3N3ZWVwLmEgKz0gYkIubV9pbnZJICogKHIyWCAqIFBZIC0gcjJZICogUFgpO1xyXG4gICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICByZXR1cm4gYjJNYXRoLkFicyhDKSA8IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyRGlzdGFuY2VKb2ludERlZiwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYpO1xyXG4gICBiMkRpc3RhbmNlSm9pbnREZWYucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5wcm90b3R5cGU7XHJcbiAgIGIyRGlzdGFuY2VKb2ludERlZi5iMkRpc3RhbmNlSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLmIySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkRpc3RhbmNlSm9pbnREZWYucHJvdG90eXBlLmIyRGlzdGFuY2VKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnREZWYuY2FsbCh0aGlzKTtcclxuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX2Rpc3RhbmNlSm9pbnQ7XHJcbiAgICAgIHRoaXMubGVuZ3RoID0gMS4wO1xyXG4gICAgICB0aGlzLmZyZXF1ZW5jeUh6ID0gMC4wO1xyXG4gICAgICB0aGlzLmRhbXBpbmdSYXRpbyA9IDAuMDtcclxuICAgfVxyXG4gICBiMkRpc3RhbmNlSm9pbnREZWYucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoYkEsIGJCLCBhbmNob3JBLCBhbmNob3JCKSB7XHJcbiAgICAgIHRoaXMuYm9keUEgPSBiQTtcclxuICAgICAgdGhpcy5ib2R5QiA9IGJCO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQS5TZXRWKHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3JBKSk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCLlNldFYodGhpcy5ib2R5Qi5HZXRMb2NhbFBvaW50KGFuY2hvckIpKTtcclxuICAgICAgdmFyIGRYID0gYW5jaG9yQi54IC0gYW5jaG9yQS54O1xyXG4gICAgICB2YXIgZFkgPSBhbmNob3JCLnkgLSBhbmNob3JBLnk7XHJcbiAgICAgIHRoaXMubGVuZ3RoID0gTWF0aC5zcXJ0KGRYICogZFggKyBkWSAqIGRZKTtcclxuICAgICAgdGhpcy5mcmVxdWVuY3lIeiA9IDAuMDtcclxuICAgICAgdGhpcy5kYW1waW5nUmF0aW8gPSAwLjA7XHJcbiAgIH1cclxuICAgQm94MkQuaW5oZXJpdChiMkZyaWN0aW9uSm9pbnQsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50KTtcclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xyXG4gICBiMkZyaWN0aW9uSm9pbnQuYjJGcmljdGlvbkpvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9saW5lYXJNYXNzID0gbmV3IGIyTWF0MjIoKTtcclxuICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyRnJpY3Rpb25Kb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckEpO1xyXG4gICB9XHJcbiAgIGIyRnJpY3Rpb25Kb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvckIpO1xyXG4gICB9XHJcbiAgIGIyRnJpY3Rpb25Kb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiB0aGlzLm1fbGluZWFySW1wdWxzZS54LCBpbnZfZHQgKiB0aGlzLm1fbGluZWFySW1wdWxzZS55KTtcclxuICAgfVxyXG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1fYW5ndWxhckltcHVsc2U7XHJcbiAgIH1cclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5TZXRNYXhGb3JjZSA9IGZ1bmN0aW9uIChmb3JjZSkge1xyXG4gICAgICBpZiAoZm9yY2UgPT09IHVuZGVmaW5lZCkgZm9yY2UgPSAwO1xyXG4gICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBmb3JjZTtcclxuICAgfVxyXG4gICBiMkZyaWN0aW9uSm9pbnQucHJvdG90eXBlLkdldE1heEZvcmNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX21heEZvcmNlO1xyXG4gICB9XHJcbiAgIGIyRnJpY3Rpb25Kb2ludC5wcm90b3R5cGUuU2V0TWF4VG9ycXVlID0gZnVuY3Rpb24gKHRvcnF1ZSkge1xyXG4gICAgICBpZiAodG9ycXVlID09PSB1bmRlZmluZWQpIHRvcnF1ZSA9IDA7XHJcbiAgICAgIHRoaXMubV9tYXhUb3JxdWUgPSB0b3JxdWU7XHJcbiAgIH1cclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5HZXRNYXhUb3JxdWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbWF4VG9ycXVlO1xyXG4gICB9XHJcbiAgIGIyRnJpY3Rpb25Kb2ludC5wcm90b3R5cGUuYjJGcmljdGlvbkpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuU2V0VihkZWYubG9jYWxBbmNob3JBKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5TZXRWKGRlZi5sb2NhbEFuY2hvckIpO1xyXG4gICAgICB0aGlzLm1fbGluZWFyTWFzcy5TZXRaZXJvKCk7XHJcbiAgICAgIHRoaXMubV9hbmd1bGFyTWFzcyA9IDAuMDtcclxuICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuU2V0WmVybygpO1xyXG4gICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9tYXhGb3JjZSA9IGRlZi5tYXhGb3JjZTtcclxuICAgICAgdGhpcy5tX21heFRvcnF1ZSA9IGRlZi5tYXhUb3JxdWU7XHJcbiAgIH1cclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHJBWCA9IHRoaXMubV9sb2NhbEFuY2hvckEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJBWSA9IHRoaXMubV9sb2NhbEFuY2hvckEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQVggKyB0TWF0LmNvbDIueCAqIHJBWSk7XHJcbiAgICAgIHJBWSA9ICh0TWF0LmNvbDEueSAqIHJBWCArIHRNYXQuY29sMi55ICogckFZKTtcclxuICAgICAgckFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgIHZhciByQlggPSB0aGlzLm1fbG9jYWxBbmNob3JCLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByQlkgPSB0aGlzLm1fbG9jYWxBbmNob3JCLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogckJYICsgdE1hdC5jb2wyLnggKiByQlkpO1xyXG4gICAgICByQlkgPSAodE1hdC5jb2wxLnkgKiByQlggKyB0TWF0LmNvbDIueSAqIHJCWSk7XHJcbiAgICAgIHJCWCA9IHRYO1xyXG4gICAgICB2YXIgbUEgPSBiQS5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBtQiA9IGJCLm1faW52TWFzcztcclxuICAgICAgdmFyIGlBID0gYkEubV9pbnZJO1xyXG4gICAgICB2YXIgaUIgPSBiQi5tX2ludkk7XHJcbiAgICAgIHZhciBLID0gbmV3IGIyTWF0MjIoKTtcclxuICAgICAgSy5jb2wxLnggPSBtQSArIG1CO1xyXG4gICAgICBLLmNvbDIueCA9IDAuMDtcclxuICAgICAgSy5jb2wxLnkgPSAwLjA7XHJcbiAgICAgIEsuY29sMi55ID0gbUEgKyBtQjtcclxuICAgICAgSy5jb2wxLnggKz0gaUEgKiByQVkgKiByQVk7XHJcbiAgICAgIEsuY29sMi54ICs9ICgtaUEgKiByQVggKiByQVkpO1xyXG4gICAgICBLLmNvbDEueSArPSAoLWlBICogckFYICogckFZKTtcclxuICAgICAgSy5jb2wyLnkgKz0gaUEgKiByQVggKiByQVg7XHJcbiAgICAgIEsuY29sMS54ICs9IGlCICogckJZICogckJZO1xyXG4gICAgICBLLmNvbDIueCArPSAoLWlCICogckJYICogckJZKTtcclxuICAgICAgSy5jb2wxLnkgKz0gKC1pQiAqIHJCWCAqIHJCWSk7XHJcbiAgICAgIEsuY29sMi55ICs9IGlCICogckJYICogckJYO1xyXG4gICAgICBLLkdldEludmVyc2UodGhpcy5tX2xpbmVhck1hc3MpO1xyXG4gICAgICB0aGlzLm1fYW5ndWxhck1hc3MgPSBpQSArIGlCO1xyXG4gICAgICBpZiAodGhpcy5tX2FuZ3VsYXJNYXNzID4gMC4wKSB7XHJcbiAgICAgICAgIHRoaXMubV9hbmd1bGFyTWFzcyA9IDEuMCAvIHRoaXMubV9hbmd1bGFyTWFzcztcclxuICAgICAgfVxyXG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcclxuICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UueCAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLnkgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB0aGlzLm1fYW5ndWxhckltcHVsc2UgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB2YXIgUCA9IHRoaXMubV9saW5lYXJJbXB1bHNlO1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggLT0gbUEgKiBQLng7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSAtPSBtQSAqIFAueTtcclxuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgLT0gaUEgKiAockFYICogUC55IC0gckFZICogUC54ICsgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlKTtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IG1CICogUC54O1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gbUIgKiBQLnk7XHJcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGlCICogKHJCWCAqIFAueSAtIHJCWSAqIFAueCArIHRoaXMubV9hbmd1bGFySW1wdWxzZSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLlNldFplcm8oKTtcclxuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gMC4wO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB2QSA9IGJBLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3QSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdkIgPSBiQi5tX2xpbmVhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgd0IgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIG1BID0gYkEubV9pbnZNYXNzO1xyXG4gICAgICB2YXIgbUIgPSBiQi5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBpQSA9IGJBLm1faW52STtcclxuICAgICAgdmFyIGlCID0gYkIubV9pbnZJO1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgckFYID0gdGhpcy5tX2xvY2FsQW5jaG9yQS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgckFZID0gdGhpcy5tX2xvY2FsQW5jaG9yQS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHJBWCArIHRNYXQuY29sMi54ICogckFZKTtcclxuICAgICAgckFZID0gKHRNYXQuY29sMS55ICogckFYICsgdE1hdC5jb2wyLnkgKiByQVkpO1xyXG4gICAgICByQVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHJCWCA9IHRoaXMubV9sb2NhbEFuY2hvckIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJCWSA9IHRoaXMubV9sb2NhbEFuY2hvckIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQlggKyB0TWF0LmNvbDIueCAqIHJCWSk7XHJcbiAgICAgIHJCWSA9ICh0TWF0LmNvbDEueSAqIHJCWCArIHRNYXQuY29sMi55ICogckJZKTtcclxuICAgICAgckJYID0gdFg7XHJcbiAgICAgIHZhciBtYXhJbXB1bHNlID0gMDsge1xyXG4gICAgICAgICB2YXIgQ2RvdCA9IHdCIC0gd0E7XHJcbiAgICAgICAgIHZhciBpbXB1bHNlID0gKC10aGlzLm1fYW5ndWxhck1hc3MgKiBDZG90KTtcclxuICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fYW5ndWxhckltcHVsc2U7XHJcbiAgICAgICAgIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heFRvcnF1ZTtcclxuICAgICAgICAgdGhpcy5tX2FuZ3VsYXJJbXB1bHNlID0gYjJNYXRoLkNsYW1wKHRoaXMubV9hbmd1bGFySW1wdWxzZSArIGltcHVsc2UsICgtbWF4SW1wdWxzZSksIG1heEltcHVsc2UpO1xyXG4gICAgICAgICBpbXB1bHNlID0gdGhpcy5tX2FuZ3VsYXJJbXB1bHNlIC0gb2xkSW1wdWxzZTtcclxuICAgICAgICAgd0EgLT0gaUEgKiBpbXB1bHNlO1xyXG4gICAgICAgICB3QiArPSBpQiAqIGltcHVsc2U7XHJcbiAgICAgIH0ge1xyXG4gICAgICAgICB2YXIgQ2RvdFggPSB2Qi54IC0gd0IgKiByQlkgLSB2QS54ICsgd0EgKiByQVk7XHJcbiAgICAgICAgIHZhciBDZG90WSA9IHZCLnkgKyB3QiAqIHJCWCAtIHZBLnkgLSB3QSAqIHJBWDtcclxuICAgICAgICAgdmFyIGltcHVsc2VWID0gYjJNYXRoLk11bE1WKHRoaXMubV9saW5lYXJNYXNzLCBuZXcgYjJWZWMyKCgtQ2RvdFgpLCAoLUNkb3RZKSkpO1xyXG4gICAgICAgICB2YXIgb2xkSW1wdWxzZVYgPSB0aGlzLm1fbGluZWFySW1wdWxzZS5Db3B5KCk7XHJcbiAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLkFkZChpbXB1bHNlVik7XHJcbiAgICAgICAgIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heEZvcmNlO1xyXG4gICAgICAgICBpZiAodGhpcy5tX2xpbmVhckltcHVsc2UuTGVuZ3RoU3F1YXJlZCgpID4gbWF4SW1wdWxzZSAqIG1heEltcHVsc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tX2xpbmVhckltcHVsc2UuTm9ybWFsaXplKCk7XHJcbiAgICAgICAgICAgIHRoaXMubV9saW5lYXJJbXB1bHNlLk11bHRpcGx5KG1heEltcHVsc2UpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGltcHVsc2VWID0gYjJNYXRoLlN1YnRyYWN0VlYodGhpcy5tX2xpbmVhckltcHVsc2UsIG9sZEltcHVsc2VWKTtcclxuICAgICAgICAgdkEueCAtPSBtQSAqIGltcHVsc2VWLng7XHJcbiAgICAgICAgIHZBLnkgLT0gbUEgKiBpbXB1bHNlVi55O1xyXG4gICAgICAgICB3QSAtPSBpQSAqIChyQVggKiBpbXB1bHNlVi55IC0gckFZICogaW1wdWxzZVYueCk7XHJcbiAgICAgICAgIHZCLnggKz0gbUIgKiBpbXB1bHNlVi54O1xyXG4gICAgICAgICB2Qi55ICs9IG1CICogaW1wdWxzZVYueTtcclxuICAgICAgICAgd0IgKz0gaUIgKiAockJYICogaW1wdWxzZVYueSAtIHJCWSAqIGltcHVsc2VWLngpO1xyXG4gICAgICB9XHJcbiAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ID0gd0E7XHJcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ID0gd0I7XHJcbiAgIH1cclxuICAgYjJGcmljdGlvbkpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XHJcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgQm94MkQuaW5oZXJpdChiMkZyaWN0aW9uSm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcclxuICAgYjJGcmljdGlvbkpvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xyXG4gICBiMkZyaWN0aW9uSm9pbnREZWYuYjJGcmljdGlvbkpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJGcmljdGlvbkpvaW50RGVmLnByb3RvdHlwZS5iMkZyaWN0aW9uSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9mcmljdGlvbkpvaW50O1xyXG4gICAgICB0aGlzLm1heEZvcmNlID0gMC4wO1xyXG4gICAgICB0aGlzLm1heFRvcnF1ZSA9IDAuMDtcclxuICAgfVxyXG4gICBiMkZyaWN0aW9uSm9pbnREZWYucHJvdG90eXBlLkluaXRpYWxpemUgPSBmdW5jdGlvbiAoYkEsIGJCLCBhbmNob3IpIHtcclxuICAgICAgdGhpcy5ib2R5QSA9IGJBO1xyXG4gICAgICB0aGlzLmJvZHlCID0gYkI7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBLlNldFYodGhpcy5ib2R5QS5HZXRMb2NhbFBvaW50KGFuY2hvcikpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQi5TZXRWKHRoaXMuYm9keUIuR2V0TG9jYWxQb2ludChhbmNob3IpKTtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyR2VhckpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XHJcbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQucHJvdG90eXBlO1xyXG4gICBiMkdlYXJKb2ludC5iMkdlYXJKb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9KID0gbmV3IGIySmFjb2JpYW4oKTtcclxuICAgfTtcclxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcclxuICAgfVxyXG4gICBiMkdlYXJKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xyXG4gICB9XHJcbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0oubGluZWFyQi54LCBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueSk7XHJcbiAgIH1cclxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHZhciB0TWF0ID0gdGhpcy5tX2JvZHlCLm1feGYuUjtcclxuICAgICAgdmFyIHJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gdGhpcy5tX2JvZHlCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdmFyIHRYID0gdE1hdC5jb2wxLnggKiByWCArIHRNYXQuY29sMi54ICogclk7XHJcbiAgICAgIHJZID0gdE1hdC5jb2wxLnkgKiByWCArIHRNYXQuY29sMi55ICogclk7XHJcbiAgICAgIHJYID0gdFg7XHJcbiAgICAgIHZhciBQWCA9IHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0oubGluZWFyQi54O1xyXG4gICAgICB2YXIgUFkgPSB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueTtcclxuICAgICAgcmV0dXJuIGludl9kdCAqICh0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmFuZ3VsYXJCIC0gclggKiBQWSArIHJZICogUFgpO1xyXG4gICB9XHJcbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5HZXRSYXRpbyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9yYXRpbztcclxuICAgfVxyXG4gICBiMkdlYXJKb2ludC5wcm90b3R5cGUuU2V0UmF0aW8gPSBmdW5jdGlvbiAocmF0aW8pIHtcclxuICAgICAgaWYgKHJhdGlvID09PSB1bmRlZmluZWQpIHJhdGlvID0gMDtcclxuICAgICAgdGhpcy5tX3JhdGlvID0gcmF0aW87XHJcbiAgIH1cclxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLmIyR2VhckpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XHJcbiAgICAgIHZhciB0eXBlMSA9IHBhcnNlSW50KGRlZi5qb2ludDEubV90eXBlKTtcclxuICAgICAgdmFyIHR5cGUyID0gcGFyc2VJbnQoZGVmLmpvaW50Mi5tX3R5cGUpO1xyXG4gICAgICB0aGlzLm1fcmV2b2x1dGUxID0gbnVsbDtcclxuICAgICAgdGhpcy5tX3ByaXNtYXRpYzEgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fcmV2b2x1dGUyID0gbnVsbDtcclxuICAgICAgdGhpcy5tX3ByaXNtYXRpYzIgPSBudWxsO1xyXG4gICAgICB2YXIgY29vcmRpbmF0ZTEgPSAwO1xyXG4gICAgICB2YXIgY29vcmRpbmF0ZTIgPSAwO1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kMSA9IGRlZi5qb2ludDEuR2V0Qm9keUEoKTtcclxuICAgICAgdGhpcy5tX2JvZHlBID0gZGVmLmpvaW50MS5HZXRCb2R5QigpO1xyXG4gICAgICBpZiAodHlwZTEgPT0gYjJKb2ludC5lX3Jldm9sdXRlSm9pbnQpIHtcclxuICAgICAgICAgdGhpcy5tX3Jldm9sdXRlMSA9IChkZWYuam9pbnQxIGluc3RhbmNlb2YgYjJSZXZvbHV0ZUpvaW50ID8gZGVmLmpvaW50MSA6IG51bGwpO1xyXG4gICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMS5TZXRWKHRoaXMubV9yZXZvbHV0ZTEubV9sb2NhbEFuY2hvcjEpO1xyXG4gICAgICAgICB0aGlzLm1fbG9jYWxBbmNob3IxLlNldFYodGhpcy5tX3Jldm9sdXRlMS5tX2xvY2FsQW5jaG9yMik7XHJcbiAgICAgICAgIGNvb3JkaW5hdGUxID0gdGhpcy5tX3Jldm9sdXRlMS5HZXRKb2ludEFuZ2xlKCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9wcmlzbWF0aWMxID0gKGRlZi5qb2ludDEgaW5zdGFuY2VvZiBiMlByaXNtYXRpY0pvaW50ID8gZGVmLmpvaW50MSA6IG51bGwpO1xyXG4gICAgICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMS5TZXRWKHRoaXMubV9wcmlzbWF0aWMxLm1fbG9jYWxBbmNob3IxKTtcclxuICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMS5TZXRWKHRoaXMubV9wcmlzbWF0aWMxLm1fbG9jYWxBbmNob3IyKTtcclxuICAgICAgICAgY29vcmRpbmF0ZTEgPSB0aGlzLm1fcHJpc21hdGljMS5HZXRKb2ludFRyYW5zbGF0aW9uKCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5tX2dyb3VuZDIgPSBkZWYuam9pbnQyLkdldEJvZHlBKCk7XHJcbiAgICAgIHRoaXMubV9ib2R5QiA9IGRlZi5qb2ludDIuR2V0Qm9keUIoKTtcclxuICAgICAgaWYgKHR5cGUyID09IGIySm9pbnQuZV9yZXZvbHV0ZUpvaW50KSB7XHJcbiAgICAgICAgIHRoaXMubV9yZXZvbHV0ZTIgPSAoZGVmLmpvaW50MiBpbnN0YW5jZW9mIGIyUmV2b2x1dGVKb2ludCA/IGRlZi5qb2ludDIgOiBudWxsKTtcclxuICAgICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjIuU2V0Vih0aGlzLm1fcmV2b2x1dGUyLm1fbG9jYWxBbmNob3IxKTtcclxuICAgICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMi5TZXRWKHRoaXMubV9yZXZvbHV0ZTIubV9sb2NhbEFuY2hvcjIpO1xyXG4gICAgICAgICBjb29yZGluYXRlMiA9IHRoaXMubV9yZXZvbHV0ZTIuR2V0Sm9pbnRBbmdsZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fcHJpc21hdGljMiA9IChkZWYuam9pbnQyIGluc3RhbmNlb2YgYjJQcmlzbWF0aWNKb2ludCA/IGRlZi5qb2ludDIgOiBudWxsKTtcclxuICAgICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjIuU2V0Vih0aGlzLm1fcHJpc21hdGljMi5tX2xvY2FsQW5jaG9yMSk7XHJcbiAgICAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIuU2V0Vih0aGlzLm1fcHJpc21hdGljMi5tX2xvY2FsQW5jaG9yMik7XHJcbiAgICAgICAgIGNvb3JkaW5hdGUyID0gdGhpcy5tX3ByaXNtYXRpYzIuR2V0Sm9pbnRUcmFuc2xhdGlvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9yYXRpbyA9IGRlZi5yYXRpbztcclxuICAgICAgdGhpcy5tX2NvbnN0YW50ID0gY29vcmRpbmF0ZTEgKyB0aGlzLm1fcmF0aW8gKiBjb29yZGluYXRlMjtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwLjA7XHJcbiAgIH1cclxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGcxID0gdGhpcy5tX2dyb3VuZDE7XHJcbiAgICAgIHZhciBnMiA9IHRoaXMubV9ncm91bmQyO1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHVnWCA9IDA7XHJcbiAgICAgIHZhciB1Z1kgPSAwO1xyXG4gICAgICB2YXIgclggPSAwO1xyXG4gICAgICB2YXIgclkgPSAwO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRWZWM7XHJcbiAgICAgIHZhciBjcnVnID0gMDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIEsgPSAwLjA7XHJcbiAgICAgIHRoaXMubV9KLlNldFplcm8oKTtcclxuICAgICAgaWYgKHRoaXMubV9yZXZvbHV0ZTEpIHtcclxuICAgICAgICAgdGhpcy5tX0ouYW5ndWxhckEgPSAoLTEuMCk7XHJcbiAgICAgICAgIEsgKz0gYkEubV9pbnZJO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0TWF0ID0gZzEubV94Zi5SO1xyXG4gICAgICAgICB0VmVjID0gdGhpcy5tX3ByaXNtYXRpYzEubV9sb2NhbFhBeGlzMTtcclxuICAgICAgICAgdWdYID0gdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgdWdZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgICAgclggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgICAgIHJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICAgICB0WCA9IHRNYXQuY29sMS54ICogclggKyB0TWF0LmNvbDIueCAqIHJZO1xyXG4gICAgICAgICByWSA9IHRNYXQuY29sMS55ICogclggKyB0TWF0LmNvbDIueSAqIHJZO1xyXG4gICAgICAgICByWCA9IHRYO1xyXG4gICAgICAgICBjcnVnID0gclggKiB1Z1kgLSByWSAqIHVnWDtcclxuICAgICAgICAgdGhpcy5tX0oubGluZWFyQS5TZXQoKC11Z1gpLCAoLXVnWSkpO1xyXG4gICAgICAgICB0aGlzLm1fSi5hbmd1bGFyQSA9ICgtY3J1Zyk7XHJcbiAgICAgICAgIEsgKz0gYkEubV9pbnZNYXNzICsgYkEubV9pbnZJICogY3J1ZyAqIGNydWc7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubV9yZXZvbHV0ZTIpIHtcclxuICAgICAgICAgdGhpcy5tX0ouYW5ndWxhckIgPSAoLXRoaXMubV9yYXRpbyk7XHJcbiAgICAgICAgIEsgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogYkIubV9pbnZJO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0TWF0ID0gZzIubV94Zi5SO1xyXG4gICAgICAgICB0VmVjID0gdGhpcy5tX3ByaXNtYXRpYzIubV9sb2NhbFhBeGlzMTtcclxuICAgICAgICAgdWdYID0gdE1hdC5jb2wxLnggKiB0VmVjLnggKyB0TWF0LmNvbDIueCAqIHRWZWMueTtcclxuICAgICAgICAgdWdZID0gdE1hdC5jb2wxLnkgKiB0VmVjLnggKyB0TWF0LmNvbDIueSAqIHRWZWMueTtcclxuICAgICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgICAgclggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgICAgIHJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICAgICB0WCA9IHRNYXQuY29sMS54ICogclggKyB0TWF0LmNvbDIueCAqIHJZO1xyXG4gICAgICAgICByWSA9IHRNYXQuY29sMS55ICogclggKyB0TWF0LmNvbDIueSAqIHJZO1xyXG4gICAgICAgICByWCA9IHRYO1xyXG4gICAgICAgICBjcnVnID0gclggKiB1Z1kgLSByWSAqIHVnWDtcclxuICAgICAgICAgdGhpcy5tX0oubGluZWFyQi5TZXQoKC10aGlzLm1fcmF0aW8gKiB1Z1gpLCAoLXRoaXMubV9yYXRpbyAqIHVnWSkpO1xyXG4gICAgICAgICB0aGlzLm1fSi5hbmd1bGFyQiA9ICgtdGhpcy5tX3JhdGlvICogY3J1Zyk7XHJcbiAgICAgICAgIEsgKz0gdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogKGJCLm1faW52TWFzcyArIGJCLm1faW52SSAqIGNydWcgKiBjcnVnKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fbWFzcyA9IEsgPiAwLjAgPyAxLjAgLyBLIDogMC4wO1xyXG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54ICs9IGJBLm1faW52TWFzcyAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0oubGluZWFyQS54O1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkEubV9pbnZNYXNzICogdGhpcy5tX2ltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJBLnk7XHJcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJBLm1faW52SSAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0ouYW5ndWxhckE7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQi5tX2ludk1hc3MgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckIueDtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IGJCLm1faW52TWFzcyAqIHRoaXMubV9pbXB1bHNlICogdGhpcy5tX0oubGluZWFyQi55O1xyXG4gICAgICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiQi5tX2ludkkgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV9KLmFuZ3VsYXJCO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZSA9IDAuMDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyR2VhckpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIENkb3QgPSB0aGlzLm1fSi5Db21wdXRlKGJBLm1fbGluZWFyVmVsb2NpdHksIGJBLm1fYW5ndWxhclZlbG9jaXR5LCBiQi5tX2xpbmVhclZlbG9jaXR5LCBiQi5tX2FuZ3VsYXJWZWxvY2l0eSk7XHJcbiAgICAgIHZhciBpbXB1bHNlID0gKC10aGlzLm1fbWFzcyAqIENkb3QpO1xyXG4gICAgICB0aGlzLm1faW1wdWxzZSArPSBpbXB1bHNlO1xyXG4gICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkEubV9pbnZNYXNzICogaW1wdWxzZSAqIHRoaXMubV9KLmxpbmVhckEueDtcclxuICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55ICs9IGJBLm1faW52TWFzcyAqIGltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJBLnk7XHJcbiAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJBLm1faW52SSAqIGltcHVsc2UgKiB0aGlzLm1fSi5hbmd1bGFyQTtcclxuICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IGJCLm1faW52TWFzcyAqIGltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLng7XHJcbiAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQi5tX2ludk1hc3MgKiBpbXB1bHNlICogdGhpcy5tX0oubGluZWFyQi55O1xyXG4gICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiQi5tX2ludkkgKiBpbXB1bHNlICogdGhpcy5tX0ouYW5ndWxhckI7XHJcbiAgIH1cclxuICAgYjJHZWFySm9pbnQucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcclxuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xyXG4gICAgICB2YXIgbGluZWFyRXJyb3IgPSAwLjA7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgY29vcmRpbmF0ZTEgPSAwO1xyXG4gICAgICB2YXIgY29vcmRpbmF0ZTIgPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX3Jldm9sdXRlMSkge1xyXG4gICAgICAgICBjb29yZGluYXRlMSA9IHRoaXMubV9yZXZvbHV0ZTEuR2V0Sm9pbnRBbmdsZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBjb29yZGluYXRlMSA9IHRoaXMubV9wcmlzbWF0aWMxLkdldEpvaW50VHJhbnNsYXRpb24oKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX3Jldm9sdXRlMikge1xyXG4gICAgICAgICBjb29yZGluYXRlMiA9IHRoaXMubV9yZXZvbHV0ZTIuR2V0Sm9pbnRBbmdsZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBjb29yZGluYXRlMiA9IHRoaXMubV9wcmlzbWF0aWMyLkdldEpvaW50VHJhbnNsYXRpb24oKTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgQyA9IHRoaXMubV9jb25zdGFudCAtIChjb29yZGluYXRlMSArIHRoaXMubV9yYXRpbyAqIGNvb3JkaW5hdGUyKTtcclxuICAgICAgdmFyIGltcHVsc2UgPSAoLXRoaXMubV9tYXNzICogQyk7XHJcbiAgICAgIGJBLm1fc3dlZXAuYy54ICs9IGJBLm1faW52TWFzcyAqIGltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJBLng7XHJcbiAgICAgIGJBLm1fc3dlZXAuYy55ICs9IGJBLm1faW52TWFzcyAqIGltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJBLnk7XHJcbiAgICAgIGJBLm1fc3dlZXAuYSArPSBiQS5tX2ludkkgKiBpbXB1bHNlICogdGhpcy5tX0ouYW5ndWxhckE7XHJcbiAgICAgIGJCLm1fc3dlZXAuYy54ICs9IGJCLm1faW52TWFzcyAqIGltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLng7XHJcbiAgICAgIGJCLm1fc3dlZXAuYy55ICs9IGJCLm1faW52TWFzcyAqIGltcHVsc2UgKiB0aGlzLm1fSi5saW5lYXJCLnk7XHJcbiAgICAgIGJCLm1fc3dlZXAuYSArPSBiQi5tX2ludkkgKiBpbXB1bHNlICogdGhpcy5tX0ouYW5ndWxhckI7XHJcbiAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIGJCLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIHJldHVybiBsaW5lYXJFcnJvciA8IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcDtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyR2VhckpvaW50RGVmLCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZik7XHJcbiAgIGIyR2VhckpvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xyXG4gICBiMkdlYXJKb2ludERlZi5iMkdlYXJKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICB9O1xyXG4gICBiMkdlYXJKb2ludERlZi5wcm90b3R5cGUuYjJHZWFySm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9nZWFySm9pbnQ7XHJcbiAgICAgIHRoaXMuam9pbnQxID0gbnVsbDtcclxuICAgICAgdGhpcy5qb2ludDIgPSBudWxsO1xyXG4gICAgICB0aGlzLnJhdGlvID0gMS4wO1xyXG4gICB9XHJcbiAgIGIySmFjb2JpYW4uYjJKYWNvYmlhbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5saW5lYXJBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxpbmVhckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIySmFjb2JpYW4ucHJvdG90eXBlLlNldFplcm8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubGluZWFyQS5TZXRaZXJvKCk7XHJcbiAgICAgIHRoaXMuYW5ndWxhckEgPSAwLjA7XHJcbiAgICAgIHRoaXMubGluZWFyQi5TZXRaZXJvKCk7XHJcbiAgICAgIHRoaXMuYW5ndWxhckIgPSAwLjA7XHJcbiAgIH1cclxuICAgYjJKYWNvYmlhbi5wcm90b3R5cGUuU2V0ID0gZnVuY3Rpb24gKHgxLCBhMSwgeDIsIGEyKSB7XHJcbiAgICAgIGlmIChhMSA9PT0gdW5kZWZpbmVkKSBhMSA9IDA7XHJcbiAgICAgIGlmIChhMiA9PT0gdW5kZWZpbmVkKSBhMiA9IDA7XHJcbiAgICAgIHRoaXMubGluZWFyQS5TZXRWKHgxKTtcclxuICAgICAgdGhpcy5hbmd1bGFyQSA9IGExO1xyXG4gICAgICB0aGlzLmxpbmVhckIuU2V0Vih4Mik7XHJcbiAgICAgIHRoaXMuYW5ndWxhckIgPSBhMjtcclxuICAgfVxyXG4gICBiMkphY29iaWFuLnByb3RvdHlwZS5Db21wdXRlID0gZnVuY3Rpb24gKHgxLCBhMSwgeDIsIGEyKSB7XHJcbiAgICAgIGlmIChhMSA9PT0gdW5kZWZpbmVkKSBhMSA9IDA7XHJcbiAgICAgIGlmIChhMiA9PT0gdW5kZWZpbmVkKSBhMiA9IDA7XHJcbiAgICAgIHJldHVybiAodGhpcy5saW5lYXJBLnggKiB4MS54ICsgdGhpcy5saW5lYXJBLnkgKiB4MS55KSArIHRoaXMuYW5ndWxhckEgKiBhMSArICh0aGlzLmxpbmVhckIueCAqIHgyLnggKyB0aGlzLmxpbmVhckIueSAqIHgyLnkpICsgdGhpcy5hbmd1bGFyQiAqIGEyO1xyXG4gICB9XHJcbiAgIGIySm9pbnQuYjJKb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5tX2VkZ2VBID0gbmV3IGIySm9pbnRFZGdlKCk7XHJcbiAgICAgIHRoaXMubV9lZGdlQiA9IG5ldyBiMkpvaW50RWRnZSgpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMkpvaW50LnByb3RvdHlwZS5HZXRUeXBlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3R5cGU7XHJcbiAgIH1cclxuICAgYjJKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgIH1cclxuICAgYjJKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgIH1cclxuICAgYjJKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgfVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gMC4wO1xyXG4gICB9XHJcbiAgIGIySm9pbnQucHJvdG90eXBlLkdldEJvZHlBID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBO1xyXG4gICB9XHJcbiAgIGIySm9pbnQucHJvdG90eXBlLkdldEJvZHlCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCO1xyXG4gICB9XHJcbiAgIGIySm9pbnQucHJvdG90eXBlLkdldE5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbmV4dDtcclxuICAgfVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5HZXRVc2VyRGF0YSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV91c2VyRGF0YTtcclxuICAgfVxyXG4gICBiMkpvaW50LnByb3RvdHlwZS5TZXRVc2VyRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgIHRoaXMubV91c2VyRGF0YSA9IGRhdGE7XHJcbiAgIH1cclxuICAgYjJKb2ludC5wcm90b3R5cGUuSXNBY3RpdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuSXNBY3RpdmUoKSAmJiB0aGlzLm1fYm9keUIuSXNBY3RpdmUoKTtcclxuICAgfVxyXG4gICBiMkpvaW50LkNyZWF0ZSA9IGZ1bmN0aW9uIChkZWYsIGFsbG9jYXRvcikge1xyXG4gICAgICB2YXIgam9pbnQgPSBudWxsO1xyXG4gICAgICBzd2l0Y2ggKGRlZi50eXBlKSB7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX2Rpc3RhbmNlSm9pbnQ6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgam9pbnQgPSBuZXcgYjJEaXN0YW5jZUpvaW50KChkZWYgaW5zdGFuY2VvZiBiMkRpc3RhbmNlSm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX21vdXNlSm9pbnQ6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgam9pbnQgPSBuZXcgYjJNb3VzZUpvaW50KChkZWYgaW5zdGFuY2VvZiBiMk1vdXNlSm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX3ByaXNtYXRpY0pvaW50OlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIGpvaW50ID0gbmV3IGIyUHJpc21hdGljSm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyUHJpc21hdGljSm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX3Jldm9sdXRlSm9pbnQ6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgam9pbnQgPSBuZXcgYjJSZXZvbHV0ZUpvaW50KChkZWYgaW5zdGFuY2VvZiBiMlJldm9sdXRlSm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX3B1bGxleUpvaW50OlxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgIGpvaW50ID0gbmV3IGIyUHVsbGV5Sm9pbnQoKGRlZiBpbnN0YW5jZW9mIGIyUHVsbGV5Sm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX2dlYXJKb2ludDpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMkdlYXJKb2ludCgoZGVmIGluc3RhbmNlb2YgYjJHZWFySm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX2xpbmVKb2ludDpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMkxpbmVKb2ludCgoZGVmIGluc3RhbmNlb2YgYjJMaW5lSm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX3dlbGRKb2ludDpcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICBqb2ludCA9IG5ldyBiMldlbGRKb2ludCgoZGVmIGluc3RhbmNlb2YgYjJXZWxkSm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgYjJKb2ludC5lX2ZyaWN0aW9uSm9pbnQ6XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgam9pbnQgPSBuZXcgYjJGcmljdGlvbkpvaW50KChkZWYgaW5zdGFuY2VvZiBiMkZyaWN0aW9uSm9pbnREZWYgPyBkZWYgOiBudWxsKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBqb2ludDtcclxuICAgfVxyXG4gICBiMkpvaW50LkRlc3Ryb3kgPSBmdW5jdGlvbiAoam9pbnQsIGFsbG9jYXRvcikge31cclxuICAgYjJKb2ludC5wcm90b3R5cGUuYjJKb2ludCA9IGZ1bmN0aW9uIChkZWYpIHtcclxuICAgICAgYjJTZXR0aW5ncy5iMkFzc2VydChkZWYuYm9keUEgIT0gZGVmLmJvZHlCKTtcclxuICAgICAgdGhpcy5tX3R5cGUgPSBkZWYudHlwZTtcclxuICAgICAgdGhpcy5tX3ByZXYgPSBudWxsO1xyXG4gICAgICB0aGlzLm1fbmV4dCA9IG51bGw7XHJcbiAgICAgIHRoaXMubV9ib2R5QSA9IGRlZi5ib2R5QTtcclxuICAgICAgdGhpcy5tX2JvZHlCID0gZGVmLmJvZHlCO1xyXG4gICAgICB0aGlzLm1fY29sbGlkZUNvbm5lY3RlZCA9IGRlZi5jb2xsaWRlQ29ubmVjdGVkO1xyXG4gICAgICB0aGlzLm1faXNsYW5kRmxhZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLm1fdXNlckRhdGEgPSBkZWYudXNlckRhdGE7XHJcbiAgIH1cclxuICAgYjJKb2ludC5wcm90b3R5cGUuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge31cclxuICAgYjJKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHt9XHJcbiAgIGIySm9pbnQucHJvdG90eXBlLkZpbmFsaXplVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uICgpIHt9XHJcbiAgIGIySm9pbnQucHJvdG90eXBlLlNvbHZlUG9zaXRpb25Db25zdHJhaW50cyA9IGZ1bmN0aW9uIChiYXVtZ2FydGUpIHtcclxuICAgICAgaWYgKGJhdW1nYXJ0ZSA9PT0gdW5kZWZpbmVkKSBiYXVtZ2FydGUgPSAwO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgIH1cclxuICAgQm94MkQucG9zdERlZnMucHVzaChmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfdW5rbm93bkpvaW50ID0gMDtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9yZXZvbHV0ZUpvaW50ID0gMTtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9wcmlzbWF0aWNKb2ludCA9IDI7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfZGlzdGFuY2VKb2ludCA9IDM7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfcHVsbGV5Sm9pbnQgPSA0O1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX21vdXNlSm9pbnQgPSA1O1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX2dlYXJKb2ludCA9IDY7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfbGluZUpvaW50ID0gNztcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV93ZWxkSm9pbnQgPSA4O1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX2ZyaWN0aW9uSm9pbnQgPSA5O1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX2luYWN0aXZlTGltaXQgPSAwO1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5lX2F0TG93ZXJMaW1pdCA9IDE7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmVfYXRVcHBlckxpbWl0ID0gMjtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuZV9lcXVhbExpbWl0cyA9IDM7XHJcbiAgIH0pO1xyXG4gICBiMkpvaW50RGVmLmIySm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgYjJKb2ludERlZi5wcm90b3R5cGUuYjJKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy50eXBlID0gYjJKb2ludC5lX3Vua25vd25Kb2ludDtcclxuICAgICAgdGhpcy51c2VyRGF0YSA9IG51bGw7XHJcbiAgICAgIHRoaXMuYm9keUEgPSBudWxsO1xyXG4gICAgICB0aGlzLmJvZHlCID0gbnVsbDtcclxuICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gZmFsc2U7XHJcbiAgIH1cclxuICAgYjJKb2ludEVkZ2UuYjJKb2ludEVkZ2UgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgQm94MkQuaW5oZXJpdChiMkxpbmVKb2ludCwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQpO1xyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LnByb3RvdHlwZTtcclxuICAgYjJMaW5lSm9pbnQuYjJMaW5lSm9pbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmIySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsWEF4aXMxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxZQXhpczEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9heGlzID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fcGVycCA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX0sgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICB0aGlzLm1faW1wdWxzZSA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqICh0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3BlcnAueCArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueSkgKiB0aGlzLm1fYXhpcy54KSwgaW52X2R0ICogKHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS55KSAqIHRoaXMubV9heGlzLnkpKTtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLnk7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldEpvaW50VHJhbnNsYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHAxID0gYkEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcclxuICAgICAgdmFyIHAyID0gYkIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IyKTtcclxuICAgICAgdmFyIGRYID0gcDIueCAtIHAxLng7XHJcbiAgICAgIHZhciBkWSA9IHAyLnkgLSBwMS55O1xyXG4gICAgICB2YXIgYXhpcyA9IGJBLkdldFdvcmxkVmVjdG9yKHRoaXMubV9sb2NhbFhBeGlzMSk7XHJcbiAgICAgIHZhciB0cmFuc2xhdGlvbiA9IGF4aXMueCAqIGRYICsgYXhpcy55ICogZFk7XHJcbiAgICAgIHJldHVybiB0cmFuc2xhdGlvbjtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0Sm9pbnRTcGVlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB2YXIgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgcjFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgIHIyWCA9IHRYO1xyXG4gICAgICB2YXIgcDFYID0gYkEubV9zd2VlcC5jLnggKyByMVg7XHJcbiAgICAgIHZhciBwMVkgPSBiQS5tX3N3ZWVwLmMueSArIHIxWTtcclxuICAgICAgdmFyIHAyWCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYO1xyXG4gICAgICB2YXIgcDJZID0gYkIubV9zd2VlcC5jLnkgKyByMlk7XHJcbiAgICAgIHZhciBkWCA9IHAyWCAtIHAxWDtcclxuICAgICAgdmFyIGRZID0gcDJZIC0gcDFZO1xyXG4gICAgICB2YXIgYXhpcyA9IGJBLkdldFdvcmxkVmVjdG9yKHRoaXMubV9sb2NhbFhBeGlzMSk7XHJcbiAgICAgIHZhciB2MSA9IGJBLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB2MiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3MSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdzIgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHNwZWVkID0gKGRYICogKCgtdzEgKiBheGlzLnkpKSArIGRZICogKHcxICogYXhpcy54KSkgKyAoYXhpcy54ICogKCgodjIueCArICgoLXcyICogcjJZKSkpIC0gdjEueCkgLSAoKC13MSAqIHIxWSkpKSArIGF4aXMueSAqICgoKHYyLnkgKyAodzIgKiByMlgpKSAtIHYxLnkpIC0gKHcxICogcjFYKSkpO1xyXG4gICAgICByZXR1cm4gc3BlZWQ7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLklzTGltaXRFbmFibGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZUxpbWl0O1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5FbmFibGVMaW1pdCA9IGZ1bmN0aW9uIChmbGFnKSB7XHJcbiAgICAgIHRoaXMubV9ib2R5QS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBmbGFnO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRMb3dlckxpbWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb247XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldFVwcGVyTGltaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbjtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuU2V0TGltaXRzID0gZnVuY3Rpb24gKGxvd2VyLCB1cHBlcikge1xyXG4gICAgICBpZiAobG93ZXIgPT09IHVuZGVmaW5lZCkgbG93ZXIgPSAwO1xyXG4gICAgICBpZiAodXBwZXIgPT09IHVuZGVmaW5lZCkgdXBwZXIgPSAwO1xyXG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gPSBsb3dlcjtcclxuICAgICAgdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSB1cHBlcjtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuSXNNb3RvckVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZW5hYmxlTW90b3I7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkVuYWJsZU1vdG9yID0gZnVuY3Rpb24gKGZsYWcpIHtcclxuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGZsYWc7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLlNldE1vdG9yU3BlZWQgPSBmdW5jdGlvbiAoc3BlZWQpIHtcclxuICAgICAgaWYgKHNwZWVkID09PSB1bmRlZmluZWQpIHNwZWVkID0gMDtcclxuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9tb3RvclNwZWVkID0gc3BlZWQ7XHJcbiAgIH1cclxuICAgYjJMaW5lSm9pbnQucHJvdG90eXBlLkdldE1vdG9yU3BlZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuU2V0TWF4TW90b3JGb3JjZSA9IGZ1bmN0aW9uIChmb3JjZSkge1xyXG4gICAgICBpZiAoZm9yY2UgPT09IHVuZGVmaW5lZCkgZm9yY2UgPSAwO1xyXG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX21heE1vdG9yRm9yY2UgPSBmb3JjZTtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuR2V0TWF4TW90b3JGb3JjZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9tYXhNb3RvckZvcmNlO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5HZXRNb3RvckZvcmNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX21vdG9ySW1wdWxzZTtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludC5wcm90b3R5cGUuYjJMaW5lSm9pbnQgPSBmdW5jdGlvbiAoZGVmKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50LmNhbGwodGhpcywgZGVmKTtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciB0WSA9IDA7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEuU2V0VihkZWYubG9jYWxBbmNob3JBKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMi5TZXRWKGRlZi5sb2NhbEFuY2hvckIpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxYQXhpczEuU2V0VihkZWYubG9jYWxBeGlzQSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbFlBeGlzMS54ID0gKC10aGlzLm1fbG9jYWxYQXhpczEueSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbFlBeGlzMS55ID0gdGhpcy5tX2xvY2FsWEF4aXMxLng7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDAuMDtcclxuICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gPSBkZWYubG93ZXJUcmFuc2xhdGlvbjtcclxuICAgICAgdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSBkZWYudXBwZXJUcmFuc2xhdGlvbjtcclxuICAgICAgdGhpcy5tX21heE1vdG9yRm9yY2UgPSBkZWYubWF4TW90b3JGb3JjZTtcclxuICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcclxuICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZGVmLmVuYWJsZUxpbWl0O1xyXG4gICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBkZWYuZW5hYmxlTW90b3I7XHJcbiAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XHJcbiAgICAgIHRoaXMubV9heGlzLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX3BlcnAuU2V0WmVybygpO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdGhpcy5tX2xvY2FsQ2VudGVyQS5TZXRWKGJBLkdldExvY2FsQ2VudGVyKCkpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxDZW50ZXJCLlNldFYoYkIuR2V0TG9jYWxDZW50ZXIoKSk7XHJcbiAgICAgIHZhciB4ZjEgPSBiQS5HZXRUcmFuc2Zvcm0oKTtcclxuICAgICAgdmFyIHhmMiA9IGJCLkdldFRyYW5zZm9ybSgpO1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gdGhpcy5tX2xvY2FsQ2VudGVyQS54O1xyXG4gICAgICB2YXIgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gdGhpcy5tX2xvY2FsQ2VudGVyQS55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICByMVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIHRoaXMubV9sb2NhbENlbnRlckIueDtcclxuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIHRoaXMubV9sb2NhbENlbnRlckIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgcjJYID0gdFg7XHJcbiAgICAgIHZhciBkWCA9IGJCLm1fc3dlZXAuYy54ICsgcjJYIC0gYkEubV9zd2VlcC5jLnggLSByMVg7XHJcbiAgICAgIHZhciBkWSA9IGJCLm1fc3dlZXAuYy55ICsgcjJZIC0gYkEubV9zd2VlcC5jLnkgLSByMVk7XHJcbiAgICAgIHRoaXMubV9pbnZNYXNzQSA9IGJBLm1faW52TWFzcztcclxuICAgICAgdGhpcy5tX2ludk1hc3NCID0gYkIubV9pbnZNYXNzO1xyXG4gICAgICB0aGlzLm1faW52SUEgPSBiQS5tX2ludkk7XHJcbiAgICAgIHRoaXMubV9pbnZJQiA9IGJCLm1faW52STsge1xyXG4gICAgICAgICB0aGlzLm1fYXhpcy5TZXRWKGIyTWF0aC5NdWxNVih4ZjEuUiwgdGhpcy5tX2xvY2FsWEF4aXMxKSk7XHJcbiAgICAgICAgIHRoaXMubV9hMSA9IChkWCArIHIxWCkgKiB0aGlzLm1fYXhpcy55IC0gKGRZICsgcjFZKSAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIHRoaXMubV9hMiA9IHIyWCAqIHRoaXMubV9heGlzLnkgLSByMlkgKiB0aGlzLm1fYXhpcy54O1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gdGhpcy5tX2ludk1hc3NBICsgdGhpcy5tX2ludk1hc3NCICsgdGhpcy5tX2ludklBICogdGhpcy5tX2ExICogdGhpcy5tX2ExICsgdGhpcy5tX2ludklCICogdGhpcy5tX2EyICogdGhpcy5tX2EyO1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JNYXNzID0gdGhpcy5tX21vdG9yTWFzcyA+IE51bWJlci5NSU5fVkFMVUUgPyAxLjAgLyB0aGlzLm1fbW90b3JNYXNzIDogMC4wO1xyXG4gICAgICB9IHtcclxuICAgICAgICAgdGhpcy5tX3BlcnAuU2V0VihiMk1hdGguTXVsTVYoeGYxLlIsIHRoaXMubV9sb2NhbFlBeGlzMSkpO1xyXG4gICAgICAgICB0aGlzLm1fczEgPSAoZFggKyByMVgpICogdGhpcy5tX3BlcnAueSAtIChkWSArIHIxWSkgKiB0aGlzLm1fcGVycC54O1xyXG4gICAgICAgICB0aGlzLm1fczIgPSByMlggKiB0aGlzLm1fcGVycC55IC0gcjJZICogdGhpcy5tX3BlcnAueDtcclxuICAgICAgICAgdmFyIG0xID0gdGhpcy5tX2ludk1hc3NBO1xyXG4gICAgICAgICB2YXIgbTIgPSB0aGlzLm1faW52TWFzc0I7XHJcbiAgICAgICAgIHZhciBpMSA9IHRoaXMubV9pbnZJQTtcclxuICAgICAgICAgdmFyIGkyID0gdGhpcy5tX2ludklCO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wxLnggPSBtMSArIG0yICsgaTEgKiB0aGlzLm1fczEgKiB0aGlzLm1fczEgKyBpMiAqIHRoaXMubV9zMiAqIHRoaXMubV9zMjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMS55ID0gaTEgKiB0aGlzLm1fczEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9zMiAqIHRoaXMubV9hMjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMi54ID0gdGhpcy5tX0suY29sMS55O1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wyLnkgPSBtMSArIG0yICsgaTEgKiB0aGlzLm1fYTEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9hMiAqIHRoaXMubV9hMjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0KSB7XHJcbiAgICAgICAgIHZhciBqb2ludFRyYW5zaXRpb24gPSB0aGlzLm1fYXhpcy54ICogZFggKyB0aGlzLm1fYXhpcy55ICogZFk7XHJcbiAgICAgICAgIGlmIChiMk1hdGguQWJzKHRoaXMubV91cHBlclRyYW5zbGF0aW9uIC0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIDwgMi4wICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2VxdWFsTGltaXRzO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYgKGpvaW50VHJhbnNpdGlvbiA8PSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdCkge1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9hdExvd2VyTGltaXQ7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSAwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmIChqb2ludFRyYW5zaXRpb24gPj0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcclxuICAgICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfYXRVcHBlckxpbWl0O1xyXG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ID0gMC4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XHJcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSAwLjA7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS55ICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHZhciBQWCA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC54ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS55KSAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIHZhciBQWSA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS55KSAqIHRoaXMubV9heGlzLnk7XHJcbiAgICAgICAgIHZhciBMMSA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fczEgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnkpICogdGhpcy5tX2ExO1xyXG4gICAgICAgICB2YXIgTDIgPSB0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3MyICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS55KSAqIHRoaXMubV9hMjtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgLT0gdGhpcy5tX2ludk1hc3NBICogUFk7XHJcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5IC09IHRoaXMubV9pbnZJQSAqIEwxO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gdGhpcy5tX2ludk1hc3NCICogUFg7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSB0aGlzLm1faW52TWFzc0IgKiBQWTtcclxuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gdGhpcy5tX2ludklCICogTDI7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcclxuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHYxID0gYkEubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHcxID0gYkEubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB2MiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3MiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgUFggPSAwO1xyXG4gICAgICB2YXIgUFkgPSAwO1xyXG4gICAgICB2YXIgTDEgPSAwO1xyXG4gICAgICB2YXIgTDIgPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yICYmIHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9lcXVhbExpbWl0cykge1xyXG4gICAgICAgICB2YXIgQ2RvdCA9IHRoaXMubV9heGlzLnggKiAodjIueCAtIHYxLngpICsgdGhpcy5tX2F4aXMueSAqICh2Mi55IC0gdjEueSkgKyB0aGlzLm1fYTIgKiB3MiAtIHRoaXMubV9hMSAqIHcxO1xyXG4gICAgICAgICB2YXIgaW1wdWxzZSA9IHRoaXMubV9tb3Rvck1hc3MgKiAodGhpcy5tX21vdG9yU3BlZWQgLSBDZG90KTtcclxuICAgICAgICAgdmFyIG9sZEltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlO1xyXG4gICAgICAgICB2YXIgbWF4SW1wdWxzZSA9IHN0ZXAuZHQgKiB0aGlzLm1fbWF4TW90b3JGb3JjZTtcclxuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IGIyTWF0aC5DbGFtcCh0aGlzLm1fbW90b3JJbXB1bHNlICsgaW1wdWxzZSwgKC1tYXhJbXB1bHNlKSwgbWF4SW1wdWxzZSk7XHJcbiAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbW90b3JJbXB1bHNlIC0gb2xkSW1wdWxzZTtcclxuICAgICAgICAgUFggPSBpbXB1bHNlICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgUFkgPSBpbXB1bHNlICogdGhpcy5tX2F4aXMueTtcclxuICAgICAgICAgTDEgPSBpbXB1bHNlICogdGhpcy5tX2ExO1xyXG4gICAgICAgICBMMiA9IGltcHVsc2UgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHYxLnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XHJcbiAgICAgICAgIHYxLnkgLT0gdGhpcy5tX2ludk1hc3NBICogUFk7XHJcbiAgICAgICAgIHcxIC09IHRoaXMubV9pbnZJQSAqIEwxO1xyXG4gICAgICAgICB2Mi54ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBYO1xyXG4gICAgICAgICB2Mi55ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICB3MiArPSB0aGlzLm1faW52SUIgKiBMMjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgQ2RvdDEgPSB0aGlzLm1fcGVycC54ICogKHYyLnggLSB2MS54KSArIHRoaXMubV9wZXJwLnkgKiAodjIueSAtIHYxLnkpICsgdGhpcy5tX3MyICogdzIgLSB0aGlzLm1fczEgKiB3MTtcclxuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdCkge1xyXG4gICAgICAgICB2YXIgQ2RvdDIgPSB0aGlzLm1fYXhpcy54ICogKHYyLnggLSB2MS54KSArIHRoaXMubV9heGlzLnkgKiAodjIueSAtIHYxLnkpICsgdGhpcy5tX2EyICogdzIgLSB0aGlzLm1fYTEgKiB3MTtcclxuICAgICAgICAgdmFyIGYxID0gdGhpcy5tX2ltcHVsc2UuQ29weSgpO1xyXG4gICAgICAgICB2YXIgZGYgPSB0aGlzLm1fSy5Tb2x2ZShuZXcgYjJWZWMyKCksICgtQ2RvdDEpLCAoLUNkb3QyKSk7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLkFkZChkZik7XHJcbiAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfYXRMb3dlckxpbWl0KSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSBiMk1hdGguTWF4KHRoaXMubV9pbXB1bHNlLnksIDAuMCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ID0gYjJNYXRoLk1pbih0aGlzLm1faW1wdWxzZS55LCAwLjApO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciBiID0gKC1DZG90MSkgLSAodGhpcy5tX2ltcHVsc2UueSAtIGYxLnkpICogdGhpcy5tX0suY29sMi54O1xyXG4gICAgICAgICB2YXIgZjJyID0gMDtcclxuICAgICAgICAgaWYgKHRoaXMubV9LLmNvbDEueCAhPSAwLjApIHtcclxuICAgICAgICAgICAgZjJyID0gYiAvIHRoaXMubV9LLmNvbDEueCArIGYxLng7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGYyciA9IGYxLng7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCA9IGYycjtcclxuICAgICAgICAgZGYueCA9IHRoaXMubV9pbXB1bHNlLnggLSBmMS54O1xyXG4gICAgICAgICBkZi55ID0gdGhpcy5tX2ltcHVsc2UueSAtIGYxLnk7XHJcbiAgICAgICAgIFBYID0gZGYueCAqIHRoaXMubV9wZXJwLnggKyBkZi55ICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgUFkgPSBkZi54ICogdGhpcy5tX3BlcnAueSArIGRmLnkgKiB0aGlzLm1fYXhpcy55O1xyXG4gICAgICAgICBMMSA9IGRmLnggKiB0aGlzLm1fczEgKyBkZi55ICogdGhpcy5tX2ExO1xyXG4gICAgICAgICBMMiA9IGRmLnggKiB0aGlzLm1fczIgKyBkZi55ICogdGhpcy5tX2EyO1xyXG4gICAgICAgICB2MS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xyXG4gICAgICAgICB2MS55IC09IHRoaXMubV9pbnZNYXNzQSAqIFBZO1xyXG4gICAgICAgICB3MSAtPSB0aGlzLm1faW52SUEgKiBMMTtcclxuICAgICAgICAgdjIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcclxuICAgICAgICAgdjIueSArPSB0aGlzLm1faW52TWFzc0IgKiBQWTtcclxuICAgICAgICAgdzIgKz0gdGhpcy5tX2ludklCICogTDI7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHZhciBkZjIgPSAwO1xyXG4gICAgICAgICBpZiAodGhpcy5tX0suY29sMS54ICE9IDAuMCkge1xyXG4gICAgICAgICAgICBkZjIgPSAoKC1DZG90MSkpIC8gdGhpcy5tX0suY29sMS54O1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkZjIgPSAwLjA7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSBkZjI7XHJcbiAgICAgICAgIFBYID0gZGYyICogdGhpcy5tX3BlcnAueDtcclxuICAgICAgICAgUFkgPSBkZjIgKiB0aGlzLm1fcGVycC55O1xyXG4gICAgICAgICBMMSA9IGRmMiAqIHRoaXMubV9zMTtcclxuICAgICAgICAgTDIgPSBkZjIgKiB0aGlzLm1fczI7XHJcbiAgICAgICAgIHYxLnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XHJcbiAgICAgICAgIHYxLnkgLT0gdGhpcy5tX2ludk1hc3NBICogUFk7XHJcbiAgICAgICAgIHcxIC09IHRoaXMubV9pbnZJQSAqIEwxO1xyXG4gICAgICAgICB2Mi54ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBYO1xyXG4gICAgICAgICB2Mi55ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICB3MiArPSB0aGlzLm1faW52SUIgKiBMMjtcclxuICAgICAgfVxyXG4gICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LlNldFYodjEpO1xyXG4gICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSA9IHcxO1xyXG4gICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LlNldFYodjIpO1xyXG4gICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSA9IHcyO1xyXG4gICB9XHJcbiAgIGIyTGluZUpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XHJcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcclxuICAgICAgdmFyIGxpbWl0QyA9IDA7XHJcbiAgICAgIHZhciBvbGRMaW1pdEltcHVsc2UgPSAwO1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIGMxID0gYkEubV9zd2VlcC5jO1xyXG4gICAgICB2YXIgYTEgPSBiQS5tX3N3ZWVwLmE7XHJcbiAgICAgIHZhciBjMiA9IGJCLm1fc3dlZXAuYztcclxuICAgICAgdmFyIGEyID0gYkIubV9zd2VlcC5hO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIG0xID0gMDtcclxuICAgICAgdmFyIG0yID0gMDtcclxuICAgICAgdmFyIGkxID0gMDtcclxuICAgICAgdmFyIGkyID0gMDtcclxuICAgICAgdmFyIGxpbmVhckVycm9yID0gMC4wO1xyXG4gICAgICB2YXIgYW5ndWxhckVycm9yID0gMC4wO1xyXG4gICAgICB2YXIgYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgIHZhciBDMiA9IDAuMDtcclxuICAgICAgdmFyIFIxID0gYjJNYXQyMi5Gcm9tQW5nbGUoYTEpO1xyXG4gICAgICB2YXIgUjIgPSBiMk1hdDIyLkZyb21BbmdsZShhMik7XHJcbiAgICAgIHRNYXQgPSBSMTtcclxuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIHRoaXMubV9sb2NhbENlbnRlckEueDtcclxuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIHRoaXMubV9sb2NhbENlbnRlckEueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgcjFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBSMjtcclxuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIHRoaXMubV9sb2NhbENlbnRlckIueDtcclxuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIHRoaXMubV9sb2NhbENlbnRlckIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgcjJYID0gdFg7XHJcbiAgICAgIHZhciBkWCA9IGMyLnggKyByMlggLSBjMS54IC0gcjFYO1xyXG4gICAgICB2YXIgZFkgPSBjMi55ICsgcjJZIC0gYzEueSAtIHIxWTtcclxuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCkge1xyXG4gICAgICAgICB0aGlzLm1fYXhpcyA9IGIyTWF0aC5NdWxNVihSMSwgdGhpcy5tX2xvY2FsWEF4aXMxKTtcclxuICAgICAgICAgdGhpcy5tX2ExID0gKGRYICsgcjFYKSAqIHRoaXMubV9heGlzLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgdGhpcy5tX2EyID0gcjJYICogdGhpcy5tX2F4aXMueSAtIHIyWSAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIHZhciB0cmFuc2xhdGlvbiA9IHRoaXMubV9heGlzLnggKiBkWCArIHRoaXMubV9heGlzLnkgKiBkWTtcclxuICAgICAgICAgaWYgKGIyTWF0aC5BYnModGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikgPCAyLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgICAgICAgQzIgPSBiMk1hdGguQ2xhbXAodHJhbnNsYXRpb24sICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKTtcclxuICAgICAgICAgICAgbGluZWFyRXJyb3IgPSBiMk1hdGguQWJzKHRyYW5zbGF0aW9uKTtcclxuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0cmFuc2xhdGlvbiA8PSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikge1xyXG4gICAgICAgICAgICBDMiA9IGIyTWF0aC5DbGFtcCh0cmFuc2xhdGlvbiAtIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wLCAoLWIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbiksIDAuMCk7XHJcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gLSB0cmFuc2xhdGlvbjtcclxuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0cmFuc2xhdGlvbiA+PSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbikge1xyXG4gICAgICAgICAgICBDMiA9IGIyTWF0aC5DbGFtcCh0cmFuc2xhdGlvbiAtIHRoaXMubV91cHBlclRyYW5zbGF0aW9uICsgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wLCAwLjAsIGIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbik7XHJcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gdHJhbnNsYXRpb24gLSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbjtcclxuICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9wZXJwID0gYjJNYXRoLk11bE1WKFIxLCB0aGlzLm1fbG9jYWxZQXhpczEpO1xyXG4gICAgICB0aGlzLm1fczEgPSAoZFggKyByMVgpICogdGhpcy5tX3BlcnAueSAtIChkWSArIHIxWSkgKiB0aGlzLm1fcGVycC54O1xyXG4gICAgICB0aGlzLm1fczIgPSByMlggKiB0aGlzLm1fcGVycC55IC0gcjJZICogdGhpcy5tX3BlcnAueDtcclxuICAgICAgdmFyIGltcHVsc2UgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHZhciBDMSA9IHRoaXMubV9wZXJwLnggKiBkWCArIHRoaXMubV9wZXJwLnkgKiBkWTtcclxuICAgICAgbGluZWFyRXJyb3IgPSBiMk1hdGguTWF4KGxpbmVhckVycm9yLCBiMk1hdGguQWJzKEMxKSk7XHJcbiAgICAgIGFuZ3VsYXJFcnJvciA9IDAuMDtcclxuICAgICAgaWYgKGFjdGl2ZSkge1xyXG4gICAgICAgICBtMSA9IHRoaXMubV9pbnZNYXNzQTtcclxuICAgICAgICAgbTIgPSB0aGlzLm1faW52TWFzc0I7XHJcbiAgICAgICAgIGkxID0gdGhpcy5tX2ludklBO1xyXG4gICAgICAgICBpMiA9IHRoaXMubV9pbnZJQjtcclxuICAgICAgICAgdGhpcy5tX0suY29sMS54ID0gbTEgKyBtMiArIGkxICogdGhpcy5tX3MxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fczI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueSA9IGkxICogdGhpcy5tX3MxICogdGhpcy5tX2ExICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueCA9IHRoaXMubV9LLmNvbDEueTtcclxuICAgICAgICAgdGhpcy5tX0suY29sMi55ID0gbTEgKyBtMiArIGkxICogdGhpcy5tX2ExICogdGhpcy5tX2ExICsgaTIgKiB0aGlzLm1fYTIgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHRoaXMubV9LLlNvbHZlKGltcHVsc2UsICgtQzEpLCAoLUMyKSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIG0xID0gdGhpcy5tX2ludk1hc3NBO1xyXG4gICAgICAgICBtMiA9IHRoaXMubV9pbnZNYXNzQjtcclxuICAgICAgICAgaTEgPSB0aGlzLm1faW52SUE7XHJcbiAgICAgICAgIGkyID0gdGhpcy5tX2ludklCO1xyXG4gICAgICAgICB2YXIgazExID0gbTEgKyBtMiArIGkxICogdGhpcy5tX3MxICogdGhpcy5tX3MxICsgaTIgKiB0aGlzLm1fczIgKiB0aGlzLm1fczI7XHJcbiAgICAgICAgIHZhciBpbXB1bHNlMSA9IDA7XHJcbiAgICAgICAgIGlmIChrMTEgIT0gMC4wKSB7XHJcbiAgICAgICAgICAgIGltcHVsc2UxID0gKCgtQzEpKSAvIGsxMTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaW1wdWxzZTEgPSAwLjA7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgaW1wdWxzZS54ID0gaW1wdWxzZTE7XHJcbiAgICAgICAgIGltcHVsc2UueSA9IDAuMDtcclxuICAgICAgfVxyXG4gICAgICB2YXIgUFggPSBpbXB1bHNlLnggKiB0aGlzLm1fcGVycC54ICsgaW1wdWxzZS55ICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgdmFyIFBZID0gaW1wdWxzZS54ICogdGhpcy5tX3BlcnAueSArIGltcHVsc2UueSAqIHRoaXMubV9heGlzLnk7XHJcbiAgICAgIHZhciBMMSA9IGltcHVsc2UueCAqIHRoaXMubV9zMSArIGltcHVsc2UueSAqIHRoaXMubV9hMTtcclxuICAgICAgdmFyIEwyID0gaW1wdWxzZS54ICogdGhpcy5tX3MyICsgaW1wdWxzZS55ICogdGhpcy5tX2EyO1xyXG4gICAgICBjMS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xyXG4gICAgICBjMS55IC09IHRoaXMubV9pbnZNYXNzQSAqIFBZO1xyXG4gICAgICBhMSAtPSB0aGlzLm1faW52SUEgKiBMMTtcclxuICAgICAgYzIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcclxuICAgICAgYzIueSArPSB0aGlzLm1faW52TWFzc0IgKiBQWTtcclxuICAgICAgYTIgKz0gdGhpcy5tX2ludklCICogTDI7XHJcbiAgICAgIGJBLm1fc3dlZXAuYSA9IGExO1xyXG4gICAgICBiQi5tX3N3ZWVwLmEgPSBhMjtcclxuICAgICAgYkEuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgcmV0dXJuIGxpbmVhckVycm9yIDw9IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCAmJiBhbmd1bGFyRXJyb3IgPD0gYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcDtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyTGluZUpvaW50RGVmLCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZik7XHJcbiAgIGIyTGluZUpvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xyXG4gICBiMkxpbmVKb2ludERlZi5iMkxpbmVKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubG9jYWxBeGlzQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJMaW5lSm9pbnREZWYucHJvdG90eXBlLmIyTGluZUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludERlZi5jYWxsKHRoaXMpO1xyXG4gICAgICB0aGlzLnR5cGUgPSBiMkpvaW50LmVfbGluZUpvaW50O1xyXG4gICAgICB0aGlzLmxvY2FsQXhpc0EuU2V0KDEuMCwgMC4wKTtcclxuICAgICAgdGhpcy5lbmFibGVMaW1pdCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmxvd2VyVHJhbnNsYXRpb24gPSAwLjA7XHJcbiAgICAgIHRoaXMudXBwZXJUcmFuc2xhdGlvbiA9IDAuMDtcclxuICAgICAgdGhpcy5lbmFibGVNb3RvciA9IGZhbHNlO1xyXG4gICAgICB0aGlzLm1heE1vdG9yRm9yY2UgPSAwLjA7XHJcbiAgICAgIHRoaXMubW90b3JTcGVlZCA9IDAuMDtcclxuICAgfVxyXG4gICBiMkxpbmVKb2ludERlZi5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChiQSwgYkIsIGFuY2hvciwgYXhpcykge1xyXG4gICAgICB0aGlzLmJvZHlBID0gYkE7XHJcbiAgICAgIHRoaXMuYm9keUIgPSBiQjtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckEgPSB0aGlzLmJvZHlBLkdldExvY2FsUG9pbnQoYW5jaG9yKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSB0aGlzLmJvZHlCLkdldExvY2FsUG9pbnQoYW5jaG9yKTtcclxuICAgICAgdGhpcy5sb2NhbEF4aXNBID0gdGhpcy5ib2R5QS5HZXRMb2NhbFZlY3RvcihheGlzKTtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyTW91c2VKb2ludCwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQpO1xyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XHJcbiAgIGIyTW91c2VKb2ludC5iMk1vdXNlSm9pbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LmIySm9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5LID0gbmV3IGIyTWF0MjIoKTtcclxuICAgICAgdGhpcy5LMSA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIHRoaXMuSzIgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV90YXJnZXQgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fbWFzcyA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIHRoaXMubV9DID0gbmV3IGIyVmVjMigpO1xyXG4gICB9O1xyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdGFyZ2V0O1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcik7XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvbkZvcmNlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBuZXcgYjJWZWMyKGludl9kdCAqIHRoaXMubV9pbXB1bHNlLngsIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLnkpO1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIDAuMDtcclxuICAgfVxyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkdldFRhcmdldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV90YXJnZXQ7XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5TZXRUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgIGlmICh0aGlzLm1fYm9keUIuSXNBd2FrZSgpID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fdGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuR2V0TWF4Rm9yY2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbWF4Rm9yY2U7XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5TZXRNYXhGb3JjZSA9IGZ1bmN0aW9uIChtYXhGb3JjZSkge1xyXG4gICAgICBpZiAobWF4Rm9yY2UgPT09IHVuZGVmaW5lZCkgbWF4Rm9yY2UgPSAwO1xyXG4gICAgICB0aGlzLm1fbWF4Rm9yY2UgPSBtYXhGb3JjZTtcclxuICAgfVxyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkdldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9mcmVxdWVuY3lIejtcclxuICAgfVxyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLlNldEZyZXF1ZW5jeSA9IGZ1bmN0aW9uIChoeikge1xyXG4gICAgICBpZiAoaHogPT09IHVuZGVmaW5lZCkgaHogPSAwO1xyXG4gICAgICB0aGlzLm1fZnJlcXVlbmN5SHogPSBoejtcclxuICAgfVxyXG4gICBiMk1vdXNlSm9pbnQucHJvdG90eXBlLkdldERhbXBpbmdSYXRpbyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9kYW1waW5nUmF0aW87XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5TZXREYW1waW5nUmF0aW8gPSBmdW5jdGlvbiAocmF0aW8pIHtcclxuICAgICAgaWYgKHJhdGlvID09PSB1bmRlZmluZWQpIHJhdGlvID0gMDtcclxuICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IHJhdGlvO1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuYjJNb3VzZUpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XHJcbiAgICAgIHRoaXMubV90YXJnZXQuU2V0VihkZWYudGFyZ2V0KTtcclxuICAgICAgdmFyIHRYID0gdGhpcy5tX3RhcmdldC54IC0gdGhpcy5tX2JvZHlCLm1feGYucG9zaXRpb24ueDtcclxuICAgICAgdmFyIHRZID0gdGhpcy5tX3RhcmdldC55IC0gdGhpcy5tX2JvZHlCLm1feGYucG9zaXRpb24ueTtcclxuICAgICAgdmFyIHRNYXQgPSB0aGlzLm1fYm9keUIubV94Zi5SO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IueCA9ICh0WCAqIHRNYXQuY29sMS54ICsgdFkgKiB0TWF0LmNvbDEueSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvci55ID0gKHRYICogdE1hdC5jb2wyLnggKyB0WSAqIHRNYXQuY29sMi55KTtcclxuICAgICAgdGhpcy5tX21heEZvcmNlID0gZGVmLm1heEZvcmNlO1xyXG4gICAgICB0aGlzLm1faW1wdWxzZS5TZXRaZXJvKCk7XHJcbiAgICAgIHRoaXMubV9mcmVxdWVuY3lIeiA9IGRlZi5mcmVxdWVuY3lIejtcclxuICAgICAgdGhpcy5tX2RhbXBpbmdSYXRpbyA9IGRlZi5kYW1waW5nUmF0aW87XHJcbiAgICAgIHRoaXMubV9iZXRhID0gMC4wO1xyXG4gICAgICB0aGlzLm1fZ2FtbWEgPSAwLjA7XHJcbiAgIH1cclxuICAgYjJNb3VzZUpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciBiID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgbWFzcyA9IGIuR2V0TWFzcygpO1xyXG4gICAgICB2YXIgb21lZ2EgPSAyLjAgKiBNYXRoLlBJICogdGhpcy5tX2ZyZXF1ZW5jeUh6O1xyXG4gICAgICB2YXIgZCA9IDIuMCAqIG1hc3MgKiB0aGlzLm1fZGFtcGluZ1JhdGlvICogb21lZ2E7XHJcbiAgICAgIHZhciBrID0gbWFzcyAqIG9tZWdhICogb21lZ2E7XHJcbiAgICAgIHRoaXMubV9nYW1tYSA9IHN0ZXAuZHQgKiAoZCArIHN0ZXAuZHQgKiBrKTtcclxuICAgICAgdGhpcy5tX2dhbW1hID0gdGhpcy5tX2dhbW1hICE9IDAgPyAxIC8gdGhpcy5tX2dhbW1hIDogMC4wO1xyXG4gICAgICB0aGlzLm1fYmV0YSA9IHN0ZXAuZHQgKiBrICogdGhpcy5tX2dhbW1hO1xyXG4gICAgICB2YXIgdE1hdDt0TWF0ID0gYi5tX3hmLlI7XHJcbiAgICAgIHZhciByWCA9IHRoaXMubV9sb2NhbEFuY2hvci54IC0gYi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByWSA9IHRoaXMubV9sb2NhbEFuY2hvci55IC0gYi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHZhciB0WCA9ICh0TWF0LmNvbDEueCAqIHJYICsgdE1hdC5jb2wyLnggKiByWSk7clkgPSAodE1hdC5jb2wxLnkgKiByWCArIHRNYXQuY29sMi55ICogclkpO1xyXG4gICAgICByWCA9IHRYO1xyXG4gICAgICB2YXIgaW52TWFzcyA9IGIubV9pbnZNYXNzO1xyXG4gICAgICB2YXIgaW52SSA9IGIubV9pbnZJO3RoaXMuSzEuY29sMS54ID0gaW52TWFzcztcclxuICAgICAgdGhpcy5LMS5jb2wyLnggPSAwLjA7XHJcbiAgICAgIHRoaXMuSzEuY29sMS55ID0gMC4wO1xyXG4gICAgICB0aGlzLksxLmNvbDIueSA9IGludk1hc3M7XHJcbiAgICAgIHRoaXMuSzIuY29sMS54ID0gaW52SSAqIHJZICogclk7XHJcbiAgICAgIHRoaXMuSzIuY29sMi54ID0gKC1pbnZJICogclggKiByWSk7XHJcbiAgICAgIHRoaXMuSzIuY29sMS55ID0gKC1pbnZJICogclggKiByWSk7XHJcbiAgICAgIHRoaXMuSzIuY29sMi55ID0gaW52SSAqIHJYICogclg7XHJcbiAgICAgIHRoaXMuSy5TZXRNKHRoaXMuSzEpO1xyXG4gICAgICB0aGlzLksuQWRkTSh0aGlzLksyKTtcclxuICAgICAgdGhpcy5LLmNvbDEueCArPSB0aGlzLm1fZ2FtbWE7XHJcbiAgICAgIHRoaXMuSy5jb2wyLnkgKz0gdGhpcy5tX2dhbW1hO1xyXG4gICAgICB0aGlzLksuR2V0SW52ZXJzZSh0aGlzLm1fbWFzcyk7XHJcbiAgICAgIHRoaXMubV9DLnggPSBiLm1fc3dlZXAuYy54ICsgclggLSB0aGlzLm1fdGFyZ2V0Lng7XHJcbiAgICAgIHRoaXMubV9DLnkgPSBiLm1fc3dlZXAuYy55ICsgclkgLSB0aGlzLm1fdGFyZ2V0Lnk7XHJcbiAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgKj0gMC45ODtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UueCAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlLnkgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICBiLm1fbGluZWFyVmVsb2NpdHkueCArPSBpbnZNYXNzICogdGhpcy5tX2ltcHVsc2UueDtcclxuICAgICAgYi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gaW52TWFzcyAqIHRoaXMubV9pbXB1bHNlLnk7XHJcbiAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgKz0gaW52SSAqIChyWCAqIHRoaXMubV9pbXB1bHNlLnkgLSByWSAqIHRoaXMubV9pbXB1bHNlLngpO1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgdFkgPSAwO1xyXG4gICAgICB0TWF0ID0gYi5tX3hmLlI7XHJcbiAgICAgIHZhciByWCA9IHRoaXMubV9sb2NhbEFuY2hvci54IC0gYi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByWSA9IHRoaXMubV9sb2NhbEFuY2hvci55IC0gYi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogclggKyB0TWF0LmNvbDIueCAqIHJZKTtcclxuICAgICAgclkgPSAodE1hdC5jb2wxLnkgKiByWCArIHRNYXQuY29sMi55ICogclkpO1xyXG4gICAgICByWCA9IHRYO1xyXG4gICAgICB2YXIgQ2RvdFggPSBiLm1fbGluZWFyVmVsb2NpdHkueCArICgoLWIubV9hbmd1bGFyVmVsb2NpdHkgKiByWSkpO1xyXG4gICAgICB2YXIgQ2RvdFkgPSBiLm1fbGluZWFyVmVsb2NpdHkueSArIChiLm1fYW5ndWxhclZlbG9jaXR5ICogclgpO1xyXG4gICAgICB0TWF0ID0gdGhpcy5tX21hc3M7XHJcbiAgICAgIHRYID0gQ2RvdFggKyB0aGlzLm1fYmV0YSAqIHRoaXMubV9DLnggKyB0aGlzLm1fZ2FtbWEgKiB0aGlzLm1faW1wdWxzZS54O1xyXG4gICAgICB0WSA9IENkb3RZICsgdGhpcy5tX2JldGEgKiB0aGlzLm1fQy55ICsgdGhpcy5tX2dhbW1hICogdGhpcy5tX2ltcHVsc2UueTtcclxuICAgICAgdmFyIGltcHVsc2VYID0gKC0odE1hdC5jb2wxLnggKiB0WCArIHRNYXQuY29sMi54ICogdFkpKTtcclxuICAgICAgdmFyIGltcHVsc2VZID0gKC0odE1hdC5jb2wxLnkgKiB0WCArIHRNYXQuY29sMi55ICogdFkpKTtcclxuICAgICAgdmFyIG9sZEltcHVsc2VYID0gdGhpcy5tX2ltcHVsc2UueDtcclxuICAgICAgdmFyIG9sZEltcHVsc2VZID0gdGhpcy5tX2ltcHVsc2UueTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSBpbXB1bHNlWDtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSBpbXB1bHNlWTtcclxuICAgICAgdmFyIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heEZvcmNlO1xyXG4gICAgICBpZiAodGhpcy5tX2ltcHVsc2UuTGVuZ3RoU3F1YXJlZCgpID4gbWF4SW1wdWxzZSAqIG1heEltcHVsc2UpIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UuTXVsdGlwbHkobWF4SW1wdWxzZSAvIHRoaXMubV9pbXB1bHNlLkxlbmd0aCgpKTtcclxuICAgICAgfVxyXG4gICAgICBpbXB1bHNlWCA9IHRoaXMubV9pbXB1bHNlLnggLSBvbGRJbXB1bHNlWDtcclxuICAgICAgaW1wdWxzZVkgPSB0aGlzLm1faW1wdWxzZS55IC0gb2xkSW1wdWxzZVk7XHJcbiAgICAgIGIubV9saW5lYXJWZWxvY2l0eS54ICs9IGIubV9pbnZNYXNzICogaW1wdWxzZVg7XHJcbiAgICAgIGIubV9saW5lYXJWZWxvY2l0eS55ICs9IGIubV9pbnZNYXNzICogaW1wdWxzZVk7XHJcbiAgICAgIGIubV9hbmd1bGFyVmVsb2NpdHkgKz0gYi5tX2ludkkgKiAoclggKiBpbXB1bHNlWSAtIHJZICogaW1wdWxzZVgpO1xyXG4gICB9XHJcbiAgIGIyTW91c2VKb2ludC5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xyXG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJNb3VzZUpvaW50RGVmLCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZik7XHJcbiAgIGIyTW91c2VKb2ludERlZi5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLnByb3RvdHlwZTtcclxuICAgYjJNb3VzZUpvaW50RGVmLmIyTW91c2VKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLnRhcmdldCA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJNb3VzZUpvaW50RGVmLnByb3RvdHlwZS5iMk1vdXNlSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9tb3VzZUpvaW50O1xyXG4gICAgICB0aGlzLm1heEZvcmNlID0gMC4wO1xyXG4gICAgICB0aGlzLmZyZXF1ZW5jeUh6ID0gNS4wO1xyXG4gICAgICB0aGlzLmRhbXBpbmdSYXRpbyA9IDAuNztcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyUHJpc21hdGljSm9pbnQsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50KTtcclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LnByb3RvdHlwZTtcclxuICAgYjJQcmlzbWF0aWNKb2ludC5iMlByaXNtYXRpY0pvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbFhBeGlzMSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsWUF4aXMxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fYXhpcyA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX3BlcnAgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9LID0gbmV3IGIyTWF0MzMoKTtcclxuICAgICAgdGhpcy5tX2ltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XHJcbiAgIH07XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiAodGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9wZXJwLnggKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2F4aXMueCksIGludl9kdCAqICh0aGlzLm1faW1wdWxzZS54ICogdGhpcy5tX3BlcnAueSArICh0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2UueikgKiB0aGlzLm1fYXhpcy55KSk7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLnk7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0Sm9pbnRUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgcDEgPSBiQS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjEpO1xyXG4gICAgICB2YXIgcDIgPSBiQi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xyXG4gICAgICB2YXIgZFggPSBwMi54IC0gcDEueDtcclxuICAgICAgdmFyIGRZID0gcDIueSAtIHAxLnk7XHJcbiAgICAgIHZhciBheGlzID0gYkEuR2V0V29ybGRWZWN0b3IodGhpcy5tX2xvY2FsWEF4aXMxKTtcclxuICAgICAgdmFyIHRyYW5zbGF0aW9uID0gYXhpcy54ICogZFggKyBheGlzLnkgKiBkWTtcclxuICAgICAgcmV0dXJuIHRyYW5zbGF0aW9uO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkdldEpvaW50U3BlZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdmFyIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgIHIxWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICByMlggPSB0WDtcclxuICAgICAgdmFyIHAxWCA9IGJBLm1fc3dlZXAuYy54ICsgcjFYO1xyXG4gICAgICB2YXIgcDFZID0gYkEubV9zd2VlcC5jLnkgKyByMVk7XHJcbiAgICAgIHZhciBwMlggPSBiQi5tX3N3ZWVwLmMueCArIHIyWDtcclxuICAgICAgdmFyIHAyWSA9IGJCLm1fc3dlZXAuYy55ICsgcjJZO1xyXG4gICAgICB2YXIgZFggPSBwMlggLSBwMVg7XHJcbiAgICAgIHZhciBkWSA9IHAyWSAtIHAxWTtcclxuICAgICAgdmFyIGF4aXMgPSBiQS5HZXRXb3JsZFZlY3Rvcih0aGlzLm1fbG9jYWxYQXhpczEpO1xyXG4gICAgICB2YXIgdjEgPSBiQS5tX2xpbmVhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdjIgPSBiQi5tX2xpbmVhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdzEgPSBiQS5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHcyID0gYkIubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciBzcGVlZCA9IChkWCAqICgoLXcxICogYXhpcy55KSkgKyBkWSAqICh3MSAqIGF4aXMueCkpICsgKGF4aXMueCAqICgoKHYyLnggKyAoKC13MiAqIHIyWSkpKSAtIHYxLngpIC0gKCgtdzEgKiByMVkpKSkgKyBheGlzLnkgKiAoKCh2Mi55ICsgKHcyICogcjJYKSkgLSB2MS55KSAtICh3MSAqIHIxWCkpKTtcclxuICAgICAgcmV0dXJuIHNwZWVkO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLklzTGltaXRFbmFibGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZUxpbWl0O1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkVuYWJsZUxpbWl0ID0gZnVuY3Rpb24gKGZsYWcpIHtcclxuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9lbmFibGVMaW1pdCA9IGZsYWc7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuR2V0TG93ZXJMaW1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9sb3dlclRyYW5zbGF0aW9uO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkdldFVwcGVyTGltaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbjtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5TZXRMaW1pdHMgPSBmdW5jdGlvbiAobG93ZXIsIHVwcGVyKSB7XHJcbiAgICAgIGlmIChsb3dlciA9PT0gdW5kZWZpbmVkKSBsb3dlciA9IDA7XHJcbiAgICAgIGlmICh1cHBlciA9PT0gdW5kZWZpbmVkKSB1cHBlciA9IDA7XHJcbiAgICAgIHRoaXMubV9ib2R5QS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiA9IGxvd2VyO1xyXG4gICAgICB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiA9IHVwcGVyO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLklzTW90b3JFbmFibGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZU1vdG9yO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkVuYWJsZU1vdG9yID0gZnVuY3Rpb24gKGZsYWcpIHtcclxuICAgICAgdGhpcy5tX2JvZHlBLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICB0aGlzLm1fYm9keUIuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGZsYWc7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuU2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uIChzcGVlZCkge1xyXG4gICAgICBpZiAoc3BlZWQgPT09IHVuZGVmaW5lZCkgc3BlZWQgPSAwO1xyXG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBzcGVlZDtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5HZXRNb3RvclNwZWVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX21vdG9yU3BlZWQ7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuU2V0TWF4TW90b3JGb3JjZSA9IGZ1bmN0aW9uIChmb3JjZSkge1xyXG4gICAgICBpZiAoZm9yY2UgPT09IHVuZGVmaW5lZCkgZm9yY2UgPSAwO1xyXG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX21heE1vdG9yRm9yY2UgPSBmb3JjZTtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5HZXRNb3RvckZvcmNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX21vdG9ySW1wdWxzZTtcclxuICAgfVxyXG4gICBiMlByaXNtYXRpY0pvaW50LnByb3RvdHlwZS5iMlByaXNtYXRpY0pvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgdFkgPSAwO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IxLlNldFYoZGVmLmxvY2FsQW5jaG9yQSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIuU2V0VihkZWYubG9jYWxBbmNob3JCKTtcclxuICAgICAgdGhpcy5tX2xvY2FsWEF4aXMxLlNldFYoZGVmLmxvY2FsQXhpc0EpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxZQXhpczEueCA9ICgtdGhpcy5tX2xvY2FsWEF4aXMxLnkpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxZQXhpczEueSA9IHRoaXMubV9sb2NhbFhBeGlzMS54O1xyXG4gICAgICB0aGlzLm1fcmVmQW5nbGUgPSBkZWYucmVmZXJlbmNlQW5nbGU7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDAuMDtcclxuICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24gPSBkZWYubG93ZXJUcmFuc2xhdGlvbjtcclxuICAgICAgdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24gPSBkZWYudXBwZXJUcmFuc2xhdGlvbjtcclxuICAgICAgdGhpcy5tX21heE1vdG9yRm9yY2UgPSBkZWYubWF4TW90b3JGb3JjZTtcclxuICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBkZWYubW90b3JTcGVlZDtcclxuICAgICAgdGhpcy5tX2VuYWJsZUxpbWl0ID0gZGVmLmVuYWJsZUxpbWl0O1xyXG4gICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBkZWYuZW5hYmxlTW90b3I7XHJcbiAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XHJcbiAgICAgIHRoaXMubV9heGlzLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX3BlcnAuU2V0WmVybygpO1xyXG4gICB9XHJcbiAgIGIyUHJpc21hdGljSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB0aGlzLm1fbG9jYWxDZW50ZXJBLlNldFYoYkEuR2V0TG9jYWxDZW50ZXIoKSk7XHJcbiAgICAgIHRoaXMubV9sb2NhbENlbnRlckIuU2V0VihiQi5HZXRMb2NhbENlbnRlcigpKTtcclxuICAgICAgdmFyIHhmMSA9IGJBLkdldFRyYW5zZm9ybSgpO1xyXG4gICAgICB2YXIgeGYyID0gYkIuR2V0VHJhbnNmb3JtKCk7XHJcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSB0aGlzLm1fbG9jYWxDZW50ZXJBLng7XHJcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSB0aGlzLm1fbG9jYWxDZW50ZXJBLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgIHIxWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gdGhpcy5tX2xvY2FsQ2VudGVyQi54O1xyXG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gdGhpcy5tX2xvY2FsQ2VudGVyQi55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICByMlggPSB0WDtcclxuICAgICAgdmFyIGRYID0gYkIubV9zd2VlcC5jLnggKyByMlggLSBiQS5tX3N3ZWVwLmMueCAtIHIxWDtcclxuICAgICAgdmFyIGRZID0gYkIubV9zd2VlcC5jLnkgKyByMlkgLSBiQS5tX3N3ZWVwLmMueSAtIHIxWTtcclxuICAgICAgdGhpcy5tX2ludk1hc3NBID0gYkEubV9pbnZNYXNzO1xyXG4gICAgICB0aGlzLm1faW52TWFzc0IgPSBiQi5tX2ludk1hc3M7XHJcbiAgICAgIHRoaXMubV9pbnZJQSA9IGJBLm1faW52STtcclxuICAgICAgdGhpcy5tX2ludklCID0gYkIubV9pbnZJOyB7XHJcbiAgICAgICAgIHRoaXMubV9heGlzLlNldFYoYjJNYXRoLk11bE1WKHhmMS5SLCB0aGlzLm1fbG9jYWxYQXhpczEpKTtcclxuICAgICAgICAgdGhpcy5tX2ExID0gKGRYICsgcjFYKSAqIHRoaXMubV9heGlzLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX2F4aXMueDtcclxuICAgICAgICAgdGhpcy5tX2EyID0gcjJYICogdGhpcy5tX2F4aXMueSAtIHIyWSAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIHRoaXMubV9tb3Rvck1hc3MgPSB0aGlzLm1faW52TWFzc0EgKyB0aGlzLm1faW52TWFzc0IgKyB0aGlzLm1faW52SUEgKiB0aGlzLm1fYTEgKiB0aGlzLm1fYTEgKyB0aGlzLm1faW52SUIgKiB0aGlzLm1fYTIgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIGlmICh0aGlzLm1fbW90b3JNYXNzID4gTnVtYmVyLk1JTl9WQUxVRSkgdGhpcy5tX21vdG9yTWFzcyA9IDEuMCAvIHRoaXMubV9tb3Rvck1hc3M7XHJcbiAgICAgIH0ge1xyXG4gICAgICAgICB0aGlzLm1fcGVycC5TZXRWKGIyTWF0aC5NdWxNVih4ZjEuUiwgdGhpcy5tX2xvY2FsWUF4aXMxKSk7XHJcbiAgICAgICAgIHRoaXMubV9zMSA9IChkWCArIHIxWCkgKiB0aGlzLm1fcGVycC55IC0gKGRZICsgcjFZKSAqIHRoaXMubV9wZXJwLng7XHJcbiAgICAgICAgIHRoaXMubV9zMiA9IHIyWCAqIHRoaXMubV9wZXJwLnkgLSByMlkgKiB0aGlzLm1fcGVycC54O1xyXG4gICAgICAgICB2YXIgbTEgPSB0aGlzLm1faW52TWFzc0E7XHJcbiAgICAgICAgIHZhciBtMiA9IHRoaXMubV9pbnZNYXNzQjtcclxuICAgICAgICAgdmFyIGkxID0gdGhpcy5tX2ludklBO1xyXG4gICAgICAgICB2YXIgaTIgPSB0aGlzLm1faW52SUI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueCA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX3MyO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wxLnkgPSBpMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wxLnogPSBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX2EyO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wyLnggPSB0aGlzLm1fSy5jb2wxLnk7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueSA9IGkxICsgaTI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueiA9IGkxICogdGhpcy5tX2ExICsgaTIgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDMueCA9IHRoaXMubV9LLmNvbDEuejtcclxuICAgICAgICAgdGhpcy5tX0suY29sMy55ID0gdGhpcy5tX0suY29sMi56O1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wzLnogPSBtMSArIG0yICsgaTEgKiB0aGlzLm1fYTEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9hMiAqIHRoaXMubV9hMjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0KSB7XHJcbiAgICAgICAgIHZhciBqb2ludFRyYW5zaXRpb24gPSB0aGlzLm1fYXhpcy54ICogZFggKyB0aGlzLm1fYXhpcy55ICogZFk7XHJcbiAgICAgICAgIGlmIChiMk1hdGguQWJzKHRoaXMubV91cHBlclRyYW5zbGF0aW9uIC0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIDwgMi4wICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2VxdWFsTGltaXRzO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYgKGpvaW50VHJhbnNpdGlvbiA8PSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdCkge1xyXG4gICAgICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9hdExvd2VyTGltaXQ7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmIChqb2ludFRyYW5zaXRpb24gPj0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcclxuICAgICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfYXRVcHBlckxpbWl0O1xyXG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMC4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XHJcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yID09IGZhbHNlKSB7XHJcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS55ICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHZhciBQWCA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC54ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KSAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIHZhciBQWSA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fcGVycC55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KSAqIHRoaXMubV9heGlzLnk7XHJcbiAgICAgICAgIHZhciBMMSA9IHRoaXMubV9pbXB1bHNlLnggKiB0aGlzLm1fczEgKyB0aGlzLm1faW1wdWxzZS55ICsgKHRoaXMubV9tb3RvckltcHVsc2UgKyB0aGlzLm1faW1wdWxzZS56KSAqIHRoaXMubV9hMTtcclxuICAgICAgICAgdmFyIEwyID0gdGhpcy5tX2ltcHVsc2UueCAqIHRoaXMubV9zMiArIHRoaXMubV9pbXB1bHNlLnkgKyAodGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopICogdGhpcy5tX2EyO1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcclxuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgLT0gdGhpcy5tX2ludklBICogTDE7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBZO1xyXG4gICAgICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSB0aGlzLm1faW52SUIgKiBMMjtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UuU2V0WmVybygpO1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMC4wO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuU29sdmVWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB2MSA9IGJBLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3MSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdjIgPSBiQi5tX2xpbmVhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdzIgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIFBYID0gMDtcclxuICAgICAgdmFyIFBZID0gMDtcclxuICAgICAgdmFyIEwxID0gMDtcclxuICAgICAgdmFyIEwyID0gMDtcclxuICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3RvciAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfZXF1YWxMaW1pdHMpIHtcclxuICAgICAgICAgdmFyIENkb3QgPSB0aGlzLm1fYXhpcy54ICogKHYyLnggLSB2MS54KSArIHRoaXMubV9heGlzLnkgKiAodjIueSAtIHYxLnkpICsgdGhpcy5tX2EyICogdzIgLSB0aGlzLm1fYTEgKiB3MTtcclxuICAgICAgICAgdmFyIGltcHVsc2UgPSB0aGlzLm1fbW90b3JNYXNzICogKHRoaXMubV9tb3RvclNwZWVkIC0gQ2RvdCk7XHJcbiAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZTtcclxuICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heE1vdG9yRm9yY2U7XHJcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSBiMk1hdGguQ2xhbXAodGhpcy5tX21vdG9ySW1wdWxzZSArIGltcHVsc2UsICgtbWF4SW1wdWxzZSksIG1heEltcHVsc2UpO1xyXG4gICAgICAgICBpbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZSAtIG9sZEltcHVsc2U7XHJcbiAgICAgICAgIFBYID0gaW1wdWxzZSAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIFBZID0gaW1wdWxzZSAqIHRoaXMubV9heGlzLnk7XHJcbiAgICAgICAgIEwxID0gaW1wdWxzZSAqIHRoaXMubV9hMTtcclxuICAgICAgICAgTDIgPSBpbXB1bHNlICogdGhpcy5tX2EyO1xyXG4gICAgICAgICB2MS54IC09IHRoaXMubV9pbnZNYXNzQSAqIFBYO1xyXG4gICAgICAgICB2MS55IC09IHRoaXMubV9pbnZNYXNzQSAqIFBZO1xyXG4gICAgICAgICB3MSAtPSB0aGlzLm1faW52SUEgKiBMMTtcclxuICAgICAgICAgdjIueCArPSB0aGlzLm1faW52TWFzc0IgKiBQWDtcclxuICAgICAgICAgdjIueSArPSB0aGlzLm1faW52TWFzc0IgKiBQWTtcclxuICAgICAgICAgdzIgKz0gdGhpcy5tX2ludklCICogTDI7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIENkb3QxWCA9IHRoaXMubV9wZXJwLnggKiAodjIueCAtIHYxLngpICsgdGhpcy5tX3BlcnAueSAqICh2Mi55IC0gdjEueSkgKyB0aGlzLm1fczIgKiB3MiAtIHRoaXMubV9zMSAqIHcxO1xyXG4gICAgICB2YXIgQ2RvdDFZID0gdzIgLSB3MTtcclxuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdCkge1xyXG4gICAgICAgICB2YXIgQ2RvdDIgPSB0aGlzLm1fYXhpcy54ICogKHYyLnggLSB2MS54KSArIHRoaXMubV9heGlzLnkgKiAodjIueSAtIHYxLnkpICsgdGhpcy5tX2EyICogdzIgLSB0aGlzLm1fYTEgKiB3MTtcclxuICAgICAgICAgdmFyIGYxID0gdGhpcy5tX2ltcHVsc2UuQ29weSgpO1xyXG4gICAgICAgICB2YXIgZGYgPSB0aGlzLm1fSy5Tb2x2ZTMzKG5ldyBiMlZlYzMoKSwgKC1DZG90MVgpLCAoLUNkb3QxWSksICgtQ2RvdDIpKTtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UuQWRkKGRmKTtcclxuICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IGIySm9pbnQuZV9hdExvd2VyTGltaXQpIHtcclxuICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IGIyTWF0aC5NYXgodGhpcy5tX2ltcHVsc2UueiwgMC4wKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSBiMk1hdGguTWluKHRoaXMubV9pbXB1bHNlLnosIDAuMCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdmFyIGJYID0gKC1DZG90MVgpIC0gKHRoaXMubV9pbXB1bHNlLnogLSBmMS56KSAqIHRoaXMubV9LLmNvbDMueDtcclxuICAgICAgICAgdmFyIGJZID0gKC1DZG90MVkpIC0gKHRoaXMubV9pbXB1bHNlLnogLSBmMS56KSAqIHRoaXMubV9LLmNvbDMueTtcclxuICAgICAgICAgdmFyIGYyciA9IHRoaXMubV9LLlNvbHZlMjIobmV3IGIyVmVjMigpLCBiWCwgYlkpO1xyXG4gICAgICAgICBmMnIueCArPSBmMS54O1xyXG4gICAgICAgICBmMnIueSArPSBmMS55O1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS54ID0gZjJyLng7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgPSBmMnIueTtcclxuICAgICAgICAgZGYueCA9IHRoaXMubV9pbXB1bHNlLnggLSBmMS54O1xyXG4gICAgICAgICBkZi55ID0gdGhpcy5tX2ltcHVsc2UueSAtIGYxLnk7XHJcbiAgICAgICAgIGRmLnogPSB0aGlzLm1faW1wdWxzZS56IC0gZjEuejtcclxuICAgICAgICAgUFggPSBkZi54ICogdGhpcy5tX3BlcnAueCArIGRmLnogKiB0aGlzLm1fYXhpcy54O1xyXG4gICAgICAgICBQWSA9IGRmLnggKiB0aGlzLm1fcGVycC55ICsgZGYueiAqIHRoaXMubV9heGlzLnk7XHJcbiAgICAgICAgIEwxID0gZGYueCAqIHRoaXMubV9zMSArIGRmLnkgKyBkZi56ICogdGhpcy5tX2ExO1xyXG4gICAgICAgICBMMiA9IGRmLnggKiB0aGlzLm1fczIgKyBkZi55ICsgZGYueiAqIHRoaXMubV9hMjtcclxuICAgICAgICAgdjEueCAtPSB0aGlzLm1faW52TWFzc0EgKiBQWDtcclxuICAgICAgICAgdjEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcclxuICAgICAgICAgdzEgLT0gdGhpcy5tX2ludklBICogTDE7XHJcbiAgICAgICAgIHYyLnggKz0gdGhpcy5tX2ludk1hc3NCICogUFg7XHJcbiAgICAgICAgIHYyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XHJcbiAgICAgICAgIHcyICs9IHRoaXMubV9pbnZJQiAqIEwyO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB2YXIgZGYyID0gdGhpcy5tX0suU29sdmUyMihuZXcgYjJWZWMyKCksICgtQ2RvdDFYKSwgKC1DZG90MVkpKTtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSBkZjIueDtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueSArPSBkZjIueTtcclxuICAgICAgICAgUFggPSBkZjIueCAqIHRoaXMubV9wZXJwLng7XHJcbiAgICAgICAgIFBZID0gZGYyLnggKiB0aGlzLm1fcGVycC55O1xyXG4gICAgICAgICBMMSA9IGRmMi54ICogdGhpcy5tX3MxICsgZGYyLnk7XHJcbiAgICAgICAgIEwyID0gZGYyLnggKiB0aGlzLm1fczIgKyBkZjIueTtcclxuICAgICAgICAgdjEueCAtPSB0aGlzLm1faW52TWFzc0EgKiBQWDtcclxuICAgICAgICAgdjEueSAtPSB0aGlzLm1faW52TWFzc0EgKiBQWTtcclxuICAgICAgICAgdzEgLT0gdGhpcy5tX2ludklBICogTDE7XHJcbiAgICAgICAgIHYyLnggKz0gdGhpcy5tX2ludk1hc3NCICogUFg7XHJcbiAgICAgICAgIHYyLnkgKz0gdGhpcy5tX2ludk1hc3NCICogUFk7XHJcbiAgICAgICAgIHcyICs9IHRoaXMubV9pbnZJQiAqIEwyO1xyXG4gICAgICB9XHJcbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkuU2V0Vih2MSk7XHJcbiAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ID0gdzE7XHJcbiAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkuU2V0Vih2Mik7XHJcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ID0gdzI7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludC5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xyXG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XHJcbiAgICAgIHZhciBsaW1pdEMgPSAwO1xyXG4gICAgICB2YXIgb2xkTGltaXRJbXB1bHNlID0gMDtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciBjMSA9IGJBLm1fc3dlZXAuYztcclxuICAgICAgdmFyIGExID0gYkEubV9zd2VlcC5hO1xyXG4gICAgICB2YXIgYzIgPSBiQi5tX3N3ZWVwLmM7XHJcbiAgICAgIHZhciBhMiA9IGJCLm1fc3dlZXAuYTtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciB0WCA9IDA7XHJcbiAgICAgIHZhciBtMSA9IDA7XHJcbiAgICAgIHZhciBtMiA9IDA7XHJcbiAgICAgIHZhciBpMSA9IDA7XHJcbiAgICAgIHZhciBpMiA9IDA7XHJcbiAgICAgIHZhciBsaW5lYXJFcnJvciA9IDAuMDtcclxuICAgICAgdmFyIGFuZ3VsYXJFcnJvciA9IDAuMDtcclxuICAgICAgdmFyIGFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICB2YXIgQzIgPSAwLjA7XHJcbiAgICAgIHZhciBSMSA9IGIyTWF0MjIuRnJvbUFuZ2xlKGExKTtcclxuICAgICAgdmFyIFIyID0gYjJNYXQyMi5Gcm9tQW5nbGUoYTIpO1xyXG4gICAgICB0TWF0ID0gUjE7XHJcbiAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSB0aGlzLm1fbG9jYWxDZW50ZXJBLng7XHJcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSB0aGlzLm1fbG9jYWxDZW50ZXJBLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgIHIxWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gUjI7XHJcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSB0aGlzLm1fbG9jYWxDZW50ZXJCLng7XHJcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSB0aGlzLm1fbG9jYWxDZW50ZXJCLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgIHIyWCA9IHRYO1xyXG4gICAgICB2YXIgZFggPSBjMi54ICsgcjJYIC0gYzEueCAtIHIxWDtcclxuICAgICAgdmFyIGRZID0gYzIueSArIHIyWSAtIGMxLnkgLSByMVk7XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQpIHtcclxuICAgICAgICAgdGhpcy5tX2F4aXMgPSBiMk1hdGguTXVsTVYoUjEsIHRoaXMubV9sb2NhbFhBeGlzMSk7XHJcbiAgICAgICAgIHRoaXMubV9hMSA9IChkWCArIHIxWCkgKiB0aGlzLm1fYXhpcy55IC0gKGRZICsgcjFZKSAqIHRoaXMubV9heGlzLng7XHJcbiAgICAgICAgIHRoaXMubV9hMiA9IHIyWCAqIHRoaXMubV9heGlzLnkgLSByMlkgKiB0aGlzLm1fYXhpcy54O1xyXG4gICAgICAgICB2YXIgdHJhbnNsYXRpb24gPSB0aGlzLm1fYXhpcy54ICogZFggKyB0aGlzLm1fYXhpcy55ICogZFk7XHJcbiAgICAgICAgIGlmIChiMk1hdGguQWJzKHRoaXMubV91cHBlclRyYW5zbGF0aW9uIC0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIDwgMi4wICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XHJcbiAgICAgICAgICAgIEMyID0gYjJNYXRoLkNsYW1wKHRyYW5zbGF0aW9uLCAoLWIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbiksIGIyU2V0dGluZ3MuYjJfbWF4TGluZWFyQ29ycmVjdGlvbik7XHJcbiAgICAgICAgICAgIGxpbmVhckVycm9yID0gYjJNYXRoLkFicyh0cmFuc2xhdGlvbik7XHJcbiAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAodHJhbnNsYXRpb24gPD0gdGhpcy5tX2xvd2VyVHJhbnNsYXRpb24pIHtcclxuICAgICAgICAgICAgQzIgPSBiMk1hdGguQ2xhbXAodHJhbnNsYXRpb24gLSB0aGlzLm1fbG93ZXJUcmFuc2xhdGlvbiArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCAwLjApO1xyXG4gICAgICAgICAgICBsaW5lYXJFcnJvciA9IHRoaXMubV9sb3dlclRyYW5zbGF0aW9uIC0gdHJhbnNsYXRpb247XHJcbiAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAodHJhbnNsYXRpb24gPj0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb24pIHtcclxuICAgICAgICAgICAgQzIgPSBiMk1hdGguQ2xhbXAodHJhbnNsYXRpb24gLSB0aGlzLm1fdXBwZXJUcmFuc2xhdGlvbiArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgMC4wLCBiMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pO1xyXG4gICAgICAgICAgICBsaW5lYXJFcnJvciA9IHRyYW5zbGF0aW9uIC0gdGhpcy5tX3VwcGVyVHJhbnNsYXRpb247XHJcbiAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1fcGVycCA9IGIyTWF0aC5NdWxNVihSMSwgdGhpcy5tX2xvY2FsWUF4aXMxKTtcclxuICAgICAgdGhpcy5tX3MxID0gKGRYICsgcjFYKSAqIHRoaXMubV9wZXJwLnkgLSAoZFkgKyByMVkpICogdGhpcy5tX3BlcnAueDtcclxuICAgICAgdGhpcy5tX3MyID0gcjJYICogdGhpcy5tX3BlcnAueSAtIHIyWSAqIHRoaXMubV9wZXJwLng7XHJcbiAgICAgIHZhciBpbXB1bHNlID0gbmV3IGIyVmVjMygpO1xyXG4gICAgICB2YXIgQzFYID0gdGhpcy5tX3BlcnAueCAqIGRYICsgdGhpcy5tX3BlcnAueSAqIGRZO1xyXG4gICAgICB2YXIgQzFZID0gYTIgLSBhMSAtIHRoaXMubV9yZWZBbmdsZTtcclxuICAgICAgbGluZWFyRXJyb3IgPSBiMk1hdGguTWF4KGxpbmVhckVycm9yLCBiMk1hdGguQWJzKEMxWCkpO1xyXG4gICAgICBhbmd1bGFyRXJyb3IgPSBiMk1hdGguQWJzKEMxWSk7XHJcbiAgICAgIGlmIChhY3RpdmUpIHtcclxuICAgICAgICAgbTEgPSB0aGlzLm1faW52TWFzc0E7XHJcbiAgICAgICAgIG0yID0gdGhpcy5tX2ludk1hc3NCO1xyXG4gICAgICAgICBpMSA9IHRoaXMubV9pbnZJQTtcclxuICAgICAgICAgaTIgPSB0aGlzLm1faW52SUI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDEueCA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX3MyO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wxLnkgPSBpMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wxLnogPSBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9hMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX2EyO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wyLnggPSB0aGlzLm1fSy5jb2wxLnk7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueSA9IGkxICsgaTI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDIueiA9IGkxICogdGhpcy5tX2ExICsgaTIgKiB0aGlzLm1fYTI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDMueCA9IHRoaXMubV9LLmNvbDEuejtcclxuICAgICAgICAgdGhpcy5tX0suY29sMy55ID0gdGhpcy5tX0suY29sMi56O1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wzLnogPSBtMSArIG0yICsgaTEgKiB0aGlzLm1fYTEgKiB0aGlzLm1fYTEgKyBpMiAqIHRoaXMubV9hMiAqIHRoaXMubV9hMjtcclxuICAgICAgICAgdGhpcy5tX0suU29sdmUzMyhpbXB1bHNlLCAoLUMxWCksICgtQzFZKSwgKC1DMikpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICBtMSA9IHRoaXMubV9pbnZNYXNzQTtcclxuICAgICAgICAgbTIgPSB0aGlzLm1faW52TWFzc0I7XHJcbiAgICAgICAgIGkxID0gdGhpcy5tX2ludklBO1xyXG4gICAgICAgICBpMiA9IHRoaXMubV9pbnZJQjtcclxuICAgICAgICAgdmFyIGsxMSA9IG0xICsgbTIgKyBpMSAqIHRoaXMubV9zMSAqIHRoaXMubV9zMSArIGkyICogdGhpcy5tX3MyICogdGhpcy5tX3MyO1xyXG4gICAgICAgICB2YXIgazEyID0gaTEgKiB0aGlzLm1fczEgKyBpMiAqIHRoaXMubV9zMjtcclxuICAgICAgICAgdmFyIGsyMiA9IGkxICsgaTI7XHJcbiAgICAgICAgIHRoaXMubV9LLmNvbDEuU2V0KGsxMSwgazEyLCAwLjApO1xyXG4gICAgICAgICB0aGlzLm1fSy5jb2wyLlNldChrMTIsIGsyMiwgMC4wKTtcclxuICAgICAgICAgdmFyIGltcHVsc2UxID0gdGhpcy5tX0suU29sdmUyMihuZXcgYjJWZWMyKCksICgtQzFYKSwgKC1DMVkpKTtcclxuICAgICAgICAgaW1wdWxzZS54ID0gaW1wdWxzZTEueDtcclxuICAgICAgICAgaW1wdWxzZS55ID0gaW1wdWxzZTEueTtcclxuICAgICAgICAgaW1wdWxzZS56ID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBQWCA9IGltcHVsc2UueCAqIHRoaXMubV9wZXJwLnggKyBpbXB1bHNlLnogKiB0aGlzLm1fYXhpcy54O1xyXG4gICAgICB2YXIgUFkgPSBpbXB1bHNlLnggKiB0aGlzLm1fcGVycC55ICsgaW1wdWxzZS56ICogdGhpcy5tX2F4aXMueTtcclxuICAgICAgdmFyIEwxID0gaW1wdWxzZS54ICogdGhpcy5tX3MxICsgaW1wdWxzZS55ICsgaW1wdWxzZS56ICogdGhpcy5tX2ExO1xyXG4gICAgICB2YXIgTDIgPSBpbXB1bHNlLnggKiB0aGlzLm1fczIgKyBpbXB1bHNlLnkgKyBpbXB1bHNlLnogKiB0aGlzLm1fYTI7XHJcbiAgICAgIGMxLnggLT0gdGhpcy5tX2ludk1hc3NBICogUFg7XHJcbiAgICAgIGMxLnkgLT0gdGhpcy5tX2ludk1hc3NBICogUFk7XHJcbiAgICAgIGExIC09IHRoaXMubV9pbnZJQSAqIEwxO1xyXG4gICAgICBjMi54ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBYO1xyXG4gICAgICBjMi55ICs9IHRoaXMubV9pbnZNYXNzQiAqIFBZO1xyXG4gICAgICBhMiArPSB0aGlzLm1faW52SUIgKiBMMjtcclxuICAgICAgYkEubV9zd2VlcC5hID0gYTE7XHJcbiAgICAgIGJCLm1fc3dlZXAuYSA9IGEyO1xyXG4gICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICByZXR1cm4gbGluZWFyRXJyb3IgPD0gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wICYmIGFuZ3VsYXJFcnJvciA8PSBiMlNldHRpbmdzLmIyX2FuZ3VsYXJTbG9wO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJQcmlzbWF0aWNKb2ludERlZiwgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYpO1xyXG4gICBiMlByaXNtYXRpY0pvaW50RGVmLnByb3RvdHlwZS5fX3N1cGVyID0gQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYucHJvdG90eXBlO1xyXG4gICBiMlByaXNtYXRpY0pvaW50RGVmLmIyUHJpc21hdGljSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLmIySm9pbnREZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxvY2FsQXhpc0EgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyUHJpc21hdGljSm9pbnREZWYucHJvdG90eXBlLmIyUHJpc21hdGljSm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9wcmlzbWF0aWNKb2ludDtcclxuICAgICAgdGhpcy5sb2NhbEF4aXNBLlNldCgxLjAsIDAuMCk7XHJcbiAgICAgIHRoaXMucmVmZXJlbmNlQW5nbGUgPSAwLjA7XHJcbiAgICAgIHRoaXMuZW5hYmxlTGltaXQgPSBmYWxzZTtcclxuICAgICAgdGhpcy5sb3dlclRyYW5zbGF0aW9uID0gMC4wO1xyXG4gICAgICB0aGlzLnVwcGVyVHJhbnNsYXRpb24gPSAwLjA7XHJcbiAgICAgIHRoaXMuZW5hYmxlTW90b3IgPSBmYWxzZTtcclxuICAgICAgdGhpcy5tYXhNb3RvckZvcmNlID0gMC4wO1xyXG4gICAgICB0aGlzLm1vdG9yU3BlZWQgPSAwLjA7XHJcbiAgIH1cclxuICAgYjJQcmlzbWF0aWNKb2ludERlZi5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChiQSwgYkIsIGFuY2hvciwgYXhpcykge1xyXG4gICAgICB0aGlzLmJvZHlBID0gYkE7XHJcbiAgICAgIHRoaXMuYm9keUIgPSBiQjtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckEgPSB0aGlzLmJvZHlBLkdldExvY2FsUG9pbnQoYW5jaG9yKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSB0aGlzLmJvZHlCLkdldExvY2FsUG9pbnQoYW5jaG9yKTtcclxuICAgICAgdGhpcy5sb2NhbEF4aXNBID0gdGhpcy5ib2R5QS5HZXRMb2NhbFZlY3RvcihheGlzKTtcclxuICAgICAgdGhpcy5yZWZlcmVuY2VBbmdsZSA9IHRoaXMuYm9keUIuR2V0QW5nbGUoKSAtIHRoaXMuYm9keUEuR2V0QW5nbGUoKTtcclxuICAgfVxyXG4gICBCb3gyRC5pbmhlcml0KGIyUHVsbGV5Sm9pbnQsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50KTtcclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LnByb3RvdHlwZTtcclxuICAgYjJQdWxsZXlKb2ludC5iMlB1bGxleUpvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubV9ncm91bmRBbmNob3IxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fZ3JvdW5kQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMiA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5tX3UxID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLm1fdTIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLkdldEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlCLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yMik7XHJcbiAgIH1cclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV91Mi54LCBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZSAqIHRoaXMubV91Mi55KTtcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5HZXRSZWFjdGlvblRvcnF1ZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gMC4wO1xyXG4gICB9XHJcbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLkdldEdyb3VuZEFuY2hvckEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBhID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLkNvcHkoKTtcclxuICAgICAgYS5BZGQodGhpcy5tX2dyb3VuZEFuY2hvcjEpO1xyXG4gICAgICByZXR1cm4gYTtcclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5HZXRHcm91bmRBbmNob3JCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgYSA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi5Db3B5KCk7XHJcbiAgICAgIGEuQWRkKHRoaXMubV9ncm91bmRBbmNob3IyKTtcclxuICAgICAgcmV0dXJuIGE7XHJcbiAgIH1cclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0TGVuZ3RoMSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHAgPSB0aGlzLm1fYm9keUEuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IxKTtcclxuICAgICAgdmFyIHNYID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnggKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMS54O1xyXG4gICAgICB2YXIgc1kgPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueSArIHRoaXMubV9ncm91bmRBbmNob3IxLnk7XHJcbiAgICAgIHZhciBkWCA9IHAueCAtIHNYO1xyXG4gICAgICB2YXIgZFkgPSBwLnkgLSBzWTtcclxuICAgICAgcmV0dXJuIE1hdGguc3FydChkWCAqIGRYICsgZFkgKiBkWSk7XHJcbiAgIH1cclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0TGVuZ3RoMiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHAgPSB0aGlzLm1fYm9keUIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3IyKTtcclxuICAgICAgdmFyIHNYID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnggKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMi54O1xyXG4gICAgICB2YXIgc1kgPSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueSArIHRoaXMubV9ncm91bmRBbmNob3IyLnk7XHJcbiAgICAgIHZhciBkWCA9IHAueCAtIHNYO1xyXG4gICAgICB2YXIgZFkgPSBwLnkgLSBzWTtcclxuICAgICAgcmV0dXJuIE1hdGguc3FydChkWCAqIGRYICsgZFkgKiBkWSk7XHJcbiAgIH1cclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuR2V0UmF0aW8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fcmF0aW87XHJcbiAgIH1cclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuYjJQdWxsZXlKb2ludCA9IGZ1bmN0aW9uIChkZWYpIHtcclxuICAgICAgdGhpcy5fX3N1cGVyLmIySm9pbnQuY2FsbCh0aGlzLCBkZWYpO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIHRZID0gMDtcclxuICAgICAgdGhpcy5tX2dyb3VuZCA9IHRoaXMubV9ib2R5QS5tX3dvcmxkLm1fZ3JvdW5kQm9keTtcclxuICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjEueCA9IGRlZi5ncm91bmRBbmNob3JBLnggLSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueDtcclxuICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjEueSA9IGRlZi5ncm91bmRBbmNob3JBLnkgLSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueTtcclxuICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjIueCA9IGRlZi5ncm91bmRBbmNob3JCLnggLSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueDtcclxuICAgICAgdGhpcy5tX2dyb3VuZEFuY2hvcjIueSA9IGRlZi5ncm91bmRBbmNob3JCLnkgLSB0aGlzLm1fZ3JvdW5kLm1feGYucG9zaXRpb24ueTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMS5TZXRWKGRlZi5sb2NhbEFuY2hvckEpO1xyXG4gICAgICB0aGlzLm1fbG9jYWxBbmNob3IyLlNldFYoZGVmLmxvY2FsQW5jaG9yQik7XHJcbiAgICAgIHRoaXMubV9yYXRpbyA9IGRlZi5yYXRpbztcclxuICAgICAgdGhpcy5tX2NvbnN0YW50ID0gZGVmLmxlbmd0aEEgKyB0aGlzLm1fcmF0aW8gKiBkZWYubGVuZ3RoQjtcclxuICAgICAgdGhpcy5tX21heExlbmd0aDEgPSBiMk1hdGguTWluKGRlZi5tYXhMZW5ndGhBLCB0aGlzLm1fY29uc3RhbnQgLSB0aGlzLm1fcmF0aW8gKiBiMlB1bGxleUpvaW50LmIyX21pblB1bGxleUxlbmd0aCk7XHJcbiAgICAgIHRoaXMubV9tYXhMZW5ndGgyID0gYjJNYXRoLk1pbihkZWYubWF4TGVuZ3RoQiwgKHRoaXMubV9jb25zdGFudCAtIGIyUHVsbGV5Sm9pbnQuYjJfbWluUHVsbGV5TGVuZ3RoKSAvIHRoaXMubV9yYXRpbyk7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlID0gMC4wO1xyXG4gICAgICB0aGlzLm1fbGltaXRJbXB1bHNlMSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2xpbWl0SW1wdWxzZTIgPSAwLjA7XHJcbiAgIH1cclxuICAgYjJQdWxsZXlKb2ludC5wcm90b3R5cGUuSW5pdFZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHZhciB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICByMVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgcjJYID0gdFg7XHJcbiAgICAgIHZhciBwMVggPSBiQS5tX3N3ZWVwLmMueCArIHIxWDtcclxuICAgICAgdmFyIHAxWSA9IGJBLm1fc3dlZXAuYy55ICsgcjFZO1xyXG4gICAgICB2YXIgcDJYID0gYkIubV9zd2VlcC5jLnggKyByMlg7XHJcbiAgICAgIHZhciBwMlkgPSBiQi5tX3N3ZWVwLmMueSArIHIyWTtcclxuICAgICAgdmFyIHMxWCA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi54ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjEueDtcclxuICAgICAgdmFyIHMxWSA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi55ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjEueTtcclxuICAgICAgdmFyIHMyWCA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi54ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjIueDtcclxuICAgICAgdmFyIHMyWSA9IHRoaXMubV9ncm91bmQubV94Zi5wb3NpdGlvbi55ICsgdGhpcy5tX2dyb3VuZEFuY2hvcjIueTtcclxuICAgICAgdGhpcy5tX3UxLlNldChwMVggLSBzMVgsIHAxWSAtIHMxWSk7XHJcbiAgICAgIHRoaXMubV91Mi5TZXQocDJYIC0gczJYLCBwMlkgLSBzMlkpO1xyXG4gICAgICB2YXIgbGVuZ3RoMSA9IHRoaXMubV91MS5MZW5ndGgoKTtcclxuICAgICAgdmFyIGxlbmd0aDIgPSB0aGlzLm1fdTIuTGVuZ3RoKCk7XHJcbiAgICAgIGlmIChsZW5ndGgxID4gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XHJcbiAgICAgICAgIHRoaXMubV91MS5NdWx0aXBseSgxLjAgLyBsZW5ndGgxKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX3UxLlNldFplcm8oKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAobGVuZ3RoMiA+IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCkge1xyXG4gICAgICAgICB0aGlzLm1fdTIuTXVsdGlwbHkoMS4wIC8gbGVuZ3RoMik7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV91Mi5TZXRaZXJvKCk7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIEMgPSB0aGlzLm1fY29uc3RhbnQgLSBsZW5ndGgxIC0gdGhpcy5tX3JhdGlvICogbGVuZ3RoMjtcclxuICAgICAgaWYgKEMgPiAwLjApIHtcclxuICAgICAgICAgdGhpcy5tX3N0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fc3RhdGUgPSBiMkpvaW50LmVfYXRVcHBlckxpbWl0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChsZW5ndGgxIDwgdGhpcy5tX21heExlbmd0aDEpIHtcclxuICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUxID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XHJcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UxID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZTEgPSBiMkpvaW50LmVfYXRVcHBlckxpbWl0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChsZW5ndGgyIDwgdGhpcy5tX21heExlbmd0aDIpIHtcclxuICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUyID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XHJcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UyID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZTIgPSBiMkpvaW50LmVfYXRVcHBlckxpbWl0O1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBjcjF1MSA9IHIxWCAqIHRoaXMubV91MS55IC0gcjFZICogdGhpcy5tX3UxLng7XHJcbiAgICAgIHZhciBjcjJ1MiA9IHIyWCAqIHRoaXMubV91Mi55IC0gcjJZICogdGhpcy5tX3UyLng7XHJcbiAgICAgIHRoaXMubV9saW1pdE1hc3MxID0gYkEubV9pbnZNYXNzICsgYkEubV9pbnZJICogY3IxdTEgKiBjcjF1MTtcclxuICAgICAgdGhpcy5tX2xpbWl0TWFzczIgPSBiQi5tX2ludk1hc3MgKyBiQi5tX2ludkkgKiBjcjJ1MiAqIGNyMnUyO1xyXG4gICAgICB0aGlzLm1fcHVsbGV5TWFzcyA9IHRoaXMubV9saW1pdE1hc3MxICsgdGhpcy5tX3JhdGlvICogdGhpcy5tX3JhdGlvICogdGhpcy5tX2xpbWl0TWFzczI7XHJcbiAgICAgIHRoaXMubV9saW1pdE1hc3MxID0gMS4wIC8gdGhpcy5tX2xpbWl0TWFzczE7XHJcbiAgICAgIHRoaXMubV9saW1pdE1hc3MyID0gMS4wIC8gdGhpcy5tX2xpbWl0TWFzczI7XHJcbiAgICAgIHRoaXMubV9wdWxsZXlNYXNzID0gMS4wIC8gdGhpcy5tX3B1bGxleU1hc3M7XHJcbiAgICAgIGlmIChzdGVwLndhcm1TdGFydGluZykge1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZSAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UxICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdGhpcy5tX2xpbWl0SW1wdWxzZTIgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB2YXIgUDFYID0gKCgtdGhpcy5tX2ltcHVsc2UpIC0gdGhpcy5tX2xpbWl0SW1wdWxzZTEpICogdGhpcy5tX3UxLng7XHJcbiAgICAgICAgIHZhciBQMVkgPSAoKC10aGlzLm1faW1wdWxzZSkgLSB0aGlzLm1fbGltaXRJbXB1bHNlMSkgKiB0aGlzLm1fdTEueTtcclxuICAgICAgICAgdmFyIFAyWCA9ICgoLXRoaXMubV9yYXRpbyAqIHRoaXMubV9pbXB1bHNlKSAtIHRoaXMubV9saW1pdEltcHVsc2UyKSAqIHRoaXMubV91Mi54O1xyXG4gICAgICAgICB2YXIgUDJZID0gKCgtdGhpcy5tX3JhdGlvICogdGhpcy5tX2ltcHVsc2UpIC0gdGhpcy5tX2xpbWl0SW1wdWxzZTIpICogdGhpcy5tX3UyLnk7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQS5tX2ludk1hc3MgKiBQMVg7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQS5tX2ludk1hc3MgKiBQMVk7XHJcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJBLm1faW52SSAqIChyMVggKiBQMVkgLSByMVkgKiBQMVgpO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkIubV9pbnZNYXNzICogUDJYO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkIubV9pbnZNYXNzICogUDJZO1xyXG4gICAgICAgICBiQi5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiQi5tX2ludkkgKiAocjJYICogUDJZIC0gcjJZICogUDJYKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UgPSAwLjA7XHJcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UxID0gMC4wO1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRJbXB1bHNlMiA9IDAuMDtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyUHVsbGV5Sm9pbnQucHJvdG90eXBlLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdmFyIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgIHIxWCA9IHRYO1xyXG4gICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICByMlggPSB0WDtcclxuICAgICAgdmFyIHYxWCA9IDA7XHJcbiAgICAgIHZhciB2MVkgPSAwO1xyXG4gICAgICB2YXIgdjJYID0gMDtcclxuICAgICAgdmFyIHYyWSA9IDA7XHJcbiAgICAgIHZhciBQMVggPSAwO1xyXG4gICAgICB2YXIgUDFZID0gMDtcclxuICAgICAgdmFyIFAyWCA9IDA7XHJcbiAgICAgIHZhciBQMlkgPSAwO1xyXG4gICAgICB2YXIgQ2RvdCA9IDA7XHJcbiAgICAgIHZhciBpbXB1bHNlID0gMDtcclxuICAgICAgdmFyIG9sZEltcHVsc2UgPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX3N0YXRlID09IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcclxuICAgICAgICAgdjFYID0gYkEubV9saW5lYXJWZWxvY2l0eS54ICsgKCgtYkEubV9hbmd1bGFyVmVsb2NpdHkgKiByMVkpKTtcclxuICAgICAgICAgdjFZID0gYkEubV9saW5lYXJWZWxvY2l0eS55ICsgKGJBLm1fYW5ndWxhclZlbG9jaXR5ICogcjFYKTtcclxuICAgICAgICAgdjJYID0gYkIubV9saW5lYXJWZWxvY2l0eS54ICsgKCgtYkIubV9hbmd1bGFyVmVsb2NpdHkgKiByMlkpKTtcclxuICAgICAgICAgdjJZID0gYkIubV9saW5lYXJWZWxvY2l0eS55ICsgKGJCLm1fYW5ndWxhclZlbG9jaXR5ICogcjJYKTtcclxuICAgICAgICAgQ2RvdCA9ICgtKHRoaXMubV91MS54ICogdjFYICsgdGhpcy5tX3UxLnkgKiB2MVkpKSAtIHRoaXMubV9yYXRpbyAqICh0aGlzLm1fdTIueCAqIHYyWCArIHRoaXMubV91Mi55ICogdjJZKTtcclxuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9wdWxsZXlNYXNzICogKCgtQ2RvdCkpO1xyXG4gICAgICAgICBvbGRJbXB1bHNlID0gdGhpcy5tX2ltcHVsc2U7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlID0gYjJNYXRoLk1heCgwLjAsIHRoaXMubV9pbXB1bHNlICsgaW1wdWxzZSk7XHJcbiAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1faW1wdWxzZSAtIG9sZEltcHVsc2U7XHJcbiAgICAgICAgIFAxWCA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS54KTtcclxuICAgICAgICAgUDFZID0gKC1pbXB1bHNlICogdGhpcy5tX3UxLnkpO1xyXG4gICAgICAgICBQMlggPSAoLXRoaXMubV9yYXRpbyAqIGltcHVsc2UgKiB0aGlzLm1fdTIueCk7XHJcbiAgICAgICAgIFAyWSA9ICgtdGhpcy5tX3JhdGlvICogaW1wdWxzZSAqIHRoaXMubV91Mi55KTtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54ICs9IGJBLm1faW52TWFzcyAqIFAxWDtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS55ICs9IGJBLm1faW52TWFzcyAqIFAxWTtcclxuICAgICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkEubV9pbnZJICogKHIxWCAqIFAxWSAtIHIxWSAqIFAxWCk7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBiQi5tX2ludk1hc3MgKiBQMlg7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSBiQi5tX2ludk1hc3MgKiBQMlk7XHJcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGJCLm1faW52SSAqIChyMlggKiBQMlkgLSByMlkgKiBQMlgpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZTEgPT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICB2MVggPSBiQS5tX2xpbmVhclZlbG9jaXR5LnggKyAoKC1iQS5tX2FuZ3VsYXJWZWxvY2l0eSAqIHIxWSkpO1xyXG4gICAgICAgICB2MVkgPSBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKyAoYkEubV9hbmd1bGFyVmVsb2NpdHkgKiByMVgpO1xyXG4gICAgICAgICBDZG90ID0gKC0odGhpcy5tX3UxLnggKiB2MVggKyB0aGlzLm1fdTEueSAqIHYxWSkpO1xyXG4gICAgICAgICBpbXB1bHNlID0gKC10aGlzLm1fbGltaXRNYXNzMSAqIENkb3QpO1xyXG4gICAgICAgICBvbGRJbXB1bHNlID0gdGhpcy5tX2xpbWl0SW1wdWxzZTE7XHJcbiAgICAgICAgIHRoaXMubV9saW1pdEltcHVsc2UxID0gYjJNYXRoLk1heCgwLjAsIHRoaXMubV9saW1pdEltcHVsc2UxICsgaW1wdWxzZSk7XHJcbiAgICAgICAgIGltcHVsc2UgPSB0aGlzLm1fbGltaXRJbXB1bHNlMSAtIG9sZEltcHVsc2U7XHJcbiAgICAgICAgIFAxWCA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS54KTtcclxuICAgICAgICAgUDFZID0gKC1pbXB1bHNlICogdGhpcy5tX3UxLnkpO1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnggKz0gYkEubV9pbnZNYXNzICogUDFYO1xyXG4gICAgICAgICBiQS5tX2xpbmVhclZlbG9jaXR5LnkgKz0gYkEubV9pbnZNYXNzICogUDFZO1xyXG4gICAgICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSArPSBiQS5tX2ludkkgKiAocjFYICogUDFZIC0gcjFZICogUDFYKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2xpbWl0U3RhdGUyID09IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcclxuICAgICAgICAgdjJYID0gYkIubV9saW5lYXJWZWxvY2l0eS54ICsgKCgtYkIubV9hbmd1bGFyVmVsb2NpdHkgKiByMlkpKTtcclxuICAgICAgICAgdjJZID0gYkIubV9saW5lYXJWZWxvY2l0eS55ICsgKGJCLm1fYW5ndWxhclZlbG9jaXR5ICogcjJYKTtcclxuICAgICAgICAgQ2RvdCA9ICgtKHRoaXMubV91Mi54ICogdjJYICsgdGhpcy5tX3UyLnkgKiB2MlkpKTtcclxuICAgICAgICAgaW1wdWxzZSA9ICgtdGhpcy5tX2xpbWl0TWFzczIgKiBDZG90KTtcclxuICAgICAgICAgb2xkSW1wdWxzZSA9IHRoaXMubV9saW1pdEltcHVsc2UyO1xyXG4gICAgICAgICB0aGlzLm1fbGltaXRJbXB1bHNlMiA9IGIyTWF0aC5NYXgoMC4wLCB0aGlzLm1fbGltaXRJbXB1bHNlMiArIGltcHVsc2UpO1xyXG4gICAgICAgICBpbXB1bHNlID0gdGhpcy5tX2xpbWl0SW1wdWxzZTIgLSBvbGRJbXB1bHNlO1xyXG4gICAgICAgICBQMlggPSAoLWltcHVsc2UgKiB0aGlzLm1fdTIueCk7XHJcbiAgICAgICAgIFAyWSA9ICgtaW1wdWxzZSAqIHRoaXMubV91Mi55KTtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS54ICs9IGJCLm1faW52TWFzcyAqIFAyWDtcclxuICAgICAgICAgYkIubV9saW5lYXJWZWxvY2l0eS55ICs9IGJCLm1faW52TWFzcyAqIFAyWTtcclxuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gYkIubV9pbnZJICogKHIyWCAqIFAyWSAtIHIyWSAqIFAyWCk7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlB1bGxleUpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XHJcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgczFYID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnggKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMS54O1xyXG4gICAgICB2YXIgczFZID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnkgKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMS55O1xyXG4gICAgICB2YXIgczJYID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnggKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMi54O1xyXG4gICAgICB2YXIgczJZID0gdGhpcy5tX2dyb3VuZC5tX3hmLnBvc2l0aW9uLnkgKyB0aGlzLm1fZ3JvdW5kQW5jaG9yMi55O1xyXG4gICAgICB2YXIgcjFYID0gMDtcclxuICAgICAgdmFyIHIxWSA9IDA7XHJcbiAgICAgIHZhciByMlggPSAwO1xyXG4gICAgICB2YXIgcjJZID0gMDtcclxuICAgICAgdmFyIHAxWCA9IDA7XHJcbiAgICAgIHZhciBwMVkgPSAwO1xyXG4gICAgICB2YXIgcDJYID0gMDtcclxuICAgICAgdmFyIHAyWSA9IDA7XHJcbiAgICAgIHZhciBsZW5ndGgxID0gMDtcclxuICAgICAgdmFyIGxlbmd0aDIgPSAwO1xyXG4gICAgICB2YXIgQyA9IDA7XHJcbiAgICAgIHZhciBpbXB1bHNlID0gMDtcclxuICAgICAgdmFyIG9sZEltcHVsc2UgPSAwO1xyXG4gICAgICB2YXIgb2xkTGltaXRQb3NpdGlvbkltcHVsc2UgPSAwO1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgbGluZWFyRXJyb3IgPSAwLjA7XHJcbiAgICAgIGlmICh0aGlzLm1fc3RhdGUgPT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICAgICByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgICAgIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgICAgcjFYID0gdFg7XHJcbiAgICAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgICAgIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgICAgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICAgICByMlggPSB0WDtcclxuICAgICAgICAgcDFYID0gYkEubV9zd2VlcC5jLnggKyByMVg7XHJcbiAgICAgICAgIHAxWSA9IGJBLm1fc3dlZXAuYy55ICsgcjFZO1xyXG4gICAgICAgICBwMlggPSBiQi5tX3N3ZWVwLmMueCArIHIyWDtcclxuICAgICAgICAgcDJZID0gYkIubV9zd2VlcC5jLnkgKyByMlk7XHJcbiAgICAgICAgIHRoaXMubV91MS5TZXQocDFYIC0gczFYLCBwMVkgLSBzMVkpO1xyXG4gICAgICAgICB0aGlzLm1fdTIuU2V0KHAyWCAtIHMyWCwgcDJZIC0gczJZKTtcclxuICAgICAgICAgbGVuZ3RoMSA9IHRoaXMubV91MS5MZW5ndGgoKTtcclxuICAgICAgICAgbGVuZ3RoMiA9IHRoaXMubV91Mi5MZW5ndGgoKTtcclxuICAgICAgICAgaWYgKGxlbmd0aDEgPiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgICAgICAgdGhpcy5tX3UxLk11bHRpcGx5KDEuMCAvIGxlbmd0aDEpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1fdTEuU2V0WmVybygpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGlmIChsZW5ndGgyID4gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV91Mi5NdWx0aXBseSgxLjAgLyBsZW5ndGgyKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tX3UyLlNldFplcm8oKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBDID0gdGhpcy5tX2NvbnN0YW50IC0gbGVuZ3RoMSAtIHRoaXMubV9yYXRpbyAqIGxlbmd0aDI7XHJcbiAgICAgICAgIGxpbmVhckVycm9yID0gYjJNYXRoLk1heChsaW5lYXJFcnJvciwgKC1DKSk7XHJcbiAgICAgICAgIEMgPSBiMk1hdGguQ2xhbXAoQyArIGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCwgKC1iMlNldHRpbmdzLmIyX21heExpbmVhckNvcnJlY3Rpb24pLCAwLjApO1xyXG4gICAgICAgICBpbXB1bHNlID0gKC10aGlzLm1fcHVsbGV5TWFzcyAqIEMpO1xyXG4gICAgICAgICBwMVggPSAoLWltcHVsc2UgKiB0aGlzLm1fdTEueCk7XHJcbiAgICAgICAgIHAxWSA9ICgtaW1wdWxzZSAqIHRoaXMubV91MS55KTtcclxuICAgICAgICAgcDJYID0gKC10aGlzLm1fcmF0aW8gKiBpbXB1bHNlICogdGhpcy5tX3UyLngpO1xyXG4gICAgICAgICBwMlkgPSAoLXRoaXMubV9yYXRpbyAqIGltcHVsc2UgKiB0aGlzLm1fdTIueSk7XHJcbiAgICAgICAgIGJBLm1fc3dlZXAuYy54ICs9IGJBLm1faW52TWFzcyAqIHAxWDtcclxuICAgICAgICAgYkEubV9zd2VlcC5jLnkgKz0gYkEubV9pbnZNYXNzICogcDFZO1xyXG4gICAgICAgICBiQS5tX3N3ZWVwLmEgKz0gYkEubV9pbnZJICogKHIxWCAqIHAxWSAtIHIxWSAqIHAxWCk7XHJcbiAgICAgICAgIGJCLm1fc3dlZXAuYy54ICs9IGJCLm1faW52TWFzcyAqIHAyWDtcclxuICAgICAgICAgYkIubV9zd2VlcC5jLnkgKz0gYkIubV9pbnZNYXNzICogcDJZO1xyXG4gICAgICAgICBiQi5tX3N3ZWVwLmEgKz0gYkIubV9pbnZJICogKHIyWCAqIHAyWSAtIHIyWSAqIHAyWCk7XHJcbiAgICAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgICAgIGJCLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlMSA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XHJcbiAgICAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgICAgIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgICAgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICAgICByMVggPSB0WDtcclxuICAgICAgICAgcDFYID0gYkEubV9zd2VlcC5jLnggKyByMVg7XHJcbiAgICAgICAgIHAxWSA9IGJBLm1fc3dlZXAuYy55ICsgcjFZO1xyXG4gICAgICAgICB0aGlzLm1fdTEuU2V0KHAxWCAtIHMxWCwgcDFZIC0gczFZKTtcclxuICAgICAgICAgbGVuZ3RoMSA9IHRoaXMubV91MS5MZW5ndGgoKTtcclxuICAgICAgICAgaWYgKGxlbmd0aDEgPiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgICAgICAgdGhpcy5tX3UxLnggKj0gMS4wIC8gbGVuZ3RoMTtcclxuICAgICAgICAgICAgdGhpcy5tX3UxLnkgKj0gMS4wIC8gbGVuZ3RoMTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tX3UxLlNldFplcm8oKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBDID0gdGhpcy5tX21heExlbmd0aDEgLSBsZW5ndGgxO1xyXG4gICAgICAgICBsaW5lYXJFcnJvciA9IGIyTWF0aC5NYXgobGluZWFyRXJyb3IsICgtQykpO1xyXG4gICAgICAgICBDID0gYjJNYXRoLkNsYW1wKEMgKyBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AsICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgMC4wKTtcclxuICAgICAgICAgaW1wdWxzZSA9ICgtdGhpcy5tX2xpbWl0TWFzczEgKiBDKTtcclxuICAgICAgICAgcDFYID0gKC1pbXB1bHNlICogdGhpcy5tX3UxLngpO1xyXG4gICAgICAgICBwMVkgPSAoLWltcHVsc2UgKiB0aGlzLm1fdTEueSk7XHJcbiAgICAgICAgIGJBLm1fc3dlZXAuYy54ICs9IGJBLm1faW52TWFzcyAqIHAxWDtcclxuICAgICAgICAgYkEubV9zd2VlcC5jLnkgKz0gYkEubV9pbnZNYXNzICogcDFZO1xyXG4gICAgICAgICBiQS5tX3N3ZWVwLmEgKz0gYkEubV9pbnZJICogKHIxWCAqIHAxWSAtIHIxWSAqIHAxWCk7XHJcbiAgICAgICAgIGJBLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlMiA9PSBiMkpvaW50LmVfYXRVcHBlckxpbWl0KSB7XHJcbiAgICAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgICAgIHIyWCA9IHRoaXMubV9sb2NhbEFuY2hvcjIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgICAgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICAgICByMlggPSB0WDtcclxuICAgICAgICAgcDJYID0gYkIubV9zd2VlcC5jLnggKyByMlg7XHJcbiAgICAgICAgIHAyWSA9IGJCLm1fc3dlZXAuYy55ICsgcjJZO1xyXG4gICAgICAgICB0aGlzLm1fdTIuU2V0KHAyWCAtIHMyWCwgcDJZIC0gczJZKTtcclxuICAgICAgICAgbGVuZ3RoMiA9IHRoaXMubV91Mi5MZW5ndGgoKTtcclxuICAgICAgICAgaWYgKGxlbmd0aDIgPiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3ApIHtcclxuICAgICAgICAgICAgdGhpcy5tX3UyLnggKj0gMS4wIC8gbGVuZ3RoMjtcclxuICAgICAgICAgICAgdGhpcy5tX3UyLnkgKj0gMS4wIC8gbGVuZ3RoMjtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5tX3UyLlNldFplcm8oKTtcclxuICAgICAgICAgfVxyXG4gICAgICAgICBDID0gdGhpcy5tX21heExlbmd0aDIgLSBsZW5ndGgyO1xyXG4gICAgICAgICBsaW5lYXJFcnJvciA9IGIyTWF0aC5NYXgobGluZWFyRXJyb3IsICgtQykpO1xyXG4gICAgICAgICBDID0gYjJNYXRoLkNsYW1wKEMgKyBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3AsICgtYjJTZXR0aW5ncy5iMl9tYXhMaW5lYXJDb3JyZWN0aW9uKSwgMC4wKTtcclxuICAgICAgICAgaW1wdWxzZSA9ICgtdGhpcy5tX2xpbWl0TWFzczIgKiBDKTtcclxuICAgICAgICAgcDJYID0gKC1pbXB1bHNlICogdGhpcy5tX3UyLngpO1xyXG4gICAgICAgICBwMlkgPSAoLWltcHVsc2UgKiB0aGlzLm1fdTIueSk7XHJcbiAgICAgICAgIGJCLm1fc3dlZXAuYy54ICs9IGJCLm1faW52TWFzcyAqIHAyWDtcclxuICAgICAgICAgYkIubV9zd2VlcC5jLnkgKz0gYkIubV9pbnZNYXNzICogcDJZO1xyXG4gICAgICAgICBiQi5tX3N3ZWVwLmEgKz0gYkIubV9pbnZJICogKHIyWCAqIHAyWSAtIHIyWSAqIHAyWCk7XHJcbiAgICAgICAgIGJCLlN5bmNocm9uaXplVHJhbnNmb3JtKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGxpbmVhckVycm9yIDwgYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xyXG4gICB9XHJcbiAgIEJveDJELnBvc3REZWZzLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJQdWxsZXlKb2ludC5iMl9taW5QdWxsZXlMZW5ndGggPSAyLjA7XHJcbiAgIH0pO1xyXG4gICBCb3gyRC5pbmhlcml0KGIyUHVsbGV5Sm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcclxuICAgYjJQdWxsZXlKb2ludERlZi5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLnByb3RvdHlwZTtcclxuICAgYjJQdWxsZXlKb2ludERlZi5iMlB1bGxleUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMuZ3JvdW5kQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5ncm91bmRBbmNob3JCID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyUHVsbGV5Sm9pbnREZWYucHJvdG90eXBlLmIyUHVsbGV5Sm9pbnREZWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX19zdXBlci5iMkpvaW50RGVmLmNhbGwodGhpcyk7XHJcbiAgICAgIHRoaXMudHlwZSA9IGIySm9pbnQuZV9wdWxsZXlKb2ludDtcclxuICAgICAgdGhpcy5ncm91bmRBbmNob3JBLlNldCgoLTEuMCksIDEuMCk7XHJcbiAgICAgIHRoaXMuZ3JvdW5kQW5jaG9yQi5TZXQoMS4wLCAxLjApO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQS5TZXQoKC0xLjApLCAwLjApO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQi5TZXQoMS4wLCAwLjApO1xyXG4gICAgICB0aGlzLmxlbmd0aEEgPSAwLjA7XHJcbiAgICAgIHRoaXMubWF4TGVuZ3RoQSA9IDAuMDtcclxuICAgICAgdGhpcy5sZW5ndGhCID0gMC4wO1xyXG4gICAgICB0aGlzLm1heExlbmd0aEIgPSAwLjA7XHJcbiAgICAgIHRoaXMucmF0aW8gPSAxLjA7XHJcbiAgICAgIHRoaXMuY29sbGlkZUNvbm5lY3RlZCA9IHRydWU7XHJcbiAgIH1cclxuICAgYjJQdWxsZXlKb2ludERlZi5wcm90b3R5cGUuSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChiQSwgYkIsIGdhQSwgZ2FCLCBhbmNob3JBLCBhbmNob3JCLCByKSB7XHJcbiAgICAgIGlmIChyID09PSB1bmRlZmluZWQpIHIgPSAwO1xyXG4gICAgICB0aGlzLmJvZHlBID0gYkE7XHJcbiAgICAgIHRoaXMuYm9keUIgPSBiQjtcclxuICAgICAgdGhpcy5ncm91bmRBbmNob3JBLlNldFYoZ2FBKTtcclxuICAgICAgdGhpcy5ncm91bmRBbmNob3JCLlNldFYoZ2FCKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckEgPSB0aGlzLmJvZHlBLkdldExvY2FsUG9pbnQoYW5jaG9yQSk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gdGhpcy5ib2R5Qi5HZXRMb2NhbFBvaW50KGFuY2hvckIpO1xyXG4gICAgICB2YXIgZDFYID0gYW5jaG9yQS54IC0gZ2FBLng7XHJcbiAgICAgIHZhciBkMVkgPSBhbmNob3JBLnkgLSBnYUEueTtcclxuICAgICAgdGhpcy5sZW5ndGhBID0gTWF0aC5zcXJ0KGQxWCAqIGQxWCArIGQxWSAqIGQxWSk7XHJcbiAgICAgIHZhciBkMlggPSBhbmNob3JCLnggLSBnYUIueDtcclxuICAgICAgdmFyIGQyWSA9IGFuY2hvckIueSAtIGdhQi55O1xyXG4gICAgICB0aGlzLmxlbmd0aEIgPSBNYXRoLnNxcnQoZDJYICogZDJYICsgZDJZICogZDJZKTtcclxuICAgICAgdGhpcy5yYXRpbyA9IHI7XHJcbiAgICAgIHZhciBDID0gdGhpcy5sZW5ndGhBICsgdGhpcy5yYXRpbyAqIHRoaXMubGVuZ3RoQjtcclxuICAgICAgdGhpcy5tYXhMZW5ndGhBID0gQyAtIHRoaXMucmF0aW8gKiBiMlB1bGxleUpvaW50LmIyX21pblB1bGxleUxlbmd0aDtcclxuICAgICAgdGhpcy5tYXhMZW5ndGhCID0gKEMgLSBiMlB1bGxleUpvaW50LmIyX21pblB1bGxleUxlbmd0aCkgLyB0aGlzLnJhdGlvO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJSZXZvbHV0ZUpvaW50LCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludCk7XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50LnByb3RvdHlwZTtcclxuICAgYjJSZXZvbHV0ZUpvaW50LmIyUmV2b2x1dGVKb2ludCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnQuYjJKb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLksgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICB0aGlzLksxID0gbmV3IGIyTWF0MjIoKTtcclxuICAgICAgdGhpcy5LMiA9IG5ldyBiMk1hdDIyKCk7XHJcbiAgICAgIHRoaXMuSzMgPSBuZXcgYjJNYXQyMigpO1xyXG4gICAgICB0aGlzLmltcHVsc2UzID0gbmV3IGIyVmVjMygpO1xyXG4gICAgICB0aGlzLmltcHVsc2UyID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLnJlZHVjZWQgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlID0gbmV3IGIyVmVjMygpO1xyXG4gICAgICB0aGlzLm1fbWFzcyA9IG5ldyBiMk1hdDMzKCk7XHJcbiAgIH07XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5QS5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjEpO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0QW5jaG9yQiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5HZXRXb3JsZFBvaW50KHRoaXMubV9sb2NhbEFuY2hvcjIpO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS54LCBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS55KTtcclxuICAgfVxyXG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLkdldFJlYWN0aW9uVG9ycXVlID0gZnVuY3Rpb24gKGludl9kdCkge1xyXG4gICAgICBpZiAoaW52X2R0ID09PSB1bmRlZmluZWQpIGludl9kdCA9IDA7XHJcbiAgICAgIHJldHVybiBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS56O1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0Sm9pbnRBbmdsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5tX3N3ZWVwLmEgLSB0aGlzLm1fYm9keUEubV9zd2VlcC5hIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0Sm9pbnRTcGVlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9ib2R5Qi5tX2FuZ3VsYXJWZWxvY2l0eSAtIHRoaXMubV9ib2R5QS5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgfVxyXG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLklzTGltaXRFbmFibGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZUxpbWl0O1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuRW5hYmxlTGltaXQgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBmbGFnO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0TG93ZXJMaW1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9sb3dlckFuZ2xlO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuR2V0VXBwZXJMaW1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV91cHBlckFuZ2xlO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuU2V0TGltaXRzID0gZnVuY3Rpb24gKGxvd2VyLCB1cHBlcikge1xyXG4gICAgICBpZiAobG93ZXIgPT09IHVuZGVmaW5lZCkgbG93ZXIgPSAwO1xyXG4gICAgICBpZiAodXBwZXIgPT09IHVuZGVmaW5lZCkgdXBwZXIgPSAwO1xyXG4gICAgICB0aGlzLm1fbG93ZXJBbmdsZSA9IGxvd2VyO1xyXG4gICAgICB0aGlzLm1fdXBwZXJBbmdsZSA9IHVwcGVyO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuSXNNb3RvckVuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9ib2R5QS5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX2JvZHlCLlNldEF3YWtlKHRydWUpO1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2VuYWJsZU1vdG9yO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuRW5hYmxlTW90b3IgPSBmdW5jdGlvbiAoZmxhZykge1xyXG4gICAgICB0aGlzLm1fZW5hYmxlTW90b3IgPSBmbGFnO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuU2V0TW90b3JTcGVlZCA9IGZ1bmN0aW9uIChzcGVlZCkge1xyXG4gICAgICBpZiAoc3BlZWQgPT09IHVuZGVmaW5lZCkgc3BlZWQgPSAwO1xyXG4gICAgICB0aGlzLm1fYm9keUEuU2V0QXdha2UodHJ1ZSk7XHJcbiAgICAgIHRoaXMubV9ib2R5Qi5TZXRBd2FrZSh0cnVlKTtcclxuICAgICAgdGhpcy5tX21vdG9yU3BlZWQgPSBzcGVlZDtcclxuICAgfVxyXG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLkdldE1vdG9yU3BlZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fbW90b3JTcGVlZDtcclxuICAgfVxyXG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLlNldE1heE1vdG9yVG9ycXVlID0gZnVuY3Rpb24gKHRvcnF1ZSkge1xyXG4gICAgICBpZiAodG9ycXVlID09PSB1bmRlZmluZWQpIHRvcnF1ZSA9IDA7XHJcbiAgICAgIHRoaXMubV9tYXhNb3RvclRvcnF1ZSA9IHRvcnF1ZTtcclxuICAgfVxyXG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLkdldE1vdG9yVG9ycXVlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX21heE1vdG9yVG9ycXVlO1xyXG4gICB9XHJcbiAgIGIyUmV2b2x1dGVKb2ludC5wcm90b3R5cGUuYjJSZXZvbHV0ZUpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvcjEuU2V0VihkZWYubG9jYWxBbmNob3JBKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yMi5TZXRWKGRlZi5sb2NhbEFuY2hvckIpO1xyXG4gICAgICB0aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBkZWYucmVmZXJlbmNlQW5nbGU7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX21vdG9ySW1wdWxzZSA9IDAuMDtcclxuICAgICAgdGhpcy5tX2xvd2VyQW5nbGUgPSBkZWYubG93ZXJBbmdsZTtcclxuICAgICAgdGhpcy5tX3VwcGVyQW5nbGUgPSBkZWYudXBwZXJBbmdsZTtcclxuICAgICAgdGhpcy5tX21heE1vdG9yVG9ycXVlID0gZGVmLm1heE1vdG9yVG9ycXVlO1xyXG4gICAgICB0aGlzLm1fbW90b3JTcGVlZCA9IGRlZi5tb3RvclNwZWVkO1xyXG4gICAgICB0aGlzLm1fZW5hYmxlTGltaXQgPSBkZWYuZW5hYmxlTGltaXQ7XHJcbiAgICAgIHRoaXMubV9lbmFibGVNb3RvciA9IGRlZi5lbmFibGVNb3RvcjtcclxuICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgfVxyXG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLkluaXRWZWxvY2l0eUNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKHN0ZXApIHtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZU1vdG9yIHx8IHRoaXMubV9lbmFibGVMaW1pdCkge31cclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHIxWSA9IHRoaXMubV9sb2NhbEFuY2hvcjEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMVggKyB0TWF0LmNvbDIueCAqIHIxWSk7XHJcbiAgICAgIHIxWSA9ICh0TWF0LmNvbDEueSAqIHIxWCArIHRNYXQuY29sMi55ICogcjFZKTtcclxuICAgICAgcjFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgIHZhciByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgIHIyWCA9IHRYO1xyXG4gICAgICB2YXIgbTEgPSBiQS5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBtMiA9IGJCLm1faW52TWFzcztcclxuICAgICAgdmFyIGkxID0gYkEubV9pbnZJO1xyXG4gICAgICB2YXIgaTIgPSBiQi5tX2ludkk7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueCA9IG0xICsgbTIgKyByMVkgKiByMVkgKiBpMSArIHIyWSAqIHIyWSAqIGkyO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wyLnggPSAoLXIxWSAqIHIxWCAqIGkxKSAtIHIyWSAqIHIyWCAqIGkyO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnggPSAoLXIxWSAqIGkxKSAtIHIyWSAqIGkyO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnkgPSB0aGlzLm1fbWFzcy5jb2wyLng7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueSA9IG0xICsgbTIgKyByMVggKiByMVggKiBpMSArIHIyWCAqIHIyWCAqIGkyO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnkgPSByMVggKiBpMSArIHIyWCAqIGkyO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnogPSB0aGlzLm1fbWFzcy5jb2wzLng7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueiA9IHRoaXMubV9tYXNzLmNvbDMueTtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMy56ID0gaTEgKyBpMjtcclxuICAgICAgdGhpcy5tX21vdG9yTWFzcyA9IDEuMCAvIChpMSArIGkyKTtcclxuICAgICAgaWYgKHRoaXMubV9lbmFibGVNb3RvciA9PSBmYWxzZSkge1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gMC4wO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTGltaXQpIHtcclxuICAgICAgICAgdmFyIGpvaW50QW5nbGUgPSBiQi5tX3N3ZWVwLmEgLSBiQS5tX3N3ZWVwLmEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XHJcbiAgICAgICAgIGlmIChiMk1hdGguQWJzKHRoaXMubV91cHBlckFuZ2xlIC0gdGhpcy5tX2xvd2VyQW5nbGUpIDwgMi4wICogYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcCkge1xyXG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9lcXVhbExpbWl0cztcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNlIGlmIChqb2ludEFuZ2xlIDw9IHRoaXMubV9sb3dlckFuZ2xlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfYXRMb3dlckxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfYXRMb3dlckxpbWl0O1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2UgaWYgKGpvaW50QW5nbGUgPj0gdGhpcy5tX3VwcGVyQW5nbGUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQpIHtcclxuICAgICAgICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiA9IDAuMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm1fbGltaXRTdGF0ZSA9IGIySm9pbnQuZV9hdFVwcGVyTGltaXQ7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubV9saW1pdFN0YXRlID0gYjJKb2ludC5lX2luYWN0aXZlTGltaXQ7XHJcbiAgICAgICAgICAgIHRoaXMubV9pbXB1bHNlLnogPSAwLjA7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdGhpcy5tX2xpbWl0U3RhdGUgPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoc3RlcC53YXJtU3RhcnRpbmcpIHtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdmFyIFBYID0gdGhpcy5tX2ltcHVsc2UueDtcclxuICAgICAgICAgdmFyIFBZID0gdGhpcy5tX2ltcHVsc2UueTtcclxuICAgICAgICAgYkEubV9saW5lYXJWZWxvY2l0eS54IC09IG0xICogUFg7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSAtPSBtMSAqIFBZO1xyXG4gICAgICAgICBiQS5tX2FuZ3VsYXJWZWxvY2l0eSAtPSBpMSAqICgocjFYICogUFkgLSByMVkgKiBQWCkgKyB0aGlzLm1fbW90b3JJbXB1bHNlICsgdGhpcy5tX2ltcHVsc2Uueik7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBtMiAqIFBYO1xyXG4gICAgICAgICBiQi5tX2xpbmVhclZlbG9jaXR5LnkgKz0gbTIgKiBQWTtcclxuICAgICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgKz0gaTIgKiAoKHIyWCAqIFBZIC0gcjJZICogUFgpICsgdGhpcy5tX21vdG9ySW1wdWxzZSArIHRoaXMubV9pbXB1bHNlLnopO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS5TZXRaZXJvKCk7XHJcbiAgICAgICAgIHRoaXMubV9tb3RvckltcHVsc2UgPSAwLjA7XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBiMlJldm9sdXRlSm9pbnQucHJvdG90eXBlLlNvbHZlVmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIG5ld0ltcHVsc2UgPSAwO1xyXG4gICAgICB2YXIgcjFYID0gMDtcclxuICAgICAgdmFyIHIxWSA9IDA7XHJcbiAgICAgIHZhciByMlggPSAwO1xyXG4gICAgICB2YXIgcjJZID0gMDtcclxuICAgICAgdmFyIHYxID0gYkEubV9saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIHcxID0gYkEubV9hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB2MiA9IGJCLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3MiA9IGJCLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgbTEgPSBiQS5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBtMiA9IGJCLm1faW52TWFzcztcclxuICAgICAgdmFyIGkxID0gYkEubV9pbnZJO1xyXG4gICAgICB2YXIgaTIgPSBiQi5tX2ludkk7XHJcbiAgICAgIGlmICh0aGlzLm1fZW5hYmxlTW90b3IgJiYgdGhpcy5tX2xpbWl0U3RhdGUgIT0gYjJKb2ludC5lX2VxdWFsTGltaXRzKSB7XHJcbiAgICAgICAgIHZhciBDZG90ID0gdzIgLSB3MSAtIHRoaXMubV9tb3RvclNwZWVkO1xyXG4gICAgICAgICB2YXIgaW1wdWxzZSA9IHRoaXMubV9tb3Rvck1hc3MgKiAoKC1DZG90KSk7XHJcbiAgICAgICAgIHZhciBvbGRJbXB1bHNlID0gdGhpcy5tX21vdG9ySW1wdWxzZTtcclxuICAgICAgICAgdmFyIG1heEltcHVsc2UgPSBzdGVwLmR0ICogdGhpcy5tX21heE1vdG9yVG9ycXVlO1xyXG4gICAgICAgICB0aGlzLm1fbW90b3JJbXB1bHNlID0gYjJNYXRoLkNsYW1wKHRoaXMubV9tb3RvckltcHVsc2UgKyBpbXB1bHNlLCAoLW1heEltcHVsc2UpLCBtYXhJbXB1bHNlKTtcclxuICAgICAgICAgaW1wdWxzZSA9IHRoaXMubV9tb3RvckltcHVsc2UgLSBvbGRJbXB1bHNlO1xyXG4gICAgICAgICB3MSAtPSBpMSAqIGltcHVsc2U7XHJcbiAgICAgICAgIHcyICs9IGkyICogaW1wdWxzZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5tX2VuYWJsZUxpbWl0ICYmIHRoaXMubV9saW1pdFN0YXRlICE9IGIySm9pbnQuZV9pbmFjdGl2ZUxpbWl0KSB7XHJcbiAgICAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgICAgIHIxWCA9IHRoaXMubV9sb2NhbEFuY2hvcjEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgICAgcjFZID0gdGhpcy5tX2xvY2FsQW5jaG9yMS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIxWCArIHRNYXQuY29sMi54ICogcjFZKTtcclxuICAgICAgICAgcjFZID0gKHRNYXQuY29sMS55ICogcjFYICsgdE1hdC5jb2wyLnkgKiByMVkpO1xyXG4gICAgICAgICByMVggPSB0WDtcclxuICAgICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgICAgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICAgICByMlkgPSB0aGlzLm1fbG9jYWxBbmNob3IyLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjJYICsgdE1hdC5jb2wyLnggKiByMlkpO1xyXG4gICAgICAgICByMlkgPSAodE1hdC5jb2wxLnkgKiByMlggKyB0TWF0LmNvbDIueSAqIHIyWSk7XHJcbiAgICAgICAgIHIyWCA9IHRYO1xyXG4gICAgICAgICB2YXIgQ2RvdDFYID0gdjIueCArICgoLXcyICogcjJZKSkgLSB2MS54IC0gKCgtdzEgKiByMVkpKTtcclxuICAgICAgICAgdmFyIENkb3QxWSA9IHYyLnkgKyAodzIgKiByMlgpIC0gdjEueSAtICh3MSAqIHIxWCk7XHJcbiAgICAgICAgIHZhciBDZG90MiA9IHcyIC0gdzE7XHJcbiAgICAgICAgIHRoaXMubV9tYXNzLlNvbHZlMzModGhpcy5pbXB1bHNlMywgKC1DZG90MVgpLCAoLUNkb3QxWSksICgtQ2RvdDIpKTtcclxuICAgICAgICAgaWYgKHRoaXMubV9saW1pdFN0YXRlID09IGIySm9pbnQuZV9lcXVhbExpbWl0cykge1xyXG4gICAgICAgICAgICB0aGlzLm1faW1wdWxzZS5BZGQodGhpcy5pbXB1bHNlMyk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdCkge1xyXG4gICAgICAgICAgICBuZXdJbXB1bHNlID0gdGhpcy5tX2ltcHVsc2UueiArIHRoaXMuaW1wdWxzZTMuejtcclxuICAgICAgICAgICAgaWYgKG5ld0ltcHVsc2UgPCAwLjApIHtcclxuICAgICAgICAgICAgICAgdGhpcy5tX21hc3MuU29sdmUyMih0aGlzLnJlZHVjZWQsICgtQ2RvdDFYKSwgKC1DZG90MVkpKTtcclxuICAgICAgICAgICAgICAgdGhpcy5pbXB1bHNlMy54ID0gdGhpcy5yZWR1Y2VkLng7XHJcbiAgICAgICAgICAgICAgIHRoaXMuaW1wdWxzZTMueSA9IHRoaXMucmVkdWNlZC55O1xyXG4gICAgICAgICAgICAgICB0aGlzLmltcHVsc2UzLnogPSAoLXRoaXMubV9pbXB1bHNlLnopO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IHRoaXMucmVkdWNlZC54O1xyXG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ICs9IHRoaXMucmVkdWNlZC55O1xyXG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMC4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICAgICBuZXdJbXB1bHNlID0gdGhpcy5tX2ltcHVsc2UueiArIHRoaXMuaW1wdWxzZTMuejtcclxuICAgICAgICAgICAgaWYgKG5ld0ltcHVsc2UgPiAwLjApIHtcclxuICAgICAgICAgICAgICAgdGhpcy5tX21hc3MuU29sdmUyMih0aGlzLnJlZHVjZWQsICgtQ2RvdDFYKSwgKC1DZG90MVkpKTtcclxuICAgICAgICAgICAgICAgdGhpcy5pbXB1bHNlMy54ID0gdGhpcy5yZWR1Y2VkLng7XHJcbiAgICAgICAgICAgICAgIHRoaXMuaW1wdWxzZTMueSA9IHRoaXMucmVkdWNlZC55O1xyXG4gICAgICAgICAgICAgICB0aGlzLmltcHVsc2UzLnogPSAoLXRoaXMubV9pbXB1bHNlLnopO1xyXG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS54ICs9IHRoaXMucmVkdWNlZC54O1xyXG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS55ICs9IHRoaXMucmVkdWNlZC55O1xyXG4gICAgICAgICAgICAgICB0aGlzLm1faW1wdWxzZS56ID0gMC4wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgdjEueCAtPSBtMSAqIHRoaXMuaW1wdWxzZTMueDtcclxuICAgICAgICAgdjEueSAtPSBtMSAqIHRoaXMuaW1wdWxzZTMueTtcclxuICAgICAgICAgdzEgLT0gaTEgKiAocjFYICogdGhpcy5pbXB1bHNlMy55IC0gcjFZICogdGhpcy5pbXB1bHNlMy54ICsgdGhpcy5pbXB1bHNlMy56KTtcclxuICAgICAgICAgdjIueCArPSBtMiAqIHRoaXMuaW1wdWxzZTMueDtcclxuICAgICAgICAgdjIueSArPSBtMiAqIHRoaXMuaW1wdWxzZTMueTtcclxuICAgICAgICAgdzIgKz0gaTIgKiAocjJYICogdGhpcy5pbXB1bHNlMy55IC0gcjJZICogdGhpcy5pbXB1bHNlMy54ICsgdGhpcy5pbXB1bHNlMy56KTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgICAgcjFYID0gdGhpcy5tX2xvY2FsQW5jaG9yMS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICAgICByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgICAgIHIxWCA9IHRYO1xyXG4gICAgICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICAgICByMlggPSB0aGlzLm1fbG9jYWxBbmNob3IyLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgICAgIHIyWSA9IHRoaXMubV9sb2NhbEFuY2hvcjIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByMlggKyB0TWF0LmNvbDIueCAqIHIyWSk7XHJcbiAgICAgICAgIHIyWSA9ICh0TWF0LmNvbDEueSAqIHIyWCArIHRNYXQuY29sMi55ICogcjJZKTtcclxuICAgICAgICAgcjJYID0gdFg7XHJcbiAgICAgICAgIHZhciBDZG90WCA9IHYyLnggKyAoKC13MiAqIHIyWSkpIC0gdjEueCAtICgoLXcxICogcjFZKSk7XHJcbiAgICAgICAgIHZhciBDZG90WSA9IHYyLnkgKyAodzIgKiByMlgpIC0gdjEueSAtICh3MSAqIHIxWCk7XHJcbiAgICAgICAgIHRoaXMubV9tYXNzLlNvbHZlMjIodGhpcy5pbXB1bHNlMiwgKC1DZG90WCksICgtQ2RvdFkpKTtcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueCArPSB0aGlzLmltcHVsc2UyLng7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnkgKz0gdGhpcy5pbXB1bHNlMi55O1xyXG4gICAgICAgICB2MS54IC09IG0xICogdGhpcy5pbXB1bHNlMi54O1xyXG4gICAgICAgICB2MS55IC09IG0xICogdGhpcy5pbXB1bHNlMi55O1xyXG4gICAgICAgICB3MSAtPSBpMSAqIChyMVggKiB0aGlzLmltcHVsc2UyLnkgLSByMVkgKiB0aGlzLmltcHVsc2UyLngpO1xyXG4gICAgICAgICB2Mi54ICs9IG0yICogdGhpcy5pbXB1bHNlMi54O1xyXG4gICAgICAgICB2Mi55ICs9IG0yICogdGhpcy5pbXB1bHNlMi55O1xyXG4gICAgICAgICB3MiArPSBpMiAqIChyMlggKiB0aGlzLmltcHVsc2UyLnkgLSByMlkgKiB0aGlzLmltcHVsc2UyLngpO1xyXG4gICAgICB9XHJcbiAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkuU2V0Vih2MSk7XHJcbiAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5ID0gdzE7XHJcbiAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkuU2V0Vih2Mik7XHJcbiAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ID0gdzI7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50LnByb3RvdHlwZS5Tb2x2ZVBvc2l0aW9uQ29uc3RyYWludHMgPSBmdW5jdGlvbiAoYmF1bWdhcnRlKSB7XHJcbiAgICAgIGlmIChiYXVtZ2FydGUgPT09IHVuZGVmaW5lZCkgYmF1bWdhcnRlID0gMDtcclxuICAgICAgdmFyIG9sZExpbWl0SW1wdWxzZSA9IDA7XHJcbiAgICAgIHZhciBDID0gMDtcclxuICAgICAgdmFyIHRNYXQ7XHJcbiAgICAgIHZhciBiQSA9IHRoaXMubV9ib2R5QTtcclxuICAgICAgdmFyIGJCID0gdGhpcy5tX2JvZHlCO1xyXG4gICAgICB2YXIgYW5ndWxhckVycm9yID0gMC4wO1xyXG4gICAgICB2YXIgcG9zaXRpb25FcnJvciA9IDAuMDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIGltcHVsc2VYID0gMDtcclxuICAgICAgdmFyIGltcHVsc2VZID0gMDtcclxuICAgICAgaWYgKHRoaXMubV9lbmFibGVMaW1pdCAmJiB0aGlzLm1fbGltaXRTdGF0ZSAhPSBiMkpvaW50LmVfaW5hY3RpdmVMaW1pdCkge1xyXG4gICAgICAgICB2YXIgYW5nbGUgPSBiQi5tX3N3ZWVwLmEgLSBiQS5tX3N3ZWVwLmEgLSB0aGlzLm1fcmVmZXJlbmNlQW5nbGU7XHJcbiAgICAgICAgIHZhciBsaW1pdEltcHVsc2UgPSAwLjA7XHJcbiAgICAgICAgIGlmICh0aGlzLm1fbGltaXRTdGF0ZSA9PSBiMkpvaW50LmVfZXF1YWxMaW1pdHMpIHtcclxuICAgICAgICAgICAgQyA9IGIyTWF0aC5DbGFtcChhbmdsZSAtIHRoaXMubV9sb3dlckFuZ2xlLCAoLWIyU2V0dGluZ3MuYjJfbWF4QW5ndWxhckNvcnJlY3Rpb24pLCBiMlNldHRpbmdzLmIyX21heEFuZ3VsYXJDb3JyZWN0aW9uKTtcclxuICAgICAgICAgICAgbGltaXRJbXB1bHNlID0gKC10aGlzLm1fbW90b3JNYXNzICogQyk7XHJcbiAgICAgICAgICAgIGFuZ3VsYXJFcnJvciA9IGIyTWF0aC5BYnMoQyk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0TG93ZXJMaW1pdCkge1xyXG4gICAgICAgICAgICBDID0gYW5nbGUgLSB0aGlzLm1fbG93ZXJBbmdsZTtcclxuICAgICAgICAgICAgYW5ndWxhckVycm9yID0gKC1DKTtcclxuICAgICAgICAgICAgQyA9IGIyTWF0aC5DbGFtcChDICsgYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcCwgKC1iMlNldHRpbmdzLmIyX21heEFuZ3VsYXJDb3JyZWN0aW9uKSwgMC4wKTtcclxuICAgICAgICAgICAgbGltaXRJbXB1bHNlID0gKC10aGlzLm1fbW90b3JNYXNzICogQyk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgZWxzZSBpZiAodGhpcy5tX2xpbWl0U3RhdGUgPT0gYjJKb2ludC5lX2F0VXBwZXJMaW1pdCkge1xyXG4gICAgICAgICAgICBDID0gYW5nbGUgLSB0aGlzLm1fdXBwZXJBbmdsZTtcclxuICAgICAgICAgICAgYW5ndWxhckVycm9yID0gQztcclxuICAgICAgICAgICAgQyA9IGIyTWF0aC5DbGFtcChDIC0gYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcCwgMC4wLCBiMlNldHRpbmdzLmIyX21heEFuZ3VsYXJDb3JyZWN0aW9uKTtcclxuICAgICAgICAgICAgbGltaXRJbXB1bHNlID0gKC10aGlzLm1fbW90b3JNYXNzICogQyk7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgYkEubV9zd2VlcC5hIC09IGJBLm1faW52SSAqIGxpbWl0SW1wdWxzZTtcclxuICAgICAgICAgYkIubV9zd2VlcC5hICs9IGJCLm1faW52SSAqIGxpbWl0SW1wdWxzZTtcclxuICAgICAgICAgYkEuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgfSB7XHJcbiAgICAgICAgIHRNYXQgPSBiQS5tX3hmLlI7XHJcbiAgICAgICAgIHZhciByMVggPSB0aGlzLm1fbG9jYWxBbmNob3IxLnggLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgICAgIHZhciByMVkgPSB0aGlzLm1fbG9jYWxBbmNob3IxLnkgLSBiQS5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgICAgIHRYID0gKHRNYXQuY29sMS54ICogcjFYICsgdE1hdC5jb2wyLnggKiByMVkpO1xyXG4gICAgICAgICByMVkgPSAodE1hdC5jb2wxLnkgKiByMVggKyB0TWF0LmNvbDIueSAqIHIxWSk7XHJcbiAgICAgICAgIHIxWCA9IHRYO1xyXG4gICAgICAgICB0TWF0ID0gYkIubV94Zi5SO1xyXG4gICAgICAgICB2YXIgcjJYID0gdGhpcy5tX2xvY2FsQW5jaG9yMi54IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICAgICB2YXIgcjJZID0gdGhpcy5tX2xvY2FsQW5jaG9yMi55IC0gYkIubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHIyWCArIHRNYXQuY29sMi54ICogcjJZKTtcclxuICAgICAgICAgcjJZID0gKHRNYXQuY29sMS55ICogcjJYICsgdE1hdC5jb2wyLnkgKiByMlkpO1xyXG4gICAgICAgICByMlggPSB0WDtcclxuICAgICAgICAgdmFyIENYID0gYkIubV9zd2VlcC5jLnggKyByMlggLSBiQS5tX3N3ZWVwLmMueCAtIHIxWDtcclxuICAgICAgICAgdmFyIENZID0gYkIubV9zd2VlcC5jLnkgKyByMlkgLSBiQS5tX3N3ZWVwLmMueSAtIHIxWTtcclxuICAgICAgICAgdmFyIENMZW5ndGhTcXVhcmVkID0gQ1ggKiBDWCArIENZICogQ1k7XHJcbiAgICAgICAgIHZhciBDTGVuZ3RoID0gTWF0aC5zcXJ0KENMZW5ndGhTcXVhcmVkKTtcclxuICAgICAgICAgcG9zaXRpb25FcnJvciA9IENMZW5ndGg7XHJcbiAgICAgICAgIHZhciBpbnZNYXNzMSA9IGJBLm1faW52TWFzcztcclxuICAgICAgICAgdmFyIGludk1hc3MyID0gYkIubV9pbnZNYXNzO1xyXG4gICAgICAgICB2YXIgaW52STEgPSBiQS5tX2ludkk7XHJcbiAgICAgICAgIHZhciBpbnZJMiA9IGJCLm1faW52STtcclxuICAgICAgICAgdmFyIGtfYWxsb3dlZFN0cmV0Y2ggPSAxMC4wICogYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wO1xyXG4gICAgICAgICBpZiAoQ0xlbmd0aFNxdWFyZWQgPiBrX2FsbG93ZWRTdHJldGNoICoga19hbGxvd2VkU3RyZXRjaCkge1xyXG4gICAgICAgICAgICB2YXIgdVggPSBDWCAvIENMZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciB1WSA9IENZIC8gQ0xlbmd0aDtcclxuICAgICAgICAgICAgdmFyIGsgPSBpbnZNYXNzMSArIGludk1hc3MyO1xyXG4gICAgICAgICAgICB2YXIgbSA9IDEuMCAvIGs7XHJcbiAgICAgICAgICAgIGltcHVsc2VYID0gbSAqICgoLUNYKSk7XHJcbiAgICAgICAgICAgIGltcHVsc2VZID0gbSAqICgoLUNZKSk7XHJcbiAgICAgICAgICAgIHZhciBrX2JldGEgPSAwLjU7XHJcbiAgICAgICAgICAgIGJBLm1fc3dlZXAuYy54IC09IGtfYmV0YSAqIGludk1hc3MxICogaW1wdWxzZVg7XHJcbiAgICAgICAgICAgIGJBLm1fc3dlZXAuYy55IC09IGtfYmV0YSAqIGludk1hc3MxICogaW1wdWxzZVk7XHJcbiAgICAgICAgICAgIGJCLm1fc3dlZXAuYy54ICs9IGtfYmV0YSAqIGludk1hc3MyICogaW1wdWxzZVg7XHJcbiAgICAgICAgICAgIGJCLm1fc3dlZXAuYy55ICs9IGtfYmV0YSAqIGludk1hc3MyICogaW1wdWxzZVk7XHJcbiAgICAgICAgICAgIENYID0gYkIubV9zd2VlcC5jLnggKyByMlggLSBiQS5tX3N3ZWVwLmMueCAtIHIxWDtcclxuICAgICAgICAgICAgQ1kgPSBiQi5tX3N3ZWVwLmMueSArIHIyWSAtIGJBLm1fc3dlZXAuYy55IC0gcjFZO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHRoaXMuSzEuY29sMS54ID0gaW52TWFzczEgKyBpbnZNYXNzMjtcclxuICAgICAgICAgdGhpcy5LMS5jb2wyLnggPSAwLjA7XHJcbiAgICAgICAgIHRoaXMuSzEuY29sMS55ID0gMC4wO1xyXG4gICAgICAgICB0aGlzLksxLmNvbDIueSA9IGludk1hc3MxICsgaW52TWFzczI7XHJcbiAgICAgICAgIHRoaXMuSzIuY29sMS54ID0gaW52STEgKiByMVkgKiByMVk7XHJcbiAgICAgICAgIHRoaXMuSzIuY29sMi54ID0gKC1pbnZJMSAqIHIxWCAqIHIxWSk7XHJcbiAgICAgICAgIHRoaXMuSzIuY29sMS55ID0gKC1pbnZJMSAqIHIxWCAqIHIxWSk7XHJcbiAgICAgICAgIHRoaXMuSzIuY29sMi55ID0gaW52STEgKiByMVggKiByMVg7XHJcbiAgICAgICAgIHRoaXMuSzMuY29sMS54ID0gaW52STIgKiByMlkgKiByMlk7XHJcbiAgICAgICAgIHRoaXMuSzMuY29sMi54ID0gKC1pbnZJMiAqIHIyWCAqIHIyWSk7XHJcbiAgICAgICAgIHRoaXMuSzMuY29sMS55ID0gKC1pbnZJMiAqIHIyWCAqIHIyWSk7XHJcbiAgICAgICAgIHRoaXMuSzMuY29sMi55ID0gaW52STIgKiByMlggKiByMlg7XHJcbiAgICAgICAgIHRoaXMuSy5TZXRNKHRoaXMuSzEpO1xyXG4gICAgICAgICB0aGlzLksuQWRkTSh0aGlzLksyKTtcclxuICAgICAgICAgdGhpcy5LLkFkZE0odGhpcy5LMyk7XHJcbiAgICAgICAgIHRoaXMuSy5Tb2x2ZShiMlJldm9sdXRlSm9pbnQudEltcHVsc2UsICgtQ1gpLCAoLUNZKSk7XHJcbiAgICAgICAgIGltcHVsc2VYID0gYjJSZXZvbHV0ZUpvaW50LnRJbXB1bHNlLng7XHJcbiAgICAgICAgIGltcHVsc2VZID0gYjJSZXZvbHV0ZUpvaW50LnRJbXB1bHNlLnk7XHJcbiAgICAgICAgIGJBLm1fc3dlZXAuYy54IC09IGJBLm1faW52TWFzcyAqIGltcHVsc2VYO1xyXG4gICAgICAgICBiQS5tX3N3ZWVwLmMueSAtPSBiQS5tX2ludk1hc3MgKiBpbXB1bHNlWTtcclxuICAgICAgICAgYkEubV9zd2VlcC5hIC09IGJBLm1faW52SSAqIChyMVggKiBpbXB1bHNlWSAtIHIxWSAqIGltcHVsc2VYKTtcclxuICAgICAgICAgYkIubV9zd2VlcC5jLnggKz0gYkIubV9pbnZNYXNzICogaW1wdWxzZVg7XHJcbiAgICAgICAgIGJCLm1fc3dlZXAuYy55ICs9IGJCLm1faW52TWFzcyAqIGltcHVsc2VZO1xyXG4gICAgICAgICBiQi5tX3N3ZWVwLmEgKz0gYkIubV9pbnZJICogKHIyWCAqIGltcHVsc2VZIC0gcjJZICogaW1wdWxzZVgpO1xyXG4gICAgICAgICBiQS5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICAgICBiQi5TeW5jaHJvbml6ZVRyYW5zZm9ybSgpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBwb3NpdGlvbkVycm9yIDw9IGIyU2V0dGluZ3MuYjJfbGluZWFyU2xvcCAmJiBhbmd1bGFyRXJyb3IgPD0gYjJTZXR0aW5ncy5iMl9hbmd1bGFyU2xvcDtcclxuICAgfVxyXG4gICBCb3gyRC5wb3N0RGVmcy5wdXNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIyUmV2b2x1dGVKb2ludC50SW1wdWxzZSA9IG5ldyBiMlZlYzIoKTtcclxuICAgfSk7XHJcbiAgIEJveDJELmluaGVyaXQoYjJSZXZvbHV0ZUpvaW50RGVmLCBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZik7XHJcbiAgIGIyUmV2b2x1dGVKb2ludERlZi5wcm90b3R5cGUuX19zdXBlciA9IEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmLnByb3RvdHlwZTtcclxuICAgYjJSZXZvbHV0ZUpvaW50RGVmLmIyUmV2b2x1dGVKb2ludERlZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgQm94MkQuRHluYW1pY3MuSm9pbnRzLmIySm9pbnREZWYuYjJKb2ludERlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBiMlZlYzIoKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgIH07XHJcbiAgIGIyUmV2b2x1dGVKb2ludERlZi5wcm90b3R5cGUuYjJSZXZvbHV0ZUpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludERlZi5jYWxsKHRoaXMpO1xyXG4gICAgICB0aGlzLnR5cGUgPSBiMkpvaW50LmVfcmV2b2x1dGVKb2ludDtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckEuU2V0KDAuMCwgMC4wKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIuU2V0KDAuMCwgMC4wKTtcclxuICAgICAgdGhpcy5yZWZlcmVuY2VBbmdsZSA9IDAuMDtcclxuICAgICAgdGhpcy5sb3dlckFuZ2xlID0gMC4wO1xyXG4gICAgICB0aGlzLnVwcGVyQW5nbGUgPSAwLjA7XHJcbiAgICAgIHRoaXMubWF4TW90b3JUb3JxdWUgPSAwLjA7XHJcbiAgICAgIHRoaXMubW90b3JTcGVlZCA9IDAuMDtcclxuICAgICAgdGhpcy5lbmFibGVMaW1pdCA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmVuYWJsZU1vdG9yID0gZmFsc2U7XHJcbiAgIH1cclxuICAgYjJSZXZvbHV0ZUpvaW50RGVmLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKGJBLCBiQiwgYW5jaG9yKSB7XHJcbiAgICAgIHRoaXMuYm9keUEgPSBiQTtcclxuICAgICAgdGhpcy5ib2R5QiA9IGJCO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3IpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IHRoaXMuYm9keUIuR2V0TG9jYWxQb2ludChhbmNob3IpO1xyXG4gICAgICB0aGlzLnJlZmVyZW5jZUFuZ2xlID0gdGhpcy5ib2R5Qi5HZXRBbmdsZSgpIC0gdGhpcy5ib2R5QS5HZXRBbmdsZSgpO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJXZWxkSm9pbnQsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50KTtcclxuICAgYjJXZWxkSm9pbnQucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5wcm90b3R5cGU7XHJcbiAgIGIyV2VsZEpvaW50LmIyV2VsZEpvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludC5iMkpvaW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckIgPSBuZXcgYjJWZWMyKCk7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlID0gbmV3IGIyVmVjMygpO1xyXG4gICAgICB0aGlzLm1fbWFzcyA9IG5ldyBiMk1hdDMzKCk7XHJcbiAgIH07XHJcbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5HZXRBbmNob3JBID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX2JvZHlBLkdldFdvcmxkUG9pbnQodGhpcy5tX2xvY2FsQW5jaG9yQSk7XHJcbiAgIH1cclxuICAgYjJXZWxkSm9pbnQucHJvdG90eXBlLkdldEFuY2hvckIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fYm9keUIuR2V0V29ybGRQb2ludCh0aGlzLm1fbG9jYWxBbmNob3JCKTtcclxuICAgfVxyXG4gICBiMldlbGRKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Gb3JjZSA9IGZ1bmN0aW9uIChpbnZfZHQpIHtcclxuICAgICAgaWYgKGludl9kdCA9PT0gdW5kZWZpbmVkKSBpbnZfZHQgPSAwO1xyXG4gICAgICByZXR1cm4gbmV3IGIyVmVjMihpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS54LCBpbnZfZHQgKiB0aGlzLm1faW1wdWxzZS55KTtcclxuICAgfVxyXG4gICBiMldlbGRKb2ludC5wcm90b3R5cGUuR2V0UmVhY3Rpb25Ub3JxdWUgPSBmdW5jdGlvbiAoaW52X2R0KSB7XHJcbiAgICAgIGlmIChpbnZfZHQgPT09IHVuZGVmaW5lZCkgaW52X2R0ID0gMDtcclxuICAgICAgcmV0dXJuIGludl9kdCAqIHRoaXMubV9pbXB1bHNlLno7XHJcbiAgIH1cclxuICAgYjJXZWxkSm9pbnQucHJvdG90eXBlLmIyV2VsZEpvaW50ID0gZnVuY3Rpb24gKGRlZikge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludC5jYWxsKHRoaXMsIGRlZik7XHJcbiAgICAgIHRoaXMubV9sb2NhbEFuY2hvckEuU2V0VihkZWYubG9jYWxBbmNob3JBKTtcclxuICAgICAgdGhpcy5tX2xvY2FsQW5jaG9yQi5TZXRWKGRlZi5sb2NhbEFuY2hvckIpO1xyXG4gICAgICB0aGlzLm1fcmVmZXJlbmNlQW5nbGUgPSBkZWYucmVmZXJlbmNlQW5nbGU7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcclxuICAgICAgdGhpcy5tX21hc3MgPSBuZXcgYjJNYXQzMygpO1xyXG4gICB9XHJcbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5Jbml0VmVsb2NpdHlDb25zdHJhaW50cyA9IGZ1bmN0aW9uIChzdGVwKSB7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHJBWCA9IHRoaXMubV9sb2NhbEFuY2hvckEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJBWSA9IHRoaXMubV9sb2NhbEFuY2hvckEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQVggKyB0TWF0LmNvbDIueCAqIHJBWSk7XHJcbiAgICAgIHJBWSA9ICh0TWF0LmNvbDEueSAqIHJBWCArIHRNYXQuY29sMi55ICogckFZKTtcclxuICAgICAgckFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgIHZhciByQlggPSB0aGlzLm1fbG9jYWxBbmNob3JCLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByQlkgPSB0aGlzLm1fbG9jYWxBbmNob3JCLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogckJYICsgdE1hdC5jb2wyLnggKiByQlkpO1xyXG4gICAgICByQlkgPSAodE1hdC5jb2wxLnkgKiByQlggKyB0TWF0LmNvbDIueSAqIHJCWSk7XHJcbiAgICAgIHJCWCA9IHRYO1xyXG4gICAgICB2YXIgbUEgPSBiQS5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBtQiA9IGJCLm1faW52TWFzcztcclxuICAgICAgdmFyIGlBID0gYkEubV9pbnZJO1xyXG4gICAgICB2YXIgaUIgPSBiQi5tX2ludkk7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueCA9IG1BICsgbUIgKyByQVkgKiByQVkgKiBpQSArIHJCWSAqIHJCWSAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wyLnggPSAoLXJBWSAqIHJBWCAqIGlBKSAtIHJCWSAqIHJCWCAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnggPSAoLXJBWSAqIGlBKSAtIHJCWSAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnkgPSB0aGlzLm1fbWFzcy5jb2wyLng7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueSA9IG1BICsgbUIgKyByQVggKiByQVggKiBpQSArIHJCWCAqIHJCWCAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnkgPSByQVggKiBpQSArIHJCWCAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnogPSB0aGlzLm1fbWFzcy5jb2wzLng7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueiA9IHRoaXMubV9tYXNzLmNvbDMueTtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMy56ID0gaUEgKyBpQjtcclxuICAgICAgaWYgKHN0ZXAud2FybVN0YXJ0aW5nKSB7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLnggKj0gc3RlcC5kdFJhdGlvO1xyXG4gICAgICAgICB0aGlzLm1faW1wdWxzZS55ICo9IHN0ZXAuZHRSYXRpbztcclxuICAgICAgICAgdGhpcy5tX2ltcHVsc2UueiAqPSBzdGVwLmR0UmF0aW87XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueCAtPSBtQSAqIHRoaXMubV9pbXB1bHNlLng7XHJcbiAgICAgICAgIGJBLm1fbGluZWFyVmVsb2NpdHkueSAtPSBtQSAqIHRoaXMubV9pbXB1bHNlLnk7XHJcbiAgICAgICAgIGJBLm1fYW5ndWxhclZlbG9jaXR5IC09IGlBICogKHJBWCAqIHRoaXMubV9pbXB1bHNlLnkgLSByQVkgKiB0aGlzLm1faW1wdWxzZS54ICsgdGhpcy5tX2ltcHVsc2Uueik7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueCArPSBtQiAqIHRoaXMubV9pbXB1bHNlLng7XHJcbiAgICAgICAgIGJCLm1fbGluZWFyVmVsb2NpdHkueSArPSBtQiAqIHRoaXMubV9pbXB1bHNlLnk7XHJcbiAgICAgICAgIGJCLm1fYW5ndWxhclZlbG9jaXR5ICs9IGlCICogKHJCWCAqIHRoaXMubV9pbXB1bHNlLnkgLSByQlkgKiB0aGlzLm1faW1wdWxzZS54ICsgdGhpcy5tX2ltcHVsc2Uueik7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgIHRoaXMubV9pbXB1bHNlLlNldFplcm8oKTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGIyV2VsZEpvaW50LnByb3RvdHlwZS5Tb2x2ZVZlbG9jaXR5Q29uc3RyYWludHMgPSBmdW5jdGlvbiAoc3RlcCkge1xyXG4gICAgICB2YXIgdE1hdDtcclxuICAgICAgdmFyIHRYID0gMDtcclxuICAgICAgdmFyIGJBID0gdGhpcy5tX2JvZHlBO1xyXG4gICAgICB2YXIgYkIgPSB0aGlzLm1fYm9keUI7XHJcbiAgICAgIHZhciB2QSA9IGJBLm1fbGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHZhciB3QSA9IGJBLm1fYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgdkIgPSBiQi5tX2xpbmVhclZlbG9jaXR5O1xyXG4gICAgICB2YXIgd0IgPSBiQi5tX2FuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgdmFyIG1BID0gYkEubV9pbnZNYXNzO1xyXG4gICAgICB2YXIgbUIgPSBiQi5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBpQSA9IGJBLm1faW52STtcclxuICAgICAgdmFyIGlCID0gYkIubV9pbnZJO1xyXG4gICAgICB0TWF0ID0gYkEubV94Zi5SO1xyXG4gICAgICB2YXIgckFYID0gdGhpcy5tX2xvY2FsQW5jaG9yQS54IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci54O1xyXG4gICAgICB2YXIgckFZID0gdGhpcy5tX2xvY2FsQW5jaG9yQS55IC0gYkEubV9zd2VlcC5sb2NhbENlbnRlci55O1xyXG4gICAgICB0WCA9ICh0TWF0LmNvbDEueCAqIHJBWCArIHRNYXQuY29sMi54ICogckFZKTtcclxuICAgICAgckFZID0gKHRNYXQuY29sMS55ICogckFYICsgdE1hdC5jb2wyLnkgKiByQVkpO1xyXG4gICAgICByQVggPSB0WDtcclxuICAgICAgdE1hdCA9IGJCLm1feGYuUjtcclxuICAgICAgdmFyIHJCWCA9IHRoaXMubV9sb2NhbEFuY2hvckIueCAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJCWSA9IHRoaXMubV9sb2NhbEFuY2hvckIueSAtIGJCLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQlggKyB0TWF0LmNvbDIueCAqIHJCWSk7XHJcbiAgICAgIHJCWSA9ICh0TWF0LmNvbDEueSAqIHJCWCArIHRNYXQuY29sMi55ICogckJZKTtcclxuICAgICAgckJYID0gdFg7XHJcbiAgICAgIHZhciBDZG90MVggPSB2Qi54IC0gd0IgKiByQlkgLSB2QS54ICsgd0EgKiByQVk7XHJcbiAgICAgIHZhciBDZG90MVkgPSB2Qi55ICsgd0IgKiByQlggLSB2QS55IC0gd0EgKiByQVg7XHJcbiAgICAgIHZhciBDZG90MiA9IHdCIC0gd0E7XHJcbiAgICAgIHZhciBpbXB1bHNlID0gbmV3IGIyVmVjMygpO1xyXG4gICAgICB0aGlzLm1fbWFzcy5Tb2x2ZTMzKGltcHVsc2UsICgtQ2RvdDFYKSwgKC1DZG90MVkpLCAoLUNkb3QyKSk7XHJcbiAgICAgIHRoaXMubV9pbXB1bHNlLkFkZChpbXB1bHNlKTtcclxuICAgICAgdkEueCAtPSBtQSAqIGltcHVsc2UueDtcclxuICAgICAgdkEueSAtPSBtQSAqIGltcHVsc2UueTtcclxuICAgICAgd0EgLT0gaUEgKiAockFYICogaW1wdWxzZS55IC0gckFZICogaW1wdWxzZS54ICsgaW1wdWxzZS56KTtcclxuICAgICAgdkIueCArPSBtQiAqIGltcHVsc2UueDtcclxuICAgICAgdkIueSArPSBtQiAqIGltcHVsc2UueTtcclxuICAgICAgd0IgKz0gaUIgKiAockJYICogaW1wdWxzZS55IC0gckJZICogaW1wdWxzZS54ICsgaW1wdWxzZS56KTtcclxuICAgICAgYkEubV9hbmd1bGFyVmVsb2NpdHkgPSB3QTtcclxuICAgICAgYkIubV9hbmd1bGFyVmVsb2NpdHkgPSB3QjtcclxuICAgfVxyXG4gICBiMldlbGRKb2ludC5wcm90b3R5cGUuU29sdmVQb3NpdGlvbkNvbnN0cmFpbnRzID0gZnVuY3Rpb24gKGJhdW1nYXJ0ZSkge1xyXG4gICAgICBpZiAoYmF1bWdhcnRlID09PSB1bmRlZmluZWQpIGJhdW1nYXJ0ZSA9IDA7XHJcbiAgICAgIHZhciB0TWF0O1xyXG4gICAgICB2YXIgdFggPSAwO1xyXG4gICAgICB2YXIgYkEgPSB0aGlzLm1fYm9keUE7XHJcbiAgICAgIHZhciBiQiA9IHRoaXMubV9ib2R5QjtcclxuICAgICAgdE1hdCA9IGJBLm1feGYuUjtcclxuICAgICAgdmFyIHJBWCA9IHRoaXMubV9sb2NhbEFuY2hvckEueCAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueDtcclxuICAgICAgdmFyIHJBWSA9IHRoaXMubV9sb2NhbEFuY2hvckEueSAtIGJBLm1fc3dlZXAubG9jYWxDZW50ZXIueTtcclxuICAgICAgdFggPSAodE1hdC5jb2wxLnggKiByQVggKyB0TWF0LmNvbDIueCAqIHJBWSk7XHJcbiAgICAgIHJBWSA9ICh0TWF0LmNvbDEueSAqIHJBWCArIHRNYXQuY29sMi55ICogckFZKTtcclxuICAgICAgckFYID0gdFg7XHJcbiAgICAgIHRNYXQgPSBiQi5tX3hmLlI7XHJcbiAgICAgIHZhciByQlggPSB0aGlzLm1fbG9jYWxBbmNob3JCLnggLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLng7XHJcbiAgICAgIHZhciByQlkgPSB0aGlzLm1fbG9jYWxBbmNob3JCLnkgLSBiQi5tX3N3ZWVwLmxvY2FsQ2VudGVyLnk7XHJcbiAgICAgIHRYID0gKHRNYXQuY29sMS54ICogckJYICsgdE1hdC5jb2wyLnggKiByQlkpO1xyXG4gICAgICByQlkgPSAodE1hdC5jb2wxLnkgKiByQlggKyB0TWF0LmNvbDIueSAqIHJCWSk7XHJcbiAgICAgIHJCWCA9IHRYO1xyXG4gICAgICB2YXIgbUEgPSBiQS5tX2ludk1hc3M7XHJcbiAgICAgIHZhciBtQiA9IGJCLm1faW52TWFzcztcclxuICAgICAgdmFyIGlBID0gYkEubV9pbnZJO1xyXG4gICAgICB2YXIgaUIgPSBiQi5tX2ludkk7XHJcbiAgICAgIHZhciBDMVggPSBiQi5tX3N3ZWVwLmMueCArIHJCWCAtIGJBLm1fc3dlZXAuYy54IC0gckFYO1xyXG4gICAgICB2YXIgQzFZID0gYkIubV9zd2VlcC5jLnkgKyByQlkgLSBiQS5tX3N3ZWVwLmMueSAtIHJBWTtcclxuICAgICAgdmFyIEMyID0gYkIubV9zd2VlcC5hIC0gYkEubV9zd2VlcC5hIC0gdGhpcy5tX3JlZmVyZW5jZUFuZ2xlO1xyXG4gICAgICB2YXIga19hbGxvd2VkU3RyZXRjaCA9IDEwLjAgKiBiMlNldHRpbmdzLmIyX2xpbmVhclNsb3A7XHJcbiAgICAgIHZhciBwb3NpdGlvbkVycm9yID0gTWF0aC5zcXJ0KEMxWCAqIEMxWCArIEMxWSAqIEMxWSk7XHJcbiAgICAgIHZhciBhbmd1bGFyRXJyb3IgPSBiMk1hdGguQWJzKEMyKTtcclxuICAgICAgaWYgKHBvc2l0aW9uRXJyb3IgPiBrX2FsbG93ZWRTdHJldGNoKSB7XHJcbiAgICAgICAgIGlBICo9IDEuMDtcclxuICAgICAgICAgaUIgKj0gMS4wO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDEueCA9IG1BICsgbUIgKyByQVkgKiByQVkgKiBpQSArIHJCWSAqIHJCWSAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wyLnggPSAoLXJBWSAqIHJBWCAqIGlBKSAtIHJCWSAqIHJCWCAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnggPSAoLXJBWSAqIGlBKSAtIHJCWSAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnkgPSB0aGlzLm1fbWFzcy5jb2wyLng7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueSA9IG1BICsgbUIgKyByQVggKiByQVggKiBpQSArIHJCWCAqIHJCWCAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wzLnkgPSByQVggKiBpQSArIHJCWCAqIGlCO1xyXG4gICAgICB0aGlzLm1fbWFzcy5jb2wxLnogPSB0aGlzLm1fbWFzcy5jb2wzLng7XHJcbiAgICAgIHRoaXMubV9tYXNzLmNvbDIueiA9IHRoaXMubV9tYXNzLmNvbDMueTtcclxuICAgICAgdGhpcy5tX21hc3MuY29sMy56ID0gaUEgKyBpQjtcclxuICAgICAgdmFyIGltcHVsc2UgPSBuZXcgYjJWZWMzKCk7XHJcbiAgICAgIHRoaXMubV9tYXNzLlNvbHZlMzMoaW1wdWxzZSwgKC1DMVgpLCAoLUMxWSksICgtQzIpKTtcclxuICAgICAgYkEubV9zd2VlcC5jLnggLT0gbUEgKiBpbXB1bHNlLng7XHJcbiAgICAgIGJBLm1fc3dlZXAuYy55IC09IG1BICogaW1wdWxzZS55O1xyXG4gICAgICBiQS5tX3N3ZWVwLmEgLT0gaUEgKiAockFYICogaW1wdWxzZS55IC0gckFZICogaW1wdWxzZS54ICsgaW1wdWxzZS56KTtcclxuICAgICAgYkIubV9zd2VlcC5jLnggKz0gbUIgKiBpbXB1bHNlLng7XHJcbiAgICAgIGJCLm1fc3dlZXAuYy55ICs9IG1CICogaW1wdWxzZS55O1xyXG4gICAgICBiQi5tX3N3ZWVwLmEgKz0gaUIgKiAockJYICogaW1wdWxzZS55IC0gckJZICogaW1wdWxzZS54ICsgaW1wdWxzZS56KTtcclxuICAgICAgYkEuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgYkIuU3luY2hyb25pemVUcmFuc2Zvcm0oKTtcclxuICAgICAgcmV0dXJuIHBvc2l0aW9uRXJyb3IgPD0gYjJTZXR0aW5ncy5iMl9saW5lYXJTbG9wICYmIGFuZ3VsYXJFcnJvciA8PSBiMlNldHRpbmdzLmIyX2FuZ3VsYXJTbG9wO1xyXG4gICB9XHJcbiAgIEJveDJELmluaGVyaXQoYjJXZWxkSm9pbnREZWYsIEJveDJELkR5bmFtaWNzLkpvaW50cy5iMkpvaW50RGVmKTtcclxuICAgYjJXZWxkSm9pbnREZWYucHJvdG90eXBlLl9fc3VwZXIgPSBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5wcm90b3R5cGU7XHJcbiAgIGIyV2VsZEpvaW50RGVmLmIyV2VsZEpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBCb3gyRC5EeW5hbWljcy5Kb2ludHMuYjJKb2ludERlZi5iMkpvaW50RGVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gbmV3IGIyVmVjMigpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IG5ldyBiMlZlYzIoKTtcclxuICAgfTtcclxuICAgYjJXZWxkSm9pbnREZWYucHJvdG90eXBlLmIyV2VsZEpvaW50RGVmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLl9fc3VwZXIuYjJKb2ludERlZi5jYWxsKHRoaXMpO1xyXG4gICAgICB0aGlzLnR5cGUgPSBiMkpvaW50LmVfd2VsZEpvaW50O1xyXG4gICAgICB0aGlzLnJlZmVyZW5jZUFuZ2xlID0gMC4wO1xyXG4gICB9XHJcbiAgIGIyV2VsZEpvaW50RGVmLnByb3RvdHlwZS5Jbml0aWFsaXplID0gZnVuY3Rpb24gKGJBLCBiQiwgYW5jaG9yKSB7XHJcbiAgICAgIHRoaXMuYm9keUEgPSBiQTtcclxuICAgICAgdGhpcy5ib2R5QiA9IGJCO1xyXG4gICAgICB0aGlzLmxvY2FsQW5jaG9yQS5TZXRWKHRoaXMuYm9keUEuR2V0TG9jYWxQb2ludChhbmNob3IpKTtcclxuICAgICAgdGhpcy5sb2NhbEFuY2hvckIuU2V0Vih0aGlzLmJvZHlCLkdldExvY2FsUG9pbnQoYW5jaG9yKSk7XHJcbiAgICAgIHRoaXMucmVmZXJlbmNlQW5nbGUgPSB0aGlzLmJvZHlCLkdldEFuZ2xlKCkgLSB0aGlzLmJvZHlBLkdldEFuZ2xlKCk7XHJcbiAgIH1cclxufSkoKTtcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgdmFyIGIyRGVidWdEcmF3ID0gQm94MkQuRHluYW1pY3MuYjJEZWJ1Z0RyYXc7XHJcbiAgIGIyRGVidWdEcmF3LmIyRGVidWdEcmF3ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLm1fZHJhd1NjYWxlID0gMS4wO1xyXG4gICAgICB0aGlzLm1fbGluZVRoaWNrbmVzcyA9IDEuMDtcclxuICAgICAgdGhpcy5tX2FscGhhID0gMS4wO1xyXG4gICAgICB0aGlzLm1fZmlsbEFscGhhID0gMS4wO1xyXG4gICAgICB0aGlzLm1feGZvcm1TY2FsZSA9IDEuMDtcclxuICAgICAgdmFyIF9fdGhpcyA9IHRoaXM7XHJcbiAgICAgIC8vI1dPUktBUk9VTkRcclxuICAgICAgdGhpcy5tX3Nwcml0ZSA9IHtcclxuICAgICAgICAgZ3JhcGhpY3M6IHtcclxuICAgICAgICAgICAgY2xlYXI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgX190aGlzLm1fY3R4LmNsZWFyUmVjdCgwLCAwLCBfX3RoaXMubV9jdHguY2FudmFzLndpZHRoLCBfX3RoaXMubV9jdHguY2FudmFzLmhlaWdodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5fY29sb3IgPSBmdW5jdGlvbiAoY29sb3IsIGFscGhhKSB7XHJcbiAgICAgIHJldHVybiBcInJnYmEoXCIgKyAoKGNvbG9yICYgMHhGRjAwMDApID4+IDE2KSArIFwiLFwiICsgKChjb2xvciAmIDB4RkYwMCkgPj4gOCkgKyBcIixcIiArIChjb2xvciAmIDB4RkYpICsgXCIsXCIgKyBhbHBoYSArIFwiKVwiO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuYjJEZWJ1Z0RyYXcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMubV9kcmF3RmxhZ3MgPSAwO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0RmxhZ3MgPSBmdW5jdGlvbiAoZmxhZ3MpIHtcclxuICAgICAgaWYgKGZsYWdzID09PSB1bmRlZmluZWQpIGZsYWdzID0gMDtcclxuICAgICAgdGhpcy5tX2RyYXdGbGFncyA9IGZsYWdzO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0RmxhZ3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZHJhd0ZsYWdzO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuQXBwZW5kRmxhZ3MgPSBmdW5jdGlvbiAoZmxhZ3MpIHtcclxuICAgICAgaWYgKGZsYWdzID09PSB1bmRlZmluZWQpIGZsYWdzID0gMDtcclxuICAgICAgdGhpcy5tX2RyYXdGbGFncyB8PSBmbGFncztcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkNsZWFyRmxhZ3MgPSBmdW5jdGlvbiAoZmxhZ3MpIHtcclxuICAgICAgaWYgKGZsYWdzID09PSB1bmRlZmluZWQpIGZsYWdzID0gMDtcclxuICAgICAgdGhpcy5tX2RyYXdGbGFncyAmPSB+ZmxhZ3M7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5TZXRTcHJpdGUgPSBmdW5jdGlvbiAoc3ByaXRlKSB7XHJcbiAgICAgIHRoaXMubV9jdHggPSBzcHJpdGU7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRTcHJpdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fY3R4O1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0RHJhd1NjYWxlID0gZnVuY3Rpb24gKGRyYXdTY2FsZSkge1xyXG4gICAgICBpZiAoZHJhd1NjYWxlID09PSB1bmRlZmluZWQpIGRyYXdTY2FsZSA9IDA7XHJcbiAgICAgIHRoaXMubV9kcmF3U2NhbGUgPSBkcmF3U2NhbGU7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXREcmF3U2NhbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZHJhd1NjYWxlO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0TGluZVRoaWNrbmVzcyA9IGZ1bmN0aW9uIChsaW5lVGhpY2tuZXNzKSB7XHJcbiAgICAgIGlmIChsaW5lVGhpY2tuZXNzID09PSB1bmRlZmluZWQpIGxpbmVUaGlja25lc3MgPSAwO1xyXG4gICAgICB0aGlzLm1fbGluZVRoaWNrbmVzcyA9IGxpbmVUaGlja25lc3M7XHJcbiAgICAgIHRoaXMubV9jdHguc3Ryb2tlV2lkdGggPSBsaW5lVGhpY2tuZXNzO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuR2V0TGluZVRoaWNrbmVzcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9saW5lVGhpY2tuZXNzO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0QWxwaGEgPSBmdW5jdGlvbiAoYWxwaGEpIHtcclxuICAgICAgaWYgKGFscGhhID09PSB1bmRlZmluZWQpIGFscGhhID0gMDtcclxuICAgICAgdGhpcy5tX2FscGhhID0gYWxwaGE7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRBbHBoYSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMubV9hbHBoYTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLlNldEZpbGxBbHBoYSA9IGZ1bmN0aW9uIChhbHBoYSkge1xyXG4gICAgICBpZiAoYWxwaGEgPT09IHVuZGVmaW5lZCkgYWxwaGEgPSAwO1xyXG4gICAgICB0aGlzLm1fZmlsbEFscGhhID0gYWxwaGE7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRGaWxsQWxwaGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm1fZmlsbEFscGhhO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuU2V0WEZvcm1TY2FsZSA9IGZ1bmN0aW9uICh4Zm9ybVNjYWxlKSB7XHJcbiAgICAgIGlmICh4Zm9ybVNjYWxlID09PSB1bmRlZmluZWQpIHhmb3JtU2NhbGUgPSAwO1xyXG4gICAgICB0aGlzLm1feGZvcm1TY2FsZSA9IHhmb3JtU2NhbGU7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5HZXRYRm9ybVNjYWxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5tX3hmb3JtU2NhbGU7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3UG9seWdvbiA9IGZ1bmN0aW9uICh2ZXJ0aWNlcywgdmVydGV4Q291bnQsIGNvbG9yKSB7XHJcbiAgICAgIGlmICghdmVydGV4Q291bnQpIHJldHVybjtcclxuICAgICAgdmFyIHMgPSB0aGlzLm1fY3R4O1xyXG4gICAgICB2YXIgZHJhd1NjYWxlID0gdGhpcy5tX2RyYXdTY2FsZTtcclxuICAgICAgcy5iZWdpblBhdGgoKTtcclxuICAgICAgcy5zdHJva2VTdHlsZSA9IHRoaXMuX2NvbG9yKGNvbG9yLmNvbG9yLCB0aGlzLm1fYWxwaGEpO1xyXG4gICAgICBzLm1vdmVUbyh2ZXJ0aWNlc1swXS54ICogZHJhd1NjYWxlLCB2ZXJ0aWNlc1swXS55ICogZHJhd1NjYWxlKTtcclxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCB2ZXJ0ZXhDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgIHMubGluZVRvKHZlcnRpY2VzW2ldLnggKiBkcmF3U2NhbGUsIHZlcnRpY2VzW2ldLnkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICB9XHJcbiAgICAgIHMubGluZVRvKHZlcnRpY2VzWzBdLnggKiBkcmF3U2NhbGUsIHZlcnRpY2VzWzBdLnkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICBzLmNsb3NlUGF0aCgpO1xyXG4gICAgICBzLnN0cm9rZSgpO1xyXG4gICB9O1xyXG4gICBiMkRlYnVnRHJhdy5wcm90b3R5cGUuRHJhd1NvbGlkUG9seWdvbiA9IGZ1bmN0aW9uICh2ZXJ0aWNlcywgdmVydGV4Q291bnQsIGNvbG9yKSB7XHJcbiAgICAgIGlmICghdmVydGV4Q291bnQpIHJldHVybjtcclxuICAgICAgdmFyIHMgPSB0aGlzLm1fY3R4O1xyXG4gICAgICB2YXIgZHJhd1NjYWxlID0gdGhpcy5tX2RyYXdTY2FsZTtcclxuICAgICAgcy5iZWdpblBhdGgoKTtcclxuICAgICAgcy5zdHJva2VTdHlsZSA9IHRoaXMuX2NvbG9yKGNvbG9yLmNvbG9yLCB0aGlzLm1fYWxwaGEpO1xyXG4gICAgICBzLmZpbGxTdHlsZSA9IHRoaXMuX2NvbG9yKGNvbG9yLmNvbG9yLCB0aGlzLm1fZmlsbEFscGhhKTtcclxuICAgICAgcy5tb3ZlVG8odmVydGljZXNbMF0ueCAqIGRyYXdTY2FsZSwgdmVydGljZXNbMF0ueSAqIGRyYXdTY2FsZSk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdmVydGV4Q291bnQ7IGkrKykge1xyXG4gICAgICAgICBzLmxpbmVUbyh2ZXJ0aWNlc1tpXS54ICogZHJhd1NjYWxlLCB2ZXJ0aWNlc1tpXS55ICogZHJhd1NjYWxlKTtcclxuICAgICAgfVxyXG4gICAgICBzLmxpbmVUbyh2ZXJ0aWNlc1swXS54ICogZHJhd1NjYWxlLCB2ZXJ0aWNlc1swXS55ICogZHJhd1NjYWxlKTtcclxuICAgICAgcy5jbG9zZVBhdGgoKTtcclxuICAgICAgcy5maWxsKCk7XHJcbiAgICAgIHMuc3Ryb2tlKCk7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3Q2lyY2xlID0gZnVuY3Rpb24gKGNlbnRlciwgcmFkaXVzLCBjb2xvcikge1xyXG4gICAgICBpZiAoIXJhZGl1cykgcmV0dXJuO1xyXG4gICAgICB2YXIgcyA9IHRoaXMubV9jdHg7XHJcbiAgICAgIHZhciBkcmF3U2NhbGUgPSB0aGlzLm1fZHJhd1NjYWxlO1xyXG4gICAgICBzLmJlZ2luUGF0aCgpO1xyXG4gICAgICBzLnN0cm9rZVN0eWxlID0gdGhpcy5fY29sb3IoY29sb3IuY29sb3IsIHRoaXMubV9hbHBoYSk7XHJcbiAgICAgIHMuYXJjKGNlbnRlci54ICogZHJhd1NjYWxlLCBjZW50ZXIueSAqIGRyYXdTY2FsZSwgcmFkaXVzICogZHJhd1NjYWxlLCAwLCBNYXRoLlBJICogMiwgdHJ1ZSk7XHJcbiAgICAgIHMuY2xvc2VQYXRoKCk7XHJcbiAgICAgIHMuc3Ryb2tlKCk7XHJcbiAgIH07XHJcbiAgIGIyRGVidWdEcmF3LnByb3RvdHlwZS5EcmF3U29saWRDaXJjbGUgPSBmdW5jdGlvbiAoY2VudGVyLCByYWRpdXMsIGF4aXMsIGNvbG9yKSB7XHJcbiAgICAgIGlmICghcmFkaXVzKSByZXR1cm47XHJcbiAgICAgIHZhciBzID0gdGhpcy5tX2N0eCxcclxuICAgICAgICAgZHJhd1NjYWxlID0gdGhpcy5tX2RyYXdTY2FsZSxcclxuICAgICAgICAgY3ggPSBjZW50ZXIueCAqIGRyYXdTY2FsZSxcclxuICAgICAgICAgY3kgPSBjZW50ZXIueSAqIGRyYXdTY2FsZTtcclxuICAgICAgcy5tb3ZlVG8oMCwgMCk7XHJcbiAgICAgIHMuYmVnaW5QYXRoKCk7XHJcbiAgICAgIHMuc3Ryb2tlU3R5bGUgPSB0aGlzLl9jb2xvcihjb2xvci5jb2xvciwgdGhpcy5tX2FscGhhKTtcclxuICAgICAgcy5maWxsU3R5bGUgPSB0aGlzLl9jb2xvcihjb2xvci5jb2xvciwgdGhpcy5tX2ZpbGxBbHBoYSk7XHJcbiAgICAgIHMuYXJjKGN4LCBjeSwgcmFkaXVzICogZHJhd1NjYWxlLCAwLCBNYXRoLlBJICogMiwgdHJ1ZSk7XHJcbiAgICAgIHMubW92ZVRvKGN4LCBjeSk7XHJcbiAgICAgIHMubGluZVRvKChjZW50ZXIueCArIGF4aXMueCAqIHJhZGl1cykgKiBkcmF3U2NhbGUsIChjZW50ZXIueSArIGF4aXMueSAqIHJhZGl1cykgKiBkcmF3U2NhbGUpO1xyXG4gICAgICBzLmNsb3NlUGF0aCgpO1xyXG4gICAgICBzLmZpbGwoKTtcclxuICAgICAgcy5zdHJva2UoKTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdTZWdtZW50ID0gZnVuY3Rpb24gKHAxLCBwMiwgY29sb3IpIHtcclxuICAgICAgdmFyIHMgPSB0aGlzLm1fY3R4LFxyXG4gICAgICAgICBkcmF3U2NhbGUgPSB0aGlzLm1fZHJhd1NjYWxlO1xyXG4gICAgICBzLnN0cm9rZVN0eWxlID0gdGhpcy5fY29sb3IoY29sb3IuY29sb3IsIHRoaXMubV9hbHBoYSk7XHJcbiAgICAgIHMuYmVnaW5QYXRoKCk7XHJcbiAgICAgIHMubW92ZVRvKHAxLnggKiBkcmF3U2NhbGUsIHAxLnkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICBzLmxpbmVUbyhwMi54ICogZHJhd1NjYWxlLCBwMi55ICogZHJhd1NjYWxlKTtcclxuICAgICAgcy5jbG9zZVBhdGgoKTtcclxuICAgICAgcy5zdHJva2UoKTtcclxuICAgfTtcclxuICAgYjJEZWJ1Z0RyYXcucHJvdG90eXBlLkRyYXdUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoeGYpIHtcclxuICAgICAgdmFyIHMgPSB0aGlzLm1fY3R4LFxyXG4gICAgICAgICBkcmF3U2NhbGUgPSB0aGlzLm1fZHJhd1NjYWxlO1xyXG4gICAgICBzLmJlZ2luUGF0aCgpO1xyXG4gICAgICBzLnN0cm9rZVN0eWxlID0gdGhpcy5fY29sb3IoMHhmZjAwMDAsIHRoaXMubV9hbHBoYSk7XHJcbiAgICAgIHMubW92ZVRvKHhmLnBvc2l0aW9uLnggKiBkcmF3U2NhbGUsIHhmLnBvc2l0aW9uLnkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICBzLmxpbmVUbygoeGYucG9zaXRpb24ueCArIHRoaXMubV94Zm9ybVNjYWxlICogeGYuUi5jb2wxLngpICogZHJhd1NjYWxlLCAoeGYucG9zaXRpb24ueSArIHRoaXMubV94Zm9ybVNjYWxlICogeGYuUi5jb2wxLnkpICogZHJhd1NjYWxlKTtcclxuXHJcbiAgICAgIHMuc3Ryb2tlU3R5bGUgPSB0aGlzLl9jb2xvcigweGZmMDAsIHRoaXMubV9hbHBoYSk7XHJcbiAgICAgIHMubW92ZVRvKHhmLnBvc2l0aW9uLnggKiBkcmF3U2NhbGUsIHhmLnBvc2l0aW9uLnkgKiBkcmF3U2NhbGUpO1xyXG4gICAgICBzLmxpbmVUbygoeGYucG9zaXRpb24ueCArIHRoaXMubV94Zm9ybVNjYWxlICogeGYuUi5jb2wyLngpICogZHJhd1NjYWxlLCAoeGYucG9zaXRpb24ueSArIHRoaXMubV94Zm9ybVNjYWxlICogeGYuUi5jb2wyLnkpICogZHJhd1NjYWxlKTtcclxuICAgICAgcy5jbG9zZVBhdGgoKTtcclxuICAgICAgcy5zdHJva2UoKTtcclxuICAgfTtcclxufSkoKTtcclxudmFyIGk7XHJcbmZvciAoaSA9IDA7IGkgPCBCb3gyRC5wb3N0RGVmcy5sZW5ndGg7ICsraSkgQm94MkQucG9zdERlZnNbaV0oKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQm94MkQiXX0=
